const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chart-object-layer-BpEe6utS.js","assets/index-BeEBmKHg.js","assets/index-B0IGPAVQ.css","assets/use-mobile-sheet-gestures-Cb4N-jmf.js","assets/IconDotsVertical-CN6gMKhf.js","assets/dropdown-menu-B-AKCW-3.js","assets/index-C7bOgUX-.js","assets/index-Cb14wQcW.js","assets/IconTrash-vSqwhPNu.js","assets/index-Bbyeb-lS.js","assets/chart-editor-panel-CgrebG3g.js","assets/button-QEsfqKkV.js","assets/index-DYsYobJT.js","assets/select-C9YdWZge.js","assets/input-gjrZ9qRS.js","assets/label-BZMtrT83.js","assets/IconX-CsWaoy8y.js","assets/conditional-format-panel-DQDU3OF-.js","assets/IconPlus-TOKri1wK.js"])))=>i.map(i=>d[i]);
var pt=Object.defineProperty;var xt=(l,t,s)=>t in l?pt(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s;var G=(l,t,s)=>xt(l,typeof t!="symbol"?t+"":t,s);import{r as u,j as e,x as bt,y as jt,t as Ce,e as kt,_ as _e}from"./index-BeEBmKHg.js";import{b as He,C as Ct,p as B,t as w,f as Mt,a as Me,e as Se,i as we,n as We,c as Q,d as St,g as ge,s as qe,h as wt,j as It,k as zt,l as Nt,m as Ge,o as Ot,r as Xe,q as Rt,u as Ft,v as At,w as Pt,x as Tt}from"./use-mobile-sheet-gestures-Cb4N-jmf.js";import{a as Bt}from"./index-C7bOgUX-.js";import{f as Dt,P as Et,D as X,a as Y,b as Z,d as ee,e as L,c as p,p as ie}from"./dropdown-menu-B-AKCW-3.js";import{c as _t}from"./index-Bbyeb-lS.js";import{c as Lt}from"./index-Cb14wQcW.js";import{c as j,u as Kt,a as N,b as O,d as R,S as te,e as Vt}from"./IconDotsVertical-CN6gMKhf.js";/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ne=j("outline","abc","IconAbc",[["path",{d:"M3 16v-6a2 2 0 1 1 4 0v6",key:"svg-0"}],["path",{d:"M3 13h4",key:"svg-1"}],["path",{d:"M10 8v6a2 2 0 1 0 4 0v-1a2 2 0 1 0 -4 0v1",key:"svg-2"}],["path",{d:"M20.732 12a2 2 0 0 0 -3.732 1v1a2 2 0 0 0 3.726 1.01",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Oe=j("outline","align-box-bottom-center","IconAlignBoxBottomCenter",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 15v2",key:"svg-1"}],["path",{d:"M12 11v6",key:"svg-2"}],["path",{d:"M15 13v4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Re=j("outline","align-box-center-middle","IconAlignBoxCenterMiddle",[["path",{d:"M3 19v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M11 15h2",key:"svg-1"}],["path",{d:"M9 12h6",key:"svg-2"}],["path",{d:"M10 9h4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fe=j("outline","align-box-top-center","IconAlignBoxTopCenter",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 9v-2",key:"svg-1"}],["path",{d:"M12 13v-6",key:"svg-2"}],["path",{d:"M15 11v-4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ae=j("outline","align-center","IconAlignCenter",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M8 12l8 0",key:"svg-1"}],["path",{d:"M6 18l12 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Pe=j("outline","align-left","IconAlignLeft",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M4 12l10 0",key:"svg-1"}],["path",{d:"M4 18l14 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Te=j("outline","align-right","IconAlignRight",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M10 12l10 0",key:"svg-1"}],["path",{d:"M6 18l14 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ut=j("outline","arrow-back-up","IconArrowBackUp",[["path",{d:"M9 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M5 10h11a4 4 0 1 1 0 8h-1",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var $t=j("outline","arrow-forward-up","IconArrowForwardUp",[["path",{d:"M15 14l4 -4l-4 -4",key:"svg-0"}],["path",{d:"M19 10h-11a4 4 0 1 0 0 8h1",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ht=j("outline","bold","IconBold",[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ie=j("outline","border-all","IconBorderAll",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M4 12l16 0",key:"svg-1"}],["path",{d:"M12 4l0 16",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ye=j("outline","border-bottom","IconBorderBottom",[["path",{d:"M20 20l-16 0",key:"svg-0"}],["path",{d:"M4 4l0 .01",key:"svg-1"}],["path",{d:"M8 4l0 .01",key:"svg-2"}],["path",{d:"M12 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M20 4l0 .01",key:"svg-5"}],["path",{d:"M4 8l0 .01",key:"svg-6"}],["path",{d:"M12 8l0 .01",key:"svg-7"}],["path",{d:"M20 8l0 .01",key:"svg-8"}],["path",{d:"M4 12l0 .01",key:"svg-9"}],["path",{d:"M8 12l0 .01",key:"svg-10"}],["path",{d:"M12 12l0 .01",key:"svg-11"}],["path",{d:"M16 12l0 .01",key:"svg-12"}],["path",{d:"M20 12l0 .01",key:"svg-13"}],["path",{d:"M4 16l0 .01",key:"svg-14"}],["path",{d:"M12 16l0 .01",key:"svg-15"}],["path",{d:"M20 16l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ze=j("outline","border-inner","IconBorderInner",[["path",{d:"M4 12l16 0",key:"svg-0"}],["path",{d:"M12 4l0 16",key:"svg-1"}],["path",{d:"M4 4l0 .01",key:"svg-2"}],["path",{d:"M8 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M20 4l0 .01",key:"svg-5"}],["path",{d:"M4 8l0 .01",key:"svg-6"}],["path",{d:"M20 8l0 .01",key:"svg-7"}],["path",{d:"M4 16l0 .01",key:"svg-8"}],["path",{d:"M20 16l0 .01",key:"svg-9"}],["path",{d:"M4 20l0 .01",key:"svg-10"}],["path",{d:"M8 20l0 .01",key:"svg-11"}],["path",{d:"M16 20l0 .01",key:"svg-12"}],["path",{d:"M20 20l0 .01",key:"svg-13"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Je=j("outline","border-left","IconBorderLeft",[["path",{d:"M4 20l0 -16",key:"svg-0"}],["path",{d:"M8 4l0 .01",key:"svg-1"}],["path",{d:"M12 4l0 .01",key:"svg-2"}],["path",{d:"M16 4l0 .01",key:"svg-3"}],["path",{d:"M20 4l0 .01",key:"svg-4"}],["path",{d:"M12 8l0 .01",key:"svg-5"}],["path",{d:"M20 8l0 .01",key:"svg-6"}],["path",{d:"M8 12l0 .01",key:"svg-7"}],["path",{d:"M12 12l0 .01",key:"svg-8"}],["path",{d:"M16 12l0 .01",key:"svg-9"}],["path",{d:"M20 12l0 .01",key:"svg-10"}],["path",{d:"M12 16l0 .01",key:"svg-11"}],["path",{d:"M20 16l0 .01",key:"svg-12"}],["path",{d:"M8 20l0 .01",key:"svg-13"}],["path",{d:"M12 20l0 .01",key:"svg-14"}],["path",{d:"M16 20l0 .01",key:"svg-15"}],["path",{d:"M20 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Qe=j("outline","border-none","IconBorderNone",[["path",{d:"M4 4l0 .01",key:"svg-0"}],["path",{d:"M8 4l0 .01",key:"svg-1"}],["path",{d:"M12 4l0 .01",key:"svg-2"}],["path",{d:"M16 4l0 .01",key:"svg-3"}],["path",{d:"M20 4l0 .01",key:"svg-4"}],["path",{d:"M4 8l0 .01",key:"svg-5"}],["path",{d:"M12 8l0 .01",key:"svg-6"}],["path",{d:"M20 8l0 .01",key:"svg-7"}],["path",{d:"M4 12l0 .01",key:"svg-8"}],["path",{d:"M8 12l0 .01",key:"svg-9"}],["path",{d:"M12 12l0 .01",key:"svg-10"}],["path",{d:"M16 12l0 .01",key:"svg-11"}],["path",{d:"M20 12l0 .01",key:"svg-12"}],["path",{d:"M4 16l0 .01",key:"svg-13"}],["path",{d:"M12 16l0 .01",key:"svg-14"}],["path",{d:"M20 16l0 .01",key:"svg-15"}],["path",{d:"M4 20l0 .01",key:"svg-16"}],["path",{d:"M8 20l0 .01",key:"svg-17"}],["path",{d:"M12 20l0 .01",key:"svg-18"}],["path",{d:"M16 20l0 .01",key:"svg-19"}],["path",{d:"M20 20l0 .01",key:"svg-20"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var et=j("outline","border-outer","IconBorderOuter",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M12 8l0 .01",key:"svg-1"}],["path",{d:"M8 12l0 .01",key:"svg-2"}],["path",{d:"M12 12l0 .01",key:"svg-3"}],["path",{d:"M16 12l0 .01",key:"svg-4"}],["path",{d:"M12 16l0 .01",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var tt=j("outline","border-right","IconBorderRight",[["path",{d:"M20 4l0 16",key:"svg-0"}],["path",{d:"M4 4l0 .01",key:"svg-1"}],["path",{d:"M8 4l0 .01",key:"svg-2"}],["path",{d:"M12 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M4 8l0 .01",key:"svg-5"}],["path",{d:"M12 8l0 .01",key:"svg-6"}],["path",{d:"M4 12l0 .01",key:"svg-7"}],["path",{d:"M8 12l0 .01",key:"svg-8"}],["path",{d:"M12 12l0 .01",key:"svg-9"}],["path",{d:"M16 12l0 .01",key:"svg-10"}],["path",{d:"M4 16l0 .01",key:"svg-11"}],["path",{d:"M12 16l0 .01",key:"svg-12"}],["path",{d:"M4 20l0 .01",key:"svg-13"}],["path",{d:"M8 20l0 .01",key:"svg-14"}],["path",{d:"M12 20l0 .01",key:"svg-15"}],["path",{d:"M16 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var st=j("outline","border-top","IconBorderTop",[["path",{d:"M4 4l16 0",key:"svg-0"}],["path",{d:"M4 8l0 .01",key:"svg-1"}],["path",{d:"M12 8l0 .01",key:"svg-2"}],["path",{d:"M20 8l0 .01",key:"svg-3"}],["path",{d:"M4 12l0 .01",key:"svg-4"}],["path",{d:"M8 12l0 .01",key:"svg-5"}],["path",{d:"M12 12l0 .01",key:"svg-6"}],["path",{d:"M16 12l0 .01",key:"svg-7"}],["path",{d:"M20 12l0 .01",key:"svg-8"}],["path",{d:"M4 16l0 .01",key:"svg-9"}],["path",{d:"M12 16l0 .01",key:"svg-10"}],["path",{d:"M20 16l0 .01",key:"svg-11"}],["path",{d:"M4 20l0 .01",key:"svg-12"}],["path",{d:"M8 20l0 .01",key:"svg-13"}],["path",{d:"M12 20l0 .01",key:"svg-14"}],["path",{d:"M16 20l0 .01",key:"svg-15"}],["path",{d:"M20 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Be=j("outline","calendar","IconCalendar",[["path",{d:"M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z",key:"svg-0"}],["path",{d:"M16 3v4",key:"svg-1"}],["path",{d:"M8 3v4",key:"svg-2"}],["path",{d:"M4 11h16",key:"svg-3"}],["path",{d:"M11 15h1",key:"svg-4"}],["path",{d:"M12 15v3",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var nt=j("outline","chart-bar","IconChartBar",[["path",{d:"M3 13a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M15 9a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M9 5a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M4 20h14",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ve=j("outline","chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ae=j("outline","currency-dollar","IconCurrencyDollar",[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ye=j("outline","decimal","IconDecimal",[["path",{d:"M17 8a2 2 0 0 1 2 2v4a2 2 0 1 1 -4 0v-4a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M10 8a2 2 0 0 1 2 2v4a2 2 0 1 1 -4 0v-4a2 2 0 0 1 2 -2z",key:"svg-1"}],["path",{d:"M5 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var rt=j("outline","droplet-off","IconDropletOff",[["path",{d:"M18.963 14.938a6.54 6.54 0 0 0 -.899 -4.06l-4.89 -7.26c-.42 -.626 -1.287 -.804 -1.936 -.398a1.376 1.376 0 0 0 -.41 .397l-1.282 1.9m-1.625 2.415l-1.986 2.946c-1.695 2.837 -1.035 6.44 1.567 8.545c2.602 2.105 6.395 2.105 8.996 0a6.83 6.83 0 0 0 1.376 -1.499",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var lt=j("outline","filter","IconFilter",[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var De=j("outline","hash","IconHash",[["path",{d:"M5 9l14 0",key:"svg-0"}],["path",{d:"M5 15l14 0",key:"svg-1"}],["path",{d:"M11 4l-4 16",key:"svg-2"}],["path",{d:"M17 4l-4 16",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Wt=j("outline","italic","IconItalic",[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ot=j("outline","math-function","IconMathFunction",[["path",{d:"M3 19a2 2 0 0 0 2 2c2 0 2 -4 3 -9s1 -9 3 -9a2 2 0 0 1 2 2",key:"svg-0"}],["path",{d:"M5 12h6",key:"svg-1"}],["path",{d:"M15 12l6 6",key:"svg-2"}],["path",{d:"M15 18l6 -6",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var it=j("outline","paint","IconPaint",[["path",{d:"M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2",key:"svg-1"}],["path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var pe=j("outline","percentage","IconPercentage",[["path",{d:"M17 17m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M7 7m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M6 18l12 -12",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var at=j("outline","strikethrough","IconStrikethrough",[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var qt=j("outline","table-alias","IconTableAlias",[["path",{d:"M3 12v-7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-7",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v10",key:"svg-2"}],["path",{d:"M2 17a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-4z",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Gt=j("outline","typography","IconTypography",[["path",{d:"M4 20l3 0",key:"svg-0"}],["path",{d:"M14 20l7 0",key:"svg-1"}],["path",{d:"M6.9 15l6.9 0",key:"svg-2"}],["path",{d:"M10.2 6.3l5.8 13.7",key:"svg-3"}],["path",{d:"M5 20l6 -16l2 0l7 16",key:"svg-4"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xt=j("filled","droplet-half-2-filled","IconDropletHalf2Filled",[["path",{d:"M13.905 2.923l.098 .135l4.92 7.306a7.566 7.566 0 0 1 1.043 3.167l.024 .326c.007 .047 .01 .094 .01 .143l-.002 .06c.056 2.3 -.944 4.582 -2.87 6.14c-2.969 2.402 -7.286 2.402 -10.255 0c-1.904 -1.54 -2.904 -3.787 -2.865 -6.071a1.052 1.052 0 0 1 .013 -.333a7.66 7.66 0 0 1 .913 -3.176l.172 -.302l4.893 -7.26c.185 -.275 .426 -.509 .709 -.686c1.055 -.66 2.446 -.413 3.197 .55zm-2.06 1.107l-.077 .038l-.041 .03l-.037 .036l-.033 .042l-4.863 7.214a5.607 5.607 0 0 0 -.651 1.61h11.723a5.444 5.444 0 0 0 -.49 -1.313l-.141 -.251l-4.891 -7.261a.428 .428 0 0 0 -.5 -.145z",key:"svg-0"}]]),Yt="Toggle",dt=u.forwardRef((l,t)=>{const{pressed:s,defaultPressed:r=!1,onPressedChange:n,...o}=l,[i=!1,c]=Dt({prop:s,onChange:n,defaultProp:r});return e.jsx(Et.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":l.disabled?"":void 0,...o,ref:t,onClick:Bt(l.onClick,()=>{l.disabled||c(!i)})})});dt.displayName=Yt;var Zt=dt;const Jt=_t("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}});function ze({className:l,variant:t,size:s,...r}){return e.jsx(Zt,{"data-slot":"toggle",className:Lt(Jt({variant:t,size:s}),l),...r})}const Qt=["#000000","#434343","#666666","#999999","#cccccc","#d50000","#e67c73","#f4511e","#ef6c00","#f09300","#0b8043","#33b679","#039be5","#3f51b5","#7986cb","#8e24aa","#d81b60","#ad1457","#6a1b9a","#4a148c"],es=["#ffffff","#f3f3f3","#e8e8e8","#d9d9d9","#cccccc","#fce4ec","#fff3e0","#fff9c4","#e8f5e9","#e0f7fa","#e3f2fd","#ede7f6","#f8bbd0","#f3e5f5","#e8eaf6","#ffcdd2","#ffe0b2","#fff59d","#c8e6c9","#b2dfdb"],ts={left:Pe,center:Ae,right:Te},ss={top:Fe,middle:Re,bottom:Oe},ns={plain:Ne,number:De,currency:ae,percent:pe,date:Be},ut=typeof navigator<"u"&&/Mac|iPhone|iPad|iPod/.test(navigator.userAgent),se=ut?"⌘":"Ctrl";function rs({spreadsheet:l,onInsertChart:t,onOpenConditionalFormat:s}){const r=Kt(),[n,o]=u.useState(void 0),[i,c]=u.useState(!1),[d,x]=u.useState(!1),[m,b]=u.useState(!1),g=u.useMemo(()=>He("en-US"),[]),C=u.useMemo(()=>He(),[]),I=u.useCallback(async()=>{if(!l)return;const k=await l.getActiveStyle();o(k),c(l.isSelectionMerged()),x(l.canMergeSelection()),b(l.hasFilter())},[l]);u.useEffect(()=>{if(l)return I(),l.onSelectionChange(I)},[l,I]);const y=u.useCallback(k=>{l==null||l.toggleStyle(k)},[l]),a=u.useCallback(k=>{l==null||l.applyStyle({al:k})},[l]),h=u.useCallback(k=>{l==null||l.applyStyle({va:k})},[l]),v=u.useCallback(k=>{l==null||l.applyStyle({tc:k})},[l]),z=u.useCallback(()=>{l==null||l.applyStyle({tc:""})},[l]),E=u.useCallback(k=>{l==null||l.applyStyle({bg:k})},[l]),A=u.useCallback(()=>{l==null||l.applyStyle({bg:""})},[l]),K=u.useCallback(()=>{l==null||l.undo()},[l]),be=u.useCallback(()=>{l==null||l.redo()},[l]),ce=u.useCallback(()=>{l==null||l.toggleFunctionBrowser()},[l]),ne=u.useCallback(()=>{t==null||t()},[t]),he=u.useCallback(()=>{s==null||s()},[s]),P=u.useCallback(k=>{l==null||l.applyStyle({nf:k})},[l]),de=u.useCallback(()=>{l==null||l.increaseDecimals()},[l]),re=u.useCallback(()=>{l==null||l.decreaseDecimals()},[l]),je=u.useCallback(()=>{l==null||l.toggleMergeCells()},[l]),le=u.useCallback(async()=>{l&&(l.hasFilter()?await l.clearFilter():await l.createFilterFromSelection(),await I())},[I,l]),F=u.useCallback(k=>{l==null||l.applyBorders(k)},[l]),ue=(n==null?void 0:n.al)||"left",M=ts[ue],f=(n==null?void 0:n.va)||"top",T=ss[f],S=(n==null?void 0:n.nf)||"plain",D=ns[S];return e.jsxs("div",{className:"flex items-center gap-0.5 overflow-x-auto border-b bg-background px-2 py-1 whitespace-nowrap",children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:K,children:e.jsx(Ut,{size:16})})}),e.jsxs(R,{children:["Undo (",se,"+Z)"]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:be,children:e.jsx($t,{size:16})})}),e.jsxs(R,{children:["Redo (",se,"+",ut?"⇧Z":"Y",")"]})]}),e.jsx(te,{orientation:"vertical",className:"mx-1 h-6"}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:()=>P("currency"),children:e.jsx(ae,{size:16})})}),e.jsxs(R,{children:["Format as currency (",C.currency,")"]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:()=>P("percent"),children:e.jsx(pe,{size:16})})}),e.jsx(R,{children:"Format as percent"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:re,children:[e.jsx(ye,{size:16}),e.jsx("span",{className:"absolute mt-3.5 ml-3 text-[8px] font-bold leading-none",children:"-"})]})}),e.jsx(R,{children:"Decrease decimal places"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:de,children:[e.jsx(ye,{size:16}),e.jsx("span",{className:"absolute mt-3.5 ml-3 text-[8px] font-bold leading-none",children:"+"})]})}),e.jsx(R,{children:"Increase decimal places"})]}),e.jsxs(X,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(Y,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(D,{size:16}),e.jsx(ve,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"More format"})]}),e.jsxs(Z,{children:[e.jsx(ee,{className:"text-xs font-normal text-muted-foreground",children:"Common formats (US examples)"}),e.jsx(L,{}),e.jsxs(p,{onClick:()=>P("plain"),children:[e.jsx(Ne,{size:16,className:"mr-2"}),"Plain text"]}),e.jsxs(p,{onClick:()=>P("number"),children:[e.jsx(De,{size:16,className:"mr-2"}),"Number",e.jsx(ie,{children:g.number})]}),e.jsxs(p,{onClick:()=>P("currency"),children:[e.jsx(ae,{size:16,className:"mr-2"}),"Currency",e.jsx(ie,{children:g.currencyValue})]}),e.jsxs(p,{onClick:()=>P("percent"),children:[e.jsx(pe,{size:16,className:"mr-2"}),"Percent",e.jsx(ie,{children:g.percent})]}),e.jsx(L,{}),e.jsxs(ee,{className:"text-xs font-normal text-muted-foreground",children:["US date preview: ",g.date]}),e.jsx(L,{}),e.jsxs(ee,{className:"text-xs font-normal text-muted-foreground",children:["Your locale (",C.locale,")"]}),e.jsxs(p,{onClick:()=>P("currency"),children:[e.jsx(ae,{size:16,className:"mr-2"}),"Locale currency",e.jsx(ie,{children:C.currencyValue})]}),e.jsxs(p,{onClick:()=>P("date"),children:[e.jsx(Be,{size:16,className:"mr-2"}),"Locale date",e.jsx(ie,{children:C.date})]})]})]}),e.jsx(te,{orientation:"vertical",className:"mx-1 h-6"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(ze,{size:"sm",pressed:(n==null?void 0:n.b)||!1,onPressedChange:()=>y("b"),className:"h-7 w-7 cursor-pointer",children:e.jsx(Ht,{size:16})})}),e.jsxs(R,{children:["Bold (",se,"+B)"]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(ze,{size:"sm",pressed:(n==null?void 0:n.i)||!1,onPressedChange:()=>y("i"),className:"h-7 w-7 cursor-pointer",children:e.jsx(Wt,{size:16})})}),e.jsxs(R,{children:["Italic (",se,"+I)"]})]}),!r&&e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(ze,{size:"sm",pressed:(n==null?void 0:n.st)||!1,onPressedChange:()=>y("st"),className:"h-7 w-7 cursor-pointer",children:e.jsx(at,{size:16})})}),e.jsxs(R,{children:["Strikethrough (",se,"+Shift+S)"]})]}),e.jsxs(X,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(Y,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:[e.jsx(Gt,{size:16}),e.jsx("span",{className:"absolute mt-5 h-0.5 w-3.5 rounded",style:{backgroundColor:(n==null?void 0:n.tc)||"#000000"}})]})})}),e.jsx(R,{children:"Text color"})]}),e.jsxs(Z,{className:"w-auto p-2",children:[e.jsxs("button",{className:"mb-2 flex w-full items-center gap-2 rounded px-2 py-1 text-xs hover:bg-muted",onClick:z,children:[e.jsx(rt,{size:14}),"Reset"]}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:Qt.map(k=>e.jsx("button",{className:"h-5 w-5 rounded border border-border hover:scale-125 transition-transform",style:{backgroundColor:k},onClick:()=>v(k)},k))})]})]}),e.jsx(te,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(X,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(Y,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:[e.jsx(Xt,{size:16}),e.jsx("span",{className:"absolute mt-5 h-0.5 w-3.5 rounded",style:{backgroundColor:(n==null?void 0:n.bg)||"transparent",border:n!=null&&n.bg?"none":"1px solid #ccc"}})]})})}),e.jsx(R,{children:"Fill color"})]}),e.jsxs(Z,{className:"w-auto p-2",children:[e.jsxs("button",{className:"mb-2 flex w-full items-center gap-2 rounded px-2 py-1 text-xs hover:bg-muted",onClick:A,children:[e.jsx(rt,{size:14}),"Reset"]}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:es.map(k=>e.jsx("button",{className:"h-5 w-5 rounded border border-border hover:scale-125 transition-transform",style:{backgroundColor:k},onClick:()=>E(k)},k))})]})]}),!r&&e.jsxs(X,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(Y,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(Ie,{size:14}),e.jsx(ve,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"Cell borders"})]}),e.jsxs(Z,{children:[e.jsxs(p,{onClick:()=>F("all"),children:[e.jsx(Ie,{size:14,className:"mr-2"}),"All borders"]}),e.jsxs(p,{onClick:()=>F("outer"),children:[e.jsx(et,{size:14,className:"mr-2"}),"Outer border"]}),e.jsxs(p,{onClick:()=>F("inner"),children:[e.jsx(Ze,{size:14,className:"mr-2"}),"Inner borders"]}),e.jsx(L,{}),e.jsxs(p,{onClick:()=>F("top"),children:[e.jsx(st,{size:14,className:"mr-2"}),"Top border"]}),e.jsxs(p,{onClick:()=>F("bottom"),children:[e.jsx(Ye,{size:14,className:"mr-2"}),"Bottom border"]}),e.jsxs(p,{onClick:()=>F("left"),children:[e.jsx(Je,{size:14,className:"mr-2"}),"Left border"]}),e.jsxs(p,{onClick:()=>F("right"),children:[e.jsx(tt,{size:14,className:"mr-2"}),"Right border"]}),e.jsx(L,{}),e.jsxs(p,{onClick:()=>F("clear"),children:[e.jsx(Qe,{size:14,className:"mr-2"}),"Clear borders"]})]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:`inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted disabled:cursor-not-allowed disabled:opacity-50 ${i?"bg-muted":""}`,onClick:je,disabled:!i&&!d,children:e.jsx(qt,{size:16})})}),e.jsx(R,{children:i?"Unmerge cells":`Merge cells (${se}+Shift+M)`})]}),!r&&e.jsxs(e.Fragment,{children:[e.jsx(te,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(X,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(Y,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(M,{size:16}),e.jsx(ve,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"Horizontal align"})]}),e.jsxs(Z,{children:[e.jsxs(p,{onClick:()=>a("left"),children:[e.jsx(Pe,{size:16,className:"mr-2"}),"Left"]}),e.jsxs(p,{onClick:()=>a("center"),children:[e.jsx(Ae,{size:16,className:"mr-2"}),"Center"]}),e.jsxs(p,{onClick:()=>a("right"),children:[e.jsx(Te,{size:16,className:"mr-2"}),"Right"]})]})]}),e.jsxs(X,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(Y,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(T,{size:16}),e.jsx(ve,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"Vertical align"})]}),e.jsxs(Z,{children:[e.jsxs(p,{onClick:()=>h("top"),children:[e.jsx(Fe,{size:16,className:"mr-2"}),"Top"]}),e.jsxs(p,{onClick:()=>h("middle"),children:[e.jsx(Re,{size:16,className:"mr-2"}),"Middle"]}),e.jsxs(p,{onClick:()=>h("bottom"),children:[e.jsx(Oe,{size:16,className:"mr-2"}),"Bottom"]})]})]}),e.jsx(te,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-[11px] font-semibold hover:bg-muted",onClick:ce,children:e.jsx(ot,{size:16,className:"mr-2"})})}),e.jsx(R,{children:"Functions"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:`inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted ${m?"bg-muted":""}`,onClick:()=>{le()},children:e.jsx(lt,{size:16})})}),e.jsx(R,{children:m?"Clear filter":"Create filter from selection"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-[11px] font-semibold hover:bg-muted",onClick:ne,children:e.jsx(nt,{size:16})})}),e.jsx(R,{children:"Insert chart"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center rounded-md px-2 text-[10px] font-semibold tracking-wide hover:bg-muted",onClick:he,children:e.jsx(it,{size:16})})}),e.jsx(R,{children:"Conditional formatting"})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx(te,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:e.jsx(Vt,{size:16})})}),e.jsxs(Z,{align:"end",children:[e.jsx(ee,{children:"Format"}),e.jsxs(p,{onClick:()=>P("currency"),children:[e.jsx(ae,{size:16,className:"mr-2"}),"Currency"]}),e.jsxs(p,{onClick:()=>P("percent"),children:[e.jsx(pe,{size:16,className:"mr-2"}),"Percent"]}),e.jsxs(p,{onClick:re,children:[e.jsx(ye,{size:16,className:"mr-2"}),"Decrease decimals"]}),e.jsxs(p,{onClick:de,children:[e.jsx(ye,{size:16,className:"mr-2"}),"Increase decimals"]}),e.jsx(L,{}),e.jsxs(p,{onClick:()=>P("plain"),children:[e.jsx(Ne,{size:16,className:"mr-2"}),"Plain text"]}),e.jsxs(p,{onClick:()=>P("number"),children:[e.jsx(De,{size:16,className:"mr-2"}),"Number (",g.number,")"]}),e.jsxs(p,{onClick:()=>P("date"),children:[e.jsx(Be,{size:16,className:"mr-2"}),"Date (",C.date,")"]}),e.jsx(L,{}),e.jsxs(p,{onClick:()=>{le()},children:[e.jsx(lt,{size:16,className:"mr-2"}),m?"Clear filter":"Create filter"]}),e.jsx(L,{}),e.jsx(ee,{children:"Align"}),e.jsxs(p,{onClick:()=>a("left"),children:[e.jsx(Pe,{size:16,className:"mr-2"}),"Left"]}),e.jsxs(p,{onClick:()=>a("center"),children:[e.jsx(Ae,{size:16,className:"mr-2"}),"Center"]}),e.jsxs(p,{onClick:()=>a("right"),children:[e.jsx(Te,{size:16,className:"mr-2"}),"Right"]}),e.jsxs(p,{onClick:()=>h("top"),children:[e.jsx(Fe,{size:16,className:"mr-2"}),"Top"]}),e.jsxs(p,{onClick:()=>h("middle"),children:[e.jsx(Re,{size:16,className:"mr-2"}),"Middle"]}),e.jsxs(p,{onClick:()=>h("bottom"),children:[e.jsx(Oe,{size:16,className:"mr-2"}),"Bottom"]}),e.jsx(L,{}),e.jsx(ee,{children:"Borders"}),e.jsxs(p,{onClick:()=>F("all"),children:[e.jsx(Ie,{size:14,className:"mr-2"}),"All borders"]}),e.jsxs(p,{onClick:()=>F("outer"),children:[e.jsx(et,{size:14,className:"mr-2"}),"Outer border"]}),e.jsxs(p,{onClick:()=>F("inner"),children:[e.jsx(Ze,{size:14,className:"mr-2"}),"Inner borders"]}),e.jsxs(p,{onClick:()=>F("top"),children:[e.jsx(st,{size:14,className:"mr-2"}),"Top border"]}),e.jsxs(p,{onClick:()=>F("bottom"),children:[e.jsx(Ye,{size:14,className:"mr-2"}),"Bottom border"]}),e.jsxs(p,{onClick:()=>F("left"),children:[e.jsx(Je,{size:14,className:"mr-2"}),"Left border"]}),e.jsxs(p,{onClick:()=>F("right"),children:[e.jsx(tt,{size:14,className:"mr-2"}),"Right border"]}),e.jsxs(p,{onClick:()=>F("clear"),children:[e.jsx(Qe,{size:14,className:"mr-2"}),"Clear borders"]}),e.jsx(L,{}),e.jsxs(p,{onClick:()=>y("st"),children:[e.jsx(at,{size:16,className:"mr-2"}),"Strikethrough"]}),e.jsxs(p,{onClick:ce,children:[e.jsx(ot,{size:16,className:"mr-2"}),"Functions"]}),e.jsxs(p,{onClick:ne,children:[e.jsx(nt,{size:16,className:"mr-2"}),"Insert chart"]}),e.jsxs(p,{onClick:he,children:[e.jsx(it,{size:16,className:"mr-2"}),"Conditional formatting"]})]})]})]})]})}class ls{constructor(t,s){G(this,"doc");G(this,"tabId");G(this,"cellIndex",new Ct);G(this,"dirty",!0);G(this,"batchOverlay",null);G(this,"batchOps",null);this.doc=t,this.tabId=s,this.doc.update((r,n)=>{n.set({activeTabId:this.tabId})}),t.subscribe(r=>{r.type==="remote-change"&&(this.dirty=!0)})}getSheet(){return this.doc.getRoot().sheets[this.tabId]}isDuplicateOwnKeysError(t){return t instanceof TypeError&&t.message.includes("ownKeys")&&t.message.includes("duplicate")}snapshotObject(t){const s=t.toJSON;return typeof s=="function"?JSON.parse(s.call(t)):{...t}}stableObjectKeys(t){try{return Object.keys(t)}catch(s){if(this.isDuplicateOwnKeysError(s))return console.warn(s),Object.keys(this.snapshotObject(t));throw s}}stableObjectEntries(t){try{return Object.entries(t)}catch(s){if(this.isDuplicateOwnKeysError(s))return console.warn(s),Object.entries(this.snapshotObject(t));throw s}}stableSheetKeys(t){return this.stableObjectKeys(t)}stableSheetEntries(t){return this.stableObjectEntries(t)}toPlainString(t){if(typeof t=="string")return t;if(t==null)return"";if(typeof t=="number"||typeof t=="boolean")return String(t);if(typeof t=="object"){const s=t;if(s.value!==void 0&&s.value!==t)return this.toPlainString(s.value);if(typeof s.toJSON=="function")try{const r=s.toJSON.call(t);if(r!==t)return this.toPlainString(r)}catch{}}return String(t)}normalizeFilterCondition(t){const s={op:t.op};return t.value!==void 0&&(s.value=this.toPlainString(t.value)),t.values!==void 0&&(s.values=t.values.map(r=>this.toPlainString(r))),s}toWorksheetFilterState(t){return{startRow:t.range[0].r,endRow:t.range[1].r,startCol:t.range[0].c,endCol:t.range[1].c,columns:Object.fromEntries(Object.entries(t.columns).map(([s,r])=>[s,this.normalizeFilterCondition(r)])),hiddenRows:[...t.hiddenRows]}}fromWorksheetFilterState(t){if(t)return{range:[{r:t.startRow,c:t.startCol},{r:t.endRow,c:t.endCol}],columns:Object.fromEntries(Object.entries(t.columns||{}).map(([s,r])=>[s,this.normalizeFilterCondition(r)])),hiddenRows:[...t.hiddenRows||[]]}}ensureIndex(){if(!this.dirty)return;const t=this.getSheet().sheet,s=[];for(const r of this.stableSheetKeys(t)){const n=B(r);s.push([n.r,n.c])}this.cellIndex.rebuild(s),this.dirty=!1}normalizeCell(t){const s={};return t.v!==void 0&&t.v!==""&&(s.v=t.v),t.f!==void 0&&t.f!==""&&(s.f=t.f),t.s&&Object.keys(t.s).length>0&&(s.s=t.s),s.v===void 0&&s.f===void 0&&s.s===void 0?null:s}async set(t,s){const r=w(t),n=this.normalizeCell(s);if(this.batchOverlay){n?(this.batchOverlay.set(r,n),this.dirty||this.cellIndex.add(t.r,t.c)):(this.batchOverlay.set(r,null),this.dirty||this.cellIndex.remove(t.r,t.c));return}if(!n){await this.delete(t);return}const o=this.tabId;this.doc.update(i=>{i.sheets[o].sheet[r]=n}),this.dirty||this.cellIndex.add(t.r,t.c)}async get(t){const s=w(t);if(this.batchOverlay&&this.batchOverlay.has(s)){const r=this.batchOverlay.get(s);return r===null?void 0:r}return this.getSheet().sheet[s]}async has(t){const s=w(t);return this.batchOverlay&&this.batchOverlay.has(s)?this.batchOverlay.get(s)!==null:this.getSheet().sheet[s]!==void 0}async delete(t){const s=w(t);if(this.batchOverlay){let o=!1;return this.batchOverlay.has(s)?o=this.batchOverlay.get(s)!==null:o=this.getSheet().sheet[s]!==void 0,o?(this.batchOverlay.set(s,null),this.dirty||this.cellIndex.remove(t.r,t.c),!0):!1}let r=!1;const n=this.tabId;return this.doc.update(o=>{o.sheets[n].sheet[s]!==void 0&&(delete o.sheets[n].sheet[s],r=!0)}),r&&!this.dirty&&this.cellIndex.remove(t.r,t.c),r}async deleteRange(t){this.ensureIndex();const s=Array.from(this.cellIndex.cellsInRange(t)),r=new Set;if(this.batchOverlay){for(const[o,i]of s){const c=w({r:o,c:i});this.batchOverlay.has(c)&&this.batchOverlay.get(c)===null||(this.batchOverlay.set(c,null),r.add(c))}for(const[o,i]of s)this.cellIndex.remove(o,i);return r}const n=this.tabId;this.doc.update(o=>{for(const[i,c]of s){const d=w({r:i,c});delete o.sheets[n].sheet[d],r.add(d)}});for(const[o,i]of s)this.cellIndex.remove(o,i);return r}async setGrid(t){if(this.batchOverlay){for(const[r,n]of t){const o=B(r),i=this.normalizeCell(n);i?(this.batchOverlay.set(r,i),this.dirty||this.cellIndex.add(o.r,o.c)):(this.batchOverlay.set(r,null),this.dirty||this.cellIndex.remove(o.r,o.c))}return}const s=this.tabId;if(this.doc.update(r=>{for(const[n,o]of t){const i=this.normalizeCell(o);i?r.sheets[s].sheet[n]=i:r.sheets[s].sheet[n]!==void 0&&delete r.sheets[s].sheet[n]}}),!this.dirty)for(const[r,n]of t){const o=B(r);this.normalizeCell(n)?this.cellIndex.add(o.r,o.c):this.cellIndex.remove(o.r,o.c)}}async getGrid(t){this.ensureIndex();const s=this.getSheet().sheet,r=new Map;for(const[n,o]of this.cellIndex.cellsInRange(t)){const i=w({r:n,c:o});if(this.batchOverlay&&this.batchOverlay.has(i)){const d=this.batchOverlay.get(i);d!==null&&r.set(i,d);continue}const c=s[i];c!==void 0&&r.set(i,c)}return r}async findEdge(t,s,r){return this.ensureIndex(),Mt(this.cellIndex,t,s,r,(n,o)=>{const i=w({r:n,c:o}),c=this.getSheet().sheet[i];return c!==void 0&&(!!c.v||!!c.f)})}async shiftCells(t,s,r){const n=this.tabId,o=i=>{const c=i.sheets[n],d=[];for(const[y,a]of this.stableSheetEntries(c.sheet))d.push([y,{v:a.v,f:a.f,s:a.s}]);const x=new Map;for(const[y,a]of d){const h=qe(y,t,s,r);if(h===null)continue;let v;a.f?v={...a,f:wt(a.f,t,s,r)}:v={...a};const z=this.normalizeCell(v);z&&x.set(h,z)}for(const[y]of d)!x.has(y)&&c.sheet[y]!==void 0&&delete c.sheet[y];for(const[y,a]of x)c.sheet[y]=a;const m=t==="row"?c.rowHeights:c.colWidths,b=[];for(const[y,a]of Object.entries(m))b.push([y,a]);for(const[y]of b)delete m[y];for(const[y,a]of b){const h=Number(y);if(r>0)h>=s?m[String(h+r)]=a:m[y]=a;else{const v=Math.abs(r);h>=s&&h<s+v||(h>=s+v?m[String(h+r)]=a:m[y]=a)}}const g=t==="row"?c.rowStyles:c.colStyles;if(g){const y=[];for(const[a,h]of Object.entries(g))y.push([a,h]);for(const[a]of y)delete g[a];for(const[a,h]of y){const v=Number(a);if(r>0)v>=s?g[String(v+r)]=h:g[a]=h;else{const z=Math.abs(r);v>=s&&v<s+z||(v>=s+z?g[String(v+r)]=h:g[a]=h)}}}c.rangeStyles&&(c.rangeStyles=It(c.rangeStyles,t,s,r)),c.conditionalFormats&&(c.conditionalFormats=zt(c.conditionalFormats,t,s,r));const C=new Map(Object.entries(c.merges||{})),I=Nt(C,t,s,r);c.merges={};for(const[y,a]of I)c.merges[y]=a;if(c.charts)for(const y of Object.values(c.charts)){const a=qe(y.anchor,t,s,r);if(a){y.anchor=a;continue}const h=B(y.anchor);t==="row"?h.r=Math.max(1,s):h.c=Math.max(1,s),y.anchor=w(h)}};if(this.batchOps){this.batchOps.push(o),this.dirty=!0;return}this.doc.update(i=>{o(i)}),this.dirty=!0}async moveCells(t,s,r,n){const o=this.tabId,i=c=>{const d=c.sheets[o],x=[];for(const[a,h]of this.stableSheetEntries(d.sheet))x.push([a,{v:h.v,f:h.f,s:h.s}]);const m=new Map;for(const[a,h]of x){const v=B(a),z=Ge(v,t,s,r,n),E=w(z);let A;h.f?A={...h,f:Ot(h.f,t,s,r,n)}:A={...h};const K=this.normalizeCell(A);K&&m.set(E,K)}for(const[a]of x)!m.has(a)&&d.sheet[a]!==void 0&&delete d.sheet[a];for(const[a,h]of m)d.sheet[a]=h;const b=t==="row"?d.rowHeights:d.colWidths,g=[];for(const[a,h]of Object.entries(b))g.push([a,h]);for(const[a]of g)delete b[a];for(const[a,h]of g){const v=Number(a),z=Xe(v,s,r,n);b[String(z)]=h}const C=t==="row"?d.rowStyles:d.colStyles;if(C){const a=[];for(const[h,v]of Object.entries(C))a.push([h,v]);for(const[h]of a)delete C[h];for(const[h,v]of a){const z=Number(h),E=Xe(z,s,r,n);C[String(E)]=v}}d.rangeStyles&&(d.rangeStyles=Rt(d.rangeStyles,t,s,r,n)),d.conditionalFormats&&(d.conditionalFormats=Ft(d.conditionalFormats,t,s,r,n));const I=new Map(Object.entries(d.merges||{})),y=At(I,t,s,r,n);d.merges={};for(const[a,h]of y)d.merges[a]=h;if(d.charts)for(const a of Object.values(d.charts)){const h=Ge(B(a.anchor),t,s,r,n);a.anchor=w(h)}};if(this.batchOps){this.batchOps.push(i),this.dirty=!0;return}this.doc.update(c=>{i(c)}),this.dirty=!0}async getFormulaGrid(){const t=new Map,s=this.getSheet().sheet;for(const[r,n]of this.stableSheetEntries(s))n.f&&t.set(r,n);return t}async buildDependantsMap(t){const s=new Map,r=this.getSheet().sheet;if(this.batchOverlay){for(const[n,o]of this.stableSheetEntries(r))if(!this.batchOverlay.has(n)&&o.f)for(const i of Me(Se(o.f)))we(i)||(s.has(i)||s.set(i,new Set),s.get(i).add(n));for(const[n,o]of this.batchOverlay)if(!(o===null||!o.f))for(const i of Me(Se(o.f)))we(i)||(s.has(i)||s.set(i,new Set),s.get(i).add(n));return s}for(const[n,o]of this.stableSheetEntries(r))if(o.f)for(const i of Me(Se(o.f)))we(i)||(s.has(i)||s.set(i,new Set),s.get(i).add(n));return s}async setDimensionSize(t,s,r){if(this.batchOps){const o=this.tabId;this.batchOps.push(i=>{const c=t==="row"?i.sheets[o].rowHeights:i.sheets[o].colWidths;c[String(s)]=r});return}const n=this.tabId;this.doc.update(o=>{const i=t==="row"?o.sheets[n].rowHeights:o.sheets[n].colWidths;i[String(s)]=r})}async getDimensionSizes(t){const s=this.getSheet(),r=t==="row"?s.rowHeights:s.colWidths,n=new Map;if(r)for(const[o,i]of Object.entries(r))n.set(Number(o),i);return n}updateActiveCell(t){this.doc.update((s,r)=>{r.set({activeCell:w(t),activeTabId:this.tabId})})}getPresences(){return this.doc.getOthersPresences().filter(t=>{var s;return((s=t.presence)==null?void 0:s.activeTabId)===this.tabId})}async setColumnStyle(t,s){if(this.batchOps){const n=this.tabId;this.batchOps.push(o=>{o.sheets[n].colStyles||(o.sheets[n].colStyles={}),o.sheets[n].colStyles[String(t)]=s});return}const r=this.tabId;this.doc.update(n=>{n.sheets[r].colStyles||(n.sheets[r].colStyles={}),n.sheets[r].colStyles[String(t)]=s})}async getColumnStyles(){const t=this.getSheet(),s=new Map;if(t.colStyles)for(const[r,n]of Object.entries(t.colStyles))s.set(Number(r),n);return s}async setRowStyle(t,s){if(this.batchOps){const n=this.tabId;this.batchOps.push(o=>{o.sheets[n].rowStyles||(o.sheets[n].rowStyles={}),o.sheets[n].rowStyles[String(t)]=s});return}const r=this.tabId;this.doc.update(n=>{n.sheets[r].rowStyles||(n.sheets[r].rowStyles={}),n.sheets[r].rowStyles[String(t)]=s})}async getRowStyles(){const t=this.getSheet(),s=new Map;if(t.rowStyles)for(const[r,n]of Object.entries(t.rowStyles))s.set(Number(r),n);return s}async setSheetStyle(t){if(this.batchOps){const r=this.tabId;this.batchOps.push(n=>{n.sheets[r].sheetStyle=t});return}const s=this.tabId;this.doc.update(r=>{r.sheets[s].sheetStyle=t})}async getSheetStyle(){const t=this.getSheet();return t.sheetStyle?{...t.sheetStyle}:void 0}async addRangeStyle(t){const s=We(t);if(!s)return;if(this.batchOps){const n=this.tabId;this.batchOps.push(o=>{o.sheets[n].rangeStyles||(o.sheets[n].rangeStyles=[]),o.sheets[n].rangeStyles.push(Q(s))});return}const r=this.tabId;this.doc.update(n=>{n.sheets[r].rangeStyles||(n.sheets[r].rangeStyles=[]),n.sheets[r].rangeStyles.push(Q(s))})}async setRangeStyles(t){const s=t.map(n=>We(n)).filter(n=>!!n).map(n=>Q(n));if(this.batchOps){const n=this.tabId;this.batchOps.push(o=>{if(s.length===0){delete o.sheets[n].rangeStyles;return}o.sheets[n].rangeStyles=s.map(i=>Q(i))});return}const r=this.tabId;this.doc.update(n=>{if(s.length===0){delete n.sheets[r].rangeStyles;return}n.sheets[r].rangeStyles=s.map(o=>Q(o))})}async getRangeStyles(){const t=this.getSheet();return!t.rangeStyles||t.rangeStyles.length===0?[]:t.rangeStyles.map(s=>Q(s))}async setConditionalFormats(t){const s=t.map(n=>St(n)).filter(n=>!!n).map(n=>ge(n));if(this.batchOps){const n=this.tabId;this.batchOps.push(o=>{if(s.length===0){delete o.sheets[n].conditionalFormats;return}o.sheets[n].conditionalFormats=s.map(i=>ge(i))});return}const r=this.tabId;this.doc.update(n=>{if(s.length===0){delete n.sheets[r].conditionalFormats;return}n.sheets[r].conditionalFormats=s.map(o=>ge(o))})}async getConditionalFormats(){const t=this.getSheet();return!t.conditionalFormats||t.conditionalFormats.length===0?[]:t.conditionalFormats.map(s=>ge(s))}async setMerge(t,s){if(this.batchOps){const o=this.tabId,i=w(t);this.batchOps.push(c=>{c.sheets[o].merges||(c.sheets[o].merges={}),c.sheets[o].merges[i]={...s}});return}const r=this.tabId,n=w(t);this.doc.update(o=>{o.sheets[r].merges||(o.sheets[r].merges={}),o.sheets[r].merges[n]={...s}})}async deleteMerge(t){var o;const s=w(t);if(this.batchOps){const i=this.tabId;return!((o=this.getSheet().merges)!=null&&o[s])?!1:(this.batchOps.push(x=>{var m;(m=x.sheets[i].merges)!=null&&m[s]&&delete x.sheets[i].merges[s]}),!0)}let r=!1;const n=this.tabId;return this.doc.update(i=>{var c;(c=i.sheets[n].merges)!=null&&c[s]&&(delete i.sheets[n].merges[s],r=!0)}),r}async getMerges(){const t=this.getSheet(),s=new Map;if(!t.merges)return s;for(const[r,n]of Object.entries(t.merges))s.set(r,{...n});return s}async setFilterState(t){if(this.batchOps){const r=this.tabId;this.batchOps.push(n=>{const o=n.sheets[r];if(!t){delete o.filter;return}o.filter=this.toWorksheetFilterState(t)});return}const s=this.tabId;this.doc.update(r=>{const n=r.sheets[s];if(!t){delete n.filter;return}n.filter=this.toWorksheetFilterState(t)})}async getFilterState(){return this.fromWorksheetFilterState(this.getSheet().filter)}async setFreezePane(t,s){if(this.batchOps){const n=this.tabId;this.batchOps.push(o=>{o.sheets[n].frozenRows=t,o.sheets[n].frozenCols=s});return}const r=this.tabId;this.doc.update(n=>{n.sheets[r].frozenRows=t,n.sheets[r].frozenCols=s})}async getFreezePane(){const t=this.getSheet();return{frozenRows:t.frozenRows??0,frozenCols:t.frozenCols??0}}beginBatch(){this.batchOverlay=new Map,this.batchOps=[]}endBatch(){const t=this.batchOverlay,s=this.batchOps;this.batchOverlay=null,this.batchOps=null;const r=t&&t.size>0,n=s&&s.length>0;if(!r&&!n)return;const o=this.tabId;this.doc.update(i=>{const c=i.sheets[o];if(t)for(const[d,x]of t)if(x===null)c.sheet[d]!==void 0&&delete c.sheet[d];else{const m=this.normalizeCell(x);m?c.sheet[d]=m:c.sheet[d]!==void 0&&delete c.sheet[d]}if(s)for(const d of s)d(i)}),this.dirty=!0}async undo(){if(!this.doc.history.canUndo())return{success:!1};const t=new Set(this.stableSheetKeys(this.getSheet().sheet)),s=new Map(Object.entries(this.getSheet().merges||{}));return this.doc.history.undo(),this.dirty=!0,{success:!0,affectedRange:this.computeAffectedRange(t,s)}}async redo(){if(!this.doc.history.canRedo())return{success:!1};const t=new Set(this.stableSheetKeys(this.getSheet().sheet)),s=new Map(Object.entries(this.getSheet().merges||{}));return this.doc.history.redo(),this.dirty=!0,{success:!0,affectedRange:this.computeAffectedRange(t,s)}}computeAffectedRange(t,s){const r=new Set(this.stableSheetKeys(this.getSheet().sheet)),n=new Map(Object.entries(this.getSheet().merges||{})),o=new Set;for(const m of r)t.has(m)||o.add(m);for(const m of t)r.has(m)||o.add(m);for(const[m,b]of n){const g=s.get(m);(!g||g.rs!==b.rs||g.cs!==b.cs)&&o.add(m)}for(const m of s.keys())n.has(m)||o.add(m);if(o.size===0)return;let i=1/0,c=-1/0,d=1/0,x=-1/0;for(const m of o){const b=B(m);b.r<i&&(i=b.r),b.r>c&&(c=b.r),b.c<d&&(d=b.c),b.c>x&&(x=b.c)}return[{r:i,c:d},{r:c,c:x}]}canUndo(){return this.doc.history.canUndo()}canRedo(){return this.doc.history.canRedo()}}function ft(l){if(typeof l!="string")return null;const t=l.toUpperCase().replace(/\$/g,"").split(":").map(s=>s.trim()).filter(Boolean);if(t.length!==2)return null;try{const s=B(t[0]),r=B(t[1]);return[{r:Math.min(s.r,r.r),c:Math.min(s.c,r.c)},{r:Math.max(s.r,r.r),c:Math.max(s.c,r.c)}]}catch{return null}}function js(l){return`${w(l[0])}:${w(l[1])}`}function os(l){const[t,s]=l,r=[];for(let n=t.c;n<=s.c;n++)r.push(mt(n));return r.length===0?{xAxisColumn:null,seriesColumns:[]}:{xAxisColumn:r[0],seriesColumns:r.slice(1)}}function is(l,t){const s=l.sheets[t.sourceTabId];if(!s)return{columns:[],xAxisColumn:null,seriesColumns:[]};const r=ft(t.sourceRange);if(!r)return{columns:[],xAxisColumn:null,seriesColumns:[]};const[n,o]=r,i=[];for(let g=n.c;g<=o.c;g++){const C=mt(g);i.push({column:C,index:g,label:xe(s,n.r,g)||C})}if(i.length===0)return{columns:[],xAxisColumn:null,seriesColumns:[]};const c=i[0].column,d=Ee(t.xAxisColumn),x=i.some(g=>g.column===d)?d:c,m=new Set,b=[];for(const g of t.seriesColumns||[]){const C=Ee(g);C&&C!==x&&!m.has(C)&&i.some(I=>I.column===C)&&(m.add(C),b.push(C))}if(b.length===0)for(const g of i)g.column!==x&&b.push(g.column);return{columns:i,xAxisColumn:x,seriesColumns:b}}function ks(l,t){const s=l.sheets[t.sourceTabId];if(!s)return{xKey:"category",rows:[],series:[],config:{}};const r=ft(t.sourceRange);if(!r)return{xKey:"category",rows:[],series:[],config:{}};const[n,o]=r,i=o.c-n.c+1,c=o.r-n.r+1;if(i<2||c<2)return{xKey:"category",rows:[],series:[],config:{}};const d=is(l,t);if(!d.xAxisColumn||d.seriesColumns.length===0)return{xKey:"category",rows:[],series:[],config:{}};const x=ct(d.xAxisColumn);if(!x)return{xKey:"category",rows:[],series:[],config:{}};const m=[],b={},g=[];for(const[y,a]of d.seriesColumns.entries()){const h=ct(a);if(!h)continue;const v=xe(s,n.r,h)||a,z=`series_${a}`,E={key:z,label:v};m.push(E),g.push({...E,index:h}),b[z]={label:v,color:cs(y)}}if(g.length===0)return{xKey:"category",rows:[],series:[],config:{}};const C="category",I=[];for(let y=n.r+1;y<=o.r;y++){const a={};a[C]=xe(s,y,x)||`Row ${y-n.r}`;let h=!1;for(const v of g){const z=as(xe(s,y,v.index));z!==null&&(a[v.key]=z,h=!0)}h&&I.push(a)}return{xKey:C,rows:I,series:m,config:b}}function xe(l,t,s){var n;const r=(n=l.sheet[w({r:t,c:s})])==null?void 0:n.v;return typeof r=="string"?r:r==null?"":String(r)}function as(l){if(typeof l!="string")return null;const t=l.trim().replace(/,/g,"");if(!t)return null;const s=Number(t);return Number.isFinite(s)?s:null}function mt(l){return w({r:1,c:l}).replace(/[0-9]+$/,"")}function ct(l){const t=Ee(l);if(!t)return null;try{return B(`${t}1`).c}catch{return null}}function Ee(l){if(typeof l!="string")return null;const t=l.trim().toUpperCase();return/^[A-Z]+$/.test(t)?t:null}function cs(l){const t=["var(--color-primary)","color-mix(in oklch, var(--color-primary) 78%, var(--color-background))","color-mix(in oklch, var(--color-primary) 68%, var(--color-foreground))","color-mix(in oklch, var(--color-primary) 56%, var(--color-background))","color-mix(in oklch, var(--color-primary) 46%, var(--color-foreground))"];return t[l%t.length]}const hs=u.lazy(()=>_e(()=>import("./chart-object-layer-BpEe6utS.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(l=>({default:l.ChartObjectLayer}))),ds=u.lazy(()=>_e(()=>import("./chart-editor-panel-CgrebG3g.js"),__vite__mapDeps([10,1,2,11,7,9,6,5,12,13,4,14,15,16,3])).then(l=>({default:l.ChartEditorPanel}))),us=u.lazy(()=>_e(()=>import("./conditional-format-panel-DQDU3OF-.js"),__vite__mapDeps([17,1,2,3,4,5,6,7,11,9,14,15,13,12,16,18])).then(l=>({default:l.ConditionalFormatPanel})));function ht({tabId:l,readOnly:t=!1,peerJumpTarget:s=null}){var le,F,ue;const{resolvedTheme:r}=bt(),n=u.useRef(null),[o,i]=u.useState(!1),[c,d]=u.useState(0),[x,m]=u.useState(null),[b,g]=u.useState(!1),[C,I]=u.useState(!1),y=u.useRef(0),a=u.useRef(void 0),h=u.useRef(!1),{doc:v,loading:z,error:E}=jt.useDocument();Pt({containerRef:n,sheetRef:a});const A=v==null?void 0:v.getRoot(),K=!!A&&Object.keys(((le=A.sheets[l])==null?void 0:le.charts)||{}).length>0,be=A&&x?(ue=(F=A.sheets[l])==null?void 0:F.charts)==null?void 0:ue[x]:void 0;u.useEffect(()=>{h.current=K},[K]);const ce=u.useCallback(()=>{if(t)return;const M=a.current;if(!v||!M)return;if(M.getSelectionType()!=="cell"){Ce.error("Select a cell range to insert a chart.");return}const f=M.getSelectionRangeOrActiveCell();if(!f){Ce.error("Select a cell range to insert a chart.");return}const T=f[1].r-f[0].r+1,S=f[1].c-f[0].c+1;if(T<2||S<2){Ce.error("Select at least 2 rows and 2 columns.");return}const D=`chart-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,k=`${w(f[0])}:${w(f[1])}`,$=w(f[0]),V=os([f[0],f[1]]);v.update(H=>{const _=H.sheets[l];_.charts||(_.charts={}),_.charts[D]={id:D,type:"bar",title:"Chart",sourceTabId:l,sourceRange:k,xAxisColumn:V.xAxisColumn||void 0,seriesColumns:V.seriesColumns,anchor:$,offsetX:8,offsetY:8,width:420,height:260}}),m(D),g(!0),I(!1)},[v,t,l]),ne=u.useCallback((M,f)=>{t||!v||v.update(T=>{var D,k;const S=(k=(D=T.sheets[l])==null?void 0:D.charts)==null?void 0:k[M];S&&(f.anchor!==void 0&&(S.anchor=f.anchor),f.offsetX!==void 0&&(S.offsetX=f.offsetX),f.offsetY!==void 0&&(S.offsetY=f.offsetY),f.width!==void 0&&(S.width=f.width),f.height!==void 0&&(S.height=f.height),f.title!==void 0&&(S.title=f.title),f.sourceRange!==void 0&&(S.sourceRange=f.sourceRange),f.type!==void 0&&(S.type=f.type),f.sourceTabId!==void 0&&(S.sourceTabId=f.sourceTabId),f.xAxisColumn!==void 0&&(S.xAxisColumn=f.xAxisColumn),f.seriesColumns!==void 0&&(S.seriesColumns=[...f.seriesColumns]))})},[v,t,l]),he=u.useCallback(M=>{t||!v||(v.update(f=>{var S;const T=f.sheets[l];(S=T==null?void 0:T.charts)!=null&&S[M]&&delete T.charts[M]}),x===M&&(m(null),g(!1)))},[v,t,x,l]),P=u.useCallback(M=>{m(M),g(!0),I(!1)},[]),de=u.useCallback(()=>{I(!0),g(!1)},[]),re=u.useCallback(()=>{const M=a.current;if(!M||M.getSelectionType()!=="cell")return null;const f=M.getSelectionRangeOrActiveCell();return f?`${w(f[0])}:${w(f[1])}`:null},[]),je=u.useCallback(()=>{x!==null&&m(null),b&&g(!1),C&&I(!1)},[b,C,x]);return u.useEffect(()=>{m(null),g(!1),I(!1)},[l]),u.useEffect(()=>{i(!0)},[]),u.useEffect(()=>{const M=n.current;if(!o||!M||!v)return;let f;const T=[];let S=!1,D=!1,k=!1,$=null,V=null,H=null;return Tt(M,{theme:r,store:new ls(v,l),readOnly:t}).then(_=>{if(S){_.cleanup();return}f=_,a.current=_,d(W=>W+1),T.push(_.onSelectionChange(()=>{!h.current||$!==null||($=requestAnimationFrame(()=>{$=null,d(W=>W+1)}))}));const ke=()=>{if(!(S||!f)){if(D){k=!0;return}D=!0,f.reloadDimensions().then(()=>{if(!(S||!f))return f.recalculateCrossSheetFormulas()}).finally(()=>{D=!1,k&&(k=!1,queueMicrotask(ke))})}},gt=()=>{S||H!==null||(H=requestAnimationFrame(()=>{H=null,ke()}))},vt=()=>{V===null&&(V=requestAnimationFrame(()=>{V=null,!S&&f&&f.renderOverlay()}))};_.setGridResolver((W,yt)=>{const Le=v.getRoot(),Ke=Object.values(Le.tabs).find(U=>U.name.toUpperCase()===W);if(!Ke)return;const fe=Le.sheets[Ke.id];if(!fe)return;const Ve=new Map;if(fe.merges)for(const[U,me]of Object.entries(fe.merges)){const q=B(U);for(let oe=q.r;oe<q.r+me.rs;oe++)for(let J=q.c;J<q.c+me.cs;J++){const $e=w({r:oe,c:J});$e!==U&&Ve.set($e,U)}}const Ue=new Map;for(const U of yt){const me=B(U),q=w(me),oe=Ve.get(q)||q,J=fe.sheet[oe];J&&Ue.set(U,J)}return Ue}),ke(),T.push(v.subscribe(W=>{W.type==="remote-change"&&gt()})),T.push(v.subscribe("presence",vt))}),()=>{S=!0,f&&f.cleanup(),a.current=void 0,$!==null&&cancelAnimationFrame($),V!==null&&cancelAnimationFrame(V),H!==null&&cancelAnimationFrame(H);for(const _ of T)_()}},[o,n,v,l,t,r]),u.useEffect(()=>{var M,f;x&&((f=(M=A==null?void 0:A.sheets[l])==null?void 0:M.charts)!=null&&f[x]||(m(null),g(!1)))},[A,x,l]),u.useEffect(()=>{if(!s||s.targetTabId&&s.targetTabId!==l||s.requestId===y.current)return;const M=a.current;if(M){y.current=s.requestId,m(null),g(!1),I(!1);try{M.focusCell(B(s.activeCell))}catch{}}},[s,c,l]),z?e.jsx(kt,{}):E?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx("div",{className:"text-red-500",children:E.message})}):e.jsxs("div",{className:"flex h-full w-full flex-col",children:[!t&&e.jsx(rs,{spreadsheet:a.current,onInsertChart:ce,onOpenConditionalFormat:de}),e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx("div",{ref:n,className:"h-full w-full",style:{touchAction:"manipulation"},onPointerDown:je}),A&&K&&e.jsx(u.Suspense,{fallback:null,children:e.jsx(hs,{spreadsheet:a.current,root:A,tabId:l,readOnly:t,selectedChartId:x,onSelectChart:m,onRequestEditChart:P,onDeleteChart:he,onUpdateChart:ne,renderVersion:c})}),A&&!t&&b&&e.jsx(u.Suspense,{fallback:null,children:e.jsx(ds,{root:A,chart:be,open:b,onClose:()=>g(!1),onUpdateChart:ne,getSelectionRange:re})}),!t&&C&&e.jsx(u.Suspense,{fallback:null,children:e.jsx(us,{spreadsheet:a.current,open:C,onClose:()=>I(!1),getSelectionRange:re})})]})]})}const Cs=Object.freeze(Object.defineProperty({__proto__:null,SheetView:ht,default:ht},Symbol.toStringTag,{value:"Module"}));export{es as B,nt as I,ht as S,ze as T,Ht as a,ks as b,Wt as c,Gt as d,rt as e,js as f,os as g,Qt as h,Xt as i,ft as p,is as r,Cs as s};
