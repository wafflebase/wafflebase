var Vp=Object.defineProperty;var Wp=(l,e,t)=>e in l?Vp(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var B=(l,e,t)=>Wp(l,typeof e!="symbol"?e+"":e,t);import{z as dd,r as Gp}from"./index-Dlszgb-E.js";import{u as Yp}from"./IconDotsVertical-Cx1369oB.js";var Br={},Vo={},wl;function Xp(){if(wl)return Vo;wl=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Vo,"__esModule",{value:!0}),Vo}var Wo={},Ol;function Kp(){if(Ol)return Wo;Ol=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Wo,"__esModule",{value:!0}),Wo}var kr={},Go={exports:{}},Yo={},Xo={},Ko={},Qo,Fl;function Wa(){return Fl||(Fl=1,Qo=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var o=42;e[t]=o;for(var i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var r=Object.getOwnPropertySymbols(e);if(r.length!==1||r[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,t);if(s.value!==o||s.enumerable!==!0)return!1}return!0}),Qo}var Jo,Pl;function No(){if(Pl)return Jo;Pl=1;var l=Wa();return Jo=function(){return l()&&!!Symbol.toStringTag},Jo}var Zo,Il;function Ga(){return Il||(Il=1,Zo=Object),Zo}var es,Dl;function Qp(){return Dl||(Dl=1,es=Error),es}var ts,Ll;function Jp(){return Ll||(Ll=1,ts=EvalError),ts}var rs,Ml;function Zp(){return Ml||(Ml=1,rs=RangeError),rs}var ns,Bl;function e0(){return Bl||(Bl=1,ns=ReferenceError),ns}var is,kl;function pd(){return kl||(kl=1,is=SyntaxError),is}var os,zl;function Ki(){return zl||(zl=1,os=TypeError),os}var ss,jl;function t0(){return jl||(jl=1,ss=URIError),ss}var as,ql;function r0(){return ql||(ql=1,as=Math.abs),as}var ls,Ul;function n0(){return Ul||(Ul=1,ls=Math.floor),ls}var us,Hl;function i0(){return Hl||(Hl=1,us=Math.max),us}var cs,$l;function o0(){return $l||($l=1,cs=Math.min),cs}var hs,Vl;function s0(){return Vl||(Vl=1,hs=Math.pow),hs}var fs,Wl;function a0(){return Wl||(Wl=1,fs=Math.round),fs}var ds,Gl;function l0(){return Gl||(Gl=1,ds=Number.isNaN||function(e){return e!==e}),ds}var ps,Yl;function u0(){if(Yl)return ps;Yl=1;var l=l0();return ps=function(t){return l(t)||t===0?t:t<0?-1:1},ps}var ms,Xl;function c0(){return Xl||(Xl=1,ms=Object.getOwnPropertyDescriptor),ms}var xs,Kl;function ui(){if(Kl)return xs;Kl=1;var l=c0();if(l)try{l([],"length")}catch{l=null}return xs=l,xs}var gs,Ql;function Ro(){if(Ql)return gs;Ql=1;var l=Object.defineProperty||!1;if(l)try{l({},"a",{value:1})}catch{l=!1}return gs=l,gs}var ys,Jl;function h0(){if(Jl)return ys;Jl=1;var l=typeof Symbol<"u"&&Symbol,e=Wa();return ys=function(){return typeof l!="function"||typeof Symbol!="function"||typeof l("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},ys}var vs,Zl;function md(){return Zl||(Zl=1,vs=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),vs}var Ss,eu;function xd(){if(eu)return Ss;eu=1;var l=Ga();return Ss=l.getPrototypeOf||null,Ss}var As,tu;function f0(){if(tu)return As;tu=1;var l="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,n="[object Function]",o=function(a,c){for(var u=[],h=0;h<a.length;h+=1)u[h]=a[h];for(var f=0;f<c.length;f+=1)u[f+a.length]=c[f];return u},i=function(a,c){for(var u=[],h=c,f=0;h<a.length;h+=1,f+=1)u[f]=a[h];return u},r=function(s,a){for(var c="",u=0;u<s.length;u+=1)c+=s[u],u+1<s.length&&(c+=a);return c};return As=function(a){var c=this;if(typeof c!="function"||e.apply(c)!==n)throw new TypeError(l+c);for(var u=i(arguments,1),h,f=function(){if(this instanceof h){var v=c.apply(this,o(u,arguments));return Object(v)===v?v:this}return c.apply(a,o(u,arguments))},d=t(0,c.length-u.length),p=[],y=0;y<d;y++)p[y]="$"+y;if(h=Function("binder","return function ("+r(p,",")+"){ return binder.apply(this,arguments); }")(f),c.prototype){var m=function(){};m.prototype=c.prototype,h.prototype=new m,m.prototype=null}return h},As}var Cs,ru;function Qi(){if(ru)return Cs;ru=1;var l=f0();return Cs=Function.prototype.bind||l,Cs}var Es,nu;function Ya(){return nu||(nu=1,Es=Function.prototype.call),Es}var _s,iu;function Xa(){return iu||(iu=1,_s=Function.prototype.apply),_s}var Ts,ou;function d0(){return ou||(ou=1,Ts=typeof Reflect<"u"&&Reflect&&Reflect.apply),Ts}var bs,su;function gd(){if(su)return bs;su=1;var l=Qi(),e=Xa(),t=Ya(),n=d0();return bs=n||l.call(t,e),bs}var Ns,au;function Ka(){if(au)return Ns;au=1;var l=Qi(),e=Ki(),t=Ya(),n=gd();return Ns=function(i){if(i.length<1||typeof i[0]!="function")throw new e("a function is required");return n(l,t,i)},Ns}var Rs,lu;function p0(){if(lu)return Rs;lu=1;var l=Ka(),e=ui(),t;try{t=[].__proto__===Array.prototype}catch(r){if(!r||typeof r!="object"||!("code"in r)||r.code!=="ERR_PROTO_ACCESS")throw r}var n=!!t&&e&&e(Object.prototype,"__proto__"),o=Object,i=o.getPrototypeOf;return Rs=n&&typeof n.get=="function"?l([n.get]):typeof i=="function"?function(s){return i(s==null?s:o(s))}:!1,Rs}var ws,uu;function Qa(){if(uu)return ws;uu=1;var l=md(),e=xd(),t=p0();return ws=l?function(o){return l(o)}:e?function(o){if(!o||typeof o!="object"&&typeof o!="function")throw new TypeError("getProto: not an object");return e(o)}:t?function(o){return t(o)}:null,ws}var Os,cu;function yd(){if(cu)return Os;cu=1;var l=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Qi();return Os=t.call(l,e),Os}var Fs,hu;function Ja(){if(hu)return Fs;hu=1;var l,e=Ga(),t=Qp(),n=Jp(),o=Zp(),i=e0(),r=pd(),s=Ki(),a=t0(),c=r0(),u=n0(),h=i0(),f=o0(),d=s0(),p=a0(),y=u0(),m=Function,v=function(I){try{return m('"use strict"; return ('+I+").constructor;")()}catch{}},x=ui(),g=Ro(),S=function(){throw new s},C=x?function(){try{return arguments.callee,S}catch{try{return x(arguments,"callee").get}catch{return S}}}():S,A=h0()(),b=Qa(),N=xd(),R=md(),P=Xa(),k=Ya(),D={},H=typeof Uint8Array>"u"||!b?l:b(Uint8Array),J={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?l:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?l:ArrayBuffer,"%ArrayIteratorPrototype%":A&&b?b([][Symbol.iterator]()):l,"%AsyncFromSyncIteratorPrototype%":l,"%AsyncFunction%":D,"%AsyncGenerator%":D,"%AsyncGeneratorFunction%":D,"%AsyncIteratorPrototype%":D,"%Atomics%":typeof Atomics>"u"?l:Atomics,"%BigInt%":typeof BigInt>"u"?l:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?l:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?l:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?l:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array>"u"?l:Float16Array,"%Float32Array%":typeof Float32Array>"u"?l:Float32Array,"%Float64Array%":typeof Float64Array>"u"?l:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?l:FinalizationRegistry,"%Function%":m,"%GeneratorFunction%":D,"%Int8Array%":typeof Int8Array>"u"?l:Int8Array,"%Int16Array%":typeof Int16Array>"u"?l:Int16Array,"%Int32Array%":typeof Int32Array>"u"?l:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":A&&b?b(b([][Symbol.iterator]())):l,"%JSON%":typeof JSON=="object"?JSON:l,"%Map%":typeof Map>"u"?l:Map,"%MapIteratorPrototype%":typeof Map>"u"||!A||!b?l:b(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":x,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?l:Promise,"%Proxy%":typeof Proxy>"u"?l:Proxy,"%RangeError%":o,"%ReferenceError%":i,"%Reflect%":typeof Reflect>"u"?l:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?l:Set,"%SetIteratorPrototype%":typeof Set>"u"||!A||!b?l:b(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?l:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":A&&b?b(""[Symbol.iterator]()):l,"%Symbol%":A?Symbol:l,"%SyntaxError%":r,"%ThrowTypeError%":C,"%TypedArray%":H,"%TypeError%":s,"%Uint8Array%":typeof Uint8Array>"u"?l:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?l:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?l:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?l:Uint32Array,"%URIError%":a,"%WeakMap%":typeof WeakMap>"u"?l:WeakMap,"%WeakRef%":typeof WeakRef>"u"?l:WeakRef,"%WeakSet%":typeof WeakSet>"u"?l:WeakSet,"%Function.prototype.call%":k,"%Function.prototype.apply%":P,"%Object.defineProperty%":g,"%Object.getPrototypeOf%":N,"%Math.abs%":c,"%Math.floor%":u,"%Math.max%":h,"%Math.min%":f,"%Math.pow%":d,"%Math.round%":p,"%Math.sign%":y,"%Reflect.getPrototypeOf%":R};if(b)try{null.error}catch(I){var te=b(b(I));J["%Error.prototype%"]=te}var le=function I(j){var $;if(j==="%AsyncFunction%")$=v("async function () {}");else if(j==="%GeneratorFunction%")$=v("function* () {}");else if(j==="%AsyncGeneratorFunction%")$=v("async function* () {}");else if(j==="%AsyncGenerator%"){var W=I("%AsyncGeneratorFunction%");W&&($=W.prototype)}else if(j==="%AsyncIteratorPrototype%"){var L=I("%AsyncGenerator%");L&&b&&($=b(L.prototype))}return J[j]=$,$},ge={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ce=Qi(),ee=yd(),G=ce.call(k,Array.prototype.concat),Q=ce.call(P,Array.prototype.splice),ie=ce.call(k,String.prototype.replace),_=ce.call(k,String.prototype.slice),E=ce.call(k,RegExp.prototype.exec),T=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,w=/\\(\\)?/g,F=function(j){var $=_(j,0,1),W=_(j,-1);if($==="%"&&W!=="%")throw new r("invalid intrinsic syntax, expected closing `%`");if(W==="%"&&$!=="%")throw new r("invalid intrinsic syntax, expected opening `%`");var L=[];return ie(j,T,function(M,U,Y,re){L[L.length]=Y?ie(re,w,"$1"):U||M}),L},O=function(j,$){var W=j,L;if(ee(ge,W)&&(L=ge[W],W="%"+L[0]+"%"),ee(J,W)){var M=J[W];if(M===D&&(M=le(W)),typeof M>"u"&&!$)throw new s("intrinsic "+j+" exists, but is not available. Please file an issue!");return{alias:L,name:W,value:M}}throw new r("intrinsic "+j+" does not exist!")};return Fs=function(j,$){if(typeof j!="string"||j.length===0)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof $!="boolean")throw new s('"allowMissing" argument must be a boolean');if(E(/^%?[^%]*%?$/,j)===null)throw new r("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var W=F(j),L=W.length>0?W[0]:"",M=O("%"+L+"%",$),U=M.name,Y=M.value,re=!1,ne=M.alias;ne&&(L=ne[0],Q(W,G([0,1],ne)));for(var q=1,X=!0;q<W.length;q+=1){var he=W[q],Ne=_(he,0,1),Re=_(he,-1);if((Ne==='"'||Ne==="'"||Ne==="`"||Re==='"'||Re==="'"||Re==="`")&&Ne!==Re)throw new r("property names with quotes must have matching quotes");if((he==="constructor"||!X)&&(re=!0),L+="."+he,U="%"+L+"%",ee(J,U))Y=J[U];else if(Y!=null){if(!(he in Y)){if(!$)throw new s("base intrinsic for "+j+" exists, but the property is not available.");return}if(x&&q+1>=W.length){var z=x(Y,he);X=!!z,X&&"get"in z&&!("originalValue"in z.get)?Y=z.get:Y=Y[he]}else X=ee(Y,he),Y=Y[he];X&&!re&&(J[U]=Y)}}return Y},Fs}var Ps,fu;function ci(){if(fu)return Ps;fu=1;var l=Ja(),e=Ka(),t=e([l("%String.prototype.indexOf%")]);return Ps=function(o,i){var r=l(o,!!i);return typeof r=="function"&&t(o,".prototype.")>-1?e([r]):r},Ps}var Is,du;function m0(){if(du)return Is;du=1;var l=No()(),e=ci(),t=e("Object.prototype.toString"),n=function(s){return l&&s&&typeof s=="object"&&Symbol.toStringTag in s?!1:t(s)==="[object Arguments]"},o=function(s){return n(s)?!0:s!==null&&typeof s=="object"&&"length"in s&&typeof s.length=="number"&&s.length>=0&&t(s)!=="[object Array]"&&"callee"in s&&t(s.callee)==="[object Function]"},i=function(){return n(arguments)}();return n.isLegacyArguments=o,Is=i?n:o,Is}var Ds,pu;function x0(){if(pu)return Ds;pu=1;var l=ci(),e=No()(),t=yd(),n=ui(),o;if(e){var i=l("RegExp.prototype.exec"),r={},s=function(){throw r},a={toString:s,valueOf:s};typeof Symbol.toPrimitive=="symbol"&&(a[Symbol.toPrimitive]=s),o=function(f){if(!f||typeof f!="object")return!1;var d=n(f,"lastIndex"),p=d&&t(d,"value");if(!p)return!1;try{i(f,a)}catch(y){return y===r}}}else{var c=l("Object.prototype.toString"),u="[object RegExp]";o=function(f){return!f||typeof f!="object"&&typeof f!="function"?!1:c(f)===u}}return Ds=o,Ds}var Ls,mu;function g0(){if(mu)return Ls;mu=1;var l=ci(),e=x0(),t=l("RegExp.prototype.exec"),n=Ki();return Ls=function(i){if(!e(i))throw new n("`regex` must be a RegExp");return function(s){return t(i,s)!==null}},Ls}var Ms,xu;function y0(){if(xu)return Ms;xu=1;var l=ci(),e=g0(),t=e(/^\s*(?:function)?\*/),n=No()(),o=Qa(),i=l("Object.prototype.toString"),r=l("Function.prototype.toString"),s=function(){if(!n)return!1;try{return Function("return function*() {}")()}catch{}},a;return Ms=function(u){if(typeof u!="function")return!1;if(t(r(u)))return!0;if(!n){var h=i(u);return h==="[object GeneratorFunction]"}if(!o)return!1;if(typeof a>"u"){var f=s();a=f?o(f):!1}return o(u)===a},Ms}var Bs,gu;function v0(){if(gu)return Bs;gu=1;var l=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,n;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},e(function(){throw 42},null,t)}catch(x){x!==n&&(e=null)}else e=null;var o=/^\s*class\b/,i=function(g){try{var S=l.call(g);return o.test(S)}catch{return!1}},r=function(g){try{return i(g)?!1:(l.call(g),!0)}catch{return!1}},s=Object.prototype.toString,a="[object Object]",c="[object Function]",u="[object GeneratorFunction]",h="[object HTMLAllCollection]",f="[object HTML document.all class]",d="[object HTMLCollection]",p=typeof Symbol=="function"&&!!Symbol.toStringTag,y=!(0 in[,]),m=function(){return!1};if(typeof document=="object"){var v=document.all;s.call(v)===s.call(document.all)&&(m=function(g){if((y||!g)&&(typeof g>"u"||typeof g=="object"))try{var S=s.call(g);return(S===h||S===f||S===d||S===a)&&g("")==null}catch{}return!1})}return Bs=e?function(g){if(m(g))return!0;if(!g||typeof g!="function"&&typeof g!="object")return!1;try{e(g,null,t)}catch(S){if(S!==n)return!1}return!i(g)&&r(g)}:function(g){if(m(g))return!0;if(!g||typeof g!="function"&&typeof g!="object")return!1;if(p)return r(g);if(i(g))return!1;var S=s.call(g);return S!==c&&S!==u&&!/^\[object HTML/.test(S)?!1:r(g)},Bs}var ks,yu;function S0(){if(yu)return ks;yu=1;var l=v0(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,n=function(a,c,u){for(var h=0,f=a.length;h<f;h++)t.call(a,h)&&(u==null?c(a[h],h,a):c.call(u,a[h],h,a))},o=function(a,c,u){for(var h=0,f=a.length;h<f;h++)u==null?c(a.charAt(h),h,a):c.call(u,a.charAt(h),h,a)},i=function(a,c,u){for(var h in a)t.call(a,h)&&(u==null?c(a[h],h,a):c.call(u,a[h],h,a))};function r(s){return e.call(s)==="[object Array]"}return ks=function(a,c,u){if(!l(c))throw new TypeError("iterator must be a function");var h;arguments.length>=3&&(h=u),r(a)?n(a,c,h):typeof a=="string"?o(a,c,h):i(a,c,h)},ks}var zs,vu;function A0(){return vu||(vu=1,zs=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),zs}var js,Su;function C0(){if(Su)return js;Su=1;var l=A0(),e=typeof globalThis>"u"?dd:globalThis;return js=function(){for(var n=[],o=0;o<l.length;o++)typeof e[l[o]]=="function"&&(n[n.length]=l[o]);return n},js}var qs={exports:{}},Us,Au;function vd(){if(Au)return Us;Au=1;var l=Ro(),e=pd(),t=Ki(),n=ui();return Us=function(i,r,s){if(!i||typeof i!="object"&&typeof i!="function")throw new t("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,h=arguments.length>6?arguments[6]:!1,f=!!n&&n(i,r);if(l)l(i,r,{configurable:u===null&&f?f.configurable:!u,enumerable:a===null&&f?f.enumerable:!a,value:s,writable:c===null&&f?f.writable:!c});else if(h||!a&&!c&&!u)i[r]=s;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Us}var Hs,Cu;function Sd(){if(Cu)return Hs;Cu=1;var l=Ro(),e=function(){return!!l};return e.hasArrayLengthDefineBug=function(){if(!l)return null;try{return l([],"length",{value:1}).length!==1}catch{return!0}},Hs=e,Hs}var $s,Eu;function E0(){if(Eu)return $s;Eu=1;var l=Ja(),e=vd(),t=Sd()(),n=ui(),o=Ki(),i=l("%Math.floor%");return $s=function(s,a){if(typeof s!="function")throw new o("`fn` is not a function");if(typeof a!="number"||a<0||a>4294967295||i(a)!==a)throw new o("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],u=!0,h=!0;if("length"in s&&n){var f=n(s,"length");f&&!f.configurable&&(u=!1),f&&!f.writable&&(h=!1)}return(u||h||!c)&&(t?e(s,"length",a,!0,!0):e(s,"length",a)),s},$s}var Vs,_u;function _0(){if(_u)return Vs;_u=1;var l=Qi(),e=Xa(),t=gd();return Vs=function(){return t(l,e,arguments)},Vs}var Tu;function wo(){return Tu||(Tu=1,function(l){var e=E0(),t=Ro(),n=Ka(),o=_0();l.exports=function(r){var s=n(arguments),a=r.length-(arguments.length-1);return e(s,1+(a>0?a:0),!0)},t?t(l.exports,"apply",{value:o}):l.exports.apply=o}(qs)),qs.exports}var Ws,bu;function Ad(){if(bu)return Ws;bu=1;var l=S0(),e=C0(),t=wo(),n=ci(),o=ui(),i=Qa(),r=n("Object.prototype.toString"),s=No()(),a=typeof globalThis>"u"?dd:globalThis,c=e(),u=n("String.prototype.slice"),h=n("Array.prototype.indexOf",!0)||function(m,v){for(var x=0;x<m.length;x+=1)if(m[x]===v)return x;return-1},f={__proto__:null};s&&o&&i?l(c,function(y){var m=new a[y];if(Symbol.toStringTag in m&&i){var v=i(m),x=o(v,Symbol.toStringTag);if(!x&&v){var g=i(v);x=o(g,Symbol.toStringTag)}f["$"+y]=t(x.get)}}):l(c,function(y){var m=new a[y],v=m.slice||m.set;v&&(f["$"+y]=t(v))});var d=function(m){var v=!1;return l(f,function(x,g){if(!v)try{"$"+x(m)===g&&(v=u(g,1))}catch{}}),v},p=function(m){var v=!1;return l(f,function(x,g){if(!v)try{x(m),v=u(g,1)}catch{}}),v};return Ws=function(m){if(!m||typeof m!="object")return!1;if(!s){var v=u(r(m),8,-1);return h(c,v)>-1?v:v!=="Object"?!1:p(m)}return o?d(m):null},Ws}var Gs,Nu;function T0(){if(Nu)return Gs;Nu=1;var l=Ad();return Gs=function(t){return!!l(t)},Gs}var Ru;function b0(){return Ru||(Ru=1,function(l){var e=m0(),t=y0(),n=Ad(),o=T0();function i(q){return q.call.bind(q)}var r=typeof BigInt<"u",s=typeof Symbol<"u",a=i(Object.prototype.toString),c=i(Number.prototype.valueOf),u=i(String.prototype.valueOf),h=i(Boolean.prototype.valueOf);if(r)var f=i(BigInt.prototype.valueOf);if(s)var d=i(Symbol.prototype.valueOf);function p(q,X){if(typeof q!="object")return!1;try{return X(q),!0}catch{return!1}}l.isArgumentsObject=e,l.isGeneratorFunction=t,l.isTypedArray=o;function y(q){return typeof Promise<"u"&&q instanceof Promise||q!==null&&typeof q=="object"&&typeof q.then=="function"&&typeof q.catch=="function"}l.isPromise=y;function m(q){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(q):o(q)||_(q)}l.isArrayBufferView=m;function v(q){return n(q)==="Uint8Array"}l.isUint8Array=v;function x(q){return n(q)==="Uint8ClampedArray"}l.isUint8ClampedArray=x;function g(q){return n(q)==="Uint16Array"}l.isUint16Array=g;function S(q){return n(q)==="Uint32Array"}l.isUint32Array=S;function C(q){return n(q)==="Int8Array"}l.isInt8Array=C;function A(q){return n(q)==="Int16Array"}l.isInt16Array=A;function b(q){return n(q)==="Int32Array"}l.isInt32Array=b;function N(q){return n(q)==="Float32Array"}l.isFloat32Array=N;function R(q){return n(q)==="Float64Array"}l.isFloat64Array=R;function P(q){return n(q)==="BigInt64Array"}l.isBigInt64Array=P;function k(q){return n(q)==="BigUint64Array"}l.isBigUint64Array=k;function D(q){return a(q)==="[object Map]"}D.working=typeof Map<"u"&&D(new Map);function H(q){return typeof Map>"u"?!1:D.working?D(q):q instanceof Map}l.isMap=H;function J(q){return a(q)==="[object Set]"}J.working=typeof Set<"u"&&J(new Set);function te(q){return typeof Set>"u"?!1:J.working?J(q):q instanceof Set}l.isSet=te;function le(q){return a(q)==="[object WeakMap]"}le.working=typeof WeakMap<"u"&&le(new WeakMap);function ge(q){return typeof WeakMap>"u"?!1:le.working?le(q):q instanceof WeakMap}l.isWeakMap=ge;function ce(q){return a(q)==="[object WeakSet]"}ce.working=typeof WeakSet<"u"&&ce(new WeakSet);function ee(q){return ce(q)}l.isWeakSet=ee;function G(q){return a(q)==="[object ArrayBuffer]"}G.working=typeof ArrayBuffer<"u"&&G(new ArrayBuffer);function Q(q){return typeof ArrayBuffer>"u"?!1:G.working?G(q):q instanceof ArrayBuffer}l.isArrayBuffer=Q;function ie(q){return a(q)==="[object DataView]"}ie.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&ie(new DataView(new ArrayBuffer(1),0,1));function _(q){return typeof DataView>"u"?!1:ie.working?ie(q):q instanceof DataView}l.isDataView=_;var E=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function T(q){return a(q)==="[object SharedArrayBuffer]"}function w(q){return typeof E>"u"?!1:(typeof T.working>"u"&&(T.working=T(new E)),T.working?T(q):q instanceof E)}l.isSharedArrayBuffer=w;function F(q){return a(q)==="[object AsyncFunction]"}l.isAsyncFunction=F;function O(q){return a(q)==="[object Map Iterator]"}l.isMapIterator=O;function I(q){return a(q)==="[object Set Iterator]"}l.isSetIterator=I;function j(q){return a(q)==="[object Generator]"}l.isGeneratorObject=j;function $(q){return a(q)==="[object WebAssembly.Module]"}l.isWebAssemblyCompiledModule=$;function W(q){return p(q,c)}l.isNumberObject=W;function L(q){return p(q,u)}l.isStringObject=L;function M(q){return p(q,h)}l.isBooleanObject=M;function U(q){return r&&p(q,f)}l.isBigIntObject=U;function Y(q){return s&&p(q,d)}l.isSymbolObject=Y;function re(q){return W(q)||L(q)||M(q)||U(q)||Y(q)}l.isBoxedPrimitive=re;function ne(q){return typeof Uint8Array<"u"&&(Q(q)||w(q))}l.isAnyArrayBuffer=ne,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(q){Object.defineProperty(l,q,{enumerable:!1,value:function(){throw new Error(q+" is not supported in userland")}})})}(Ko)),Ko}var Ys,wu;function N0(){return wu||(wu=1,Ys=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),Ys}var lo={exports:{}},Ou;function R0(){return Ou||(Ou=1,typeof Object.create=="function"?lo.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:lo.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),lo.exports}var Fu;function ri(){return Fu||(Fu=1,function(l){var e={},t=Object.getOwnPropertyDescriptors||function(E){for(var T=Object.keys(E),w={},F=0;F<T.length;F++)w[T[F]]=Object.getOwnPropertyDescriptor(E,T[F]);return w},n=/%[sdj%]/g;l.format=function(_){if(!A(_)){for(var E=[],T=0;T<arguments.length;T++)E.push(s(arguments[T]));return E.join(" ")}for(var T=1,w=arguments,F=w.length,O=String(_).replace(n,function(j){if(j==="%%")return"%";if(T>=F)return j;switch(j){case"%s":return String(w[T++]);case"%d":return Number(w[T++]);case"%j":try{return JSON.stringify(w[T++])}catch{return"[Circular]"}default:return j}}),I=w[T];T<F;I=w[++T])g(I)||!P(I)?O+=" "+I:O+=" "+s(I);return O},l.deprecate=function(_,E){if(typeof process<"u"&&process.noDeprecation===!0)return _;if(typeof process>"u")return function(){return l.deprecate(_,E).apply(this,arguments)};var T=!1;function w(){if(!T){if(process.throwDeprecation)throw new Error(E);process.traceDeprecation?console.trace(E):console.error(E),T=!0}return _.apply(this,arguments)}return w};var o={},i=/^$/;if(e.NODE_DEBUG){var r=e.NODE_DEBUG;r=r.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),i=new RegExp("^"+r+"$","i")}l.debuglog=function(_){if(_=_.toUpperCase(),!o[_])if(i.test(_)){var E=process.pid;o[_]=function(){var T=l.format.apply(l,arguments);console.error("%s %d: %s",_,E,T)}}else o[_]=function(){};return o[_]};function s(_,E){var T={seen:[],stylize:c};return arguments.length>=3&&(T.depth=arguments[2]),arguments.length>=4&&(T.colors=arguments[3]),x(E)?T.showHidden=E:E&&l._extend(T,E),N(T.showHidden)&&(T.showHidden=!1),N(T.depth)&&(T.depth=2),N(T.colors)&&(T.colors=!1),N(T.customInspect)&&(T.customInspect=!0),T.colors&&(T.stylize=a),h(T,_,T.depth)}l.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function a(_,E){var T=s.styles[E];return T?"\x1B["+s.colors[T][0]+"m"+_+"\x1B["+s.colors[T][1]+"m":_}function c(_,E){return _}function u(_){var E={};return _.forEach(function(T,w){E[T]=!0}),E}function h(_,E,T){if(_.customInspect&&E&&H(E.inspect)&&E.inspect!==l.inspect&&!(E.constructor&&E.constructor.prototype===E)){var w=E.inspect(T,_);return A(w)||(w=h(_,w,T)),w}var F=f(_,E);if(F)return F;var O=Object.keys(E),I=u(O);if(_.showHidden&&(O=Object.getOwnPropertyNames(E)),D(E)&&(O.indexOf("message")>=0||O.indexOf("description")>=0))return d(E);if(O.length===0){if(H(E)){var j=E.name?": "+E.name:"";return _.stylize("[Function"+j+"]","special")}if(R(E))return _.stylize(RegExp.prototype.toString.call(E),"regexp");if(k(E))return _.stylize(Date.prototype.toString.call(E),"date");if(D(E))return d(E)}var $="",W=!1,L=["{","}"];if(v(E)&&(W=!0,L=["[","]"]),H(E)){var M=E.name?": "+E.name:"";$=" [Function"+M+"]"}if(R(E)&&($=" "+RegExp.prototype.toString.call(E)),k(E)&&($=" "+Date.prototype.toUTCString.call(E)),D(E)&&($=" "+d(E)),O.length===0&&(!W||E.length==0))return L[0]+$+L[1];if(T<0)return R(E)?_.stylize(RegExp.prototype.toString.call(E),"regexp"):_.stylize("[Object]","special");_.seen.push(E);var U;return W?U=p(_,E,T,I,O):U=O.map(function(Y){return y(_,E,T,I,Y,W)}),_.seen.pop(),m(U,$,L)}function f(_,E){if(N(E))return _.stylize("undefined","undefined");if(A(E)){var T="'"+JSON.stringify(E).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return _.stylize(T,"string")}if(C(E))return _.stylize(""+E,"number");if(x(E))return _.stylize(""+E,"boolean");if(g(E))return _.stylize("null","null")}function d(_){return"["+Error.prototype.toString.call(_)+"]"}function p(_,E,T,w,F){for(var O=[],I=0,j=E.length;I<j;++I)ee(E,String(I))?O.push(y(_,E,T,w,String(I),!0)):O.push("");return F.forEach(function($){$.match(/^\d+$/)||O.push(y(_,E,T,w,$,!0))}),O}function y(_,E,T,w,F,O){var I,j,$;if($=Object.getOwnPropertyDescriptor(E,F)||{value:E[F]},$.get?$.set?j=_.stylize("[Getter/Setter]","special"):j=_.stylize("[Getter]","special"):$.set&&(j=_.stylize("[Setter]","special")),ee(w,F)||(I="["+F+"]"),j||(_.seen.indexOf($.value)<0?(g(T)?j=h(_,$.value,null):j=h(_,$.value,T-1),j.indexOf(`
`)>-1&&(O?j=j.split(`
`).map(function(W){return"  "+W}).join(`
`).slice(2):j=`
`+j.split(`
`).map(function(W){return"   "+W}).join(`
`))):j=_.stylize("[Circular]","special")),N(I)){if(O&&F.match(/^\d+$/))return j;I=JSON.stringify(""+F),I.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(I=I.slice(1,-1),I=_.stylize(I,"name")):(I=I.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),I=_.stylize(I,"string"))}return I+": "+j}function m(_,E,T){var w=_.reduce(function(F,O){return O.indexOf(`
`)>=0,F+O.replace(/\u001b\[\d\d?m/g,"").length+1},0);return w>60?T[0]+(E===""?"":E+`
 `)+" "+_.join(`,
  `)+" "+T[1]:T[0]+E+" "+_.join(", ")+" "+T[1]}l.types=b0();function v(_){return Array.isArray(_)}l.isArray=v;function x(_){return typeof _=="boolean"}l.isBoolean=x;function g(_){return _===null}l.isNull=g;function S(_){return _==null}l.isNullOrUndefined=S;function C(_){return typeof _=="number"}l.isNumber=C;function A(_){return typeof _=="string"}l.isString=A;function b(_){return typeof _=="symbol"}l.isSymbol=b;function N(_){return _===void 0}l.isUndefined=N;function R(_){return P(_)&&te(_)==="[object RegExp]"}l.isRegExp=R,l.types.isRegExp=R;function P(_){return typeof _=="object"&&_!==null}l.isObject=P;function k(_){return P(_)&&te(_)==="[object Date]"}l.isDate=k,l.types.isDate=k;function D(_){return P(_)&&(te(_)==="[object Error]"||_ instanceof Error)}l.isError=D,l.types.isNativeError=D;function H(_){return typeof _=="function"}l.isFunction=H;function J(_){return _===null||typeof _=="boolean"||typeof _=="number"||typeof _=="string"||typeof _=="symbol"||typeof _>"u"}l.isPrimitive=J,l.isBuffer=N0();function te(_){return Object.prototype.toString.call(_)}function le(_){return _<10?"0"+_.toString(10):_.toString(10)}var ge=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ce(){var _=new Date,E=[le(_.getHours()),le(_.getMinutes()),le(_.getSeconds())].join(":");return[_.getDate(),ge[_.getMonth()],E].join(" ")}l.log=function(){console.log("%s - %s",ce(),l.format.apply(l,arguments))},l.inherits=R0(),l._extend=function(_,E){if(!E||!P(E))return _;for(var T=Object.keys(E),w=T.length;w--;)_[T[w]]=E[T[w]];return _};function ee(_,E){return Object.prototype.hasOwnProperty.call(_,E)}var G=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;l.promisify=function(E){if(typeof E!="function")throw new TypeError('The "original" argument must be of type Function');if(G&&E[G]){var T=E[G];if(typeof T!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(T,G,{value:T,enumerable:!1,writable:!1,configurable:!0}),T}function T(){for(var w,F,O=new Promise(function($,W){w=$,F=W}),I=[],j=0;j<arguments.length;j++)I.push(arguments[j]);I.push(function($,W){$?F($):w(W)});try{E.apply(this,I)}catch($){F($)}return O}return Object.setPrototypeOf(T,Object.getPrototypeOf(E)),G&&Object.defineProperty(T,G,{value:T,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(T,t(E))},l.promisify.custom=G;function Q(_,E){if(!_){var T=new Error("Promise was rejected with a falsy value");T.reason=_,_=T}return E(_)}function ie(_){if(typeof _!="function")throw new TypeError('The "original" argument must be of type Function');function E(){for(var T=[],w=0;w<arguments.length;w++)T.push(arguments[w]);var F=T.pop();if(typeof F!="function")throw new TypeError("The last argument must be of type Function");var O=this,I=function(){return F.apply(O,arguments)};_.apply(this,T).then(function(j){process.nextTick(I.bind(null,null,j))},function(j){process.nextTick(Q.bind(null,j,I))})}return Object.setPrototypeOf(E,Object.getPrototypeOf(_)),Object.defineProperties(E,t(_)),E}l.callbackify=ie}(Xo)),Xo}var Pu;function Cd(){if(Pu)return Yo;Pu=1;function l(x){"@babel/helpers - typeof";return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(x)}function e(x,g,S){return Object.defineProperty(x,"prototype",{writable:!1}),x}function t(x,g){if(!(x instanceof g))throw new TypeError("Cannot call a class as a function")}function n(x,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(g&&g.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),Object.defineProperty(x,"prototype",{writable:!1}),g&&o(x,g)}function o(x,g){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(C,A){return C.__proto__=A,C},o(x,g)}function i(x){var g=a();return function(){var C=c(x),A;if(g){var b=c(this).constructor;A=Reflect.construct(C,arguments,b)}else A=C.apply(this,arguments);return r(this,A)}}function r(x,g){if(g&&(l(g)==="object"||typeof g=="function"))return g;if(g!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s(x)}function s(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x}function a(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function c(x){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(S){return S.__proto__||Object.getPrototypeOf(S)},c(x)}var u={},h,f;function d(x,g,S){S||(S=Error);function C(b,N,R){return typeof g=="string"?g:g(b,N,R)}var A=function(b){n(R,b);var N=i(R);function R(P,k,D){var H;return t(this,R),H=N.call(this,C(P,k,D)),H.code=x,H}return e(R)}(S);u[x]=A}function p(x,g){if(Array.isArray(x)){var S=x.length;return x=x.map(function(C){return String(C)}),S>2?"one of ".concat(g," ").concat(x.slice(0,S-1).join(", "),", or ")+x[S-1]:S===2?"one of ".concat(g," ").concat(x[0]," or ").concat(x[1]):"of ".concat(g," ").concat(x[0])}else return"of ".concat(g," ").concat(String(x))}function y(x,g,S){return x.substr(0,g.length)===g}function m(x,g,S){return(S===void 0||S>x.length)&&(S=x.length),x.substring(S-g.length,S)===g}function v(x,g,S){return typeof S!="number"&&(S=0),S+g.length>x.length?!1:x.indexOf(g,S)!==-1}return d("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),d("ERR_INVALID_ARG_TYPE",function(x,g,S){h===void 0&&(h=Ve()),h(typeof x=="string","'name' must be a string");var C;typeof g=="string"&&y(g,"not ")?(C="must not be",g=g.replace(/^not /,"")):C="must be";var A;if(m(x," argument"))A="The ".concat(x," ").concat(C," ").concat(p(g,"type"));else{var b=v(x,".")?"property":"argument";A='The "'.concat(x,'" ').concat(b," ").concat(C," ").concat(p(g,"type"))}return A+=". Received type ".concat(l(S)),A},TypeError),d("ERR_INVALID_ARG_VALUE",function(x,g){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";f===void 0&&(f=ri());var C=f.inspect(g);return C.length>128&&(C="".concat(C.slice(0,128),"...")),"The argument '".concat(x,"' ").concat(S,". Received ").concat(C)},TypeError),d("ERR_INVALID_RETURN_VALUE",function(x,g,S){var C;return S&&S.constructor&&S.constructor.name?C="instance of ".concat(S.constructor.name):C="type ".concat(l(S)),"Expected ".concat(x,' to be returned from the "').concat(g,'"')+" function but got ".concat(C,".")},TypeError),d("ERR_MISSING_ARGS",function(){for(var x=arguments.length,g=new Array(x),S=0;S<x;S++)g[S]=arguments[S];h===void 0&&(h=Ve()),h(g.length>0,"At least one arg needs to be specified");var C="The ",A=g.length;switch(g=g.map(function(b){return'"'.concat(b,'"')}),A){case 1:C+="".concat(g[0]," argument");break;case 2:C+="".concat(g[0]," and ").concat(g[1]," arguments");break;default:C+=g.slice(0,A-1).join(", "),C+=", and ".concat(g[A-1]," arguments");break}return"".concat(C," must be specified")},TypeError),Yo.codes=u,Yo}var Xs,Iu;function w0(){if(Iu)return Xs;Iu=1;function l(ee,G){var Q=Object.keys(ee);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(ee);G&&(ie=ie.filter(function(_){return Object.getOwnPropertyDescriptor(ee,_).enumerable})),Q.push.apply(Q,ie)}return Q}function e(ee){for(var G=1;G<arguments.length;G++){var Q=arguments[G]!=null?arguments[G]:{};G%2?l(Object(Q),!0).forEach(function(ie){t(ee,ie,Q[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(Q)):l(Object(Q)).forEach(function(ie){Object.defineProperty(ee,ie,Object.getOwnPropertyDescriptor(Q,ie))})}return ee}function t(ee,G,Q){return G=r(G),G in ee?Object.defineProperty(ee,G,{value:Q,enumerable:!0,configurable:!0,writable:!0}):ee[G]=Q,ee}function n(ee,G){if(!(ee instanceof G))throw new TypeError("Cannot call a class as a function")}function o(ee,G){for(var Q=0;Q<G.length;Q++){var ie=G[Q];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(ee,r(ie.key),ie)}}function i(ee,G,Q){return G&&o(ee.prototype,G),Object.defineProperty(ee,"prototype",{writable:!1}),ee}function r(ee){var G=s(ee,"string");return x(G)==="symbol"?G:String(G)}function s(ee,G){if(x(ee)!=="object"||ee===null)return ee;var Q=ee[Symbol.toPrimitive];if(Q!==void 0){var ie=Q.call(ee,G);if(x(ie)!=="object")return ie;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ee)}function a(ee,G){if(typeof G!="function"&&G!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(G&&G.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),Object.defineProperty(ee,"prototype",{writable:!1}),G&&m(ee,G)}function c(ee){var G=p();return function(){var ie=v(ee),_;if(G){var E=v(this).constructor;_=Reflect.construct(ie,arguments,E)}else _=ie.apply(this,arguments);return u(this,_)}}function u(ee,G){if(G&&(x(G)==="object"||typeof G=="function"))return G;if(G!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(ee)}function h(ee){if(ee===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee}function f(ee){var G=typeof Map=="function"?new Map:void 0;return f=function(ie){if(ie===null||!y(ie))return ie;if(typeof ie!="function")throw new TypeError("Super expression must either be null or a function");if(typeof G<"u"){if(G.has(ie))return G.get(ie);G.set(ie,_)}function _(){return d(ie,arguments,v(this).constructor)}return _.prototype=Object.create(ie.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),m(_,ie)},f(ee)}function d(ee,G,Q){return p()?d=Reflect.construct.bind():d=function(_,E,T){var w=[null];w.push.apply(w,E);var F=Function.bind.apply(_,w),O=new F;return T&&m(O,T.prototype),O},d.apply(null,arguments)}function p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y(ee){return Function.toString.call(ee).indexOf("[native code]")!==-1}function m(ee,G){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ie,_){return ie.__proto__=_,ie},m(ee,G)}function v(ee){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Q){return Q.__proto__||Object.getPrototypeOf(Q)},v(ee)}function x(ee){"@babel/helpers - typeof";return x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},x(ee)}var g=ri(),S=g.inspect,C=Cd(),A=C.codes.ERR_INVALID_ARG_TYPE;function b(ee,G,Q){return(Q===void 0||Q>ee.length)&&(Q=ee.length),ee.substring(Q-G.length,Q)===G}function N(ee,G){if(G=Math.floor(G),ee.length==0||G==0)return"";var Q=ee.length*G;for(G=Math.floor(Math.log(G)/Math.log(2));G;)ee+=ee,G--;return ee+=ee.substring(0,Q-ee.length),ee}var R="",P="",k="",D="",H={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},J=10;function te(ee){var G=Object.keys(ee),Q=Object.create(Object.getPrototypeOf(ee));return G.forEach(function(ie){Q[ie]=ee[ie]}),Object.defineProperty(Q,"message",{value:ee.message}),Q}function le(ee){return S(ee,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function ge(ee,G,Q){var ie="",_="",E=0,T="",w=!1,F=le(ee),O=F.split(`
`),I=le(G).split(`
`),j=0,$="";if(Q==="strictEqual"&&x(ee)==="object"&&x(G)==="object"&&ee!==null&&G!==null&&(Q="strictEqualObject"),O.length===1&&I.length===1&&O[0]!==I[0]){var W=O[0].length+I[0].length;if(W<=J){if((x(ee)!=="object"||ee===null)&&(x(G)!=="object"||G===null)&&(ee!==0||G!==0))return"".concat(H[Q],`

`)+"".concat(O[0]," !== ").concat(I[0],`
`)}else if(Q!=="strictEqualObject"){var L=process.stderr&&process.stderr.isTTY?process.stderr.columns:80;if(W<L){for(;O[0][j]===I[0][j];)j++;j>2&&($=`
  `.concat(N(" ",j),"^"),j=0)}}}for(var M=O[O.length-1],U=I[I.length-1];M===U&&(j++<2?T=`
  `.concat(M).concat(T):ie=M,O.pop(),I.pop(),!(O.length===0||I.length===0));)M=O[O.length-1],U=I[I.length-1];var Y=Math.max(O.length,I.length);if(Y===0){var re=F.split(`
`);if(re.length>30)for(re[26]="".concat(R,"...").concat(D);re.length>27;)re.pop();return"".concat(H.notIdentical,`

`).concat(re.join(`
`),`
`)}j>3&&(T=`
`.concat(R,"...").concat(D).concat(T),w=!0),ie!==""&&(T=`
  `.concat(ie).concat(T),ie="");var ne=0,q=H[Q]+`
`.concat(P,"+ actual").concat(D," ").concat(k,"- expected").concat(D),X=" ".concat(R,"...").concat(D," Lines skipped");for(j=0;j<Y;j++){var he=j-E;if(O.length<j+1)he>1&&j>2&&(he>4?(_+=`
`.concat(R,"...").concat(D),w=!0):he>3&&(_+=`
  `.concat(I[j-2]),ne++),_+=`
  `.concat(I[j-1]),ne++),E=j,ie+=`
`.concat(k,"-").concat(D," ").concat(I[j]),ne++;else if(I.length<j+1)he>1&&j>2&&(he>4?(_+=`
`.concat(R,"...").concat(D),w=!0):he>3&&(_+=`
  `.concat(O[j-2]),ne++),_+=`
  `.concat(O[j-1]),ne++),E=j,_+=`
`.concat(P,"+").concat(D," ").concat(O[j]),ne++;else{var Ne=I[j],Re=O[j],z=Re!==Ne&&(!b(Re,",")||Re.slice(0,-1)!==Ne);z&&b(Ne,",")&&Ne.slice(0,-1)===Re&&(z=!1,Re+=","),z?(he>1&&j>2&&(he>4?(_+=`
`.concat(R,"...").concat(D),w=!0):he>3&&(_+=`
  `.concat(O[j-2]),ne++),_+=`
  `.concat(O[j-1]),ne++),E=j,_+=`
`.concat(P,"+").concat(D," ").concat(Re),ie+=`
`.concat(k,"-").concat(D," ").concat(Ne),ne+=2):(_+=ie,ie="",(he===1||j===0)&&(_+=`
  `.concat(Re),ne++))}if(ne>20&&j<Y-2)return"".concat(q).concat(X,`
`).concat(_,`
`).concat(R,"...").concat(D).concat(ie,`
`)+"".concat(R,"...").concat(D)}return"".concat(q).concat(w?X:"",`
`).concat(_).concat(ie).concat(T).concat($)}var ce=function(ee,G){a(ie,ee);var Q=c(ie);function ie(_){var E;if(n(this,ie),x(_)!=="object"||_===null)throw new A("options","Object",_);var T=_.message,w=_.operator,F=_.stackStartFn,O=_.actual,I=_.expected,j=Error.stackTraceLimit;if(Error.stackTraceLimit=0,T!=null)E=Q.call(this,String(T));else if(process.stderr&&process.stderr.isTTY&&(process.stderr&&process.stderr.getColorDepth&&process.stderr.getColorDepth()!==1?(R="\x1B[34m",P="\x1B[32m",D="\x1B[39m",k="\x1B[31m"):(R="",P="",D="",k="")),x(O)==="object"&&O!==null&&x(I)==="object"&&I!==null&&"stack"in O&&O instanceof Error&&"stack"in I&&I instanceof Error&&(O=te(O),I=te(I)),w==="deepStrictEqual"||w==="strictEqual")E=Q.call(this,ge(O,I,w));else if(w==="notDeepStrictEqual"||w==="notStrictEqual"){var $=H[w],W=le(O).split(`
`);if(w==="notStrictEqual"&&x(O)==="object"&&O!==null&&($=H.notStrictEqualObject),W.length>30)for(W[26]="".concat(R,"...").concat(D);W.length>27;)W.pop();W.length===1?E=Q.call(this,"".concat($," ").concat(W[0])):E=Q.call(this,"".concat($,`

`).concat(W.join(`
`),`
`))}else{var L=le(O),M="",U=H[w];w==="notDeepEqual"||w==="notEqual"?(L="".concat(H[w],`

`).concat(L),L.length>1024&&(L="".concat(L.slice(0,1021),"..."))):(M="".concat(le(I)),L.length>512&&(L="".concat(L.slice(0,509),"...")),M.length>512&&(M="".concat(M.slice(0,509),"...")),w==="deepEqual"||w==="equal"?L="".concat(U,`

`).concat(L,`

should equal

`):M=" ".concat(w," ").concat(M)),E=Q.call(this,"".concat(L).concat(M))}return Error.stackTraceLimit=j,E.generatedMessage=!T,Object.defineProperty(h(E),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),E.code="ERR_ASSERTION",E.actual=O,E.expected=I,E.operator=w,Error.captureStackTrace&&Error.captureStackTrace(h(E),F),E.stack,E.name="AssertionError",u(E)}return i(ie,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:G,value:function(E,T){return S(this,e(e({},T),{},{customInspect:!1,depth:0}))}}]),ie}(f(Error),S.custom);return Xs=ce,Xs}var Ks,Du;function Ed(){if(Du)return Ks;Du=1;var l=Object.prototype.toString;return Ks=function(t){var n=l.call(t),o=n==="[object Arguments]";return o||(o=n!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&l.call(t.callee)==="[object Function]"),o},Ks}var Qs,Lu;function O0(){if(Lu)return Qs;Lu=1;var l;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n=Ed(),o=Object.prototype.propertyIsEnumerable,i=!o.call({toString:null},"toString"),r=o.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=function(f){var d=f.constructor;return d&&d.prototype===f},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},u=function(){if(typeof window>"u")return!1;for(var f in window)try{if(!c["$"+f]&&e.call(window,f)&&window[f]!==null&&typeof window[f]=="object")try{a(window[f])}catch{return!0}}catch{return!0}return!1}(),h=function(f){if(typeof window>"u"||!u)return a(f);try{return a(f)}catch{return!1}};l=function(d){var p=d!==null&&typeof d=="object",y=t.call(d)==="[object Function]",m=n(d),v=p&&t.call(d)==="[object String]",x=[];if(!p&&!y&&!m)throw new TypeError("Object.keys called on a non-object");var g=r&&y;if(v&&d.length>0&&!e.call(d,0))for(var S=0;S<d.length;++S)x.push(String(S));if(m&&d.length>0)for(var C=0;C<d.length;++C)x.push(String(C));else for(var A in d)!(g&&A==="prototype")&&e.call(d,A)&&x.push(String(A));if(i)for(var b=h(d),N=0;N<s.length;++N)!(b&&s[N]==="constructor")&&e.call(d,s[N])&&x.push(s[N]);return x}}return Qs=l,Qs}var Js,Mu;function _d(){if(Mu)return Js;Mu=1;var l=Array.prototype.slice,e=Ed(),t=Object.keys,n=t?function(r){return t(r)}:O0(),o=Object.keys;return n.shim=function(){if(Object.keys){var r=function(){var s=Object.keys(arguments);return s&&s.length===arguments.length}(1,2);r||(Object.keys=function(a){return e(a)?o(l.call(a)):o(a)})}else Object.keys=n;return Object.keys||n},Js=n,Js}var Zs,Bu;function F0(){if(Bu)return Zs;Bu=1;var l=_d(),e=Wa()(),t=ci(),n=Ga(),o=t("Array.prototype.push"),i=t("Object.prototype.propertyIsEnumerable"),r=e?n.getOwnPropertySymbols:null;return Zs=function(a,c){if(a==null)throw new TypeError("target must be an object");var u=n(a);if(arguments.length===1)return u;for(var h=1;h<arguments.length;++h){var f=n(arguments[h]),d=l(f),p=e&&(n.getOwnPropertySymbols||r);if(p)for(var y=p(f),m=0;m<y.length;++m){var v=y[m];i(f,v)&&o(d,v)}for(var x=0;x<d.length;++x){var g=d[x];if(i(f,g)){var S=f[g];u[g]=S}}}return u},Zs}var ea,ku;function P0(){if(ku)return ea;ku=1;var l=F0(),e=function(){if(!Object.assign)return!1;for(var n="abcdefghijklmnopqrst",o=n.split(""),i={},r=0;r<o.length;++r)i[o[r]]=o[r];var s=Object.assign({},i),a="";for(var c in s)a+=c;return n!==a},t=function(){if(!Object.assign||!Object.preventExtensions)return!1;var n=Object.preventExtensions({1:2});try{Object.assign(n,"xy")}catch{return n[1]==="y"}return!1};return ea=function(){return!Object.assign||e()||t()?l:Object.assign},ea}var ta,zu;function Td(){if(zu)return ta;zu=1;var l=function(e){return e!==e};return ta=function(t,n){return t===0&&n===0?1/t===1/n:!!(t===n||l(t)&&l(n))},ta}var ra,ju;function Za(){if(ju)return ra;ju=1;var l=Td();return ra=function(){return typeof Object.is=="function"?Object.is:l},ra}var na,qu;function I0(){if(qu)return na;qu=1;var l=Ja(),e=wo(),t=e(l("String.prototype.indexOf"));return na=function(o,i){var r=l(o,!!i);return typeof r=="function"&&t(o,".prototype.")>-1?e(r):r},na}var ia,Uu;function Oo(){if(Uu)return ia;Uu=1;var l=_d(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",t=Object.prototype.toString,n=Array.prototype.concat,o=vd(),i=function(c){return typeof c=="function"&&t.call(c)==="[object Function]"},r=Sd()(),s=function(c,u,h,f){if(u in c){if(f===!0){if(c[u]===h)return}else if(!i(f)||!f())return}r?o(c,u,h,!0):o(c,u,h)},a=function(c,u){var h=arguments.length>2?arguments[2]:{},f=l(u);e&&(f=n.call(f,Object.getOwnPropertySymbols(u)));for(var d=0;d<f.length;d+=1)s(c,f[d],u[f[d]],h[f[d]])};return a.supportsDescriptors=!!r,ia=a,ia}var oa,Hu;function D0(){if(Hu)return oa;Hu=1;var l=Za(),e=Oo();return oa=function(){var n=l();return e(Object,{is:n},{is:function(){return Object.is!==n}}),n},oa}var sa,$u;function L0(){if($u)return sa;$u=1;var l=Oo(),e=wo(),t=Td(),n=Za(),o=D0(),i=e(n(),Object);return l(i,{getPolyfill:n,implementation:t,shim:o}),sa=i,sa}var aa,Vu;function bd(){return Vu||(Vu=1,aa=function(e){return e!==e}),aa}var la,Wu;function Nd(){if(Wu)return la;Wu=1;var l=bd();return la=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:l},la}var ua,Gu;function M0(){if(Gu)return ua;Gu=1;var l=Oo(),e=Nd();return ua=function(){var n=e();return l(Number,{isNaN:n},{isNaN:function(){return Number.isNaN!==n}}),n},ua}var ca,Yu;function B0(){if(Yu)return ca;Yu=1;var l=wo(),e=Oo(),t=bd(),n=Nd(),o=M0(),i=l(n(),Number);return e(i,{getPolyfill:n,implementation:t,shim:o}),ca=i,ca}var ha,Xu;function k0(){if(Xu)return ha;Xu=1;function l(z,V){return i(z)||o(z,V)||t(z,V)||e()}function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t(z,V){if(z){if(typeof z=="string")return n(z,V);var ae=Object.prototype.toString.call(z).slice(8,-1);if(ae==="Object"&&z.constructor&&(ae=z.constructor.name),ae==="Map"||ae==="Set")return Array.from(z);if(ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ae))return n(z,V)}}function n(z,V){(V==null||V>z.length)&&(V=z.length);for(var ae=0,pe=new Array(V);ae<V;ae++)pe[ae]=z[ae];return pe}function o(z,V){var ae=z==null?null:typeof Symbol<"u"&&z[Symbol.iterator]||z["@@iterator"];if(ae!=null){var pe,me,Te,Se,we=[],Oe=!0,ze=!1;try{if(Te=(ae=ae.call(z)).next,V!==0)for(;!(Oe=(pe=Te.call(ae)).done)&&(we.push(pe.value),we.length!==V);Oe=!0);}catch(K){ze=!0,me=K}finally{try{if(!Oe&&ae.return!=null&&(Se=ae.return(),Object(Se)!==Se))return}finally{if(ze)throw me}}return we}}function i(z){if(Array.isArray(z))return z}function r(z){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},r(z)}var s=/a/g.flags!==void 0,a=function(V){var ae=[];return V.forEach(function(pe){return ae.push(pe)}),ae},c=function(V){var ae=[];return V.forEach(function(pe,me){return ae.push([me,pe])}),ae},u=Object.is?Object.is:L0(),h=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},f=Number.isNaN?Number.isNaN:B0();function d(z){return z.call.bind(z)}var p=d(Object.prototype.hasOwnProperty),y=d(Object.prototype.propertyIsEnumerable),m=d(Object.prototype.toString),v=ri().types,x=v.isAnyArrayBuffer,g=v.isArrayBufferView,S=v.isDate,C=v.isMap,A=v.isRegExp,b=v.isSet,N=v.isNativeError,R=v.isBoxedPrimitive,P=v.isNumberObject,k=v.isStringObject,D=v.isBooleanObject,H=v.isBigIntObject,J=v.isSymbolObject,te=v.isFloat32Array,le=v.isFloat64Array;function ge(z){if(z.length===0||z.length>10)return!0;for(var V=0;V<z.length;V++){var ae=z.charCodeAt(V);if(ae<48||ae>57)return!0}return z.length===10&&z>=Math.pow(2,32)}function ce(z){return Object.keys(z).filter(ge).concat(h(z).filter(Object.prototype.propertyIsEnumerable.bind(z)))}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function ee(z,V){if(z===V)return 0;for(var ae=z.length,pe=V.length,me=0,Te=Math.min(ae,pe);me<Te;++me)if(z[me]!==V[me]){ae=z[me],pe=V[me];break}return ae<pe?-1:pe<ae?1:0}var G=!0,Q=!1,ie=0,_=1,E=2,T=3;function w(z,V){return s?z.source===V.source&&z.flags===V.flags:RegExp.prototype.toString.call(z)===RegExp.prototype.toString.call(V)}function F(z,V){if(z.byteLength!==V.byteLength)return!1;for(var ae=0;ae<z.byteLength;ae++)if(z[ae]!==V[ae])return!1;return!0}function O(z,V){return z.byteLength!==V.byteLength?!1:ee(new Uint8Array(z.buffer,z.byteOffset,z.byteLength),new Uint8Array(V.buffer,V.byteOffset,V.byteLength))===0}function I(z,V){return z.byteLength===V.byteLength&&ee(new Uint8Array(z),new Uint8Array(V))===0}function j(z,V){return P(z)?P(V)&&u(Number.prototype.valueOf.call(z),Number.prototype.valueOf.call(V)):k(z)?k(V)&&String.prototype.valueOf.call(z)===String.prototype.valueOf.call(V):D(z)?D(V)&&Boolean.prototype.valueOf.call(z)===Boolean.prototype.valueOf.call(V):H(z)?H(V)&&BigInt.prototype.valueOf.call(z)===BigInt.prototype.valueOf.call(V):J(V)&&Symbol.prototype.valueOf.call(z)===Symbol.prototype.valueOf.call(V)}function $(z,V,ae,pe){if(z===V)return z!==0?!0:ae?u(z,V):!0;if(ae){if(r(z)!=="object")return typeof z=="number"&&f(z)&&f(V);if(r(V)!=="object"||z===null||V===null||Object.getPrototypeOf(z)!==Object.getPrototypeOf(V))return!1}else{if(z===null||r(z)!=="object")return V===null||r(V)!=="object"?z==V:!1;if(V===null||r(V)!=="object")return!1}var me=m(z),Te=m(V);if(me!==Te)return!1;if(Array.isArray(z)){if(z.length!==V.length)return!1;var Se=ce(z),we=ce(V);return Se.length!==we.length?!1:L(z,V,ae,pe,_,Se)}if(me==="[object Object]"&&(!C(z)&&C(V)||!b(z)&&b(V)))return!1;if(S(z)){if(!S(V)||Date.prototype.getTime.call(z)!==Date.prototype.getTime.call(V))return!1}else if(A(z)){if(!A(V)||!w(z,V))return!1}else if(N(z)||z instanceof Error){if(z.message!==V.message||z.name!==V.name)return!1}else if(g(z)){if(!ae&&(te(z)||le(z))){if(!F(z,V))return!1}else if(!O(z,V))return!1;var Oe=ce(z),ze=ce(V);return Oe.length!==ze.length?!1:L(z,V,ae,pe,ie,Oe)}else{if(b(z))return!b(V)||z.size!==V.size?!1:L(z,V,ae,pe,E);if(C(z))return!C(V)||z.size!==V.size?!1:L(z,V,ae,pe,T);if(x(z)){if(!I(z,V))return!1}else if(R(z)&&!j(z,V))return!1}return L(z,V,ae,pe,ie)}function W(z,V){return V.filter(function(ae){return y(z,ae)})}function L(z,V,ae,pe,me,Te){if(arguments.length===5){Te=Object.keys(z);var Se=Object.keys(V);if(Te.length!==Se.length)return!1}for(var we=0;we<Te.length;we++)if(!p(V,Te[we]))return!1;if(ae&&arguments.length===5){var Oe=h(z);if(Oe.length!==0){var ze=0;for(we=0;we<Oe.length;we++){var K=Oe[we];if(y(z,K)){if(!y(V,K))return!1;Te.push(K),ze++}else if(y(V,K))return!1}var xe=h(V);if(Oe.length!==xe.length&&W(V,xe).length!==ze)return!1}else{var ye=h(V);if(ye.length!==0&&W(V,ye).length!==0)return!1}}if(Te.length===0&&(me===ie||me===_&&z.length===0||z.size===0))return!0;if(pe===void 0)pe={val1:new Map,val2:new Map,position:0};else{var Ee=pe.val1.get(z);if(Ee!==void 0){var Ie=pe.val2.get(V);if(Ie!==void 0)return Ee===Ie}pe.position++}pe.val1.set(z,pe.position),pe.val2.set(V,pe.position);var Ge=he(z,V,ae,Te,pe,me);return pe.val1.delete(z),pe.val2.delete(V),Ge}function M(z,V,ae,pe){for(var me=a(z),Te=0;Te<me.length;Te++){var Se=me[Te];if($(V,Se,ae,pe))return z.delete(Se),!0}return!1}function U(z){switch(r(z)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":z=+z;case"number":if(f(z))return!1}return!0}function Y(z,V,ae){var pe=U(ae);return pe??(V.has(pe)&&!z.has(pe))}function re(z,V,ae,pe,me){var Te=U(ae);if(Te!=null)return Te;var Se=V.get(Te);return Se===void 0&&!V.has(Te)||!$(pe,Se,!1,me)?!1:!z.has(Te)&&$(pe,Se,!1,me)}function ne(z,V,ae,pe){for(var me=null,Te=a(z),Se=0;Se<Te.length;Se++){var we=Te[Se];if(r(we)==="object"&&we!==null)me===null&&(me=new Set),me.add(we);else if(!V.has(we)){if(ae||!Y(z,V,we))return!1;me===null&&(me=new Set),me.add(we)}}if(me!==null){for(var Oe=a(V),ze=0;ze<Oe.length;ze++){var K=Oe[ze];if(r(K)==="object"&&K!==null){if(!M(me,K,ae,pe))return!1}else if(!ae&&!z.has(K)&&!M(me,K,ae,pe))return!1}return me.size===0}return!0}function q(z,V,ae,pe,me,Te){for(var Se=a(z),we=0;we<Se.length;we++){var Oe=Se[we];if($(ae,Oe,me,Te)&&$(pe,V.get(Oe),me,Te))return z.delete(Oe),!0}return!1}function X(z,V,ae,pe){for(var me=null,Te=c(z),Se=0;Se<Te.length;Se++){var we=l(Te[Se],2),Oe=we[0],ze=we[1];if(r(Oe)==="object"&&Oe!==null)me===null&&(me=new Set),me.add(Oe);else{var K=V.get(Oe);if(K===void 0&&!V.has(Oe)||!$(ze,K,ae,pe)){if(ae||!re(z,V,Oe,ze,pe))return!1;me===null&&(me=new Set),me.add(Oe)}}}if(me!==null){for(var xe=c(V),ye=0;ye<xe.length;ye++){var Ee=l(xe[ye],2),Ie=Ee[0],Ge=Ee[1];if(r(Ie)==="object"&&Ie!==null){if(!q(me,z,Ie,Ge,ae,pe))return!1}else if(!ae&&(!z.has(Ie)||!$(z.get(Ie),Ge,!1,pe))&&!q(me,z,Ie,Ge,!1,pe))return!1}return me.size===0}return!0}function he(z,V,ae,pe,me,Te){var Se=0;if(Te===E){if(!ne(z,V,ae,me))return!1}else if(Te===T){if(!X(z,V,ae,me))return!1}else if(Te===_)for(;Se<z.length;Se++)if(p(z,Se)){if(!p(V,Se)||!$(z[Se],V[Se],ae,me))return!1}else{if(p(V,Se))return!1;for(var we=Object.keys(z);Se<we.length;Se++){var Oe=we[Se];if(!p(V,Oe)||!$(z[Oe],V[Oe],ae,me))return!1}return we.length===Object.keys(V).length}for(Se=0;Se<pe.length;Se++){var ze=pe[Se];if(!$(z[ze],V[ze],ae,me))return!1}return!0}function Ne(z,V){return $(z,V,Q)}function Re(z,V){return $(z,V,G)}return ha={isDeepEqual:Ne,isDeepStrictEqual:Re},ha}var Ku;function Ve(){if(Ku)return Go.exports;Ku=1;function l(E){"@babel/helpers - typeof";return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},l(E)}function e(E,T,w){return Object.defineProperty(E,"prototype",{writable:!1}),E}function t(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}var n=Cd(),o=n.codes,i=o.ERR_AMBIGUOUS_ARGUMENT,r=o.ERR_INVALID_ARG_TYPE,s=o.ERR_INVALID_ARG_VALUE,a=o.ERR_INVALID_RETURN_VALUE,c=o.ERR_MISSING_ARGS,u=w0(),h=ri(),f=h.inspect,d=ri().types,p=d.isPromise,y=d.isRegExp,m=P0()(),v=Za()(),x=I0()("RegExp.prototype.test"),g,S;function C(){var E=k0();g=E.isDeepEqual,S=E.isDeepStrictEqual}var A=!1,b=Go.exports=D,N={};function R(E){throw E.message instanceof Error?E.message:new u(E)}function P(E,T,w,F,O){var I=arguments.length,j;if(I===0)j="Failed";else if(I===1)w=E,E=void 0;else{if(A===!1){A=!0;var $=process.emitWarning?process.emitWarning:console.warn.bind(console);$("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}I===2&&(F="!=")}if(w instanceof Error)throw w;var W={actual:E,expected:T,operator:F===void 0?"fail":F,stackStartFn:O||P};w!==void 0&&(W.message=w);var L=new u(W);throw j&&(L.message=j,L.generatedMessage=!0),L}b.fail=P,b.AssertionError=u;function k(E,T,w,F){if(!w){var O=!1;if(T===0)O=!0,F="No value argument passed to `assert.ok()`";else if(F instanceof Error)throw F;var I=new u({actual:w,expected:!0,message:F,operator:"==",stackStartFn:E});throw I.generatedMessage=O,I}}function D(){for(var E=arguments.length,T=new Array(E),w=0;w<E;w++)T[w]=arguments[w];k.apply(void 0,[D,T.length].concat(T))}b.ok=D,b.equal=function E(T,w,F){if(arguments.length<2)throw new c("actual","expected");T!=w&&R({actual:T,expected:w,message:F,operator:"==",stackStartFn:E})},b.notEqual=function E(T,w,F){if(arguments.length<2)throw new c("actual","expected");T==w&&R({actual:T,expected:w,message:F,operator:"!=",stackStartFn:E})},b.deepEqual=function E(T,w,F){if(arguments.length<2)throw new c("actual","expected");g===void 0&&C(),g(T,w)||R({actual:T,expected:w,message:F,operator:"deepEqual",stackStartFn:E})},b.notDeepEqual=function E(T,w,F){if(arguments.length<2)throw new c("actual","expected");g===void 0&&C(),g(T,w)&&R({actual:T,expected:w,message:F,operator:"notDeepEqual",stackStartFn:E})},b.deepStrictEqual=function E(T,w,F){if(arguments.length<2)throw new c("actual","expected");g===void 0&&C(),S(T,w)||R({actual:T,expected:w,message:F,operator:"deepStrictEqual",stackStartFn:E})},b.notDeepStrictEqual=H;function H(E,T,w){if(arguments.length<2)throw new c("actual","expected");g===void 0&&C(),S(E,T)&&R({actual:E,expected:T,message:w,operator:"notDeepStrictEqual",stackStartFn:H})}b.strictEqual=function E(T,w,F){if(arguments.length<2)throw new c("actual","expected");v(T,w)||R({actual:T,expected:w,message:F,operator:"strictEqual",stackStartFn:E})},b.notStrictEqual=function E(T,w,F){if(arguments.length<2)throw new c("actual","expected");v(T,w)&&R({actual:T,expected:w,message:F,operator:"notStrictEqual",stackStartFn:E})};var J=e(function E(T,w,F){var O=this;t(this,E),w.forEach(function(I){I in T&&(F!==void 0&&typeof F[I]=="string"&&y(T[I])&&x(T[I],F[I])?O[I]=F[I]:O[I]=T[I])})});function te(E,T,w,F,O,I){if(!(w in E)||!S(E[w],T[w])){if(!F){var j=new J(E,O),$=new J(T,O,E),W=new u({actual:j,expected:$,operator:"deepStrictEqual",stackStartFn:I});throw W.actual=E,W.expected=T,W.operator=I.name,W}R({actual:E,expected:T,message:F,operator:I.name,stackStartFn:I})}}function le(E,T,w,F){if(typeof T!="function"){if(y(T))return x(T,E);if(arguments.length===2)throw new r("expected",["Function","RegExp"],T);if(l(E)!=="object"||E===null){var O=new u({actual:E,expected:T,message:w,operator:"deepStrictEqual",stackStartFn:F});throw O.operator=F.name,O}var I=Object.keys(T);if(T instanceof Error)I.push("name","message");else if(I.length===0)throw new s("error",T,"may not be an empty object");return g===void 0&&C(),I.forEach(function(j){typeof E[j]=="string"&&y(T[j])&&x(T[j],E[j])||te(E,T,j,w,I,F)}),!0}return T.prototype!==void 0&&E instanceof T?!0:Error.isPrototypeOf(T)?!1:T.call({},E)===!0}function ge(E){if(typeof E!="function")throw new r("fn","Function",E);try{E()}catch(T){return T}return N}function ce(E){return p(E)||E!==null&&l(E)==="object"&&typeof E.then=="function"&&typeof E.catch=="function"}function ee(E){return Promise.resolve().then(function(){var T;if(typeof E=="function"){if(T=E(),!ce(T))throw new a("instance of Promise","promiseFn",T)}else if(ce(E))T=E;else throw new r("promiseFn",["Function","Promise"],E);return Promise.resolve().then(function(){return T}).then(function(){return N}).catch(function(w){return w})})}function G(E,T,w,F){if(typeof w=="string"){if(arguments.length===4)throw new r("error",["Object","Error","Function","RegExp"],w);if(l(T)==="object"&&T!==null){if(T.message===w)throw new i("error/message",'The error message "'.concat(T.message,'" is identical to the message.'))}else if(T===w)throw new i("error/message",'The error "'.concat(T,'" is identical to the message.'));F=w,w=void 0}else if(w!=null&&l(w)!=="object"&&typeof w!="function")throw new r("error",["Object","Error","Function","RegExp"],w);if(T===N){var O="";w&&w.name&&(O+=" (".concat(w.name,")")),O+=F?": ".concat(F):".";var I=E.name==="rejects"?"rejection":"exception";R({actual:void 0,expected:w,operator:E.name,message:"Missing expected ".concat(I).concat(O),stackStartFn:E})}if(w&&!le(T,w,F,E))throw T}function Q(E,T,w,F){if(T!==N){if(typeof w=="string"&&(F=w,w=void 0),!w||le(T,w)){var O=F?": ".concat(F):".",I=E.name==="doesNotReject"?"rejection":"exception";R({actual:T,expected:w,operator:E.name,message:"Got unwanted ".concat(I).concat(O,`
`)+'Actual message: "'.concat(T&&T.message,'"'),stackStartFn:E})}throw T}}b.throws=function E(T){for(var w=arguments.length,F=new Array(w>1?w-1:0),O=1;O<w;O++)F[O-1]=arguments[O];G.apply(void 0,[E,ge(T)].concat(F))},b.rejects=function E(T){for(var w=arguments.length,F=new Array(w>1?w-1:0),O=1;O<w;O++)F[O-1]=arguments[O];return ee(T).then(function(I){return G.apply(void 0,[E,I].concat(F))})},b.doesNotThrow=function E(T){for(var w=arguments.length,F=new Array(w>1?w-1:0),O=1;O<w;O++)F[O-1]=arguments[O];Q.apply(void 0,[E,ge(T)].concat(F))},b.doesNotReject=function E(T){for(var w=arguments.length,F=new Array(w>1?w-1:0),O=1;O<w;O++)F[O-1]=arguments[O];return ee(T).then(function(I){return Q.apply(void 0,[E,I].concat(F))})},b.ifError=function E(T){if(T!=null){var w="ifError got unwanted exception: ";l(T)==="object"&&typeof T.message=="string"?T.message.length===0&&T.constructor?w+=T.constructor.name:w+=T.message:w+=f(T);var F=new u({actual:T,expected:null,operator:"ifError",message:w,stackStartFn:E}),O=T.stack;if(typeof O=="string"){var I=O.split(`
`);I.shift();for(var j=F.stack.split(`
`),$=0;$<I.length;$++){var W=j.indexOf(I[$]);if(W!==-1){j=j.slice(0,W);break}}F.stack="".concat(j.join(`
`),`
`).concat(I.join(`
`))}throw F}};function ie(E,T,w,F,O){if(!y(T))throw new r("regexp","RegExp",T);var I=O==="match";if(typeof E!="string"||x(T,E)!==I){if(w instanceof Error)throw w;var j=!w;w=w||(typeof E!="string"?'The "string" argument must be of type string. Received type '+"".concat(l(E)," (").concat(f(E),")"):(I?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(f(T),`. Input:

`).concat(f(E),`
`));var $=new u({actual:E,expected:T,message:w,operator:O,stackStartFn:F});throw $.generatedMessage=j,$}}b.match=function E(T,w,F){ie(T,w,F,E,"match")},b.doesNotMatch=function E(T,w,F){ie(T,w,F,E,"doesNotMatch")};function _(){for(var E=arguments.length,T=new Array(E),w=0;w<E;w++)T[w]=arguments[w];k.apply(void 0,[_,T.length].concat(T))}return b.strict=m(_,b,{equal:b.strictEqual,deepEqual:b.deepStrictEqual,notEqual:b.notStrictEqual,notDeepEqual:b.notDeepStrictEqual}),b.strict.strict=b.strict,Go.exports}var it={},Qu;function Z(){if(Qu)return it;Qu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(it,"__esModule",{value:!0}),it.SuppressWarnings=it.Override=it.Nullable=it.NotNull=void 0;function l(o,i,r){}it.NotNull=l;function e(o,i,r){}it.Nullable=e;function t(o,i,r){}it.Override=t;function n(o){return(i,r,s)=>{}}return it.SuppressWarnings=n,it}var fa={},Ju;function Rr(){return Ju||(Ju=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.IntStream=void 0,function(e){e.EOF=-1,e.UNKNOWN_SOURCE_NAME="<unknown>"}(l.IntStream||(l.IntStream={}))}(fa)),fa}var Zu;function z0(){if(Zu)return kr;Zu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=kr&&kr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(kr,"__esModule",{value:!0}),kr.ANTLRInputStream=void 0;const e=Ve(),t=Z(),n=Rr();let o=class{constructor(r){this.p=0,this.data=r,this.n=r.length}reset(){this.p=0}consume(){if(this.p>=this.n)throw e(this.LA(1)===n.IntStream.EOF),new Error("cannot consume EOF");this.p<this.n&&this.p++}LA(r){return r===0?0:r<0&&(r++,this.p+r-1<0)||this.p+r-1>=this.n?n.IntStream.EOF:this.data.charCodeAt(this.p+r-1)}LT(r){return this.LA(r)}get index(){return this.p}get size(){return this.n}mark(){return-1}release(r){}seek(r){if(r<=this.p){this.p=r;return}for(r=Math.min(r,this.n);this.p<r;)this.consume()}getText(r){let s=r.a,a=r.b;a>=this.n&&(a=this.n-1);let c=a-s+1;return s>=this.n?"":this.data.substr(s,c)}get sourceName(){return this.name?this.name:n.IntStream.UNKNOWN_SOURCE_NAME}toString(){return this.data}};return l([t.Override],o.prototype,"consume",null),l([t.Override],o.prototype,"LA",null),l([t.Override],o.prototype,"index",null),l([t.Override],o.prototype,"size",null),l([t.Override],o.prototype,"mark",null),l([t.Override],o.prototype,"release",null),l([t.Override],o.prototype,"seek",null),l([t.Override],o.prototype,"getText",null),l([t.Override],o.prototype,"sourceName",null),l([t.Override],o.prototype,"toString",null),kr.ANTLRInputStream=o,kr}var zr={},dt={},mi={},ec;function yr(){return ec||(ec=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=mi&&mi.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c};Object.defineProperty(l,"__esModule",{value:!0}),l.ATNState=void 0;const t=Z();let n=class Pa{constructor(){this.stateNumber=Pa.INVALID_STATE_NUMBER,this.ruleIndex=0,this.epsilonOnlyTransitions=!1,this.transitions=[],this.optimizedTransitions=this.transitions}getStateNumber(){return this.stateNumber}get nonStopStateNumber(){return this.getStateNumber()}hashCode(){return this.stateNumber}equals(i){return i instanceof Pa?this.stateNumber===i.stateNumber:!1}get isNonGreedyExitState(){return!1}toString(){return String(this.stateNumber)}getTransitions(){return this.transitions.slice(0)}get numberOfTransitions(){return this.transitions.length}addTransition(i,r){if(this.transitions.length===0)this.epsilonOnlyTransitions=i.isEpsilon;else if(this.epsilonOnlyTransitions!==i.isEpsilon)throw this.epsilonOnlyTransitions=!1,new Error("ATN state "+this.stateNumber+" has both epsilon and non-epsilon transitions.");this.transitions.splice(r!==void 0?r:this.transitions.length,0,i)}transition(i){return this.transitions[i]}setTransition(i,r){this.transitions[i]=r}removeTransition(i){return this.transitions.splice(i,1)[0]}get onlyHasEpsilonTransitions(){return this.epsilonOnlyTransitions}setRuleIndex(i){this.ruleIndex=i}get isOptimized(){return this.optimizedTransitions!==this.transitions}get numberOfOptimizedTransitions(){return this.optimizedTransitions.length}getOptimizedTransition(i){return this.optimizedTransitions[i]}addOptimizedTransition(i){this.isOptimized||(this.optimizedTransitions=new Array),this.optimizedTransitions.push(i)}setOptimizedTransition(i,r){if(!this.isOptimized)throw new Error("This ATNState is not optimized.");this.optimizedTransitions[i]=r}removeOptimizedTransition(i){if(!this.isOptimized)throw new Error("This ATNState is not optimized.");this.optimizedTransitions.splice(i,1)}};e([t.Override],n.prototype,"hashCode",null),e([t.Override],n.prototype,"equals",null),e([t.Override],n.prototype,"toString",null),l.ATNState=n,function(o){o.INVALID_STATE_NUMBER=-1}(n=l.ATNState||(l.ATNState={}))}(mi)),mi}var da={},tc;function He(){return tc||(tc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.ATNStateType=void 0,function(e){e[e.INVALID_TYPE=0]="INVALID_TYPE",e[e.BASIC=1]="BASIC",e[e.RULE_START=2]="RULE_START",e[e.BLOCK_START=3]="BLOCK_START",e[e.PLUS_BLOCK_START=4]="PLUS_BLOCK_START",e[e.STAR_BLOCK_START=5]="STAR_BLOCK_START",e[e.TOKEN_START=6]="TOKEN_START",e[e.RULE_STOP=7]="RULE_STOP",e[e.BLOCK_END=8]="BLOCK_END",e[e.STAR_LOOP_BACK=9]="STAR_LOOP_BACK",e[e.STAR_LOOP_ENTRY=10]="STAR_LOOP_ENTRY",e[e.PLUS_LOOP_BACK=11]="PLUS_LOOP_BACK",e[e.LOOP_END=12]="LOOP_END"}(l.ATNStateType||(l.ATNStateType={}))}(da)),da}var pt={},xi={},rc;function wr(){if(rc)return xi;rc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(xi,"__esModule",{value:!0}),xi.RecognitionException=void 0;let l=class extends Error{constructor(t,n,o,i){super(i),this._offendingState=-1,this._recognizer=t,this.input=n,this.ctx=o,t&&(this._offendingState=t.state)}get offendingState(){return this._offendingState}setOffendingState(t){this._offendingState=t}get expectedTokens(){if(this._recognizer)return this._recognizer.atn.getExpectedTokens(this._offendingState,this.ctx)}get context(){return this.ctx}get inputStream(){return this.input}getOffendingToken(t){if(!(t&&t!==this._recognizer))return this.offendingToken}setOffendingToken(t,n){t===this._recognizer&&(this.offendingToken=n)}get recognizer(){return this._recognizer}};return xi.RecognitionException=l,xi}var mt={},gi={},xt={},nc;function Or(){if(nc)return xt;nc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=xt&&xt.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c},e=xt&&xt.__param||function(o,i){return function(r,s){i(r,s,o)}};Object.defineProperty(xt,"__esModule",{value:!0}),xt.Transition=void 0;const t=Z();let n=class{constructor(i){if(i==null)throw new Error("target cannot be null.");this.target=i}get isEpsilon(){return!1}get label(){}};return n.serializationNames=["INVALID","EPSILON","RANGE","RULE","PREDICATE","ATOM","ACTION","SET","NOT_SET","WILDCARD","PRECEDENCE"],l([t.NotNull],n.prototype,"target",void 0),n=l([e(0,t.NotNull)],n),xt.Transition=n,xt}var ic;function el(){if(ic)return gi;ic=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(gi,"__esModule",{value:!0}),gi.AbstractPredicateTransition=void 0;const l=Or();let e=class extends l.Transition{constructor(n){super(n)}};return gi.AbstractPredicateTransition=e,gi}var jr={},gt={},qr={},pa={},oc;function je(){return oc||(oc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.MurmurHash=void 0,function(e){function n(a=0){return a}e.initialize=n;function o(a,c){c==null?c=0:typeof c=="string"?c=s(c):typeof c=="object"&&(c=c.hashCode());let m=c;return m=Math.imul(m,3432918353),m=m<<15|m>>>17,m=Math.imul(m,461845907),a=a^m,a=a<<13|a>>>19,a=Math.imul(a,5)+3864292196,a&4294967295}e.update=o;function i(a,c){return a=a^c*4,a=a^a>>>16,a=Math.imul(a,2246822507),a=a^a>>>13,a=Math.imul(a,3266489909),a=a^a>>>16,a}e.finish=i;function r(a,c=0){let u=n(c),h=0;for(let f of a)u=o(u,f),h++;return u=i(u,h),u}e.hashCode=r;function s(a){let c=a.length;if(c===0)return 0;let u=0;for(let h=0;h<c;h++){let f=a.charCodeAt(h);u=(u<<5>>>0)-u+f,u|=0}return u}}(l.MurmurHash||(l.MurmurHash={}))}(pa)),pa}var Ur={},sc;function ht(){if(sc)return Ur;sc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ur&&Ur.__decorate||function(n,o,i,r){var s=arguments.length,a=s<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,i):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,o,i,r);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.ObjectEqualityComparator=void 0;const e=Z();let t=class{hashCode(o){return o==null?0:o.hashCode()}equals(o,i){return o==null?i==null:o.equals(i)}};return t.INSTANCE=new t,l([e.Override],t.prototype,"hashCode",null),l([e.Override],t.prototype,"equals",null),Ur.ObjectEqualityComparator=t,Ur}var ac;function j0(){if(ac)return qr;ac=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=qr&&qr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(qr,"__esModule",{value:!0}),qr.DefaultEqualityComparator=void 0;const e=Z(),t=je(),n=ht();let o=class{hashCode(r){return r==null?0:typeof r=="string"||typeof r=="number"?t.MurmurHash.hashCode([r]):n.ObjectEqualityComparator.INSTANCE.hashCode(r)}equals(r,s){return r==null?s==null:typeof r=="string"||typeof r=="number"?r===s:n.ObjectEqualityComparator.INSTANCE.equals(r,s)}};return o.INSTANCE=new o,l([e.Override],o.prototype,"hashCode",null),l([e.Override],o.prototype,"equals",null),qr.DefaultEqualityComparator=o,qr}var lc;function Fr(){if(lc)return gt;lc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=gt&&gt.__decorate||function(c,u,h,f){var d=arguments.length,p=d<3?u:f===null?f=Object.getOwnPropertyDescriptor(u,h):f,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,u,h,f);else for(var m=c.length-1;m>=0;m--)(y=c[m])&&(p=(d<3?y(p):d>3?y(u,h,p):y(u,h))||p);return d>3&&p&&Object.defineProperty(u,h,p),p},e=gt&&gt.__param||function(c,u){return function(h,f){u(h,f,c)}};Object.defineProperty(gt,"__esModule",{value:!0}),gt.Array2DHashSet=void 0;const t=Ve(),n=j0(),o=Z(),i=je(),r=16,s=.75;let a=class go{constructor(u,h=r){if(this.n=0,this.threshold=Math.floor(r*s),u instanceof go){this.comparator=u.comparator,this.buckets=u.buckets.slice(0);for(let f=0;f<this.buckets.length;f++){let d=this.buckets[f];d&&(this.buckets[f]=d.slice(0))}this.n=u.n,this.threshold=u.threshold}else this.comparator=u||n.DefaultEqualityComparator.INSTANCE,this.buckets=this.createBuckets(h)}getOrAdd(u){return this.n>this.threshold&&this.expand(),this.getOrAddImpl(u)}getOrAddImpl(u){let h=this.getBucket(u),f=this.buckets[h];if(!f)return f=[u],this.buckets[h]=f,this.n++,u;for(let d of f)if(this.comparator.equals(d,u))return d;return f.push(u),this.n++,u}get(u){if(u==null)return u;let h=this.getBucket(u),f=this.buckets[h];if(f){for(let d of f)if(this.comparator.equals(d,u))return d}}getBucket(u){return this.comparator.hashCode(u)&this.buckets.length-1}hashCode(){let u=i.MurmurHash.initialize();for(let h of this.buckets)if(h!=null)for(let f of h){if(f==null)break;u=i.MurmurHash.update(u,this.comparator.hashCode(f))}return u=i.MurmurHash.finish(u,this.size),u}equals(u){return u===this?!0:!(u instanceof go)||u.size!==this.size?!1:this.containsAll(u)}expand(){let u=this.buckets,h=this.buckets.length*2,f=this.createBuckets(h);this.buckets=f,this.threshold=Math.floor(h*s);let d=this.size;for(let p of u)if(p)for(let y of p){let m=this.getBucket(y),v=this.buckets[m];v||(v=[],this.buckets[m]=v),v.push(y)}t(this.n===d)}add(u){return this.getOrAdd(u)===u}get size(){return this.n}get isEmpty(){return this.n===0}contains(u){return this.containsFast(this.asElementType(u))}containsFast(u){return u==null?!1:this.get(u)!=null}*[Symbol.iterator](){yield*this.toArray()}toArray(){const u=new Array(this.size);let h=0;for(let f of this.buckets)if(f!=null)for(let d of f){if(d==null)break;u[h++]=d}return u}containsAll(u){if(u instanceof go){let h=u;for(let f of h.buckets)if(f!=null)for(let d of f){if(d==null)break;if(!this.containsFast(this.asElementType(d)))return!1}}else for(let h of u)if(!this.containsFast(this.asElementType(h)))return!1;return!0}addAll(u){let h=!1;for(let f of u)this.getOrAdd(f)!==f&&(h=!0);return h}clear(){this.buckets=this.createBuckets(r),this.n=0,this.threshold=Math.floor(r*s)}toString(){if(this.size===0)return"{}";let u="{",h=!0;for(let f of this.buckets)if(f!=null)for(let d of f){if(d==null)break;h?h=!1:u+=", ",u+=d.toString()}return u+="}",u}toTableString(){let u="";for(let h of this.buckets){if(h==null){u+=`null
`;continue}u+="[";let f=!0;for(let d of h)f?f=!1:u+=" ",d==null?u+="_":u+=d.toString();u+=`]
`}return u}asElementType(u){return u}createBuckets(u){return new Array(u)}};return l([o.NotNull],a.prototype,"comparator",void 0),l([o.Override],a.prototype,"hashCode",null),l([o.Override],a.prototype,"equals",null),l([o.Override],a.prototype,"add",null),l([o.Override],a.prototype,"size",null),l([o.Override],a.prototype,"isEmpty",null),l([o.Override],a.prototype,"contains",null),l([e(0,o.Nullable)],a.prototype,"containsFast",null),l([o.Override],a.prototype,Symbol.iterator,null),l([o.Override],a.prototype,"toArray",null),l([o.Override],a.prototype,"containsAll",null),l([o.Override],a.prototype,"addAll",null),l([o.Override],a.prototype,"clear",null),l([o.Override],a.prototype,"toString",null),l([o.SuppressWarnings("unchecked")],a.prototype,"asElementType",null),l([o.SuppressWarnings("unchecked")],a.prototype,"createBuckets",null),gt.Array2DHashSet=a,gt}var Hr={},uc;function Fo(){if(uc)return Hr;uc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Hr&&Hr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.ArrayEqualityComparator=void 0;const e=Z(),t=je(),n=ht();let o=class{hashCode(r){return r==null?0:t.MurmurHash.hashCode(r,0)}equals(r,s){if(r==null)return s==null;if(s==null||r.length!==s.length)return!1;for(let a=0;a<r.length;a++)if(!n.ObjectEqualityComparator.INSTANCE.equals(r[a],s[a]))return!1;return!0}};return o.INSTANCE=new o,l([e.Override],o.prototype,"hashCode",null),l([e.Override],o.prototype,"equals",null),Hr.ArrayEqualityComparator=o,Hr}var Ke={},cc;function vr(){if(cc)return Ke;cc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.toCharArray=Ke.toMap=Ke.equals=Ke.join=Ke.escapeWhitespace=void 0;function l(i,r){return r?i.replace(/ /,""):i.replace(/\t/,"\\t").replace(/\n/,"\\n").replace(/\r/,"\\r")}Ke.escapeWhitespace=l;function e(i,r){let s="",a=!0;for(let c of i)a?a=!1:s+=r,s+=c;return s}Ke.join=e;function t(i,r){return i===r?!0:i===void 0||r===void 0?!1:i.equals(r)}Ke.equals=t;function n(i){let r=new Map;for(let s=0;s<i.length;s++)r.set(i[s],s);return r}Ke.toMap=n;function o(i){if(typeof i=="string"){let r=new Uint16Array(i.length);for(let s=0;s<i.length;s++)r[s]=i.charCodeAt(s);return r}else return i.toCharArray()}return Ke.toCharArray=o,Ke}var hc;function hi(){return hc||(hc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=jr&&jr.__decorate||function(f,d,p,y){var m=arguments.length,v=m<3?d:y===null?y=Object.getOwnPropertyDescriptor(d,p):y,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,d,p,y);else for(var g=f.length-1;g>=0;g--)(x=f[g])&&(v=(m<3?x(v):m>3?x(d,p,v):x(d,p))||v);return m>3&&v&&Object.defineProperty(d,p,v),v},t=jr&&jr.__param||function(f,d){return function(p,y){d(p,y,f)}};Object.defineProperty(l,"__esModule",{value:!0}),l.SemanticContext=void 0;const n=Fr(),o=Fo(),i=je(),r=Z(),s=ht(),a=vr();function c(f){let d;for(let p of f){if(d===void 0){d=p;continue}d.compareTo(p)<0&&(d=p)}return d}function u(f){let d;for(let p of f){if(d===void 0){d=p;continue}d.compareTo(p)>0&&(d=p)}return d}let h=class tt{static get NONE(){return tt._NONE===void 0&&(tt._NONE=new tt.Predicate),tt._NONE}evalPrecedence(d,p){return this}static and(d,p){if(!d||d===tt.NONE)return p;if(p===tt.NONE)return d;let y=new tt.AND(d,p);return y.opnds.length===1?y.opnds[0]:y}static or(d,p){if(!d)return p;if(d===tt.NONE||p===tt.NONE)return tt.NONE;let y=new tt.OR(d,p);return y.opnds.length===1?y.opnds[0]:y}};l.SemanticContext=h,function(f){function y(C){let A=[];for(let b=0;b<C.length;b++){let N=C[b];N instanceof f.PrecedencePredicate&&(A.push(N),C.splice(b,1),b--)}return A}class m extends f{constructor(A=-1,b=-1,N=!1){super(),this.ruleIndex=A,this.predIndex=b,this.isCtxDependent=N}eval(A,b){let N=this.isCtxDependent?b:void 0;return A.sempred(N,this.ruleIndex,this.predIndex)}hashCode(){let A=i.MurmurHash.initialize();return A=i.MurmurHash.update(A,this.ruleIndex),A=i.MurmurHash.update(A,this.predIndex),A=i.MurmurHash.update(A,this.isCtxDependent?1:0),A=i.MurmurHash.finish(A,3),A}equals(A){return A instanceof m?this===A?!0:this.ruleIndex===A.ruleIndex&&this.predIndex===A.predIndex&&this.isCtxDependent===A.isCtxDependent:!1}toString(){return"{"+this.ruleIndex+":"+this.predIndex+"}?"}}e([r.Override],m.prototype,"eval",null),e([r.Override],m.prototype,"hashCode",null),e([r.Override],m.prototype,"equals",null),e([r.Override],m.prototype,"toString",null),f.Predicate=m;class v extends f{constructor(A){super(),this.precedence=A}eval(A,b){return A.precpred(b,this.precedence)}evalPrecedence(A,b){if(A.precpred(b,this.precedence))return f.NONE}compareTo(A){return this.precedence-A.precedence}hashCode(){let A=1;return A=31*A+this.precedence,A}equals(A){return A instanceof v?this===A?!0:this.precedence===A.precedence:!1}toString(){return"{"+this.precedence+">=prec}?"}}e([r.Override],v.prototype,"eval",null),e([r.Override],v.prototype,"evalPrecedence",null),e([r.Override],v.prototype,"compareTo",null),e([r.Override],v.prototype,"hashCode",null),e([r.Override],v.prototype,"equals",null),e([r.Override],v.prototype,"toString",null),f.PrecedencePredicate=v;class x extends f{}f.Operator=x;let g=class yo extends x{constructor(A,b){super();let N=new n.Array2DHashSet(s.ObjectEqualityComparator.INSTANCE);A instanceof yo?N.addAll(A.opnds):N.add(A),b instanceof yo?N.addAll(b.opnds):N.add(b),this.opnds=N.toArray();let R=y(this.opnds),P=u(R);P&&this.opnds.push(P)}get operands(){return this.opnds}equals(A){return this===A?!0:A instanceof yo?o.ArrayEqualityComparator.INSTANCE.equals(this.opnds,A.opnds):!1}hashCode(){return i.MurmurHash.hashCode(this.opnds,40363613)}eval(A,b){for(let N of this.opnds)if(!N.eval(A,b))return!1;return!0}evalPrecedence(A,b){let N=!1,R=[];for(let k of this.opnds){let D=k.evalPrecedence(A,b);if(N=N||D!==k,D==null)return;D!==f.NONE&&R.push(D)}if(!N)return this;if(R.length===0)return f.NONE;let P=R[0];for(let k=1;k<R.length;k++)P=f.and(P,R[k]);return P}toString(){return a.join(this.opnds,"&&")}};e([r.Override],g.prototype,"operands",null),e([r.Override],g.prototype,"equals",null),e([r.Override],g.prototype,"hashCode",null),e([r.Override],g.prototype,"eval",null),e([r.Override],g.prototype,"evalPrecedence",null),e([r.Override],g.prototype,"toString",null),g=e([t(0,r.NotNull),t(1,r.NotNull)],g),f.AND=g;let S=class vo extends x{constructor(A,b){super();let N=new n.Array2DHashSet(s.ObjectEqualityComparator.INSTANCE);A instanceof vo?N.addAll(A.opnds):N.add(A),b instanceof vo?N.addAll(b.opnds):N.add(b),this.opnds=N.toArray();let R=y(this.opnds),P=c(R);P&&this.opnds.push(P)}get operands(){return this.opnds}equals(A){return this===A?!0:A instanceof vo?o.ArrayEqualityComparator.INSTANCE.equals(this.opnds,A.opnds):!1}hashCode(){return i.MurmurHash.hashCode(this.opnds,486279973)}eval(A,b){for(let N of this.opnds)if(N.eval(A,b))return!0;return!1}evalPrecedence(A,b){let N=!1,R=[];for(let k of this.opnds){let D=k.evalPrecedence(A,b);if(N=N||D!==k,D===f.NONE)return f.NONE;D&&R.push(D)}if(!N)return this;if(R.length===0)return;let P=R[0];for(let k=1;k<R.length;k++)P=f.or(P,R[k]);return P}toString(){return a.join(this.opnds,"||")}};e([r.Override],S.prototype,"operands",null),e([r.Override],S.prototype,"equals",null),e([r.Override],S.prototype,"hashCode",null),e([r.Override],S.prototype,"eval",null),e([r.Override],S.prototype,"evalPrecedence",null),e([r.Override],S.prototype,"toString",null),S=e([t(0,r.NotNull),t(1,r.NotNull)],S),f.OR=S}(h=l.SemanticContext||(l.SemanticContext={}))}(jr)),jr}var fc;function Rd(){if(fc)return mt;fc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=mt&&mt.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=mt&&mt.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(mt,"__esModule",{value:!0}),mt.PredicateTransition=void 0;const t=el(),n=Z(),o=hi();let i=class extends t.AbstractPredicateTransition{constructor(s,a,c,u){super(s),this.ruleIndex=a,this.predIndex=c,this.isCtxDependent=u}get serializationType(){return 4}get isEpsilon(){return!0}matches(s,a,c){return!1}get predicate(){return new o.SemanticContext.Predicate(this.ruleIndex,this.predIndex,this.isCtxDependent)}toString(){return"pred_"+this.ruleIndex+":"+this.predIndex}};return l([n.Override],i.prototype,"serializationType",null),l([n.Override],i.prototype,"isEpsilon",null),l([n.Override],i.prototype,"matches",null),l([n.Override,n.NotNull],i.prototype,"toString",null),i=l([e(0,n.NotNull)],i),mt.PredicateTransition=i,mt}var dc;function Po(){if(dc)return pt;dc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=pt&&pt.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=pt&&pt.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(pt,"__esModule",{value:!0}),pt.FailedPredicateException=void 0;const t=wr(),n=Z(),o=Rd();let i=class wd extends t.RecognitionException{constructor(s,a,c){super(s,s.inputStream,s.context,wd.formatMessage(a,c));let h=s.interpreter.atn.states[s.state].transition(0);h instanceof o.PredicateTransition?(this._ruleIndex=h.ruleIndex,this._predicateIndex=h.predIndex):(this._ruleIndex=0,this._predicateIndex=0),this._predicate=a,super.setOffendingToken(s,s.currentToken)}get ruleIndex(){return this._ruleIndex}get predicateIndex(){return this._predicateIndex}get predicate(){return this._predicate}static formatMessage(s,a){return a||`failed predicate: {${s}}?`}};return l([n.NotNull],i,"formatMessage",null),i=l([e(0,n.NotNull)],i),pt.FailedPredicateException=i,pt}var yt={},pc;function Io(){if(pc)return yt;pc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=yt&&yt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=yt&&yt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(yt,"__esModule",{value:!0}),yt.InputMismatchException=void 0;const t=wr(),n=Z();let o=class extends t.RecognitionException{constructor(r,s,a){a===void 0&&(a=r.context),super(r,r.inputStream,a),s!==void 0&&this.setOffendingState(s),this.setOffendingToken(r,r.currentToken)}};return o=l([e(0,n.NotNull)],o),yt.InputMismatchException=o,yt}var vt={},$r={},ma={},mc;function tl(){return mc||(mc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.Arrays=void 0,function(e){function t(i,r,s,a){return n(i,s!==void 0?s:0,a!==void 0?a:i.length,r)}e.binarySearch=t;function n(i,r,s,a){let c=r,u=s-1;for(;c<=u;){let h=c+u>>>1,f=i[h];if(f<a)c=h+1;else if(f>a)u=h-1;else return h}return-(c+1)}function o(i){let r="[",s=!0;for(let a of i)s?s=!1:r+=", ",a===null?r+="null":a===void 0?r+="undefined":r+=a;return r+="]",r}e.toString=o}(l.Arrays||(l.Arrays={}))}(ma)),ma}var xc;function rl(){if(xc)return $r;xc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=$r&&$r.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f};Object.defineProperty($r,"__esModule",{value:!0}),$r.IntegerList=void 0;const e=tl(),t=Z(),n=new Int32Array(0),o=4,i=(1<<31>>>0)-1-8;let r=class So{constructor(a){if(!a)this._data=n,this._size=0;else if(a instanceof So)this._data=a._data.slice(0),this._size=a._size;else if(typeof a=="number")a===0?(this._data=n,this._size=0):(this._data=new Int32Array(a),this._size=0);else{this._data=n,this._size=0;for(let c of a)this.add(c)}}add(a){this._data.length===this._size&&this.ensureCapacity(this._size+1),this._data[this._size]=a,this._size++}addAll(a){if(Array.isArray(a))this.ensureCapacity(this._size+a.length),this._data.subarray(this._size,this._size+a.length).set(a),this._size+=a.length;else if(a instanceof So)this.ensureCapacity(this._size+a._size),this._data.subarray(this._size,this._size+a.size).set(a._data),this._size+=a._size;else{this.ensureCapacity(this._size+a.size);let c=0;for(let u of a)this._data[this._size+c]=u,c++;this._size+=a.size}}get(a){if(a<0||a>=this._size)throw RangeError();return this._data[a]}contains(a){for(let c=0;c<this._size;c++)if(this._data[c]===a)return!0;return!1}set(a,c){if(a<0||a>=this._size)throw RangeError();let u=this._data[a];return this._data[a]=c,u}removeAt(a){let c=this.get(a);return this._data.copyWithin(a,a+1,this._size),this._data[this._size-1]=0,this._size--,c}removeRange(a,c){if(a<0||c<0||a>this._size||c>this._size||a>c)throw RangeError();this._data.copyWithin(c,a,this._size),this._data.fill(0,this._size-(c-a),this._size),this._size-=c-a}get isEmpty(){return this._size===0}get size(){return this._size}trimToSize(){this._data.length!==this._size&&(this._data=this._data.slice(0,this._size))}clear(){this._data.fill(0,0,this._size),this._size=0}toArray(){return this._size===0?[]:Array.from(this._data.subarray(0,this._size))}sort(){this._data.subarray(0,this._size).sort()}equals(a){if(a===this)return!0;if(!(a instanceof So)||this._size!==a._size)return!1;for(let c=0;c<this._size;c++)if(this._data[c]!==a._data[c])return!1;return!0}hashCode(){let a=1;for(let c=0;c<this._size;c++)a=31*a+this._data[c];return a}toString(){return this._data.toString()}binarySearch(a,c,u){if(c===void 0&&(c=0),u===void 0&&(u=this._size),c<0||u<0||c>this._size||u>this._size)throw new RangeError;if(c>u)throw new RangeError;return e.Arrays.binarySearch(this._data,a,c,u)}ensureCapacity(a){if(a<0||a>i)throw new RangeError;let c;for(this._data.length===0?c=o:c=this._data.length;c<a;)c=c*2,(c<0||c>i)&&(c=i);let u=new Int32Array(c);u.set(this._data),this._data=u}toCharArray(){let a=new Uint16Array(this._size),c=0,u=!1;for(let h=0;h<this._size;h++){let f=this._data[h];if(f>=0&&f<65536){a[c]=f,c++;continue}if(!u){let p=new Uint16Array(this.charArraySize());p.set(a,0),a=p,u=!0}let d=String.fromCodePoint(f);a[c]=d.charCodeAt(0),a[c+1]=d.charCodeAt(1),c+=2}return a}charArraySize(){let a=0;for(let c=0;c<this._size;c++)a+=this._data[c]>=65536?2:1;return a}};return l([t.NotNull],r.prototype,"_data",void 0),l([t.Override],r.prototype,"equals",null),l([t.Override],r.prototype,"hashCode",null),l([t.Override],r.prototype,"toString",null),$r.IntegerList=r,$r}var Vr={},gc;function Xe(){if(gc)return Vr;gc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Vr&&Vr.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.Interval=void 0;const e=Z(),t=1e3;let n=class rt{constructor(i,r){this.a=i,this.b=r}static get INVALID(){return rt._INVALID}static of(i,r){return i!==r||i<0||i>t?new rt(i,r):(rt.cache[i]==null&&(rt.cache[i]=new rt(i,i)),rt.cache[i])}get length(){return this.b<this.a?0:this.b-this.a+1}equals(i){return i===this?!0:i instanceof rt?this.a===i.a&&this.b===i.b:!1}hashCode(){let i=23;return i=i*31+this.a,i=i*31+this.b,i}startsBeforeDisjoint(i){return this.a<i.a&&this.b<i.a}startsBeforeNonDisjoint(i){return this.a<=i.a&&this.b>=i.a}startsAfter(i){return this.a>i.a}startsAfterDisjoint(i){return this.a>i.b}startsAfterNonDisjoint(i){return this.a>i.a&&this.a<=i.b}disjoint(i){return this.startsBeforeDisjoint(i)||this.startsAfterDisjoint(i)}adjacent(i){return this.a===i.b+1||this.b===i.a-1}properlyContains(i){return i.a>=this.a&&i.b<=this.b}union(i){return rt.of(Math.min(this.a,i.a),Math.max(this.b,i.b))}intersection(i){return rt.of(Math.max(this.a,i.a),Math.min(this.b,i.b))}differenceNotProperlyContained(i){let r;return i.startsBeforeNonDisjoint(this)?r=rt.of(Math.max(this.a,i.b+1),this.b):i.startsAfterNonDisjoint(this)&&(r=rt.of(this.a,i.a-1)),r}toString(){return this.a+".."+this.b}};return n._INVALID=new n(-1,-2),n.cache=new Array(t+1),l([e.Override],n.prototype,"equals",null),l([e.Override],n.prototype,"hashCode",null),l([e.Override],n.prototype,"toString",null),Vr.Interval=n,Vr}var Wr={},yi={},St={},xa={},yc;function Be(){return yc||(yc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.Token=void 0;const e=Rr();(function(t){t.INVALID_TYPE=0,t.EPSILON=-2,t.MIN_USER_TOKEN_TYPE=1,t.EOF=e.IntStream.EOF,t.DEFAULT_CHANNEL=0,t.HIDDEN_CHANNEL=1,t.MIN_USER_CHANNEL_VALUE=2})(l.Token||(l.Token={}))}(xa)),xa}var vc;function Ji(){if(vc)return St;vc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=St&&St.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=St&&St.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(St,"__esModule",{value:!0}),St.CommonToken=void 0;const t=Xe(),n=Z(),o=Be();let i=class ji{constructor(s,a,c=ji.EMPTY_SOURCE,u=o.Token.DEFAULT_CHANNEL,h=0,f=0){this._line=0,this._charPositionInLine=-1,this._channel=o.Token.DEFAULT_CHANNEL,this.index=-1,this._text=a,this._type=s,this.source=c,this._channel=u,this.start=h,this.stop=f,c.source!=null&&(this._line=c.source.line,this._charPositionInLine=c.source.charPositionInLine)}static fromToken(s){let a=new ji(s.type,void 0,ji.EMPTY_SOURCE,s.channel,s.startIndex,s.stopIndex);return a._line=s.line,a.index=s.tokenIndex,a._charPositionInLine=s.charPositionInLine,s instanceof ji?(a._text=s._text,a.source=s.source):(a._text=s.text,a.source={source:s.tokenSource,stream:s.inputStream}),a}get type(){return this._type}set type(s){this._type=s}get line(){return this._line}set line(s){this._line=s}get text(){if(this._text!=null)return this._text;let s=this.inputStream;if(s==null)return;let a=s.size;return this.start<a&&this.stop<a?s.getText(t.Interval.of(this.start,this.stop)):"<EOF>"}set text(s){this._text=s}get charPositionInLine(){return this._charPositionInLine}set charPositionInLine(s){this._charPositionInLine=s}get channel(){return this._channel}set channel(s){this._channel=s}get startIndex(){return this.start}set startIndex(s){this.start=s}get stopIndex(){return this.stop}set stopIndex(s){this.stop=s}get tokenIndex(){return this.index}set tokenIndex(s){this.index=s}get tokenSource(){return this.source.source}get inputStream(){return this.source.stream}toString(s){let a="";this._channel>0&&(a=",channel="+this._channel);let c=this.text;c!=null?(c=c.replace(/\n/g,"\\n"),c=c.replace(/\r/g,"\\r"),c=c.replace(/\t/g,"\\t")):c="<no text>";let u=String(this._type);return s&&(u=s.vocabulary.getDisplayName(this._type)),"[@"+this.tokenIndex+","+this.start+":"+this.stop+"='"+c+"',<"+u+">"+a+","+this._line+":"+this.charPositionInLine+"]"}};return i.EMPTY_SOURCE={source:void 0,stream:void 0},l([n.NotNull],i.prototype,"source",void 0),l([n.Override],i.prototype,"type",null),l([n.Override],i.prototype,"line",null),l([n.Override],i.prototype,"text",null),l([n.Override],i.prototype,"charPositionInLine",null),l([n.Override],i.prototype,"channel",null),l([n.Override],i.prototype,"startIndex",null),l([n.Override],i.prototype,"stopIndex",null),l([n.Override],i.prototype,"tokenIndex",null),l([n.Override],i.prototype,"tokenSource",null),l([n.Override],i.prototype,"inputStream",null),l([n.Override],i.prototype,"toString",null),l([e(0,n.NotNull)],i,"fromToken",null),i=l([e(2,n.NotNull)],i),St.CommonToken=i,St}var Sc;function nl(){return Sc||(Sc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=yi&&yi.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(l,"__esModule",{value:!0}),l.CommonTokenFactory=void 0;const t=Ji(),n=Xe(),o=Z();let i=class{constructor(s=!1){this.copyText=s}create(s,a,c,u,h,f,d,p){let y=new t.CommonToken(a,c,s,u,h,f);return y.line=d,y.charPositionInLine=p,c==null&&this.copyText&&s.stream!=null&&(y.text=s.stream.getText(n.Interval.of(h,f))),y}createSimple(s,a){return new t.CommonToken(s,a)}};e([o.Override],i.prototype,"create",null),e([o.Override],i.prototype,"createSimple",null),l.CommonTokenFactory=i,function(r){r.DEFAULT=new r}(i=l.CommonTokenFactory||(l.CommonTokenFactory={}))}(yi)),yi}var vi={},Ac;function Od(){if(Ac)return vi;Ac=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(vi,"__esModule",{value:!0}),vi.IntegerStack=void 0;const l=rl();let e=class extends l.IntegerList{constructor(n){super(n)}push(n){this.add(n)}pop(){return this.removeAt(this.size-1)}peek(){return this.get(this.size-1)}};return vi.IntegerStack=e,vi}var Gr={},Si={},Cc;function Fd(){if(Cc)return Si;Cc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Si,"__esModule",{value:!0}),Si.AcceptStateInfo=void 0;let l=class{constructor(t,n){this._prediction=t,this._lexerActionExecutor=n}get prediction(){return this._prediction}get lexerActionExecutor(){return this._lexerActionExecutor}};return Si.AcceptStateInfo=l,Si}var Yr={},Ai={},Ec;function fi(){if(Ec)return Ai;Ec=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.Array2DHashMap=void 0;const l=Fr();class e{constructor(o){this.keyComparator=o}hashCode(o){return this.keyComparator.hashCode(o.key)}equals(o,i){return this.keyComparator.equals(o.key,i.key)}}let t=class Ia{constructor(o){o instanceof Ia?this.backingStore=new l.Array2DHashSet(o.backingStore):this.backingStore=new l.Array2DHashSet(new e(o))}clear(){this.backingStore.clear()}containsKey(o){return this.backingStore.contains({key:o})}get(o){let i=this.backingStore.get({key:o});if(i)return i.value}get isEmpty(){return this.backingStore.isEmpty}put(o,i){let r=this.backingStore.get({key:o,value:i}),s;return r?(s=r.value,r.value=i):this.backingStore.add({key:o,value:i}),s}putIfAbsent(o,i){let r=this.backingStore.get({key:o,value:i}),s;return r?s=r.value:this.backingStore.add({key:o,value:i}),s}get size(){return this.backingStore.size}hashCode(){return this.backingStore.hashCode()}equals(o){return o instanceof Ia?this.backingStore.equals(o.backingStore):!1}};return Ai.Array2DHashMap=t,Ai}var At={},Xr={},Ct={},Ci={},_c;function Wn(){if(_c)return Ci;_c=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.DecisionState=void 0;const l=yr();let e=class extends l.ATNState{constructor(){super(...arguments),this.decision=-1,this.nonGreedy=!1,this.sll=!1}};return Ci.DecisionState=e,Ci}var Kr={},Ei={},Tc;function il(){return Tc||(Tc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Ei&&Ei.__decorate||function(a,c,u,h){var f=arguments.length,d=f<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,u):h,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(a,c,u,h);else for(var y=a.length-1;y>=0;y--)(p=a[y])&&(d=(f<3?p(d):f>3?p(c,u,d):p(c,u))||d);return f>3&&d&&Object.defineProperty(c,u,d),d};Object.defineProperty(l,"__esModule",{value:!0}),l.PredictionContextCache=void 0;const t=fi(),n=Z(),o=ht(),i=lt(),r=Ve();let s=class Da{constructor(c=!0){this.contexts=new t.Array2DHashMap(o.ObjectEqualityComparator.INSTANCE),this.childContexts=new t.Array2DHashMap(o.ObjectEqualityComparator.INSTANCE),this.joinContexts=new t.Array2DHashMap(o.ObjectEqualityComparator.INSTANCE),this.enableCache=c}getAsCached(c){if(!this.enableCache)return c;let u=this.contexts.get(c);return u||(u=c,this.contexts.put(c,c)),u}getChild(c,u){if(!this.enableCache)return c.getChild(u);let h=new Da.PredictionContextAndInt(c,u),f=this.childContexts.get(h);return f||(f=c.getChild(u),f=this.getAsCached(f),this.childContexts.put(h,f)),f}join(c,u){if(!this.enableCache)return i.PredictionContext.join(c,u,this);let h=new Da.IdentityCommutativePredictionContextOperands(c,u),f=this.joinContexts.get(h);return f||(f=i.PredictionContext.join(c,u,this),f=this.getAsCached(f),this.joinContexts.put(h,f),f)}};l.PredictionContextCache=s,s.UNCACHED=new s(!1),function(a){class c{constructor(f,d){this.obj=f,this.value=d}equals(f){if(f instanceof c){if(f===this)return!0}else return!1;let d=f;return this.value===d.value&&(this.obj===d.obj||this.obj!=null&&this.obj.equals(d.obj))}hashCode(){let f=5;return f=7*f+(this.obj!=null?this.obj.hashCode():0),f=7*f+this.value,f}}e([n.Override],c.prototype,"equals",null),e([n.Override],c.prototype,"hashCode",null),a.PredictionContextAndInt=c;class u{constructor(f,d){r(f!=null),r(d!=null),this._x=f,this._y=d}get x(){return this._x}get y(){return this._y}equals(f){if(f instanceof u){if(this===f)return!0}else return!1;let d=f;return this._x===d._x&&this._y===d._y||this._x===d._y&&this._y===d._x}hashCode(){return this._x.hashCode()^this._y.hashCode()}}e([n.Override],u.prototype,"equals",null),e([n.Override],u.prototype,"hashCode",null),a.IdentityCommutativePredictionContextOperands=u}(s=l.PredictionContextCache||(l.PredictionContextCache={}))}(Ei)),Ei}var bc;function lt(){return bc||(bc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Kr&&Kr.__decorate||function(y,m,v,x){var g=arguments.length,S=g<3?m:x===null?x=Object.getOwnPropertyDescriptor(m,v):x,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(y,m,v,x);else for(var A=y.length-1;A>=0;A--)(C=y[A])&&(S=(g<3?C(S):g>3?C(m,v,S):C(m,v))||S);return g>3&&S&&Object.defineProperty(m,v,S),S},t=Kr&&Kr.__param||function(y,m){return function(v,x){m(v,x,y)}};Object.defineProperty(l,"__esModule",{value:!0}),l.SingletonPredictionContext=l.PredictionContext=void 0;const n=fi(),o=Fr(),i=tl(),r=je(),s=Z(),a=il(),c=Ve(),u=1;let h=class $e{constructor(m){this.cachedHashCode=m}static calculateEmptyHashCode(){let m=r.MurmurHash.initialize(u);return m=r.MurmurHash.finish(m,0),m}static calculateSingleHashCode(m,v){let x=r.MurmurHash.initialize(u);return x=r.MurmurHash.update(x,m),x=r.MurmurHash.update(x,v),x=r.MurmurHash.finish(x,2),x}static calculateHashCode(m,v){let x=r.MurmurHash.initialize(u);for(let g of m)x=r.MurmurHash.update(x,g);for(let g of v)x=r.MurmurHash.update(x,g);return x=r.MurmurHash.finish(x,2*m.length),x}static fromRuleContext(m,v,x=!0){if(v.isEmpty)return x?$e.EMPTY_FULL:$e.EMPTY_LOCAL;let g;v._parent?g=$e.fromRuleContext(m,v._parent,x):g=x?$e.EMPTY_FULL:$e.EMPTY_LOCAL;let C=m.states[v.invokingState].transition(0);return g.getChild(C.followState.stateNumber)}static addEmptyContext(m){return m.addEmptyContext()}static removeEmptyContext(m){return m.removeEmptyContext()}static join(m,v,x=a.PredictionContextCache.UNCACHED){if(m===v)return m;if(m.isEmpty)return $e.isEmptyLocal(m)?m:$e.addEmptyContext(v);if(v.isEmpty)return $e.isEmptyLocal(v)?v:$e.addEmptyContext(m);let g=m.size,S=v.size;if(g===1&&S===1&&m.getReturnState(0)===v.getReturnState(0)){let D=x.join(m.getParent(0),v.getParent(0));return D===m.getParent(0)?m:D===v.getParent(0)?v:D.getChild(m.getReturnState(0))}let C=0,A=new Array(g+S),b=new Array(A.length),N=0,R=0,P=!0,k=!0;for(;N<g&&R<S;)m.getReturnState(N)===v.getReturnState(R)?(A[C]=x.join(m.getParent(N),v.getParent(R)),b[C]=m.getReturnState(N),P=P&&A[C]===m.getParent(N),k=k&&A[C]===v.getParent(R),N++,R++):m.getReturnState(N)<v.getReturnState(R)?(A[C]=m.getParent(N),b[C]=m.getReturnState(N),k=!1,N++):(c(v.getReturnState(R)<m.getReturnState(N)),A[C]=v.getParent(R),b[C]=v.getReturnState(R),P=!1,R++),C++;for(;N<g;)A[C]=m.getParent(N),b[C]=m.getReturnState(N),N++,k=!1,C++;for(;R<S;)A[C]=v.getParent(R),b[C]=v.getReturnState(R),R++,P=!1,C++;return P?m:k?v:(C<A.length&&(A=A.slice(0,C),b=b.slice(0,C)),A.length===0?$e.EMPTY_FULL:A.length===1?new p(A[0],b[0]):new d(A,b))}static isEmptyLocal(m){return m===$e.EMPTY_LOCAL}static getCachedContext(m,v,x){if(m.isEmpty)return m;let g=x.get(m);if(g)return g;if(g=v.get(m),g)return x.put(m,g),g;let S=!1,C=new Array(m.size);for(let b=0;b<C.length;b++){let N=$e.getCachedContext(m.getParent(b),v,x);if(S||N!==m.getParent(b)){if(!S){C=new Array(m.size);for(let R=0;R<m.size;R++)C[R]=m.getParent(R);S=!0}C[b]=N}}if(!S)return g=v.putIfAbsent(m,m),x.put(m,g??m),m;let A;if(C.length===1)A=new p(C[0],m.getReturnState(0));else{let b=new Array(m.size);for(let N=0;N<m.size;N++)b[N]=m.getReturnState(N);A=new d(C,b,m.hashCode())}return g=v.putIfAbsent(A,A),x.put(A,g||A),x.put(m,g||A),A}appendSingleContext(m,v){return this.appendContext($e.EMPTY_FULL.getChild(m),v)}getChild(m){return new p(this,m)}hashCode(){return this.cachedHashCode}toStrings(m,v,x=$e.EMPTY_FULL){let g=[];e:for(let S=0;;S++){let C=0,A=!0,b=this,N=v,R="";for(R+="[";!b.isEmpty&&b!==x;){let P=0;if(b.size>0){let k=1;for(;1<<k>>>0<b.size;)k++;let D=(1<<k>>>0)-1;if(P=S>>C&D,A=A&&P>=b.size-1,P>=b.size)continue e;C+=k}if(m){R.length>1&&(R+=" ");let D=m.atn.states[N],H=m.ruleNames[D.ruleIndex];R+=H}else b.getReturnState(P)!==$e.EMPTY_FULL_STATE_KEY&&(b.isEmpty||(R.length>1&&(R+=" "),R+=b.getReturnState(P)));N=b.getReturnState(P),b=b.getParent(P)}if(R+="]",g.push(R),A)break}return g}};e([s.Override],h.prototype,"hashCode",null),e([t(0,s.NotNull),t(1,s.NotNull),t(2,s.NotNull)],h,"join",null),e([t(0,s.NotNull),t(1,s.NotNull),t(2,s.NotNull)],h,"getCachedContext",null),l.PredictionContext=h;class f extends h{constructor(m){super(h.calculateEmptyHashCode()),this.fullContext=m}get isFullContext(){return this.fullContext}addEmptyContext(){return this}removeEmptyContext(){throw new Error("Cannot remove the empty context from itself.")}getParent(m){throw new Error("index out of bounds")}getReturnState(m){throw new Error("index out of bounds")}findReturnState(m){return-1}get size(){return 0}appendSingleContext(m,v){return v.getChild(this,m)}appendContext(m,v){return m}get isEmpty(){return!0}get hasEmpty(){return!0}equals(m){return this===m}toStrings(m,v,x){return["[]"]}}e([s.Override],f.prototype,"addEmptyContext",null),e([s.Override],f.prototype,"removeEmptyContext",null),e([s.Override],f.prototype,"getParent",null),e([s.Override],f.prototype,"getReturnState",null),e([s.Override],f.prototype,"findReturnState",null),e([s.Override],f.prototype,"size",null),e([s.Override],f.prototype,"appendSingleContext",null),e([s.Override],f.prototype,"appendContext",null),e([s.Override],f.prototype,"isEmpty",null),e([s.Override],f.prototype,"hasEmpty",null),e([s.Override],f.prototype,"equals",null),e([s.Override],f.prototype,"toStrings",null);let d=class qn extends h{constructor(m,v,x){super(x||h.calculateHashCode(m,v)),c(m.length===v.length),c(v.length>1||v[0]!==h.EMPTY_FULL_STATE_KEY,"Should be using PredictionContext.EMPTY instead."),this.parents=m,this.returnStates=v}getParent(m){return this.parents[m]}getReturnState(m){return this.returnStates[m]}findReturnState(m){return i.Arrays.binarySearch(this.returnStates,m)}get size(){return this.returnStates.length}get isEmpty(){return!1}get hasEmpty(){return this.returnStates[this.returnStates.length-1]===h.EMPTY_FULL_STATE_KEY}addEmptyContext(){if(this.hasEmpty)return this;let m=this.parents.slice(0),v=this.returnStates.slice(0);return m.push(h.EMPTY_FULL),v.push(h.EMPTY_FULL_STATE_KEY),new qn(m,v)}removeEmptyContext(){if(!this.hasEmpty)return this;if(this.returnStates.length===2)return new p(this.parents[0],this.returnStates[0]);{let m=this.parents.slice(0,this.parents.length-1),v=this.returnStates.slice(0,this.returnStates.length-1);return new qn(m,v)}}appendContext(m,v){return qn.appendContextImpl(this,m,new h.IdentityHashMap)}static appendContextImpl(m,v,x){if(v.isEmpty){if(h.isEmptyLocal(v)){if(m.hasEmpty)return h.EMPTY_LOCAL;throw new Error("what to do here?")}return m}if(v.size!==1)throw new Error("Appending a tree suffix is not yet supported.");let g=x.get(m);if(!g){if(m.isEmpty)g=v;else{let S=m.size;m.hasEmpty&&S--;let C=new Array(S),A=new Array(S);for(let b=0;b<S;b++)A[b]=m.getReturnState(b);for(let b=0;b<S;b++)C[b]=qn.appendContextImpl(m.getParent(b),v,x);C.length===1?g=new p(C[0],A[0]):(c(C.length>1),g=new qn(C,A)),m.hasEmpty&&(g=h.join(g,v))}x.put(m,g)}return g}equals(m){if(this===m)return!0;if(!(m instanceof qn)||this.hashCode()!==m.hashCode())return!1;let v=m;return this.equalsImpl(v,new o.Array2DHashSet)}equalsImpl(m,v){let x=[],g=[];for(x.push(this),g.push(m);;){let S=x.pop(),C=g.pop();if(!S||!C)break;let A=new a.PredictionContextCache.IdentityCommutativePredictionContextOperands(S,C);if(!v.add(A))continue;let b=A.x.size;if(b===0){if(!A.x.equals(A.y))return!1;continue}let N=A.y.size;if(b!==N)return!1;for(let R=0;R<b;R++){if(A.x.getReturnState(R)!==A.y.getReturnState(R))return!1;let P=A.x.getParent(R),k=A.y.getParent(R);if(P.hashCode()!==k.hashCode())return!1;P!==k&&(x.push(P),g.push(k))}}return!0}};e([s.NotNull],d.prototype,"parents",void 0),e([s.NotNull],d.prototype,"returnStates",void 0),e([s.Override],d.prototype,"getParent",null),e([s.Override],d.prototype,"getReturnState",null),e([s.Override],d.prototype,"findReturnState",null),e([s.Override],d.prototype,"size",null),e([s.Override],d.prototype,"isEmpty",null),e([s.Override],d.prototype,"hasEmpty",null),e([s.Override],d.prototype,"addEmptyContext",null),e([s.Override],d.prototype,"removeEmptyContext",null),e([s.Override],d.prototype,"appendContext",null),e([s.Override],d.prototype,"equals",null),d=e([t(0,s.NotNull)],d);let p=class Pd extends h{constructor(m,v){super(h.calculateSingleHashCode(m,v)),this.parent=m,this.returnState=v}getParent(m){return this.parent}getReturnState(m){return this.returnState}findReturnState(m){return this.returnState===m?0:-1}get size(){return 1}get isEmpty(){return!1}get hasEmpty(){return!1}appendContext(m,v){return v.getChild(this.parent.appendContext(m,v),this.returnState)}addEmptyContext(){let m=[this.parent,h.EMPTY_FULL],v=[this.returnState,h.EMPTY_FULL_STATE_KEY];return new d(m,v)}removeEmptyContext(){return this}equals(m){if(m===this)return!0;if(!(m instanceof Pd))return!1;let v=m;return this.hashCode()!==v.hashCode()?!1:this.returnState===v.returnState&&this.parent.equals(v.parent)}};e([s.NotNull],p.prototype,"parent",void 0),e([s.Override],p.prototype,"getParent",null),e([s.Override],p.prototype,"getReturnState",null),e([s.Override],p.prototype,"findReturnState",null),e([s.Override],p.prototype,"size",null),e([s.Override],p.prototype,"isEmpty",null),e([s.Override],p.prototype,"hasEmpty",null),e([s.Override],p.prototype,"appendContext",null),e([s.Override],p.prototype,"addEmptyContext",null),e([s.Override],p.prototype,"removeEmptyContext",null),e([s.Override],p.prototype,"equals",null),p=e([t(0,s.NotNull)],p),l.SingletonPredictionContext=p,function(y){y.EMPTY_LOCAL=new f(!1),y.EMPTY_FULL=new f(!0),y.EMPTY_LOCAL_STATE_KEY=-2147483648,y.EMPTY_FULL_STATE_KEY=(1<<31>>>0)-1;class m extends n.Array2DHashMap{constructor(){super(v.INSTANCE)}}y.IdentityHashMap=m;class v{IdentityEqualityComparator(){}hashCode(g){return g.hashCode()}equals(g,S){return g===S}}v.INSTANCE=new v,e([s.Override],v.prototype,"hashCode",null),e([s.Override],v.prototype,"equals",null),y.IdentityEqualityComparator=v}(h=l.PredictionContext||(l.PredictionContext={}))}(Kr)),Kr}var Nc;function Do(){if(Nc)return Ct;Nc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ct&&Ct.__decorate||function(y,m,v,x){var g=arguments.length,S=g<3?m:x===null?x=Object.getOwnPropertyDescriptor(m,v):x,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(y,m,v,x);else for(var A=y.length-1;A>=0;A--)(C=y[A])&&(S=(g<3?C(S):g>3?C(m,v,S):C(m,v))||S);return g>3&&S&&Object.defineProperty(m,v,S),S},e=Ct&&Ct.__param||function(y,m){return function(v,x){m(v,x,y)}};Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.ATNConfig=void 0;const t=fi(),n=Wn(),o=je(),i=Z(),r=ht(),s=lt(),a=hi(),c=Ve(),u=2147483648;let h=class qi{constructor(m,v,x){typeof v=="number"?(c((v&16777215)===v),this._state=m,this.altAndOuterContextDepth=v,this._context=x):(this._state=m,this.altAndOuterContextDepth=v.altAndOuterContextDepth,this._context=x)}static create(m,v,x,g=a.SemanticContext.NONE,S){return g!==a.SemanticContext.NONE?S!=null?new p(S,g,m,v,x,!1):new f(g,m,v,x):S!=null?new d(S,m,v,x,!1):new qi(m,v,x)}get state(){return this._state}get alt(){return this.altAndOuterContextDepth&16777215}get context(){return this._context}set context(m){this._context=m}get reachesIntoOuterContext(){return this.outerContextDepth!==0}get outerContextDepth(){return this.altAndOuterContextDepth>>>24&127}set outerContextDepth(m){c(m>=0),m=Math.min(m,127),this.altAndOuterContextDepth=m<<24|(this.altAndOuterContextDepth&-2130706433)>>>0}get lexerActionExecutor(){}get semanticContext(){return a.SemanticContext.NONE}get hasPassedThroughNonGreedyDecision(){return!1}clone(){return this.transform(this.state,!1)}transform(m,v,x){return x==null?this.transformImpl(m,this._context,this.semanticContext,v,this.lexerActionExecutor):x instanceof s.PredictionContext?this.transformImpl(m,x,this.semanticContext,v,this.lexerActionExecutor):x instanceof a.SemanticContext?this.transformImpl(m,this._context,x,v,this.lexerActionExecutor):this.transformImpl(m,this._context,this.semanticContext,v,x)}transformImpl(m,v,x,g,S){let C=g&&qi.checkNonGreedyDecision(this,m);return x!==a.SemanticContext.NONE?S!=null||C?new p(S,x,m,this,v,C):new f(x,m,this,v):S!=null||C?new d(S,m,this,v,C):new qi(m,this,v)}static checkNonGreedyDecision(m,v){return m.hasPassedThroughNonGreedyDecision||v instanceof n.DecisionState&&v.nonGreedy}appendContext(m,v){if(typeof m=="number"){let x=this.context.appendSingleContext(m,v);return this.transform(this.state,!1,x)}else{let x=this.context.appendContext(m,v);return this.transform(this.state,!1,x)}}contains(m){if(this.state.stateNumber!==m.state.stateNumber||this.alt!==m.alt||!this.semanticContext.equals(m.semanticContext))return!1;let v=[],x=[];for(v.push(this.context),x.push(m.context);;){let g=v.pop(),S=x.pop();if(!g||!S)break;if(g===S)return!0;if(g.size<S.size)return!1;if(S.isEmpty)return g.hasEmpty;for(let C=0;C<S.size;C++){let A=g.findReturnState(S.getReturnState(C));if(A<0)return!1;v.push(g.getParent(A)),x.push(S.getParent(C))}}return!1}get isPrecedenceFilterSuppressed(){return(this.altAndOuterContextDepth&u)!==0}set isPrecedenceFilterSuppressed(m){m?this.altAndOuterContextDepth|=u:this.altAndOuterContextDepth&=2147483647}equals(m){return this===m?!0:m instanceof qi?this.state.stateNumber===m.state.stateNumber&&this.alt===m.alt&&this.reachesIntoOuterContext===m.reachesIntoOuterContext&&this.context.equals(m.context)&&this.semanticContext.equals(m.semanticContext)&&this.isPrecedenceFilterSuppressed===m.isPrecedenceFilterSuppressed&&this.hasPassedThroughNonGreedyDecision===m.hasPassedThroughNonGreedyDecision&&r.ObjectEqualityComparator.INSTANCE.equals(this.lexerActionExecutor,m.lexerActionExecutor):!1}hashCode(){let m=o.MurmurHash.initialize(7);return m=o.MurmurHash.update(m,this.state.stateNumber),m=o.MurmurHash.update(m,this.alt),m=o.MurmurHash.update(m,this.reachesIntoOuterContext?1:0),m=o.MurmurHash.update(m,this.context),m=o.MurmurHash.update(m,this.semanticContext),m=o.MurmurHash.update(m,this.hasPassedThroughNonGreedyDecision?1:0),m=o.MurmurHash.update(m,this.lexerActionExecutor),m=o.MurmurHash.finish(m,7),m}toDotString(){let m="";m+=`digraph G {
`,m+=`rankdir=LR;
`;let v=new t.Array2DHashMap(s.PredictionContext.IdentityEqualityComparator.INSTANCE),x=[];function g(S){let C=v.size,A=v.putIfAbsent(S,C);return A??(x.push(S),C)}for(x.push(this.context),v.put(this.context,0);;){let S=x.pop();if(!S)break;for(let C=0;C<S.size;C++)m+="  s"+g(S),m+="->",m+="s"+g(S.getParent(C)),m+='[label="'+S.getReturnState(C)+`"];
`}return m+=`}
`,m.toString()}toString(m,v,x){x==null&&(x=v!=null),v==null&&(v=!0);let g="",S;x?S=this.context.toStrings(m,this.state.stateNumber):S=["?"];let C=!0;for(let A of S)C?C=!1:g+=", ",g+="(",g+=this.state,v&&(g+=",",g+=this.alt),this.context&&(g+=",",g+=A),this.semanticContext!==a.SemanticContext.NONE&&(g+=",",g+=this.semanticContext),this.reachesIntoOuterContext&&(g+=",up="+this.outerContextDepth),g+=")";return g.toString()}};l([i.NotNull],h.prototype,"_state",void 0),l([i.NotNull],h.prototype,"_context",void 0),l([i.NotNull],h.prototype,"state",null),l([i.NotNull,e(0,i.NotNull)],h.prototype,"context",null),l([i.NotNull],h.prototype,"semanticContext",null),l([i.Override],h.prototype,"clone",null),l([e(0,i.NotNull),e(2,i.NotNull)],h.prototype,"transformImpl",null),l([i.Override],h.prototype,"equals",null),l([i.Override],h.prototype,"hashCode",null),l([e(0,i.NotNull),e(3,i.NotNull)],h,"create",null),h=l([e(0,i.NotNull),e(2,i.NotNull)],h),Ct.ATNConfig=h;let f=class extends h{constructor(m,v,x,g){typeof x=="number"?super(v,x,g):super(v,x,g),this._semanticContext=m}get semanticContext(){return this._semanticContext}};l([i.NotNull],f.prototype,"_semanticContext",void 0),l([i.Override],f.prototype,"semanticContext",null),f=l([e(1,i.NotNull),e(2,i.NotNull)],f);let d=class extends h{constructor(m,v,x,g,S){if(typeof x=="number")super(v,x,g);else if(super(v,x,g),x.semanticContext!==a.SemanticContext.NONE)throw new Error("Not supported");this._lexerActionExecutor=m,this.passedThroughNonGreedyDecision=S}get lexerActionExecutor(){return this._lexerActionExecutor}get hasPassedThroughNonGreedyDecision(){return this.passedThroughNonGreedyDecision}};l([i.Override],d.prototype,"lexerActionExecutor",null),l([i.Override],d.prototype,"hasPassedThroughNonGreedyDecision",null),d=l([e(1,i.NotNull),e(2,i.NotNull)],d);let p=class extends f{constructor(m,v,x,g,S,C){typeof g=="number"?super(v,x,g,S):super(v,x,g,S),this._lexerActionExecutor=m,this.passedThroughNonGreedyDecision=C}get lexerActionExecutor(){return this._lexerActionExecutor}get hasPassedThroughNonGreedyDecision(){return this.passedThroughNonGreedyDecision}};return l([i.Override],p.prototype,"lexerActionExecutor",null),l([i.Override],p.prototype,"hasPassedThroughNonGreedyDecision",null),p=l([e(1,i.NotNull),e(2,i.NotNull)],p),Ct}var _i={},Rc;function Pr(){if(Rc)return _i;Rc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(_i,"__esModule",{value:!0}),_i.BitSet=void 0;const l=ri(),e=je(),t=new Uint16Array(0);function n(h){return h>>>4}function o(h){return h*16}function i(h){let f=1;for(let d=0;d<16;d++){if((h&f)!==0)return d;f=f<<1>>>0}throw new RangeError("No specified bit found")}function r(h){let f=32768;for(let d=15;d>=0;d--){if((h&f)!==0)return d;f=f>>>1}throw new RangeError("No specified bit found")}function s(h,f){return h&=15,f&=15,h===f?1<<h>>>0:65535>>>15-f^65535>>>16-h}const a=new Uint8Array(65536);for(let h=0;h<16;h++){const f=1<<h>>>0;let d=0;for(;d<a.length;){d+=f;for(let p=0;p<f;p++)a[d]++,d++}}let c=class Ui{constructor(f){if(!f)this.data=t;else if(typeof f=="number"){if(f<0)throw new RangeError("nbits cannot be negative");this.data=new Uint16Array(n(f-1)+1)}else if(f instanceof Ui)this.data=f.data.slice(0);else{let d=-1;for(let p of f)d<p&&(d=p);this.data=new Uint16Array(n(d-1)+1);for(let p of f)this.set(p)}}and(f){const d=this.data,p=f.data,y=Math.min(d.length,p.length);let m=-1;for(let v=0;v<y;v++)(d[v]&=p[v])!==0&&(m=v);m===-1&&(this.data=t),m<d.length-1&&(this.data=d.slice(0,m+1))}andNot(f){const d=this.data,p=f.data,y=Math.min(d.length,p.length);let m=-1;for(let v=0;v<y;v++)(d[v]&=p[v]^65535)!==0&&(m=v);m===-1&&(this.data=t),m<d.length-1&&(this.data=d.slice(0,m+1))}cardinality(){if(this.isEmpty)return 0;const f=this.data,d=f.length;let p=0;for(let y=0;y<d;y++)p+=a[f[y]];return p}clear(f,d){f==null?this.data.fill(0):d==null?this.set(f,!1):this.set(f,d,!1)}flip(f,d){if(d==null&&(d=f),f<0||d<f)throw new RangeError;let p=n(f);const y=n(d);if(p===y)this.data[p]^=s(f,d);else{for(this.data[p++]^=s(f,15);p<y;)this.data[p++]^=65535;this.data[p++]^=s(0,d)}}get(f,d){if(d===void 0)return!!(this.data[n(f)]&s(f,f));{let p=new Ui(d+1);for(let y=f;y<=d;y++)p.set(y,this.get(y));return p}}intersects(f){let d=Math.min(this.length(),f.length());if(d===0)return!1;let p=n(d-1);for(let y=0;y<=p;y++)if((this.data[y]&f.data[y])!==0)return!0;return!1}get isEmpty(){return this.length()===0}length(){return this.data.length?this.previousSetBit(o(this.data.length)-1)+1:0}nextClearBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let y=n(f);if(y>p)return-1;let m=65535^s(f,15);if((d[y]|m)===65535){for(y++,m=0;y<p&&d[y]===65535;y++);if(y===p)return-1}return o(y)+i((d[y]|m)^65535)}nextSetBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let y=n(f);if(y>p)return-1;let m=s(f,15);if((d[y]&m)===0){for(y++,m=65535;y<p&&d[y]===0;y++);if(y>=p)return-1}return o(y)+i(d[y]&m)}or(f){const d=this.data,p=f.data,y=Math.min(d.length,p.length),m=Math.max(d.length,p.length),v=d.length===m?d:new Uint16Array(m);let x=-1;for(let S=0;S<y;S++)(v[S]=d[S]|p[S])!==0&&(x=S);const g=d.length>p.length?d:p;for(let S=y;S<m;S++)(v[S]=g[S])!==0&&(x=S);x===-1?this.data=t:v.length===x+1?this.data=v:this.data=v.slice(0,x)}previousClearBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let y=n(f);y>=p&&(y=p-1);let m=65535^s(0,f);if((d[y]|m)===65535){for(m=0,y--;y>=0&&d[y]===65535;y--);if(y<0)return-1}return o(y)+r((d[y]|m)^65535)}previousSetBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let y=n(f);y>=p&&(y=p-1);let m=s(0,f);if((d[y]&m)===0){for(y--,m=65535;y>=0&&d[y]===0;y--);if(y<0)return-1}return o(y)+r(d[y]&m)}set(f,d,p){if(d===void 0?(d=f,p=!0):typeof d=="boolean"&&(p=d,d=f),p===void 0&&(p=!0),f<0||f>d)throw new RangeError;let y=n(f),m=n(d);if(p&&m>=this.data.length){let v=new Uint16Array(m+1);this.data.forEach((x,g)=>v[g]=x),this.data=v}else if(!p){if(y>=this.data.length)return;m>=this.data.length&&(m=this.data.length-1,d=this.data.length*16-1)}if(y===m)this._setBits(y,p,s(f,d));else{for(this._setBits(y++,p,s(f,15));y<m;)this.data[y++]=p?65535:0;this._setBits(y,p,s(0,d))}}_setBits(f,d,p){d?this.data[f]|=p:this.data[f]&=65535^p}get size(){return this.data.byteLength*8}hashCode(){return e.MurmurHash.hashCode(this.data,22)}equals(f){if(f===this)return!0;if(!(f instanceof Ui))return!1;const d=this.length();if(d!==f.length())return!1;if(d===0)return!0;let p=n(d-1);for(let y=0;y<=p;y++)if(this.data[y]!==f.data[y])return!1;return!0}toString(){let f="{",d=!0;for(let p=this.nextSetBit(0);p>=0;p=this.nextSetBit(p+1))d?d=!1:f+=", ",f+=p;return f+="}",f}xor(f){const d=this.data,p=f.data,y=Math.min(d.length,p.length),m=Math.max(d.length,p.length),v=d.length===m?d:new Uint16Array(m);let x=-1;for(let S=0;S<y;S++)(v[S]=d[S]^p[S])!==0&&(x=S);const g=d.length>p.length?d:p;for(let S=y;S<m;S++)(v[S]=g[S])!==0&&(x=S);x===-1?this.data=t:v.length===x+1?this.data=v:this.data=v.slice(0,x+1)}clone(){return new Ui(this)}[Symbol.iterator](){return new u(this.data)}[l.inspect.custom](){return"BitSet "+this.toString()}};_i.BitSet=c;class u{constructor(f){this.data=f,this.index=0,this.mask=65535}next(){for(;this.index<this.data.length;){const f=this.data[this.index]&this.mask;if(f!==0){const d=o(this.index)+i(f);return this.mask=s(d+1,15),{done:!1,value:d}}this.index++,this.mask=65535}return{done:!0,value:-1}}[Symbol.iterator](){return this}}return _i}var wc;function Zi(){if(wc)return Xr;wc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Xr&&Xr.__decorate||function(v,x,g,S){var C=arguments.length,A=C<3?x:S===null?S=Object.getOwnPropertyDescriptor(x,g):S,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(v,x,g,S);else for(var N=v.length-1;N>=0;N--)(b=v[N])&&(A=(C<3?b(A):C>3?b(x,g,A):b(x,g))||A);return C>3&&A&&Object.defineProperty(x,g,A),A};Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.ATNConfigSet=void 0;const e=fi(),t=Fr(),n=Fo(),o=ft(),i=Do(),r=Pr(),s=Z(),a=ht(),c=lt(),u=il(),h=hi(),f=Ve(),d=vr();class p{hashCode(x){return x.state^x.alt}equals(x,g){return x.state===g.state&&x.alt===g.alt}}p.INSTANCE=new p;function y(v){return v?new e.Array2DHashMap(v):new e.Array2DHashMap(p.INSTANCE)}let m=class La{constructor(x,g){this._uniqueAlt=0,this._hasSemanticContext=!1,this._dipsIntoOuterContext=!1,this.outermostConfigSet=!1,this.cachedHashCode=-1,x?(g?(this.mergedConfigs=void 0,this.unmerged=void 0):x.isReadOnly?(this.mergedConfigs=y(),this.unmerged=[]):(this.mergedConfigs=y(x.mergedConfigs),this.unmerged=x.unmerged.slice(0)),this.configs=x.configs.slice(0),this._dipsIntoOuterContext=x._dipsIntoOuterContext,this._hasSemanticContext=x._hasSemanticContext,this.outermostConfigSet=x.outermostConfigSet,(g||!x.isReadOnly)&&(this._uniqueAlt=x._uniqueAlt,this._conflictInfo=x._conflictInfo)):(this.mergedConfigs=y(),this.unmerged=[],this.configs=[],this._uniqueAlt=o.ATN.INVALID_ALT_NUMBER)}getRepresentedAlternatives(){if(this._conflictInfo!=null)return this._conflictInfo.conflictedAlts.clone();let x=new r.BitSet;for(let g of this)x.set(g.alt);return x}get isReadOnly(){return this.mergedConfigs==null}get isOutermostConfigSet(){return this.outermostConfigSet}set isOutermostConfigSet(x){if(this.outermostConfigSet&&!x)throw new Error("IllegalStateException");f(!x||!this._dipsIntoOuterContext),this.outermostConfigSet=x}getStates(){let x=new t.Array2DHashSet(a.ObjectEqualityComparator.INSTANCE);for(let g of this.configs)x.add(g.state);return x}optimizeConfigs(x){if(this.configs.length!==0)for(let g of this.configs)g.context=x.atn.getCachedContext(g.context)}clone(x){let g=new La(this,x);return!x&&this.isReadOnly&&g.addAll(this.configs),g}get size(){return this.configs.length}get isEmpty(){return this.configs.length===0}contains(x){if(!(x instanceof i.ATNConfig))return!1;if(this.mergedConfigs&&this.unmerged){let g=x,S=this.getKey(g),C=this.mergedConfigs.get(S);if(C!=null&&this.canMerge(g,S,C))return C.contains(g);for(let A of this.unmerged)if(A.contains(x))return!0}else for(let g of this.configs)if(g.contains(x))return!0;return!1}*[Symbol.iterator](){yield*this.configs}toArray(){return this.configs}add(x,g){if(this.ensureWritable(),!this.mergedConfigs||!this.unmerged)throw new Error("Covered by ensureWritable but duplicated here for strict null check limitation");f(!this.outermostConfigSet||!x.reachesIntoOuterContext),g==null&&(g=u.PredictionContextCache.UNCACHED);let S,C=this.getKey(x),A=this.mergedConfigs.get(C);if(S=A==null,A!=null&&this.canMerge(x,C,A)){A.outerContextDepth=Math.max(A.outerContextDepth,x.outerContextDepth),x.isPrecedenceFilterSuppressed&&(A.isPrecedenceFilterSuppressed=!0);let b=c.PredictionContext.join(A.context,x.context,g);return this.updatePropertiesForMergedConfig(x),A.context===b?!1:(A.context=b,!0)}for(let b=0;b<this.unmerged.length;b++){let N=this.unmerged[b];if(this.canMerge(x,C,N)){N.outerContextDepth=Math.max(N.outerContextDepth,x.outerContextDepth),x.isPrecedenceFilterSuppressed&&(N.isPrecedenceFilterSuppressed=!0);let R=c.PredictionContext.join(N.context,x.context,g);return this.updatePropertiesForMergedConfig(x),N.context===R?!1:(N.context=R,S&&(this.mergedConfigs.put(C,N),this.unmerged.splice(b,1)),!0)}}return this.configs.push(x),S?this.mergedConfigs.put(C,x):this.unmerged.push(x),this.updatePropertiesForAddedConfig(x),!0}updatePropertiesForMergedConfig(x){this._dipsIntoOuterContext=this._dipsIntoOuterContext||x.reachesIntoOuterContext,f(!this.outermostConfigSet||!this._dipsIntoOuterContext)}updatePropertiesForAddedConfig(x){this.configs.length===1?this._uniqueAlt=x.alt:this._uniqueAlt!==x.alt&&(this._uniqueAlt=o.ATN.INVALID_ALT_NUMBER),this._hasSemanticContext=this._hasSemanticContext||!h.SemanticContext.NONE.equals(x.semanticContext),this._dipsIntoOuterContext=this._dipsIntoOuterContext||x.reachesIntoOuterContext,f(!this.outermostConfigSet||!this._dipsIntoOuterContext)}canMerge(x,g,S){return x.state.stateNumber!==S.state.stateNumber||g.alt!==S.alt?!1:x.semanticContext.equals(S.semanticContext)}getKey(x){return{state:x.state.stateNumber,alt:x.alt}}containsAll(x){for(let g of x)if(!(g instanceof i.ATNConfig)||!this.contains(g))return!1;return!0}addAll(x,g){this.ensureWritable();let S=!1;for(let C of x)this.add(C,g)&&(S=!0);return S}clear(){if(this.ensureWritable(),!this.mergedConfigs||!this.unmerged)throw new Error("Covered by ensureWritable but duplicated here for strict null check limitation");this.mergedConfigs.clear(),this.unmerged.length=0,this.configs.length=0,this._dipsIntoOuterContext=!1,this._hasSemanticContext=!1,this._uniqueAlt=o.ATN.INVALID_ALT_NUMBER,this._conflictInfo=void 0}equals(x){return this===x?!0:x instanceof La?this.outermostConfigSet===x.outermostConfigSet&&d.equals(this._conflictInfo,x._conflictInfo)&&n.ArrayEqualityComparator.INSTANCE.equals(this.configs,x.configs):!1}hashCode(){if(this.isReadOnly&&this.cachedHashCode!==-1)return this.cachedHashCode;let x=1;return x=5*x^(this.outermostConfigSet?1:0),x=5*x^n.ArrayEqualityComparator.INSTANCE.hashCode(this.configs),this.isReadOnly&&(this.cachedHashCode=x),x}toString(x){x==null&&(x=!1);let g="",S=this.configs.slice(0);S.sort((C,A)=>C.alt!==A.alt?C.alt-A.alt:C.state.stateNumber!==A.state.stateNumber?C.state.stateNumber-A.state.stateNumber:C.semanticContext.toString().localeCompare(A.semanticContext.toString())),g+="[";for(let C=0;C<S.length;C++)C>0&&(g+=", "),g+=S[C].toString(void 0,!0,x);return g+="]",this._hasSemanticContext&&(g+=",hasSemanticContext="+this._hasSemanticContext),this._uniqueAlt!==o.ATN.INVALID_ALT_NUMBER&&(g+=",uniqueAlt="+this._uniqueAlt),this._conflictInfo!=null&&(g+=",conflictingAlts="+this._conflictInfo.conflictedAlts,this._conflictInfo.isExact||(g+="*")),this._dipsIntoOuterContext&&(g+=",dipsIntoOuterContext"),g.toString()}get uniqueAlt(){return this._uniqueAlt}get hasSemanticContext(){return this._hasSemanticContext}set hasSemanticContext(x){this.ensureWritable(),this._hasSemanticContext=x}get conflictInfo(){return this._conflictInfo}set conflictInfo(x){this.ensureWritable(),this._conflictInfo=x}get conflictingAlts(){if(this._conflictInfo!=null)return this._conflictInfo.conflictedAlts}get isExactConflict(){return this._conflictInfo==null?!1:this._conflictInfo.isExact}get dipsIntoOuterContext(){return this._dipsIntoOuterContext}get(x){return this.configs[x]}ensureWritable(){if(this.isReadOnly)throw new Error("This ATNConfigSet is read only.")}};return l([s.NotNull],m.prototype,"getRepresentedAlternatives",null),l([s.Override],m.prototype,"size",null),l([s.Override],m.prototype,"isEmpty",null),l([s.Override],m.prototype,"contains",null),l([s.Override],m.prototype,Symbol.iterator,null),l([s.Override],m.prototype,"toArray",null),l([s.Override],m.prototype,"containsAll",null),l([s.Override],m.prototype,"clear",null),l([s.Override],m.prototype,"equals",null),l([s.Override],m.prototype,"hashCode",null),Xr.ATNConfigSet=m,Xr}var Qr={},Jr={},Zr={},Oc;function Lo(){return Oc||(Oc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Zr&&Zr.__decorate||function(u,h,f,d){var p=arguments.length,y=p<3?h:d===null?d=Object.getOwnPropertyDescriptor(h,f):d,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(u,h,f,d);else for(var v=u.length-1;v>=0;v--)(m=u[v])&&(y=(p<3?m(y):p>3?m(h,f,y):m(h,f))||y);return p>3&&y&&Object.defineProperty(h,f,y),y},t=Zr&&Zr.__param||function(u,h){return function(f,d){h(f,d,u)}};Object.defineProperty(l,"__esModule",{value:!0}),l.DFAState=void 0;const n=ft(),o=Pr(),i=je(),r=Z(),s=lt(),a=Ve();let c=class Id{constructor(h){this.stateNumber=-1,this.configs=h,this.edges=new Map,this.contextEdges=new Map}get isContextSensitive(){return!!this.contextSymbols}isContextSymbol(h){return this.isContextSensitive?this.contextSymbols.get(h):!1}setContextSymbol(h){a(this.isContextSensitive),this.contextSymbols.set(h)}setContextSensitive(h){a(!this.configs.isOutermostConfigSet),!this.isContextSensitive&&(this.contextSymbols||(this.contextSymbols=new o.BitSet))}get acceptStateInfo(){return this._acceptStateInfo}set acceptStateInfo(h){this._acceptStateInfo=h}get isAcceptState(){return!!this._acceptStateInfo}get prediction(){return this._acceptStateInfo?this._acceptStateInfo.prediction:n.ATN.INVALID_ALT_NUMBER}get lexerActionExecutor(){if(this._acceptStateInfo)return this._acceptStateInfo.lexerActionExecutor}getTarget(h){return this.edges.get(h)}setTarget(h,f){this.edges.set(h,f)}getEdgeMap(){return this.edges}getContextTarget(h){return h===s.PredictionContext.EMPTY_FULL_STATE_KEY&&(h=-1),this.contextEdges.get(h)}setContextTarget(h,f){if(!this.isContextSensitive)throw new Error("The state is not context sensitive.");h===s.PredictionContext.EMPTY_FULL_STATE_KEY&&(h=-1),this.contextEdges.set(h,f)}getContextEdgeMap(){let h=new Map(this.contextEdges),f=h.get(-1);if(f!==void 0)if(h.size===1){let d=new Map;return d.set(s.PredictionContext.EMPTY_FULL_STATE_KEY,f),d}else h.delete(-1),h.set(s.PredictionContext.EMPTY_FULL_STATE_KEY,f);return h}hashCode(){let h=i.MurmurHash.initialize(7);return h=i.MurmurHash.update(h,this.configs.hashCode()),h=i.MurmurHash.finish(h,1),h}equals(h){if(this===h)return!0;if(!(h instanceof Id))return!1;let f=h;return this.configs.equals(f.configs)}toString(){let h="";return h+=this.stateNumber+":"+this.configs,this.isAcceptState&&(h+="=>",this.predicates?h+=this.predicates:h+=this.prediction),h.toString()}};e([r.NotNull],c.prototype,"configs",void 0),e([r.NotNull],c.prototype,"edges",void 0),e([r.NotNull],c.prototype,"contextEdges",void 0),e([r.Override],c.prototype,"hashCode",null),e([r.Override],c.prototype,"equals",null),e([r.Override],c.prototype,"toString",null),l.DFAState=c,function(u){let h=class{constructor(d,p){this.alt=p,this.pred=d}toString(){return"("+this.pred+", "+this.alt+")"}};e([r.NotNull],h.prototype,"pred",void 0),e([r.Override],h.prototype,"toString",null),h=e([t(0,r.NotNull)],h),u.PredPrediction=h}(c=l.DFAState||(l.DFAState={}))}(Zr)),Zr}var Fc;function Mo(){return Fc||(Fc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Jr&&Jr.__decorate||function(a,c,u,h){var f=arguments.length,d=f<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,u):h,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(a,c,u,h);else for(var y=a.length-1;y>=0;y--)(p=a[y])&&(d=(f<3?p(d):f>3?p(c,u,d):p(c,u))||d);return f>3&&d&&Object.defineProperty(c,u,d),d},t=Jr&&Jr.__param||function(a,c){return function(u,h){c(u,h,a)}};Object.defineProperty(l,"__esModule",{value:!0}),l.ATNSimulator=void 0;const n=Zi(),o=Lo(),i=Z(),r=lt();let s=class Hi{constructor(c){this.atn=c}static get ERROR(){return Hi._ERROR||(Hi._ERROR=new o.DFAState(new n.ATNConfigSet),Hi._ERROR.stateNumber=r.PredictionContext.EMPTY_FULL_STATE_KEY),Hi._ERROR}clearDFA(){this.atn.clearDFA()}};e([i.NotNull],s.prototype,"atn",void 0),e([i.NotNull],s,"ERROR",null),s=e([t(0,i.NotNull)],s),l.ATNSimulator=s,s=l.ATNSimulator||(l.ATNSimulator={}),l.ATNSimulator=s}(Jr)),Jr}var Et={},Ti={},Pc;function Dd(){if(Pc)return Ti;Pc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.ConsoleErrorListener=void 0;let l=class{syntaxError(t,n,o,i,r,s){console.error(`line ${o}:${i} ${r}`)}};return Ti.ConsoleErrorListener=l,l.INSTANCE=new l,Ti}var _t={},Ic;function ol(){if(Ic)return _t;Ic=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=_t&&_t.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c},e=_t&&_t.__param||function(o,i){return function(r,s){i(r,s,o)}};Object.defineProperty(_t,"__esModule",{value:!0}),_t.ProxyErrorListener=void 0;const t=Z();let n=class{constructor(i){if(this.delegates=i,!i)throw new Error("Invalid delegates")}getDelegates(){return this.delegates}syntaxError(i,r,s,a,c,u){this.delegates.forEach(h=>{h.syntaxError&&h.syntaxError(i,r,s,a,c,u)})}};return l([t.Override,e(0,t.NotNull),e(4,t.NotNull)],n.prototype,"syntaxError",null),_t.ProxyErrorListener=n,_t}var Dc;function eo(){if(Dc)return Et;Dc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Et&&Et.__decorate||function(a,c,u,h){var f=arguments.length,d=f<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,u):h,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(a,c,u,h);else for(var y=a.length-1;y>=0;y--)(p=a[y])&&(d=(f<3?p(d):f>3?p(c,u,d):p(c,u))||d);return f>3&&d&&Object.defineProperty(c,u,d),d},e=Et&&Et.__param||function(a,c){return function(u,h){c(u,h,a)}};Object.defineProperty(Et,"__esModule",{value:!0}),Et.Recognizer=void 0;const t=Dd(),n=ol(),o=Z(),i=Be(),r=vr();let s=class $i{constructor(){this._listeners=[t.ConsoleErrorListener.INSTANCE],this._stateNumber=-1}getTokenTypeMap(){let c=this.vocabulary,u=$i.tokenTypeMapCache.get(c);if(u==null){let h=new Map;for(let f=0;f<=this.atn.maxTokenType;f++){let d=c.getLiteralName(f);d!=null&&h.set(d,f);let p=c.getSymbolicName(f);p!=null&&h.set(p,f)}h.set("EOF",i.Token.EOF),u=h,$i.tokenTypeMapCache.set(c,u)}return u}getRuleIndexMap(){let c=this.ruleNames;if(c==null)throw new Error("The current recognizer does not provide a list of rule names.");let u=$i.ruleIndexMapCache.get(c);return u==null&&(u=r.toMap(c),$i.ruleIndexMapCache.set(c,u)),u}getTokenType(c){let u=this.getTokenTypeMap().get(c);return u??i.Token.INVALID_TYPE}get serializedATN(){throw new Error("there is no serialized ATN")}get atn(){return this._interp.atn}get interpreter(){return this._interp}set interpreter(c){this._interp=c}get parseInfo(){return Promise.resolve(void 0)}getErrorHeader(c){let u=c.getOffendingToken();if(!u)return"";let h=u.line,f=u.charPositionInLine;return"line "+h+":"+f}addErrorListener(c){if(!c)throw new TypeError("listener must not be null");this._listeners.push(c)}removeErrorListener(c){let u=this._listeners.indexOf(c);u!==-1&&this._listeners.splice(u,1)}removeErrorListeners(){this._listeners.length=0}getErrorListeners(){return this._listeners.slice(0)}getErrorListenerDispatch(){return new n.ProxyErrorListener(this.getErrorListeners())}sempred(c,u,h){return!0}precpred(c,u){return!0}action(c,u,h){}get state(){return this._stateNumber}set state(c){this._stateNumber=c}};return s.EOF=-1,s.tokenTypeMapCache=new WeakMap,s.ruleIndexMapCache=new WeakMap,l([o.SuppressWarnings("serial"),o.NotNull],s.prototype,"_listeners",void 0),l([o.NotNull],s.prototype,"getTokenTypeMap",null),l([o.NotNull],s.prototype,"getRuleIndexMap",null),l([o.NotNull],s.prototype,"serializedATN",null),l([o.NotNull],s.prototype,"atn",null),l([o.NotNull,e(0,o.NotNull)],s.prototype,"interpreter",null),l([o.NotNull,e(0,o.NotNull)],s.prototype,"getErrorHeader",null),l([e(0,o.NotNull)],s.prototype,"addErrorListener",null),l([e(0,o.NotNull)],s.prototype,"removeErrorListener",null),l([o.NotNull],s.prototype,"getErrorListeners",null),Et.Recognizer=s,Et}var en={},Lc;function Gn(){if(Lc)return en;Lc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=en&&en.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c};Object.defineProperty(en,"__esModule",{value:!0}),en.VocabularyImpl=void 0;const e=Z(),t=Be();let n=class{constructor(i,r,s){this.literalNames=i,this.symbolicNames=r,this.displayNames=s,this._maxTokenType=Math.max(this.displayNames.length,Math.max(this.literalNames.length,this.symbolicNames.length))-1}get maxTokenType(){return this._maxTokenType}getLiteralName(i){if(i>=0&&i<this.literalNames.length)return this.literalNames[i]}getSymbolicName(i){if(i>=0&&i<this.symbolicNames.length)return this.symbolicNames[i];if(i===t.Token.EOF)return"EOF"}getDisplayName(i){if(i>=0&&i<this.displayNames.length){let a=this.displayNames[i];if(a)return a}let r=this.getLiteralName(i);if(r)return r;let s=this.getSymbolicName(i);return s||String(i)}};return n.EMPTY_VOCABULARY=new n([],[],[]),l([e.NotNull],n.prototype,"literalNames",void 0),l([e.NotNull],n.prototype,"symbolicNames",void 0),l([e.NotNull],n.prototype,"displayNames",void 0),l([e.Override],n.prototype,"maxTokenType",null),l([e.Override],n.prototype,"getLiteralName",null),l([e.Override],n.prototype,"getSymbolicName",null),l([e.Override,e.NotNull],n.prototype,"getDisplayName",null),l([e.NotNull],n,"EMPTY_VOCABULARY",void 0),en.VocabularyImpl=n,en}var Mc;function Ld(){if(Mc)return Qr;Mc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Qr&&Qr.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f};Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.DFASerializer=void 0;const e=Mo(),t=Z(),n=lt(),o=eo(),i=Gn();let r=class{constructor(a,c,u,h){c instanceof o.Recognizer?(u=c.ruleNames,h=c.atn,c=c.vocabulary):c||(c=i.VocabularyImpl.EMPTY_VOCABULARY),this.dfa=a,this.vocabulary=c,this.ruleNames=u,this.atn=h}toString(){if(!this.dfa.s0)return"";let a="";if(this.dfa.states){let u=new Array(...this.dfa.states.toArray());u.sort((h,f)=>h.stateNumber-f.stateNumber);for(let h of u){let f=h.getEdgeMap(),d=[...f.keys()].sort((m,v)=>m-v),p=h.getContextEdgeMap(),y=[...p.keys()].sort((m,v)=>m-v);for(let m of d){let v=f.get(m);if((v==null||v===e.ATNSimulator.ERROR)&&!h.isContextSymbol(m))continue;let x=!1;a+=this.getStateString(h)+"-"+this.getEdgeLabel(m)+"->",h.isContextSymbol(m)&&(a+="!",x=!0);let g=v;g&&g.stateNumber!==e.ATNSimulator.ERROR.stateNumber?a+=this.getStateString(g)+`
`:x&&(a+=`ctx
`)}if(h.isContextSensitive)for(let m of y)a+=this.getStateString(h)+"-"+this.getContextLabel(m)+"->"+this.getStateString(p.get(m))+`
`}}let c=a;return c.length===0?"":c}getContextLabel(a){if(a===n.PredictionContext.EMPTY_FULL_STATE_KEY)return"ctx:EMPTY_FULL";if(a===n.PredictionContext.EMPTY_LOCAL_STATE_KEY)return"ctx:EMPTY_LOCAL";if(this.atn&&a>0&&a<=this.atn.states.length){let u=this.atn.states[a].ruleIndex;if(this.ruleNames&&u>=0&&u<this.ruleNames.length)return"ctx:"+String(a)+"("+this.ruleNames[u]+")"}return"ctx:"+String(a)}getEdgeLabel(a){return this.vocabulary.getDisplayName(a)}getStateString(a){if(a===e.ATNSimulator.ERROR)return"ERROR";let c=a.stateNumber,u="s"+c;if(a.isAcceptState&&(a.predicates?u=":s"+c+"=>"+a.predicates:u=":s"+c+"=>"+a.prediction),a.isContextSensitive){u+="*";for(let h of a.configs)if(h.reachesIntoOuterContext){u+="*";break}}return u}};return l([t.NotNull],r.prototype,"dfa",void 0),l([t.NotNull],r.prototype,"vocabulary",void 0),l([t.Override],r.prototype,"toString",null),Qr.DFASerializer=r,Qr}var Tt={},Bc;function q0(){if(Bc)return Tt;Bc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Tt&&Tt.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Tt&&Tt.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.LexerDFASerializer=void 0;const t=Ld(),n=Z(),o=Gn();let i=class extends t.DFASerializer{constructor(s){super(s,o.VocabularyImpl.EMPTY_VOCABULARY)}getEdgeLabel(s){return"'"+String.fromCodePoint(s)+"'"}};return l([n.Override,n.NotNull],i.prototype,"getEdgeLabel",null),i=l([e(0,n.NotNull)],i),Tt.LexerDFASerializer=i,Tt}var tn={},kc;function sl(){if(kc)return tn;kc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=tn&&tn.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(tn,"__esModule",{value:!0}),tn.StarLoopEntryState=void 0;const e=He(),t=Pr(),n=Wn(),o=Z();let i=class extends n.DecisionState{constructor(){super(...arguments),this.precedenceRuleDecision=!1,this.precedenceLoopbackStates=new t.BitSet}get stateType(){return e.ATNStateType.STAR_LOOP_ENTRY}};return l([o.Override],i.prototype,"stateType",null),tn.StarLoopEntryState=i,tn}var zc;function Md(){if(zc)return At;zc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=At&&At.__decorate||function(f,d,p,y){var m=arguments.length,v=m<3?d:y===null?y=Object.getOwnPropertyDescriptor(d,p):y,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,d,p,y);else for(var g=f.length-1;g>=0;g--)(x=f[g])&&(v=(m<3?x(v):m>3?x(d,p,v):x(d,p))||v);return m>3&&v&&Object.defineProperty(d,p,v),v},e=At&&At.__param||function(f,d){return function(p,y){d(p,y,f)}};Object.defineProperty(At,"__esModule",{value:!0}),At.DFA=void 0;const t=Fr(),n=Zi(),o=Ld(),i=Lo(),r=q0(),s=Z(),a=ht(),c=sl(),u=Gn();let h=class{constructor(d,p=0){if(this.states=new t.Array2DHashSet(a.ObjectEqualityComparator.INSTANCE),this.nextStateNumber=0,!d.atn)throw new Error("The ATNState must be associated with an ATN");this.atnStartState=d,this.atn=d.atn,this.decision=p;let y=!1;d instanceof c.StarLoopEntryState&&d.precedenceRuleDecision&&(y=!0,this.s0=new i.DFAState(new n.ATNConfigSet),this.s0full=new i.DFAState(new n.ATNConfigSet)),this.precedenceDfa=y}get isPrecedenceDfa(){return this.precedenceDfa}getPrecedenceStartState(d,p){if(!this.isPrecedenceDfa)throw new Error("Only precedence DFAs may contain a precedence start state.");return p?this.s0full.getTarget(d):this.s0.getTarget(d)}setPrecedenceStartState(d,p,y){if(!this.isPrecedenceDfa)throw new Error("Only precedence DFAs may contain a precedence start state.");d<0||(p?this.s0full.setTarget(d,y):this.s0.setTarget(d,y))}get isEmpty(){return this.isPrecedenceDfa?this.s0.getEdgeMap().size===0&&this.s0full.getEdgeMap().size===0:this.s0==null&&this.s0full==null}get isContextSensitive(){return this.isPrecedenceDfa?this.s0full.getEdgeMap().size>0:this.s0full!=null}addState(d){return d.stateNumber=this.nextStateNumber++,this.states.getOrAdd(d)}toString(d,p){if(d||(d=u.VocabularyImpl.EMPTY_VOCABULARY),!this.s0)return"";let y;return p?y=new o.DFASerializer(this,d,p,this.atnStartState.atn):y=new o.DFASerializer(this,d),y.toString()}toLexerString(){return this.s0?new r.LexerDFASerializer(this).toString():""}};return l([s.NotNull],h.prototype,"states",void 0),l([s.NotNull],h.prototype,"atnStartState",void 0),l([s.NotNull],h.prototype,"atn",void 0),h=l([e(0,s.NotNull)],h),At.DFA=h,At}var rn={},nn={},jc;function Bd(){if(jc)return nn;jc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=nn&&nn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(nn,"__esModule",{value:!0}),nn.BasicState=void 0;const e=yr(),t=He(),n=Z();let o=class extends e.ATNState{get stateType(){return t.ATNStateType.BASIC}};return l([n.Override],o.prototype,"stateType",null),nn.BasicState=o,nn}var qc;function kd(){if(qc)return rn;qc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=rn&&rn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(rn,"__esModule",{value:!0}),rn.InvalidState=void 0;const e=He(),t=Bd(),n=Z();let o=class extends t.BasicState{get stateType(){return e.ATNStateType.INVALID_TYPE}};return l([n.Override],o.prototype,"stateType",null),rn.InvalidState=o,rn}var bt={},Nt={},Rt={},Uc;function al(){if(Uc)return Rt;Uc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Rt&&Rt.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f},e=Rt&&Rt.__param||function(s,a){return function(c,u){a(c,u,s)}};Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.SetTransition=void 0;const t=Yn(),n=Z(),o=Be(),i=Or();let r=class extends i.Transition{constructor(a,c){super(a),c==null&&(c=t.IntervalSet.of(o.Token.INVALID_TYPE)),this.set=c}get serializationType(){return 7}get label(){return this.set}matches(a,c,u){return this.set.contains(a)}toString(){return this.set.toString()}};return l([n.NotNull],r.prototype,"set",void 0),l([n.Override],r.prototype,"serializationType",null),l([n.Override,n.NotNull],r.prototype,"label",null),l([n.Override],r.prototype,"matches",null),l([n.Override,n.NotNull],r.prototype,"toString",null),r=l([e(0,n.NotNull),e(1,n.Nullable)],r),Rt.SetTransition=r,Rt}var Hc;function ll(){if(Hc)return Nt;Hc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Nt&&Nt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=Nt&&Nt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.NotSetTransition=void 0;const t=Z(),n=al();let o=class extends n.SetTransition{constructor(r,s){super(r,s)}get serializationType(){return 8}matches(r,s,a){return r>=s&&r<=a&&!super.matches(r,s,a)}toString(){return"~"+super.toString()}};return l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"matches",null),l([t.Override],o.prototype,"toString",null),o=l([e(0,t.NotNull),e(1,t.Nullable)],o),Nt.NotSetTransition=o,Nt}var on={},$c;function to(){if($c)return on;$c=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=on&&on.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(on,"__esModule",{value:!0}),on.RuleStopState=void 0;const e=yr(),t=He(),n=Z();let o=class extends e.ATNState{get nonStopStateNumber(){return-1}get stateType(){return t.ATNStateType.RULE_STOP}};return l([n.Override],o.prototype,"nonStopStateNumber",null),l([n.Override],o.prototype,"stateType",null),on.RuleStopState=o,on}var wt={},Vc;function ul(){if(Vc)return wt;Vc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=wt&&wt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=wt&&wt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(wt,"__esModule",{value:!0}),wt.RuleTransition=void 0;const t=Z(),n=Or();let o=class extends n.Transition{constructor(r,s,a,c){super(r),this.tailCall=!1,this.optimizedTailCall=!1,this.ruleIndex=s,this.precedence=a,this.followState=c}get serializationType(){return 3}get isEpsilon(){return!0}matches(r,s,a){return!1}};return l([t.NotNull],o.prototype,"followState",void 0),l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"isEpsilon",null),l([t.Override],o.prototype,"matches",null),o=l([e(0,t.NotNull),e(3,t.NotNull)],o),wt.RuleTransition=o,wt}var Ot={},Wc;function zd(){if(Wc)return Ot;Wc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ot&&Ot.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=Ot&&Ot.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.WildcardTransition=void 0;const t=Z(),n=Or();let o=class extends n.Transition{constructor(r){super(r)}get serializationType(){return 9}matches(r,s,a){return r>=s&&r<=a}toString(){return"."}};return l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"matches",null),l([t.Override,t.NotNull],o.prototype,"toString",null),o=l([e(0,t.NotNull)],o),Ot.WildcardTransition=o,Ot}var Gc;function U0(){if(Gc)return bt;Gc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=bt&&bt.__decorate||function(m,v,x,g){var S=arguments.length,C=S<3?v:g===null?g=Object.getOwnPropertyDescriptor(v,x):g,A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(m,v,x,g);else for(var b=m.length-1;b>=0;b--)(A=m[b])&&(C=(S<3?A(C):S>3?A(v,x,C):A(v,x))||C);return S>3&&C&&Object.defineProperty(v,x,C),C},e=bt&&bt.__param||function(m,v){return function(x,g){v(x,g,m)}};Object.defineProperty(bt,"__esModule",{value:!0}),bt.LL1Analyzer=void 0;const t=el(),n=Fr(),o=Do(),i=Pr(),r=Yn(),s=Z(),a=ll(),c=ht(),u=lt(),h=to(),f=ul(),d=Be(),p=zd();let y=class Ma{constructor(v){this.atn=v}getDecisionLookahead(v){if(v==null)return;let x=new Array(v.numberOfTransitions);for(let g=0;g<v.numberOfTransitions;g++){let S=new r.IntervalSet;x[g]=S;let C=new n.Array2DHashSet(c.ObjectEqualityComparator.INSTANCE);this._LOOK(v.transition(g).target,void 0,u.PredictionContext.EMPTY_LOCAL,S,C,new i.BitSet,!1,!1),(S.size===0||S.contains(Ma.HIT_PRED))&&(S=void 0,x[g]=S)}return x}LOOK(v,x,g){if(g===void 0){if(v.atn==null)throw new Error("Illegal state");g=v.atn.ruleToStopState[v.ruleIndex]}else g===null&&(g=void 0);let S=new r.IntervalSet;return this._LOOK(v,g,x,S,new n.Array2DHashSet,new i.BitSet,!0,!0),S}_LOOK(v,x,g,S,C,A,b,N){let R=o.ATNConfig.create(v,0,g);if(!C.add(R))return;if(v===x){if(u.PredictionContext.isEmptyLocal(g)){S.add(d.Token.EPSILON);return}else if(g.isEmpty){N&&S.add(d.Token.EOF);return}}if(v instanceof h.RuleStopState){if(g.isEmpty&&!u.PredictionContext.isEmptyLocal(g)){N&&S.add(d.Token.EOF);return}let k=A.get(v.ruleIndex);try{A.clear(v.ruleIndex);for(let D=0;D<g.size;D++){if(g.getReturnState(D)===u.PredictionContext.EMPTY_FULL_STATE_KEY)continue;let H=this.atn.states[g.getReturnState(D)];this._LOOK(H,x,g.getParent(D),S,C,A,b,N)}}finally{k&&A.set(v.ruleIndex)}}let P=v.numberOfTransitions;for(let k=0;k<P;k++){let D=v.transition(k);if(D instanceof f.RuleTransition){if(A.get(D.ruleIndex))continue;let H=g.getChild(D.followState.stateNumber);try{A.set(D.ruleIndex),this._LOOK(D.target,x,H,S,C,A,b,N)}finally{A.clear(D.ruleIndex)}}else if(D instanceof t.AbstractPredicateTransition)b?this._LOOK(D.target,x,g,S,C,A,b,N):S.add(Ma.HIT_PRED);else if(D.isEpsilon)this._LOOK(D.target,x,g,S,C,A,b,N);else if(D instanceof p.WildcardTransition)S.addAll(r.IntervalSet.of(d.Token.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType));else{let H=D.label;H!=null&&(D instanceof a.NotSetTransition&&(H=H.complement(r.IntervalSet.of(d.Token.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType))),S.addAll(H))}}}};return y.HIT_PRED=d.Token.INVALID_TYPE,l([s.NotNull],y.prototype,"atn",void 0),l([s.NotNull,e(0,s.NotNull),e(1,s.NotNull)],y.prototype,"LOOK",null),l([e(0,s.NotNull),e(2,s.NotNull),e(3,s.NotNull),e(4,s.NotNull),e(5,s.NotNull)],y.prototype,"_LOOK",null),y=l([e(0,s.NotNull)],y),bt.LL1Analyzer=y,bt}var Yc;function ft(){return Yc||(Yc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Yr&&Yr.__decorate||function(p,y,m,v){var x=arguments.length,g=x<3?y:v===null?v=Object.getOwnPropertyDescriptor(y,m):v,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(p,y,m,v);else for(var C=p.length-1;C>=0;C--)(S=p[C])&&(g=(x<3?S(g):x>3?S(y,m,g):S(y,m))||g);return x>3&&g&&Object.defineProperty(y,m,g),g},t=Yr&&Yr.__param||function(p,y){return function(m,v){y(m,v,p)}};Object.defineProperty(l,"__esModule",{value:!0}),l.ATN=void 0;const n=fi(),o=Md(),i=Yn(),r=kd(),s=U0(),a=Z(),c=ht(),u=lt(),h=Be(),f=Ve();let d=class{constructor(y,m){this.states=[],this.decisionToState=[],this.modeNameToStartState=new Map,this.modeToStartState=[],this.contextCache=new n.Array2DHashMap(c.ObjectEqualityComparator.INSTANCE),this.decisionToDFA=[],this.modeToDFA=[],this.LL1Table=new Map,this.grammarType=y,this.maxTokenType=m}clearDFA(){this.decisionToDFA=new Array(this.decisionToState.length);for(let y=0;y<this.decisionToDFA.length;y++)this.decisionToDFA[y]=new o.DFA(this.decisionToState[y],y);this.modeToDFA=new Array(this.modeToStartState.length);for(let y=0;y<this.modeToDFA.length;y++)this.modeToDFA[y]=new o.DFA(this.modeToStartState[y]);this.contextCache.clear(),this.LL1Table.clear()}get contextCacheSize(){return this.contextCache.size}getCachedContext(y){return u.PredictionContext.getCachedContext(y,this.contextCache,new u.PredictionContext.IdentityHashMap)}getDecisionToDFA(){return f(this.decisionToDFA!=null&&this.decisionToDFA.length===this.decisionToState.length),this.decisionToDFA}nextTokens(y,m){return m?new s.LL1Analyzer(this).LOOK(y,m):(y.nextTokenWithinRule||(y.nextTokenWithinRule=this.nextTokens(y,u.PredictionContext.EMPTY_LOCAL),y.nextTokenWithinRule.setReadonly(!0)),y.nextTokenWithinRule)}addState(y){y.atn=this,y.stateNumber=this.states.length,this.states.push(y)}removeState(y){let m=new r.InvalidState;m.atn=this,m.stateNumber=y.stateNumber,this.states[y.stateNumber]=m}defineMode(y,m){this.modeNameToStartState.set(y,m),this.modeToStartState.push(m),this.modeToDFA.push(new o.DFA(m)),this.defineDecisionState(m)}defineDecisionState(y){return this.decisionToState.push(y),y.decision=this.decisionToState.length-1,this.decisionToDFA.push(new o.DFA(y,y.decision)),y.decision}getDecisionState(y){if(this.decisionToState.length>0)return this.decisionToState[y]}get numberOfDecisions(){return this.decisionToState.length}getExpectedTokens(y,m){if(y<0||y>=this.states.length)throw new RangeError("Invalid state number.");let v=m,x=this.states[y],g=this.nextTokens(x);if(!g.contains(h.Token.EPSILON))return g;let S=new i.IntervalSet;for(S.addAll(g),S.remove(h.Token.EPSILON);v!=null&&v.invokingState>=0&&g.contains(h.Token.EPSILON);){let A=this.states[v.invokingState].transition(0);g=this.nextTokens(A.followState),S.addAll(g),S.remove(h.Token.EPSILON),v=v._parent}return g.contains(h.Token.EPSILON)&&S.add(h.Token.EOF),S}};e([a.NotNull],d.prototype,"states",void 0),e([a.NotNull],d.prototype,"decisionToState",void 0),e([a.NotNull],d.prototype,"modeNameToStartState",void 0),e([a.NotNull],d.prototype,"modeToStartState",void 0),e([a.NotNull],d.prototype,"decisionToDFA",void 0),e([a.NotNull],d.prototype,"modeToDFA",void 0),e([a.NotNull],d.prototype,"nextTokens",null),e([t(0,a.NotNull)],d.prototype,"removeState",null),e([t(0,a.NotNull),t(1,a.NotNull)],d.prototype,"defineMode",null),e([t(0,a.NotNull)],d.prototype,"defineDecisionState",null),e([a.NotNull],d.prototype,"getExpectedTokens",null),d=e([t(0,a.NotNull)],d),l.ATN=d,function(p){p.INVALID_ALT_NUMBER=0}(d=l.ATN||(l.ATN={})),l.ATN=d}(Yr)),Yr}var Ft={},Pt={},Xc;function H0(){if(Xc)return Pt;Xc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Pt&&Pt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=Pt&&Pt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.LexerIndexedCustomAction=void 0;const t=je(),n=Z();let o=class jd{constructor(r,s){this._offset=r,this._action=s}get offset(){return this._offset}get action(){return this._action}get actionType(){return this._action.actionType}get isPositionDependent(){return!0}execute(r){this._action.execute(r)}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this._offset),r=t.MurmurHash.update(r,this._action),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof jd?this._offset===r._offset&&this._action.equals(r._action):!1}};return l([n.NotNull],o.prototype,"action",null),l([n.Override],o.prototype,"actionType",null),l([n.Override],o.prototype,"isPositionDependent",null),l([n.Override],o.prototype,"execute",null),l([n.Override],o.prototype,"hashCode",null),l([n.Override],o.prototype,"equals",null),o=l([e(1,n.NotNull)],o),Pt.LexerIndexedCustomAction=o,Pt}var Kc;function $0(){if(Kc)return Ft;Kc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ft&&Ft.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f},e=Ft&&Ft.__param||function(s,a){return function(c,u){a(c,u,s)}};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.LexerActionExecutor=void 0;const t=Fo(),n=H0(),o=je(),i=Z();let r=class Vi{constructor(a){this._lexerActions=a;let c=o.MurmurHash.initialize();for(let u of a)c=o.MurmurHash.update(c,u);this.cachedHashCode=o.MurmurHash.finish(c,a.length)}static append(a,c){if(!a)return new Vi([c]);let u=a._lexerActions.slice(0);return u.push(c),new Vi(u)}fixOffsetBeforeMatch(a){let c;for(let u=0;u<this._lexerActions.length;u++)this._lexerActions[u].isPositionDependent&&!(this._lexerActions[u]instanceof n.LexerIndexedCustomAction)&&(c||(c=this._lexerActions.slice(0)),c[u]=new n.LexerIndexedCustomAction(a,this._lexerActions[u]));return c?new Vi(c):this}get lexerActions(){return this._lexerActions}execute(a,c,u){let h=!1,f=c.index;try{for(let d of this._lexerActions){if(d instanceof n.LexerIndexedCustomAction){let p=d.offset;c.seek(u+p),d=d.action,h=u+p!==f}else d.isPositionDependent&&(c.seek(f),h=!1);d.execute(a)}}finally{h&&c.seek(f)}}hashCode(){return this.cachedHashCode}equals(a){return a===this?!0:a instanceof Vi?this.cachedHashCode===a.cachedHashCode&&t.ArrayEqualityComparator.INSTANCE.equals(this._lexerActions,a._lexerActions):!1}};return l([i.NotNull],r.prototype,"_lexerActions",void 0),l([i.NotNull],r.prototype,"lexerActions",null),l([e(0,i.NotNull)],r.prototype,"execute",null),l([i.Override],r.prototype,"hashCode",null),l([i.Override],r.prototype,"equals",null),l([i.NotNull,e(1,i.NotNull)],r,"append",null),r=l([e(0,i.NotNull)],r),Ft.LexerActionExecutor=r,Ft}var It={},Qc;function Bo(){if(Qc)return It;Qc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=It&&It.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f},e=It&&It.__param||function(s,a){return function(c,u){a(c,u,s)}};Object.defineProperty(It,"__esModule",{value:!0}),It.LexerNoViableAltException=void 0;const t=wr(),n=Z(),o=Xe(),i=vr();let r=class extends t.RecognitionException{constructor(a,c,u,h){super(a,c),this._startIndex=u,this._deadEndConfigs=h}get startIndex(){return this._startIndex}get deadEndConfigs(){return this._deadEndConfigs}get inputStream(){return super.inputStream}toString(){let a="";return this._startIndex>=0&&this._startIndex<this.inputStream.size&&(a=this.inputStream.getText(o.Interval.of(this._startIndex,this._startIndex)),a=i.escapeWhitespace(a,!1)),`LexerNoViableAltException('${a}')`}};return l([n.Override],r.prototype,"inputStream",null),l([n.Override],r.prototype,"toString",null),r=l([e(1,n.NotNull)],r),It.LexerNoViableAltException=r,It}var sn={},Jc;function V0(){if(Jc)return sn;Jc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=sn&&sn.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c};Object.defineProperty(sn,"__esModule",{value:!0}),sn.OrderedATNConfigSet=void 0;const e=Zi(),t=Z();let n=class qd extends e.ATNConfigSet{constructor(i,r){i!=null&&r!=null?super(i,r):super()}clone(i){let r=new qd(this,i);return!i&&this.isReadOnly&&r.addAll(this),r}getKey(i){return{state:0,alt:i.hashCode()}}canMerge(i,r,s){return i.equals(s)}};return l([t.Override],n.prototype,"clone",null),l([t.Override],n.prototype,"getKey",null),l([t.Override],n.prototype,"canMerge",null),sn.OrderedATNConfigSet=n,sn}var Zc;function ko(){return Zc||(Zc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Gr&&Gr.__decorate||function(C,A,b,N){var R=arguments.length,P=R<3?A:N===null?N=Object.getOwnPropertyDescriptor(A,b):N,k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(C,A,b,N);else for(var D=C.length-1;D>=0;D--)(k=C[D])&&(P=(R<3?k(P):R>3?k(A,b,P):k(A,b))||P);return R>3&&P&&Object.defineProperty(A,b,P),P},t=Gr&&Gr.__param||function(C,A){return function(b,N){A(b,N,C)}};Object.defineProperty(l,"__esModule",{value:!0}),l.LexerATNSimulator=void 0;const n=Fd(),o=ft(),i=Do(),r=Zi(),s=Mo(),a=Lo(),c=Xe(),u=Rr(),h=Ir(),f=$0(),d=Bo(),p=Z(),y=V0(),m=lt(),v=to(),x=Be(),g=Ve();let S=class Qe extends s.ATNSimulator{constructor(A,b){super(A),this.optimize_tail_calls=!0,this.startIndex=-1,this._line=1,this._charPositionInLine=0,this.mode=h.Lexer.DEFAULT_MODE,this.prevAccept=new Qe.SimState,this.recog=b}copyState(A){this._charPositionInLine=A.charPositionInLine,this._line=A._line,this.mode=A.mode,this.startIndex=A.startIndex}match(A,b){this.mode=b;let N=A.mark();try{this.startIndex=A.index,this.prevAccept.reset();let R=this.atn.modeToDFA[b].s0;return R==null?this.matchATN(A):this.execATN(A,R)}finally{A.release(N)}}reset(){this.prevAccept.reset(),this.startIndex=-1,this._line=1,this._charPositionInLine=0,this.mode=h.Lexer.DEFAULT_MODE}matchATN(A){let b=this.atn.modeToStartState[this.mode];Qe.debug&&console.log(`matchATN mode ${this.mode} start: ${b}`);let N=this.mode,R=this.computeStartState(A,b),P=R.hasSemanticContext;P&&(R.hasSemanticContext=!1);let k=this.addDFAState(R);if(!P){let H=this.atn.modeToDFA[this.mode];H.s0?k=H.s0:H.s0=k}let D=this.execATN(A,k);return Qe.debug&&console.log(`DFA after matchATN: ${this.atn.modeToDFA[N].toLexerString()}`),D}execATN(A,b){Qe.debug&&console.log(`start state closure=${b.configs}`),b.isAcceptState&&this.captureSimState(this.prevAccept,A,b);let N=A.LA(1),R=b;for(;;){Qe.debug&&console.log(`execATN loop starting closure: ${R.configs}`);let P=this.getExistingTargetState(R,N);if(P==null&&(P=this.computeTargetState(A,R,N)),P===s.ATNSimulator.ERROR||(N!==u.IntStream.EOF&&this.consume(A),P.isAcceptState&&(this.captureSimState(this.prevAccept,A,P),N===u.IntStream.EOF)))break;N=A.LA(1),R=P}return this.failOrAccept(this.prevAccept,A,R.configs,N)}getExistingTargetState(A,b){let N=A.getTarget(b);return Qe.debug&&N!=null&&console.log("reuse state "+A.stateNumber+" edge to "+N.stateNumber),N}computeTargetState(A,b,N){let R=new y.OrderedATNConfigSet;return this.getReachableConfigSet(A,b.configs,R,N),R.isEmpty?(R.hasSemanticContext||this.addDFAEdge(b,N,s.ATNSimulator.ERROR),s.ATNSimulator.ERROR):this.addDFAEdge(b,N,R)}failOrAccept(A,b,N,R){if(A.dfaState!=null){let P=A.dfaState.lexerActionExecutor;return this.accept(b,P,this.startIndex,A.index,A.line,A.charPos),A.dfaState.prediction}else{if(R===u.IntStream.EOF&&b.index===this.startIndex)return x.Token.EOF;throw new d.LexerNoViableAltException(this.recog,b,this.startIndex,N)}}getReachableConfigSet(A,b,N,R){let P=o.ATN.INVALID_ALT_NUMBER;for(let k of b){let D=k.alt===P;if(D&&k.hasPassedThroughNonGreedyDecision)continue;Qe.debug&&console.log(`testing ${this.getTokenName(R)} at ${k.toString(this.recog,!0)}`);let H=k.state.numberOfOptimizedTransitions;for(let J=0;J<H;J++){let te=k.state.getOptimizedTransition(J),le=this.getReachableTarget(te,R);if(le!=null){let ge=k.lexerActionExecutor,ce;ge!=null?(ge=ge.fixOffsetBeforeMatch(A.index-this.startIndex),ce=k.transform(le,!0,ge)):(g(k.lexerActionExecutor==null),ce=k.transform(le,!0));let ee=R===u.IntStream.EOF;if(this.closure(A,ce,N,D,!0,ee)){P=k.alt;break}}}}}accept(A,b,N,R,P,k){Qe.debug&&console.log(`ACTION ${b}`),A.seek(R),this._line=P,this._charPositionInLine=k,b!=null&&this.recog!=null&&b.execute(this.recog,A,N)}getReachableTarget(A,b){if(A.matches(b,h.Lexer.MIN_CHAR_VALUE,h.Lexer.MAX_CHAR_VALUE))return A.target}computeStartState(A,b){let N=m.PredictionContext.EMPTY_FULL,R=new y.OrderedATNConfigSet;for(let P=0;P<b.numberOfTransitions;P++){let k=b.transition(P).target,D=i.ATNConfig.create(k,P+1,N);this.closure(A,D,R,!1,!1,!1)}return R}closure(A,b,N,R,P,k){if(Qe.debug&&console.log("closure("+b.toString(this.recog,!0)+")"),b.state instanceof v.RuleStopState){Qe.debug&&(this.recog!=null?console.log(`closure at ${this.recog.ruleNames[b.state.ruleIndex]} rule stop ${b}`):console.log(`closure at rule stop ${b}`));let H=b.context;if(H.isEmpty)return N.add(b),!0;H.hasEmpty&&(N.add(b.transform(b.state,!0,m.PredictionContext.EMPTY_FULL)),R=!0);for(let J=0;J<H.size;J++){let te=H.getReturnState(J);if(te===m.PredictionContext.EMPTY_FULL_STATE_KEY)continue;let le=H.getParent(J),ge=this.atn.states[te],ce=b.transform(ge,!1,le);R=this.closure(A,ce,N,R,P,k)}return R}b.state.onlyHasEpsilonTransitions||(!R||!b.hasPassedThroughNonGreedyDecision)&&N.add(b);let D=b.state;for(let H=0;H<D.numberOfOptimizedTransitions;H++){let J=D.getOptimizedTransition(H),te=this.getEpsilonTarget(A,b,J,N,P,k);te!=null&&(R=this.closure(A,te,N,R,P,k))}return R}getEpsilonTarget(A,b,N,R,P,k){let D;switch(N.serializationType){case 3:let H=N;if(this.optimize_tail_calls&&H.optimizedTailCall&&!b.context.hasEmpty)D=b.transform(N.target,!0);else{let te=b.context.getChild(H.followState.stateNumber);D=b.transform(N.target,!0,te)}break;case 10:throw new Error("Precedence predicates are not supported in lexers.");case 4:let J=N;Qe.debug&&console.log("EVAL rule "+J.ruleIndex+":"+J.predIndex),R.hasSemanticContext=!0,this.evaluatePredicate(A,J.ruleIndex,J.predIndex,P)?D=b.transform(N.target,!0):D=void 0;break;case 6:if(b.context.hasEmpty){let te=f.LexerActionExecutor.append(b.lexerActionExecutor,this.atn.lexerActions[N.actionIndex]);D=b.transform(N.target,!0,te);break}else{D=b.transform(N.target,!0);break}case 1:D=b.transform(N.target,!0);break;case 5:case 2:case 7:if(k&&N.matches(u.IntStream.EOF,h.Lexer.MIN_CHAR_VALUE,h.Lexer.MAX_CHAR_VALUE)){D=b.transform(N.target,!1);break}D=void 0;break;default:D=void 0;break}return D}evaluatePredicate(A,b,N,R){if(this.recog==null)return!0;if(!R)return this.recog.sempred(void 0,b,N);let P=this._charPositionInLine,k=this._line,D=A.index,H=A.mark();try{return this.consume(A),this.recog.sempred(void 0,b,N)}finally{this._charPositionInLine=P,this._line=k,A.seek(D),A.release(H)}}captureSimState(A,b,N){A.index=b.index,A.line=this._line,A.charPos=this._charPositionInLine,A.dfaState=N}addDFAEdge(A,b,N){if(N instanceof r.ATNConfigSet){let R=N.hasSemanticContext;R&&(N.hasSemanticContext=!1);let P=this.addDFAState(N);return R||this.addDFAEdge(A,b,P),P}else Qe.debug&&console.log("EDGE "+A+" -> "+N+" upon "+String.fromCharCode(b)),A!=null&&A.setTarget(b,N)}addDFAState(A){g(!A.hasSemanticContext);let b=new a.DFAState(A),N=this.atn.modeToDFA[this.mode].states.get(b);if(N!=null)return N;A.optimizeConfigs(this);let R=new a.DFAState(A.clone(!0)),P;for(let k of A)if(k.state instanceof v.RuleStopState){P=k;break}if(P!=null){let k=this.atn.ruleToTokenType[P.state.ruleIndex],D=P.lexerActionExecutor;R.acceptStateInfo=new n.AcceptStateInfo(k,D)}return this.atn.modeToDFA[this.mode].addState(R)}getDFA(A){return this.atn.modeToDFA[A]}getText(A){return A.getText(c.Interval.of(this.startIndex,A.index-1))}get line(){return this._line}set line(A){this._line=A}get charPositionInLine(){return this._charPositionInLine}set charPositionInLine(A){this._charPositionInLine=A}consume(A){A.LA(1)===10?(this._line++,this._charPositionInLine=0):this._charPositionInLine++,A.consume()}getTokenName(A){return A===-1?"EOF":"'"+String.fromCharCode(A)+"'"}};e([p.NotNull],S.prototype,"prevAccept",void 0),e([t(0,p.NotNull)],S.prototype,"copyState",null),e([t(0,p.NotNull)],S.prototype,"match",null),e([p.Override],S.prototype,"reset",null),e([t(0,p.NotNull)],S.prototype,"matchATN",null),e([t(0,p.NotNull),t(1,p.NotNull)],S.prototype,"execATN",null),e([t(0,p.NotNull)],S.prototype,"getExistingTargetState",null),e([p.NotNull,t(0,p.NotNull),t(1,p.NotNull)],S.prototype,"computeTargetState",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull)],S.prototype,"getReachableConfigSet",null),e([t(0,p.NotNull)],S.prototype,"accept",null),e([p.NotNull,t(0,p.NotNull),t(1,p.NotNull)],S.prototype,"computeStartState",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull)],S.prototype,"closure",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull),t(3,p.NotNull)],S.prototype,"getEpsilonTarget",null),e([t(0,p.NotNull)],S.prototype,"evaluatePredicate",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull)],S.prototype,"captureSimState",null),e([p.NotNull,t(0,p.NotNull)],S.prototype,"addDFAState",null),e([p.NotNull],S.prototype,"getDFA",null),e([p.NotNull,t(0,p.NotNull)],S.prototype,"getText",null),e([t(0,p.NotNull)],S.prototype,"consume",null),e([p.NotNull],S.prototype,"getTokenName",null),S=e([t(0,p.NotNull)],S),l.LexerATNSimulator=S,function(C){C.debug=!1,C.dfa_debug=!1;class A{constructor(){this.index=-1,this.line=0,this.charPos=-1}reset(){this.index=-1,this.line=0,this.charPos=-1,this.dfaState=void 0}}C.SimState=A}(S=l.LexerATNSimulator||(l.LexerATNSimulator={})),l.LexerATNSimulator=S}(Gr)),Gr}var eh;function Ir(){if(eh)return Wr;eh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Wr&&Wr.__decorate||function(h,f,d,p){var y=arguments.length,m=y<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,d):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(h,f,d,p);else for(var x=h.length-1;x>=0;x--)(v=h[x])&&(m=(y<3?v(m):y>3?v(f,d,m):v(f,d))||m);return y>3&&m&&Object.defineProperty(f,d,m),m};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.Lexer=void 0;const e=nl(),t=Od(),n=Xe(),o=Rr(),i=ko(),r=Bo(),s=Z(),a=eo(),c=Be();let u=class Ar extends a.Recognizer{constructor(f){super(),this._factory=e.CommonTokenFactory.DEFAULT,this._tokenStartCharIndex=-1,this._tokenStartLine=0,this._tokenStartCharPositionInLine=0,this._hitEOF=!1,this._channel=0,this._type=0,this._modeStack=new t.IntegerStack,this._mode=Ar.DEFAULT_MODE,this._input=f,this._tokenFactorySourcePair={source:this,stream:f}}static get DEFAULT_TOKEN_CHANNEL(){return c.Token.DEFAULT_CHANNEL}static get HIDDEN(){return c.Token.HIDDEN_CHANNEL}reset(f){(f===void 0||f)&&this._input.seek(0),this._token=void 0,this._type=c.Token.INVALID_TYPE,this._channel=c.Token.DEFAULT_CHANNEL,this._tokenStartCharIndex=-1,this._tokenStartCharPositionInLine=-1,this._tokenStartLine=-1,this._text=void 0,this._hitEOF=!1,this._mode=Ar.DEFAULT_MODE,this._modeStack.clear(),this.interpreter.reset()}nextToken(){if(this._input==null)throw new Error("nextToken requires a non-null input stream.");let f=this._input.mark();try{e:for(;;){if(this._hitEOF)return this.emitEOF();this._token=void 0,this._channel=c.Token.DEFAULT_CHANNEL,this._tokenStartCharIndex=this._input.index,this._tokenStartCharPositionInLine=this.interpreter.charPositionInLine,this._tokenStartLine=this.interpreter.line,this._text=void 0;do{this._type=c.Token.INVALID_TYPE;let d;try{d=this.interpreter.match(this._input,this._mode)}catch(p){if(p instanceof r.LexerNoViableAltException)this.notifyListeners(p),this.recover(p),d=Ar.SKIP;else throw p}if(this._input.LA(1)===o.IntStream.EOF&&(this._hitEOF=!0),this._type===c.Token.INVALID_TYPE&&(this._type=d),this._type===Ar.SKIP)continue e}while(this._type===Ar.MORE);return this._token==null?this.emit():this._token}}finally{this._input.release(f)}}skip(){this._type=Ar.SKIP}more(){this._type=Ar.MORE}mode(f){this._mode=f}pushMode(f){i.LexerATNSimulator.debug&&console.log("pushMode "+f),this._modeStack.push(this._mode),this.mode(f)}popMode(){if(this._modeStack.isEmpty)throw new Error("EmptyStackException");return i.LexerATNSimulator.debug&&console.log("popMode back to "+this._modeStack.peek()),this.mode(this._modeStack.pop()),this._mode}get tokenFactory(){return this._factory}set tokenFactory(f){this._factory=f}get inputStream(){return this._input}set inputStream(f){this.reset(!1),this._input=f,this._tokenFactorySourcePair={source:this,stream:this._input}}get sourceName(){return this._input.sourceName}emit(f){return f||(f=this._factory.create(this._tokenFactorySourcePair,this._type,this._text,this._channel,this._tokenStartCharIndex,this.charIndex-1,this._tokenStartLine,this._tokenStartCharPositionInLine)),this._token=f,f}emitEOF(){let f=this.charPositionInLine,d=this.line,p=this._factory.create(this._tokenFactorySourcePair,c.Token.EOF,void 0,c.Token.DEFAULT_CHANNEL,this._input.index,this._input.index-1,d,f);return this.emit(p),p}get line(){return this.interpreter.line}set line(f){this.interpreter.line=f}get charPositionInLine(){return this.interpreter.charPositionInLine}set charPositionInLine(f){this.interpreter.charPositionInLine=f}get charIndex(){return this._input.index}get text(){return this._text!=null?this._text:this.interpreter.getText(this._input)}set text(f){this._text=f}get token(){return this._token}set token(f){this._token=f}set type(f){this._type=f}get type(){return this._type}set channel(f){this._channel=f}get channel(){return this._channel}getAllTokens(){let f=[],d=this.nextToken();for(;d.type!==c.Token.EOF;)f.push(d),d=this.nextToken();return f}notifyListeners(f){let d=this._input.getText(n.Interval.of(this._tokenStartCharIndex,this._input.index)),p="token recognition error at: '"+this.getErrorDisplay(d)+"'",y=this.getErrorListenerDispatch();y.syntaxError&&y.syntaxError(this,void 0,this._tokenStartLine,this._tokenStartCharPositionInLine,p,f)}getErrorDisplay(f){if(typeof f=="number"){switch(f){case c.Token.EOF:return"<EOF>";case 10:return"\\n";case 9:return"\\t";case 13:return"\\r"}return String.fromCharCode(f)}return f.replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}getCharErrorDisplay(f){return"'"+this.getErrorDisplay(f)+"'"}recover(f){f instanceof r.LexerNoViableAltException?this._input.LA(1)!==o.IntStream.EOF&&this.interpreter.consume(this._input):this._input.consume()}};return u.DEFAULT_MODE=0,u.MORE=-2,u.SKIP=-3,u.MIN_CHAR_VALUE=0,u.MAX_CHAR_VALUE=1114111,l([s.Override],u.prototype,"nextToken",null),l([s.Override],u.prototype,"tokenFactory",null),l([s.Override],u.prototype,"inputStream",null),l([s.Override],u.prototype,"sourceName",null),l([s.Override],u.prototype,"line",null),l([s.Override],u.prototype,"charPositionInLine",null),Wr.Lexer=u,Wr}var th;function Yn(){if(th)return vt;th=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=vt&&vt.__decorate||function(u,h,f,d){var p=arguments.length,y=p<3?h:d===null?d=Object.getOwnPropertyDescriptor(h,f):d,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(u,h,f,d);else for(var v=u.length-1;v>=0;v--)(m=u[v])&&(y=(p<3?m(y):p>3?m(h,f,y):m(h,f))||y);return p>3&&y&&Object.defineProperty(h,f,y),y},e=vt&&vt.__param||function(u,h){return function(f,d){h(f,d,u)}};Object.defineProperty(vt,"__esModule",{value:!0}),vt.IntervalSet=void 0;const t=Fo(),n=rl(),o=Xe(),i=Ir(),r=je(),s=Z(),a=Be();let c=class Fe{constructor(h){this.readonly=!1,h!=null?this._intervals=h.slice(0):this._intervals=[]}static get COMPLETE_CHAR_SET(){return Fe._COMPLETE_CHAR_SET===void 0&&(Fe._COMPLETE_CHAR_SET=Fe.of(i.Lexer.MIN_CHAR_VALUE,i.Lexer.MAX_CHAR_VALUE),Fe._COMPLETE_CHAR_SET.setReadonly(!0)),Fe._COMPLETE_CHAR_SET}static get EMPTY_SET(){return Fe._EMPTY_SET==null&&(Fe._EMPTY_SET=new Fe,Fe._EMPTY_SET.setReadonly(!0)),Fe._EMPTY_SET}static of(h,f=h){let d=new Fe;return d.add(h,f),d}clear(){if(this.readonly)throw new Error("can't alter readonly IntervalSet");this._intervals.length=0}add(h,f=h){this.addRange(o.Interval.of(h,f))}addRange(h){if(this.readonly)throw new Error("can't alter readonly IntervalSet");if(!(h.b<h.a)){for(let f=0;f<this._intervals.length;f++){let d=this._intervals[f];if(h.equals(d))return;if(h.adjacent(d)||!h.disjoint(d)){let p=h.union(d);for(this._intervals[f]=p;f<this._intervals.length-1;){f++;let y=this._intervals[f];if(!p.adjacent(y)&&p.disjoint(y))break;this._intervals.splice(f,1),f--,this._intervals[f]=p.union(y)}return}if(h.startsBeforeDisjoint(d)){this._intervals.splice(f,0,h);return}}this._intervals.push(h)}}static or(h){let f=new Fe;for(let d of h)f.addAll(d);return f}addAll(h){if(h==null)return this;if(h instanceof Fe){let f=h,d=f._intervals.length;for(let p=0;p<d;p++){let y=f._intervals[p];this.add(y.a,y.b)}}else for(let f of h.toArray())this.add(f);return this}complementRange(h,f){return this.complement(Fe.of(h,f))}complement(h){if(h.isNil)return Fe.EMPTY_SET;let f;return h instanceof Fe?f=h:(f=new Fe,f.addAll(h)),f.subtract(this)}subtract(h){if(h==null||h.isNil)return new Fe(this._intervals);if(h instanceof Fe)return Fe.subtract(this,h);let f=new Fe;return f.addAll(h),Fe.subtract(this,f)}static subtract(h,f){if(h.isNil)return new Fe;let d=new Fe(h._intervals);if(f.isNil)return d;let p=0,y=0;for(;p<d._intervals.length&&y<f._intervals.length;){let m=d._intervals[p],v=f._intervals[y];if(v.b<m.a){y++;continue}if(v.a>m.b){p++;continue}let x,g;if(v.a>m.a&&(x=new o.Interval(m.a,v.a-1)),v.b<m.b&&(g=new o.Interval(v.b+1,m.b)),x)if(g){d._intervals[p]=x,d._intervals.splice(p+1,0,g),p++,y++;continue}else{d._intervals[p]=x,p++;continue}else if(g){d._intervals[p]=g,y++;continue}else{d._intervals.splice(p,1);continue}}return d}or(h){let f=new Fe;return f.addAll(this),f.addAll(h),f}and(h){if(h.isNil)return new Fe;let f=this._intervals,d=h._intervals,p,y=f.length,m=d.length,v=0,x=0;for(;v<y&&x<m;){let g=f[v],S=d[x];g.startsBeforeDisjoint(S)?v++:S.startsBeforeDisjoint(g)?x++:g.properlyContains(S)?(p||(p=new Fe),p.addRange(g.intersection(S)),x++):S.properlyContains(g)?(p||(p=new Fe),p.addRange(g.intersection(S)),v++):g.disjoint(S)||(p||(p=new Fe),p.addRange(g.intersection(S)),g.startsAfterNonDisjoint(S)?x++:S.startsAfterNonDisjoint(g)&&v++)}return p||new Fe}contains(h){let f=this._intervals.length,d=0,p=f-1;for(;d<=p;){let y=d+p>>1,m=this._intervals[y],v=m.a;if(m.b<h)d=y+1;else if(v>h)p=y-1;else return!0}return!1}get isNil(){return this._intervals==null||this._intervals.length===0}get maxElement(){if(this.isNil)throw new RangeError("set is empty");return this._intervals[this._intervals.length-1].b}get minElement(){if(this.isNil)throw new RangeError("set is empty");return this._intervals[0].a}get intervals(){return this._intervals}hashCode(){let h=r.MurmurHash.initialize();for(let f of this._intervals)h=r.MurmurHash.update(h,f.a),h=r.MurmurHash.update(h,f.b);return h=r.MurmurHash.finish(h,this._intervals.length*2),h}equals(h){return h==null||!(h instanceof Fe)?!1:t.ArrayEqualityComparator.INSTANCE.equals(this._intervals,h._intervals)}toString(h=!1){let f="";if(this._intervals==null||this._intervals.length===0)return"{}";this.size>1&&(f+="{");let d=!0;for(let p of this._intervals){d?d=!1:f+=", ";let y=p.a,m=p.b;y===m?y===a.Token.EOF?f+="<EOF>":h?f+="'"+String.fromCodePoint(y)+"'":f+=y:h?f+="'"+String.fromCodePoint(y)+"'..'"+String.fromCodePoint(m)+"'":f+=y+".."+m}return this.size>1&&(f+="}"),f}toStringVocabulary(h){if(this._intervals==null||this._intervals.length===0)return"{}";let f="";this.size>1&&(f+="{");let d=!0;for(let p of this._intervals){d?d=!1:f+=", ";let y=p.a,m=p.b;if(y===m)f+=this.elementName(h,y);else for(let v=y;v<=m;v++)v>y&&(f+=", "),f+=this.elementName(h,v)}return this.size>1&&(f+="}"),f}elementName(h,f){return f===a.Token.EOF?"<EOF>":f===a.Token.EPSILON?"<EPSILON>":h.getDisplayName(f)}get size(){let h=0,f=this._intervals.length;if(f===1){let d=this._intervals[0];return d.b-d.a+1}for(let d=0;d<f;d++){let p=this._intervals[d];h+=p.b-p.a+1}return h}toIntegerList(){let h=new n.IntegerList(this.size),f=this._intervals.length;for(let d=0;d<f;d++){let p=this._intervals[d],y=p.a,m=p.b;for(let v=y;v<=m;v++)h.add(v)}return h}toSet(){let h=new Set;for(let f of this._intervals){let d=f.a,p=f.b;for(let y=d;y<=p;y++)h.add(y)}return h}toArray(){let h=new Array,f=this._intervals.length;for(let d=0;d<f;d++){let p=this._intervals[d],y=p.a,m=p.b;for(let v=y;v<=m;v++)h.push(v)}return h}remove(h){if(this.readonly)throw new Error("can't alter readonly IntervalSet");let f=this._intervals.length;for(let d=0;d<f;d++){let p=this._intervals[d],y=p.a,m=p.b;if(h<y)break;if(h===y&&h===m){this._intervals.splice(d,1);break}if(h===y){this._intervals[d]=o.Interval.of(p.a+1,p.b);break}if(h===m){this._intervals[d]=o.Interval.of(p.a,p.b-1);break}if(h>y&&h<m){let v=p.b;this._intervals[d]=o.Interval.of(p.a,h-1),this.add(h+1,v)}}}get isReadonly(){return this.readonly}setReadonly(h){if(this.readonly&&!h)throw new Error("can't alter readonly IntervalSet");this.readonly=h}};return l([s.Override],c.prototype,"addAll",null),l([s.Override],c.prototype,"complement",null),l([s.Override],c.prototype,"subtract",null),l([s.Override],c.prototype,"or",null),l([s.Override],c.prototype,"and",null),l([s.Override],c.prototype,"contains",null),l([s.Override],c.prototype,"isNil",null),l([s.Override],c.prototype,"hashCode",null),l([s.Override],c.prototype,"equals",null),l([e(0,s.NotNull)],c.prototype,"toStringVocabulary",null),l([s.NotNull,e(0,s.NotNull)],c.prototype,"elementName",null),l([s.Override],c.prototype,"size",null),l([s.Override],c.prototype,"remove",null),l([s.NotNull],c,"of",null),l([s.NotNull],c,"subtract",null),vt.IntervalSet=c,vt}var an={},ot={},ln={},rh;function Ud(){if(rh)return ln;rh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ln&&ln.__decorate||function(n,o,i,r){var s=arguments.length,a=s<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,i):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,o,i,r);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(ln,"__esModule",{value:!0}),ln.ATNDeserializationOptions=void 0;const e=Z();let t=class Zn{constructor(o){this.readOnly=!1,o?(this.verifyATN=o.verifyATN,this.generateRuleBypassTransitions=o.generateRuleBypassTransitions,this.optimize=o.optimize):(this.verifyATN=!0,this.generateRuleBypassTransitions=!1,this.optimize=!0)}static get defaultOptions(){return Zn._defaultOptions==null&&(Zn._defaultOptions=new Zn,Zn._defaultOptions.makeReadOnly()),Zn._defaultOptions}get isReadOnly(){return this.readOnly}makeReadOnly(){this.readOnly=!0}get isVerifyATN(){return this.verifyATN}set isVerifyATN(o){this.throwIfReadOnly(),this.verifyATN=o}get isGenerateRuleBypassTransitions(){return this.generateRuleBypassTransitions}set isGenerateRuleBypassTransitions(o){this.throwIfReadOnly(),this.generateRuleBypassTransitions=o}get isOptimize(){return this.optimize}set isOptimize(o){this.throwIfReadOnly(),this.optimize=o}throwIfReadOnly(){if(this.isReadOnly)throw new Error("The object is read only.")}};return l([e.NotNull],t,"defaultOptions",null),ln.ATNDeserializationOptions=t,ln}var Dt={},Lt={},nh;function Hd(){if(nh)return Lt;nh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Lt&&Lt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=Lt&&Lt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.ActionTransition=void 0;const t=Z(),n=Or();let o=class extends n.Transition{constructor(r,s,a=-1,c=!1){super(r),this.ruleIndex=s,this.actionIndex=a,this.isCtxDependent=c}get serializationType(){return 6}get isEpsilon(){return!0}matches(r,s,a){return!1}toString(){return"action_"+this.ruleIndex+":"+this.actionIndex}};return l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"isEpsilon",null),l([t.Override],o.prototype,"matches",null),l([t.Override],o.prototype,"toString",null),o=l([e(0,t.NotNull)],o),Lt.ActionTransition=o,Lt}var Mt={},ih;function $d(){if(ih)return Mt;ih=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Mt&&Mt.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Mt&&Mt.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.AtomTransition=void 0;const t=Yn(),n=Z(),o=Or();let i=class extends o.Transition{constructor(s,a){super(s),this._label=a}get serializationType(){return 5}get label(){return t.IntervalSet.of(this._label)}matches(s,a,c){return this._label===s}toString(){return String(this.label)}};return l([n.Override],i.prototype,"serializationType",null),l([n.Override,n.NotNull],i.prototype,"label",null),l([n.Override],i.prototype,"matches",null),l([n.Override,n.NotNull],i.prototype,"toString",null),i=l([e(0,n.NotNull)],i),Mt.AtomTransition=i,Mt}var un={},bi={},oh;function zo(){if(oh)return bi;oh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(bi,"__esModule",{value:!0}),bi.BlockStartState=void 0;const l=Wn();let e=class extends l.DecisionState{};return bi.BlockStartState=e,bi}var sh;function W0(){if(sh)return un;sh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=un&&un.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(un,"__esModule",{value:!0}),un.BasicBlockStartState=void 0;const e=He(),t=zo(),n=Z();let o=class extends t.BlockStartState{get stateType(){return e.ATNStateType.BLOCK_START}};return l([n.Override],o.prototype,"stateType",null),un.BasicBlockStartState=o,un}var cn={},ah;function G0(){if(ah)return cn;ah=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=cn&&cn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(cn,"__esModule",{value:!0}),cn.BlockEndState=void 0;const e=yr(),t=He(),n=Z();let o=class extends e.ATNState{get stateType(){return t.ATNStateType.BLOCK_END}};return l([n.Override],o.prototype,"stateType",null),cn.BlockEndState=o,cn}var Bt={},lh;function Y0(){if(lh)return Bt;lh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Bt&&Bt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=Bt&&Bt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.EpsilonTransition=void 0;const t=Z(),n=Or();let o=class extends n.Transition{constructor(r,s=-1){super(r),this._outermostPrecedenceReturn=s}get outermostPrecedenceReturn(){return this._outermostPrecedenceReturn}get serializationType(){return 1}get isEpsilon(){return!0}matches(r,s,a){return!1}toString(){return"epsilon"}};return l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"isEpsilon",null),l([t.Override],o.prototype,"matches",null),l([t.Override,t.NotNull],o.prototype,"toString",null),o=l([e(0,t.NotNull)],o),Bt.EpsilonTransition=o,Bt}var kt={},uh;function X0(){if(uh)return kt;uh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=kt&&kt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=kt&&kt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(kt,"__esModule",{value:!0}),kt.LexerChannelAction=void 0;const t=je(),n=Z();let o=class Vd{constructor(r){this._channel=r}get channel(){return this._channel}get actionType(){return 0}get isPositionDependent(){return!1}execute(r){r.channel=this._channel}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._channel),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof Vd?this._channel===r._channel:!1}toString(){return`channel(${this._channel})`}};return l([n.Override],o.prototype,"actionType",null),l([n.Override],o.prototype,"isPositionDependent",null),l([n.Override,e(0,n.NotNull)],o.prototype,"execute",null),l([n.Override],o.prototype,"hashCode",null),l([n.Override],o.prototype,"equals",null),l([n.Override],o.prototype,"toString",null),kt.LexerChannelAction=o,kt}var zt={},ch;function K0(){if(ch)return zt;ch=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=zt&&zt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=zt&&zt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(zt,"__esModule",{value:!0}),zt.LexerCustomAction=void 0;const t=je(),n=Z();let o=class Wd{constructor(r,s){this._ruleIndex=r,this._actionIndex=s}get ruleIndex(){return this._ruleIndex}get actionIndex(){return this._actionIndex}get actionType(){return 1}get isPositionDependent(){return!0}execute(r){r.action(void 0,this._ruleIndex,this._actionIndex)}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._ruleIndex),r=t.MurmurHash.update(r,this._actionIndex),t.MurmurHash.finish(r,3)}equals(r){return r===this?!0:r instanceof Wd?this._ruleIndex===r._ruleIndex&&this._actionIndex===r._actionIndex:!1}};return l([n.Override],o.prototype,"actionType",null),l([n.Override],o.prototype,"isPositionDependent",null),l([n.Override,e(0,n.NotNull)],o.prototype,"execute",null),l([n.Override],o.prototype,"hashCode",null),l([n.Override],o.prototype,"equals",null),zt.LexerCustomAction=o,zt}var jt={},hh;function Q0(){if(hh)return jt;hh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=jt&&jt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=jt&&jt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(jt,"__esModule",{value:!0}),jt.LexerModeAction=void 0;const t=je(),n=Z();let o=class Gd{constructor(r){this._mode=r}get mode(){return this._mode}get actionType(){return 2}get isPositionDependent(){return!1}execute(r){r.mode(this._mode)}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._mode),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof Gd?this._mode===r._mode:!1}toString(){return`mode(${this._mode})`}};return l([n.Override],o.prototype,"actionType",null),l([n.Override],o.prototype,"isPositionDependent",null),l([n.Override,e(0,n.NotNull)],o.prototype,"execute",null),l([n.Override],o.prototype,"hashCode",null),l([n.Override],o.prototype,"equals",null),l([n.Override],o.prototype,"toString",null),jt.LexerModeAction=o,jt}var hn={},fh;function J0(){return fh||(fh=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=hn&&hn.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},t=hn&&hn.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(l,"__esModule",{value:!0}),l.LexerMoreAction=void 0;const n=je(),o=Z();let i=class{constructor(){}get actionType(){return 3}get isPositionDependent(){return!1}execute(s){s.more()}hashCode(){let s=n.MurmurHash.initialize();return s=n.MurmurHash.update(s,this.actionType),n.MurmurHash.finish(s,1)}equals(s){return s===this}toString(){return"more"}};e([o.Override],i.prototype,"actionType",null),e([o.Override],i.prototype,"isPositionDependent",null),e([o.Override,t(0,o.NotNull)],i.prototype,"execute",null),e([o.Override],i.prototype,"hashCode",null),e([o.Override],i.prototype,"equals",null),e([o.Override],i.prototype,"toString",null),l.LexerMoreAction=i,function(r){r.INSTANCE=new r}(i=l.LexerMoreAction||(l.LexerMoreAction={}))}(hn)),hn}var fn={},dh;function Z0(){return dh||(dh=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=fn&&fn.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},t=fn&&fn.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(l,"__esModule",{value:!0}),l.LexerPopModeAction=void 0;const n=je(),o=Z();let i=class{constructor(){}get actionType(){return 4}get isPositionDependent(){return!1}execute(s){s.popMode()}hashCode(){let s=n.MurmurHash.initialize();return s=n.MurmurHash.update(s,this.actionType),n.MurmurHash.finish(s,1)}equals(s){return s===this}toString(){return"popMode"}};e([o.Override],i.prototype,"actionType",null),e([o.Override],i.prototype,"isPositionDependent",null),e([o.Override,t(0,o.NotNull)],i.prototype,"execute",null),e([o.Override],i.prototype,"hashCode",null),e([o.Override],i.prototype,"equals",null),e([o.Override],i.prototype,"toString",null),l.LexerPopModeAction=i,function(r){r.INSTANCE=new r}(i=l.LexerPopModeAction||(l.LexerPopModeAction={}))}(fn)),fn}var qt={},ph;function em(){if(ph)return qt;ph=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=qt&&qt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=qt&&qt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(qt,"__esModule",{value:!0}),qt.LexerPushModeAction=void 0;const t=je(),n=Z();let o=class Yd{constructor(r){this._mode=r}get mode(){return this._mode}get actionType(){return 5}get isPositionDependent(){return!1}execute(r){r.pushMode(this._mode)}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._mode),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof Yd?this._mode===r._mode:!1}toString(){return`pushMode(${this._mode})`}};return l([n.Override],o.prototype,"actionType",null),l([n.Override],o.prototype,"isPositionDependent",null),l([n.Override,e(0,n.NotNull)],o.prototype,"execute",null),l([n.Override],o.prototype,"hashCode",null),l([n.Override],o.prototype,"equals",null),l([n.Override],o.prototype,"toString",null),qt.LexerPushModeAction=o,qt}var dn={},mh;function tm(){return mh||(mh=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=dn&&dn.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},t=dn&&dn.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(l,"__esModule",{value:!0}),l.LexerSkipAction=void 0;const n=je(),o=Z();let i=class{constructor(){}get actionType(){return 6}get isPositionDependent(){return!1}execute(s){s.skip()}hashCode(){let s=n.MurmurHash.initialize();return s=n.MurmurHash.update(s,this.actionType),n.MurmurHash.finish(s,1)}equals(s){return s===this}toString(){return"skip"}};e([o.Override],i.prototype,"actionType",null),e([o.Override],i.prototype,"isPositionDependent",null),e([o.Override,t(0,o.NotNull)],i.prototype,"execute",null),e([o.Override],i.prototype,"hashCode",null),e([o.Override],i.prototype,"equals",null),e([o.Override],i.prototype,"toString",null),l.LexerSkipAction=i,function(r){r.INSTANCE=new r}(i=l.LexerSkipAction||(l.LexerSkipAction={}))}(dn)),dn}var Ut={},xh;function rm(){if(xh)return Ut;xh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ut&&Ut.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=Ut&&Ut.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.LexerTypeAction=void 0;const t=je(),n=Z();let o=class Xd{constructor(r){this._type=r}get type(){return this._type}get actionType(){return 7}get isPositionDependent(){return!1}execute(r){r.type=this._type}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._type),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof Xd?this._type===r._type:!1}toString(){return`type(${this._type})`}};return l([n.Override],o.prototype,"actionType",null),l([n.Override],o.prototype,"isPositionDependent",null),l([n.Override,e(0,n.NotNull)],o.prototype,"execute",null),l([n.Override],o.prototype,"hashCode",null),l([n.Override],o.prototype,"equals",null),l([n.Override],o.prototype,"toString",null),Ut.LexerTypeAction=o,Ut}var pn={},gh;function Kd(){if(gh)return pn;gh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=pn&&pn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(pn,"__esModule",{value:!0}),pn.LoopEndState=void 0;const e=yr(),t=He(),n=Z();let o=class extends e.ATNState{get stateType(){return t.ATNStateType.LOOP_END}};return l([n.Override],o.prototype,"stateType",null),pn.LoopEndState=o,pn}var Ht={},mn={},yh;function nm(){if(yh)return mn;yh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=mn&&mn.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c};Object.defineProperty(mn,"__esModule",{value:!0}),mn.ConflictInfo=void 0;const e=Z(),t=vr();let n=class Qd{constructor(i,r){this._conflictedAlts=i,this.exact=r}get conflictedAlts(){return this._conflictedAlts}get isExact(){return this.exact}equals(i){return i===this?!0:i instanceof Qd?this.isExact===i.isExact&&t.equals(this.conflictedAlts,i.conflictedAlts):!1}hashCode(){return this.conflictedAlts.hashCode()}};return l([e.Override],n.prototype,"equals",null),l([e.Override],n.prototype,"hashCode",null),mn.ConflictInfo=n,mn}var xn={},gn={},yn={},vh;function di(){if(vh)return yn;vh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=yn&&yn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(yn,"__esModule",{value:!0}),yn.TerminalNode=void 0;const e=Xe(),t=Z(),n=Be();let o=class{constructor(r){this._symbol=r}getChild(r){throw new RangeError("Terminal Node has no children.")}get symbol(){return this._symbol}get parent(){return this._parent}setParent(r){this._parent=r}get payload(){return this._symbol}get sourceInterval(){let r=this._symbol.tokenIndex;return new e.Interval(r,r)}get childCount(){return 0}accept(r){return r.visitTerminal(this)}get text(){return this._symbol.text||""}toStringTree(r){return this.toString()}toString(){return this._symbol.type===n.Token.EOF?"<EOF>":this._symbol.text||""}};return l([t.Override],o.prototype,"getChild",null),l([t.Override],o.prototype,"parent",null),l([t.Override],o.prototype,"setParent",null),l([t.Override],o.prototype,"payload",null),l([t.Override],o.prototype,"sourceInterval",null),l([t.Override],o.prototype,"childCount",null),l([t.Override],o.prototype,"accept",null),l([t.Override],o.prototype,"text",null),l([t.Override],o.prototype,"toStringTree",null),l([t.Override],o.prototype,"toString",null),yn.TerminalNode=o,yn}var Sh;function cl(){if(Sh)return gn;Sh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=gn&&gn.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c};Object.defineProperty(gn,"__esModule",{value:!0}),gn.ErrorNode=void 0;const e=Z(),t=di();let n=class extends t.TerminalNode{constructor(i){super(i)}accept(i){return i.visitErrorNode(this)}};return l([e.Override],n.prototype,"accept",null),gn.ErrorNode=n,gn}var vn={},Ni={},Ah;function hl(){if(Ah)return Ni;Ah=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.RuleNode=void 0;let l=class{};return Ni.RuleNode=l,Ni}var $t={},Ch;function Xn(){if(Ch)return $t;Ch=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=$t&&$t.__decorate||function(d,p,y,m){var v=arguments.length,x=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,y):m,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(d,p,y,m);else for(var S=d.length-1;S>=0;S--)(g=d[S])&&(x=(v<3?g(x):v>3?g(p,y,x):g(p,y))||x);return v>3&&x&&Object.defineProperty(p,y,x),x},e=$t&&$t.__param||function(d,p){return function(y,m){p(y,m,d)}};Object.defineProperty($t,"__esModule",{value:!0}),$t.Trees=void 0;const t=ft(),n=Ji(),o=cl(),i=Z(),r=io(),s=ut(),a=hl(),c=di(),u=Be(),h=vr();let f=class Cr{static toStringTree(p,y){let m;y instanceof r.Parser?m=y.ruleNames:m=y;let v=h.escapeWhitespace(this.getNodeText(p,m),!1);if(p.childCount===0)return v;let x="";x+="(",v=h.escapeWhitespace(this.getNodeText(p,m),!1),x+=v,x+=" ";for(let g=0;g<p.childCount;g++)g>0&&(x+=" "),x+=this.toStringTree(p.getChild(g),m);return x+=")",x}static getNodeText(p,y){let m;if(y instanceof r.Parser)m=y.ruleNames;else if(y)m=y;else{let v=p.payload;return typeof v.text=="string"?v.text:p.payload.toString()}if(p instanceof a.RuleNode){let v=p.ruleContext,x=v.ruleIndex,g=m[x],S=v.altNumber;return S!==t.ATN.INVALID_ALT_NUMBER?g+":"+S:g}else{if(p instanceof o.ErrorNode)return p.toString();if(p instanceof c.TerminalNode)return p.symbol.text||""}throw new TypeError("Unexpected node type")}static getChildren(p){let y=[];for(let m=0;m<p.childCount;m++)y.push(p.getChild(m));return y}static getAncestors(p){let y=[],m=p.parent;for(;m;)y.unshift(m),m=m.parent;return y}static isAncestorOf(p,y){if(!p||!y||!p.parent)return!1;let m=y.parent;for(;m;){if(p===m)return!0;m=m.parent}return!1}static findAllTokenNodes(p,y){return Cr.findAllNodes(p,y,!0)}static findAllRuleNodes(p,y){return Cr.findAllNodes(p,y,!1)}static findAllNodes(p,y,m){let v=[];return Cr._findAllNodes(p,y,m,v),v}static _findAllNodes(p,y,m,v){m&&p instanceof c.TerminalNode?p.symbol.type===y&&v.push(p):!m&&p instanceof s.ParserRuleContext&&p.ruleIndex===y&&v.push(p);for(let x=0;x<p.childCount;x++)Cr._findAllNodes(p.getChild(x),y,m,v)}static getDescendants(p){let y=[];function m(v){y.push(v);const x=v.childCount;for(let g=0;g<x;g++)m(v.getChild(g))}return m(p),y}static getRootOfSubtreeEnclosingRegion(p,y,m){let v=p.childCount;for(let x=0;x<v;x++){let g=p.getChild(x),S=Cr.getRootOfSubtreeEnclosingRegion(g,y,m);if(S)return S}if(p instanceof s.ParserRuleContext){let x=p.stop;if(y>=p.start.tokenIndex&&(x==null||m<=x.tokenIndex))return p}}static stripChildrenOutOfRange(p,y,m,v){if(!p)return;let x=p.childCount;for(let g=0;g<x;g++){let S=p.getChild(g),C=S.sourceInterval;if(S instanceof s.ParserRuleContext&&(C.b<m||C.a>v)&&Cr.isAncestorOf(S,y)){let A=new n.CommonToken(u.Token.INVALID_TYPE,"...");p.children[g]=new c.TerminalNode(A)}}}static findNodeSuchThat(p,y){if(y(p))return p;let m=p.childCount;for(let v=0;v<m;v++){let x=Cr.findNodeSuchThat(p.getChild(v),y);if(x!==void 0)return x}}};return l([e(0,i.NotNull)],f,"toStringTree",null),l([i.NotNull,e(0,i.NotNull)],f,"getAncestors",null),l([e(0,i.NotNull)],f,"getRootOfSubtreeEnclosingRegion",null),$t.Trees=f,$t}var Eh;function Zd(){if(Eh)return vn;Eh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=vn&&vn.__decorate||function(c,u,h,f){var d=arguments.length,p=d<3?u:f===null?f=Object.getOwnPropertyDescriptor(u,h):f,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,u,h,f);else for(var m=c.length-1;m>=0;m--)(y=c[m])&&(p=(d<3?y(p):d>3?y(u,h,p):y(u,h))||p);return d>3&&p&&Object.defineProperty(u,h,p),p};Object.defineProperty(vn,"__esModule",{value:!0}),vn.RuleContext=void 0;const e=ft(),t=eo(),n=hl(),o=Xe(),i=Z(),r=Xn(),s=ut();let a=class Jd extends n.RuleNode{constructor(u,h){super(),this._parent=u,this.invokingState=h??-1}static getChildContext(u,h){return new Jd(u,h)}depth(){let u=0,h=this;for(;h;)h=h._parent,u++;return u}get isEmpty(){return this.invokingState===-1}get sourceInterval(){return o.Interval.INVALID}get ruleContext(){return this}get parent(){return this._parent}setParent(u){this._parent=u}get payload(){return this}get text(){if(this.childCount===0)return"";let u="";for(let h=0;h<this.childCount;h++)u+=this.getChild(h).text;return u.toString()}get ruleIndex(){return-1}get altNumber(){return e.ATN.INVALID_ALT_NUMBER}set altNumber(u){}getChild(u){throw new RangeError("i must be greater than or equal to 0 and less than childCount")}get childCount(){return 0}accept(u){return u.visitChildren(this)}toStringTree(u){return r.Trees.toStringTree(this,u)}toString(u,h){const f=u instanceof t.Recognizer?u.ruleNames:u;h=h||s.ParserRuleContext.emptyContext();let d="",p=this;for(d+="[";p&&p!==h;){if(!f)p.isEmpty||(d+=p.invokingState);else{let y=p.ruleIndex,m=y>=0&&y<f.length?f[y]:y.toString();d+=m}p._parent&&(f||!p._parent.isEmpty)&&(d+=" "),p=p._parent}return d+="]",d.toString()}};return l([i.Override],a.prototype,"sourceInterval",null),l([i.Override],a.prototype,"ruleContext",null),l([i.Override],a.prototype,"parent",null),l([i.Override],a.prototype,"setParent",null),l([i.Override],a.prototype,"payload",null),l([i.Override],a.prototype,"text",null),l([i.Override],a.prototype,"getChild",null),l([i.Override],a.prototype,"childCount",null),l([i.Override],a.prototype,"accept",null),l([i.Override],a.prototype,"toStringTree",null),vn.RuleContext=a,vn}var _h;function ut(){if(_h)return xn;_h=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=xn&&xn.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f};Object.defineProperty(xn,"__esModule",{value:!0}),xn.ParserRuleContext=void 0;const e=cl(),t=Xe(),n=Z(),o=Zd(),i=di();let r=class Ba extends o.RuleContext{constructor(a,c){c==null?super():super(a,c)}static emptyContext(){return Ba.EMPTY}copyFrom(a){if(this._parent=a._parent,this.invokingState=a.invokingState,this._start=a._start,this._stop=a._stop,a.children){this.children=[];for(let c of a.children)c instanceof e.ErrorNode&&this.addChild(c)}}enterRule(a){}exitRule(a){}addAnyChild(a){return this.children?this.children.push(a):this.children=[a],a}addChild(a){if(a instanceof i.TerminalNode){a.setParent(this),this.addAnyChild(a);return}else if(a instanceof o.RuleContext){this.addAnyChild(a);return}else return a=new i.TerminalNode(a),this.addAnyChild(a),a.setParent(this),a}addErrorNode(a){if(a instanceof e.ErrorNode){const c=a;return c.setParent(this),this.addAnyChild(c)}else{const c=a;let u=new e.ErrorNode(c);return this.addAnyChild(u),u.setParent(this),u}}removeLastChild(){this.children&&this.children.pop()}get parent(){let a=super.parent;if(a===void 0||a instanceof Ba)return a;throw new TypeError("Invalid parent type for ParserRuleContext")}getChild(a,c){if(!this.children||a<0||a>=this.children.length)throw new RangeError("index parameter must be between >= 0 and <= number of children.");if(c==null)return this.children[a];let u=this.tryGetChild(a,c);if(u===void 0)throw new Error("The specified node does not exist");return u}tryGetChild(a,c){if(!this.children||a<0||a>=this.children.length)return;let u=-1;for(let h of this.children)if(h instanceof c&&(u++,u===a))return h}getToken(a,c){let u=this.tryGetToken(a,c);if(u===void 0)throw new Error("The specified token does not exist");return u}tryGetToken(a,c){if(!this.children||c<0||c>=this.children.length)return;let u=-1;for(let h of this.children)if(h instanceof i.TerminalNode&&h.symbol.type===a&&(u++,u===c))return h}getTokens(a){let c=[];if(!this.children)return c;for(let u of this.children)u instanceof i.TerminalNode&&u.symbol.type===a&&c.push(u);return c}get ruleContext(){return this}getRuleContext(a,c){return this.getChild(a,c)}tryGetRuleContext(a,c){return this.tryGetChild(a,c)}getRuleContexts(a){let c=[];if(!this.children)return c;for(let u of this.children)u instanceof a&&c.push(u);return c}get childCount(){return this.children?this.children.length:0}get sourceInterval(){return this._start?!this._stop||this._stop.tokenIndex<this._start.tokenIndex?t.Interval.of(this._start.tokenIndex,this._start.tokenIndex-1):t.Interval.of(this._start.tokenIndex,this._stop.tokenIndex):t.Interval.INVALID}get start(){return this._start}get stop(){return this._stop}toInfoString(a){return"ParserRuleContext"+a.getRuleInvocationStack(this).reverse()+"{start="+this._start+", stop="+this._stop+"}"}};return r.EMPTY=new r,l([n.Override],r.prototype,"parent",null),l([n.Override],r.prototype,"childCount",null),l([n.Override],r.prototype,"sourceInterval",null),xn.ParserRuleContext=r,xn}var Ri={},Th;function im(){return Th||(Th=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Ri&&Ri.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(l,"__esModule",{value:!0}),l.PredictionMode=void 0;const t=fi(),n=je(),o=Z(),i=to();(function(r){r[r.SLL=0]="SLL",r[r.LL=1]="LL",r[r.LL_EXACT_AMBIG_DETECTION=2]="LL_EXACT_AMBIG_DETECTION"})(l.PredictionMode||(l.PredictionMode={})),function(r){class s extends t.Array2DHashMap{constructor(){super(a.INSTANCE)}}class a{AltAndContextConfigEqualityComparator(){}hashCode(f){let d=n.MurmurHash.initialize(7);return d=n.MurmurHash.update(d,f.state.stateNumber),d=n.MurmurHash.update(d,f.context),d=n.MurmurHash.finish(d,2),d}equals(f,d){return f===d?!0:f==null||d==null?!1:f.state.stateNumber===d.state.stateNumber&&f.context.equals(d.context)}}a.INSTANCE=new a,e([o.Override],a.prototype,"hashCode",null),e([o.Override],a.prototype,"equals",null);function c(h){for(let f of h)if(f.state instanceof i.RuleStopState)return!0;return!1}r.hasConfigInRuleStopState=c;function u(h){for(let f of h)if(!(f.state instanceof i.RuleStopState))return!1;return!0}r.allConfigsInRuleStopStates=u}(l.PredictionMode||(l.PredictionMode={}))}(Ri)),Ri}var Vt={},bh;function ep(){if(bh)return Vt;bh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Vt&&Vt.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=Vt&&Vt.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.SimulatorState=void 0;const t=Z(),n=ut();let o=class{constructor(r,s,a,c){this.outerContext=r??n.ParserRuleContext.emptyContext(),this.s0=s,this.useContext=a,this.remainingOuterContext=c}};return o=l([e(1,t.NotNull)],o),Vt.SimulatorState=o,Vt}var Nh;function ro(){if(Nh)return Ht;Nh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ht&&Ht.__decorate||function(ie,_,E,T){var w=arguments.length,F=w<3?_:T===null?T=Object.getOwnPropertyDescriptor(_,E):T,O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(ie,_,E,T);else for(var I=ie.length-1;I>=0;I--)(O=ie[I])&&(F=(w<3?O(F):w>3?O(_,E,F):O(_,E))||F);return w>3&&F&&Object.defineProperty(_,E,F),F},e=Ht&&Ht.__param||function(ie,_){return function(E,T){_(E,T,ie)}};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.ParserATNSimulator=void 0;const t=Fd(),n=Hd(),o=Fr(),i=tl(),r=ft(),s=Do(),a=Zi(),c=Mo(),u=He(),h=$d(),f=Pr(),d=nm(),p=Wn(),y=Lo(),m=rl(),v=Xe(),x=Rr(),g=Z(),S=ll(),C=jo(),A=ht(),b=ut(),N=lt(),R=il(),P=im(),k=to(),D=ul(),H=hi(),J=al(),te=ep(),le=Be(),ge=Gn(),ce=Ve(),ee=65535,G=-2147483648;let Q=class _e extends c.ATNSimulator{constructor(_,E){super(_),this.predictionMode=P.PredictionMode.LL,this.force_global_context=!1,this.always_try_local_context=!0,this.enable_global_context_dfa=!1,this.optimize_unique_closure=!0,this.optimize_ll1=!0,this.optimize_tail_calls=!0,this.tail_call_preserves_sll=!0,this.treat_sllk1_conflict_as_ambiguity=!1,this.reportAmbiguities=!1,this.userWantsCtxSensitive=!0,this._parser=E}getPredictionMode(){return this.predictionMode}setPredictionMode(_){this.predictionMode=_}reset(){}adaptivePredict(_,E,T,w){w===void 0&&(w=!1);let F=this.atn.decisionToDFA[E];if(ce(F!=null),this.optimize_ll1&&!F.isPrecedenceDfa&&!F.isEmpty){let $=_.LA(1);if($>=0&&$<=65535){let W=(E<<16>>>0)+$,L=this.atn.LL1Table.get(W);if(L!=null)return L}}this.dfa=F,this.force_global_context?w=!0:this.always_try_local_context||(w=w||F.isContextSensitive),this.userWantsCtxSensitive=w||this.predictionMode!==P.PredictionMode.SLL&&T!=null&&!this.atn.decisionToState[E].sll,T==null&&(T=b.ParserRuleContext.emptyContext());let O;F.isEmpty||(O=this.getStartState(F,_,T,w)),O==null&&(T==null&&(T=b.ParserRuleContext.emptyContext()),_e.debug&&console.log("ATN decision "+F.decision+" exec LA(1)=="+this.getLookaheadName(_)+", outerContext="+T.toString(this._parser)),O=this.computeStartState(F,T,w));let I=_.mark(),j=_.index;try{let $=this.execDFA(F,_,j,O);return _e.debug&&console.log("DFA after predictATN: "+F.toString(this._parser.vocabulary,this._parser.ruleNames)),$}finally{this.dfa=void 0,_.seek(j),_.release(I)}}getStartState(_,E,T,w){if(!w)if(_.isPrecedenceDfa){let I=_.getPrecedenceStartState(this._parser.precedence,!1);return I==null?void 0:new te.SimulatorState(T,I,!1,T)}else return _.s0==null?void 0:new te.SimulatorState(T,_.s0,!1,T);if(!this.enable_global_context_dfa)return;let F=T;ce(T!=null);let O;for(_.isPrecedenceDfa?O=_.getPrecedenceStartState(this._parser.precedence,!0):O=_.s0full;F!=null&&O!=null&&O.isContextSensitive;)F=this.skipTailCalls(F),O=O.getContextTarget(this.getReturnState(F)),F.isEmpty?ce(O==null||!O.isContextSensitive):F=F.parent;if(O!=null)return new te.SimulatorState(T,O,w,F)}execDFA(_,E,T,w){let F=w.outerContext;_e.dfa_debug&&console.log("DFA decision "+_.decision+" exec LA(1)=="+this.getLookaheadName(E)+", outerContext="+F.toString(this._parser)),_e.dfa_debug&&console.log(_.toString(this._parser.vocabulary,this._parser.ruleNames));let O=w.s0,I=E.LA(1),j=w.remainingOuterContext;for(;;){if(_e.dfa_debug&&console.log("DFA state "+O.stateNumber+" LA(1)=="+this.getLookaheadName(E)),w.useContext)for(;O.isContextSymbol(I);){let L;if(j!=null&&(j=this.skipTailCalls(j),L=O.getContextTarget(this.getReturnState(j))),L==null){let M=new te.SimulatorState(w.outerContext,O,w.useContext,j);return this.execATN(_,E,T,M)}ce(j!=null),j=j.parent,O=L}if(this.isAcceptState(O,w.useContext)){O.predicates!=null?_e.dfa_debug&&console.log("accept "+O):_e.dfa_debug&&console.log("accept; predict "+O.prediction+" in state "+O.stateNumber);break}ce(!this.isAcceptState(O,w.useContext));let W=this.getExistingTargetState(O,I);if(W==null){_e.dfa_debug&&I>=0&&console.log("no edge for "+this._parser.vocabulary.getDisplayName(I));let L;if(_e.dfa_debug){let U=v.Interval.of(T,this._parser.inputStream.index);console.log("ATN exec upon "+this._parser.inputStream.getText(U)+" at DFA state "+O.stateNumber)}let M=new te.SimulatorState(F,O,w.useContext,j);return L=this.execATN(_,E,T,M),_e.dfa_debug&&console.log("back from DFA update, alt="+L+`, dfa=
`+_.toString(this._parser.vocabulary,this._parser.ruleNames)),_e.dfa_debug&&console.log("DFA decision "+_.decision+" predicts "+L),L}else if(W===c.ATNSimulator.ERROR){let L=new te.SimulatorState(F,O,w.useContext,j);return this.handleNoViableAlt(E,T,L)}O=W,!this.isAcceptState(O,w.useContext)&&I!==x.IntStream.EOF&&(E.consume(),I=E.LA(1))}if(!w.useContext&&O.configs.conflictInfo!=null&&_.atnStartState instanceof p.DecisionState&&!(!this.userWantsCtxSensitive||!O.configs.dipsIntoOuterContext&&O.configs.isExactConflict||this.treat_sllk1_conflict_as_ambiguity&&E.index===T)){ce(!w.useContext);let W,L=O.predicates;if(L!=null){let M=E.index;if(M!==T&&E.seek(T),W=this.evalSemanticContext(L,F,!0),W.cardinality()===1)return W.nextSetBit(0);M!==T&&E.seek(M)}if(this.reportAmbiguities){let M=new te.SimulatorState(F,O,w.useContext,j);this.reportAttemptingFullContext(_,W,M,T,E.index)}return E.seek(T),this.adaptivePredict(E,_.decision,F,!0)}let $=O.predicates;if($!=null){let W=E.index;T!==W&&E.seek(T);let L=this.evalSemanticContext($,F,this.reportAmbiguities&&this.predictionMode===P.PredictionMode.LL_EXACT_AMBIG_DETECTION);switch(L.cardinality()){case 0:throw this.noViableAlt(E,F,O.configs,T);case 1:return L.nextSetBit(0);default:return T!==W&&E.seek(W),this.reportAmbiguity(_,O,T,W,O.configs.isExactConflict,L,O.configs),L.nextSetBit(0)}}return _e.dfa_debug&&console.log("DFA decision "+_.decision+" predicts "+O.prediction),O.prediction}isAcceptState(_,E){return _.isAcceptState?_.configs.conflictingAlts==null?!0:E&&this.predictionMode===P.PredictionMode.LL_EXACT_AMBIG_DETECTION?_.configs.isExactConflict:!0:!1}execATN(_,E,T,w){_e.debug&&console.log("execATN decision "+_.decision+" exec LA(1)=="+this.getLookaheadName(E));let F=w.outerContext,O=w.useContext,I=E.LA(1),j=w,$=new R.PredictionContextCache;for(;;){let W=this.computeReachSet(_,j,I,$);if(W==null)return this.setDFAEdge(j.s0,E.LA(1),c.ATNSimulator.ERROR),this.handleNoViableAlt(E,T,j);let L=W.s0;if(ce(L.isAcceptState||L.prediction===r.ATN.INVALID_ALT_NUMBER),ce(L.isAcceptState||L.configs.conflictInfo==null),this.isAcceptState(L,O)){let M=L.configs.conflictingAlts,U=M==null?L.prediction:r.ATN.INVALID_ALT_NUMBER;if(U!==r.ATN.INVALID_ALT_NUMBER){if(this.optimize_ll1&&E.index===T&&!_.isPrecedenceDfa&&W.outerContext===W.remainingOuterContext&&_.decision>=0&&!L.configs.hasSemanticContext&&I>=0&&I<=ee){let re=(_.decision<<16>>>0)+I;this.atn.LL1Table.set(re,U)}O&&this.always_try_local_context&&this.reportContextSensitivity(_,U,W,T,E.index)}U=L.prediction;let Y=M!=null&&this.userWantsCtxSensitive;if(Y&&(Y=!O&&(L.configs.dipsIntoOuterContext||!L.configs.isExactConflict)&&(!this.treat_sllk1_conflict_as_ambiguity||E.index!==T)),L.configs.hasSemanticContext){let re=L.predicates;if(re!=null){let ne=E.index;switch(ne!==T&&E.seek(T),M=this.evalSemanticContext(re,F,Y||this.reportAmbiguities),M.cardinality()){case 0:throw this.noViableAlt(E,F,L.configs,T);case 1:return M.nextSetBit(0)}ne!==T&&E.seek(ne)}}if(Y){ce(!O),ce(this.isAcceptState(L,!1)),_e.debug&&console.log("RETRY with outerContext="+F);let re=this.computeStartState(_,F,!0);return this.reportAmbiguities&&this.reportAttemptingFullContext(_,M,W,T,E.index),E.seek(T),this.execATN(_,E,T,re)}else return M!=null&&(this.reportAmbiguities&&M.cardinality()>1&&this.reportAmbiguity(_,L,T,E.index,L.configs.isExactConflict,M,L.configs),U=M.nextSetBit(0)),U}j=W,I!==x.IntStream.EOF&&(E.consume(),I=E.LA(1))}}handleNoViableAlt(_,E,T){if(T.s0!=null){let w=new f.BitSet,F=0;for(let O of T.s0.configs)(O.reachesIntoOuterContext||O.state instanceof k.RuleStopState)&&(w.set(O.alt),F=Math.max(F,O.alt));switch(w.cardinality()){case 0:break;case 1:return w.nextSetBit(0);default:if(!T.s0.configs.hasSemanticContext)return w.nextSetBit(0);let O=new a.ATNConfigSet;for(let j of T.s0.configs)(j.reachesIntoOuterContext||j.state instanceof k.RuleStopState)&&O.add(j);let I=this.getPredsForAmbigAlts(w,O,F);if(I!=null){let j=this.getPredicatePredictions(w,I);if(j!=null){let $=_.index;try{_.seek(E);let W=this.evalSemanticContext(j,T.outerContext,!1);if(!W.isEmpty)return W.nextSetBit(0)}finally{_.seek($)}}}return w.nextSetBit(0)}}throw this.noViableAlt(_,T.outerContext,T.s0.configs,E)}computeReachSet(_,E,T,w){let F=E.useContext,O=E.remainingOuterContext,I=E.s0;if(F)for(;I.isContextSymbol(T);){let W;if(O!=null&&(O=this.skipTailCalls(O),W=I.getContextTarget(this.getReturnState(O))),W==null)break;ce(O!=null),O=O.parent,I=W}if(ce(!this.isAcceptState(I,F)),this.isAcceptState(I,F))return new te.SimulatorState(E.outerContext,I,F,O);let j=I,$=this.getExistingTargetState(j,T);if($==null){let W=this.computeTargetState(_,j,O,T,F,w);$=W[0],O=W[1]}if($!==c.ATNSimulator.ERROR)return ce(!F||!$.configs.dipsIntoOuterContext),new te.SimulatorState(E.outerContext,$,F,O)}getExistingTargetState(_,E){return _.getTarget(E)}computeTargetState(_,E,T,w,F,O){let I=E.configs.toArray(),j,$=new a.ATNConfigSet,W;do{let M=!F||T!=null;M||($.isOutermostConfigSet=!0);let U=new a.ATNConfigSet,Y;for(let q of I){if(_e.debug&&console.log("testing "+this.getTokenName(w)+" at "+q.toString()),q.state instanceof k.RuleStopState){ce(q.context.isEmpty),(F&&!q.reachesIntoOuterContext||w===x.IntStream.EOF)&&(Y==null&&(Y=[]),Y.push(q));continue}let X=q.state.numberOfOptimizedTransitions;for(let he=0;he<X;he++){let Ne=q.state.getOptimizedTransition(he),Re=this.getReachableTarget(q,Ne,w);Re!=null&&U.add(q.transform(Re,!1),O)}}if(this.optimize_unique_closure&&Y==null&&w!==le.Token.EOF&&U.uniqueAlt!==r.ATN.INVALID_ALT_NUMBER){U.isOutermostConfigSet=$.isOutermostConfigSet,$=U;break}let re=!1,ne=w===le.Token.EOF;if(this.closure(U,$,re,M,O,ne),W=$.dipsIntoOuterContext,w===x.IntStream.EOF&&($=this.removeAllConfigsNotInRuleStopState($,O)),Y!=null&&(!F||!P.PredictionMode.hasConfigInRuleStopState($))){ce(Y.length>0);for(let q of Y)$.add(q,O)}if(F&&W){$.clear(),T=T,T=this.skipTailCalls(T);let q=this.getReturnState(T);if(j==null&&(j=new m.IntegerList),T.isEmpty?T=void 0:T=T.parent,j.add(q),q!==N.PredictionContext.EMPTY_FULL_STATE_KEY)for(let X=0;X<I.length;X++)I[X]=I[X].appendContext(q,O)}}while(F&&W);return $.isEmpty?(this.setDFAEdge(E,w,c.ATNSimulator.ERROR),[c.ATNSimulator.ERROR,T]):[this.addDFAEdge(_,E,w,j,$,O),T]}removeAllConfigsNotInRuleStopState(_,E){if(P.PredictionMode.allConfigsInRuleStopStates(_))return _;let T=new a.ATNConfigSet;for(let w of _)w.state instanceof k.RuleStopState&&T.add(w,E);return T}computeStartState(_,E,T){let w=_.isPrecedenceDfa?_.getPrecedenceStartState(this._parser.precedence,T):T?_.s0full:_.s0;if(w!=null){if(!T)return new te.SimulatorState(E,w,T,E);w.setContextSensitive(this.atn)}_.decision;let F=_.atnStartState,O=0,I=E,j=T?N.PredictionContext.EMPTY_FULL:N.PredictionContext.EMPTY_LOCAL,$=new R.PredictionContextCache;if(T){if(!this.enable_global_context_dfa)for(;I!=null;)I.isEmpty?(O=N.PredictionContext.EMPTY_FULL_STATE_KEY,I=void 0):(O=this.getReturnState(I),j=j.appendSingleContext(O,$),I=I.parent);for(;w!=null&&w.isContextSensitive&&I!=null;){let L;if(I=this.skipTailCalls(I),I.isEmpty?(L=w.getContextTarget(N.PredictionContext.EMPTY_FULL_STATE_KEY),O=N.PredictionContext.EMPTY_FULL_STATE_KEY,I=void 0):(O=this.getReturnState(I),L=w.getContextTarget(O),j=j.appendSingleContext(O,$),I=I.parent),L==null)break;w=L}}if(w!=null&&!w.isContextSensitive)return new te.SimulatorState(E,w,T,I);let W=new a.ATNConfigSet;for(;;){let L=new a.ATNConfigSet,M=F.numberOfTransitions;for(let X=0;X<M;X++){let he=F.transition(X).target;L.add(s.ATNConfig.create(he,X+1,j))}let U=I!=null;U||(W.isOutermostConfigSet=!0),this.closure(L,W,!0,U,$,!1);let re=W.dipsIntoOuterContext,ne;if(T&&!this.enable_global_context_dfa){w=this.addDFAState(_,W,$);break}else w==null?_.isPrecedenceDfa?(W=this.applyPrecedenceFilter(W,E,$),ne=this.addDFAState(_,W,$),_.setPrecedenceStartState(this._parser.precedence,T,ne)):(ne=this.addDFAState(_,W,$),T?_.s0full?ne=_.s0full:_.s0full=ne:_.s0?ne=_.s0:_.s0=ne):(_.isPrecedenceDfa&&(W=this.applyPrecedenceFilter(W,E,$)),ne=this.addDFAState(_,W,$),w.setContextTarget(O,ne));if(w=ne,!T||!re)break;ne.setContextSensitive(this.atn),I=I,W.clear(),I=this.skipTailCalls(I);let q=this.getReturnState(I);I.isEmpty?I=void 0:I=I.parent,q!==N.PredictionContext.EMPTY_FULL_STATE_KEY&&(j=j.appendSingleContext(q,$)),O=q}return new te.SimulatorState(E,w,T,I)}applyPrecedenceFilter(_,E,T){let w=new Map,F=new a.ATNConfigSet;for(let O of _){if(O.alt!==1)continue;let I=O.semanticContext.evalPrecedence(this._parser,E);I!=null&&(w.set(O.state.stateNumber,O.context),I!==O.semanticContext?F.add(O.transform(O.state,!1,I),T):F.add(O,T))}for(let O of _)if(O.alt!==1){if(!O.isPrecedenceFilterSuppressed){let I=w.get(O.state.stateNumber);if(I!=null&&I.equals(O.context))continue}F.add(O,T)}return F}getReachableTarget(_,E,T){if(E.matches(T,0,this.atn.maxTokenType))return E.target}predicateDFAState(_,E,T){let w=this.getConflictingAltsFromConfigSet(E);if(!w)throw new Error("This unhandled scenario is intended to be unreachable, but I'm currently not sure of why we know that's the case.");_e.debug&&console.log("predicateDFAState "+_);let F=this.getPredsForAmbigAlts(w,E,T),O;return F!=null&&(O=this.getPredicatePredictions(w,F),_.predicates=O),O}getPredsForAmbigAlts(_,E,T){let w=new Array(T+1),F=w.length;for(let j of E)_.get(j.alt)&&(w[j.alt]=H.SemanticContext.or(w[j.alt],j.semanticContext));let O=0;for(let j=0;j<F;j++)w[j]==null?w[j]=H.SemanticContext.NONE:w[j]!==H.SemanticContext.NONE&&O++;let I=w;return O===0&&(I=void 0),_e.debug&&console.log("getPredsForAmbigAlts result "+(I?i.Arrays.toString(I):"undefined")),I}getPredicatePredictions(_,E){let T=[],w=!1;for(let F=1;F<E.length;F++){let O=E[F];ce(O!=null),_!=null&&_.get(F)&&O===H.SemanticContext.NONE?T.push(new y.DFAState.PredPrediction(O,F)):O!==H.SemanticContext.NONE&&(w=!0,T.push(new y.DFAState.PredPrediction(O,F)))}if(w)return T}evalSemanticContext(_,E,T){let w=new f.BitSet;for(let F of _){if(F.pred===H.SemanticContext.NONE){if(w.set(F.alt),!T)break;continue}let O=this.evalSemanticContextImpl(F.pred,E,F.alt);if((_e.debug||_e.dfa_debug)&&console.log("eval pred "+F+"="+O),O&&((_e.debug||_e.dfa_debug)&&console.log("PREDICT "+F.alt),w.set(F.alt),!T))break}return w}evalSemanticContextImpl(_,E,T){return _.eval(this._parser,E)}closure(_,E,T,w,F,O){F==null&&(F=R.PredictionContextCache.UNCACHED);let I=_,j=new o.Array2DHashSet(A.ObjectEqualityComparator.INSTANCE);for(;I.size>0;){let $=new a.ATNConfigSet;for(let W of I)this.closureImpl(W,E,$,j,T,w,F,0,O);I=$}}closureImpl(_,E,T,w,F,O,I,j,$){if(_e.debug&&console.log("closure("+_.toString(this._parser,!0)+")"),_.state instanceof k.RuleStopState)if(_.context.isEmpty)if(O)_e.debug&&console.log("FALLING off rule "+this.getRuleName(_.state.ruleIndex)),_.context===N.PredictionContext.EMPTY_FULL?_=_.transform(_.state,!1,N.PredictionContext.EMPTY_LOCAL):!_.reachesIntoOuterContext&&N.PredictionContext.isEmptyLocal(_.context)&&E.add(_,I);else{E.add(_,I);return}else{let L=_.context.hasEmpty,M=_.context.size-(L?1:0);for(let U=0;U<M;U++){let Y=_.context.getParent(U),re=this.atn.states[_.context.getReturnState(U)],ne=s.ATNConfig.create(re,_.alt,Y,_.semanticContext);ne.outerContextDepth=_.outerContextDepth,ne.isPrecedenceFilterSuppressed=_.isPrecedenceFilterSuppressed,ce(j>G),this.closureImpl(ne,E,T,w,F,O,I,j-1,$)}if(!L||!O)return;_=_.transform(_.state,!1,N.PredictionContext.EMPTY_LOCAL)}let W=_.state;W.onlyHasEpsilonTransitions||(E.add(_,I),_e.debug&&console.log("added config "+E));for(let L=0;L<W.numberOfOptimizedTransitions;L++){if(L===0&&W.stateType===u.ATNStateType.STAR_LOOP_ENTRY&&W.precedenceRuleDecision&&!_.context.hasEmpty){let re=W,ne=!0;for(let q=0;q<_.context.size;q++)if(!re.precedenceLoopbackStates.get(_.context.getReturnState(q))){ne=!1;break}if(ne)continue}let M=W.getOptimizedTransition(L),U=!(M instanceof n.ActionTransition)&&F,Y=this.getEpsilonTarget(_,M,U,j===0,I,$);if(Y!=null){if(M instanceof D.RuleTransition&&T!=null&&!F){T.add(Y,I);continue}let re=j;if(_.state instanceof k.RuleStopState){if(this.dfa!=null&&this.dfa.isPrecedenceDfa&&M.outermostPrecedenceReturn===this.dfa.atnStartState.ruleIndex&&(Y.isPrecedenceFilterSuppressed=!0),Y.outerContextDepth=Y.outerContextDepth+1,!w.add(Y))continue;ce(re>G),re--,_e.debug&&console.log("dips into outer ctx: "+Y)}else if(M instanceof D.RuleTransition)this.optimize_tail_calls&&M.optimizedTailCall&&(!this.tail_call_preserves_sll||!N.PredictionContext.isEmptyLocal(_.context))?(ce(Y.context===_.context),re===0&&(re--,!this.tail_call_preserves_sll&&N.PredictionContext.isEmptyLocal(_.context)&&(Y.outerContextDepth=Y.outerContextDepth+1))):re>=0&&re++;else if(!M.isEpsilon&&!w.add(Y))continue;this.closureImpl(Y,E,T,w,U,O,I,re,$)}}}getRuleName(_){return this._parser!=null&&_>=0?this._parser.ruleNames[_]:"<rule "+_+">"}getEpsilonTarget(_,E,T,w,F,O){switch(E.serializationType){case 3:return this.ruleTransition(_,E,F);case 10:return this.precedenceTransition(_,E,T,w);case 4:return this.predTransition(_,E,T,w);case 6:return this.actionTransition(_,E);case 1:return _.transform(E.target,!1);case 5:case 2:case 7:return O&&E.matches(le.Token.EOF,0,1)?_.transform(E.target,!1):void 0;default:return}}actionTransition(_,E){return _e.debug&&console.log("ACTION edge "+E.ruleIndex+":"+E.actionIndex),_.transform(E.target,!1)}precedenceTransition(_,E,T,w){_e.debug&&(console.log("PRED (collectPredicates="+T+") "+E.precedence+">=_p, ctx dependent=true"),this._parser!=null&&console.log("context surrounding pred is "+this._parser.getRuleInvocationStack()));let F;if(T&&w){let O=H.SemanticContext.and(_.semanticContext,E.predicate);F=_.transform(E.target,!1,O)}else F=_.transform(E.target,!1);return _e.debug&&console.log("config from pred transition="+F),F}predTransition(_,E,T,w){_e.debug&&(console.log("PRED (collectPredicates="+T+") "+E.ruleIndex+":"+E.predIndex+", ctx dependent="+E.isCtxDependent),this._parser!=null&&console.log("context surrounding pred is "+this._parser.getRuleInvocationStack()));let F;if(T&&(!E.isCtxDependent||E.isCtxDependent&&w)){let O=H.SemanticContext.and(_.semanticContext,E.predicate);F=_.transform(E.target,!1,O)}else F=_.transform(E.target,!1);return _e.debug&&console.log("config from pred transition="+F),F}ruleTransition(_,E,T){_e.debug&&console.log("CALL rule "+this.getRuleName(E.target.ruleIndex)+", ctx="+_.context);let w=E.followState,F;return this.optimize_tail_calls&&E.optimizedTailCall&&(!this.tail_call_preserves_sll||!N.PredictionContext.isEmptyLocal(_.context))?F=_.context:T!=null?F=T.getChild(_.context,w.stateNumber):F=_.context.getChild(w.stateNumber),_.transform(E.target,!1,F)}isConflicted(_,E){if(_.uniqueAlt!==r.ATN.INVALID_ALT_NUMBER||_.size<=1)return;let T=_.toArray();T.sort(_e.STATE_ALT_SORT_COMPARATOR);let w=!_.dipsIntoOuterContext,F=new f.BitSet,O=T[0].alt;F.set(O);let I=T[0].state.nonStopStateNumber;for(let M of T){let U=M.state.nonStopStateNumber;if(U!==I){if(M.alt!==O)return;I=U}}let j;if(w){I=T[0].state.nonStopStateNumber,j=new f.BitSet;let M=O;for(let Y of T){if(Y.state.nonStopStateNumber!==I)break;let re=Y.alt;j.set(re),M=re}I=T[0].state.nonStopStateNumber;let U=O;for(let Y of T){let re=Y.state.nonStopStateNumber,ne=Y.alt;if(re!==I){if(U!==M){w=!1;break}I=re,U=O}else if(ne!==U){if(ne!==j.nextSetBit(U+1)){w=!1;break}U=ne}}}I=T[0].state.nonStopStateNumber;let $=0,W=0,L=T[0].context;for(let M=1;M<T.length;M++){let U=T[M];if(U.alt!==O||U.state.nonStopStateNumber!==I)break;W=M,L=E.join(L,T[M].context)}for(let M=W+1;M<T.length;M++){let U=T[M],Y=U.state;if(F.set(U.alt),Y.nonStopStateNumber!==I){I=Y.nonStopStateNumber,$=M,W=M,L=U.context;for(let he=$+1;he<T.length;he++){let Ne=T[he];if(Ne.alt!==O||Ne.state.nonStopStateNumber!==I)break;W=he,L=E.join(L,Ne.context)}M=W;continue}let re=U.context,ne=U.alt,q=M;for(let he=q+1;he<T.length;he++){let Ne=T[he];if(Ne.alt!==ne||Ne.state.nonStopStateNumber!==I)break;q=he,re=E.join(re,Ne.context)}M=q;let X=E.join(L,re);if(!L.equals(X))return;w=w&&L.equals(re)}return new d.ConflictInfo(F,w)}getConflictingAltsFromConfigSet(_){let E=_.conflictingAlts;return E==null&&_.uniqueAlt!==r.ATN.INVALID_ALT_NUMBER&&(E=new f.BitSet,E.set(_.uniqueAlt)),E}getTokenName(_){if(_===le.Token.EOF)return"EOF";let T=(this._parser!=null?this._parser.vocabulary:ge.VocabularyImpl.EMPTY_VOCABULARY).getDisplayName(_);return T===String(_)?T:T+"<"+_+">"}getLookaheadName(_){return this.getTokenName(_.LA(1))}dumpDeadEndConfigs(_){console.log("dead end configs: ");let E=_.deadEndConfigs;if(E)for(let T of E){let w="no edges";if(T.state.numberOfOptimizedTransitions>0){let F=T.state.getOptimizedTransition(0);F instanceof h.AtomTransition?w="Atom "+this.getTokenName(F._label):F instanceof J.SetTransition&&(w=(F instanceof S.NotSetTransition?"~":"")+"Set "+F.set.toString())}console.log(T.toString(this._parser,!0)+":"+w)}}noViableAlt(_,E,T,w){return new C.NoViableAltException(this._parser,_,_.get(w),_.LT(1),T,E)}getUniqueAlt(_){let E=r.ATN.INVALID_ALT_NUMBER;for(let T of _)if(E===r.ATN.INVALID_ALT_NUMBER)E=T.alt;else if(T.alt!==E)return r.ATN.INVALID_ALT_NUMBER;return E}configWithAltAtStopState(_,E){for(let T of _)if(T.alt===E&&T.state instanceof k.RuleStopState)return!0;return!1}addDFAEdge(_,E,T,w,F,O){ce(w==null||w.isEmpty||_.isContextSensitive);let I=E,j=this.addDFAState(_,F,O);if(w!=null)for(let $ of w.toArray()){if($===N.PredictionContext.EMPTY_FULL_STATE_KEY&&I.configs.isOutermostConfigSet)continue;I.setContextSensitive(this.atn),I.setContextSymbol(T);let W=I.getContextTarget($);if(W!=null){I=W;continue}W=this.addDFAContextState(_,I.configs,$,O),ce($!==N.PredictionContext.EMPTY_FULL_STATE_KEY||W.configs.isOutermostConfigSet),I.setContextTarget($,W),I=W}return _e.debug&&console.log("EDGE "+I+" -> "+j+" upon "+this.getTokenName(T)),this.setDFAEdge(I,T,j),_e.debug&&console.log(`DFA=
`+_.toString(this._parser!=null?this._parser.vocabulary:ge.VocabularyImpl.EMPTY_VOCABULARY,this._parser!=null?this._parser.ruleNames:void 0)),j}setDFAEdge(_,E,T){_!=null&&_.setTarget(E,T)}addDFAContextState(_,E,T,w){if(T!==N.PredictionContext.EMPTY_FULL_STATE_KEY){let F=new a.ATNConfigSet;for(let O of E)F.add(O.appendContext(T,w));return this.addDFAState(_,F,w)}else return ce(!E.isOutermostConfigSet,"Shouldn't be adding a duplicate edge."),E=E.clone(!0),E.isOutermostConfigSet=!0,this.addDFAState(_,E,w)}addDFAState(_,E,T){let w=this.enable_global_context_dfa||!E.isOutermostConfigSet;if(w){E.isReadOnly||E.optimizeConfigs(this);let $=this.createDFAState(_,E),W=_.states.get($);if(W!=null)return W}E.isReadOnly||E.conflictInfo==null&&(E.conflictInfo=this.isConflicted(E,T));let F=this.createDFAState(_,E.clone(!0)),O=this.atn.getDecisionState(_.decision),I=this.getUniqueAlt(E);if(I!==r.ATN.INVALID_ALT_NUMBER)F.acceptStateInfo=new t.AcceptStateInfo(I);else if(E.conflictingAlts!=null){let $=E.conflictingAlts;$&&(F.acceptStateInfo=new t.AcceptStateInfo($.nextSetBit(0)))}if(F.isAcceptState&&E.hasSemanticContext&&this.predicateDFAState(F,E,O.numberOfTransitions),!w)return F;let j=_.addState(F);return _e.debug&&j===F&&console.log("adding new DFA state: "+F),j}createDFAState(_,E){return new y.DFAState(E)}reportAttemptingFullContext(_,E,T,w,F){if(_e.debug||_e.retry_debug){let O=v.Interval.of(w,F);console.log("reportAttemptingFullContext decision="+_.decision+":"+T.s0.configs+", input="+this._parser.inputStream.getText(O))}if(this._parser!=null){let O=this._parser.getErrorListenerDispatch();O.reportAttemptingFullContext&&O.reportAttemptingFullContext(this._parser,_,w,F,E,T)}}reportContextSensitivity(_,E,T,w,F){if(_e.debug||_e.retry_debug){let O=v.Interval.of(w,F);console.log("reportContextSensitivity decision="+_.decision+":"+T.s0.configs+", input="+this._parser.inputStream.getText(O))}if(this._parser!=null){let O=this._parser.getErrorListenerDispatch();O.reportContextSensitivity&&O.reportContextSensitivity(this._parser,_,w,F,E,T)}}reportAmbiguity(_,E,T,w,F,O,I){if(_e.debug||_e.retry_debug){let j=v.Interval.of(T,w);console.log("reportAmbiguity "+O+":"+I+", input="+this._parser.inputStream.getText(j))}if(this._parser!=null){let j=this._parser.getErrorListenerDispatch();j.reportAmbiguity&&j.reportAmbiguity(this._parser,_,T,w,F,O,I)}}getReturnState(_){return _.isEmpty?N.PredictionContext.EMPTY_FULL_STATE_KEY:this.atn.states[_.invokingState].transition(0).followState.stateNumber}skipTailCalls(_){if(!this.optimize_tail_calls)return _;for(;!_.isEmpty;){let E=this.atn.states[_.invokingState];if(ce(E.numberOfTransitions===1&&E.transition(0).serializationType===3),!E.transition(0).tailCall)break;_=_.parent}return _}get parser(){return this._parser}};return Q.debug=!1,Q.dfa_debug=!1,Q.retry_debug=!1,Q.STATE_ALT_SORT_COMPARATOR=(ie,_)=>{let E=ie.state.nonStopStateNumber-_.state.nonStopStateNumber;return E!==0||(E=ie.alt-_.alt,E!==0)?E:0},l([g.NotNull],Q.prototype,"predictionMode",void 0),l([g.NotNull],Q.prototype,"getPredictionMode",null),l([e(0,g.NotNull)],Q.prototype,"setPredictionMode",null),l([g.Override],Q.prototype,"reset",null),l([e(0,g.NotNull)],Q.prototype,"adaptivePredict",null),l([e(0,g.NotNull),e(1,g.NotNull),e(2,g.NotNull)],Q.prototype,"getStartState",null),l([e(0,g.NotNull),e(1,g.NotNull),e(3,g.NotNull)],Q.prototype,"execDFA",null),l([e(0,g.NotNull),e(1,g.NotNull),e(3,g.NotNull)],Q.prototype,"execATN",null),l([e(0,g.NotNull),e(2,g.NotNull)],Q.prototype,"handleNoViableAlt",null),l([e(0,g.NotNull)],Q.prototype,"getExistingTargetState",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"computeTargetState",null),l([g.NotNull,e(0,g.NotNull)],Q.prototype,"removeAllConfigsNotInRuleStopState",null),l([g.NotNull],Q.prototype,"computeStartState",null),l([g.NotNull,e(0,g.NotNull)],Q.prototype,"applyPrecedenceFilter",null),l([e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"getReachableTarget",null),l([e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"getPredsForAmbigAlts",null),l([e(0,g.NotNull)],Q.prototype,"evalSemanticContext",null),l([e(0,g.NotNull)],Q.prototype,"evalSemanticContextImpl",null),l([e(1,g.NotNull),e(4,g.Nullable)],Q.prototype,"closure",null),l([e(0,g.NotNull),e(1,g.NotNull),e(2,g.Nullable),e(3,g.NotNull),e(6,g.NotNull)],Q.prototype,"closureImpl",null),l([g.NotNull],Q.prototype,"getRuleName",null),l([e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"getEpsilonTarget",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"actionTransition",null),l([g.Nullable,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"precedenceTransition",null),l([g.Nullable,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"predTransition",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull),e(2,g.Nullable)],Q.prototype,"ruleTransition",null),l([e(0,g.NotNull)],Q.prototype,"isConflicted",null),l([g.NotNull],Q.prototype,"getTokenName",null),l([e(0,g.NotNull)],Q.prototype,"dumpDeadEndConfigs",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull),e(2,g.NotNull)],Q.prototype,"noViableAlt",null),l([e(0,g.NotNull)],Q.prototype,"getUniqueAlt",null),l([e(0,g.NotNull)],Q.prototype,"configWithAltAtStopState",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull),e(4,g.NotNull)],Q.prototype,"addDFAEdge",null),l([e(0,g.Nullable),e(2,g.Nullable)],Q.prototype,"setDFAEdge",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"addDFAContextState",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"addDFAState",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"createDFAState",null),l([e(0,g.NotNull),e(2,g.NotNull)],Q.prototype,"reportAttemptingFullContext",null),l([e(0,g.NotNull),e(2,g.NotNull)],Q.prototype,"reportContextSensitivity",null),l([e(0,g.NotNull),e(5,g.NotNull),e(6,g.NotNull)],Q.prototype,"reportAmbiguity",null),Q=l([e(0,g.NotNull)],Q),Ht.ParserATNSimulator=Q,Ht}var Sn={},Rh;function om(){if(Rh)return Sn;Rh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Sn&&Sn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.PlusBlockStartState=void 0;const e=He(),t=zo(),n=Z();let o=class extends t.BlockStartState{get stateType(){return e.ATNStateType.PLUS_BLOCK_START}};return l([n.Override],o.prototype,"stateType",null),Sn.PlusBlockStartState=o,Sn}var An={},wh;function sm(){if(wh)return An;wh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=An&&An.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(An,"__esModule",{value:!0}),An.PlusLoopbackState=void 0;const e=He(),t=Wn(),n=Z();let o=class extends t.DecisionState{get stateType(){return e.ATNStateType.PLUS_LOOP_BACK}};return l([n.Override],o.prototype,"stateType",null),An.PlusLoopbackState=o,An}var Wt={},Oh;function am(){if(Oh)return Wt;Oh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Wt&&Wt.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Wt&&Wt.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PrecedencePredicateTransition=void 0;const t=el(),n=Z(),o=hi();let i=class extends t.AbstractPredicateTransition{constructor(s,a){super(s),this.precedence=a}get serializationType(){return 10}get isEpsilon(){return!0}matches(s,a,c){return!1}get predicate(){return new o.SemanticContext.PrecedencePredicate(this.precedence)}toString(){return this.precedence+" >= _p"}};return l([n.Override],i.prototype,"serializationType",null),l([n.Override],i.prototype,"isEpsilon",null),l([n.Override],i.prototype,"matches",null),l([n.Override],i.prototype,"toString",null),i=l([e(0,n.NotNull)],i),Wt.PrecedencePredicateTransition=i,Wt}var Gt={},Fh;function lm(){if(Fh)return Gt;Fh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Gt&&Gt.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Gt&&Gt.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.RangeTransition=void 0;const t=Yn(),n=Z(),o=Or();let i=class extends o.Transition{constructor(s,a,c){super(s),this.from=a,this.to=c}get serializationType(){return 2}get label(){return t.IntervalSet.of(this.from,this.to)}matches(s,a,c){return s>=this.from&&s<=this.to}toString(){return"'"+String.fromCodePoint(this.from)+"'..'"+String.fromCodePoint(this.to)+"'"}};return l([n.Override],i.prototype,"serializationType",null),l([n.Override,n.NotNull],i.prototype,"label",null),l([n.Override],i.prototype,"matches",null),l([n.Override,n.NotNull],i.prototype,"toString",null),i=l([e(0,n.NotNull)],i),Gt.RangeTransition=i,Gt}var Cn={},Ph;function um(){if(Ph)return Cn;Ph=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Cn&&Cn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.RuleStartState=void 0;const e=yr(),t=He(),n=Z();let o=class extends e.ATNState{constructor(){super(...arguments),this.isPrecedenceRule=!1,this.leftFactored=!1}get stateType(){return t.ATNStateType.RULE_START}};return l([n.Override],o.prototype,"stateType",null),Cn.RuleStartState=o,Cn}var En={},Ih;function cm(){if(Ih)return En;Ih=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=En&&En.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(En,"__esModule",{value:!0}),En.StarBlockStartState=void 0;const e=He(),t=zo(),n=Z();let o=class extends t.BlockStartState{get stateType(){return e.ATNStateType.STAR_BLOCK_START}};return l([n.Override],o.prototype,"stateType",null),En.StarBlockStartState=o,En}var _n={},Dh;function hm(){if(Dh)return _n;Dh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=_n&&_n.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(_n,"__esModule",{value:!0}),_n.StarLoopbackState=void 0;const e=yr(),t=He(),n=Z();let o=class extends e.ATNState{get loopEntryState(){return this.transition(0).target}get stateType(){return t.ATNStateType.STAR_LOOP_BACK}};return l([n.Override],o.prototype,"stateType",null),_n.StarLoopbackState=o,_n}var Tn={},Lh;function fm(){if(Lh)return Tn;Lh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Tn&&Tn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.TokensStartState=void 0;const e=He(),t=Wn(),n=Z();let o=class extends t.DecisionState{get stateType(){return e.ATNStateType.TOKEN_START}};return l([n.Override],o.prototype,"stateType",null),Tn.TokensStartState=o,Tn}var wi={},Mh;function dm(){if(Mh)return wi;Mh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(wi,"__esModule",{value:!0}),wi.UUID=void 0;const l=je();let e=class ka{constructor(n,o,i,r){this.data=new Uint32Array(4),this.data[0]=n,this.data[1]=o,this.data[2]=i,this.data[3]=r}static fromString(n){if(!/^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$/.test(n))throw new Error("Incorrectly formatted UUID");let o=n.split("-"),i=parseInt(o[0],16),r=(parseInt(o[1],16)<<16>>>0)+parseInt(o[2],16),s=(parseInt(o[3],16)<<16>>>0)+parseInt(o[4].substr(0,4),16),a=parseInt(o[4].substr(-8),16);return new ka(i,r,s,a)}hashCode(){return l.MurmurHash.hashCode([this.data[0],this.data[1],this.data[2],this.data[3]])}equals(n){return n===this?!0:n instanceof ka?this.data[0]===n.data[0]&&this.data[1]===n.data[1]&&this.data[2]===n.data[2]&&this.data[3]===n.data[3]:!1}toString(){return("00000000"+this.data[0].toString(16)).substr(-8)+"-"+("0000"+(this.data[1]>>>16).toString(16)).substr(-4)+"-"+("0000"+this.data[1].toString(16)).substr(-4)+"-"+("0000"+(this.data[2]>>>16).toString(16)).substr(-4)+"-"+("0000"+this.data[2].toString(16)).substr(-4)+("00000000"+this.data[3].toString(16)).substr(-8)}};return wi.UUID=e,wi}var Bh;function fl(){if(Bh)return Dt;Bh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Dt&&Dt.__decorate||function(W,L,M,U){var Y=arguments.length,re=Y<3?L:U===null?U=Object.getOwnPropertyDescriptor(L,M):U,ne;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")re=Reflect.decorate(W,L,M,U);else for(var q=W.length-1;q>=0;q--)(ne=W[q])&&(re=(Y<3?ne(re):Y>3?ne(L,M,re):ne(L,M))||re);return Y>3&&re&&Object.defineProperty(L,M,re),re},e=Dt&&Dt.__param||function(W,L){return function(M,U){L(M,U,W)}};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.ATNDeserializer=void 0;const t=Hd(),n=Fr(),o=ft(),i=Ud(),r=He(),s=$d(),a=W0(),c=Bd(),u=Pr(),h=G0(),f=zo(),d=Wn(),p=Md(),y=Y0(),m=Yn(),v=kd(),x=X0(),g=K0(),S=Q0(),C=J0(),A=Z0(),b=em(),N=tm(),R=rm(),P=Kd(),k=Z(),D=ll(),H=ro(),J=om(),te=sm(),le=am(),ge=Rd(),ce=lm(),ee=um(),G=to(),Q=ul(),ie=al(),_=cm(),E=hm(),T=sl(),w=Be(),F=fm(),O=dm(),I=zd();var j;(function(W){W[W.UNICODE_BMP=0]="UNICODE_BMP",W[W.UNICODE_SMP=1]="UNICODE_SMP"})(j||(j={}));let $=class de{constructor(L){L===void 0&&(L=i.ATNDeserializationOptions.defaultOptions),this.deserializationOptions=L}static get SERIALIZED_VERSION(){return 3}static isFeatureSupported(L,M){let U=de.SUPPORTED_UUIDS.findIndex(Y=>Y.equals(L));return U<0?!1:de.SUPPORTED_UUIDS.findIndex(Y=>Y.equals(M))>=U}static getUnicodeDeserializer(L){return L===0?{readUnicode:(M,U)=>de.toInt(M[U]),size:1}:{readUnicode:(M,U)=>de.toInt32(M,U),size:2}}deserialize(L){L=L.slice(0);for(let K=1;K<L.length;K++)L[K]=L[K]-2&65535;let M=0,U=de.toInt(L[M++]);if(U!==de.SERIALIZED_VERSION){let K=`Could not deserialize ATN with version ${U} (expected ${de.SERIALIZED_VERSION}).`;throw new Error(K)}let Y=de.toUUID(L,M);if(M+=8,de.SUPPORTED_UUIDS.findIndex(K=>K.equals(Y))<0){let K=`Could not deserialize ATN with UUID ${Y} (expected ${de.SERIALIZED_UUID} or a legacy UUID).`;throw new Error(K)}let re=de.isFeatureSupported(de.ADDED_LEXER_ACTIONS,Y),ne=de.toInt(L[M++]),q=de.toInt(L[M++]),X=new o.ATN(ne,q),he=[],Ne=[],Re=de.toInt(L[M++]);for(let K=0;K<Re;K++){let xe=de.toInt(L[M++]);if(xe===r.ATNStateType.INVALID_TYPE){X.addState(new v.InvalidState);continue}let ye=de.toInt(L[M++]);ye===65535&&(ye=-1);let Ee=this.stateFactory(xe,ye);if(xe===r.ATNStateType.LOOP_END){let Ie=de.toInt(L[M++]);he.push([Ee,Ie])}else if(Ee instanceof f.BlockStartState){let Ie=de.toInt(L[M++]);Ne.push([Ee,Ie])}X.addState(Ee)}for(let K of he)K[0].loopBackState=X.states[K[1]];for(let K of Ne)K[0].endState=X.states[K[1]];let z=de.toInt(L[M++]);for(let K=0;K<z;K++){let xe=de.toInt(L[M++]);X.states[xe].nonGreedy=!0}let V=de.toInt(L[M++]);for(let K=0;K<V;K++){let xe=de.toInt(L[M++]);X.states[xe].sll=!0}let ae=de.toInt(L[M++]);for(let K=0;K<ae;K++){let xe=de.toInt(L[M++]);X.states[xe].isPrecedenceRule=!0}let pe=de.toInt(L[M++]);X.grammarType===0&&(X.ruleToTokenType=new Int32Array(pe)),X.ruleToStartState=new Array(pe);for(let K=0;K<pe;K++){let xe=de.toInt(L[M++]),ye=X.states[xe];if(ye.leftFactored=de.toInt(L[M++])!==0,X.ruleToStartState[K]=ye,X.grammarType===0){let Ee=de.toInt(L[M++]);Ee===65535&&(Ee=w.Token.EOF),X.ruleToTokenType[K]=Ee,de.isFeatureSupported(de.ADDED_LEXER_ACTIONS,Y)||de.toInt(L[M++])}}X.ruleToStopState=new Array(pe);for(let K of X.states)K instanceof G.RuleStopState&&(X.ruleToStopState[K.ruleIndex]=K,X.ruleToStartState[K.ruleIndex].stopState=K);let me=de.toInt(L[M++]);for(let K=0;K<me;K++){let xe=de.toInt(L[M++]);X.modeToStartState.push(X.states[xe])}X.modeToDFA=new Array(me);for(let K=0;K<me;K++)X.modeToDFA[K]=new p.DFA(X.modeToStartState[K]);let Te=[];M=this.deserializeSets(L,M,Te,de.getUnicodeDeserializer(0)),de.isFeatureSupported(de.ADDED_UNICODE_SMP,Y)&&(M=this.deserializeSets(L,M,Te,de.getUnicodeDeserializer(1)));let Se=de.toInt(L[M++]);for(let K=0;K<Se;K++){let xe=de.toInt(L[M]),ye=de.toInt(L[M+1]),Ee=de.toInt(L[M+2]),Ie=de.toInt(L[M+3]),Ge=de.toInt(L[M+4]),Ue=de.toInt(L[M+5]),Ze=this.edgeFactory(X,Ee,xe,ye,Ie,Ge,Ue,Te);X.states[xe].addTransition(Ze),M+=6}let we=new n.Array2DHashSet({hashCode:K=>K.stopState^K.returnState^K.outermostPrecedenceReturn,equals:(K,xe)=>K.stopState===xe.stopState&&K.returnState===xe.returnState&&K.outermostPrecedenceReturn===xe.outermostPrecedenceReturn}),Oe=[];for(let K of X.states){let xe=K.ruleIndex>=0&&X.ruleToStartState[K.ruleIndex].leftFactored;for(let ye=0;ye<K.numberOfTransitions;ye++){let Ee=K.transition(ye);if(!(Ee instanceof Q.RuleTransition))continue;let Ie=Ee;if(!X.ruleToStartState[Ie.target.ruleIndex].leftFactored&&xe)continue;let Ue=-1;X.ruleToStartState[Ie.target.ruleIndex].isPrecedenceRule&&Ie.precedence===0&&(Ue=Ie.target.ruleIndex);let Ze={stopState:Ie.target.ruleIndex,returnState:Ie.followState.stateNumber,outermostPrecedenceReturn:Ue};we.add(Ze)&&Oe.push(Ze)}}for(let K of Oe){let xe=new y.EpsilonTransition(X.states[K.returnState],K.outermostPrecedenceReturn);X.ruleToStopState[K.stopState].addTransition(xe)}for(let K of X.states){if(K instanceof f.BlockStartState){if(K.endState===void 0)throw new Error("IllegalStateException");if(K.endState.startState!==void 0)throw new Error("IllegalStateException");K.endState.startState=K}if(K instanceof te.PlusLoopbackState){let xe=K;for(let ye=0;ye<xe.numberOfTransitions;ye++){let Ee=xe.transition(ye).target;Ee instanceof J.PlusBlockStartState&&(Ee.loopBackState=xe)}}else if(K instanceof E.StarLoopbackState){let xe=K;for(let ye=0;ye<xe.numberOfTransitions;ye++){let Ee=xe.transition(ye).target;Ee instanceof T.StarLoopEntryState&&(Ee.loopBackState=xe)}}}let ze=de.toInt(L[M++]);for(let K=1;K<=ze;K++){let xe=de.toInt(L[M++]),ye=X.states[xe];X.decisionToState.push(ye),ye.decision=K-1}if(X.grammarType===0)if(re){X.lexerActions=new Array(de.toInt(L[M++]));for(let K=0;K<X.lexerActions.length;K++){let xe=de.toInt(L[M++]),ye=de.toInt(L[M++]);ye===65535&&(ye=-1);let Ee=de.toInt(L[M++]);Ee===65535&&(Ee=-1);let Ie=this.lexerActionFactory(xe,ye,Ee);X.lexerActions[K]=Ie}}else{let K=[];for(let xe of X.states)for(let ye=0;ye<xe.numberOfTransitions;ye++){let Ee=xe.transition(ye);if(!(Ee instanceof t.ActionTransition))continue;let Ie=Ee.ruleIndex,Ge=Ee.actionIndex,Ue=new g.LexerCustomAction(Ie,Ge);xe.setTransition(ye,new t.ActionTransition(Ee.target,Ie,K.length,!1)),K.push(Ue)}X.lexerActions=K}this.markPrecedenceDecisions(X),X.decisionToDFA=new Array(ze);for(let K=0;K<ze;K++)X.decisionToDFA[K]=new p.DFA(X.decisionToState[K],K);if(this.deserializationOptions.isVerifyATN&&this.verifyATN(X),this.deserializationOptions.isGenerateRuleBypassTransitions&&X.grammarType===1){X.ruleToTokenType=new Int32Array(X.ruleToStartState.length);for(let K=0;K<X.ruleToStartState.length;K++)X.ruleToTokenType[K]=X.maxTokenType+K+1;for(let K=0;K<X.ruleToStartState.length;K++){let xe=new a.BasicBlockStartState;xe.ruleIndex=K,X.addState(xe);let ye=new h.BlockEndState;ye.ruleIndex=K,X.addState(ye),xe.endState=ye,X.defineDecisionState(xe),ye.startState=xe;let Ee,Ie;if(X.ruleToStartState[K].isPrecedenceRule){Ee=void 0;for(let Ue of X.states){if(Ue.ruleIndex!==K||!(Ue instanceof T.StarLoopEntryState))continue;let Ze=Ue.transition(Ue.numberOfTransitions-1).target;if(Ze instanceof P.LoopEndState&&Ze.epsilonOnlyTransitions&&Ze.transition(0).target instanceof G.RuleStopState){Ee=Ue;break}}if(!Ee)throw new Error("Couldn't identify final state of the precedence rule prefix section.");Ie=Ee.loopBackState.transition(0)}else Ee=X.ruleToStopState[K];for(let Ue of X.states)for(let Ze=0;Ze<Ue.numberOfTransitions;Ze++){let ao=Ue.transition(Ze);ao!==Ie&&ao.target===Ee&&(ao.target=ye)}for(;X.ruleToStartState[K].numberOfTransitions>0;){let Ue=X.ruleToStartState[K].removeTransition(X.ruleToStartState[K].numberOfTransitions-1);xe.addTransition(Ue)}X.ruleToStartState[K].addTransition(new y.EpsilonTransition(xe)),ye.addTransition(new y.EpsilonTransition(Ee));let Ge=new c.BasicState;X.addState(Ge),Ge.addTransition(new s.AtomTransition(ye,X.ruleToTokenType[K])),xe.addTransition(new y.EpsilonTransition(Ge))}this.deserializationOptions.isVerifyATN&&this.verifyATN(X)}if(this.deserializationOptions.isOptimize){for(;;){let K=0;K+=de.inlineSetRules(X),K+=de.combineChainedEpsilons(X);let xe=X.grammarType===0;if(K+=de.optimizeSets(X,xe),K===0)break}this.deserializationOptions.isVerifyATN&&this.verifyATN(X)}return de.identifyTailCalls(X),X}deserializeSets(L,M,U,Y){let re=de.toInt(L[M++]);for(let ne=0;ne<re;ne++){let q=de.toInt(L[M]);M++;let X=new m.IntervalSet;U.push(X),de.toInt(L[M++])!==0&&X.add(-1);for(let Ne=0;Ne<q;Ne++){let Re=Y.readUnicode(L,M);M+=Y.size;let z=Y.readUnicode(L,M);M+=Y.size,X.add(Re,z)}}return M}markPrecedenceDecisions(L){let M=new Map;for(let U of L.states)if(U instanceof T.StarLoopEntryState&&L.ruleToStartState[U.ruleIndex].isPrecedenceRule){let Y=U.transition(U.numberOfTransitions-1).target;Y instanceof P.LoopEndState&&Y.epsilonOnlyTransitions&&Y.transition(0).target instanceof G.RuleStopState&&(M.set(U.ruleIndex,U),U.precedenceRuleDecision=!0,U.precedenceLoopbackStates=new u.BitSet(L.states.length))}for(let U of M)for(let Y of L.ruleToStopState[U[0]].getTransitions())Y.serializationType!==1||Y.outermostPrecedenceReturn!==-1||U[1].precedenceLoopbackStates.set(Y.target.stateNumber)}verifyATN(L){for(let M of L.states)if(this.checkCondition(M!==void 0,"ATN states should not be undefined."),M.stateType!==r.ATNStateType.INVALID_TYPE){if(this.checkCondition(M.onlyHasEpsilonTransitions||M.numberOfTransitions<=1),M instanceof J.PlusBlockStartState&&this.checkCondition(M.loopBackState!==void 0),M instanceof T.StarLoopEntryState){let U=M;if(this.checkCondition(U.loopBackState!==void 0),this.checkCondition(U.numberOfTransitions===2),U.transition(0).target instanceof _.StarBlockStartState)this.checkCondition(U.transition(1).target instanceof P.LoopEndState),this.checkCondition(!U.nonGreedy);else if(U.transition(0).target instanceof P.LoopEndState)this.checkCondition(U.transition(1).target instanceof _.StarBlockStartState),this.checkCondition(U.nonGreedy);else throw new Error("IllegalStateException")}if(M instanceof E.StarLoopbackState&&(this.checkCondition(M.numberOfTransitions===1),this.checkCondition(M.transition(0).target instanceof T.StarLoopEntryState)),M instanceof P.LoopEndState&&this.checkCondition(M.loopBackState!==void 0),M instanceof ee.RuleStartState&&this.checkCondition(M.stopState!==void 0),M instanceof f.BlockStartState&&this.checkCondition(M.endState!==void 0),M instanceof h.BlockEndState&&this.checkCondition(M.startState!==void 0),M instanceof d.DecisionState){let U=M;this.checkCondition(U.numberOfTransitions<=1||U.decision>=0)}else this.checkCondition(M.numberOfTransitions<=1||M instanceof G.RuleStopState)}}checkCondition(L,M){if(!L)throw new Error("IllegalStateException: "+M)}static inlineSetRules(L){let M=0,U=new Array(L.ruleToStartState.length);for(let Y=0;Y<L.ruleToStartState.length;Y++){let ne=L.ruleToStartState[Y];for(;ne.onlyHasEpsilonTransitions&&ne.numberOfOptimizedTransitions===1&&ne.getOptimizedTransition(0).serializationType===1;)ne=ne.getOptimizedTransition(0).target;if(ne.numberOfOptimizedTransitions!==1)continue;let q=ne.getOptimizedTransition(0),X=q.target;if(!(q.isEpsilon||!X.onlyHasEpsilonTransitions||X.numberOfOptimizedTransitions!==1||!(X.getOptimizedTransition(0).target instanceof G.RuleStopState)))switch(q.serializationType){case 5:case 2:case 7:U[Y]=q;break;case 8:case 9:continue;default:continue}}for(let Y of L.states){if(Y.ruleIndex<0)continue;let re;for(let ne=0;ne<Y.numberOfOptimizedTransitions;ne++){let q=Y.getOptimizedTransition(ne);if(!(q instanceof Q.RuleTransition)){re!==void 0&&re.push(q);continue}let X=q,he=U[X.target.ruleIndex];if(he===void 0){re!==void 0&&re.push(q);continue}if(re===void 0){re=[];for(let z=0;z<ne;z++)re.push(Y.getOptimizedTransition(ne))}M++;let Ne=X.followState,Re=new c.BasicState;switch(Re.setRuleIndex(Ne.ruleIndex),L.addState(Re),re.push(new y.EpsilonTransition(Re)),he.serializationType){case 5:Re.addTransition(new s.AtomTransition(Ne,he._label));break;case 2:Re.addTransition(new ce.RangeTransition(Ne,he.from,he.to));break;case 7:Re.addTransition(new ie.SetTransition(Ne,he.label));break;default:throw new Error("UnsupportedOperationException")}}if(re!==void 0){if(Y.isOptimized)for(;Y.numberOfOptimizedTransitions>0;)Y.removeOptimizedTransition(Y.numberOfOptimizedTransitions-1);for(let ne of re)Y.addOptimizedTransition(ne)}}return H.ParserATNSimulator.debug&&console.log("ATN runtime optimizer removed "+M+" rule invocations by inlining sets."),M}static combineChainedEpsilons(L){let M=0;for(let U of L.states){if(!U.onlyHasEpsilonTransitions||U instanceof G.RuleStopState)continue;let Y;e:for(let re=0;re<U.numberOfOptimizedTransitions;re++){let ne=U.getOptimizedTransition(re),q=ne.target;if(ne.serializationType!==1||ne.outermostPrecedenceReturn!==-1||q.stateType!==r.ATNStateType.BASIC||!q.onlyHasEpsilonTransitions){Y!==void 0&&Y.push(ne);continue e}for(let X=0;X<q.numberOfOptimizedTransitions;X++)if(q.getOptimizedTransition(X).serializationType!==1||q.getOptimizedTransition(X).outermostPrecedenceReturn!==-1){Y!==void 0&&Y.push(ne);continue e}if(M++,Y===void 0){Y=[];for(let X=0;X<re;X++)Y.push(U.getOptimizedTransition(X))}for(let X=0;X<q.numberOfOptimizedTransitions;X++){let he=q.getOptimizedTransition(X).target;Y.push(new y.EpsilonTransition(he))}}if(Y!==void 0){if(U.isOptimized)for(;U.numberOfOptimizedTransitions>0;)U.removeOptimizedTransition(U.numberOfOptimizedTransitions-1);for(let re of Y)U.addOptimizedTransition(re)}}return H.ParserATNSimulator.debug&&console.log("ATN runtime optimizer removed "+M+" transitions by combining chained epsilon transitions."),M}static optimizeSets(L,M){if(M)return 0;let U=0,Y=L.decisionToState;for(let re of Y){let ne=new m.IntervalSet;for(let z=0;z<re.numberOfOptimizedTransitions;z++){let V=re.getOptimizedTransition(z);if(!(V instanceof y.EpsilonTransition)||V.target.numberOfOptimizedTransitions!==1)continue;let ae=V.target.getOptimizedTransition(0);ae.target instanceof h.BlockEndState&&(ae instanceof D.NotSetTransition||(ae instanceof s.AtomTransition||ae instanceof ce.RangeTransition||ae instanceof ie.SetTransition)&&ne.add(z))}if(ne.size<=1)continue;let q=[];for(let z=0;z<re.numberOfOptimizedTransitions;z++)ne.contains(z)||q.push(re.getOptimizedTransition(z));let X=re.getOptimizedTransition(ne.minElement).target.getOptimizedTransition(0).target,he=new m.IntervalSet;for(let z of ne.intervals)for(let V=z.a;V<=z.b;V++){let ae=re.getOptimizedTransition(V).target.getOptimizedTransition(0);if(ae instanceof D.NotSetTransition)throw new Error("Not yet implemented.");he.addAll(ae.label)}let Ne;if(he.intervals.length===1)if(he.size===1)Ne=new s.AtomTransition(X,he.minElement);else{let z=he.intervals[0];Ne=new ce.RangeTransition(X,z.a,z.b)}else Ne=new ie.SetTransition(X,he);let Re=new c.BasicState;if(Re.setRuleIndex(re.ruleIndex),L.addState(Re),Re.addTransition(Ne),q.push(new y.EpsilonTransition(Re)),U+=re.numberOfOptimizedTransitions-q.length,re.isOptimized)for(;re.numberOfOptimizedTransitions>0;)re.removeOptimizedTransition(re.numberOfOptimizedTransitions-1);for(let z of q)re.addOptimizedTransition(z)}return H.ParserATNSimulator.debug&&console.log("ATN runtime optimizer removed "+U+" paths by collapsing sets."),U}static identifyTailCalls(L){for(let M of L.states){for(let U=0;U<M.numberOfTransitions;U++){let Y=M.transition(U);Y instanceof Q.RuleTransition&&(Y.tailCall=this.testTailCall(L,Y,!1),Y.optimizedTailCall=this.testTailCall(L,Y,!0))}if(M.isOptimized)for(let U=0;U<M.numberOfOptimizedTransitions;U++){let Y=M.getOptimizedTransition(U);Y instanceof Q.RuleTransition&&(Y.tailCall=this.testTailCall(L,Y,!1),Y.optimizedTailCall=this.testTailCall(L,Y,!0))}}}static testTailCall(L,M,U){if(!U&&M.tailCall||U&&M.optimizedTailCall)return!0;let Y=new u.BitSet(L.states.length),re=[];for(re.push(M.followState);;){let ne=re.pop();if(!ne)break;if(Y.get(ne.stateNumber)||ne instanceof G.RuleStopState)continue;if(!ne.onlyHasEpsilonTransitions)return!1;let q=U?ne.numberOfOptimizedTransitions:ne.numberOfTransitions;for(let X=0;X<q;X++){let he=U?ne.getOptimizedTransition(X):ne.transition(X);if(he.serializationType!==1)return!1;re.push(he.target)}}return!0}static toInt(L){return L}static toInt32(L,M){return(L[M]|L[M+1]<<16)>>>0}static toUUID(L,M){let U=de.toInt32(L,M),Y=de.toInt32(L,M+2),re=de.toInt32(L,M+4),ne=de.toInt32(L,M+6);return new O.UUID(ne,re,Y,U)}edgeFactory(L,M,U,Y,re,ne,q,X){let he=L.states[Y];switch(M){case 1:return new y.EpsilonTransition(he);case 2:return q!==0?new ce.RangeTransition(he,w.Token.EOF,ne):new ce.RangeTransition(he,re,ne);case 3:return new Q.RuleTransition(L.states[re],ne,q,he);case 4:return new ge.PredicateTransition(he,re,ne,q!==0);case 10:return new le.PrecedencePredicateTransition(he,re);case 5:return q!==0?new s.AtomTransition(he,w.Token.EOF):new s.AtomTransition(he,re);case 6:return new t.ActionTransition(he,re,ne,q!==0);case 7:return new ie.SetTransition(he,X[re]);case 8:return new D.NotSetTransition(he,X[re]);case 9:return new I.WildcardTransition(he)}throw new Error("The specified transition type is not valid.")}stateFactory(L,M){let U;switch(L){case r.ATNStateType.INVALID_TYPE:return new v.InvalidState;case r.ATNStateType.BASIC:U=new c.BasicState;break;case r.ATNStateType.RULE_START:U=new ee.RuleStartState;break;case r.ATNStateType.BLOCK_START:U=new a.BasicBlockStartState;break;case r.ATNStateType.PLUS_BLOCK_START:U=new J.PlusBlockStartState;break;case r.ATNStateType.STAR_BLOCK_START:U=new _.StarBlockStartState;break;case r.ATNStateType.TOKEN_START:U=new F.TokensStartState;break;case r.ATNStateType.RULE_STOP:U=new G.RuleStopState;break;case r.ATNStateType.BLOCK_END:U=new h.BlockEndState;break;case r.ATNStateType.STAR_LOOP_BACK:U=new E.StarLoopbackState;break;case r.ATNStateType.STAR_LOOP_ENTRY:U=new T.StarLoopEntryState;break;case r.ATNStateType.PLUS_LOOP_BACK:U=new te.PlusLoopbackState;break;case r.ATNStateType.LOOP_END:U=new P.LoopEndState;break;default:let Y=`The specified state type ${L} is not valid.`;throw new Error(Y)}return U.ruleIndex=M,U}lexerActionFactory(L,M,U){switch(L){case 0:return new x.LexerChannelAction(M);case 1:return new g.LexerCustomAction(M,U);case 2:return new S.LexerModeAction(M);case 3:return C.LexerMoreAction.INSTANCE;case 4:return A.LexerPopModeAction.INSTANCE;case 5:return new b.LexerPushModeAction(M);case 6:return N.LexerSkipAction.INSTANCE;case 7:return new R.LexerTypeAction(M);default:let Y=`The specified lexer action type ${L} is not valid.`;throw new Error(Y)}}};return $.BASE_SERIALIZED_UUID=O.UUID.fromString("E4178468-DF95-44D0-AD87-F22A5D5FB6D3"),$.ADDED_LEXER_ACTIONS=O.UUID.fromString("AB35191A-1603-487E-B75A-479B831EAF6D"),$.ADDED_UNICODE_SMP=O.UUID.fromString("C23FEA89-0605-4f51-AFB8-058BCAB8C91B"),$.SUPPORTED_UUIDS=[$.BASE_SERIALIZED_UUID,$.ADDED_LEXER_ACTIONS,$.ADDED_UNICODE_SMP],$.SERIALIZED_UUID=$.ADDED_UNICODE_SMP,l([k.NotNull],$.prototype,"deserializationOptions",void 0),l([e(0,k.NotNull)],$.prototype,"deserialize",null),l([e(0,k.NotNull)],$.prototype,"markPrecedenceDecisions",null),l([k.NotNull,e(0,k.NotNull)],$.prototype,"edgeFactory",null),Dt.ATNDeserializer=$,Dt}var Yt={},kh;function pm(){if(kh)return Yt;kh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Yt&&Yt.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c},e=Yt&&Yt.__param||function(o,i){return function(r,s){i(r,s,o)}};Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.ParseInfo=void 0;const t=Z();let n=class{constructor(i){this.atnSimulator=i}getDecisionInfo(){return this.atnSimulator.getDecisionInfo()}getLLDecisions(){let i=this.atnSimulator.getDecisionInfo(),r=[];for(let s=0;s<i.length;s++)i[s].LL_Fallback>0&&r.push(s);return r}getTotalTimeInPrediction(){let i=this.atnSimulator.getDecisionInfo(),r=0;for(let s of i)r+=s.timeInPrediction;return r}getTotalSLLLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),r=0;for(let s of i)r+=s.SLL_TotalLook;return r}getTotalLLLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),r=0;for(let s of i)r+=s.LL_TotalLook;return r}getTotalSLLATNLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),r=0;for(let s of i)r+=s.SLL_ATNTransitions;return r}getTotalLLATNLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),r=0;for(let s of i)r+=s.LL_ATNTransitions;return r}getTotalATNLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),r=0;for(let s of i)r+=s.SLL_ATNTransitions,r+=s.LL_ATNTransitions;return r}getDFASize(i){if(i)return this.atnSimulator.atn.decisionToDFA[i].states.size;{let r=0,s=this.atnSimulator.atn.decisionToDFA;for(let a=0;a<s.length;a++)r+=this.getDFASize(a);return r}}};return l([t.NotNull],n.prototype,"getDecisionInfo",null),l([t.NotNull],n.prototype,"getLLDecisions",null),n=l([e(0,t.NotNull)],n),Yt.ParseInfo=n,Yt}var bn={},zh;function tp(){if(zh)return bn;zh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=bn&&bn.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c};Object.defineProperty(bn,"__esModule",{value:!0}),bn.ProxyParserErrorListener=void 0;const e=ol(),t=Z();let n=class extends e.ProxyErrorListener{constructor(i){super(i)}reportAmbiguity(i,r,s,a,c,u,h){this.getDelegates().forEach(f=>{f.reportAmbiguity&&f.reportAmbiguity(i,r,s,a,c,u,h)})}reportAttemptingFullContext(i,r,s,a,c,u){this.getDelegates().forEach(h=>{h.reportAttemptingFullContext&&h.reportAttemptingFullContext(i,r,s,a,c,u)})}reportContextSensitivity(i,r,s,a,c,u){this.getDelegates().forEach(h=>{h.reportContextSensitivity&&h.reportContextSensitivity(i,r,s,a,c,u)})}};return l([t.Override],n.prototype,"reportAmbiguity",null),l([t.Override],n.prototype,"reportAttemptingFullContext",null),l([t.Override],n.prototype,"reportContextSensitivity",null),bn.ProxyParserErrorListener=n,bn}var Nn={},ga={},ya={},Xt={},jh;function mm(){if(jh)return Xt;jh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.isSupplementaryCodePoint=Xt.isLowSurrogate=Xt.isHighSurrogate=void 0;function l(n){return n>=55296&&n<=56319}Xt.isHighSurrogate=l;function e(n){return n>=56320&&n<=57343}Xt.isLowSurrogate=e;function t(n){return n>=65536}return Xt.isSupplementaryCodePoint=t,Xt}var qh;function rp(){return qh||(qh=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.CodePointBuffer=void 0;const e=Ve(),t=mm();class n{constructor(i,r){this.buffer=i,this._position=0,this._size=r}static withArray(i){return new n(i,i.length)}get position(){return this._position}set position(i){if(i<0||i>this._size)throw new RangeError;this._position=i}get remaining(){return this._size-this.position}get(i){return this.buffer[i]}array(){return this.buffer.slice(0,this._size)}static builder(i){return new n.Builder(i)}}l.CodePointBuffer=n,function(o){let i;(function(s){s[s.BYTE=0]="BYTE",s[s.CHAR=1]="CHAR",s[s.INT=2]="INT"})(i||(i={}));class r{constructor(a){this.type=0,this.buffer=new Uint8Array(a),this.prevHighSurrogate=-1,this.position=0}build(){return new o(this.buffer,this.position)}static roundUpToNextPowerOfTwo(a){let c=32-Math.clz32(a-1);return Math.pow(2,c)}ensureRemaining(a){switch(this.type){case 0:if(this.buffer.length-this.position<a){let c=r.roundUpToNextPowerOfTwo(this.buffer.length+a),u=new Uint8Array(c);u.set(this.buffer.subarray(0,this.position),0),this.buffer=u}break;case 1:if(this.buffer.length-this.position<a){let c=r.roundUpToNextPowerOfTwo(this.buffer.length+a),u=new Uint16Array(c);u.set(this.buffer.subarray(0,this.position),0),this.buffer=u}break;case 2:if(this.buffer.length-this.position<a){let c=r.roundUpToNextPowerOfTwo(this.buffer.length+a),u=new Int32Array(c);u.set(this.buffer.subarray(0,this.position),0),this.buffer=u}break}}append(a){this.ensureRemaining(a.length),this.appendArray(a)}appendArray(a){switch(this.type){case 0:this.appendArrayByte(a);break;case 1:this.appendArrayChar(a);break;case 2:this.appendArrayInt(a);break}}appendArrayByte(a){e(this.prevHighSurrogate===-1);let c=a,u=0,h=a.length,f=this.buffer,d=this.position;for(;u<h;){let p=c[u];if(p<=255)f[d]=p;else if(a=a.subarray(u,h),this.position=d,t.isHighSurrogate(p)){this.byteToIntBuffer(a.length),this.appendArrayInt(a);return}else{this.byteToCharBuffer(a.length),this.appendArrayChar(a);return}u++,d++}this.position=d}appendArrayChar(a){e(this.prevHighSurrogate===-1);let c=a,u=0,h=a.length,f=this.buffer,d=this.position;for(;u<h;){let p=c[u];if(!t.isHighSurrogate(p))f[d]=p;else{a=a.subarray(u,h),this.position=d,this.charToIntBuffer(a.length),this.appendArrayInt(a);return}u++,d++}this.position=d}appendArrayInt(a){let c=a,u=0,h=a.length,f=this.buffer,d=this.position;for(;u<h;){let p=c[u];u++,this.prevHighSurrogate!==-1?t.isLowSurrogate(p)?(f[d]=String.fromCharCode(this.prevHighSurrogate,p).codePointAt(0),d++,this.prevHighSurrogate=-1):(f[d]=this.prevHighSurrogate,d++,t.isHighSurrogate(p)?this.prevHighSurrogate=p:(f[d]=p,d++,this.prevHighSurrogate=-1)):t.isHighSurrogate(p)?this.prevHighSurrogate=p:(f[d]=p,d++)}this.prevHighSurrogate!==-1&&(f[d]=this.prevHighSurrogate,d++),this.position=d}byteToCharBuffer(a){let c=new Uint16Array(Math.max(this.position+a,this.buffer.length>>1));c.set(this.buffer.subarray(0,this.position),0),this.type=1,this.buffer=c}byteToIntBuffer(a){let c=new Int32Array(Math.max(this.position+a,this.buffer.length>>2));c.set(this.buffer.subarray(0,this.position),0),this.type=2,this.buffer=c}charToIntBuffer(a){let c=new Int32Array(Math.max(this.position+a,this.buffer.length>>1));c.set(this.buffer.subarray(0,this.position),0),this.type=2,this.buffer=c}}o.Builder=r}(n=l.CodePointBuffer||(l.CodePointBuffer={}))}(ya)),ya}var Rn={},Uh;function ip(){if(Uh)return Rn;Uh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Rn&&Rn.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.CodePointCharStream=void 0;const e=Ve(),t=Rr(),n=Xe(),o=Z();let i=class np{constructor(s,a,c,u){e(a===0),this._array=s,this._size=c,this._name=u,this._position=0}get internalStorage(){return this._array}static fromBuffer(s,a){return(a===void 0||a.length===0)&&(a=t.IntStream.UNKNOWN_SOURCE_NAME),new np(s.array(),s.position,s.remaining,a)}consume(){if(this._size-this._position===0)throw e(this.LA(1)===t.IntStream.EOF),new RangeError("cannot consume EOF");this._position++}get index(){return this._position}get size(){return this._size}mark(){return-1}release(s){}seek(s){this._position=s}get sourceName(){return this._name}toString(){return this.getText(n.Interval.of(0,this.size-1))}LA(s){let a;switch(Math.sign(s)){case-1:return a=this.index+s,a<0?t.IntStream.EOF:this._array[a];case 0:return 0;case 1:return a=this.index+s-1,a>=this.size?t.IntStream.EOF:this._array[a]}throw new RangeError("Not reached")}getText(s){const a=Math.min(s.a,this.size),c=Math.min(s.b-s.a+1,this.size-a);return this._array instanceof Int32Array?String.fromCodePoint(...Array.from(this._array.subarray(a,a+c))):String.fromCharCode(...Array.from(this._array.subarray(a,a+c)))}};return l([o.Override],i.prototype,"consume",null),l([o.Override],i.prototype,"index",null),l([o.Override],i.prototype,"size",null),l([o.Override],i.prototype,"mark",null),l([o.Override],i.prototype,"release",null),l([o.Override],i.prototype,"seek",null),l([o.Override],i.prototype,"sourceName",null),l([o.Override],i.prototype,"toString",null),l([o.Override],i.prototype,"LA",null),l([o.Override],i.prototype,"getText",null),Rn.CodePointCharStream=i,Rn}var Hh;function dl(){return Hh||(Hh=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.CharStreams=void 0;const e=rp(),t=ip(),n=Rr();(function(o){function i(r,s){(s===void 0||s.length===0)&&(s=n.IntStream.UNKNOWN_SOURCE_NAME);let a=e.CodePointBuffer.builder(r.length),c=new Uint16Array(r.length);for(let u=0;u<r.length;u++)c[u]=r.charCodeAt(u);return a.append(c),t.CodePointCharStream.fromBuffer(a.build(),s)}o.fromString=i})(l.CharStreams||(l.CharStreams={}))}(ga)),ga}var Kt={},Qt={},$h;function op(){if($h)return Qt;$h=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Qt&&Qt.__decorate||function(c,u,h,f){var d=arguments.length,p=d<3?u:f===null?f=Object.getOwnPropertyDescriptor(u,h):f,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,u,h,f);else for(var m=c.length-1;m>=0;m--)(y=c[m])&&(p=(d<3?y(p):d>3?y(u,h,p):y(u,h))||p);return d>3&&p&&Object.defineProperty(u,h,p),p},e=Qt&&Qt.__param||function(c,u){return function(h,f){u(h,f,c)}};Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.BufferedTokenStream=void 0;const t=Ve(),n=Ji(),o=Xe(),i=Ir(),r=Z(),s=Be();let a=class{constructor(u){if(this.tokens=[],this.p=-1,this.fetchedEOF=!1,u==null)throw new Error("tokenSource cannot be null");this._tokenSource=u}get tokenSource(){return this._tokenSource}set tokenSource(u){this._tokenSource=u,this.tokens.length=0,this.p=-1,this.fetchedEOF=!1}get index(){return this.p}mark(){return 0}release(u){}seek(u){this.lazyInit(),this.p=this.adjustSeekIndex(u)}get size(){return this.tokens.length}consume(){let u;if(this.p>=0?this.fetchedEOF?u=this.p<this.tokens.length-1:u=this.p<this.tokens.length:u=!1,!u&&this.LA(1)===s.Token.EOF)throw new Error("cannot consume EOF");this.sync(this.p+1)&&(this.p=this.adjustSeekIndex(this.p+1))}sync(u){t(u>=0);let h=u-this.tokens.length+1;return h>0?this.fetch(h)>=h:!0}fetch(u){if(this.fetchedEOF)return 0;for(let h=0;h<u;h++){let f=this.tokenSource.nextToken();if(this.isWritableToken(f)&&(f.tokenIndex=this.tokens.length),this.tokens.push(f),f.type===s.Token.EOF)return this.fetchedEOF=!0,h+1}return u}get(u){if(u<0||u>=this.tokens.length)throw new RangeError("token index "+u+" out of range 0.."+(this.tokens.length-1));return this.tokens[u]}getRange(u,h){if(u<0||h<0)return[];this.lazyInit();let f=new Array;h>=this.tokens.length&&(h=this.tokens.length-1);for(let d=u;d<=h;d++){let p=this.tokens[d];if(p.type===s.Token.EOF)break;f.push(p)}return f}LA(u){let h=this.LT(u);return h?h.type:s.Token.INVALID_TYPE}tryLB(u){if(!(this.p-u<0))return this.tokens[this.p-u]}LT(u){let h=this.tryLT(u);if(h===void 0)throw new RangeError("requested lookback index out of range");return h}tryLT(u){if(this.lazyInit(),u===0)throw new RangeError("0 is not a valid lookahead index");if(u<0)return this.tryLB(-u);let h=this.p+u-1;return this.sync(h),h>=this.tokens.length?this.tokens[this.tokens.length-1]:this.tokens[h]}adjustSeekIndex(u){return u}lazyInit(){this.p===-1&&this.setup()}setup(){this.sync(0),this.p=this.adjustSeekIndex(0)}getTokens(u,h,f){if(this.lazyInit(),u===void 0)return t(h===void 0&&f===void 0),this.tokens;if(h===void 0&&(h=this.tokens.length-1),u<0||h>=this.tokens.length||h<0||u>=this.tokens.length)throw new RangeError("start "+u+" or stop "+h+" not in 0.."+(this.tokens.length-1));if(u>h)return[];if(f===void 0)return this.tokens.slice(u,h+1);typeof f=="number"&&(f=new Set().add(f));let d=f,p=this.tokens.slice(u,h+1);return p=p.filter(y=>d.has(y.type)),p}nextTokenOnChannel(u,h){if(this.sync(u),u>=this.size)return this.size-1;let f=this.tokens[u];for(;f.channel!==h;){if(f.type===s.Token.EOF)return u;u++,this.sync(u),f=this.tokens[u]}return u}previousTokenOnChannel(u,h){if(this.sync(u),u>=this.size)return this.size-1;for(;u>=0;){let f=this.tokens[u];if(f.type===s.Token.EOF||f.channel===h)return u;u--}return u}getHiddenTokensToRight(u,h=-1){if(this.lazyInit(),u<0||u>=this.tokens.length)throw new RangeError(u+" not in 0.."+(this.tokens.length-1));let f=this.nextTokenOnChannel(u+1,i.Lexer.DEFAULT_TOKEN_CHANNEL),d,p=u+1;return f===-1?d=this.size-1:d=f,this.filterForChannel(p,d,h)}getHiddenTokensToLeft(u,h=-1){if(this.lazyInit(),u<0||u>=this.tokens.length)throw new RangeError(u+" not in 0.."+(this.tokens.length-1));if(u===0)return[];let f=this.previousTokenOnChannel(u-1,i.Lexer.DEFAULT_TOKEN_CHANNEL);if(f===u-1)return[];let d=f+1,p=u-1;return this.filterForChannel(d,p,h)}filterForChannel(u,h,f){let d=new Array;for(let p=u;p<=h;p++){let y=this.tokens[p];f===-1?y.channel!==i.Lexer.DEFAULT_TOKEN_CHANNEL&&d.push(y):y.channel===f&&d.push(y)}return d}get sourceName(){return this.tokenSource.sourceName}getText(u){u===void 0?u=o.Interval.of(0,this.size-1):u instanceof o.Interval||(u=u.sourceInterval);let h=u.a,f=u.b;if(h<0||f<0)return"";this.fill(),f>=this.tokens.length&&(f=this.tokens.length-1);let d="";for(let p=h;p<=f;p++){let y=this.tokens[p];if(y.type===s.Token.EOF)break;d+=y.text}return d.toString()}getTextFromRange(u,h){return this.isToken(u)&&this.isToken(h)?this.getText(o.Interval.of(u.tokenIndex,h.tokenIndex)):""}fill(){this.lazyInit();const u=1e3;for(;;)if(this.fetch(u)<u)return}isWritableToken(u){return u instanceof n.CommonToken}isToken(u){return u instanceof n.CommonToken}};return l([r.NotNull],a.prototype,"_tokenSource",void 0),l([r.Override],a.prototype,"tokenSource",null),l([r.Override],a.prototype,"index",null),l([r.Override],a.prototype,"mark",null),l([r.Override],a.prototype,"release",null),l([r.Override],a.prototype,"seek",null),l([r.Override],a.prototype,"size",null),l([r.Override],a.prototype,"consume",null),l([r.Override],a.prototype,"get",null),l([r.Override],a.prototype,"LA",null),l([r.NotNull,r.Override],a.prototype,"LT",null),l([r.Override],a.prototype,"sourceName",null),l([r.NotNull,r.Override],a.prototype,"getText",null),l([r.NotNull,r.Override],a.prototype,"getTextFromRange",null),a=l([e(0,r.NotNull)],a),Qt.BufferedTokenStream=a,Qt}var Vh;function pl(){if(Vh)return Kt;Vh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Kt&&Kt.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Kt&&Kt.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.CommonTokenStream=void 0;const t=op(),n=Z(),o=Be();let i=class extends t.BufferedTokenStream{constructor(s,a=o.Token.DEFAULT_CHANNEL){super(s),this.channel=a}adjustSeekIndex(s){return this.nextTokenOnChannel(s,this.channel)}tryLB(s){if(this.p-s<0)return;let a=this.p,c=1;for(;c<=s&&a>0;)a=this.previousTokenOnChannel(a-1,this.channel),c++;if(!(a<0))return this.tokens[a]}tryLT(s){if(this.lazyInit(),s===0)throw new RangeError("0 is not a valid lookahead index");if(s<0)return this.tryLB(-s);let a=this.p,c=1;for(;c<s;)this.sync(a+1)&&(a=this.nextTokenOnChannel(a+1,this.channel)),c++;return this.tokens[a]}getNumberOfOnChannelTokens(){let s=0;this.fill();for(let a of this.tokens)if(a.channel===this.channel&&s++,a.type===o.Token.EOF)break;return s}};return l([n.Override],i.prototype,"adjustSeekIndex",null),l([n.Override],i.prototype,"tryLB",null),l([n.Override],i.prototype,"tryLT",null),i=l([e(0,n.NotNull)],i),Kt.CommonTokenStream=i,Kt}var Jt={},Wh;function sp(){if(Wh)return Jt;Wh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Jt&&Jt.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Jt&&Jt.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.ListTokenSource=void 0;const t=nl(),n=Z(),o=Be();let i=class{constructor(s,a){if(this.i=0,this._factory=t.CommonTokenFactory.DEFAULT,s==null)throw new Error("tokens cannot be null");this.tokens=s,this._sourceName=a}get charPositionInLine(){if(this.i<this.tokens.length)return this.tokens[this.i].charPositionInLine;if(this.eofToken!=null)return this.eofToken.charPositionInLine;if(this.tokens.length>0){let s=this.tokens[this.tokens.length-1],a=s.text;if(a!=null){let c=a.lastIndexOf(`
`);if(c>=0)return a.length-c-1}return s.charPositionInLine+s.stopIndex-s.startIndex+1}return 0}nextToken(){if(this.i>=this.tokens.length){if(this.eofToken==null){let a=-1;if(this.tokens.length>0){let u=this.tokens[this.tokens.length-1].stopIndex;u!==-1&&(a=u+1)}let c=Math.max(-1,a-1);this.eofToken=this._factory.create({source:this,stream:this.inputStream},o.Token.EOF,"EOF",o.Token.DEFAULT_CHANNEL,a,c,this.line,this.charPositionInLine)}return this.eofToken}let s=this.tokens[this.i];return this.i===this.tokens.length-1&&s.type===o.Token.EOF&&(this.eofToken=s),this.i++,s}get line(){if(this.i<this.tokens.length)return this.tokens[this.i].line;if(this.eofToken!=null)return this.eofToken.line;if(this.tokens.length>0){let s=this.tokens[this.tokens.length-1],a=s.line,c=s.text;if(c!=null)for(let u=0;u<c.length;u++)c.charAt(u)===`
`&&a++;return a}return 1}get inputStream(){if(this.i<this.tokens.length)return this.tokens[this.i].inputStream;if(this.eofToken!=null)return this.eofToken.inputStream;if(this.tokens.length>0)return this.tokens[this.tokens.length-1].inputStream}get sourceName(){if(this._sourceName)return this._sourceName;let s=this.inputStream;return s!=null?s.sourceName:"List"}set tokenFactory(s){this._factory=s}get tokenFactory(){return this._factory}};return l([n.Override],i.prototype,"charPositionInLine",null),l([n.Override],i.prototype,"nextToken",null),l([n.Override],i.prototype,"line",null),l([n.Override],i.prototype,"inputStream",null),l([n.Override],i.prototype,"sourceName",null),l([n.Override,n.NotNull,e(0,n.NotNull)],i.prototype,"tokenFactory",null),i=l([e(0,n.NotNull)],i),Jt.ListTokenSource=i,Jt}var Oi={},Gh;function xm(){if(Gh)return Oi;Gh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.MultiMap=void 0;let l=class extends Map{constructor(){super()}map(t,n){let o=super.get(t);o||(o=[],super.set(t,o)),o.push(n)}getPairs(){let t=[];return this.forEach((n,o)=>{n.forEach(i=>{t.push([o,i])})}),t}};return Oi.MultiMap=l,Oi}var Fi={},Yh;function ap(){if(Yh)return Fi;Yh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.ParseCancellationException=void 0;let l=class extends Error{constructor(t){super(t.message),this.cause=t,this.stack=t.stack}getCause(){return this.cause}};return Fi.ParseCancellationException=l,Fi}var Zt={},wn={},Xh;function lp(){if(Xh)return wn;Xh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=wn&&wn.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c};Object.defineProperty(wn,"__esModule",{value:!0}),wn.InterpreterRuleContext=void 0;const e=Z(),t=ut();let n=class extends t.ParserRuleContext{constructor(i,r,s){s!==void 0?super(r,s):super(),this._ruleIndex=i}get ruleIndex(){return this._ruleIndex}};return l([e.Override],n.prototype,"ruleIndex",null),wn.InterpreterRuleContext=n,wn}var Kh;function up(){if(Kh)return Zt;Kh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Zt&&Zt.__decorate||function(v,x,g,S){var C=arguments.length,A=C<3?x:S===null?S=Object.getOwnPropertyDescriptor(x,g):S,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(v,x,g,S);else for(var N=v.length-1;N>=0;N--)(b=v[N])&&(A=(C<3?b(A):C>3?b(x,g,A):b(x,g))||A);return C>3&&A&&Object.defineProperty(x,g,A),A},e=Zt&&Zt.__param||function(v,x){return function(g,S){x(g,S,v)}};Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.ParserInterpreter=void 0;const t=yr(),n=He(),o=Pr(),i=Po(),r=Io(),s=lp(),a=Kd(),c=Z(),u=Z(),h=io(),f=ro(),d=wr(),p=sl(),y=Be();let m=class za extends h.Parser{constructor(x,g,S,C,A){if(super(x instanceof za?x.inputStream:A),this._parentContextStack=[],this.overrideDecision=-1,this.overrideDecisionInputIndex=-1,this.overrideDecisionAlt=-1,this.overrideDecisionReached=!1,this._overrideDecisionRoot=void 0,x instanceof za){let b=x;this._grammarFileName=b._grammarFileName,this._atn=b._atn,this.pushRecursionContextStates=b.pushRecursionContextStates,this._ruleNames=b._ruleNames,this._vocabulary=b._vocabulary,this.interpreter=new f.ParserATNSimulator(this._atn,this)}else{g=g,S=S,C=C,this._grammarFileName=x,this._atn=C,this._ruleNames=S.slice(0),this._vocabulary=g,this.pushRecursionContextStates=new o.BitSet(C.states.length);for(let b of C.states)b instanceof p.StarLoopEntryState&&b.precedenceRuleDecision&&this.pushRecursionContextStates.set(b.stateNumber);this.interpreter=new f.ParserATNSimulator(C,this)}}reset(x){x===void 0?super.reset():super.reset(x),this.overrideDecisionReached=!1,this._overrideDecisionRoot=void 0}get atn(){return this._atn}get vocabulary(){return this._vocabulary}get ruleNames(){return this._ruleNames}get grammarFileName(){return this._grammarFileName}parse(x){let g=this._atn.ruleToStartState[x];for(this._rootContext=this.createInterpreterRuleContext(void 0,t.ATNState.INVALID_STATE_NUMBER,x),g.isPrecedenceRule?this.enterRecursionRule(this._rootContext,g.stateNumber,x,0):this.enterRule(this._rootContext,g.stateNumber,x);;){let S=this.atnState;switch(S.stateType){case n.ATNStateType.RULE_STOP:if(this._ctx.isEmpty)if(g.isPrecedenceRule){let C=this._ctx,A=this._parentContextStack.pop();return this.unrollRecursionContexts(A[0]),C}else return this.exitRule(),this._rootContext;this.visitRuleStopState(S);break;default:try{this.visitState(S)}catch(C){if(C instanceof d.RecognitionException)this.state=this._atn.ruleToStopState[S.ruleIndex].stateNumber,this.context.exception=C,this.errorHandler.reportError(this,C),this.recover(C);else throw C}break}}}enterRecursionRule(x,g,S,C){this._parentContextStack.push([this._ctx,x.invokingState]),super.enterRecursionRule(x,g,S,C)}get atnState(){return this._atn.states[this.state]}visitState(x){let g=1;x.numberOfTransitions>1&&(g=this.visitDecisionState(x));let S=x.transition(g-1);switch(S.serializationType){case 1:if(this.pushRecursionContextStates.get(x.stateNumber)&&!(S.target instanceof a.LoopEndState)){let P=this._parentContextStack[this._parentContextStack.length-1],k=this.createInterpreterRuleContext(P[0],P[1],this._ctx.ruleIndex);this.pushNewRecursionContext(k,this._atn.ruleToStartState[x.ruleIndex].stateNumber,this._ctx.ruleIndex)}break;case 5:this.match(S._label);break;case 2:case 7:case 8:S.matches(this._input.LA(1),y.Token.MIN_USER_TOKEN_TYPE,65535)||this.recoverInline(),this.matchWildcard();break;case 9:this.matchWildcard();break;case 3:let C=S.target,A=C.ruleIndex,b=this.createInterpreterRuleContext(this._ctx,x.stateNumber,A);C.isPrecedenceRule?this.enterRecursionRule(b,C.stateNumber,A,S.precedence):this.enterRule(b,S.target.stateNumber,A);break;case 4:let N=S;if(!this.sempred(this._ctx,N.ruleIndex,N.predIndex))throw new i.FailedPredicateException(this);break;case 6:let R=S;this.action(this._ctx,R.ruleIndex,R.actionIndex);break;case 10:if(!this.precpred(this._ctx,S.precedence)){let P=S.precedence;throw new i.FailedPredicateException(this,`precpred(_ctx, ${P})`)}break;default:throw new Error("UnsupportedOperationException: Unrecognized ATN transition type.")}this.state=S.target.stateNumber}visitDecisionState(x){let g;this.errorHandler.sync(this);let S=x.decision;return S===this.overrideDecision&&this._input.index===this.overrideDecisionInputIndex&&!this.overrideDecisionReached?(g=this.overrideDecisionAlt,this.overrideDecisionReached=!0):g=this.interpreter.adaptivePredict(this._input,S,this._ctx),g}createInterpreterRuleContext(x,g,S){return new s.InterpreterRuleContext(S,x,g)}visitRuleStopState(x){if(this._atn.ruleToStartState[x.ruleIndex].isPrecedenceRule){let C=this._parentContextStack.pop();this.unrollRecursionContexts(C[0]),this.state=C[1]}else this.exitRule();let S=this._atn.states[this.state].transition(0);this.state=S.followState.stateNumber}addDecisionOverride(x,g,S){this.overrideDecision=x,this.overrideDecisionInputIndex=g,this.overrideDecisionAlt=S}get overrideDecisionRoot(){return this._overrideDecisionRoot}recover(x){let g=this._input.index;if(this.errorHandler.recover(this,x),this._input.index===g){let S=x.getOffendingToken();if(!S)throw new Error("Expected exception to have an offending token");let C=S.tokenSource,A=C!==void 0?C.inputStream:void 0,b={source:C,stream:A};if(x instanceof r.InputMismatchException){let N=x.expectedTokens;if(N===void 0)throw new Error("Expected the exception to provide expected tokens");let R=y.Token.INVALID_TYPE;N.isNil||(R=N.minElement);let P=this.tokenFactory.create(b,R,S.text,y.Token.DEFAULT_CHANNEL,-1,-1,S.line,S.charPositionInLine);this._ctx.addErrorNode(this.createErrorNode(this._ctx,P))}else{S.tokenSource;let N=this.tokenFactory.create(b,y.Token.INVALID_TYPE,S.text,y.Token.DEFAULT_CHANNEL,-1,-1,S.line,S.charPositionInLine);this._ctx.addErrorNode(this.createErrorNode(this._ctx,N))}}}recoverInline(){return this._errHandler.recoverInline(this)}get rootContext(){return this._rootContext}};return l([c.NotNull],m.prototype,"_vocabulary",void 0),l([u.Override],m.prototype,"reset",null),l([u.Override],m.prototype,"atn",null),l([u.Override],m.prototype,"vocabulary",null),l([u.Override],m.prototype,"ruleNames",null),l([u.Override],m.prototype,"grammarFileName",null),l([u.Override],m.prototype,"enterRecursionRule",null),m=l([e(1,c.NotNull)],m),Zt.ParserInterpreter=m,Zt}var er={},Qh;function gm(){if(Qh)return er;Qh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=er&&er.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c},e=er&&er.__param||function(o,i){return function(r,s){i(r,s,o)}};Object.defineProperty(er,"__esModule",{value:!0}),er.ParseTreeMatch=void 0;const t=Z();let n=class{constructor(i,r,s,a){if(!i)throw new Error("tree cannot be null");if(!r)throw new Error("pattern cannot be null");if(!s)throw new Error("labels cannot be null");this._tree=i,this._pattern=r,this._labels=s,this._mismatchedNode=a}get(i){let r=this._labels.get(i);if(!(!r||r.length===0))return r[r.length-1]}getAll(i){const r=this._labels.get(i);return r||[]}get labels(){return this._labels}get mismatchedNode(){return this._mismatchedNode}get succeeded(){return!this._mismatchedNode}get pattern(){return this._pattern}get tree(){return this._tree}toString(){return`Match ${this.succeeded?"succeeded":"failed"}; found ${this.labels.size} labels`}};return l([t.NotNull,e(0,t.NotNull)],n.prototype,"getAll",null),l([t.NotNull],n.prototype,"labels",null),l([t.NotNull],n.prototype,"pattern",null),l([t.NotNull],n.prototype,"tree",null),l([t.Override],n.prototype,"toString",null),n=l([e(0,t.NotNull),e(1,t.NotNull),e(2,t.NotNull)],n),er.ParseTreeMatch=n,er}var tr={},Pi={},Ii={},Jh;function ym(){if(Jh)return Ii;Jh=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.XPathLexer=void 0;const l=fl(),e=Ir(),t=ko(),n=Gn(),o=vr();let i=class Je extends e.Lexer{constructor(s){super(s),this._interp=new t.LexerATNSimulator(Je._ATN,this)}get vocabulary(){return Je.VOCABULARY}get grammarFileName(){return"XPathLexer.g4"}get ruleNames(){return Je.ruleNames}get serializedATN(){return Je._serializedATN}get channelNames(){return Je.channelNames}get modeNames(){return Je.modeNames}action(s,a,c){switch(a){case 4:this.ID_action(s,c);break}}ID_action(s,a){switch(a){case 0:let c=this.text;c.charAt(0)===c.charAt(0).toUpperCase()?this.type=Je.TOKEN_REF:this.type=Je.RULE_REF;break}}static get _ATN(){return Je.__ATN||(Je.__ATN=new l.ATNDeserializer().deserialize(o.toCharArray(Je._serializedATN))),Je.__ATN}};return Ii.XPathLexer=i,i.TOKEN_REF=1,i.RULE_REF=2,i.ANYWHERE=3,i.ROOT=4,i.WILDCARD=5,i.BANG=6,i.ID=7,i.STRING=8,i.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"],i.modeNames=["DEFAULT_MODE"],i.ruleNames=["ANYWHERE","ROOT","WILDCARD","BANG","ID","NameChar","NameStartChar","STRING"],i._LITERAL_NAMES=[void 0,void 0,void 0,"'//'","'/'","'*'","'!'"],i._SYMBOLIC_NAMES=[void 0,"TOKEN_REF","RULE_REF","ANYWHERE","ROOT","WILDCARD","BANG","ID","STRING"],i.VOCABULARY=new n.VocabularyImpl(i._LITERAL_NAMES,i._SYMBOLIC_NAMES,[]),i._serializedATNSegments=2,i._serializedATNSegment0=`
2\b					\x07	\x07\b	\b			\x07
\f"\v\x07\x07\b\b		\x07	,
	\f		/\v			-
\x07\x07	\b\v	\r

2;C\\aac|\r(*<>?AOR_\uD801\uDA02\uDA38\uDA3D\uDA6E\uDA77\uDA77\uDA86\uDA86\uDA9D\uDAA1\uDAA3\uDAB1"C\\c|\r(*<>?AOR_`,i._serializedATNSegment1=`1\x07	\v\x07	\v\r%')\x071\x071\x071\x07,\b\x1B\x07#\x1B
 \b\r\x07"  !!#" #$\b$\f%&	&'(	()-\x07)*,\v+*,/-.-+.0/-01\x07)1 -`,i._serializedATN=o.join([i._serializedATNSegment0,i._serializedATNSegment1],""),Ii}var On={},Zh;function vm(){if(Zh)return On;Zh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=On&&On.__decorate||function(n,o,i,r){var s=arguments.length,a=s<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,i):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,o,i,r);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(On,"__esModule",{value:!0}),On.XPathLexerErrorListener=void 0;const e=Z();let t=class{syntaxError(o,i,r,s,a,c){}};return l([e.Override],t.prototype,"syntaxError",null),On.XPathLexerErrorListener=t,On}var Fn={},Pn={},ef;function pi(){if(ef)return Pn;ef=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Pn&&Pn.__decorate||function(n,o,i,r){var s=arguments.length,a=s<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,i):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,o,i,r);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.XPathElement=void 0;const e=Z();let t=class{constructor(o){this.nodeName=o,this.invert=!1}toString(){let o=this.invert?"!":"";return Object.constructor.name+"["+o+this.nodeName+"]"}};return l([e.Override],t.prototype,"toString",null),Pn.XPathElement=t,Pn}var tf;function Sm(){if(tf)return Fn;tf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Fn&&Fn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.XPathRuleAnywhereElement=void 0;const e=Z(),t=Xn(),n=pi();let o=class extends n.XPathElement{constructor(r,s){super(r),this.ruleIndex=s}evaluate(r){return t.Trees.findAllRuleNodes(r,this.ruleIndex)}};return l([e.Override],o.prototype,"evaluate",null),Fn.XPathRuleAnywhereElement=o,Fn}var In={},rf;function Am(){if(rf)return In;rf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=In&&In.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(In,"__esModule",{value:!0}),In.XPathRuleElement=void 0;const e=ut(),t=Z(),n=Xn(),o=pi();let i=class extends o.XPathElement{constructor(s,a){super(s),this.ruleIndex=a}evaluate(s){let a=[];for(let c of n.Trees.getChildren(s))c instanceof e.ParserRuleContext&&(c.ruleIndex===this.ruleIndex&&!this.invert||c.ruleIndex!==this.ruleIndex&&this.invert)&&a.push(c);return a}};return l([t.Override],i.prototype,"evaluate",null),In.XPathRuleElement=i,In}var Dn={},nf;function Cm(){if(nf)return Dn;nf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Dn&&Dn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.XPathTokenAnywhereElement=void 0;const e=Z(),t=Xn(),n=pi();let o=class extends n.XPathElement{constructor(r,s){super(r),this.tokenType=s}evaluate(r){return t.Trees.findAllTokenNodes(r,this.tokenType)}};return l([e.Override],o.prototype,"evaluate",null),Dn.XPathTokenAnywhereElement=o,Dn}var Ln={},of;function Em(){if(of)return Ln;of=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ln&&Ln.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.XPathTokenElement=void 0;const e=Z(),t=di(),n=Xn(),o=pi();let i=class extends o.XPathElement{constructor(s,a){super(s),this.tokenType=a}evaluate(s){let a=[];for(let c of n.Trees.getChildren(s))c instanceof t.TerminalNode&&(c.symbol.type===this.tokenType&&!this.invert||c.symbol.type!==this.tokenType&&this.invert)&&a.push(c);return a}};return l([e.Override],i.prototype,"evaluate",null),Ln.XPathTokenElement=i,Ln}var Mn={},sf;function _m(){if(sf)return Mn;sf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Mn&&Mn.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.XPathWildcardAnywhereElement=void 0;const e=Z(),t=Xn(),n=ml(),o=pi();let i=class extends o.XPathElement{constructor(){super(n.XPath.WILDCARD)}evaluate(s){return this.invert?[]:t.Trees.getDescendants(s)}};return l([e.Override],i.prototype,"evaluate",null),Mn.XPathWildcardAnywhereElement=i,Mn}var Bn={},af;function Tm(){if(af)return Bn;af=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Bn&&Bn.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.XPathWildcardElement=void 0;const e=Z(),t=Xn(),n=ml(),o=pi();let i=class extends o.XPathElement{constructor(){super(n.XPath.WILDCARD)}evaluate(s){let a=[];if(this.invert)return a;for(let c of t.Trees.getChildren(s))a.push(c);return a}};return l([e.Override],i.prototype,"evaluate",null),Bn.XPathWildcardElement=i,Bn}var lf;function ml(){if(lf)return Pi;lf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.XPath=void 0;const l=dl(),e=pl(),t=Bo(),n=ut(),o=Be(),i=ym(),r=vm(),s=Sm(),a=Am(),c=Cm(),u=Em(),h=_m(),f=Tm();let d=class cp{constructor(y,m){this.parser=y,this.path=m,this.elements=this.split(m)}split(y){let m=new i.XPathLexer(l.CharStreams.fromString(y));m.recover=A=>{throw A},m.removeErrorListeners(),m.addErrorListener(new r.XPathLexerErrorListener);let v=new e.CommonTokenStream(m);try{v.fill()}catch(A){if(A instanceof t.LexerNoViableAltException){let N="Invalid tokens or characters at index "+m.charPositionInLine+" in path '"+y+"' -- "+A.message;throw new RangeError(N)}throw A}let x=v.getTokens(),g=[],S=x.length,C=0;e:for(;C<S;){let A=x[C],b;switch(A.type){case i.XPathLexer.ROOT:case i.XPathLexer.ANYWHERE:let N=A.type===i.XPathLexer.ANYWHERE;C++,b=x[C];let R=b.type===i.XPathLexer.BANG;R&&(C++,b=x[C]);let P=this.getXPathElement(b,N);P.invert=R,g.push(P),C++;break;case i.XPathLexer.TOKEN_REF:case i.XPathLexer.RULE_REF:case i.XPathLexer.WILDCARD:g.push(this.getXPathElement(A,!1)),C++;break;case o.Token.EOF:break e;default:throw new Error("Unknowth path element "+A)}}return g}getXPathElement(y,m){if(y.type===o.Token.EOF)throw new Error("Missing path element at end of path");let v=y.text;if(v==null)throw new Error("Expected wordToken to have text content.");let x=this.parser.getTokenType(v),g=this.parser.getRuleIndex(v);switch(y.type){case i.XPathLexer.WILDCARD:return m?new h.XPathWildcardAnywhereElement:new f.XPathWildcardElement;case i.XPathLexer.TOKEN_REF:case i.XPathLexer.STRING:if(x===o.Token.INVALID_TYPE)throw new Error(v+" at index "+y.startIndex+" isn't a valid token name");return m?new c.XPathTokenAnywhereElement(v,x):new u.XPathTokenElement(v,x);default:if(g===-1)throw new Error(v+" at index "+y.startIndex+" isn't a valid rule name");return m?new s.XPathRuleAnywhereElement(v,g):new a.XPathRuleElement(v,g)}}static findAll(y,m,v){return new cp(v,m).evaluate(y)}evaluate(y){let m=new n.ParserRuleContext;m.addChild(y);let v=new Set([m]),x=0;for(;x<this.elements.length;){let g=new Set;for(let S of v)S.childCount>0&&this.elements[x].evaluate(S).forEach(g.add,g);x++,v=g}return v}};return Pi.XPath=d,d.WILDCARD="*",d.NOT="!",Pi}var uf;function bm(){if(uf)return tr;uf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=tr&&tr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=tr&&tr.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(tr,"__esModule",{value:!0}),tr.ParseTreePattern=void 0;const t=Z(),n=ml();let o=class{constructor(r,s,a,c){this._matcher=r,this._patternRuleIndex=a,this._pattern=s,this._patternTree=c}match(r){return this._matcher.match(r,this)}matches(r){return this._matcher.match(r,this).succeeded}findAll(r,s){let a=n.XPath.findAll(r,s,this._matcher.parser),c=[];for(let u of a){let h=this.match(u);h.succeeded&&c.push(h)}return c}get matcher(){return this._matcher}get pattern(){return this._pattern}get patternRuleIndex(){return this._patternRuleIndex}get patternTree(){return this._patternTree}};return l([t.NotNull],o.prototype,"_pattern",void 0),l([t.NotNull],o.prototype,"_patternTree",void 0),l([t.NotNull],o.prototype,"_matcher",void 0),l([t.NotNull,e(0,t.NotNull)],o.prototype,"match",null),l([e(0,t.NotNull)],o.prototype,"matches",null),l([t.NotNull,e(0,t.NotNull),e(1,t.NotNull)],o.prototype,"findAll",null),l([t.NotNull],o.prototype,"matcher",null),l([t.NotNull],o.prototype,"pattern",null),l([t.NotNull],o.prototype,"patternTree",null),o=l([e(0,t.NotNull),e(1,t.NotNull),e(3,t.NotNull)],o),tr.ParseTreePattern=o,tr}var rr={},cf;function Nm(){if(cf)return rr;cf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=rr&&rr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=rr&&rr.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(rr,"__esModule",{value:!0}),rr.RuleTagToken=void 0;const t=Z(),n=Be();let o=class{constructor(r,s,a){if(r==null||r.length===0)throw new Error("ruleName cannot be null or empty.");this._ruleName=r,this.bypassTokenType=s,this._label=a}get ruleName(){return this._ruleName}get label(){return this._label}get channel(){return n.Token.DEFAULT_CHANNEL}get text(){return this._label!=null?"<"+this._label+":"+this._ruleName+">":"<"+this._ruleName+">"}get type(){return this.bypassTokenType}get line(){return 0}get charPositionInLine(){return-1}get tokenIndex(){return-1}get startIndex(){return-1}get stopIndex(){return-1}get tokenSource(){}get inputStream(){}toString(){return this._ruleName+":"+this.bypassTokenType}};return l([t.NotNull],o.prototype,"ruleName",null),l([t.Override],o.prototype,"channel",null),l([t.Override],o.prototype,"text",null),l([t.Override],o.prototype,"type",null),l([t.Override],o.prototype,"line",null),l([t.Override],o.prototype,"charPositionInLine",null),l([t.Override],o.prototype,"tokenIndex",null),l([t.Override],o.prototype,"startIndex",null),l([t.Override],o.prototype,"stopIndex",null),l([t.Override],o.prototype,"tokenSource",null),l([t.Override],o.prototype,"inputStream",null),l([t.Override],o.prototype,"toString",null),o=l([e(0,t.NotNull)],o),rr.RuleTagToken=o,rr}var kn={},Di={},hf;function hp(){if(hf)return Di;hf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Di,"__esModule",{value:!0}),Di.Chunk=void 0;let l=class{};return Di.Chunk=l,Di}var ff;function Rm(){if(ff)return kn;ff=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=kn&&kn.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c};Object.defineProperty(kn,"__esModule",{value:!0}),kn.TagChunk=void 0;const e=hp(),t=Z();let n=class extends e.Chunk{constructor(i,r){if(super(),i==null||i.length===0)throw new Error("tag cannot be null or empty");this._tag=i,this._label=r}get tag(){return this._tag}get label(){return this._label}toString(){return this._label!=null?this._label+":"+this._tag:this._tag}};return l([t.NotNull],n.prototype,"tag",null),l([t.Override],n.prototype,"toString",null),kn.TagChunk=n,kn}var nr={},df;function wm(){if(df)return nr;df=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=nr&&nr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=nr&&nr.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(nr,"__esModule",{value:!0}),nr.TextChunk=void 0;const t=hp(),n=Z();let o=class extends t.Chunk{constructor(r){if(super(),r==null)throw new Error("text cannot be null");this._text=r}get text(){return this._text}toString(){return"'"+this._text+"'"}};return l([n.NotNull],o.prototype,"_text",void 0),l([n.NotNull],o.prototype,"text",null),l([n.Override],o.prototype,"toString",null),o=l([e(0,n.NotNull)],o),nr.TextChunk=o,nr}var ir={},pf;function Om(){if(pf)return ir;pf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ir&&ir.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=ir&&ir.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(ir,"__esModule",{value:!0}),ir.TokenTagToken=void 0;const t=Ji(),n=Z();let o=class extends t.CommonToken{constructor(r,s,a){super(s),this._tokenName=r,this._label=a}get tokenName(){return this._tokenName}get label(){return this._label}get text(){return this._label!=null?"<"+this._label+":"+this._tokenName+">":"<"+this._tokenName+">"}toString(){return this._tokenName+":"+this.type}};return l([n.NotNull],o.prototype,"_tokenName",void 0),l([n.NotNull],o.prototype,"tokenName",null),l([n.Override],o.prototype,"text",null),l([n.Override],o.prototype,"toString",null),o=l([e(0,n.NotNull)],o),ir.TokenTagToken=o,ir}var mf;function Fm(){return mf||(mf=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Nn&&Nn.__decorate||function(b,N,R,P){var k=arguments.length,D=k<3?N:P===null?P=Object.getOwnPropertyDescriptor(N,R):P,H;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(b,N,R,P);else for(var J=b.length-1;J>=0;J--)(H=b[J])&&(D=(k<3?H(D):k>3?H(N,R,D):H(N,R))||D);return k>3&&D&&Object.defineProperty(N,R,D),D},t=Nn&&Nn.__param||function(b,N){return function(R,P){N(R,P,b)}};Object.defineProperty(l,"__esModule",{value:!0}),l.ParseTreePatternMatcher=void 0;const n=fp(),o=dl(),i=pl(),r=sp(),s=xm(),a=Z(),c=ap(),u=up(),h=ut(),f=gm(),d=bm(),p=wr(),y=hl(),m=Nm(),v=Rm(),x=di(),g=wm(),S=Be(),C=Om();let A=class ja{constructor(N,R){this.start="<",this.stop=">",this.escape="\\",this.escapeRE=/\\/g,this._lexer=N,this._parser=R}setDelimiters(N,R,P){if(!N)throw new Error("start cannot be null or empty");if(!R)throw new Error("stop cannot be null or empty");this.start=N,this.stop=R,this.escape=P,this.escapeRE=new RegExp(P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g")}matches(N,R,P=0){if(typeof R=="string"){let k=this.compile(R,P);return this.matches(N,k)}else{let k=new s.MultiMap;return!this.matchImpl(N,R.patternTree,k)}}match(N,R,P=0){if(typeof R=="string"){let k=this.compile(R,P);return this.match(N,k)}else{let k=new s.MultiMap,D=this.matchImpl(N,R.patternTree,k);return new f.ParseTreeMatch(N,R,k,D)}}compile(N,R){let P=this.tokenize(N),k=new r.ListTokenSource(P),D=new i.CommonTokenStream(k);const H=this._parser;let J=new u.ParserInterpreter(H.grammarFileName,H.vocabulary,H.ruleNames,H.getATNWithBypassAlts(),D),te;try{J.errorHandler=new n.BailErrorStrategy,te=J.parse(R)}catch(le){throw le instanceof c.ParseCancellationException?le.getCause():le instanceof p.RecognitionException?le:le instanceof Error?new ja.CannotInvokeStartRule(le):le}if(D.LA(1)!==S.Token.EOF)throw new ja.StartRuleDoesNotConsumeFullPattern;return new d.ParseTreePattern(this,N,R,te)}get lexer(){return this._lexer}get parser(){return this._parser}matchImpl(N,R,P){if(!N)throw new TypeError("tree cannot be null");if(!R)throw new TypeError("patternTree cannot be null");if(N instanceof x.TerminalNode&&R instanceof x.TerminalNode){let k;if(N.symbol.type===R.symbol.type)if(R.symbol instanceof C.TokenTagToken){let D=R.symbol;P.map(D.tokenName,N);const H=D.label;H&&P.map(H,N)}else N.text===R.text||k||(k=N);else k||(k=N);return k}if(N instanceof h.ParserRuleContext&&R instanceof h.ParserRuleContext){let k,D=this.getRuleTagToken(R);if(D){if(N.ruleContext.ruleIndex===R.ruleContext.ruleIndex){P.map(D.ruleName,N);const J=D.label;J&&P.map(J,N)}else k||(k=N);return k}if(N.childCount!==R.childCount)return k||(k=N),k;let H=N.childCount;for(let J=0;J<H;J++){let te=this.matchImpl(N.getChild(J),R.getChild(J),P);if(te)return te}return k}return N}getRuleTagToken(N){if(N instanceof y.RuleNode&&N.childCount===1&&N.getChild(0)instanceof x.TerminalNode){let R=N.getChild(0);if(R.symbol instanceof m.RuleTagToken)return R.symbol}}tokenize(N){let R=this.split(N),P=[];for(let k of R)if(k instanceof v.TagChunk){let D=k;const H=D.tag.substr(0,1);if(H===H.toUpperCase()){let J=this._parser.getTokenType(D.tag);if(J===S.Token.INVALID_TYPE)throw new Error("Unknown token "+D.tag+" in pattern: "+N);let te=new C.TokenTagToken(D.tag,J,D.label);P.push(te)}else if(H===H.toLowerCase()){let J=this._parser.getRuleIndex(D.tag);if(J===-1)throw new Error("Unknown rule "+D.tag+" in pattern: "+N);let te=this._parser.getATNWithBypassAlts().ruleToTokenType[J];P.push(new m.RuleTagToken(D.tag,te,D.label))}else throw new Error("invalid tag: "+D.tag+" in pattern: "+N)}else{let D=k;this._lexer.inputStream=o.CharStreams.fromString(D.text);let H=this._lexer.nextToken();for(;H.type!==S.Token.EOF;)P.push(H),H=this._lexer.nextToken()}return P}split(N){let R=0,P=N.length,k=[],D=[],H=[];for(;R<P;)R===N.indexOf(this.escape+this.start,R)?R+=this.escape.length+this.start.length:R===N.indexOf(this.escape+this.stop,R)?R+=this.escape.length+this.stop.length:R===N.indexOf(this.start,R)?(D.push(R),R+=this.start.length):R===N.indexOf(this.stop,R)?(H.push(R),R+=this.stop.length):R++;if(D.length>H.length)throw new Error("unterminated tag in pattern: "+N);if(D.length<H.length)throw new Error("missing start tag in pattern: "+N);let J=D.length;for(let te=0;te<J;te++)if(D[te]>=H[te])throw new Error("tag delimiters out of order in pattern: "+N);if(J===0){let te=N.substring(0,P);k.push(new g.TextChunk(te))}if(J>0&&D[0]>0){let te=N.substring(0,D[0]);k.push(new g.TextChunk(te))}for(let te=0;te<J;te++){let le=N.substring(D[te]+this.start.length,H[te]),ge=le,ce,ee=le.indexOf(":");if(ee>=0&&(ce=le.substring(0,ee),ge=le.substring(ee+1,le.length)),k.push(new v.TagChunk(ge,ce)),te+1<J){let G=N.substring(H[te]+this.stop.length,D[te+1]);k.push(new g.TextChunk(G))}}if(J>0){let te=H[J-1]+this.stop.length;if(te<P){let le=N.substring(te,P);k.push(new g.TextChunk(le))}}for(let te=0;te<k.length;te++){let le=k[te];if(le instanceof g.TextChunk){let ge=le.text.replace(this.escapeRE,"");ge.length<le.text.length&&(k[te]=new g.TextChunk(ge))}}return k}};e([a.NotNull,t(1,a.NotNull)],A.prototype,"match",null),e([a.NotNull],A.prototype,"lexer",null),e([a.NotNull],A.prototype,"parser",null),e([t(0,a.NotNull),t(1,a.NotNull),t(2,a.NotNull)],A.prototype,"matchImpl",null),l.ParseTreePatternMatcher=A,function(b){class N extends Error{constructor(k){super(`CannotInvokeStartRule: ${k}`),this.error=k}}b.CannotInvokeStartRule=N;class R extends Error{constructor(){super("StartRuleDoesNotConsumeFullPattern")}}b.StartRuleDoesNotConsumeFullPattern=R}(A=l.ParseTreePatternMatcher||(l.ParseTreePatternMatcher={}))}(Nn)),Nn}var or={},sr={},ar={},xf;function no(){if(xf)return ar;xf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ar&&ar.__decorate||function(o,i,r,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,r):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,r,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,r,c):u(i,r))||c);return a>3&&c&&Object.defineProperty(i,r,c),c},e=ar&&ar.__param||function(o,i){return function(r,s){i(r,s,o)}};Object.defineProperty(ar,"__esModule",{value:!0}),ar.DecisionEventInfo=void 0;const t=Z();let n=class{constructor(i,r,s,a,c,u){this.decision=i,this.fullCtx=u,this.stopIndex=c,this.input=s,this.startIndex=a,this.state=r}};return l([t.NotNull],n.prototype,"input",void 0),n=l([e(2,t.NotNull)],n),ar.DecisionEventInfo=n,ar}var gf;function Pm(){if(gf)return sr;gf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=sr&&sr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=sr&&sr.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(sr,"__esModule",{value:!0}),sr.AmbiguityInfo=void 0;const t=no(),n=Z();let o=class extends t.DecisionEventInfo{constructor(r,s,a,c,u,h){super(r,s,c,u,h,s.useContext),this.ambigAlts=a}get ambiguousAlternatives(){return this.ambigAlts}};return l([n.NotNull],o.prototype,"ambigAlts",void 0),l([n.NotNull],o.prototype,"ambiguousAlternatives",null),o=l([e(1,n.NotNull),e(2,n.NotNull),e(3,n.NotNull)],o),sr.AmbiguityInfo=o,sr}var lr={},yf;function Im(){if(yf)return lr;yf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=lr&&lr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=lr&&lr.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(lr,"__esModule",{value:!0}),lr.ContextSensitivityInfo=void 0;const t=no(),n=Z();let o=class extends t.DecisionEventInfo{constructor(r,s,a,c,u){super(r,s,a,c,u,!0)}};return o=l([e(1,n.NotNull),e(2,n.NotNull)],o),lr.ContextSensitivityInfo=o,lr}var zn={},vf;function Dm(){if(vf)return zn;vf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=zn&&zn.__decorate||function(n,o,i,r){var s=arguments.length,a=s<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,i):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,o,i,r);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(zn,"__esModule",{value:!0}),zn.DecisionInfo=void 0;const e=Z();let t=class{constructor(o){this.invocations=0,this.timeInPrediction=0,this.SLL_TotalLook=0,this.SLL_MinLook=0,this.SLL_MaxLook=0,this.LL_TotalLook=0,this.LL_MinLook=0,this.LL_MaxLook=0,this.contextSensitivities=[],this.errors=[],this.ambiguities=[],this.predicateEvals=[],this.SLL_ATNTransitions=0,this.SLL_DFATransitions=0,this.LL_Fallback=0,this.LL_ATNTransitions=0,this.LL_DFATransitions=0,this.decision=o}toString(){return"{decision="+this.decision+", contextSensitivities="+this.contextSensitivities.length+", errors="+this.errors.length+", ambiguities="+this.ambiguities.length+", SLL_lookahead="+this.SLL_TotalLook+", SLL_ATNTransitions="+this.SLL_ATNTransitions+", SLL_DFATransitions="+this.SLL_DFATransitions+", LL_Fallback="+this.LL_Fallback+", LL_lookahead="+this.LL_TotalLook+", LL_ATNTransitions="+this.LL_ATNTransitions+"}"}};return l([e.Override],t.prototype,"toString",null),zn.DecisionInfo=t,zn}var ur={},Sf;function Lm(){if(Sf)return ur;Sf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ur&&ur.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=ur&&ur.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(ur,"__esModule",{value:!0}),ur.ErrorInfo=void 0;const t=no(),n=Z();let o=class extends t.DecisionEventInfo{constructor(r,s,a,c,u){super(r,s,a,c,u,s.useContext)}};return o=l([e(1,n.NotNull),e(2,n.NotNull)],o),ur.ErrorInfo=o,ur}var cr={},Af;function Mm(){if(Af)return cr;Af=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=cr&&cr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=cr&&cr.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(cr,"__esModule",{value:!0}),cr.LookaheadEventInfo=void 0;const t=no(),n=Z();let o=class extends t.DecisionEventInfo{constructor(r,s,a,c,u,h,f){super(r,s,c,u,h,f),this.predictedAlt=a}};return o=l([e(3,n.NotNull)],o),cr.LookaheadEventInfo=o,cr}var hr={},Cf;function Bm(){if(Cf)return hr;Cf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=hr&&hr.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u},e=hr&&hr.__param||function(i,r){return function(s,a){r(s,a,i)}};Object.defineProperty(hr,"__esModule",{value:!0}),hr.PredicateEvalInfo=void 0;const t=no(),n=Z();let o=class extends t.DecisionEventInfo{constructor(r,s,a,c,u,h,f,d){super(s,r,a,c,u,r.useContext),this.semctx=h,this.evalResult=f,this.predictedAlt=d}};return o=l([e(0,n.NotNull),e(2,n.NotNull),e(5,n.NotNull)],o),hr.PredicateEvalInfo=o,hr}var Ef;function _f(){if(Ef)return or;Ef=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=or&&or.__decorate||function(y,m,v,x){var g=arguments.length,S=g<3?m:x===null?x=Object.getOwnPropertyDescriptor(m,v):x,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(y,m,v,x);else for(var A=y.length-1;A>=0;A--)(C=y[A])&&(S=(g<3?C(S):g>3?C(m,v,S):C(m,v))||S);return g>3&&S&&Object.defineProperty(m,v,S),S},e=or&&or.__param||function(y,m){return function(v,x){m(v,x,y)}};Object.defineProperty(or,"__esModule",{value:!0}),or.ProfilingATNSimulator=void 0;const t=Pm(),n=ft(),o=Mo(),i=Im(),r=Dm(),s=Lm(),a=Z(),c=Mm(),u=ro(),h=Bm(),f=hi(),d=ep();let p=class extends u.ParserATNSimulator{constructor(m){super(m.interpreter.atn,m),this._startIndex=0,this._sllStopIndex=0,this._llStopIndex=0,this.currentDecision=0,this.conflictingAltResolvedBySLL=0,this.optimize_ll1=!1,this.reportAmbiguities=!0,this.numDecisions=this.atn.decisionToState.length,this.decisions=[];for(let v=0;v<this.numDecisions;v++)this.decisions.push(new r.DecisionInfo(v))}adaptivePredict(m,v,x,g){if(g!==void 0)return super.adaptivePredict(m,v,x,g);try{this._input=m,this._startIndex=m.index,this._sllStopIndex=this._startIndex-1,this._llStopIndex=-1,this.currentDecision=v,this.currentState=void 0,this.conflictingAltResolvedBySLL=n.ATN.INVALID_ALT_NUMBER;let S=process.hrtime(),C=super.adaptivePredict(m,v,x),A=process.hrtime(),b=(A[0]-S[0])*1e9;b===0?b=A[1]-S[1]:b+=1e9-S[1]+A[1],this.decisions[v].timeInPrediction+=b,this.decisions[v].invocations++;let N=this._sllStopIndex-this._startIndex+1;if(this.decisions[v].SLL_TotalLook+=N,this.decisions[v].SLL_MinLook=this.decisions[v].SLL_MinLook===0?N:Math.min(this.decisions[v].SLL_MinLook,N),N>this.decisions[v].SLL_MaxLook&&(this.decisions[v].SLL_MaxLook=N,this.decisions[v].SLL_MaxLookEvent=new c.LookaheadEventInfo(v,void 0,C,m,this._startIndex,this._sllStopIndex,!1)),this._llStopIndex>=0){let R=this._llStopIndex-this._startIndex+1;this.decisions[v].LL_TotalLook+=R,this.decisions[v].LL_MinLook=this.decisions[v].LL_MinLook===0?R:Math.min(this.decisions[v].LL_MinLook,R),R>this.decisions[v].LL_MaxLook&&(this.decisions[v].LL_MaxLook=R,this.decisions[v].LL_MaxLookEvent=new c.LookaheadEventInfo(v,void 0,C,m,this._startIndex,this._llStopIndex,!0))}return C}finally{this._input=void 0,this.currentDecision=-1}}getStartState(m,v,x,g){let S=super.getStartState(m,v,x,g);return this.currentState=S,S}computeStartState(m,v,x){let g=super.computeStartState(m,v,x);return this.currentState=g,g}computeReachSet(m,v,x,g){if(this._input===void 0)throw new Error("Invalid state");let S=super.computeReachSet(m,v,x,g);return S==null&&this.decisions[this.currentDecision].errors.push(new s.ErrorInfo(this.currentDecision,v,this._input,this._startIndex,this._input.index)),this.currentState=S,S}getExistingTargetState(m,v){if(this.currentState===void 0||this._input===void 0)throw new Error("Invalid state");this.currentState.useContext?this._llStopIndex=this._input.index:this._sllStopIndex=this._input.index;let x=super.getExistingTargetState(m,v);if(x!=null&&(this.currentState=new d.SimulatorState(this.currentState.outerContext,x,this.currentState.useContext,this.currentState.remainingOuterContext),this.currentState.useContext?this.decisions[this.currentDecision].LL_DFATransitions++:this.decisions[this.currentDecision].SLL_DFATransitions++,x===o.ATNSimulator.ERROR)){let g=new d.SimulatorState(this.currentState.outerContext,m,this.currentState.useContext,this.currentState.remainingOuterContext);this.decisions[this.currentDecision].errors.push(new s.ErrorInfo(this.currentDecision,g,this._input,this._startIndex,this._input.index))}return x}computeTargetState(m,v,x,g,S,C){let A=super.computeTargetState(m,v,x,g,S,C);return S?this.decisions[this.currentDecision].LL_ATNTransitions++:this.decisions[this.currentDecision].SLL_ATNTransitions++,A}evalSemanticContextImpl(m,v,x){if(this.currentState===void 0||this._input===void 0)throw new Error("Invalid state");let g=super.evalSemanticContextImpl(m,v,x);if(!(m instanceof f.SemanticContext.PrecedencePredicate)){let C=this._llStopIndex>=0?this._llStopIndex:this._sllStopIndex;this.decisions[this.currentDecision].predicateEvals.push(new h.PredicateEvalInfo(this.currentState,this.currentDecision,this._input,this._startIndex,C,m,g,x))}return g}reportContextSensitivity(m,v,x,g,S){if(this._input===void 0)throw new Error("Invalid state");v!==this.conflictingAltResolvedBySLL&&this.decisions[this.currentDecision].contextSensitivities.push(new i.ContextSensitivityInfo(this.currentDecision,x,this._input,g,S)),super.reportContextSensitivity(m,v,x,g,S)}reportAttemptingFullContext(m,v,x,g,S){v!=null?this.conflictingAltResolvedBySLL=v.nextSetBit(0):this.conflictingAltResolvedBySLL=x.s0.configs.getRepresentedAlternatives().nextSetBit(0),this.decisions[this.currentDecision].LL_Fallback++,super.reportAttemptingFullContext(m,v,x,g,S)}reportAmbiguity(m,v,x,g,S,C,A){if(this.currentState===void 0||this._input===void 0)throw new Error("Invalid state");let b;C!=null?b=C.nextSetBit(0):b=A.getRepresentedAlternatives().nextSetBit(0),this.conflictingAltResolvedBySLL!==n.ATN.INVALID_ALT_NUMBER&&b!==this.conflictingAltResolvedBySLL&&this.decisions[this.currentDecision].contextSensitivities.push(new i.ContextSensitivityInfo(this.currentDecision,this.currentState,this._input,x,g)),this.decisions[this.currentDecision].ambiguities.push(new t.AmbiguityInfo(this.currentDecision,this.currentState,C,this._input,x,g)),super.reportAmbiguity(m,v,x,g,S,C,A)}getDecisionInfo(){return this.decisions}getCurrentState(){return this.currentState}};return l([a.Override,e(0,a.NotNull)],p.prototype,"adaptivePredict",null),l([a.Override],p.prototype,"getStartState",null),l([a.Override],p.prototype,"computeStartState",null),l([a.Override],p.prototype,"computeReachSet",null),l([a.Override],p.prototype,"getExistingTargetState",null),l([a.Override],p.prototype,"computeTargetState",null),l([a.Override],p.prototype,"evalSemanticContextImpl",null),l([a.Override],p.prototype,"reportContextSensitivity",null),l([a.Override],p.prototype,"reportAttemptingFullContext",null),l([a.Override,e(0,a.NotNull),e(5,a.NotNull),e(6,a.NotNull)],p.prototype,"reportAmbiguity",null),or.ProfilingATNSimulator=p,or}var Tf;function io(){if(Tf)return ot;Tf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ot&&ot.__decorate||function(g,S,C,A){var b=arguments.length,N=b<3?S:A===null?A=Object.getOwnPropertyDescriptor(S,C):A,R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(g,S,C,A);else for(var P=g.length-1;P>=0;P--)(R=g[P])&&(N=(b<3?R(N):b>3?R(S,C,N):R(S,C))||N);return b>3&&N&&Object.defineProperty(S,C,N),N},e=ot&&ot.__param||function(g,S){return function(C,A){S(C,A,g)}},t=ot&&ot.__awaiter||function(g,S,C,A){function b(N){return N instanceof C?N:new C(function(R){R(N)})}return new(C||(C=Promise))(function(N,R){function P(H){try{D(A.next(H))}catch(J){R(J)}}function k(H){try{D(A.throw(H))}catch(J){R(J)}}function D(H){H.done?N(H.value):b(H.value).then(P,k)}D((A=A.apply(g,S||[])).next())})};Object.defineProperty(ot,"__esModule",{value:!0}),ot.Parser=void 0;const n=vr(),o=Ud(),i=fl(),r=xl(),s=cl(),a=Od(),c=Ir(),u=Z(),h=pm(),f=ro(),d=tp(),p=eo(),y=di(),m=Be();class v{constructor(S,C){this.ruleNames=S,this.tokenStream=C}enterEveryRule(S){console.log("enter   "+this.ruleNames[S.ruleIndex]+", LT(1)="+this.tokenStream.LT(1).text)}exitEveryRule(S){console.log("exit    "+this.ruleNames[S.ruleIndex]+", LT(1)="+this.tokenStream.LT(1).text)}visitErrorNode(S){}visitTerminal(S){let C=S.parent.ruleContext,A=S.symbol;console.log("consume "+A+" rule "+this.ruleNames[C.ruleIndex])}}l([u.Override],v.prototype,"enterEveryRule",null),l([u.Override],v.prototype,"exitEveryRule",null),l([u.Override],v.prototype,"visitErrorNode",null),l([u.Override],v.prototype,"visitTerminal",null);let x=class Ao extends p.Recognizer{constructor(S){super(),this._errHandler=new r.DefaultErrorStrategy,this._precedenceStack=new a.IntegerStack,this._buildParseTrees=!0,this._parseListeners=[],this._syntaxErrors=0,this.matchedEOF=!1,this._precedenceStack.push(0),this.inputStream=S}reset(S){(S===void 0||S)&&this.inputStream.seek(0),this._errHandler.reset(this),this._ctx=void 0,this._syntaxErrors=0,this.matchedEOF=!1,this.isTrace=!1,this._precedenceStack.clear(),this._precedenceStack.push(0);let C=this.interpreter;C!=null&&C.reset()}match(S){let C=this.currentToken;return C.type===S?(S===m.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):(C=this._errHandler.recoverInline(this),this._buildParseTrees&&C.tokenIndex===-1&&this._ctx.addErrorNode(this.createErrorNode(this._ctx,C))),C}matchWildcard(){let S=this.currentToken;return S.type>0?(this._errHandler.reportMatch(this),this.consume()):(S=this._errHandler.recoverInline(this),this._buildParseTrees&&S.tokenIndex===-1&&this._ctx.addErrorNode(this.createErrorNode(this._ctx,S))),S}set buildParseTree(S){this._buildParseTrees=S}get buildParseTree(){return this._buildParseTrees}getParseListeners(){return this._parseListeners}addParseListener(S){if(S==null)throw new TypeError("listener cannot be null");this._parseListeners.push(S)}removeParseListener(S){let C=this._parseListeners.findIndex(A=>A===S);C!==-1&&this._parseListeners.splice(C,1)}removeParseListeners(){this._parseListeners.length=0}triggerEnterRuleEvent(){for(let S of this._parseListeners)S.enterEveryRule&&S.enterEveryRule(this._ctx),this._ctx.enterRule(S)}triggerExitRuleEvent(){for(let S=this._parseListeners.length-1;S>=0;S--){let C=this._parseListeners[S];this._ctx.exitRule(C),C.exitEveryRule&&C.exitEveryRule(this._ctx)}}get numberOfSyntaxErrors(){return this._syntaxErrors}get tokenFactory(){return this._input.tokenSource.tokenFactory}getATNWithBypassAlts(){let S=this.serializedATN;if(S==null)throw new Error("The current parser does not support an ATN with bypass alternatives.");let C=Ao.bypassAltsAtnCache.get(S);if(C==null){let A=new o.ATNDeserializationOptions;A.isGenerateRuleBypassTransitions=!0,C=new i.ATNDeserializer(A).deserialize(n.toCharArray(S)),Ao.bypassAltsAtnCache.set(S,C)}return C}compileParseTreePattern(S,C,A){return t(this,void 0,void 0,function*(){if(!A){if(this.inputStream){let P=this.inputStream.tokenSource;P instanceof c.Lexer&&(A=P)}if(!A)throw new Error("Parser can't discover a lexer to use")}let b=A,N=yield Promise.resolve().then(()=>Fm());return new N.ParseTreePatternMatcher(b,this).compile(S,C)})}get errorHandler(){return this._errHandler}set errorHandler(S){this._errHandler=S}get inputStream(){return this._input}set inputStream(S){this.reset(!1),this._input=S}get currentToken(){return this._input.LT(1)}notifyErrorListeners(S,C,A){C===void 0?C=this.currentToken:C===null&&(C=void 0),this._syntaxErrors++;let b=-1,N=-1;C!=null&&(b=C.line,N=C.charPositionInLine);let R=this.getErrorListenerDispatch();R.syntaxError&&R.syntaxError(this,C,b,N,S,A)}consume(){let S=this.currentToken;S.type!==Ao.EOF&&this.inputStream.consume();let C=this._parseListeners.length!==0;if(this._buildParseTrees||C)if(this._errHandler.inErrorRecoveryMode(this)){let A=this._ctx.addErrorNode(this.createErrorNode(this._ctx,S));if(C)for(let b of this._parseListeners)b.visitErrorNode&&b.visitErrorNode(A)}else{let A=this.createTerminalNode(this._ctx,S);if(this._ctx.addChild(A),C)for(let b of this._parseListeners)b.visitTerminal&&b.visitTerminal(A)}return S}createTerminalNode(S,C){return new y.TerminalNode(C)}createErrorNode(S,C){return new s.ErrorNode(C)}addContextToParseTree(){let S=this._ctx._parent;S!=null&&S.addChild(this._ctx)}enterRule(S,C,A){this.state=C,this._ctx=S,this._ctx._start=this._input.LT(1),this._buildParseTrees&&this.addContextToParseTree(),this.triggerEnterRuleEvent()}enterLeftFactoredRule(S,C,A){if(this.state=C,this._buildParseTrees){let b=this._ctx.getChild(this._ctx.childCount-1);this._ctx.removeLastChild(),b._parent=S,S.addChild(b)}this._ctx=S,this._ctx._start=this._input.LT(1),this._buildParseTrees&&this.addContextToParseTree(),this.triggerEnterRuleEvent()}exitRule(){this.matchedEOF?this._ctx._stop=this._input.LT(1):this._ctx._stop=this._input.tryLT(-1),this.triggerExitRuleEvent(),this.state=this._ctx.invokingState,this._ctx=this._ctx._parent}enterOuterAlt(S,C){if(S.altNumber=C,this._buildParseTrees&&this._ctx!==S){let A=this._ctx._parent;A!=null&&(A.removeLastChild(),A.addChild(S))}this._ctx=S}get precedence(){return this._precedenceStack.isEmpty?-1:this._precedenceStack.peek()}enterRecursionRule(S,C,A,b){this.state=C,this._precedenceStack.push(b),this._ctx=S,this._ctx._start=this._input.LT(1),this.triggerEnterRuleEvent()}pushNewRecursionContext(S,C,A){let b=this._ctx;b._parent=S,b.invokingState=C,b._stop=this._input.tryLT(-1),this._ctx=S,this._ctx._start=b._start,this._buildParseTrees&&this._ctx.addChild(b),this.triggerEnterRuleEvent()}unrollRecursionContexts(S){this._precedenceStack.pop(),this._ctx._stop=this._input.tryLT(-1);let C=this._ctx;if(this._parseListeners.length>0)for(;this._ctx!==S;)this.triggerExitRuleEvent(),this._ctx=this._ctx._parent;else this._ctx=S;C._parent=S,this._buildParseTrees&&S!=null&&S.addChild(C)}getInvokingContext(S){let C=this._ctx;for(;C&&C.ruleIndex!==S;)C=C._parent;return C}get context(){return this._ctx}set context(S){this._ctx=S}precpred(S,C){return C>=this._precedenceStack.peek()}getErrorListenerDispatch(){return new d.ProxyParserErrorListener(this.getErrorListeners())}inContext(S){return!1}isExpectedToken(S){let C=this.interpreter.atn,A=this._ctx,b=C.states[this.state],N=C.nextTokens(b);if(N.contains(S))return!0;if(!N.contains(m.Token.EPSILON))return!1;for(;A!=null&&A.invokingState>=0&&N.contains(m.Token.EPSILON);){let P=C.states[A.invokingState].transition(0);if(N=C.nextTokens(P.followState),N.contains(S))return!0;A=A._parent}return!!(N.contains(m.Token.EPSILON)&&S===m.Token.EOF)}get isMatchedEOF(){return this.matchedEOF}getExpectedTokens(){return this.atn.getExpectedTokens(this.state,this.context)}getExpectedTokensWithinCurrentRule(){let S=this.interpreter.atn,C=S.states[this.state];return S.nextTokens(C)}getRuleIndex(S){let C=this.getRuleIndexMap().get(S);return C??-1}get ruleContext(){return this._ctx}getRuleInvocationStack(S=this._ctx){let C=S,A=this.ruleNames,b=[];for(;C!=null;){let N=C.ruleIndex;N<0?b.push("n/a"):b.push(A[N]),C=C._parent}return b}getDFAStrings(){let S=[];for(let C of this._interp.atn.decisionToDFA)S.push(C.toString(this.vocabulary,this.ruleNames));return S}dumpDFA(){let S=!1;for(let C of this._interp.atn.decisionToDFA)C.isEmpty||(S&&console.log(),console.log("Decision "+C.decision+":"),process.stdout.write(C.toString(this.vocabulary,this.ruleNames)),S=!0)}get sourceName(){return this._input.sourceName}get parseInfo(){return Promise.resolve().then(()=>_f()).then(S=>{let C=this.interpreter;if(C instanceof S.ProfilingATNSimulator)return new h.ParseInfo(C)})}setProfile(S){return t(this,void 0,void 0,function*(){let C=yield Promise.resolve().then(()=>_f()),A=this.interpreter;S?A instanceof C.ProfilingATNSimulator||(this.interpreter=new C.ProfilingATNSimulator(this)):A instanceof C.ProfilingATNSimulator&&(this.interpreter=new f.ParserATNSimulator(this.atn,this)),this.interpreter.setPredictionMode(A.getPredictionMode())})}set isTrace(S){S?(this._tracer?this.removeParseListener(this._tracer):this._tracer=new v(this.ruleNames,this._input),this.addParseListener(this._tracer)):this._tracer&&(this.removeParseListener(this._tracer),this._tracer=void 0)}get isTrace(){return this._tracer!=null}};return x.bypassAltsAtnCache=new Map,l([u.NotNull],x.prototype,"_errHandler",void 0),l([u.NotNull],x.prototype,"match",null),l([u.NotNull],x.prototype,"matchWildcard",null),l([u.NotNull],x.prototype,"getParseListeners",null),l([e(0,u.NotNull)],x.prototype,"addParseListener",null),l([u.NotNull],x.prototype,"getATNWithBypassAlts",null),l([u.NotNull,e(0,u.NotNull)],x.prototype,"errorHandler",null),l([u.Override],x.prototype,"inputStream",null),l([u.NotNull],x.prototype,"currentToken",null),l([e(0,u.NotNull)],x.prototype,"enterRule",null),l([u.Override,e(0,u.Nullable)],x.prototype,"precpred",null),l([u.Override],x.prototype,"getErrorListenerDispatch",null),l([u.NotNull],x.prototype,"getExpectedTokens",null),l([u.NotNull],x.prototype,"getExpectedTokensWithinCurrentRule",null),l([u.Override],x.prototype,"parseInfo",null),ot.Parser=x,ot}var bf;function jo(){if(bf)return an;bf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=an&&an.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(an,"__esModule",{value:!0}),an.NoViableAltException=void 0;const e=io(),t=wr(),n=Z();let o=class extends t.RecognitionException{constructor(r,s,a,c,u,h){r instanceof e.Parser&&(s===void 0&&(s=r.inputStream),a===void 0&&(a=r.currentToken),c===void 0&&(c=r.currentToken),h===void 0&&(h=r.context)),super(r,s,h),this._deadEndConfigs=u,this._startToken=a,this.setOffendingToken(r,c)}get startToken(){return this._startToken}get deadEndConfigs(){return this._deadEndConfigs}};return l([n.NotNull],o.prototype,"_startToken",void 0),an.NoViableAltException=o,an}var Nf;function xl(){if(Nf)return dt;Nf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=dt&&dt.__decorate||function(f,d,p,y){var m=arguments.length,v=m<3?d:y===null?y=Object.getOwnPropertyDescriptor(d,p):y,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,d,p,y);else for(var g=f.length-1;g>=0;g--)(x=f[g])&&(v=(m<3?x(v):m>3?x(d,p,v):x(d,p))||v);return m>3&&v&&Object.defineProperty(d,p,v),v},e=dt&&dt.__param||function(f,d){return function(p,y){d(p,y,f)}};Object.defineProperty(dt,"__esModule",{value:!0}),dt.DefaultErrorStrategy=void 0;const t=yr(),n=He(),o=Po(),i=Io(),r=Yn(),s=jo(),a=lt(),c=Be(),u=Z();let h=class{constructor(){this.errorRecoveryMode=!1,this.lastErrorIndex=-1,this.nextTokensState=t.ATNState.INVALID_STATE_NUMBER}reset(d){this.endErrorCondition(d)}beginErrorCondition(d){this.errorRecoveryMode=!0}inErrorRecoveryMode(d){return this.errorRecoveryMode}endErrorCondition(d){this.errorRecoveryMode=!1,this.lastErrorStates=void 0,this.lastErrorIndex=-1}reportMatch(d){this.endErrorCondition(d)}reportError(d,p){this.inErrorRecoveryMode(d)||(this.beginErrorCondition(d),p instanceof s.NoViableAltException?this.reportNoViableAlternative(d,p):p instanceof i.InputMismatchException?this.reportInputMismatch(d,p):p instanceof o.FailedPredicateException?this.reportFailedPredicate(d,p):(console.error(`unknown recognition error type: ${p}`),this.notifyErrorListeners(d,p.toString(),p)))}notifyErrorListeners(d,p,y){let m=y.getOffendingToken(d);m===void 0&&(m=null),d.notifyErrorListeners(p,m,y)}recover(d,p){this.lastErrorIndex===d.inputStream.index&&this.lastErrorStates&&this.lastErrorStates.contains(d.state)&&d.consume(),this.lastErrorIndex=d.inputStream.index,this.lastErrorStates||(this.lastErrorStates=new r.IntervalSet),this.lastErrorStates.add(d.state);let y=this.getErrorRecoverySet(d);this.consumeUntil(d,y)}sync(d){let p=d.interpreter.atn.states[d.state];if(this.inErrorRecoveryMode(d))return;let m=d.inputStream.LA(1),v=d.atn.nextTokens(p);if(v.contains(m)){this.nextTokensContext=void 0,this.nextTokensState=t.ATNState.INVALID_STATE_NUMBER;return}if(v.contains(c.Token.EPSILON)){this.nextTokensContext===void 0&&(this.nextTokensContext=d.context,this.nextTokensState=d.state);return}switch(p.stateType){case n.ATNStateType.BLOCK_START:case n.ATNStateType.STAR_BLOCK_START:case n.ATNStateType.PLUS_BLOCK_START:case n.ATNStateType.STAR_LOOP_ENTRY:if(this.singleTokenDeletion(d))return;throw new i.InputMismatchException(d);case n.ATNStateType.PLUS_LOOP_BACK:case n.ATNStateType.STAR_LOOP_BACK:this.reportUnwantedToken(d);let g=d.getExpectedTokens().or(this.getErrorRecoverySet(d));this.consumeUntil(d,g);break}}reportNoViableAlternative(d,p){let y=d.inputStream,m;y?p.startToken.type===c.Token.EOF?m="<EOF>":m=y.getTextFromRange(p.startToken,p.getOffendingToken()):m="<unknown input>";let v="no viable alternative at input "+this.escapeWSAndQuote(m);this.notifyErrorListeners(d,v,p)}reportInputMismatch(d,p){let y=p.expectedTokens,m=y?y.toStringVocabulary(d.vocabulary):"",v="mismatched input "+this.getTokenErrorDisplay(p.getOffendingToken(d))+" expecting "+m;this.notifyErrorListeners(d,v,p)}reportFailedPredicate(d,p){let m="rule "+d.ruleNames[d.context.ruleIndex]+" "+p.message;this.notifyErrorListeners(d,m,p)}reportUnwantedToken(d){if(this.inErrorRecoveryMode(d))return;this.beginErrorCondition(d);let p=d.currentToken,y=this.getTokenErrorDisplay(p),m=this.getExpectedTokens(d),v="extraneous input "+y+" expecting "+m.toStringVocabulary(d.vocabulary);d.notifyErrorListeners(v,p,void 0)}reportMissingToken(d){if(this.inErrorRecoveryMode(d))return;this.beginErrorCondition(d);let p=d.currentToken,m="missing "+this.getExpectedTokens(d).toStringVocabulary(d.vocabulary)+" at "+this.getTokenErrorDisplay(p);d.notifyErrorListeners(m,p,void 0)}recoverInline(d){let p=this.singleTokenDeletion(d);if(p)return d.consume(),p;if(this.singleTokenInsertion(d))return this.getMissingSymbol(d);throw this.nextTokensContext===void 0?new i.InputMismatchException(d):new i.InputMismatchException(d,this.nextTokensState,this.nextTokensContext)}singleTokenInsertion(d){let p=d.inputStream.LA(1),m=d.interpreter.atn.states[d.state].transition(0).target,v=d.interpreter.atn;return v.nextTokens(m,a.PredictionContext.fromRuleContext(v,d.context)).contains(p)?(this.reportMissingToken(d),!0):!1}singleTokenDeletion(d){let p=d.inputStream.LA(2);if(this.getExpectedTokens(d).contains(p)){this.reportUnwantedToken(d),d.consume();let m=d.currentToken;return this.reportMatch(d),m}}getMissingSymbol(d){let p=d.currentToken,y=this.getExpectedTokens(d),m=c.Token.INVALID_TYPE;y.isNil||(m=y.minElement);let v;m===c.Token.EOF?v="<missing EOF>":v="<missing "+d.vocabulary.getDisplayName(m)+">";let x=p,g=d.inputStream.tryLT(-1);return x.type===c.Token.EOF&&g!=null&&(x=g),this.constructToken(d.inputStream.tokenSource,m,v,x)}constructToken(d,p,y,m){let v=d.tokenFactory,x=m.tokenSource,g=x?x.inputStream:void 0;return v.create({source:d,stream:g},p,y,c.Token.DEFAULT_CHANNEL,-1,-1,m.line,m.charPositionInLine)}getExpectedTokens(d){return d.getExpectedTokens()}getTokenErrorDisplay(d){if(!d)return"<no token>";let p=this.getSymbolText(d);return p||(this.getSymbolType(d)===c.Token.EOF?p="<EOF>":p=`<${this.getSymbolType(d)}>`),this.escapeWSAndQuote(p)}getSymbolText(d){return d.text}getSymbolType(d){return d.type}escapeWSAndQuote(d){return d=d.replace(`
`,"\\n"),d=d.replace("\r","\\r"),d=d.replace("	","\\t"),"'"+d+"'"}getErrorRecoverySet(d){let p=d.interpreter.atn,y=d.context,m=new r.IntervalSet;for(;y&&y.invokingState>=0;){let x=p.states[y.invokingState].transition(0),g=p.nextTokens(x.followState);m.addAll(g),y=y._parent}return m.remove(c.Token.EPSILON),m}consumeUntil(d,p){let y=d.inputStream.LA(1);for(;y!==c.Token.EOF&&!p.contains(y);)d.consume(),y=d.inputStream.LA(1)}};return l([u.Override],h.prototype,"reset",null),l([e(0,u.NotNull)],h.prototype,"beginErrorCondition",null),l([u.Override],h.prototype,"inErrorRecoveryMode",null),l([e(0,u.NotNull)],h.prototype,"endErrorCondition",null),l([u.Override],h.prototype,"reportMatch",null),l([u.Override],h.prototype,"reportError",null),l([e(0,u.NotNull)],h.prototype,"notifyErrorListeners",null),l([u.Override],h.prototype,"recover",null),l([u.Override],h.prototype,"sync",null),l([e(0,u.NotNull),e(1,u.NotNull)],h.prototype,"reportNoViableAlternative",null),l([e(0,u.NotNull),e(1,u.NotNull)],h.prototype,"reportInputMismatch",null),l([e(0,u.NotNull),e(1,u.NotNull)],h.prototype,"reportFailedPredicate",null),l([e(0,u.NotNull)],h.prototype,"reportUnwantedToken",null),l([e(0,u.NotNull)],h.prototype,"reportMissingToken",null),l([u.Override],h.prototype,"recoverInline",null),l([e(0,u.NotNull)],h.prototype,"singleTokenInsertion",null),l([e(0,u.NotNull)],h.prototype,"singleTokenDeletion",null),l([u.NotNull,e(0,u.NotNull)],h.prototype,"getMissingSymbol",null),l([u.NotNull,e(0,u.NotNull)],h.prototype,"getExpectedTokens",null),l([e(0,u.NotNull)],h.prototype,"getSymbolText",null),l([e(0,u.NotNull)],h.prototype,"getSymbolType",null),l([u.NotNull,e(0,u.NotNull)],h.prototype,"escapeWSAndQuote",null),l([u.NotNull,e(0,u.NotNull)],h.prototype,"getErrorRecoverySet",null),l([e(0,u.NotNull),e(1,u.NotNull)],h.prototype,"consumeUntil",null),dt.DefaultErrorStrategy=h,dt}var Rf;function fp(){if(Rf)return zr;Rf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=zr&&zr.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(zr,"__esModule",{value:!0}),zr.BailErrorStrategy=void 0;const e=xl(),t=Io(),n=Z(),o=ap();let i=class extends e.DefaultErrorStrategy{recover(s,a){for(let c=s.context;c;c=c.parent)c.exception=a;throw new o.ParseCancellationException(a)}recoverInline(s){let a=new t.InputMismatchException(s);for(let c=s.context;c;c=c.parent)c.exception=a;throw new o.ParseCancellationException(a)}sync(s){}};return l([n.Override],i.prototype,"recover",null),l([n.Override],i.prototype,"recoverInline",null),l([n.Override],i.prototype,"sync",null),zr.BailErrorStrategy=i,zr}var va={},wf;function km(){if(wf)return va;wf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(va,"__esModule",{value:!0}),va}var Sa={},Of;function zm(){return Of||(Of=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.Dependents=void 0,function(e){e[e.SELF=0]="SELF",e[e.PARENTS=1]="PARENTS",e[e.CHILDREN=2]="CHILDREN",e[e.ANCESTORS=3]="ANCESTORS",e[e.DESCENDANTS=4]="DESCENDANTS",e[e.SIBLINGS=5]="SIBLINGS",e[e.PRECEEDING_SIBLINGS=6]="PRECEEDING_SIBLINGS",e[e.FOLLOWING_SIBLINGS=7]="FOLLOWING_SIBLINGS",e[e.PRECEEDING=8]="PRECEEDING",e[e.FOLLOWING=9]="FOLLOWING"}(l.Dependents||(l.Dependents={}))}(Sa)),Sa}var fr={},Ff;function jm(){if(Ff)return fr;Ff=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=fr&&fr.__decorate||function(r,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,s,a,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=fr&&fr.__param||function(r,s){return function(a,c){s(a,c,r)}};Object.defineProperty(fr,"__esModule",{value:!0}),fr.DiagnosticErrorListener=void 0;const t=Pr(),n=Z(),o=Xe();let i=class{constructor(s=!0){this.exactOnly=s,this.exactOnly=s}syntaxError(s,a,c,u,h,f){}reportAmbiguity(s,a,c,u,h,f,d){if(this.exactOnly&&!h)return;let p=this.getDecisionDescription(s,a),y=this.getConflictingAlts(f,d),m=s.inputStream.getText(o.Interval.of(c,u)),v=`reportAmbiguity d=${p}: ambigAlts=${y}, input='${m}'`;s.notifyErrorListeners(v)}reportAttemptingFullContext(s,a,c,u,h,f){let d=this.getDecisionDescription(s,a),p=s.inputStream.getText(o.Interval.of(c,u)),y=`reportAttemptingFullContext d=${d}, input='${p}'`;s.notifyErrorListeners(y)}reportContextSensitivity(s,a,c,u,h,f){let d=this.getDecisionDescription(s,a),p=s.inputStream.getText(o.Interval.of(c,u)),y=`reportContextSensitivity d=${d}, input='${p}'`;s.notifyErrorListeners(y)}getDecisionDescription(s,a){let c=a.decision,u=a.atnStartState.ruleIndex,h=s.ruleNames;if(u<0||u>=h.length)return c.toString();let f=h[u];return f?`${c} (${f})`:c.toString()}getConflictingAlts(s,a){if(s!=null)return s;let c=new t.BitSet;for(let u of a)c.set(u.alt);return c}};return l([n.Override],i.prototype,"syntaxError",null),l([n.Override,e(0,n.NotNull),e(1,n.NotNull),e(6,n.NotNull)],i.prototype,"reportAmbiguity",null),l([n.Override,e(0,n.NotNull),e(1,n.NotNull),e(5,n.NotNull)],i.prototype,"reportAttemptingFullContext",null),l([n.Override,e(0,n.NotNull),e(1,n.NotNull),e(5,n.NotNull)],i.prototype,"reportContextSensitivity",null),l([e(0,n.NotNull),e(1,n.NotNull)],i.prototype,"getDecisionDescription",null),l([n.NotNull,e(1,n.NotNull)],i.prototype,"getConflictingAlts",null),fr.DiagnosticErrorListener=i,fr}var dr={},Pf;function qm(){if(Pf)return dr;Pf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=dr&&dr.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f},e=dr&&dr.__param||function(s,a){return function(c,u){a(c,u,s)}};Object.defineProperty(dr,"__esModule",{value:!0}),dr.LexerInterpreter=void 0;const t=Ir(),n=ko(),o=Z(),i=Z();let r=class extends t.Lexer{constructor(a,c,u,h,f,d,p){if(super(p),d.grammarType!==0)throw new Error("IllegalArgumentException: The ATN must be a lexer ATN.");this._grammarFileName=a,this._atn=d,this._ruleNames=u.slice(0),this._channelNames=h.slice(0),this._modeNames=f.slice(0),this._vocabulary=c,this._interp=new n.LexerATNSimulator(d,this)}get atn(){return this._atn}get grammarFileName(){return this._grammarFileName}get ruleNames(){return this._ruleNames}get channelNames(){return this._channelNames}get modeNames(){return this._modeNames}get vocabulary(){return this._vocabulary}};return l([o.NotNull],r.prototype,"_vocabulary",void 0),l([i.Override],r.prototype,"atn",null),l([i.Override],r.prototype,"grammarFileName",null),l([i.Override],r.prototype,"ruleNames",null),l([i.Override],r.prototype,"channelNames",null),l([i.Override],r.prototype,"modeNames",null),l([i.Override],r.prototype,"vocabulary",null),r=l([e(1,o.NotNull)],r),dr.LexerInterpreter=r,dr}var Aa={},If;function Um(){if(If)return Aa;If=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Aa,"__esModule",{value:!0}),Aa}var jn={},Df;function Hm(){if(Df)return jn;Df=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=jn&&jn.__decorate||function(i,r,s,a){var c=arguments.length,u=c<3?r:a===null?a=Object.getOwnPropertyDescriptor(r,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,r,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(r,s,u):h(r,s))||u);return c>3&&u&&Object.defineProperty(r,s,u),u};Object.defineProperty(jn,"__esModule",{value:!0}),jn.RuleContextWithAltNum=void 0;const e=ft(),t=Z(),n=ut();let o=class extends n.ParserRuleContext{constructor(r,s){s!==void 0?super(r,s):super(),this._altNumber=e.ATN.INVALID_ALT_NUMBER}get altNumber(){return this._altNumber}set altNumber(r){this._altNumber=r}};return l([t.Override],o.prototype,"altNumber",null),jn.RuleContextWithAltNum=o,jn}var Li={},Lf;function $m(){if(Lf)return Li;Lf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Li,"__esModule",{value:!0}),Li.RuleDependency=void 0;function l(e){return(t,n,o)=>{}}return Li.RuleDependency=l,Li}var Mi={},Mf;function Vm(){if(Mf)return Mi;Mf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.RuleVersion=void 0;function l(e){return(t,n,o)=>{}}return Mi.RuleVersion=l,Mi}var Ca={},Bf;function Wm(){if(Bf)return Ca;Bf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Ca,"__esModule",{value:!0}),Ca}var Ea={},kf;function Gm(){if(kf)return Ea;kf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Ea,"__esModule",{value:!0}),Ea}var _a={},zf;function Ym(){if(zf)return _a;zf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(_a,"__esModule",{value:!0}),_a}var pr={},jf;function Xm(){if(jf)return pr;jf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=pr&&pr.__decorate||function(c,u,h,f){var d=arguments.length,p=d<3?u:f===null?f=Object.getOwnPropertyDescriptor(u,h):f,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,u,h,f);else for(var m=c.length-1;m>=0;m--)(y=c[m])&&(p=(d<3?y(p):d>3?y(u,h,p):y(u,h))||p);return d>3&&p&&Object.defineProperty(u,h,p),p};Object.defineProperty(pr,"__esModule",{value:!0}),pr.RewriteOperation=pr.TokenStreamRewriter=void 0;const e=Xe(),t=Z(),n=Be();let o=class nt{constructor(u){this.tokens=u,this.programs=new Map,this.programs.set(nt.DEFAULT_PROGRAM_NAME,[]),this.lastRewriteTokenIndexes=new Map}getTokenStream(){return this.tokens}rollback(u,h=nt.DEFAULT_PROGRAM_NAME){let f=this.programs.get(h);f!=null&&this.programs.set(h,f.slice(nt.MIN_TOKEN_INDEX,u))}deleteProgram(u=nt.DEFAULT_PROGRAM_NAME){this.rollback(nt.MIN_TOKEN_INDEX,u)}insertAfter(u,h,f=nt.DEFAULT_PROGRAM_NAME){let d;typeof u=="number"?d=u:d=u.tokenIndex;let p=this.getProgram(f),y=new s(this.tokens,d,p.length,h);p.push(y)}insertBefore(u,h,f=nt.DEFAULT_PROGRAM_NAME){let d;typeof u=="number"?d=u:d=u.tokenIndex;let p=this.getProgram(f),y=new r(this.tokens,d,p.length,h);p.push(y)}replaceSingle(u,h){typeof u=="number"?this.replace(u,u,h):this.replace(u,u,h)}replace(u,h,f,d=nt.DEFAULT_PROGRAM_NAME){if(typeof u!="number"&&(u=u.tokenIndex),typeof h!="number"&&(h=h.tokenIndex),u>h||u<0||h<0||h>=this.tokens.size)throw new RangeError(`replace: range invalid: ${u}..${h}(size=${this.tokens.size})`);let p=this.getProgram(d),y=new a(this.tokens,u,h,p.length,f);p.push(y)}delete(u,h,f=nt.DEFAULT_PROGRAM_NAME){h===void 0&&(h=u),typeof u=="number"?this.replace(u,h,"",f):this.replace(u,h,"",f)}getLastRewriteTokenIndex(u=nt.DEFAULT_PROGRAM_NAME){let h=this.lastRewriteTokenIndexes.get(u);return h??-1}setLastRewriteTokenIndex(u,h){this.lastRewriteTokenIndexes.set(u,h)}getProgram(u){let h=this.programs.get(u);return h==null&&(h=this.initializeProgram(u)),h}initializeProgram(u){let h=[];return this.programs.set(u,h),h}getText(u,h=nt.DEFAULT_PROGRAM_NAME){let f;u instanceof e.Interval?f=u:f=e.Interval.of(0,this.tokens.size-1),typeof u=="string"&&(h=u);let d=this.programs.get(h),p=f.a,y=f.b;if(y>this.tokens.size-1&&(y=this.tokens.size-1),p<0&&(p=0),d==null||d.length===0)return this.tokens.getText(f);let m=[],v=this.reduceToSingleOperationPerIndex(d),x=p;for(;x<=y&&x<this.tokens.size;){let g=v.get(x);v.delete(x);let S=this.tokens.get(x);g==null?(S.type!==n.Token.EOF&&m.push(String(S.text)),x++):x=g.execute(m)}if(y===this.tokens.size-1)for(let g of v.values())g.index>=this.tokens.size-1&&m.push(g.text.toString());return m.join("")}reduceToSingleOperationPerIndex(u){for(let f=0;f<u.length;f++){let d=u[f];if(d==null||!(d instanceof a))continue;let p=d,y=this.getKindOfOps(u,r,f);for(let v of y)v.index===p.index?(u[v.instructionIndex]=void 0,p.text=v.text.toString()+(p.text!=null?p.text.toString():"")):v.index>p.index&&v.index<=p.lastIndex&&(u[v.instructionIndex]=void 0);let m=this.getKindOfOps(u,a,f);for(let v of m){if(v.index>=p.index&&v.lastIndex<=p.lastIndex){u[v.instructionIndex]=void 0;continue}let x=v.lastIndex<p.index||v.index>p.lastIndex;if(v.text==null&&p.text==null&&!x)u[v.instructionIndex]=void 0,p.index=Math.min(v.index,p.index),p.lastIndex=Math.max(v.lastIndex,p.lastIndex);else if(!x)throw new Error(`replace op boundaries of ${p} overlap with previous ${v}`)}}for(let f=0;f<u.length;f++){let d=u[f];if(d==null||!(d instanceof r))continue;let p=d,y=this.getKindOfOps(u,r,f);for(let v of y)v.index===p.index&&(v instanceof s?(p.text=this.catOpText(v.text,p.text),u[v.instructionIndex]=void 0):v instanceof r&&(p.text=this.catOpText(p.text,v.text),u[v.instructionIndex]=void 0));let m=this.getKindOfOps(u,a,f);for(let v of m){if(p.index===v.index){v.text=this.catOpText(p.text,v.text),u[f]=void 0;continue}if(p.index>=v.index&&p.index<=v.lastIndex)throw new Error(`insert op ${p} within boundaries of previous ${v}`)}}let h=new Map;for(let f of u)if(f!=null){if(h.get(f.index)!=null)throw new Error("should only be one op per index");h.set(f.index,f)}return h}catOpText(u,h){let f="",d="";return u!=null&&(f=u.toString()),h!=null&&(d=h.toString()),f+d}getKindOfOps(u,h,f){let d=[];for(let p=0;p<f&&p<u.length;p++){let y=u[p];y!=null&&y instanceof h&&d.push(y)}return d}};pr.TokenStreamRewriter=o,o.DEFAULT_PROGRAM_NAME="default",o.PROGRAM_INIT_SIZE=100,o.MIN_TOKEN_INDEX=0;class i{constructor(u,h,f,d){this.tokens=u,this.instructionIndex=f,this.index=h,this.text=d===void 0?"":d}execute(u){return this.index}toString(){let u=this.constructor.name,h=u.indexOf("$");return u=u.substring(h+1,u.length),"<"+u+"@"+this.tokens.get(this.index)+':"'+this.text+'">'}}l([t.Override],i.prototype,"toString",null),pr.RewriteOperation=i;class r extends i{constructor(u,h,f,d){super(u,h,f,d)}execute(u){return u.push(this.text.toString()),this.tokens.get(this.index).type!==n.Token.EOF&&u.push(String(this.tokens.get(this.index).text)),this.index+1}}l([t.Override],r.prototype,"execute",null);class s extends r{constructor(u,h,f,d){super(u,h+1,f,d)}}class a extends i{constructor(u,h,f,d,p){super(u,h,d,p),this.lastIndex=f}execute(u){return this.text!=null&&u.push(this.text.toString()),this.lastIndex+1}toString(){return this.text==null?"<DeleteOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+">":"<ReplaceOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+':"'+this.text+'">'}}return l([t.Override],a.prototype,"execute",null),l([t.Override],a.prototype,"toString",null),pr}var Ta={},qf;function Km(){if(qf)return Ta;qf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Ta,"__esModule",{value:!0}),Ta}var ba={},Uf;function Qm(){if(Uf)return ba;Uf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(ba,"__esModule",{value:!0}),ba}var Hf;function Jm(){return Hf||(Hf=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Br&&Br.__createBinding||(Object.create?function(n,o,i,r){r===void 0&&(r=i),Object.defineProperty(n,r,{enumerable:!0,get:function(){return o[i]}})}:function(n,o,i,r){r===void 0&&(r=i),n[r]=o[i]}),t=Br&&Br.__exportStar||function(n,o){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&e(o,n,i)};Object.defineProperty(l,"__esModule",{value:!0}),t(Xp(),l),t(Kp(),l),t(z0(),l),t(fp(),l),t(op(),l),t(km(),l),t(dl(),l),t(rp(),l),t(ip(),l),t(Ji(),l),t(nl(),l),t(pl(),l),t(Dd(),l),t(xl(),l),t(zm(),l),t(jm(),l),t(Po(),l),t(Io(),l),t(lp(),l),t(Rr(),l),t(Ir(),l),t(qm(),l),t(Bo(),l),t(sp(),l),t(jo(),l),t(io(),l),t(Um(),l),t(up(),l),t(ut(),l),t(ol(),l),t(tp(),l),t(wr(),l),t(eo(),l),t(Zd(),l),t(Hm(),l),t($m(),l),t(Vm(),l),t(Be(),l),t(Wm(),l),t(Gm(),l),t(Ym(),l),t(Xm(),l),t(Km(),l),t(Gn(),l),t(Qm(),l)}(Br)),Br}var ni=Jm(),dp=fl(),Zm=Ir(),ex=ko(),pp=Gn(),mp=vr();const Ae=class Ae extends Zm.Lexer{get vocabulary(){return Ae.VOCABULARY}constructor(e){super(e),this._interp=new ex.LexerATNSimulator(Ae._ATN,this)}get grammarFileName(){return"Formula.g4"}get ruleNames(){return Ae.ruleNames}get serializedATN(){return Ae._serializedATN}get channelNames(){return Ae.channelNames}get modeNames(){return Ae.modeNames}static get _ATN(){return Ae.__ATN||(Ae.__ATN=new dp.ATNDeserializer().deserialize(mp.toCharArray(Ae._serializedATN))),Ae.__ATN}};B(Ae,"T__0",1),B(Ae,"T__1",2),B(Ae,"T__2",3),B(Ae,"REFERENCE",4),B(Ae,"REF",5),B(Ae,"REFRANGE",6),B(Ae,"BOOL",7),B(Ae,"STRING",8),B(Ae,"NUM",9),B(Ae,"FUNCNAME",10),B(Ae,"WS",11),B(Ae,"MUL",12),B(Ae,"DIV",13),B(Ae,"ADD",14),B(Ae,"SUB",15),B(Ae,"EQ",16),B(Ae,"NEQ",17),B(Ae,"LTE",18),B(Ae,"GTE",19),B(Ae,"LT",20),B(Ae,"GT",21),B(Ae,"channelNames",["DEFAULT_TOKEN_CHANNEL","HIDDEN"]),B(Ae,"modeNames",["DEFAULT_MODE"]),B(Ae,"ruleNames",["T__0","T__1","T__2","REFERENCE","SHEET_NAME","QUOTED_SHEET_NAME","REF","REFRANGE","BOOL","STRING","NUM","FUNCNAME","WS","MUL","DIV","ADD","SUB","EQ","NEQ","LTE","GTE","LT","GT"]),B(Ae,"_LITERAL_NAMES",[void 0,"'('","')'","','",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"'*'","'/'","'+'","'-'","'='","'<>'","'<='","'>='","'<'","'>'"]),B(Ae,"_SYMBOLIC_NAMES",[void 0,void 0,void 0,void 0,"REFERENCE","REF","REFRANGE","BOOL","STRING","NUM","FUNCNAME","WS","MUL","DIV","ADD","SUB","EQ","NEQ","LTE","GTE","LT","GT"]),B(Ae,"VOCABULARY",new pp.VocabularyImpl(Ae._LITERAL_NAMES,Ae._SYMBOLIC_NAMES,[])),B(Ae,"_serializedATN",`\b					\x07	\x07\b	\b			
	
\v	\v\f	\f\r	\r											J
\x07N
\fQ\v\x07\x07\x07U
\x07\r\x07\x07V\x07\x07\b\b\\
\b\b\b\b\`
\b\b\bc
\b\b\bf
\b\b\b\x07\bj
\b\f\b\bm\v\b				




















\v\v\x07\v
\v\f\v\v\v\v\v\v\f\f
\f\r\f\f\f\f\f
\f\r\f\f\f
\f\r\r\x07\r
\r\f\r\r\v\r
\r\x07	\v\r\x07\b	
\v\f\x1B\r!#%')+-/
C\\c|2;C\\c|))3;2;$$\x07002;C\\aac|\v\v""\x07	\x1B!#%')+-/13\x075	I\vK\rR[n\x1B!#%')+-/12\x07*234\x07+456\x07.6\b78\r\x0789\x07#9:	:J;<\r\x07<=\x07#=>\b>J?@\v@A\x07#AB	BJCD\vDE\x07#EF\bFJGJ	HJ\bI7I;I?ICIGIHJ
KO	LN	MLNQOMOPP\fQORT\x07)SU
TSUVVTVWWXXY\x07)YZ\\\x07&[Z[\\\\]]_	^\`	_^_\`\`bac	babccedf\x07&edeffggk	hj	ihjmkikllmkno\bop\x07<pq\bqrs\x07Vst\x07Ttu\x07Wu\x07Gvw\x07Hwx\x07Cxy\x07Nyz\x07Uz\x07G{|\x07v|}\x07t}~\x07w~\x07g\x07h\x07c\x07n\x07u\x07grv{\x07$
\x07\x07$	\x070			\b		\b\x07,\x071 \x07-"\x07/$\x07?&\x07>\x07@(\x07>\x07?*\x07@\x07?,\x07>.\x07@0IOV[_bek\b`),B(Ae,"__ATN");let ii=Ae;var tx=ft(),rx=Po(),nx=jo(),ix=io(),gl=ut(),ox=ro(),Na=wr(),Ra=Be();const se=class se extends ix.Parser{get vocabulary(){return se.VOCABULARY}get grammarFileName(){return"Formula.g4"}get ruleNames(){return se.ruleNames}get serializedATN(){return se._serializedATN}createFailedPredicateException(e,t){return new rx.FailedPredicateException(this,e,t)}constructor(e){super(e),this._interp=new ox.ParserATNSimulator(se._ATN,this)}formula(){let e=new sx(this._ctx,this.state);this.enterRule(e,0,se.RULE_formula);let t;try{this.enterOuterAlt(e,1);{this.state=7,this._errHandler.sync(this),t=this._input.LA(1);do this.state=6,this.expr(0),this.state=9,this._errHandler.sync(this),t=this._input.LA(1);while((t&-32)===0&&(1<<t&(1<<se.T__0|1<<se.REFERENCE|1<<se.BOOL|1<<se.STRING|1<<se.NUM|1<<se.FUNCNAME))!==0)}}catch(n){if(n instanceof Na.RecognitionException)e.exception=n,this._errHandler.reportError(this,n),this._errHandler.recover(this,n);else throw n}finally{this.exitRule()}return e}expr(e){e===void 0&&(e=0);let t=this._ctx,n=this.state,o=new ke(this._ctx,n),i=o,r=2;this.enterRecursionRule(o,2,se.RULE_expr,e);let s;try{let a;this.enterOuterAlt(o,1);{switch(this.state=26,this._errHandler.sync(this),this._input.LA(1)){case se.FUNCNAME:o=new ax(o),this._ctx=o,i=o,this.state=12,this.match(se.FUNCNAME),this.state=13,this.match(se.T__0),this.state=15,this._errHandler.sync(this),s=this._input.LA(1),(s&-32)===0&&(1<<s&(1<<se.T__0|1<<se.REFERENCE|1<<se.BOOL|1<<se.STRING|1<<se.NUM|1<<se.FUNCNAME))!==0&&(this.state=14,this.args()),this.state=17,this.match(se.T__1);break;case se.NUM:o=new hx(o),this._ctx=o,i=o,this.state=18,this.match(se.NUM);break;case se.BOOL:o=new fx(o),this._ctx=o,i=o,this.state=19,this.match(se.BOOL);break;case se.STRING:o=new dx(o),this._ctx=o,i=o,this.state=20,this.match(se.STRING);break;case se.REFERENCE:o=new px(o),this._ctx=o,i=o,this.state=21,this.match(se.REFERENCE);break;case se.T__0:o=new mx(o),this._ctx=o,i=o,this.state=22,this.match(se.T__0),this.state=23,this.expr(0),this.state=24,this.match(se.T__1);break;default:throw new nx.NoViableAltException(this)}for(this._ctx._stop=this._input.tryLT(-1),this.state=39,this._errHandler.sync(this),a=this.interpreter.adaptivePredict(this._input,4,this._ctx);a!==2&&a!==tx.ATN.INVALID_ALT_NUMBER;){if(a===1)switch(this._parseListeners!=null&&this.triggerExitRuleEvent(),i=o,this.state=37,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,3,this._ctx)){case 1:{if(o=new lx(new ke(t,n)),this.pushNewRecursionContext(o,r,se.RULE_expr),this.state=28,!this.precpred(this._ctx,8))throw this.createFailedPredicateException("this.precpred(this._ctx, 8)");this.state=29,o._op=this._input.LT(1),s=this._input.LA(1),s===se.MUL||s===se.DIV?(this._input.LA(1)===Ra.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):o._op=this._errHandler.recoverInline(this),this.state=30,this.expr(9)}break;case 2:{if(o=new ux(new ke(t,n)),this.pushNewRecursionContext(o,r,se.RULE_expr),this.state=31,!this.precpred(this._ctx,7))throw this.createFailedPredicateException("this.precpred(this._ctx, 7)");this.state=32,o._op=this._input.LT(1),s=this._input.LA(1),s===se.ADD||s===se.SUB?(this._input.LA(1)===Ra.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):o._op=this._errHandler.recoverInline(this),this.state=33,this.expr(8)}break;case 3:{if(o=new cx(new ke(t,n)),this.pushNewRecursionContext(o,r,se.RULE_expr),this.state=34,!this.precpred(this._ctx,6))throw this.createFailedPredicateException("this.precpred(this._ctx, 6)");this.state=35,o._op=this._input.LT(1),s=this._input.LA(1),(s&-32)===0&&(1<<s&(1<<se.EQ|1<<se.NEQ|1<<se.LTE|1<<se.GTE|1<<se.LT|1<<se.GT))!==0?(this._input.LA(1)===Ra.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):o._op=this._errHandler.recoverInline(this),this.state=36,this.expr(7)}break}this.state=41,this._errHandler.sync(this),a=this.interpreter.adaptivePredict(this._input,4,this._ctx)}}}catch(a){if(a instanceof Na.RecognitionException)o.exception=a,this._errHandler.reportError(this,a),this._errHandler.recover(this,a);else throw a}finally{this.unrollRecursionContexts(t)}return o}args(){let e=new xp(this._ctx,this.state);this.enterRule(e,4,se.RULE_args);let t;try{for(this.enterOuterAlt(e,1),this.state=42,this.expr(0),this.state=47,this._errHandler.sync(this),t=this._input.LA(1);t===se.T__2;)this.state=43,this.match(se.T__2),this.state=44,this.expr(0),this.state=49,this._errHandler.sync(this),t=this._input.LA(1)}catch(n){if(n instanceof Na.RecognitionException)e.exception=n,this._errHandler.reportError(this,n),this._errHandler.recover(this,n);else throw n}finally{this.exitRule()}return e}sempred(e,t,n){switch(t){case 1:return this.expr_sempred(e,n)}return!0}expr_sempred(e,t){switch(t){case 0:return this.precpred(this._ctx,8);case 1:return this.precpred(this._ctx,7);case 2:return this.precpred(this._ctx,6)}return!0}static get _ATN(){return se.__ATN||(se.__ATN=new dp.ATNDeserializer().deserialize(mp.toCharArray(se._serializedATN))),se.__ATN}};B(se,"T__0",1),B(se,"T__1",2),B(se,"T__2",3),B(se,"REFERENCE",4),B(se,"REF",5),B(se,"REFRANGE",6),B(se,"BOOL",7),B(se,"STRING",8),B(se,"NUM",9),B(se,"FUNCNAME",10),B(se,"WS",11),B(se,"MUL",12),B(se,"DIV",13),B(se,"ADD",14),B(se,"SUB",15),B(se,"EQ",16),B(se,"NEQ",17),B(se,"LTE",18),B(se,"GTE",19),B(se,"LT",20),B(se,"GT",21),B(se,"RULE_formula",0),B(se,"RULE_expr",1),B(se,"RULE_args",2),B(se,"ruleNames",["formula","expr","args"]),B(se,"_LITERAL_NAMES",[void 0,"'('","')'","','",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"'*'","'/'","'+'","'-'","'='","'<>'","'<='","'>='","'<'","'>'"]),B(se,"_SYMBOLIC_NAMES",[void 0,void 0,void 0,void 0,"REFERENCE","REF","REFRANGE","BOOL","STRING","NUM","FUNCNAME","WS","MUL","DIV","ADD","SUB","EQ","NEQ","LTE","GTE","LT","GT"]),B(se,"VOCABULARY",new pp.VocabularyImpl(se._LITERAL_NAMES,se._SYMBOLIC_NAMES,[])),B(se,"_serializedATN",`5			

\r\v

\x07(
\f+\v\x070
\f3\v<	,\b
	\b
\v\v	\v\f\f\r\b\x07\f\x07\x07\x07\v\x07	\x07
\x07\x07\x1B\x07\x1B\r)\f
 	 (\v!"\f	"#	#(
$%\f\b%&	&(	''!'$(+)')**+),1-.\x07.0/-031/122\x0731\b\v')1`),B(se,"__ATN");let De=se;class sx extends gl.ParserRuleContext{expr(e){return e===void 0?this.getRuleContexts(ke):this.getRuleContext(e,ke)}constructor(e,t){super(e,t)}get ruleIndex(){return De.RULE_formula}enterRule(e){e.enterFormula&&e.enterFormula(this)}exitRule(e){e.exitFormula&&e.exitFormula(this)}accept(e){return e.visitFormula?e.visitFormula(this):e.visitChildren(this)}}class ke extends gl.ParserRuleContext{constructor(e,t){super(e,t)}get ruleIndex(){return De.RULE_expr}copyFrom(e){super.copyFrom(e)}}class ax extends ke{FUNCNAME(){return this.getToken(De.FUNCNAME,0)}args(){return this.tryGetRuleContext(0,xp)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterFunction&&e.enterFunction(this)}exitRule(e){e.exitFunction&&e.exitFunction(this)}accept(e){return e.visitFunction?e.visitFunction(this):e.visitChildren(this)}}class lx extends ke{constructor(t){super(t.parent,t.invokingState);B(this,"_op");this.copyFrom(t)}expr(t){return t===void 0?this.getRuleContexts(ke):this.getRuleContext(t,ke)}MUL(){return this.tryGetToken(De.MUL,0)}DIV(){return this.tryGetToken(De.DIV,0)}enterRule(t){t.enterMulDiv&&t.enterMulDiv(this)}exitRule(t){t.exitMulDiv&&t.exitMulDiv(this)}accept(t){return t.visitMulDiv?t.visitMulDiv(this):t.visitChildren(this)}}class ux extends ke{constructor(t){super(t.parent,t.invokingState);B(this,"_op");this.copyFrom(t)}expr(t){return t===void 0?this.getRuleContexts(ke):this.getRuleContext(t,ke)}ADD(){return this.tryGetToken(De.ADD,0)}SUB(){return this.tryGetToken(De.SUB,0)}enterRule(t){t.enterAddSub&&t.enterAddSub(this)}exitRule(t){t.exitAddSub&&t.exitAddSub(this)}accept(t){return t.visitAddSub?t.visitAddSub(this):t.visitChildren(this)}}class cx extends ke{constructor(t){super(t.parent,t.invokingState);B(this,"_op");this.copyFrom(t)}expr(t){return t===void 0?this.getRuleContexts(ke):this.getRuleContext(t,ke)}EQ(){return this.tryGetToken(De.EQ,0)}NEQ(){return this.tryGetToken(De.NEQ,0)}LT(){return this.tryGetToken(De.LT,0)}GT(){return this.tryGetToken(De.GT,0)}LTE(){return this.tryGetToken(De.LTE,0)}GTE(){return this.tryGetToken(De.GTE,0)}enterRule(t){t.enterComparison&&t.enterComparison(this)}exitRule(t){t.exitComparison&&t.exitComparison(this)}accept(t){return t.visitComparison?t.visitComparison(this):t.visitChildren(this)}}class hx extends ke{NUM(){return this.getToken(De.NUM,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterNumber&&e.enterNumber(this)}exitRule(e){e.exitNumber&&e.exitNumber(this)}accept(e){return e.visitNumber?e.visitNumber(this):e.visitChildren(this)}}class fx extends ke{BOOL(){return this.getToken(De.BOOL,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterBoolean&&e.enterBoolean(this)}exitRule(e){e.exitBoolean&&e.exitBoolean(this)}accept(e){return e.visitBoolean?e.visitBoolean(this):e.visitChildren(this)}}class dx extends ke{STRING(){return this.getToken(De.STRING,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterStr&&e.enterStr(this)}exitRule(e){e.exitStr&&e.exitStr(this)}accept(e){return e.visitStr?e.visitStr(this):e.visitChildren(this)}}class px extends ke{REFERENCE(){return this.getToken(De.REFERENCE,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterReference&&e.enterReference(this)}exitRule(e){e.exitReference&&e.exitReference(this)}accept(e){return e.visitReference?e.visitReference(this):e.visitChildren(this)}}class mx extends ke{expr(){return this.getRuleContext(0,ke)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterParentheses&&e.enterParentheses(this)}exitRule(e){e.exitParentheses&&e.exitParentheses(this)}accept(e){return e.visitParentheses?e.visitParentheses(this):e.visitChildren(this)}}class xp extends gl.ParserRuleContext{expr(e){return e===void 0?this.getRuleContexts(ke):this.getRuleContext(e,ke)}constructor(e,t){super(e,t)}get ruleIndex(){return De.RULE_args}enterRule(e){e.enterArgs&&e.enterArgs(this)}exitRule(e){e.exitArgs&&e.exitArgs(this)}accept(e){return e.visitArgs?e.visitArgs(this):e.visitChildren(this)}}function*$f(l){const[e,t]=l;for(let n=e.r;n<=t.r;n++)for(let o=e.c;o<=t.c;o++)yield{r:n,c:o}}function mr(l,e){const[t,n]=e;return t.r<=l.r&&l.r<=n.r&&t.c<=l.c&&l.c<=n.c}function xx(l,e){const[t,n]=l,[o,i]=e;return o.r<=t.r&&n.r<=i.r&&o.c<=t.c&&n.c<=i.c}function qe(l,e){return[{r:Math.min(l.r,e.r),c:Math.min(l.c,e.c)},{r:Math.max(l.r,e.r),c:Math.max(l.c,e.c)}]}function st(l){return[Vf(l[0]),Vf(l[1])]}function Er(l,e){return Wi(l[0],e[0])&&Wi(l[1],e[1])}function gx(l,e){const t=[];return l[0].r>e[0].r&&t.push([{r:l[0].r-1,c:l[0].c},{r:l[0].r-1,c:l[1].c}]),l[1].r<e[1].r&&t.push([{r:l[1].r+1,c:l[0].c},{r:l[1].r+1,c:l[1].c}]),l[0].c>e[0].c&&t.push([{r:l[0].r,c:l[0].c-1},{r:l[1].r,c:l[0].c-1}]),l[1].c<e[1].c&&t.push([{r:l[0].r,c:l[1].c+1},{r:l[1].r,c:l[1].c+1}]),t}function wa(l,e){const[t,n]=l,[o,i]=e;return[{r:Math.min(t.r,o.r),c:Math.min(t.c,o.c)},{r:Math.max(n.r,i.r),c:Math.max(n.c,i.c)}]}function Wi(l,e){return l.r===e.r&&l.c===e.c}function Vf(l){return{r:l.r,c:l.c}}function We(l){return l.includes(":")}function oo(l){return l.includes("!")}function yl(l){const e=l.indexOf("!");if(e===-1)throw new Error(`Not a cross-sheet reference: ${l}`);let t=l.substring(0,e);t.startsWith("'")&&t.endsWith("'")&&(t=t.slice(1,-1));const n=l.substring(e+1);return{sheetName:t,localRef:n}}function*Dr(l){for(const e of l){if(oo(e)){const{sheetName:t,localRef:n}=yl(e);if(n.includes(":")){const o=Eo(n);for(const i of $f(o))yield`${t}!${fe(i)}`}else yield e;continue}if(We(e)){const t=Eo(e);for(const n of $f(t))yield fe(n);continue}yield e}}function fe(l){return oi(l.c)+l.r}function yx(l){const[e,t]=l;return`${fe(e)}:${fe(t)}`}function oi(l){let e="";for(;l>0;){const t=l%26;t===0?(e="Z"+e,l=Math.floor(l/26)-1):(e=String.fromCharCode(t+64)+e,l=Math.floor(l/26))}return e}function be(l){const e=l.replace(/\$/g,"");let t=0;for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);if(48<=r&&r<=57){t=i;break}}if(t===0)throw new Error("Invalid Reference");const n=parseInt(e.substring(t)),o=e.substring(0,t).split("").reverse().reduce((i,r,s)=>i+Math.pow(26,s)*(r.charCodeAt(0)-65+1),0);if(isNaN(n)||isNaN(o))throw new Error("Invalid Reference");return{r:n,c:o}}function Eo(l){const[e,t]=l.split(":");return[be(e),be(t)]}class so{constructor(){B(this,"ref");B(this,"bool");B(this,"num");B(this,"str")}static create(){return new so}setRef(e){return this.ref=e,this}setBool(e){return this.bool=e,this}setNum(e){return this.num=e,this}setStr(e){return this.str=e,this}map(e,t){return e.t==="bool"&&this.bool?this.bool(e):e.t==="num"&&this.num?this.num(e):e.t==="str"&&this.str?this.str(e):e.t==="ref"&&this.ref&&t?this.ref(e,t):e}*iterate(e,t,n){for(const o of e.expr()){const i=t(o);if(i.t==="ref"&&n)for(const r of Dr([i.v]))yield this.ref({t:"ref",v:r},n);else yield this.map(i)}}}function vx(l){return{t:"num",v:l.v?1:0}}function Sx(l){const e=Number(l);return{t:"num",v:isNaN(e)?0:e}}function Ax(l,e){var o;if(We(l.v))return{t:"err",v:"#VALUE!"};const t=((o=e.get(l.v))==null?void 0:o.v)||"",n=Number(t);return{t:"num",v:isNaN(n)?0:n}}const Ce=so.create().setRef(Ax).setBool(vx).setStr(Sx);function Cx(l){return{t:"bool",v:l.v!==0}}function Ex(l,e){var o;if(We(l.v))return{t:"err",v:"#VALUE!"};const t=((o=e.get(l.v))==null?void 0:o.v)||"";if(t==="TRUE"||t==="true")return{t:"bool",v:!0};if(t==="FALSE"||t==="false"||t==="")return{t:"bool",v:!1};const n=Number(t);return isNaN(n)?{t:"err",v:"#VALUE!"}:{t:"bool",v:n!==0}}const Lr=so.create().setRef(Ex).setNum(Cx).setStr(()=>({t:"err",v:"#VALUE!"}));function _x(l){return{t:"str",v:l.v.toString()}}function Tx(l){return{t:"str",v:l.v?"TRUE":"FALSE"}}function gp(l,e){var n;return We(l.v)?{t:"err",v:"#VALUE!"}:{t:"str",v:((n=e.get(l.v))==null?void 0:n.v)||""}}so.create().setRef(gp).setNum(_x).setBool(Tx);const Wf=new Map([["SUM",bx],["ABS",Nx],["ROUND",wx],["ROUNDUP",Ox],["ROUNDDOWN",Fx],["INT",Px],["MOD",Ix],["SQRT",Dx],["POWER",Lx],["PRODUCT",kx],["MEDIAN",zx],["IF",jx],["IFS",qx],["SWITCH",Ux],["AND",Hx],["OR",$x],["NOT",Vx],["AVERAGE",Wx],["MIN",Gx],["MAX",Yx],["COUNT",Xx],["COUNTA",Kx],["COUNTBLANK",Qx],["COUNTIF",Jx],["SUMIF",Zx],["COUNTIFS",eg],["SUMIFS",tg],["MATCH",rg],["INDEX",ng],["VLOOKUP",ig],["HLOOKUP",og],["TRIM",sg],["LEN",ag],["LEFT",lg],["RIGHT",ug],["MID",cg],["CONCATENATE",Sp],["CONCAT",hg],["FIND",fg],["SEARCH",dg],["TEXTJOIN",pg],["LOWER",mg],["UPPER",xg],["PROPER",gg],["SUBSTITUTE",yg],["TODAY",vg],["NOW",Sg],["DATE",Ag],["TIME",Cg],["DAYS",Eg],["YEAR",_g],["MONTH",Tg],["DAY",bg],["HOUR",Ng],["MINUTE",Rg],["SECOND",wg],["WEEKDAY",Og],["RAND",Mx],["RANDBETWEEN",Bx],["ISBLANK",Fg],["ISNUMBER",Pg],["ISTEXT",Ig],["ISERROR",Dg],["ISERR",Lg],["ISNA",Mg],["ISLOGICAL",Bg],["ISNONTEXT",kg],["IFERROR",zg],["IFNA",jg]]);function bx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};let o=0;for(const i of Ce.iterate(n,e,t)){if(i.t==="err")return i;o+=i.v}return{t:"num",v:o}}function Nx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);return i.t==="err"?i:{t:"num",v:Math.abs(i.v)}}function Rx(l){return l>=0?Math.floor(l+.5):Math.ceil(l-.5)}function vl(l,e,t){if(!l)return{t:"num",v:0};const n=Ce.map(e(l),t);return n.t==="err"?n:{t:"num",v:Math.trunc(n.v)}}function Kn(l){return typeof l=="object"&&l!==null&&l.t==="err"}function si(l,e,t){const n=e(l);return n.t==="err"?n:n.t!=="ref"||!t?{t:"err",v:"#VALUE!"}:{t:"refs",v:Array.from(Dr([n.v]))}}function qo(l,e,t){const n=e(l);if(n.t==="err")return n;if(n.t!=="ref"||!t)return{t:"err",v:"#VALUE!"};if(!We(n.v))return{t:"matrix",v:{refs:[n.v],rowCount:1,colCount:1}};try{let o=n.v,i="";if(oo(n.v)){const{sheetName:c,localRef:u}=yl(n.v);o=u,i=`${c}!`}const[r,s]=Eo(o),a=[];for(let c=r.r;c<=s.r;c++)for(let u=r.c;u<=s.c;u++)a.push(`${i}${fe({r:c,c:u})}`);return{t:"matrix",v:{refs:a,rowCount:s.r-r.r+1,colCount:s.c-r.c+1}}}catch{return{t:"err",v:"#VALUE!"}}}function yp(l){const e=l===""?void 0:Number(l),t=e===void 0||isNaN(e)?void 0:e,n=l.toUpperCase(),o=n==="TRUE"?!0:n==="FALSE"?!1:void 0;return{normalized:l.toLowerCase(),numericValue:t,boolValue:o}}function Sl(l,e){const t=Me(l,e);return t.t==="err"?t:yp(t.v)}function $n(l,e){var n;const t=((n=e==null?void 0:e.get(l))==null?void 0:n.v)||"";return yp(t)}function Al(l,e){return l.numericValue!==void 0&&e.numericValue!==void 0?l.numericValue===e.numericValue:l.boolValue!==void 0&&e.boolValue!==void 0?l.boolValue===e.boolValue:l.normalized===e.normalized}function _o(l,e){return l.numericValue!==void 0&&e.numericValue!==void 0?l.numericValue-e.numericValue:l.boolValue!==void 0&&e.boolValue!==void 0?Number(l.boolValue)-Number(e.boolValue):l.normalized.localeCompare(e.normalized)}function vp(l){const e=Number(l);return isNaN(e)?0:e}function Uo(l,e){if(l.t==="err")return l;if(l.t==="num")return{op:"=",value:l.v.toString(),numericValue:l.v};if(l.t==="bool")return{op:"=",value:l.v?"TRUE":"FALSE",boolValue:l.v};const t=Me(l,e);if(t.t==="err")return t;const n=/^(<=|>=|<>|=|<|>)(.*)$/.exec(t.v),o=(n==null?void 0:n[1])||"=",i=n?n[2]:t.v;let r,s;if(i!==""){const c=Number(i);isNaN(c)?i.toUpperCase()==="TRUE"?s=!0:i.toUpperCase()==="FALSE"&&(s=!1):r=c}let a;return(o==="="||o==="<>")&&/(^|[^~])[*?]/.test(i)&&(a=new RegExp(`^${Cp(i)}$`,"i")),{op:o,value:i,numericValue:r,boolValue:s,wildcardPattern:a}}function Ho(l,e){const t=l===""?void 0:Number(l),n=t!==void 0&&!isNaN(t),o=l.toUpperCase(),i=o==="TRUE"?!0:o==="FALSE"?!1:void 0,r=l.toLowerCase(),s=e.value.toLowerCase();if(e.op==="<"||e.op==="<="||e.op===">"||e.op===">=")return e.numericValue!==void 0?n?e.op==="<"?t<e.numericValue:e.op==="<="?t<=e.numericValue:e.op===">"?t>e.numericValue:t>=e.numericValue:!1:e.op==="<"?r<s:e.op==="<="?r<=s:e.op===">"?r>s:r>=s;let a=!1;return e.wildcardPattern?a=e.wildcardPattern.test(l):e.numericValue!==void 0&&n?a=t===e.numericValue:e.boolValue!==void 0&&i!==void 0?a=i===e.boolValue:a=r===s,e.op==="="?a:!a}function wx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);if(i.t==="err")return i;const r=vl(o[1],e,t);if(r.t==="err")return r;const s=10**r.v;return{t:"num",v:Rx(i.v*s)/s}}function Ox(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);if(i.t==="err")return i;const r=vl(o[1],e,t);if(r.t==="err")return r;const s=10**r.v,a=i.v*s;return{t:"num",v:(a>=0?Math.ceil(a):Math.floor(a))/s}}function Fx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);if(i.t==="err")return i;const r=vl(o[1],e,t);if(r.t==="err")return r;const s=10**r.v,a=i.v*s;return{t:"num",v:(a>=0?Math.floor(a):Math.ceil(a))/s}}function Px(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);return i.t==="err"?i:{t:"num",v:Math.floor(i.v)}}function Ix(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);if(i.t==="err")return i;const r=Ce.map(e(o[1]),t);return r.t==="err"?r:r.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:i.v-r.v*Math.floor(i.v/r.v)}}function Dx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);return i.t==="err"?i:i.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.sqrt(i.v)}}function Lx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);if(i.t==="err")return i;const r=Ce.map(e(o[1]),t);if(r.t==="err")return r;const s=Math.pow(i.v,r.v);return isFinite(s)?{t:"num",v:s}:{t:"err",v:"#VALUE!"}}function Mx(l,e,t){const n=l.args();return n&&n.expr().length>0?{t:"err",v:"#N/A!"}:{t:"num",v:Math.random()}}function Bx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);if(i.t==="err")return i;const r=Ce.map(e(o[1]),t);if(r.t==="err")return r;const s=Math.ceil(i.v),a=Math.floor(r.v);return s>a?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.floor(Math.random()*(a-s+1))+s}}function kx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};let o=1;for(const i of Ce.iterate(n,e,t)){if(i.t==="err")return i;o*=i.v}return{t:"num",v:o}}function zx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=[];for(const r of Ce.iterate(n,e,t)){if(r.t==="err")return r;o.push(r.v)}if(o.length===0)return{t:"err",v:"#VALUE!"};o.sort((r,s)=>r-s);const i=Math.floor(o.length/2);return o.length%2===1?{t:"num",v:o[i]}:{t:"num",v:(o[i-1]+o[i])/2}}function jx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<2||o.length>3)return{t:"err",v:"#N/A!"};const i=Lr.map(e(o[0]),t);return i.t==="err"?i:i.v?e(o[1]):o.length===3?e(o[2]):{t:"bool",v:!1}}function qx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<2||o.length%2!==0)return{t:"err",v:"#N/A!"};for(let i=0;i<o.length;i+=2){const r=Lr.map(e(o[i]),t);if(r.t==="err")return r;if(r.v)return e(o[i+1])}return{t:"err",v:"#N/A!"}}function Ux(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<3)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);if(i.t==="err")return i;const r=o.length-1,s=r%2===1,a=s?(r-1)/2:r/2;for(let c=0;c<a;c++){const u=Me(e(o[1+c*2]),t);if(u.t==="err")return u;if(u.v===i.v)return e(o[2+c*2])}return s?e(o[o.length-1]):{t:"err",v:"#N/A!"}}function Hx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};for(const o of Lr.iterate(n,e,t)){if(o.t==="err")return o;if(!o.v)return{t:"bool",v:!1}}return{t:"bool",v:!0}}function $x(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};for(const o of Lr.iterate(n,e,t)){if(o.t==="err")return o;if(o.v)return{t:"bool",v:!0}}return{t:"bool",v:!1}}function Vx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=Lr.map(e(o[0]),t);return i.t==="err"?i:{t:"bool",v:!i.v}}function Wx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};let o=0,i=0;for(const r of Ce.iterate(n,e,t)){if(r.t==="err")return r;o+=r.v,i++}return i===0?{t:"err",v:"#VALUE!"}:{t:"num",v:o/i}}function Gx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};let o=1/0;for(const i of Ce.iterate(n,e,t)){if(i.t==="err")return i;i.v<o&&(o=i.v)}return{t:"num",v:o}}function Yx(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};let o=-1/0;for(const i of Ce.iterate(n,e,t)){if(i.t==="err")return i;i.v>o&&(o=i.v)}return{t:"num",v:o}}function Xx(l,e,t){var i,r;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};let o=0;for(const s of n.expr()){const a=e(s);if(a.t==="num")o++;else if(a.t==="bool")o++;else if(a.t==="ref"&&t)if(We(a.v))for(const c of Dr([a.v])){const u=((i=t.get(c))==null?void 0:i.v)||"";u!==""&&!isNaN(Number(u))&&o++}else{const c=((r=t.get(a.v))==null?void 0:r.v)||"";c!==""&&!isNaN(Number(c))&&o++}}return{t:"num",v:o}}function Kx(l,e,t){var i,r;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};let o=0;for(const s of n.expr()){const a=e(s);if(a.t==="num"||a.t==="bool")o++;else if(a.t==="str")a.v!==""&&o++;else if(a.t==="ref"&&t)if(We(a.v))for(const c of Dr([a.v]))(((i=t.get(c))==null?void 0:i.v)||"")!==""&&o++;else(((r=t.get(a.v))==null?void 0:r.v)||"")!==""&&o++}return{t:"num",v:o}}function Qx(l,e,t){var i,r;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};let o=0;for(const s of n.expr()){const a=e(s);if(a.t==="str"){a.v===""&&o++;continue}if(a.t!=="ref"||!t)continue;if(We(a.v)){for(const u of Dr([a.v]))(((i=t.get(u))==null?void 0:i.v)||"")===""&&o++;continue}(((r=t.get(a.v))==null?void 0:r.v)||"")===""&&o++}return{t:"num",v:o}}function Jx(l,e,t){var a;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=si(o[0],e,t);if(i.t==="err")return i;const r=Uo(e(o[1]),t);if(Kn(r))return r;let s=0;for(const c of i.v){const u=((a=t==null?void 0:t.get(c))==null?void 0:a.v)||"";Ho(u,r)&&s++}return{t:"num",v:s}}function Zx(l,e,t){var c,u;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<2||o.length>3)return{t:"err",v:"#N/A!"};const i=si(o[0],e,t);if(i.t==="err")return i;const r=Uo(e(o[1]),t);if(Kn(r))return r;const s=o.length===3?si(o[2],e,t):i;if(s.t==="err")return s;if(i.v.length!==s.v.length)return{t:"err",v:"#VALUE!"};let a=0;for(let h=0;h<i.v.length;h++){const f=((c=t==null?void 0:t.get(i.v[h]))==null?void 0:c.v)||"";if(!Ho(f,r))continue;const d=((u=t==null?void 0:t.get(s.v[h]))==null?void 0:u.v)||"";a+=vp(d)}return{t:"num",v:a}}function eg(l,e,t){var c;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<2||o.length%2!==0)return{t:"err",v:"#N/A!"};const i=[],r=[];for(let u=0;u<o.length;u+=2){const h=si(o[u],e,t);if(h.t==="err")return h;i.push(h.v);const f=Uo(e(o[u+1]),t);if(Kn(f))return f;r.push(f)}const s=i[0].length;if(i.some(u=>u.length!==s))return{t:"err",v:"#VALUE!"};let a=0;for(let u=0;u<s;u++){let h=!0;for(let f=0;f<i.length;f++){const d=((c=t==null?void 0:t.get(i[f][u]))==null?void 0:c.v)||"";if(!Ho(d,r[f])){h=!1;break}}h&&a++}return{t:"num",v:a}}function tg(l,e,t){var c,u;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<3||(o.length-1)%2!==0)return{t:"err",v:"#N/A!"};const i=si(o[0],e,t);if(i.t==="err")return i;const r=[],s=[];for(let h=1;h<o.length;h+=2){const f=si(o[h],e,t);if(f.t==="err")return f;r.push(f.v);const d=Uo(e(o[h+1]),t);if(Kn(d))return d;s.push(d)}if(r.some(h=>h.length!==i.v.length))return{t:"err",v:"#VALUE!"};let a=0;for(let h=0;h<i.v.length;h++){let f=!0;for(let d=0;d<r.length;d++){const p=((c=t==null?void 0:t.get(r[d][h]))==null?void 0:c.v)||"";if(!Ho(p,s[d])){f=!1;break}}f&&(a+=vp(((u=t==null?void 0:t.get(i.v[h]))==null?void 0:u.v)||""))}return{t:"num",v:a}}function rg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<2||o.length>3)return{t:"err",v:"#N/A!"};const i=Sl(e(o[0]),t);if(Kn(i))return i;const r=qo(o[1],e,t);if(r.t==="err")return r;if(r.v.rowCount>1&&r.v.colCount>1)return{t:"err",v:"#N/A!"};let s=1;if(o.length===3){const c=Ce.map(e(o[2]),t);if(c.t==="err")return c;s=Math.trunc(c.v)}if(s!==-1&&s!==0&&s!==1)return{t:"err",v:"#N/A!"};if(s===0){for(let c=0;c<r.v.refs.length;c++){const u=$n(r.v.refs[c],t);if(Al(u,i))return{t:"num",v:c+1}}return{t:"err",v:"#N/A!"}}let a=-1;if(s===1){let c=-1/0;for(let u=0;u<r.v.refs.length;u++){const h=$n(r.v.refs[u],t),f=_o(h,i);f<=0&&f>c&&(c=f,a=u)}}else{let c=1/0;for(let u=0;u<r.v.refs.length;u++){const h=$n(r.v.refs[u],t),f=_o(h,i);f>=0&&f<c&&(c=f,a=u)}}return a<0?{t:"err",v:"#N/A!"}:{t:"num",v:a+1}}function ng(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<1||o.length>3)return{t:"err",v:"#N/A!"};const i=qo(o[0],e,t);if(i.t==="err")return i;let r=1,s=1;if(o.length>=2){const a=Ce.map(e(o[1]),t);if(a.t==="err")return a;const c=Math.trunc(a.v);o.length===2&&i.v.rowCount===1&&i.v.colCount>1?s=c:r=c}if(o.length===3){const a=Ce.map(e(o[2]),t);if(a.t==="err")return a;s=Math.trunc(a.v)}return r<=0||s<=0?{t:"err",v:"#VALUE!"}:r>i.v.rowCount||s>i.v.colCount?{t:"err",v:"#REF!"}:{t:"ref",v:i.v.refs[(r-1)*i.v.colCount+(s-1)]}}function ig(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<3||o.length>4)return{t:"err",v:"#N/A!"};const i=Sl(e(o[0]),t);if(Kn(i))return i;const r=qo(o[1],e,t);if(r.t==="err")return r;const s=Ce.map(e(o[2]),t);if(s.t==="err")return s;const a=Math.trunc(s.v);if(a<=0)return{t:"err",v:"#VALUE!"};if(a>r.v.colCount)return{t:"err",v:"#REF!"};let c=!0;if(o.length===4){const f=Lr.map(e(o[3]),t);if(f.t==="err")return f;c=f.v}if(!c){for(let f=0;f<r.v.rowCount;f++){const d=r.v.refs[f*r.v.colCount],p=$n(d,t);if(Al(p,i))return{t:"ref",v:r.v.refs[f*r.v.colCount+(a-1)]}}return{t:"err",v:"#N/A!"}}let u=-1,h=-1/0;for(let f=0;f<r.v.rowCount;f++){const d=r.v.refs[f*r.v.colCount],p=$n(d,t),y=_o(p,i);y<=0&&y>h&&(h=y,u=f)}return u<0?{t:"err",v:"#N/A!"}:{t:"ref",v:r.v.refs[u*r.v.colCount+(a-1)]}}function og(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<3||o.length>4)return{t:"err",v:"#N/A!"};const i=Sl(e(o[0]),t);if(Kn(i))return i;const r=qo(o[1],e,t);if(r.t==="err")return r;const s=Ce.map(e(o[2]),t);if(s.t==="err")return s;const a=Math.trunc(s.v);if(a<=0)return{t:"err",v:"#VALUE!"};if(a>r.v.rowCount)return{t:"err",v:"#REF!"};let c=!0;if(o.length===4){const f=Lr.map(e(o[3]),t);if(f.t==="err")return f;c=f.v}if(!c){for(let f=0;f<r.v.colCount;f++){const d=r.v.refs[f],p=$n(d,t);if(Al(p,i))return{t:"ref",v:r.v.refs[(a-1)*r.v.colCount+f]}}return{t:"err",v:"#N/A!"}}let u=-1,h=-1/0;for(let f=0;f<r.v.colCount;f++){const d=r.v.refs[f],p=$n(d,t),y=_o(p,i);y<=0&&y>h&&(h=y,u=f)}return u<0?{t:"err",v:"#N/A!"}:{t:"ref",v:r.v.refs[(a-1)*r.v.colCount+u]}}function Me(l,e){return l.t==="err"||l.t==="str"?l:l.t==="num"?{t:"str",v:l.v.toString()}:l.t==="bool"?{t:"str",v:l.v?"TRUE":"FALSE"}:l.t==="ref"&&e?gp(l,e):{t:"err",v:"#VALUE!"}}function sg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);return i.t==="err"?i:{t:"str",v:i.v.trim()}}function ag(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);return i.t==="err"?i:{t:"num",v:i.v.length}}function lg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);if(i.t==="err")return i;let r=1;if(o.length===2){const s=Ce.map(e(o[1]),t);if(s.t==="err")return s;r=s.v}return{t:"str",v:i.v.slice(0,r)}}function ug(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);if(i.t==="err")return i;let r=1;if(o.length===2){const s=Ce.map(e(o[1]),t);if(s.t==="err")return s;r=s.v}return{t:"str",v:i.v.slice(-r)}}function cg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==3)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);if(i.t==="err")return i;const r=Ce.map(e(o[1]),t);if(r.t==="err")return r;const s=Ce.map(e(o[2]),t);if(s.t==="err")return s;const a=r.v-1;return{t:"str",v:i.v.slice(a,a+s.v)}}function Sp(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<2)return{t:"err",v:"#N/A!"};let i="";for(const r of o){const s=Me(e(r),t);if(s.t==="err")return s;i+=s.v}return{t:"str",v:i}}function hg(l,e,t){return Sp(l,e,t)}function Ap(l,e,t,n){if(!l)return{t:"num",v:1};const o=Ce.map(t(l),n);if(o.t==="err")return o;const i=Math.trunc(o.v);return i<1||i>e.length+1?{t:"err",v:"#VALUE!"}:{t:"num",v:i}}function fg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<2||o.length>3)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);if(i.t==="err")return i;const r=Me(e(o[1]),t);if(r.t==="err")return r;const s=Ap(o[2],r.v,e,t);if(s.t==="err")return s;if(i.v==="")return{t:"num",v:s.v};const a=r.v.indexOf(i.v,s.v-1);return a<0?{t:"err",v:"#VALUE!"}:{t:"num",v:a+1}}function Cp(l){let e="";for(let t=0;t<l.length;t++){const n=l[t];if(n==="~"&&t+1<l.length){e+=l[t+1].replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),t++;continue}if(n==="*"){e+=".*";continue}if(n==="?"){e+=".";continue}e+=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}return e}function dg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<2||o.length>3)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);if(i.t==="err")return i;const r=Me(e(o[1]),t);if(r.t==="err")return r;const s=Ap(o[2],r.v,e,t);if(s.t==="err")return s;if(i.v==="")return{t:"num",v:s.v};const a=Cp(i.v),c=new RegExp(a,"i"),u=r.v.slice(s.v-1),h=c.exec(u);return!h||h.index===void 0?{t:"err",v:"#VALUE!"}:{t:"num",v:s.v+h.index}}function pg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<3)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);if(i.t==="err")return i;const r=Lr.map(e(o[1]),t);if(r.t==="err")return r;const s=[];for(const a of o.slice(2)){const c=e(a);if(c.t==="ref"&&t&&We(c.v)){for(const h of Dr([c.v])){const f=Me({t:"ref",v:h},t);if(f.t==="err")return f;r.v&&f.v===""||s.push(f.v)}continue}const u=Me(c,t);if(u.t==="err")return u;r.v&&u.v===""||s.push(u.v)}return{t:"str",v:s.join(i.v)}}function mg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);return i.t==="err"?i:{t:"str",v:i.v.toLowerCase()}}function xg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);return i.t==="err"?i:{t:"str",v:i.v.toUpperCase()}}function gg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);return i.t==="err"?i:{t:"str",v:i.v.toLowerCase().replace(/\b([a-z])([a-z]*)/g,(s,a,c)=>a.toUpperCase()+c)}}function yg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<3||o.length>4)return{t:"err",v:"#N/A!"};const i=Me(e(o[0]),t);if(i.t==="err")return i;const r=Me(e(o[1]),t);if(r.t==="err")return r;const s=Me(e(o[2]),t);if(s.t==="err")return s;if(r.v==="")return{t:"str",v:i.v};if(o.length===3)return{t:"str",v:i.v.split(r.v).join(s.v)};const a=Ce.map(e(o[3]),t);if(a.t==="err")return a;const c=Math.trunc(a.v);if(c<=0)return{t:"err",v:"#VALUE!"};let u=0,h=0;for(;;){const f=i.v.indexOf(r.v,u);if(f<0)return{t:"str",v:i.v};if(h++,h===c)return{t:"str",v:i.v.slice(0,f)+s.v+i.v.slice(f+r.v.length)};u=f+r.v.length}}function Cl(l){const e=l.getFullYear(),t=String(l.getMonth()+1).padStart(2,"0"),n=String(l.getDate()).padStart(2,"0");return`${e}-${t}-${n}`}function Ep(l){const e=String(l.getHours()).padStart(2,"0"),t=String(l.getMinutes()).padStart(2,"0"),n=String(l.getSeconds()).padStart(2,"0");return`${e}:${t}:${n}`}function vg(l,e,t){const n=l.args();return n&&n.expr().length>0?{t:"err",v:"#N/A!"}:{t:"str",v:Cl(new Date)}}function Sg(l,e,t){const n=l.args();if(n&&n.expr().length>0)return{t:"err",v:"#N/A!"};const o=new Date;return{t:"str",v:`${Cl(o)} ${Ep(o)}`}}function ai(l,e){const t=Me(l,e);if(t.t==="err")return t;const n=new Date(t.v);return isNaN(n.getTime())?{t:"err",v:"#VALUE!"}:n}function El(l,e){const t=Me(l,e);if(t.t==="err")return t;const n=/^(\d{1,2}):(\d{1,2})(?::(\d{1,2}))?$/.exec(t.v.trim());if(n){const i=Number(n[1]),r=Number(n[2]),s=Number(n[3]||"0");return i<0||i>23||r<0||r>59||s<0||s>59?{t:"err",v:"#VALUE!"}:new Date(1970,0,1,i,r,s)}const o=new Date(t.v);return isNaN(o.getTime())?{t:"err",v:"#VALUE!"}:o}function Ag(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==3)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);if(i.t==="err")return i;const r=Ce.map(e(o[1]),t);if(r.t==="err")return r;const s=Ce.map(e(o[2]),t);if(s.t==="err")return s;const a=Math.trunc(i.v),c=Math.trunc(r.v),u=Math.trunc(s.v);return!isFinite(a)||!isFinite(c)||!isFinite(u)?{t:"err",v:"#VALUE!"}:{t:"str",v:Cl(new Date(a,c-1,u))}}function Cg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==3)return{t:"err",v:"#N/A!"};const i=Ce.map(e(o[0]),t);if(i.t==="err")return i;const r=Ce.map(e(o[1]),t);if(r.t==="err")return r;const s=Ce.map(e(o[2]),t);if(s.t==="err")return s;const a=Math.trunc(i.v),c=Math.trunc(r.v),u=Math.trunc(s.v);return!isFinite(a)||!isFinite(c)||!isFinite(u)?{t:"err",v:"#VALUE!"}:{t:"str",v:Ep(new Date(1970,0,1,a,c,u))}}function Eg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=ai(e(o[0]),t);if(!(i instanceof Date))return i;const r=ai(e(o[1]),t);if(!(r instanceof Date))return r;const s=24*60*60*1e3,a=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate()),c=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate());return{t:"num",v:(a-c)/s}}function _g(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=ai(e(o[0]),t);return i instanceof Date?{t:"num",v:i.getFullYear()}:i}function Tg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=ai(e(o[0]),t);return i instanceof Date?{t:"num",v:i.getMonth()+1}:i}function bg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=ai(e(o[0]),t);return i instanceof Date?{t:"num",v:i.getDate()}:i}function Ng(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=El(e(o[0]),t);return i instanceof Date?{t:"num",v:i.getHours()}:i}function Rg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=El(e(o[0]),t);return i instanceof Date?{t:"num",v:i.getMinutes()}:i}function wg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=El(e(o[0]),t);return i instanceof Date?{t:"num",v:i.getSeconds()}:i}function Og(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=ai(e(o[0]),t);if(!(i instanceof Date))return i;let r=1;if(o.length===2){const a=Ce.map(e(o[1]),t);if(a.t==="err")return a;r=Math.trunc(a.v)}const s=i.getDay();return r===1?{t:"num",v:s+1}:r===2?{t:"num",v:s===0?7:s}:r===3?{t:"num",v:s===0?6:s-1}:{t:"err",v:"#VALUE!"}}function Fg(l,e,t){var s;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);return i.t==="err"?i:i.t!=="ref"||!t?{t:"bool",v:!1}:We(i.v)?{t:"err",v:"#VALUE!"}:{t:"bool",v:(((s=t.get(i.v))==null?void 0:s.v)||"")===""}}function Pg(l,e,t){var c;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);if(i.t==="err")return i;if(i.t==="num")return{t:"bool",v:!0};if(i.t!=="ref"||!t)return{t:"bool",v:!1};if(We(i.v))return{t:"err",v:"#VALUE!"};const r=((c=t.get(i.v))==null?void 0:c.v)||"",s=r.toUpperCase();return{t:"bool",v:r!==""&&!(s==="TRUE"||s==="FALSE")&&!isNaN(Number(r))}}function Ig(l,e,t){var u;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);if(i.t==="err")return i;if(i.t==="str")return{t:"bool",v:!0};if(i.t!=="ref"||!t)return{t:"bool",v:!1};if(We(i.v))return{t:"err",v:"#VALUE!"};const r=((u=t.get(i.v))==null?void 0:u.v)||"";if(r==="")return{t:"bool",v:!1};const s=r.toUpperCase(),a=s==="TRUE"||s==="FALSE",c=!isNaN(Number(r));return{t:"bool",v:!a&&!c}}function Dg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();return o.length!==1?{t:"err",v:"#N/A!"}:{t:"bool",v:e(o[0]).t==="err"}}function Lg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);return{t:"bool",v:i.t==="err"&&i.v!=="#N/A!"}}function Mg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);return{t:"bool",v:i.t==="err"&&i.v==="#N/A!"}}function Bg(l,e,t){var a;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);if(i.t==="err")return i;if(i.t==="bool")return{t:"bool",v:!0};if(i.t!=="ref"||!t)return{t:"bool",v:!1};if(We(i.v))return{t:"err",v:"#VALUE!"};const s=(((a=t.get(i.v))==null?void 0:a.v)||"").toUpperCase();return{t:"bool",v:s==="TRUE"||s==="FALSE"}}function kg(l,e,t){var u;const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);if(i.t==="err")return{t:"bool",v:!0};if(i.t==="str")return{t:"bool",v:!1};if(i.t==="num"||i.t==="bool")return{t:"bool",v:!0};if(i.t!=="ref"||!t)return{t:"bool",v:!1};if(We(i.v))return{t:"err",v:"#VALUE!"};const r=((u=t.get(i.v))==null?void 0:u.v)||"";if(r==="")return{t:"bool",v:!0};const s=r.toUpperCase(),a=s==="TRUE"||s==="FALSE",c=!isNaN(Number(r));return{t:"bool",v:a||c}}function zg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=e(o[0]);return i.t==="err"?e(o[1]):i}function jg(l,e,t){const n=l.args();if(!n)return{t:"err",v:"#N/A!"};const o=n.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=e(o[0]);return i.t==="err"&&i.v==="#N/A!"?e(o[1]):i}function _p(l){const e=ni.CharStreams.fromString(l.slice(1)),t=new ii(e),n=new ni.CommonTokenStream(t);t.removeErrorListeners(),n.fill();const o=new Set;for(const i of n.getTokens())i.type===De.REFERENCE&&o.add(i.text.toUpperCase());return o}function Mr(l){const e=ni.CharStreams.fromString(l.slice(1)),t=new ii(e),n=new ni.CommonTokenStream(t);t.removeErrorListeners(),n.fill();const o=[];for(const s of n.getTokens())s.type!=ii.EOF&&o.push({type:t.vocabulary.getSymbolicName(s.type)||"STRING",start:s.startIndex,stop:s.stopIndex,text:s.text});const i=[];let r;for(const s of o)!r&&s.start>0?i.push({type:"STRING",start:0,stop:s.start-1,text:l.slice(1,s.start+1)}):r&&r.stop+1!==s.start&&i.push({type:"STRING",start:r.stop+1,stop:s.start-1,text:l.slice(r.stop+2,s.start+1)}),i.push(s),r=s;return r&&r.stop+2<l.length&&i.push({type:"STRING",start:r.stop+1,stop:l.length-1,text:l.slice(r.stop+2)}),i}function Bi(l){const e=Mr(l),t=[];for(const n of e)if(n.type==="REFERENCE")try{const o=n.text.toUpperCase();if(oo(o))continue;if(o.includes(":"))t.push({text:o,range:Eo(o)});else{const i=be(o);t.push({text:o,range:[i,i]})}}catch{}return t}function qg(l,e){if(!l.startsWith("=")||e<=0)return!1;if(e===1)return!0;const t=Mr(l);for(const s of t){const a=s.start+1,c=s.stop+2;if(s.type==="REFERENCE"&&e>=a&&e<=c)return!0}const o=l.slice(0,e).trimEnd();if(o.length===0)return!1;const i=o[o.length-1];return new Set(["=","(",",","+","-","*","/","<",">",":"]).has(i)}function Gf(l,e){if(!l.startsWith("="))return;const t=Mr(l);for(const n of t){if(n.type!=="REFERENCE")continue;const o=n.start+1,i=n.stop+2;if(e>=o&&e<=i)return{start:o,end:i,text:n.text}}}function Ug(l,e){var t;try{const n=ni.CharStreams.fromString(l.slice(1)),o=new ii(n),i=new ni.CommonTokenStream(o),r=new De(i),s=r.expr(),a=new Hg(e);o.removeErrorListeners(),r.removeErrorListeners();const c=a.visit(s);return c.t==="ref"&&e?We(c.v)?"#VALUE!":((t=e.get(c.v))==null?void 0:t.v)||"":c.v.toString()}catch{return"#ERROR!"}}class Hg{constructor(e){B(this,"grid");this.visit=this.visit.bind(this),this.grid=e}visitChildren(){throw new Error("Method not implemented.")}visitTerminal(){throw new Error("Method not implemented.")}visitErrorNode(){throw new Error("Method not implemented.")}visitFormula(){throw new Error("Method not implemented.")}visitExpr(){throw new Error("Method not implemented.")}visitArgs(){throw new Error("Method not implemented.")}visit(e){return e.accept(this)}visitFunction(e){const t=e.FUNCNAME().text.toUpperCase();if(Wf.has(t))return Wf.get(t)(e,this.visit,this.grid);throw new Error("Function not implemented.")}visitReference(e){return this.grid?{t:"ref",v:e.text.toUpperCase()}:{t:"err",v:"#REF!"}}visitParentheses(e){return this.visit(e.expr())}visitNumber(e){return{t:"num",v:Number(e.text)}}visitBoolean(e){return{t:"bool",v:e.text==="TRUE"||e.text==="true"}}visitAddSub(e){const t=Ce.map(this.visit(e.expr(0)),this.grid);if(t.t==="err")return t;const n=Ce.map(this.visit(e.expr(1)),this.grid);return n.t==="err"?n:e._op.type===De.ADD?{t:"num",v:t.v+n.v}:{t:"num",v:t.v-n.v}}visitMulDiv(e){const t=Ce.map(this.visit(e.expr(0)),this.grid);if(t.t==="err")return t;const n=Ce.map(this.visit(e.expr(1)),this.grid);return n.t==="err"?n:e._op.type===De.MUL?{t:"num",v:t.v*n.v}:{t:"num",v:t.v/n.v}}visitComparison(e){const t=Ce.map(this.visit(e.expr(0)),this.grid);if(t.t==="err")return t;const n=Ce.map(this.visit(e.expr(1)),this.grid);if(n.t==="err")return n;switch(e._op.type){case De.EQ:return{t:"bool",v:t.v===n.v};case De.NEQ:return{t:"bool",v:t.v!==n.v};case De.LT:return{t:"bool",v:t.v<n.v};case De.GT:return{t:"bool",v:t.v>n.v};case De.LTE:return{t:"bool",v:t.v<=n.v};case De.GTE:return{t:"bool",v:t.v>=n.v};default:return{t:"err",v:"#ERROR!"}}}visitStr(e){return{t:"str",v:e.text.slice(1,-1)}}}function Ye(l,e,t,n){const o=e+t;return n<=e?l>=e&&l<o?n+(l-e):l>=n&&l<e?l+t:l:l>=e&&l<o?n-t+(l-e):l>=o&&l<n?l-t:l}function Vn(l,e,t,n,o){return e==="row"?{r:Ye(l.r,t,n,o),c:l.c}:{r:l.r,c:Ye(l.c,t,n,o)}}function $g(l,e,t,n,o){const i=Mr(l);let r="=";for(const s of i)if(s.type==="REFERENCE"){const a=s.text;if(a.includes("!"))r+=a;else if(a.includes(":")){const[c,u]=a.split(":"),h=be(c.toUpperCase()),f=be(u.toUpperCase()),d=Vn(h,e,t,n,o),p=Vn(f,e,t,n,o);r+=fe(d)+":"+fe(p)}else{const c=be(a.toUpperCase()),u=Vn(c,e,t,n,o);r+=fe(u)}}else r+=s.text;return r}function Vg(l,e,t,n,o){const i=new Map;for(const[r,s]of l){const a=be(r),c=Vn(a,e,t,n,o),u=fe(c);let h;s.f?h={...s,f:$g(s.f,e,t,n,o)}:h={...s},i.set(u,h)}return i}function br(l,e,t,n){const o=new Map;for(const[i,r]of l)o.set(Ye(i,e,t,n),r);return o}function Yf(l,e,t){const n=Mr(l);let o="=";for(const i of n)if(i.type==="REFERENCE"){const r=i.text;if(r.includes("!"))o+=r;else if(r.includes(":")){const[s,a]=r.split(":"),c=be(s.toUpperCase()),u=be(a.toUpperCase()),h={r:c.r+e,c:c.c+t},f={r:u.r+e,c:u.c+t};h.r<1||h.c<1||f.r<1||f.c<1?o+="#REF!":o+=fe(h)+":"+fe(f)}else{const s=be(r.toUpperCase()),a={r:s.r+e,c:s.c+t};a.r<1||a.c<1?o+="#REF!":o+=fe(a)}}else o+=i.text;return o}function Co(l,e,t,n){const o=e==="row"?l.r:l.c;if(n>0)return o>=t?e==="row"?{r:l.r+n,c:l.c}:{r:l.r,c:l.c+n}:l;const i=Math.abs(n);return o>=t&&o<t+i?null:o>=t+i?e==="row"?{r:l.r+n,c:l.c}:{r:l.r,c:l.c+n}:l}function Wg(l,e,t,n){const o=be(l),i=Co(o,e,t,n);return i?fe(i):null}function Gg(l,e,t,n){const o=Mr(l);let i="=";for(const r of o)if(r.type==="REFERENCE"){const s=r.text;if(s.includes("!"))i+=s;else if(s.includes(":")){const[a,c]=s.split(":"),u=be(a.toUpperCase()),h=be(c.toUpperCase()),f=Co(u,e,t,n),d=Co(h,e,t,n);!f||!d?i+="#REF!":i+=fe(f)+":"+fe(d)}else{const a=be(s.toUpperCase()),c=Co(a,e,t,n);c?i+=fe(c):i+="#REF!"}}else i+=r.text;return i}function Nr(l,e,t){const n=new Map;for(const[o,i]of l)if(t>0)o>=e?n.set(o+t,i):n.set(o,i);else{const r=Math.abs(t);o>=e&&o<e+r||(o>=e+r?n.set(o+t,i):n.set(o,i))}return n}function Yg(l,e,t,n){const o=new Map;for(const[i,r]of l){const s=Wg(i,e,t,n);if(s===null)continue;let a;r.f?a={...r,f:Gg(r.f,e,t,n)}:a={...r},o.set(s,a)}return o}const Xg=new Set(["isEmpty","isNotEmpty","textContains","greaterThan","between","dateBefore","dateAfter"]),Kg=new Set(["textContains","greaterThan","dateBefore","dateAfter"]);function Qg(l){return[{r:l[0].r,c:l[0].c},{r:l[1].r,c:l[1].c}]}function Jg(l){return Xg.has(l)}function ct(l){if(typeof l=="string")return l;if(l==null)return"";if(typeof l=="number"||typeof l=="boolean")return String(l);if(typeof l=="object"){const e=l;if(e.value!==void 0&&e.value!==l)return ct(e.value);if(typeof e.toJSON=="function")try{const t=e.toJSON.call(l);if(t!==l)return ct(t)}catch{}}return String(l)}function Zg(l){return qe(l[0],l[1])}function ki(l){if(!l)return;const e=l.trim().replace(/,/g,"");if(!e)return;const t=Number(e);return Number.isFinite(t)?t:void 0}function uo(l){if(!l)return;const e=l.trim();if(!e)return;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const o=Number(t[1]),i=Number(t[2]),r=Number(t[3]),s=new Date(o,i-1,r);return s.getFullYear()!==o||s.getMonth()!==i-1||s.getDate()!==r?void 0:s.getTime()}const n=new Date(e);if(!Number.isNaN(n.getTime()))return new Date(n.getFullYear(),n.getMonth(),n.getDate()).getTime()}function co(l,e,t){if(t>0)return l>=e?l+t:l;const n=Math.abs(t);return l>=e&&l<e+n?e:l>=e+n?l+t:l}function Tp(l){return qe({r:Math.max(1,l[0].r),c:Math.max(1,l[0].c)},{r:Math.max(1,l[1].r),c:Math.max(1,l[1].c)})}function Xf(l){if(typeof l!="string")return;const e=l.trim();return e.length>0?e:void 0}function ey(l){const e={};l.b!==void 0&&(e.b=l.b),l.i!==void 0&&(e.i=l.i),l.u!==void 0&&(e.u=l.u);const t=Xf(l.tc);t!==void 0&&(e.tc=t);const n=Xf(l.bg);return n!==void 0&&(e.bg=n),Object.keys(e).length>0?e:void 0}function li(l){const e={id:l.id,range:Qg(l.range),op:l.op,style:{...l.style}};return l.value!==void 0&&(e.value=l.value),l.value2!==void 0&&(e.value2=l.value2),e}function $o(l){const e=ct(l.id).trim();if(!e)return;const t=ct(l.op).trim();if(!Jg(t))return;const n=ey(l.style||{});if(!n)return;const o={id:e,range:Zg(l.range),op:t,style:n};if(Kg.has(t)){const i=ct(l.value).trim();return i?(o.value=i,o):void 0}if(t==="between"){const i=ct(l.value).trim(),r=ct(l.value2).trim();return!i||!r?void 0:(o.value=i,o.value2=r,o)}return o}function ty(l,e){const n=ct(l).trim();switch(e.op){case"isEmpty":return n.length===0;case"isNotEmpty":return n.length>0;case"textContains":{const o=ct(e.value).trim().toLowerCase();return o?n.toLowerCase().includes(o):!1}case"greaterThan":{const o=ki(n),i=ki(e.value);return o!==void 0&&i!==void 0&&o>i}case"between":{const o=ki(n),i=ki(e.value),r=ki(e.value2);if(o===void 0||i===void 0||r===void 0)return!1;const s=Math.min(i,r),a=Math.max(i,r);return o>=s&&o<=a}case"dateBefore":{const o=uo(n),i=uo(e.value);return o!==void 0&&i!==void 0&&o<i}case"dateAfter":{const o=uo(n),i=uo(e.value);return o!==void 0&&i!==void 0&&o>i}default:return!1}}function ry(l,e,t,n){if(l.length===0)return;const o={r:e,c:t},i=ct(n==null?void 0:n.v);let r;for(const s of l)mr(o,s.range)&&ty(i,s)&&(r={...r||{},...s.style});return r}function bp(l,e,t,n){const o=[];for(const i of l){const r=$o(i);if(!r)continue;const s=r.range,a=e==="row"?qe({r:co(s[0].r,t,n),c:s[0].c},{r:co(s[1].r,t,n),c:s[1].c}):qe({r:s[0].r,c:co(s[0].c,t,n)},{r:s[1].r,c:co(s[1].c,t,n)});o.push({...li(r),range:Tp(a)})}return o}function Np(l,e,t,n,o){const i=[];for(const r of l){const s=$o(r);if(!s)continue;const a=s.range,c=e==="row"?qe({r:Ye(a[0].r,t,n,o),c:a[0].c},{r:Ye(a[1].r,t,n,o),c:a[1].c}):qe({r:a[0].r,c:Ye(a[0].c,t,n,o)},{r:a[1].r,c:Ye(a[1].c,t,n,o)});i.push({...li(s),range:Tp(c)})}return i}function Rp(l){const e={};for(const t of Object.keys(l)){const n=l[t];n!==void 0&&(e[t]=n)}return Object.keys(e).length>0?e:void 0}function wp(l,e){const t=l?{...l}:{};let n=!1;for(const o of Object.keys(e)){const i=e[o];i!==void 0&&(t[o]=i,n=!0)}if(Object.keys(t).length!==0&&!(!l&&!n))return t}function _l(l){const e=Math.min(l[0].r,l[1].r),t=Math.min(l[0].c,l[1].c),n=Math.max(l[0].r,l[1].r),o=Math.max(l[0].c,l[1].c);return[{r:e,c:t},{r:n,c:o}]}function Gi(l){return{range:_l(l.range),style:{...l.style}}}function gr(l){const e=Rp(l.style);if(e)return{range:_l(l.range),style:e}}function Yi(l,e){const t=Object.keys(l),n=Object.keys(e);if(t.length!==n.length)return!1;for(const o of t)if(l[o]!==e[o])return!1;return!0}function ny(l,e){return l[0].r<=e[0].r&&l[0].c<=e[0].c&&l[1].r>=e[1].r&&l[1].c>=e[1].c}function Tl(l){const e=[];for(let t=l.length-1;t>=0;t--){const n=gr(l[t]);if(!n)continue;let o=!1;for(const i of e)if(Yi(i.style,n.style)&&ny(i.range,n.range)){o=!0;break}o||e.push(Gi(n))}return e.reverse()}function Op(l){if(l.length<=1)return l;const e=[...l].sort((n,o)=>n[0]-o[0]),t=[];for(const n of e){const o=t[t.length-1];if(!o){t.push([n[0],n[1]]);continue}if(n[0]<=o[1]+1){o[1]=Math.max(o[1],n[1]);continue}t.push([n[0],n[1]])}return t}function Kf(l,e,t,n){if(n===0)return[[l,e]];if(n>0)return e<t?[[l,e]]:l>=t?[[l+n,e+n]]:[[l,e+n]];const o=Math.abs(n),i=t+o-1,r=[];return l<t&&r.push([l,Math.min(e,t-1)]),e>i&&r.push([Math.max(l,i+1)+n,e+n]),Op(r.filter(([s,a])=>s<=a))}function Qf(l,e,t,n,o){const i=t+n,r=[];o<=t?(r.push({start:Number.NEGATIVE_INFINITY,end:o-1,delta:0}),r.push({start:o,end:t-1,delta:n}),r.push({start:t,end:i-1,delta:o-t}),r.push({start:i,end:Number.POSITIVE_INFINITY,delta:0})):(r.push({start:Number.NEGATIVE_INFINITY,end:t-1,delta:0}),r.push({start:t,end:i-1,delta:o-n-t}),r.push({start:i,end:o-1,delta:-n}),r.push({start:o,end:Number.POSITIVE_INFINITY,delta:0}));const s=[];for(const a of r){const c=Math.max(l,a.start),u=Math.min(e,a.end);c>u||s.push([c+a.delta,u+a.delta])}return Op(s)}function Fp(l,e,t){const n=[];for(const[o,i]of t){if(e==="row"){n.push({range:[{r:o,c:l.range[0].c},{r:i,c:l.range[1].c}],style:{...l.style}});continue}n.push({range:[{r:l.range[0].r,c:o},{r:l.range[1].r,c:i}],style:{...l.style}})}return n}function Pp(l,e){if(l.length<=1)return l.map(Gi);const t=[];for(const n of l){const o=gr(n);if(!o)continue;const i=t[t.length-1];if(!i||!Yi(i.style,o.style)){t.push(o);continue}if(e==="row"){const a=i.range[0].c===o.range[0].c&&i.range[1].c===o.range[1].c,c=o.range[0].r<=i.range[1].r+1;if(!a||!c){t.push(o);continue}i.range[0].r=Math.min(i.range[0].r,o.range[0].r),i.range[1].r=Math.max(i.range[1].r,o.range[1].r);continue}const r=i.range[0].r===o.range[0].r&&i.range[1].r===o.range[1].r,s=o.range[0].c<=i.range[1].c+1;if(!r||!s){t.push(o);continue}i.range[0].c=Math.min(i.range[0].c,o.range[0].c),i.range[1].c=Math.max(i.range[1].c,o.range[1].c)}return t}function Ip(l,e,t,n){const o=[];for(const i of l){const r=gr(i);if(!r)continue;const s=e==="row"?Kf(r.range[0].r,r.range[1].r,t,n):Kf(r.range[0].c,r.range[1].c,t,n);o.push(...Fp(r,e,s))}return Tl(Pp(o,e))}function Dp(l,e,t,n,o){const i=[];for(const r of l){const s=gr(r);if(!s)continue;const a=e==="row"?Qf(s.range[0].r,s.range[1].r,t,n,o):Qf(s.range[0].c,s.range[1].c,t,n,o);i.push(...Fp(s,e,a))}return Tl(Pp(i,e))}function iy(l,e){const t=_l(e),n=[];for(const o of l){const i=gr(o);if(!i)continue;const r=Math.max(i.range[0].r,t[0].r),s=Math.min(i.range[1].r,t[1].r),a=Math.max(i.range[0].c,t[0].c),c=Math.min(i.range[1].c,t[1].c);r>s||a>c||n.push({range:[{r,c:a},{r:s,c}],style:{...i.style}})}return n}function oy(l,e,t){const n=[];for(const o of l){const i=gr(o);if(!i)continue;const r=i.range[0].r+e,s=i.range[1].r+e,a=i.range[0].c+t,c=i.range[1].c+t;s<1||c<1||n.push({range:[{r:Math.max(1,r),c:Math.max(1,a)},{r:Math.max(1,s),c:Math.max(1,c)}],style:{...i.style}})}return n}function Lp(l,e,t){let n;for(const o of l)e<o.range[0].r||e>o.range[1].r||t<o.range[0].c||t>o.range[1].c||(n=wp(n,o.style));return n}function zi(l,e){return[{r:l.r,c:l.c},{r:l.r+e.rs-1,c:l.c+e.cs-1}]}function Jf(l,e,t,n){if(n>0)return t<=l?[l+n,e+n]:t<=e?[l,e+n]:[l,e];const o=Math.abs(n),i=t,r=t+o-1;if(r<l)return[l+n,e+n];if(i>e)return[l,e];const s=Math.max(l,i),c=Math.min(e,r)-s+1,u=e-l+1-c;return u<=0?null:i<=l?[i,i+u-1]:[l,l+u-1]}function sy(l,e,t,n,o){const i=Jf(l.r,l.r+e.rs-1,t==="row"?n:Number.NEGATIVE_INFINITY,t==="row"?o:0);if(!i)return null;const r=Jf(l.c,l.c+e.cs-1,t==="column"?n:Number.NEGATIVE_INFINITY,t==="column"?o:0);if(!r)return null;const[s,a]=i,[c,u]=r,h=a-s+1,f=u-c+1;return h<=1&&f<=1?null:{anchor:{r:s,c},span:{rs:h,cs:f}}}function ay(l,e,t,n,o,i){const r=t==="row"?l.r+e.rs-1:l.c+e.cs-1,s=t==="row"?l.r:l.c,a=Ye(s,n,o,i),c=Ye(r,n,o,i),u=Math.min(a,c),f=Math.max(a,c)-u+1;if(t==="row"){const y=f,m=e.cs;return y<=1&&m<=1?null:{anchor:{r:u,c:l.c},span:{rs:y,cs:m}}}const d=e.rs,p=f;return d<=1&&p<=1?null:{anchor:{r:l.r,c:u},span:{rs:d,cs:p}}}function Mp(l,e,t,n){const o=new Map;for(const[i,r]of l){const s=be(i),a=sy(s,r,e,t,n);a&&o.set(fe(a.anchor),a.span)}return o}function Bp(l,e,t,n,o){const i=new Map;for(const[r,s]of l){const a=be(r),c=ay(a,s,e,t,n,o);c&&i.set(fe(c.anchor),c.span)}return i}function ly(l,e,t,n,o){const i=t==="row"?l.r:l.c,r=t==="row"?l.r+e.rs-1:l.c+e.cs-1,s=n+o-1;return r<n||i>s?!1:!(i>=n&&r<=s)}class Zf{constructor(e){B(this,"customSizes");B(this,"defaultSize");B(this,"cacheDirty",!0);B(this,"sortedIndices",[]);B(this,"sortedSizes",[]);B(this,"prefixDeltas",[]);B(this,"customStarts",[]);this.defaultSize=e,this.customSizes=new Map}getSize(e){return this.customSizes.get(e)??this.defaultSize}setSize(e,t){t===this.defaultSize?this.customSizes.delete(e):this.customSizes.set(e,t),this.cacheDirty=!0}getDefaultSize(){return this.defaultSize}getOffset(e){let t=(e-1)*this.defaultSize;if(this.customSizes.size===0)return t;this.ensureCache();const n=this.lowerBound(this.sortedIndices,e)-1;return n>=0&&(t+=this.prefixDeltas[n]),t}findIndex(e){if(e<0)return 1;if(this.customSizes.size===0)return Math.floor(e/this.defaultSize)+1;this.ensureCache();const t=this.customStarts[0];if(e<t)return Math.floor(e/this.defaultSize)+1;const n=this.upperBound(this.customStarts,e)-1,o=this.sortedIndices[n],i=this.customStarts[n],r=this.sortedSizes[n];if(e<i+r)return o;const s=e-(i+r);return o+1+Math.floor(s/this.defaultSize)}shift(e,t){const n=new Map;for(const[o,i]of this.customSizes)if(t>0)o>=e?n.set(o+t,i):n.set(o,i);else{const r=Math.abs(t);o>=e&&o<e+r||(o>=e+r?n.set(o+t,i):n.set(o,i))}this.customSizes=n,this.cacheDirty=!0}move(e,t,n){const o=new Map;for(const[i,r]of this.customSizes)o.set(Ye(i,e,t,n),r);this.customSizes=o,this.cacheDirty=!0}clear(){this.customSizes.clear(),this.cacheDirty=!0}hasCustomSizes(){return this.customSizes.size>0}ensureCache(){if(!this.cacheDirty)return;if(this.customSizes.size===0){this.sortedIndices=[],this.sortedSizes=[],this.prefixDeltas=[],this.customStarts=[],this.cacheDirty=!1;return}const e=Array.from(this.customSizes.entries()).sort((n,o)=>n[0]-o[0]);this.sortedIndices=[],this.sortedSizes=[],this.prefixDeltas=[],this.customStarts=[];let t=0;for(const[n,o]of e)this.sortedIndices.push(n),this.sortedSizes.push(o),this.customStarts.push((n-1)*this.defaultSize+t),t+=o-this.defaultSize,this.prefixDeltas.push(t);this.cacheDirty=!1}lowerBound(e,t){let n=0,o=e.length;for(;n<o;){const i=n+Math.floor((o-n)/2);e[i]<t?n=i+1:o=i}return n}upperBound(e,t){let n=0,o=e.length;for(;n<o;){const i=n+Math.floor((o-n)/2);e[i]<=t?n=i+1:o=i}return n}}class uy{constructor(){B(this,"rowIndex",new Map);B(this,"colIndex",new Map)}add(e,t){let n=this.rowIndex.get(e);n||(n=new Set,this.rowIndex.set(e,n)),n.add(t);let o=this.colIndex.get(t);o||(o=new Set,this.colIndex.set(t,o)),o.add(e)}remove(e,t){const n=this.rowIndex.get(e);n&&(n.delete(t),n.size===0&&this.rowIndex.delete(e));const o=this.colIndex.get(t);o&&(o.delete(e),o.size===0&&this.colIndex.delete(t))}has(e,t){const n=this.rowIndex.get(e);return n!==void 0&&n.has(t)}clear(){this.rowIndex.clear(),this.colIndex.clear()}rebuild(e){this.clear();for(const[t,n]of e)this.add(t,n)}*cellsInRange(e){const[t,n]=e;for(const[o,i]of this.rowIndex)if(!(o<t.r||o>n.r))for(const r of i)r>=t.c&&r<=n.c&&(yield[o,r])}hasAnyInRange(e){return!this.cellsInRange(e).next().done}getOccupiedColsInRow(e){return this.rowIndex.get(e)}getOccupiedRowsInCol(e){return this.colIndex.get(e)}get size(){let e=0;for(const t of this.rowIndex.values())e+=t.size;return e}}function cy(l,e,t,n,o){const i=t==="left"||t==="right",r=t==="down"||t==="right",s=i?e.c:e.r,a=i?n[0].c:n[0].r,c=i?n[1].c:n[1].r,u=i?l.getOccupiedColsInRow(e.r):l.getOccupiedRowsInCol(e.c);let h;if(u&&o){const v=new Set;for(const x of u){const g=i?e.r:x,S=i?x:e.c;o(g,S)&&v.add(x)}h=v.size>0?v:void 0}else h=u;if(!h||h.size===0)return ed(e,t,n);const f=Array.from(h).sort((v,x)=>v-x);r||f.reverse();const d=r?f.filter(v=>v>s):f.filter(v=>v<s),p=h.has(s),y=r?s+1:s-1,m=mr(i?{r:e.r,c:y}:{r:y,c:e.c},n)&&h.has(y);if(p&&m){let v=s,x=y;for(;(r?x<=c:x>=a)&&h.has(x);)v=x,x=r?x+1:x-1;return i?{r:e.r,c:v}:{r:v,c:e.c}}if(d.length>0){const v=d[0];return i?{r:e.r,c:v}:{r:v,c:e.c}}return ed(e,t,n)}function ed(l,e,t){switch(e){case"up":return{r:t[0].r,c:l.c};case"down":return{r:t[1].r,c:l.c};case"left":return{r:l.r,c:t[0].c};case"right":return{r:l.r,c:t[1].c}}}async function Sr(l,e,t){const[n,o]=hy(e,t);for(const i of n){const r=be(i);if(!await l.hasFormula(r))continue;const s=await l.getCell(r);if(o.has(i)){await l.setCell(r,{v:"#REF!",f:s.f,s:s.s});continue}const a=_p(s.f),c=await l.fetchGridByReferences(a),u=await Ug(s.f,c);await l.setCell(r,{v:u,f:s.f,s:s.s})}}function hy(l,e){const t=[],n=new Set,o=new Set,i=new Set,r=s=>{if(i.has(s))for(const a of i)n.add(a);if(i.add(s),!o.has(s)){if(o.add(s),l.has(s))for(const a of l.get(s))r(a);t.push(s)}i.delete(s)};for(const s of e)r(s);return[t.reverse(),n]}function fy(l){let e=1/0,t=1/0,n=0,o=0;for(const[r]of l.entries()){const{r:s,c:a}=be(r);e=Math.min(e,s),t=Math.min(t,a),n=Math.max(n,s),o=Math.max(o,a)}const i=Array.from({length:n-e+1},()=>Array(o-t+1).fill(""));for(const[r,s]of l.entries()){const{r:a,c}=be(r);i[a-e][c-t]=s.v||s.f||""}return i.map(r=>r.join("	")).join(`
`)}function dy(l,e){let t=l.r,n=l.c;const o=new Map,i=e.split(`
`);for(const r of i){const s=r.split("	");for(const a of s)o.set(fe({r:t,c:n}),{v:a}),n+=1;t+=1,n=l.c}return o}function td(l){const e=l.match(/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/);if(!e)return;const t=parseInt(e[1],10),n=parseInt(e[2],10),o=parseInt(e[3],10);if(!(t===255&&n===255&&o===255))return"#"+t.toString(16).padStart(2,"0")+n.toString(16).padStart(2,"0")+o.toString(16).padStart(2,"0")}function py(l){return l.includes("google-sheets-html-origin")||l.includes("data-sheets-value")||l.includes("urn:schemas-microsoft-com:office:excel")||l.includes('xmlns:x="urn:schemas-microsoft-com:office:excel"')}function my(l,e){const o=new DOMParser().parseFromString(l,"text/html").querySelector("table");if(!o)return new Map;const i=new Map,r=o.querySelectorAll("tr");for(let s=0;s<r.length;s++){const a=r[s].querySelectorAll("td, th");for(let c=0;c<a.length;c++){const u=a[c],h=u.textContent||"";if(!h&&!u.style.cssText)continue;const f={v:h},d={};let p=!1;const y=u.style.fontWeight;if((y==="bold"||y==="700")&&(d.b=!0,p=!0),u.style.fontStyle==="italic"&&(d.i=!0,p=!0),u.style.backgroundColor){const m=td(u.style.backgroundColor);m&&(d.bg=m,p=!0)}if(u.style.color){const m=td(u.style.color);m&&(d.tc=m,p=!0)}if(u.style.textAlign){const m=u.style.textAlign;(m==="left"||m==="center"||m==="right")&&(d.al=m,p=!0)}p&&(f.s=d),i.set(fe({r:e.r+s,c:e.c+c}),f)}}return i}const kp="en-US",rd="USD",xy=new Set(["AT","BE","CY","DE","EE","ES","FI","FR","GR","HR","IE","IT","LT","LU","LV","MT","NL","PT","SI","SK"]),gy={AE:"AED",AR:"ARS",AU:"AUD",BD:"BDT",BR:"BRL",CA:"CAD",CH:"CHF",CL:"CLP",CN:"CNY",CO:"COP",CZ:"CZK",DK:"DKK",EG:"EGP",GB:"GBP",HK:"HKD",HU:"HUF",ID:"IDR",IL:"ILS",IN:"INR",JP:"JPY",KE:"KES",KR:"KRW",KW:"KWD",MX:"MXN",MY:"MYR",NG:"NGN",NO:"NOK",NZ:"NZD",PE:"PEN",PH:"PHP",PK:"PKR",PL:"PLN",QA:"QAR",RO:"RON",RU:"RUB",SA:"SAR",SE:"SEK",SG:"SGD",TH:"THB",TR:"TRY",TW:"TWD",UA:"UAH",US:"USD",VN:"VND",ZA:"ZAR"},nd=new Map;function bl(l){return l&&l.trim()?l.trim():typeof navigator<"u"&&navigator.language?navigator.language:Intl.DateTimeFormat().resolvedOptions().locale||kp}function yy(l){const[e]=l.replace(/_/g,"-").split("-u-"),t=e.split("-").filter(Boolean);for(let n=1;n<t.length;n++){const o=t[n];if(/^[a-z]{2}$/i.test(o))return o.toUpperCase()}try{const n=new Intl.Locale(l).maximize().region;if(n)return n.toUpperCase()}catch{}}function Oa(l,e,t){try{return new Intl.NumberFormat(e,t).format(l)}catch{return new Intl.NumberFormat(kp,t).format(l)}}function vy(l,e){const t=String(l.getFullYear()).padStart(4,"0"),n=String(l.getMonth()+1).padStart(2,"0"),o=String(l.getDate()).padStart(2,"0");return`${t}-${n}-${o}`}function Sy(){return bl()}function zp(l){const e=bl(l),t=nd.get(e);if(t)return t;const n=yy(e);let o=rd;return n&&(o=xy.has(n)?"EUR":gy[n]??rd),nd.set(e,o),o}function JS(l){const e=bl(l),t=zp(e);return{locale:e,currency:t,number:Oa(1234.56,e,{minimumFractionDigits:2,maximumFractionDigits:2}),currencyValue:Oa(1234.56,e,{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}),percent:Oa(.1234,e,{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),date:vy(new Date(2026,1,18))}}function ho(l,e,t){try{return l.toLocaleString(e,t)}catch{return l.toLocaleString("en-US",t)}}function Ay(l){const e=l.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(e){const n=Number(e[1]),o=Number(e[2]),i=Number(e[3]),r=new Date(n,o-1,i);return r.getFullYear()===n&&r.getMonth()===o-1&&r.getDate()===i?r:void 0}const t=new Date(l);if(!isNaN(t.getTime()))return t}function Cy(l,e){const t=Ay(l);if(!t)return l;const n=String(t.getFullYear()).padStart(4,"0"),o=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${n}-${o}-${i}`}function qa(l,e,t,n){if(!e||e==="plain"||l==="")return l;const o=t??2,i=(n==null?void 0:n.locale)??Sy(),r=(n==null?void 0:n.currency)??zp(i);switch(e){case"number":{const s=Number(l);return isNaN(s)?l:ho(s,i,{minimumFractionDigits:o,maximumFractionDigits:o})}case"currency":{const s=Number(l);return isNaN(s)?l:t===void 0?ho(s,i,{style:"currency",currency:r}):ho(s,i,{style:"currency",currency:r,minimumFractionDigits:o,maximumFractionDigits:o})}case"percent":{const s=Number(l);return isNaN(s)?l:ho(s,i,{style:"percent",minimumFractionDigits:o,maximumFractionDigits:o})}case"date":return Cy(l);default:return l}}const Ey={$:"USD","":"KRW"};function id(l){return l.length>1&&l.startsWith("0")}function _y(l){if(!l.includes(","))return/^\d+$/.test(l)?l:void 0;const e=l.split(",");if(/^\d{1,3}$/.test(e[0])){for(let t=1;t<e.length;t++)if(!/^\d{3}$/.test(e[t]))return;return e.join("")}}function Nl(l,e){if(l.length===0||/\s/.test(l))return;if(e.allowExponent&&/[eE]/.test(l)){const n=l.match(/^([+-])?(\d+(?:\.\d+)?|\.\d+)[eE]([+-]?\d+)$/);if(!n)return;const o=n[1]??"",i=n[2],r=n[3],s=i.startsWith(".")?"0":i.split(".")[0];if(!e.allowPaddedInteger&&id(s))return;const a=+`${o}${i}e${r}`;return Number.isFinite(a)?a:void 0}const t=l.match(/^([+-])?(\d[\d,]*)(?:\.(\d*))?$/);if(t){const n=t[1]??"",o=t[2],i=t[3],r=_y(o);if(!r||!e.allowPaddedInteger&&id(r))return;const s=i!==void 0?`${n}${r}.${i}`:`${n}${r}`,a=Number(s);return Number.isFinite(a)?a:void 0}if(e.allowLeadingDot){const n=l.match(/^([+-])?\.(\d+)$/);if(!n)return;const o=n[1]??"",i=n[2],r=+`${o}0.${i}`;return Number.isFinite(r)?r:void 0}}function jp(l,e,t){const n=new Date(l,e-1,t);if(!(n.getFullYear()!==l||n.getMonth()!==e-1||n.getDate()!==t))return`${String(l).padStart(4,"0")}-${String(e).padStart(2,"0")}-${String(t).padStart(2,"0")}`}function Ty(l){const e=l.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!e)return;const t=Number(e[1]),n=Number(e[2]),o=Number(e[3]);return jp(t,n,o)}function by(l,e){const t=l.match(/^(\d{1,2})\/(\d{1,2})$/);if(!t)return;const n=Number(t[1]),o=Number(t[2]);return jp(e,n,o)}function Ny(l){const e=l.match(/^([+-])?\s*([$])\s*([0-9][0-9,]*(?:\.[0-9]+)?|\.\d+)$/);if(!e)return;const t=e[1]??"",n=e[2],o=e[3],i=Nl(`${t}${o}`,{allowExponent:!1,allowLeadingDot:!0,allowPaddedInteger:!0});if(i!==void 0)return{code:Ey[n],value:i}}function Ry(l){const e=l.match(/^([+-])?\s*([0-9][0-9,]*(?:\.[0-9]+)?|\.\d+)\s*%$/);if(!e)return;const t=e[1]??"",n=e[2],o=Nl(`${t}${n}`,{allowExponent:!1,allowLeadingDot:!0,allowPaddedInteger:!0});if(o!==void 0)return o/100}function od(l,e){const t=l.trim();if(t.startsWith("="))return{type:"formula",value:t.slice(1).trimStart()};const n=t.toLowerCase();if(n==="true")return{type:"boolean",value:!0};if(n==="false")return{type:"boolean",value:!1};const o=Ny(t);if(o)return{type:"number",value:o.value,format:`currency:${o.code}`};const i=Ry(t);if(i!==void 0)return{type:"number",value:i,format:"percent"};const r=Ty(t);if(r)return{type:"date",value:r,format:"yyyy-mm-dd"};const s=new Date().getFullYear(),a=by(t,s);if(a)return{type:"date",value:a,format:"yyyy-mm-dd"};const c=Nl(t,{allowExponent:!0,allowLeadingDot:!0,allowPaddedInteger:!1});return c!==void 0?{type:"number",value:c}:{type:"text",value:t}}const wy={rows:1e6,columns:18278},Oy=5e4,Fy={b:!1,i:!1,u:!1,st:!1,bt:!1,br:!1,bb:!1,bl:!1,al:"left",va:"top",nf:"plain",dp:2};class Py{constructor(e){B(this,"store");B(this,"dimension");B(this,"activeCell");B(this,"range");B(this,"selectionType","cell");B(this,"rowDimensions");B(this,"colDimensions");B(this,"frozenRows",0);B(this,"frozenCols",0);B(this,"colStyles",new Map);B(this,"rowStyles",new Map);B(this,"sheetStyle");B(this,"rangeStyles",[]);B(this,"conditionalFormats",[]);B(this,"merges",new Map);B(this,"mergeCoverMap",new Map);B(this,"filterRange");B(this,"filterColumns",new Map);B(this,"hiddenRows",new Set);B(this,"copyBuffer");B(this,"gridResolver");this.store=e,this.dimension={...wy},this.activeCell={r:1,c:1}}get dimensionRange(){return[{r:1,c:1},{r:this.dimension.rows,c:this.dimension.columns}]}getDimension(){return this.dimension}setDimensions(e,t){this.rowDimensions=e,this.colDimensions=t}getRowDimensions(){return this.rowDimensions}getColDimensions(){return this.colDimensions}setRowHeight(e,t){var n;(n=this.rowDimensions)==null||n.setSize(e,t),this.store.setDimensionSize("row",e,t)}setColumnWidth(e,t){var n;(n=this.colDimensions)==null||n.setSize(e,t),this.store.setDimensionSize("column",e,t)}async loadDimensions(){if(this.rowDimensions){this.rowDimensions.clear();const e=await this.store.getDimensionSizes("row");for(const[t,n]of e)this.rowDimensions.setSize(t,n)}if(this.colDimensions){this.colDimensions.clear();const e=await this.store.getDimensionSizes("column");for(const[t,n]of e)this.colDimensions.setSize(t,n)}}getFreezePane(){return{frozenRows:this.frozenRows,frozenCols:this.frozenCols}}async setFreezePane(e,t){this.frozenRows=e,this.frozenCols=t,await this.store.setFreezePane(e,t)}async loadFreezePane(){const{frozenRows:e,frozenCols:t}=await this.store.getFreezePane();this.frozenRows=e,this.frozenCols=t}async loadStyles(){this.colStyles=await this.store.getColumnStyles(),this.rowStyles=await this.store.getRowStyles(),this.sheetStyle=await this.store.getSheetStyle(),this.rangeStyles=await this.store.getRangeStyles(),this.conditionalFormats=await this.store.getConditionalFormats()}async loadMerges(){this.merges=await this.store.getMerges(),this.rebuildMergeCoverMap()}async loadFilterState(){const e=await this.store.getFilterState();if(!e){this.filterRange=void 0,this.filterColumns.clear(),this.hiddenRows.clear();return}this.filterRange=qe(e.range[0],e.range[1]),this.filterColumns=new Map;for(const[t,n]of Object.entries(e.columns)){const o=Number(t);Number.isFinite(o)&&this.filterColumns.set(o,{...n})}this.normalizeFilterColumnsToRange(),this.hiddenRows=new Set(e.hiddenRows.filter(t=>t>0)),this.pruneHiddenRowsOutsideFilter(),this.ensureActiveCellVisibleAfterFiltering()}hasFilter(){return!!this.filterRange}getFilterRange(){return this.filterRange?st(this.filterRange):void 0}getHiddenRows(){return new Set(this.hiddenRows)}getFilteredColumns(){return new Set(this.filterColumns.keys())}getColumnFilterCondition(e){const t=this.filterColumns.get(e);if(t)return{...t,values:t.values?[...t.values]:void 0}}isColumnInFilter(e){return this.filterRange?e>=this.filterRange[0].c&&e<=this.filterRange[1].c:!1}getFilterState(){return this.buildFilterStatePayload()}getColStyles(){return this.colStyles}getRowStyles(){return this.rowStyles}getSheetStyle(){return this.sheetStyle}getRangeStyles(){return this.rangeStyles.map(e=>({range:st(e.range),style:{...e.style}}))}getConditionalFormats(){return this.conditionalFormats.map(e=>li(e))}getMerges(){return this.merges}rebuildMergeCoverMap(){this.mergeCoverMap.clear();for(const[e,t]of this.merges){const n=be(e);for(let o=n.r;o<n.r+t.rs;o++)for(let i=n.c;i<n.c+t.cs;i++){const r=fe({r:o,c:i});r!==e&&this.mergeCoverMap.set(r,e)}}}getAnchorSrefForRef(e){const t=fe(e);return this.merges.has(t)?t:this.mergeCoverMap.get(t)||t}normalizeRefToAnchor(e){return be(this.getAnchorSrefForRef(e))}getMergeForRef(e){const t=this.getAnchorSrefForRef(e),n=this.merges.get(t);if(!n)return;const o=be(t);return{anchorSref:t,anchor:o,span:n,range:zi(o,n)}}expandRangeToMergedBoundaries(e){let t=st(e),n=!0;for(;n;){n=!1;for(const[o,i]of this.merges){const r=zi(be(o),i);if(!mr(r[0],t)&&!mr(r[1],t)&&!(r[0].r<=t[1].r&&r[1].r>=t[0].r&&r[0].c<=t[1].c&&r[1].c>=t[0].c))continue;const s=wa(t,r);Er(s,t)||(t=s,n=!0)}}return t}*mergeCoveredSrefs(e,t){for(let n=e.r;n<e.r+t.rs;n++)for(let o=e.c;o<e.c+t.cs;o++)yield fe({r:n,c:o})}expandChangedSrefsWithMergeAliases(e){const t=new Set;for(const n of e){const o=this.getAnchorSrefForRef(be(n)),i=this.merges.get(o);if(!i){t.add(n);continue}const r=be(o);for(const s of this.mergeCoveredSrefs(r,i))t.add(s)}return t}getMergesIntersecting(e){const t=[];for(const[n,o]of this.merges){const i=be(n),r=zi(i,o);r[0].r<=e[1].r&&r[1].r>=e[0].r&&r[0].c<=e[1].c&&r[1].c>=e[0].c&&t.push({anchorSref:n,anchor:i,span:o,range:r})}return t}resolveEffectiveStyle(e,t,n){const o=this.sheetStyle,i=this.colStyles.get(t),r=this.rowStyles.get(e),s=Lp(this.rangeStyles,e,t);if(!(!o&&!i&&!r&&!s&&!n))return{...o,...i,...r,...s,...n}}async getCell(e){return this.store.get(this.normalizeRefToAnchor(e))}async setCell(e,t){await this.store.set(this.normalizeRefToAnchor(e),t)}async setGrid(e){await this.store.setGrid(e)}async hasFormula(e){const t=await this.getCell(e);return!!(t&&t.f)}async toInputString(e){const t=await this.getCell(e);return t?t.f?t.f:t.v||"":""}async toDisplayString(e){const t=this.normalizeRefToAnchor(e),n=await this.store.get(t);if(!n||!n.v)return"";const o=this.resolveEffectiveStyle(t.r,t.c,n.s);return qa(n.v,o==null?void 0:o.nf,o==null?void 0:o.dp,{currency:o==null?void 0:o.cu})}toStoredValue(e){switch(e.type){case"number":return e.value.toString();case"date":case"text":return e.value;case"boolean":return e.value?"TRUE":"FALSE"}}applyInferredFormat(e,t){var n;if(t.type==="date"){const o={...e||{},nf:"date"};return delete o.cu,o}if(t.type==="number"&&t.format==="percent"){const o={...e||{},nf:"percent"};return delete o.cu,o}return t.type==="number"&&((n=t.format)!=null&&n.startsWith("currency:"))?{...e||{},nf:"currency",cu:t.format.slice(9)}:e?{...e}:void 0}applyInputInferenceToGrid(e){const t=new Map;for(const[n,o]of e){if(o.f){t.set(n,{...o});continue}const i=od(o.v??""),r=this.applyInferredFormat(o.s,i),s=i.type==="formula"?{f:`=${i.value}`}:{v:this.toStoredValue(i)};t.set(n,this.compactCell(s,r))}return t}async setData(e,t){const n=this.normalizeRefToAnchor(e);this.store.beginBatch();try{const o=await this.store.get(n),i=od(t),r=this.applyInferredFormat(o==null?void 0:o.s,i),s=i.type==="formula"?{f:`=${i.value}`}:{v:this.toStoredValue(i)},a=this.compactCell(s,r);this.isEmptyCell(a)?await this.store.delete(n):await this.store.set(n,a);const c=this.expandChangedSrefsWithMergeAliases([fe(n)]),u=await this.store.buildDependantsMap(c);await Sr(this,u,c),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}async removeData(){this.store.beginBatch();try{const e=this.getRangeOrActiveCell(),t=await this.store.getGrid(e),n=new Set;for(const[r,s]of t){const a=be(r);s.s&&Object.keys(s.s).length>0?await this.store.set(a,{s:s.s}):await this.store.delete(a),n.add(r)}if(n.size===0)return!1;const o=this.expandChangedSrefsWithMergeAliases(n),i=await this.store.buildDependantsMap(o);return await Sr(this,i,o),this.filterRange&&await this.recomputeFilterHiddenRows(),!0}finally{this.store.endBatch()}}async insertRows(e,t=1){await this.shiftCells("row",e,t)}async deleteRows(e,t=1){await this.shiftCells("row",e,-t)}async insertColumns(e,t=1){await this.shiftCells("column",e,t)}async deleteColumns(e,t=1){await this.shiftCells("column",e,-t)}async moveRows(e,t,n){await this.moveCells("row",e,t,n)}async moveColumns(e,t,n){await this.moveCells("column",e,t,n)}async shiftCells(e,t,n){var i,r;await this.store.shiftCells(e,t,n),e==="row"?((i=this.rowDimensions)==null||i.shift(t,n),this.rowStyles=Nr(this.rowStyles,t,n)):((r=this.colDimensions)==null||r.shift(t,n),this.colStyles=Nr(this.colStyles,t,n)),this.rangeStyles=Ip(this.rangeStyles,e,t,n),this.conditionalFormats=bp(this.conditionalFormats,e,t,n),this.merges=Mp(this.merges,e,t,n),this.rebuildMergeCoverMap(),this.shiftFilterState(e,t,n);const o=e==="row"?this.activeCell.r:this.activeCell.c;if(n>0&&o>=t)e==="row"?this.activeCell={r:this.activeCell.r+n,c:this.activeCell.c}:this.activeCell={r:this.activeCell.r,c:this.activeCell.c+n};else if(n<0){const s=Math.abs(n);o>=t&&o<t+s?e==="row"?this.activeCell={r:Math.max(1,t),c:this.activeCell.c}:this.activeCell={r:this.activeCell.r,c:Math.max(1,t)}:o>=t+s&&(e==="row"?this.activeCell={r:this.activeCell.r+n,c:this.activeCell.c}:this.activeCell={r:this.activeCell.r,c:this.activeCell.c+n})}this.activeCell=this.normalizeRefToAnchor(this.activeCell),this.store.beginBatch();try{const s=e==="row"?this.frozenRows:this.frozenCols;if(s>0){if(n>0&&t<=s){const a=s+n;e==="row"?this.frozenRows=a:this.frozenCols=a,await this.store.setFreezePane(this.frozenRows,this.frozenCols)}else if(n<0){const a=Math.abs(n);if(t<=s){const c=Math.min(a,s-t+1),u=Math.max(0,s-c);e==="row"?this.frozenRows=u:this.frozenCols=u,await this.store.setFreezePane(this.frozenRows,this.frozenCols)}}}await this.recalculateAllFormulaCells(),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}async moveCells(e,t,n,o,i){var r,s;if(!(o>=t&&o<=t+n)){for(const[a,c]of this.merges){const u=be(a);if(ly(u,c,e,t,n))return}if(await this.store.moveCells(e,t,n,o),e==="row"?((r=this.rowDimensions)==null||r.move(t,n,o),this.rowStyles=br(this.rowStyles,t,n,o)):((s=this.colDimensions)==null||s.move(t,n,o),this.colStyles=br(this.colStyles,t,n,o)),this.rangeStyles=Dp(this.rangeStyles,e,t,n,o),this.conditionalFormats=Np(this.conditionalFormats,e,t,n,o),this.merges=Bp(this.merges,e,t,n,o),this.rebuildMergeCoverMap(),this.moveFilterState(e,t,n,o),this.activeCell=this.normalizeRefToAnchor(Vn(this.activeCell,e,t,n,o)),this.range&&(this.range=this.expandRangeToMergedBoundaries([Vn(this.range[0],e,t,n,o),Vn(this.range[1],e,t,n,o)])),!(i!=null&&i.skipPostRecalculate)){this.store.beginBatch();try{await this.recalculateAllFormulaCells(),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}}}async recalculateAllFormulaCells(){const e=new Set,t=[{r:1,c:1},{r:1e3,c:100}],n=await this.store.getGrid(t);for(const[o,i]of n)i.f&&e.add(o);if(e.size>0){const o=await this.store.buildDependantsMap(e);await Sr(this,o,e)}}buildFilterStatePayload(){if(!this.filterRange)return;const e={},t=Array.from(this.filterColumns.entries()).sort((n,o)=>n[0]-o[0]);for(const[n,o]of t)this.isColumnInFilter(n)&&(e[String(n)]={...o});return{range:st(this.filterRange),columns:e,hiddenRows:Array.from(this.hiddenRows).sort((n,o)=>n-o)}}normalizeFilterColumnsToRange(){if(!this.filterRange){this.filterColumns.clear();return}for(const e of this.filterColumns.keys())this.isColumnInFilter(e)||this.filterColumns.delete(e)}pruneHiddenRowsOutsideFilter(){if(!this.filterRange){this.hiddenRows.clear();return}const e=this.filterRange[0].r+1,t=this.filterRange[1].r,n=new Set;for(const o of this.hiddenRows)o>=e&&o<=t&&n.add(o);this.hiddenRows=n}normalizeFilterText(e){if(typeof e=="string")return e;if(e==null)return"";if(typeof e=="number"||typeof e=="boolean")return String(e);if(typeof e=="object"){const t=e;if(t.value!==void 0&&t.value!==e)return this.normalizeFilterText(t.value);if(typeof t.toJSON=="function")try{const n=t.toJSON.call(e);if(n!==e)return this.normalizeFilterText(n)}catch{}}return String(e)}normalizeFilterCondition(e){const t=e.op;if(t==="in"){const o=Array.from(new Set((e.values||[]).map(i=>this.normalizeFilterText(i).trim())));return{op:t,values:o}}if(t==="isEmpty"||t==="isNotEmpty")return{op:t};const n=this.normalizeFilterText(e.value).trim();if(n.length!==0)return{op:t,value:n}}matchesFilterCondition(e,t){const n=this.normalizeFilterText(e).trim(),o=n.toLowerCase(),i=this.normalizeFilterText(t.value).trim().toLowerCase();switch(t.op){case"in":return new Set((t.values||[]).map(r=>this.normalizeFilterText(r).trim())).has(n);case"contains":return o.includes(i);case"notContains":return!o.includes(i);case"equals":return o===i;case"notEquals":return o!==i;case"isEmpty":return o.length===0;case"isNotEmpty":return o.length>0;default:return!0}}async rowMatchesFilters(e,t){for(const[n,o]of this.filterColumns){if(n===t)continue;const i=await this.getCell({r:e,c:n}),r=this.normalizeFilterText(i==null?void 0:i.v);if(!this.matchesFilterCondition(r,o))return!1}return!0}async recomputeFilterHiddenRows(){if(!this.filterRange){this.hiddenRows.clear(),await this.store.setFilterState(void 0);return}if(this.filterRange=qe({r:Math.max(1,this.filterRange[0].r),c:Math.max(1,this.filterRange[0].c)},{r:Math.min(this.dimension.rows,this.filterRange[1].r),c:Math.min(this.dimension.columns,this.filterRange[1].c)}),this.filterRange[1].r<=this.filterRange[0].r){this.filterRange=void 0,this.filterColumns.clear(),this.hiddenRows.clear(),await this.store.setFilterState(void 0);return}this.normalizeFilterColumnsToRange();const e=new Set,t=this.filterRange[0].r+1,n=this.filterRange[1].r;if(this.filterColumns.size>0)for(let o=t;o<=n;o++)await this.rowMatchesFilters(o)||e.add(o);this.hiddenRows=e,this.ensureActiveCellVisibleAfterFiltering(),await this.store.setFilterState(this.buildFilterStatePayload())}shiftFilterBoundary(e,t,n){if(n>0)return e>=t?e+n:e;const o=Math.abs(n);return e>=t&&e<t+o?t:e>=t+o?e+n:e}shiftFilterState(e,t,n){if(!this.filterRange)return;if(e==="row"){const s=this.shiftFilterBoundary(this.filterRange[0].r,t,n),a=this.shiftFilterBoundary(this.filterRange[1].r,t,n);this.filterRange=qe({r:Math.max(1,s),c:this.filterRange[0].c},{r:Math.max(1,a),c:this.filterRange[1].c});const c=new Map;for(const h of this.hiddenRows)c.set(h,1);const u=Nr(c,t,n);this.hiddenRows=new Set(u.keys()),this.pruneHiddenRowsOutsideFilter();return}const o=this.shiftFilterBoundary(this.filterRange[0].c,t,n),i=this.shiftFilterBoundary(this.filterRange[1].c,t,n);this.filterRange=qe({r:this.filterRange[0].r,c:Math.max(1,o)},{r:this.filterRange[1].r,c:Math.max(1,i)});const r=new Map;for(const[s,a]of this.filterColumns)r.set(s,a);this.filterColumns=Nr(r,t,n),this.normalizeFilterColumnsToRange()}moveFilterState(e,t,n,o){if(!this.filterRange)return;if(e==="row"){const a=Ye(this.filterRange[0].r,t,n,o),c=Ye(this.filterRange[1].r,t,n,o);this.filterRange=qe({r:a,c:this.filterRange[0].c},{r:c,c:this.filterRange[1].c});const u=new Map;for(const f of this.hiddenRows)u.set(f,1);const h=br(u,t,n,o);this.hiddenRows=new Set(h.keys()),this.pruneHiddenRowsOutsideFilter();return}const i=Ye(this.filterRange[0].c,t,n,o),r=Ye(this.filterRange[1].c,t,n,o);this.filterRange=qe({r:this.filterRange[0].r,c:i},{r:this.filterRange[1].r,c:r});const s=new Map;for(const[a,c]of this.filterColumns)s.set(a,c);this.filterColumns=br(s,t,n,o),this.normalizeFilterColumnsToRange()}ensureActiveCellVisibleAfterFiltering(){if(!this.hiddenRows.has(this.activeCell.r))return;let e;if(this.filterRange&&this.activeCell.r>this.filterRange[0].r&&this.activeCell.r<=this.filterRange[1].r)e=this.filterRange[0].r;else{for(let t=this.activeCell.r+1;t<=this.dimension.rows;t++)if(!this.hiddenRows.has(t)){e=t;break}if(e===void 0){for(let t=this.activeCell.r-1;t>=1;t--)if(!this.hiddenRows.has(t)){e=t;break}}}e!==void 0&&(this.range=void 0,this.setActiveCell({r:e,c:this.activeCell.c}))}findNextVisibleRow(e,t){const n=t==="down"?1:-1;let o=e;for(;o>=1&&o<=this.dimension.rows;){if(!this.hiddenRows.has(o))return o;o+=n}}async fetchGrid(e){return this.store.getGrid(e)}hasCellContent(e){const t=e.v!==void 0&&e.v!==""&&e.v!==null,n=!!e.f;return t||n}isEmptyCell(e){const t=this.hasCellContent(e),n=e.s!==void 0&&Object.keys(e.s).length>0;return!t&&!n}normalizeStylePatch(e){return Rp(e)}mergeStylePatch(e,t){return wp(e,t)}rangesIntersect(e,t){return e[0].r<=t[1].r&&e[1].r>=t[0].r&&e[0].c<=t[1].c&&e[1].c>=t[0].c}hasConflictingStyleSourceForKey(e,t,n,o){var r;const i=(r=this.sheetStyle)==null?void 0:r[t];if(i!==void 0&&i!==n)return!0;for(const[s,a]of this.colStyles){if(s<e[0].c||s>e[1].c)continue;const c=a[t];if(c!==void 0&&c!==n)return!0}for(const[s,a]of this.rowStyles){if(s<e[0].r||s>e[1].r)continue;const c=a[t];if(c!==void 0&&c!==n)return!0}for(let s=0;s<this.rangeStyles.length;s++){if(o!==void 0&&s===o)continue;const a=this.rangeStyles[s],c=a.style[t];if(!(c===void 0||c===n)&&this.rangesIntersect(e,a.range))return!0}return!1}pruneRedundantDefaultStyleKeys(e,t,n){const o={};for(const i of Object.keys(t)){const r=t[i];if(r===void 0)continue;const s=Fy[i];s!==void 0&&r===s&&!this.hasConflictingStyleSourceForKey(e,i,r,n)||(o[i]=r)}return Object.keys(o).length>0?o:void 0}sameRangeStylePatchList(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Er(e[n].range,t[n].range)||!Yi(e[n].style,t[n].style))return!1;return!0}compactShadowedRangeStyles(){const e=Tl(this.rangeStyles);return this.sameRangeStylePatchList(e,this.rangeStyles)?!1:(this.rangeStyles=e,!0)}containsRange(e,t){return e[0].r<=t[0].r&&e[0].c<=t[0].c&&e[1].r>=t[1].r&&e[1].c>=t[1].c}mergeableColBand(e,t){return e[0].r!==t[0].r||e[1].r!==t[1].r?!1:t[0].c<=e[1].c+1&&e[0].c<=t[1].c+1}mergeableRowBand(e,t){return e[0].c!==t[0].c||e[1].c!==t[1].c?!1:t[0].r<=e[1].r+1&&e[0].r<=t[1].r+1}tryMergeRangeStylePatches(e,t){if(Yi(e.style,t.style)){if(Er(e.range,t.range)||this.containsRange(e.range,t.range))return e;if(this.containsRange(t.range,e.range))return t;if(this.mergeableColBand(e.range,t.range))return{range:[{r:e.range[0].r,c:Math.min(e.range[0].c,t.range[0].c)},{r:e.range[1].r,c:Math.max(e.range[1].c,t.range[1].c)}],style:{...e.style}};if(this.mergeableRowBand(e.range,t.range))return{range:[{r:Math.min(e.range[0].r,t.range[0].r),c:e.range[0].c},{r:Math.max(e.range[1].r,t.range[1].r),c:e.range[1].c}],style:{...e.style}}}}async addRangeStylePatch(e,t){const n=this.normalizeStylePatch(t);if(!n)return;const o=gr({range:st(e),style:n});if(!o)return;const i=this.rangeStyles,r=this.pruneRedundantDefaultStyleKeys(o.range,o.style);if(!r)return;o.style=r;const s=i[i.length-1];if(s&&Er(s.range,o.range)){const u=this.mergeStylePatch(s.style,o.style);if(!u)return;const h=this.pruneRedundantDefaultStyleKeys(s.range,u,i.length-1);if(!h){this.rangeStyles=i.slice(0,-1),this.compactShadowedRangeStyles(),await this.store.setRangeStyles(this.rangeStyles);return}if(Yi(h,s.style))return;s.style={...h},this.compactShadowedRangeStyles(),await this.store.setRangeStyles(this.rangeStyles);return}let a=o,c=i.length;for(let u=i.length-1;u>=0;u--){const h=i[u],f=this.tryMergeRangeStylePatches(h,a);if(!f)break;if(Er(f.range,h.range)){if(u===i.length-1)return;this.rangeStyles=i.slice(0,u+1),this.compactShadowedRangeStyles(),await this.store.setRangeStyles(this.rangeStyles);return}a=f,c=u}if(c===i.length){this.rangeStyles.push(a),await this.store.addRangeStyle(a),this.compactShadowedRangeStyles()&&await this.store.setRangeStyles(this.rangeStyles);return}this.rangeStyles=[...i.slice(0,c),a],this.compactShadowedRangeStyles(),await this.store.setRangeStyles(this.rangeStyles)}async applyStylePatchToExistingCells(e,t){const n=this.normalizeStylePatch(t);if(!n)return;const o=await this.store.getGrid(e),i=new Set;for(const[r]of o){const s=be(r),a=this.normalizeRefToAnchor(s),c=fe(a);if(i.has(c))continue;i.add(c);const u=await this.store.get(a);if(!(u!=null&&u.s))continue;const h={};for(const f of Object.keys(n)){const d=u.s[f],p=n[f];d===void 0||d===p||(h[f]=p)}Object.keys(h).length!==0&&await this.setStyle(a,h)}}compactCell(e,t){const n={};return e.v!==void 0&&(n.v=e.v),e.f!==void 0&&(n.f=e.f),t&&Object.keys(t).length>0&&(n.s=t),n}getCopyRange(){var e;return(e=this.copyBuffer)==null?void 0:e.sourceRange}clearCopyBuffer(){this.copyBuffer=void 0}async copy(){const e=this.getRangeOrActiveCell(),t=await this.fetchGrid(e),n=iy(this.rangeStyles,e),o=fy(t);return this.copyBuffer={sourceRange:e,grid:t,rangeStyles:n,text:o},{text:o}}async paste(e){const{text:t,html:n}=e;let o,i=[],r=!1;if(this.copyBuffer&&t===this.copyBuffer.text){o=this.relocateGrid(this.copyBuffer.grid,this.copyBuffer.sourceRange,this.activeCell);const s=this.activeCell.r-this.copyBuffer.sourceRange[0].r,a=this.activeCell.c-this.copyBuffer.sourceRange[0].c;i=oy(this.copyBuffer.rangeStyles,s,a)}else if(n&&py(n))o=my(n,this.activeCell),r=!0;else if(t)o=dy(this.activeCell,t),r=!0;else return;r&&(o=this.applyInputInferenceToGrid(o)),this.store.beginBatch();try{await this.setGrid(o);for(const a of i)await this.addRangeStylePatch(a.range,a.style),await this.applyStylePatchToExistingCells(a.range,a.style);const s=new Set;for(const[a]of o)s.add(a);if(s.size>0){const a=this.expandChangedSrefsWithMergeAliases(s),c=await this.store.buildDependantsMap(a);await Sr(this,c,a)}this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}this.selectPastedRange(o)}selectPastedRange(e){if(e.size===0)return;let t=1/0,n=-1/0,o=1/0,i=-1/0;for(const r of e.keys()){const s=be(r);s.r<t&&(t=s.r),s.r>n&&(n=s.r),s.c<o&&(o=s.c),s.c>i&&(i=s.c)}t===n&&o===i?this.selectStart({r:t,c:o}):(this.selectionType="cell",this.activeCell={r:t,c:o},this.range=[{r:t,c:o},{r:n,c:i}],this.store.updateActiveCell(this.activeCell))}relocateGrid(e,t,n){const o=n.r-t[0].r,i=n.c-t[0].c,r=new Map;for(const[s,a]of e){const c=be(s),u={r:c.r+o,c:c.c+i},h=fe(u);if(a.f){const f=Yf(a.f,o,i);r.set(h,{f,s:a.s})}else r.set(h,{...a})}return r}computeAutofillRange(e,t){if(!mr(t,e))return wa(e,[t,t])}getAutofillPreviewRange(e){if(this.selectionType!=="cell")return;const t=this.getRangeOrActiveCell();return this.computeAutofillRange(t,e)}positiveMod(e,t){return(e%t+t)%t}cloneCellForAutofill(e,t,n){if(e.f){const i=Yf(e.f,t,n);return e.s?{f:i,s:{...e.s}}:{f:i}}const o={};return e.v!==void 0&&(o.v=e.v),e.s&&(o.s={...e.s}),o}async autofill(e){if(this.selectionType!=="cell")return!1;const t=st(this.getRangeOrActiveCell()),n=this.computeAutofillRange(t,e);if(!n||this.getMergesIntersecting(n).length>0)return!1;const o=await this.store.getGrid(t),i=t[1].r-t[0].r+1,r=t[1].c-t[0].c+1,s=new Set;this.store.beginBatch();try{for(let a=n[0].r;a<=n[1].r;a++)for(let c=n[0].c;c<=n[1].c;c++){const u={r:a,c};if(mr(u,t))continue;const h={r:t[0].r+this.positiveMod(u.r-t[0].r,i),c:t[0].c+this.positiveMod(u.c-t[0].c,r)},f=o.get(fe(h)),d=this.normalizeRefToAnchor(u),p=fe(d);if(!f){await this.store.delete(d),s.add(p);continue}const y=u.r-h.r,m=u.c-h.c,v=this.cloneCellForAutofill(f,y,m);this.isEmptyCell(v)?await this.store.delete(d):await this.store.set(d,v),s.add(p)}if(s.size>0){const a=this.expandChangedSrefsWithMergeAliases(s),c=await this.store.buildDependantsMap(a);await Sr(this,c,a)}this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return s.size===0?!1:(this.selectionType="cell",this.range=n,!0)}async hasContents(e){const t=await this.store.getGrid(e);for(const n of t.values())if(this.hasCellContent(n))return!0;return!1}async fetchGridByReferences(e){const t=new Map,n=new Map;for(const o of Dr(e))if(oo(o)){const{sheetName:i,localRef:r}=yl(o);n.has(i.toUpperCase())||n.set(i.toUpperCase(),new Set),n.get(i.toUpperCase()).add(r)}else{const i=this.normalizeRefToAnchor(be(o)),r=await this.store.get(i);r&&t.set(o,r)}if(this.gridResolver&&n.size>0)for(const[o,i]of n){const r=this.gridResolver(o,i);if(r)for(const[s,a]of r)t.set(`${o}!${s}`,a)}return t}setGridResolver(e){this.gridResolver=e}async recalculateCrossSheetFormulas(){const e=await this.store.getFormulaGrid(),t=new Set;for(const[n]of e)t.add(n);if(t.size!==0){this.store.beginBatch();try{const n=await this.store.buildDependantsMap(t);await Sr(this,n,t),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}}getActiveCell(){return this.activeCell}setActiveCell(e){const t=this.normalizeRefToAnchor(e);this.activeCell=t,this.store.updateActiveCell(t)}getRange(){return this.range}getPresences(){return this.store.getPresences()}getRangeOrActiveCell(){if(this.range)return this.expandRangeToMergedBoundaries(this.range);const e=this.getMergeForRef(this.activeCell);return e?e.range:[this.activeCell,this.activeCell]}getSelectionType(){return this.selectionType}selectRow(e){this.selectionType="row",this.activeCell={r:e,c:1},this.range=[{r:e,c:1},{r:e,c:this.dimension.columns}],this.store.updateActiveCell(this.activeCell)}selectColumn(e){this.selectionType="column",this.activeCell={r:1,c:e},this.range=[{r:1,c:e},{r:this.dimension.rows,c:e}],this.store.updateActiveCell(this.activeCell)}selectRowRange(e,t){this.selectionType="row";const n=Math.min(e,t),o=Math.max(e,t);this.range=[{r:n,c:1},{r:o,c:this.dimension.columns}]}selectColumnRange(e,t){this.selectionType="column";const n=Math.min(e,t),o=Math.max(e,t);this.range=[{r:1,c:n},{r:this.dimension.rows,c:o}]}selectAllCells(){this.selectionType="all",this.activeCell={r:1,c:1},this.range=st(this.dimensionRange),this.store.updateActiveCell(this.activeCell)}getSelectedIndices(){return this.selectionType==="cell"||this.selectionType==="all"||!this.range?null:this.selectionType==="row"?{axis:"row",from:this.range[0].r,to:this.range[1].r}:{axis:"column",from:this.range[0].c,to:this.range[1].c}}async createFilterFromSelection(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell(),t=await this.expandFilterRangeForHeaderOnlySelection(e);return await this.setFilterRange(t)?(this.selectionType="cell",this.range=st(qe(t[0],t[1])),!0):!1}async expandFilterRangeForHeaderOnlySelection(e){const t=qe(e[0],e[1]);if(t[0].r!==t[1].r)return t;const n=t[0].r;if(n>=this.dimension.rows)return t;const o=[{r:n+1,c:t[0].c},{r:this.dimension.rows,c:t[1].c}],i=await this.store.getGrid(o);if(i.size===0)return t;const r=new Set;for(const[a,c]of i)this.hasCellContent(c)&&r.add(be(a).r);let s=n;for(;r.has(s+1);)s+=1;return qe(t[0],{r:s,c:t[1].c})}async setFilterRange(e){const t=qe(e[0],e[1]);if(t[1].r<=t[0].r)return!1;this.store.beginBatch();try{this.filterRange=t,this.normalizeFilterColumnsToRange(),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async clearFilter(){this.store.beginBatch();try{this.filterRange=void 0,this.filterColumns.clear(),this.hiddenRows.clear(),await this.store.setFilterState(void 0)}finally{this.store.endBatch()}}async setColumnFilter(e,t){if(!this.filterRange||!this.isColumnInFilter(e))return!1;this.store.beginBatch();try{const n=this.normalizeFilterCondition(t);n?this.filterColumns.set(e,n):this.filterColumns.delete(e),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async filterColumnByValue(e,t){return this.setColumnFilter(e,{op:"equals",value:t})}async clearColumnFilter(e){if(!this.filterRange||!this.isColumnInFilter(e)||!this.filterColumns.has(e))return!1;this.store.beginBatch();try{this.filterColumns.delete(e),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async getFilterColumnValues(e){if(!this.filterRange||!this.isColumnInFilter(e))return;const t=new Set,n=this.filterRange[0].r+1,o=this.filterRange[1].r;for(let s=n;s<=o;s++){if(!await this.rowMatchesFilters(s,e))continue;const a=await this.getCell({r:s,c:e}),c=this.normalizeFilterText(a==null?void 0:a.v);t.add(c.trim())}const i=Array.from(t).sort((s,a)=>s.localeCompare(a,void 0,{sensitivity:"base"})),r=this.filterColumns.get(e);return r?r.op==="in"?{values:i,selected:new Set((r.values||[]).map(s=>this.normalizeFilterText(s).trim()))}:{values:i,selected:new Set(i.filter(s=>this.matchesFilterCondition(s,r)))}:{values:i,selected:new Set(i)}}async setColumnIncludedValues(e,t){if(!this.filterRange||!this.isColumnInFilter(e))return!1;const n=Array.from(new Set(t.map(s=>this.normalizeFilterText(s).trim()))).sort((s,a)=>s.localeCompare(a,void 0,{sensitivity:"base"})),o=await this.getFilterColumnValues(e);if(!o)return!1;const i=new Set(o.values),r=n.filter(s=>i.has(s));this.store.beginBatch();try{r.length===o.values.length?this.filterColumns.delete(e):this.filterColumns.set(e,{op:"in",values:r}),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async sortFilterByColumn(e,t){if(!this.filterRange||!this.isColumnInFilter(e))return!1;const n=this.filterRange[0].r+1,o=this.filterRange[1].r;if(o<=n)return!1;const i=[{r:n,c:1},{r:o,c:this.dimension.columns}];if(this.getMergesIntersecting(i).length>0)return!1;const r=[];for(let u=n;u<=o;u++){const h=await this.getCell({r:u,c:e}),f=this.normalizeFilterText(h==null?void 0:h.v).trim(),d=f.length>0&&Number.isFinite(Number(f))?Number(f):null;r.push({row:u,text:f,lower:f.toLowerCase(),numeric:d})}r.sort((u,h)=>{const f=u.text.length===0,d=h.text.length===0;if(f&&!d)return 1;if(!f&&d)return-1;let p=0;return u.numeric!==null&&h.numeric!==null?p=u.numeric-h.numeric:p=u.lower.localeCompare(h.lower,void 0,{sensitivity:"base"}),p===0&&(p=u.row-h.row),t==="asc"?p:-p});const s=r.map(u=>u.row),a=Array.from({length:o-n+1},(u,h)=>n+h),c=[];for(let u=0;u<s.length;u++){const h=s[u],f=a.indexOf(h);if(f===-1||f===u)continue;const d=n+f,p=n+u;c.push({srcIndex:d,dstIndex:p}),a.splice(f,1),a.splice(u,0,h)}if(c.length===0)return!0;this.store.beginBatch();try{for(const u of c)await this.moveCells("row",u.srcIndex,1,u.dstIndex,{skipPostRecalculate:!0});await this.recalculateAllFormulaCells(),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}selectStart(e){mr(e,this.dimensionRange)&&(this.selectionType="cell",this.setActiveCell(this.normalizeRefToAnchor(e)),this.range=void 0)}selectEnd(e){if(!mr(e,this.dimensionRange))return;const t=this.normalizeRefToAnchor(e);if(Wi(this.activeCell,t)){this.range=void 0;return}this.range=this.expandRangeToMergedBoundaries(qe(this.activeCell,t))}hasRange(){return!!this.range}async selectAll(){let e=this.getRangeOrActiveCell(),t=st(e),n=!0;for(;n;){n=!1;for(const o of gx(t,this.dimensionRange))await this.hasContents(o)&&(t=wa(t,o),n=!0)}if(Er(e,t)){this.range=st(this.dimensionRange);return}this.range=t}async moveToEdge(e){const t=this.getMergeForRef(this.activeCell),n={...this.activeCell};t&&(e==="right"?n.c=t.range[1].c:e==="down"&&(n.r=t.range[1].r));const o=await this.store.findEdge(n,e,this.dimensionRange);let i=this.normalizeRefToAnchor(o);if((e==="up"||e==="down")&&this.hiddenRows.has(i.r)){const r=this.findNextVisibleRow(i.r,e);if(r===void 0)return!1;i=this.normalizeRefToAnchor({r,c:i.c})}return Wi(this.activeCell,i)?!1:(this.range=void 0,this.setActiveCell(i),!0)}move(e){const t=e==="up"?-1:e==="down"?1:0,n=e==="left"?-1:e==="right"?1:0;let o=this.activeCell.r,i=this.activeCell.c;const r=this.getMergeForRef(this.activeCell);if(r?e==="right"?i=r.range[1].c+1:e==="down"?o=r.range[1].r+1:e==="left"?i-=1:o-=1:(o+=t,i+=n),(e==="up"||e==="down")&&this.hiddenRows.has(o)){const a=this.findNextVisibleRow(o,e);if(a===void 0)return!1;o=a}if(!mr({r:o,c:i},this.dimensionRange))return!1;const s=this.normalizeRefToAnchor({r:o,c:i});return Wi(this.activeCell,s)?!1:(this.range=void 0,this.setActiveCell(s),!0)}resizeRange(e){const t=e==="up"?-1:e==="down"?1:0,n=e==="left"?-1:e==="right"?1:0;let o=st(this.getRangeOrActiveCell());if(t!==0){const i=t>0?"down":"up",r=s=>this.hiddenRows.has(s)?this.findNextVisibleRow(s,i):s;if(this.activeCell.r===o[1].r){const s=r(o[0].r+t);if(s===void 0)return!1;o[0].r=s}else{const s=r(o[1].r+t);if(s===void 0)return!1;o[1].r=s}}return n!==0&&(this.activeCell.c===o[1].c?o[0].c+=n:o[1].c+=n),o=qe(o[0],o[1]),xx(o,this.dimensionRange)?(this.range=this.expandRangeToMergedBoundaries(o),!0):!1}async getStyle(e){const t=this.normalizeRefToAnchor(e),n=await this.store.get(t);return this.resolveEffectiveStyle(t.r,t.c,n==null?void 0:n.s)}async setStyle(e,t){const n=this.normalizeStylePatch(t);if(!n)return;const o=this.normalizeRefToAnchor(e),i=await this.store.get(o)||{},r=this.mergeStylePatch(i.s,n),s=this.compactCell(i,r);if(this.isEmptyCell(s)){await this.store.delete(o);return}await this.store.set(o,s)}async setRangeStyle(e){this.store.beginBatch();try{if(this.selectionType==="column"){const n=this.getRangeOrActiveCell();for(let o=n[0].c;o<=n[1].c;o++){const i=this.mergeStylePatch(this.colStyles.get(o),e);i&&(this.colStyles.set(o,i),await this.store.setColumnStyle(o,i))}return}if(this.selectionType==="row"){const n=this.getRangeOrActiveCell();for(let o=n[0].r;o<=n[1].r;o++){const i=this.mergeStylePatch(this.rowStyles.get(o),e);i&&(this.rowStyles.set(o,i),await this.store.setRowStyle(o,i))}return}if(this.selectionType==="all"){const n=this.mergeStylePatch(this.sheetStyle,e);if(!n)return;this.sheetStyle=n,await this.store.setSheetStyle(n);return}const t=this.getRangeOrActiveCell();await this.addRangeStylePatch(t,e),await this.applyStylePatchToExistingCells(t,e)}finally{this.store.endBatch()}}async setConditionalFormats(e){const t=e.map(n=>$o(n)).filter(n=>!!n).map(n=>li(n));this.conditionalFormats=t,await this.store.setConditionalFormats(this.conditionalFormats)}async setRangeBorders(e){if(this.selectionType!=="cell")return!1;const t=this.getRangeOrActiveCell(),n=t[1].r-t[0].r+1,o=t[1].c-t[0].c+1;if(n*o>Oy)return!1;const i=this.collectBorderTargets(t);this.store.beginBatch();try{for(const{anchor:r,range:s}of i){const a=this.toBorderPatchForPreset(e,t,s);await this.setStyle(r,a)}}finally{this.store.endBatch()}return!0}async toggleRangeStyle(e){const t=await this.getStyle(this.activeCell),n=!(t!=null&&t[e]);await this.setRangeStyle({[e]:n})}collectBorderTargets(e){const t=[],n=new Set;for(let o=e[0].r;o<=e[1].r;o++)for(let i=e[0].c;i<=e[1].c;i++){const r=this.normalizeRefToAnchor({r:o,c:i}),s=fe(r);if(n.has(s))continue;n.add(s);const a=this.merges.get(s),c=a?zi(r,a):qe(r,r);t.push({anchor:r,range:c})}return t}toBorderPatchForPreset(e,t,n){const o=n[0].r===t[0].r,i=n[1].r===t[1].r,r=n[0].c===t[0].c,s=n[1].c===t[1].c;switch(e){case"all":return{bt:!0,bl:!0,br:s,bb:i};case"outer":return{bt:o,bl:r,br:s,bb:i};case"inner":return{bt:!o,bl:!r,br:!1,bb:!1};case"top":return{bt:o};case"bottom":return{bb:i};case"left":return{bl:r};case"right":return{br:s};case"clear":default:return{bt:!1,bl:!1,br:!1,bb:!1}}}isSelectionMerged(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell(),t=this.getMergesIntersecting(e);return t.length===1&&Er(t[0].range,e)}canMergeSelection(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell();if(e[0].r===e[1].r&&e[0].c===e[1].c)return!1;const n=this.frozenRows>0&&e[0].r<=this.frozenRows&&e[1].r>this.frozenRows,o=this.frozenCols>0&&e[0].c<=this.frozenCols&&e[1].c>this.frozenCols;return n||o?!1:this.getMergesIntersecting(e).length===0}async toggleMergeSelection(){return this.isSelectionMerged()?this.unmergeSelection():this.mergeSelection()}async mergeSelection(){if(!this.canMergeSelection())return!1;const e=this.getRangeOrActiveCell(),t=e[0],n={rs:e[1].r-e[0].r+1,cs:e[1].c-e[0].c+1},o=new Set;for(const i of this.mergeCoveredSrefs(t,n))o.add(i);this.store.beginBatch();try{for(let s=e[0].r;s<=e[1].r;s++)for(let a=e[0].c;a<=e[1].c;a++){if(s===t.r&&a===t.c)continue;const c={r:s,c:a},u=await this.store.get(c);u&&(u.s&&Object.keys(u.s).length>0?await this.store.set(c,{s:u.s}):await this.store.delete(c))}await this.store.setMerge(t,n),this.merges.set(fe(t),n),this.rebuildMergeCoverMap();const i=this.expandChangedSrefsWithMergeAliases(o),r=await this.store.buildDependantsMap(i);await Sr(this,r,i)}finally{this.store.endBatch()}return this.selectionType="cell",this.setActiveCell(t),this.range=zi(t,n),!0}async unmergeSelection(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell(),t=this.getMergesIntersecting(e);if(t.length===0)return!1;const n=new Set;for(const o of t)for(const i of this.mergeCoveredSrefs(o.anchor,o.span))n.add(i);this.store.beginBatch();try{for(const r of t)await this.store.deleteMerge(r.anchor),this.merges.delete(r.anchorSref);this.rebuildMergeCoverMap();const o=this.expandChangedSrefsWithMergeAliases(n),i=await this.store.buildDependantsMap(o);await Sr(this,i,o)}finally{this.store.endBatch()}return this.selectionType="cell",this.range=void 0,!0}async getActiveDecimalPlaces(){const e=await this.getStyle(this.activeCell);return(e==null?void 0:e.dp)??2}async undo(){const e=await this.store.undo();if(e.success&&(await this.loadDimensions(),await this.loadStyles(),await this.loadMerges(),await this.loadFreezePane(),await this.loadFilterState(),e.affectedRange)){const[t,n]=e.affectedRange;this.selectionType="cell",this.activeCell=t,t.r===n.r&&t.c===n.c?this.range=void 0:this.range=e.affectedRange,this.store.updateActiveCell(this.activeCell)}return e.success}async redo(){const e=await this.store.redo();if(e.success&&(await this.loadDimensions(),await this.loadStyles(),await this.loadMerges(),await this.loadFreezePane(),await this.loadFilterState(),e.affectedRange)){const[t,n]=e.affectedRange;this.selectionType="cell",this.activeCell=t,t.r===n.r&&t.c===n.c?this.range=void 0:this.range=e.affectedRange,this.store.updateActiveCell(this.activeCell)}return e.success}moveInRange(e,t){const n=this.range||this.dimensionRange;let o=this.activeCell.r,i=this.activeCell.c;const r=this.getMergeForRef(this.activeCell),s=n[1].r-n[0].r+1,a=n[1].c-n[0].c+1;if(e!==0){const c=e>0?r?r.span.rs:e:e<0?-1:0;o+c>n[1].r?(o=n[0].r,i=(i+1-n[0].c+a)%a+n[0].c):o+c<n[0].r?(o=n[1].r,i=(i-1-n[0].c+a)%a+n[0].c):o+=c}if(t!==0){const c=t>0?r?r.span.cs:t:t<0?-1:0;i+c>n[1].c?(i=n[0].c,o=(o+1-n[0].r+s)%s+n[0].r):i+c<n[0].c?(i=n[1].c,o=(o-1-n[0].r+s)%s+n[0].r):i+=c}this.setActiveCell(this.normalizeRefToAnchor({r:o,c:i}))}}class Iy{constructor(e){B(this,"grid");B(this,"cellIndex",new uy);B(this,"rowHeights",new Map);B(this,"colWidths",new Map);B(this,"colStyles",new Map);B(this,"rowStyles",new Map);B(this,"sheetStyle");B(this,"rangeStyles",[]);B(this,"conditionalFormats",[]);B(this,"merges",new Map);B(this,"filterState");B(this,"frozenRows",0);B(this,"frozenCols",0);this.grid=e||new Map,this.rebuildIndex()}async set(e,t){this.grid.set(fe(e),t),this.cellIndex.add(e.r,e.c)}async get(e){return this.grid.get(fe(e))}async has(e){return this.grid.has(fe(e))}async delete(e){const t=this.grid.delete(fe(e));return t&&this.cellIndex.remove(e.r,e.c),t}async deleteRange(e){const t=new Set,n=[];for(const[o,i]of this.cellIndex.cellsInRange(e)){const r=fe({r:o,c:i});this.grid.delete(r),t.add(r),n.push([o,i])}for(const[o,i]of n)this.cellIndex.remove(o,i);return t}async setGrid(e){for(const[t,n]of e){this.grid.set(t,n);const o=be(t);this.cellIndex.add(o.r,o.c)}}async getGrid(e){const t=new Map;for(const[n,o]of this.cellIndex.cellsInRange(e)){const i=fe({r:n,c:o}),r=this.grid.get(i);r!==void 0&&t.set(i,r)}return t}async findEdge(e,t,n){return cy(this.cellIndex,e,t,n,(o,i)=>{const r=this.grid.get(fe({r:o,c:i}));return r!==void 0&&(!!r.v||!!r.f)})}async shiftCells(e,t,n){this.grid=Yg(this.grid,e,t,n),this.rebuildIndex(),e==="row"?(this.rowHeights=Nr(this.rowHeights,t,n),this.rowStyles=Nr(this.rowStyles,t,n)):(this.colWidths=Nr(this.colWidths,t,n),this.colStyles=Nr(this.colStyles,t,n)),this.rangeStyles=Ip(this.rangeStyles,e,t,n),this.conditionalFormats=bp(this.conditionalFormats,e,t,n),this.merges=Mp(this.merges,e,t,n)}async moveCells(e,t,n,o){this.grid=Vg(this.grid,e,t,n,o),this.rebuildIndex(),e==="row"?(this.rowHeights=br(this.rowHeights,t,n,o),this.rowStyles=br(this.rowStyles,t,n,o)):(this.colWidths=br(this.colWidths,t,n,o),this.colStyles=br(this.colStyles,t,n,o)),this.rangeStyles=Dp(this.rangeStyles,e,t,n,o),this.conditionalFormats=Np(this.conditionalFormats,e,t,n,o),this.merges=Bp(this.merges,e,t,n,o)}async getFormulaGrid(){const e=new Map;for(const[t,n]of this.grid)n.f&&e.set(t,n);return e}async buildDependantsMap(e){const t=Array.from(this.grid.entries()),n=new Map;for(const[o,i]of t)if(i.f)for(const r of Dr(_p(i.f)))oo(r)||(n.has(r)||n.set(r,new Set),n.get(r).add(o));return n}getPresences(){return[]}async setDimensionSize(e,t,n){(e==="row"?this.rowHeights:this.colWidths).set(t,n)}async getDimensionSizes(e){return new Map(e==="row"?this.rowHeights:this.colWidths)}updateActiveCell(e){}async setColumnStyle(e,t){this.colStyles.set(e,t)}async getColumnStyles(){return new Map(this.colStyles)}async setRowStyle(e,t){this.rowStyles.set(e,t)}async getRowStyles(){return new Map(this.rowStyles)}async setSheetStyle(e){this.sheetStyle=e}async getSheetStyle(){return this.sheetStyle?{...this.sheetStyle}:void 0}async addRangeStyle(e){const t=gr(e);t&&this.rangeStyles.push(Gi(t))}async setRangeStyles(e){this.rangeStyles=e.map(t=>gr(t)).filter(t=>!!t).map(t=>Gi(t))}async getRangeStyles(){return this.rangeStyles.map(e=>Gi(e))}async setConditionalFormats(e){this.conditionalFormats=e.map(t=>$o(t)).filter(t=>!!t).map(t=>li(t))}async getConditionalFormats(){return this.conditionalFormats.map(e=>li(e))}async setMerge(e,t){this.merges.set(fe(e),{...t})}async deleteMerge(e){return this.merges.delete(fe(e))}async getMerges(){return new Map(this.merges)}async setFilterState(e){if(!e){this.filterState=void 0;return}this.filterState={range:[{...e.range[0]},{...e.range[1]}],columns:Object.fromEntries(Object.entries(e.columns).map(([t,n])=>[t,{...n}])),hiddenRows:[...e.hiddenRows]}}async getFilterState(){if(this.filterState)return{range:[{...this.filterState.range[0]},{...this.filterState.range[1]}],columns:Object.fromEntries(Object.entries(this.filterState.columns).map(([e,t])=>[e,{...t}])),hiddenRows:[...this.filterState.hiddenRows]}}async setFreezePane(e,t){this.frozenRows=e,this.frozenCols=t}async getFreezePane(){return{frozenRows:this.frozenRows,frozenCols:this.frozenCols}}beginBatch(){}endBatch(){}async undo(){return{success:!1}}async redo(){return{success:!1}}canUndo(){return!1}canRedo(){return!1}rebuildIndex(){this.cellIndex.rebuild(Array.from(this.grid.keys()).map(e=>{const t=be(e);return[t.r,t.c]}))}}const Dy={cellBorderColor:"#D3D3D3",customBorderColor:"#000000",cellBGColor:"#FFFFFF",cellTextColor:"#000000",activeCellColor:"#E6C746",selectionBGColor:"rgba(230, 199, 70, 0.1)",headerBGColor:"#F0F0F0",headerActiveBGColor:"#E6C746","tokens.REFERENCE":"#E6C746","tokens.NUM":"#4DA6FF",peerCursor1:"#FF6B6B",peerCursor2:"#4ECDC4",peerCursor3:"#45B7D1",peerCursor4:"#96CEB4",peerCursor5:"#FFEAA7",peerCursor6:"#DDA0DD",peerCursor7:"#98D8C8",peerCursor8:"#F7DC6F",resizeHandleColor:"#1A73E8",headerSelectedBGColor:"rgba(26, 115, 232, 0.3)",dropIndicatorColor:"#1A73E8",freezeLineColor:"#BBBBBB",freezeHandleColor:"#9E9E9E",freezeHandleHoverColor:"#5F6368",formulaRange1:"#1A73E8",formulaRange2:"#E84C3D",formulaRange3:"#9B59B6",formulaRange4:"#27AE60",formulaRange5:"#F39C12",formulaRange6:"#00ACC1"},Ly={cellBorderColor:"#4A4A4A",customBorderColor:"#FFFFFF",cellBGColor:"#1E1E1E",cellTextColor:"#FFFFFF",activeCellColor:"#D4B73E",selectionBGColor:"rgba(212, 183, 62, 0.1)",headerBGColor:"#2D2D2D",headerActiveBGColor:"#D4B73E","tokens.REFERENCE":"#D4B73E","tokens.NUM":"#4DA6FF",peerCursor1:"#FF7979",peerCursor2:"#55EFC4",peerCursor3:"#74B9FF",peerCursor4:"#A4D4C4",peerCursor5:"#FDCB6E",peerCursor6:"#E17055",peerCursor7:"#81ECEC",peerCursor8:"#F8D84F",resizeHandleColor:"#8AB4F8",headerSelectedBGColor:"rgba(138, 180, 248, 0.3)",dropIndicatorColor:"#8AB4F8",freezeLineColor:"#5A5A5A",freezeHandleColor:"#8E8E8E",freezeHandleHoverColor:"#CCCCCC",formulaRange1:"#8AB4F8",formulaRange2:"#FF7979",formulaRange3:"#BB86FC",formulaRange4:"#66BB6A",formulaRange5:"#FFB74D",formulaRange6:"#4DD0E1"};function ve(l,e){return l==="light"?Dy[e]:Ly[e]}const sd=["formulaRange1","formulaRange2","formulaRange3","formulaRange4","formulaRange5","formulaRange6"];function To(l,e){return ve(l,sd[e%sd.length])}function ad(l,e){const t=["peerCursor1","peerCursor2","peerCursor3","peerCursor4","peerCursor5","peerCursor6","peerCursor7","peerCursor8"];let n=0;for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);n=(n<<5)-n+r,n=n&n}const o=Math.abs(n)%t.length;return ve(l,t[o])}function xr(l){const e=window.getSelection();if(e.rangeCount===0)return;const t=e.getRangeAt(0);if(!l.contains(t.commonAncestorContainer))return;let n=0,o=0,i=0;function r(s){if(s.nodeType===Node.TEXT_NODE){const a=s.textContent;s===t.startContainer&&(o=n+t.startOffset),s===t.endContainer&&(i=n+t.endOffset),n+=a.length}for(const a of s.childNodes)r(a)}return r(l),{start:o,end:i}}function _r(l,e){let t=0,n=null,o=null;const i=document.createRange();function r(a){if(a.nodeType===Node.TEXT_NODE){const c=a.textContent;n===null&&t+c.length>=e.start&&(n=a,i.setStart(a,e.start-t)),o===null&&t+c.length>=e.end&&(o=a,i.setEnd(a,e.end-t)),t+=c.length}for(const c of a.childNodes)r(c)}r(l);const s=window.getSelection();s.removeAllRanges(),s.addRange(i),l.focus()}function qp(l){return l=l.replace(/&/g,"&amp;"),l=l.replace(/</g,"&lt;"),l=l.replace(/>/g,"&gt;"),l=l.replace(/"/g,"&quot;"),l=l.replace(/'/g,"&#039;"),l=l.replace(/\n/g,"<br>"),l=l.replace(/ /g,"&nbsp;"),l}const Up=23,Hp=10;class My{constructor(e="light",t=!1){B(this,"sheet");B(this,"theme");B(this,"readOnly");B(this,"container");B(this,"cellLabel");B(this,"formulaInput");B(this,"boundRenderInput");this.theme=e,this.readOnly=t,this.container=document.createElement("div"),this.container.style.height=`${Up}px`,this.container.style.margin=`${Hp}px 0px`,this.container.style.display="flex",this.container.style.alignItems="center",this.container.style.borderTop=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.container.style.borderBottom=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.container.style.justifyContent="flex-start",this.cellLabel=document.createElement("div"),this.cellLabel.style.width="120px",this.cellLabel.style.textAlign="center",this.cellLabel.style.font="12px Arial",this.cellLabel.style.borderRight=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.container.appendChild(this.cellLabel),this.formulaInput=document.createElement("div"),this.formulaInput.contentEditable=this.readOnly?"false":"true",this.formulaInput.style.margin="0 20px",this.formulaInput.style.width="100%",this.formulaInput.style.height="12px",this.formulaInput.style.border="none",this.formulaInput.style.font="12px Arial",this.formulaInput.style.outline="none",this.formulaInput.style.overflow="hidden",this.formulaInput.style.whiteSpace="nowrap",this.formulaInput.style.lineHeight="12px",this.container.appendChild(this.formulaInput),this.boundRenderInput=this.renderInput.bind(this),this.formulaInput.addEventListener("input",this.boundRenderInput)}getContainer(){return this.container}initialize(e){this.sheet=e}cleanup(){this.formulaInput.removeEventListener("input",this.boundRenderInput),this.sheet=void 0,this.container.remove()}async render(){if(!this.sheet)return;const e=this.sheet.getActiveCell(),t=this.sheet.getSelectionType(),n=this.sheet.getSelectedIndices();let o;if(t==="row"&&n)o=`${n.from}:${n.to}`;else if(t==="column"&&n){const i=oi(n.from),r=oi(n.to);o=`${i}:${r}`}else{const i=this.sheet.getRange();o=i?yx(i):fe(e)}this.cellLabel.textContent=o,this.formulaInput.innerText=await this.sheet.toInputString(e),this.renderInput()}getFormulaInput(){return this.formulaInput}getValue(){return this.formulaInput.innerText}setValue(e){this.formulaInput.innerText=e,this.renderInput()}focus(){this.formulaInput.focus()}blur(){this.formulaInput.blur()}isFocused(){return document.activeElement===this.formulaInput}renderInput(){const e=this.formulaInput.innerText;if(!e.startsWith("="))return;const t=Mr(e),n=[];let o=0;for(const r of t){if(r.type==="REFERENCE"){n.push(`<span style="color: ${To(this.theme,o)}">${r.text}</span>`),o++;continue}if(r.type==="NUM"){n.push(`<span style="color: ${this.getThemeColor("tokens.NUM")}">${r.text}</span>`);continue}n.push(qp(r.text))}const i=xr(this.formulaInput);this.formulaInput.innerHTML="="+n.join(""),i&&_r(this.formulaInput,i)}getThemeColor(e){return ve(this.theme,e)}}const at=100,oe=23,ue=50,Tr=13,bo=1.5,fo=4,Ua=5,Fa=.5,By=1.5,ky="center",$p=4,zy=10;function Le(l,e={left:0,top:0},t,n){const o=n?n.getOffset(l.c):(l.c-1)*at,i=t?t.getOffset(l.r):(l.r-1)*oe,r=n?n.getSize(l.c):at,s=t?t.getSize(l.r):oe;return{left:o+ue-e.left,top:i+oe-e.top,width:r,height:s}}function Un(l,e){const t=Math.min(l.left,e.left),n=Math.min(l.top,e.top),o=Math.max(l.left+l.width,e.left+e.width),i=Math.max(l.top+l.height,e.top+e.height);return{left:t,top:n,width:o-t,height:i-n}}const Hn={frozenRows:0,frozenCols:0,frozenWidth:0,frozenHeight:0};function jy(l,e,t,n){return l===0&&e===0?Hn:{frozenRows:l,frozenCols:e,frozenWidth:e>0?n.getOffset(e+1):0,frozenHeight:l>0?t.getOffset(l+1):0}}function qy(l,e,t,n){const o=t?t.findIndex(e-oe):Math.floor(e/oe),i=n?n.findIndex(l-ue):Math.floor((l+ue)/at);return{r:o,c:i}}function Uy(l,e,t,n,o,i){const r=i.frozenCols>0&&l<ue+i.frozenWidth,s=i.frozenRows>0&&e<oe+i.frozenHeight,a=r?l-ue:l-ue-i.frozenWidth+o.getOffset(i.frozenCols+1)+t.left,c=s?e-oe:e-oe-i.frozenHeight+n.getOffset(i.frozenRows+1)+t.top,u=o.findIndex(a),h=n.findIndex(c);return{r:Math.max(1,h),c:Math.max(1,u)}}function Xi(l,e,t,n,o){const i=n.getOffset(l.c),r=t.getOffset(l.r),s=n.getSize(l.c),a=t.getSize(l.r),c=o.frozenCols>0&&l.c<=o.frozenCols,u=o.frozenRows>0&&l.r<=o.frozenRows,h=c?i+ue:i+ue-e.left-n.getOffset(o.frozenCols+1)+o.frozenWidth,f=u?r+oe:r+oe-e.top-t.getOffset(o.frozenRows+1)+o.frozenHeight;return{left:h,top:f,width:s,height:a}}class Hy{constructor(e="light"){B(this,"container");B(this,"input");B(this,"cellPositionHint");B(this,"theme");B(this,"boundHandleInput");B(this,"minWidth",at);B(this,"minHeight",oe);B(this,"maxWidth",1/0);B(this,"maxHeight",1/0);B(this,"composing",!1);this.theme=e,this.container=document.createElement("div"),this.container.style.position="absolute",this.container.style.left="-1000px",this.container.style.width=at+"px",this.container.style.height=oe+"px",this.container.style.zIndex="1",this.container.style.margin="0px",this.container.style.pointerEvents="none",this.input=document.createElement("div"),this.input.contentEditable="true",this.input.style.border="none",this.input.style.outline=`2px solid ${this.getThemeColor("activeCellColor")}`,this.input.style.fontFamily="Arial, sans-serif",this.input.style.fontSize=Tr+"px",this.input.style.fontWeight="normal",this.input.style.lineHeight=String(bo),this.input.style.color=this.getThemeColor("cellTextColor"),this.input.style.backgroundColor=this.getThemeColor("cellBGColor"),this.input.style.whiteSpace="pre",this.input.style.overflow="hidden",this.container.appendChild(this.input),this.cellPositionHint=document.createElement("div"),this.cellPositionHint.style.position="absolute",this.cellPositionHint.style.right="4px",this.cellPositionHint.style.top="4px",this.cellPositionHint.style.padding="0 4px",this.cellPositionHint.style.borderRadius="3px",this.cellPositionHint.style.border=`1px solid ${this.getThemeColor("cellBorderColor")}`,this.cellPositionHint.style.backgroundColor=this.getThemeColor("headerBGColor"),this.cellPositionHint.style.color=this.getThemeColor("cellTextColor"),this.cellPositionHint.style.fontSize="10px",this.cellPositionHint.style.lineHeight="14px",this.cellPositionHint.style.fontFamily="Arial, sans-serif",this.cellPositionHint.style.pointerEvents="none",this.cellPositionHint.style.display="none",this.cellPositionHint.style.zIndex="2",this.container.appendChild(this.cellPositionHint),this.boundHandleInput=this.handleInput.bind(this),this.input.addEventListener("input",this.boundHandleInput),this.input.addEventListener("compositionstart",()=>{this.composing=!0}),this.input.addEventListener("compositionend",()=>{this.composing=!1,this.adjustSize()})}cleanup(){this.input.removeEventListener("input",this.boundHandleInput),this.container.remove()}getContainer(){return this.container}getInput(){return this.input}show(e,t,n="",o=!0,i,r,s,a){this.updateFrame(e,t,i??at,r??oe,s??1/0,a??1/0),this.input.innerText=n,this.renderInput(),this.adjustSize(),o&&(_r(this.input,{start:this.input.innerText.length,end:this.input.innerText.length}),this.input.focus())}hide(){this.container.style.left="-1000px",this.container.style.pointerEvents="none",this.setCellPositionHint(),this.input.innerText="",this.input.blur()}isShown(){return this.container.style.left!=="-1000px"}isFocused(){return document.activeElement===this.input}getValue(){return this.input.innerText}setValue(e){this.input.innerText=e,this.renderInput(),this.adjustSize()}hasFormula(){return this.input.innerText.startsWith("=")}updatePlacement(e,t,n=at,o=oe,i=1/0,r=1/0){this.updateFrame(e,t,n,o,i,r),this.adjustSize()}setCellPositionHint(e){if(!e){this.cellPositionHint.style.display="none",this.cellPositionHint.innerText="";return}this.cellPositionHint.innerText=e,this.cellPositionHint.style.display="block"}applyStyle(e){this.input.style.fontWeight=e!=null&&e.b?"bold":"normal",this.input.style.fontStyle=e!=null&&e.i?"italic":"normal";const t=[];e!=null&&e.u&&t.push("underline"),e!=null&&e.st&&t.push("line-through"),this.input.style.textDecoration=t.length?t.join(" "):"none",this.input.style.color=(e==null?void 0:e.tc)||this.getThemeColor("cellTextColor"),this.input.style.backgroundColor=(e==null?void 0:e.bg)||this.getThemeColor("cellBGColor"),this.input.style.textAlign=(e==null?void 0:e.al)||"left";const n=(e==null?void 0:e.va)||"top";this.container.style.display="flex",this.container.style.alignItems=n==="middle"?"center":n==="bottom"?"flex-end":"flex-start"}handleInput(){this.renderInput(),this.composing||this.adjustSize()}updateFrame(e,t,n,o,i,r){this.minWidth=n,this.minHeight=o,this.maxWidth=i,this.maxHeight=r,this.container.style.left=e+"px",this.container.style.top=t+"px",this.container.style.pointerEvents="auto"}adjustSize(){this.input.style.width=this.minWidth+"px",this.input.style.height=this.minHeight+"px";const e=Math.min(Math.max(this.minWidth,this.input.scrollWidth),this.maxWidth),t=Math.min(Math.max(this.minHeight,this.input.scrollHeight),this.maxHeight);this.container.style.width=e+"px",this.container.style.height=t+"px",this.input.style.width=e+"px",this.input.style.height=t+"px",this.input.style.overflowY=this.input.scrollHeight>this.maxHeight?"auto":"hidden"}renderInput(){const e=this.input.innerText;if(!e.startsWith("="))return;const t=Mr(e),n=[];let o=0;for(const r of t){if(r.type==="REFERENCE"){n.push(`<span style="color: ${To(this.theme,o)}">${r.text}</span>`),o++;continue}if(r.type==="NUM"){n.push(`<span style="color: ${this.getThemeColor("tokens.NUM")}">${r.text}</span>`);continue}n.push(qp(r.text))}const i=xr(this.input);this.input.innerHTML="="+n.join(""),i&&_r(this.input,i)}getThemeColor(e){return ve(this.theme,e)}}class $y{constructor(e="light"){B(this,"canvas");B(this,"theme");this.theme=e,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.zIndex="1",this.canvas.style.pointerEvents="none"}cleanup(){this.canvas.remove()}getContainer(){return this.canvas}render(e,t,n,o,i,r,s,a,c,u,h,f=Hn,d,p,y,m=!0,v){this.canvas.width=0,this.canvas.height=0;const x=this.canvas.getContext("2d"),g=window.devicePixelRatio||1;this.canvas.width=e.width*g,this.canvas.height=e.height*g,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",x.scale(g,g);const S=f.frozenRows>0||f.frozenCols>0,C=this.buildMergeRenderData(v),A=this.resolveAutofillSelectionRange(i,n,C);if(!S)this.renderActiveCellSimple(x,n,t,r,s,C),this.renderSelectionSimple(x,e,t,i,c,r,s),this.renderPeerCursorsSimple(x,e,o,t,r,s,C),this.renderFormulaRangesSimple(x,h,t,r,s),this.renderCopyRangeSimple(x,p,t,r,s);else{const b=this.buildQuadrants(e,t,f,r,s);this.renderSelectionFrozen(x,e,t,i,c,r,s,f,b);for(const N of b){x.save(),x.beginPath(),x.rect(N.x,N.y,N.width,N.height),x.clip();const R=this.toCellRect(n,{left:N.scrollLeft,top:N.scrollTop},r,s,C);x.strokeStyle=this.getThemeColor("activeCellColor"),x.lineWidth=2,x.strokeRect(R.left,R.top,R.width,R.height),x.restore()}for(const{clientID:N,presence:R}of o){if(!R.activeCell)continue;const P=be(R.activeCell),k=ad(this.theme,N);for(const D of b){x.save(),x.beginPath(),x.rect(D.x,D.y,D.width,D.height),x.clip();const H=this.toCellRect(P,{left:D.scrollLeft,top:D.scrollTop},r,s,C);H.left>=-H.width&&H.left<e.width&&H.top>=-H.height&&H.top<e.height&&(x.strokeStyle=k,x.lineWidth=2,x.strokeRect(H.left,H.top,H.width,H.height)),x.restore()}}if(h&&h.length>0)for(let N=0;N<h.length;N++){const R=h[N],P=To(this.theme,N);for(const k of b){x.save(),x.beginPath(),x.rect(k.x,k.y,k.width,k.height),x.clip();const D={left:k.scrollLeft,top:k.scrollTop},H=Un(Le(R[0],D,r,s),Le(R[1],D,r,s));x.strokeStyle=P,x.lineWidth=2,x.strokeRect(H.left,H.top,H.width,H.height),x.fillStyle=P+"20",x.fillRect(H.left,H.top,H.width,H.height),x.restore()}}if(p)for(const N of b){x.save(),x.beginPath(),x.rect(N.x,N.y,N.width,N.height),x.clip();const R={left:N.scrollLeft,top:N.scrollTop};this.drawCopyRangeBorder(x,p,R,r,s),x.restore()}}y&&!Er(y,A)&&this.renderAutofillPreview(x,y,t,r,s,f),m&&this.renderAutofillHandle(x,A,c,t,r,s,f),a&&s&&r&&this.renderResizeHover(x,e,t,a,r,s,f),u&&s&&r&&this.renderDragMoveIndicator(x,e,t,u,r,s,f),d&&s&&r&&this.renderFreezeDragPreview(x,e,d,r,s)}buildQuadrants(e,t,n,o,i){const r=n.frozenWidth,s=n.frozenHeight,a=o?o.getOffset(n.frozenRows+1):0,c=i?i.getOffset(n.frozenCols+1):0,u=[];return u.push({x:ue+r,y:oe+s,width:e.width-ue-r,height:e.height-oe-s,scrollLeft:t.left+c-r,scrollTop:t.top+a-s}),n.frozenRows>0&&u.push({x:ue+r,y:oe,width:e.width-ue-r,height:s,scrollLeft:t.left+c-r,scrollTop:0}),n.frozenCols>0&&u.push({x:ue,y:oe+s,width:r,height:e.height-oe-s,scrollLeft:0,scrollTop:t.top+a-s}),n.frozenRows>0&&n.frozenCols>0&&u.push({x:ue,y:oe,width:r,height:s,scrollLeft:0,scrollTop:0}),u}renderActiveCellSimple(e,t,n,o,i,r){const s=this.toCellRect(t,n,o,i,r);e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=2,e.strokeRect(s.left,s.top,s.width,s.height)}renderSelectionSimple(e,t,n,o,i,r,s){if(i==="all")e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,oe,t.width-ue,t.height-oe);else if(o)if(i==="row"){const a=Le(o[0],n,r,s),c=Le(o[1],n,r,s),u=a.top,h=c.top+c.height-a.top;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,u,t.width-ue,h),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(ue,u,t.width-ue,h)}else if(i==="column"){const a=Le(o[0],n,r,s),c=Le(o[1],n,r,s),u=a.left,h=c.left+c.width-a.left;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(u,oe,h,t.height-oe),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(u,oe,h,t.height-oe)}else{const a=Un(Le(o[0],n,r,s),Le(o[1],n,r,s));e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(a.left,a.top,a.width,a.height),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(a.left,a.top,a.width,a.height)}}renderPeerCursorsSimple(e,t,n,o,i,r,s){for(const{clientID:a,presence:c}of n){if(!c.activeCell)continue;const u=be(c.activeCell),h=this.toCellRect(u,o,i,r,s);if(h.left>=-h.width&&h.left<t.width&&h.top>=-h.height&&h.top<t.height){const f=ad(this.theme,a);e.strokeStyle=f,e.lineWidth=2,e.strokeRect(h.left,h.top,h.width,h.height)}}}renderFormulaRangesSimple(e,t,n,o,i){if(!(!t||t.length===0))for(let r=0;r<t.length;r++){const s=t[r],a=Un(Le(s[0],n,o,i),Le(s[1],n,o,i)),c=To(this.theme,r);e.strokeStyle=c,e.lineWidth=2,e.strokeRect(a.left,a.top,a.width,a.height),e.fillStyle=c+"20",e.fillRect(a.left,a.top,a.width,a.height)}}renderCopyRangeSimple(e,t,n,o,i){t&&this.drawCopyRangeBorder(e,t,n,o,i)}drawCopyRangeBorder(e,t,n,o,i){const r=Un(Le(t[0],n,o,i),Le(t[1],n,o,i));e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=2,e.setLineDash([5,3]),e.strokeRect(r.left,r.top,r.width,r.height),e.setLineDash([])}renderSelectionFrozen(e,t,n,o,i,r,s,a,c){if(i==="all"){e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,oe,t.width-ue,t.height-oe);return}if(o)for(const u of c){e.save(),e.beginPath(),e.rect(u.x,u.y,u.width,u.height),e.clip();const h={left:u.scrollLeft,top:u.scrollTop};if(i==="row"){const f=Le(o[0],h,r,s),d=Le(o[1],h,r,s),p=f.top,y=d.top+d.height-f.top;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,p,t.width-ue,y),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(ue,p,t.width-ue,y)}else if(i==="column"){const f=Le(o[0],h,r,s),d=Le(o[1],h,r,s),p=f.left,y=d.left+d.width-f.left;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(p,oe,y,t.height-oe),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(p,oe,y,t.height-oe)}else{const f=Un(Le(o[0],h,r,s),Le(o[1],h,r,s));e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(f.left,f.top,f.width,f.height),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(f.left,f.top,f.width,f.height)}e.restore()}}renderResizeHover(e,t,n,o,i,r,s){if(e.strokeStyle=this.getThemeColor("resizeHandleColor"),e.lineWidth=2,o.axis==="column"){const c=s.frozenCols>0&&o.index<=s.frozenCols?0:n.left+r.getOffset(s.frozenCols+1)-s.frozenWidth,u=ue+r.getOffset(o.index)+r.getSize(o.index)-c;e.beginPath(),e.moveTo(u,0),e.lineTo(u,t.height),e.stroke()}else{const c=s.frozenRows>0&&o.index<=s.frozenRows?0:n.top+i.getOffset(s.frozenRows+1)-s.frozenHeight,u=oe+i.getOffset(o.index)+i.getSize(o.index)-c;e.beginPath(),e.moveTo(0,u),e.lineTo(t.width,u),e.stroke()}}renderDragMoveIndicator(e,t,n,o,i,r,s){if(e.strokeStyle=this.getThemeColor("dropIndicatorColor"),e.lineWidth=3,o.axis==="column"){const c=s.frozenCols>0&&o.dropIndex<=s.frozenCols?0:n.left+r.getOffset(s.frozenCols+1)-s.frozenWidth,u=ue+r.getOffset(o.dropIndex)-c;e.beginPath(),e.moveTo(u,0),e.lineTo(u,t.height),e.stroke()}else{const c=s.frozenRows>0&&o.dropIndex<=s.frozenRows?0:n.top+i.getOffset(s.frozenRows+1)-s.frozenHeight,u=oe+i.getOffset(o.dropIndex)-c;e.beginPath(),e.moveTo(0,u),e.lineTo(t.width,u),e.stroke()}}renderFreezeDragPreview(e,t,n,o,i){if(e.strokeStyle=this.getThemeColor("freezeLineColor"),e.lineWidth=2,n.axis==="row"){const r=n.targetIndex===0?oe:oe+o.getOffset(n.targetIndex+1);e.beginPath(),e.moveTo(0,r),e.lineTo(t.width,r),e.stroke()}else{const r=n.targetIndex===0?ue:ue+i.getOffset(n.targetIndex+1);e.beginPath(),e.moveTo(r,0),e.lineTo(r,t.height),e.stroke()}}toRangeRect(e,t,n,o,i=Hn){if(!n||!o)return;const r=i.frozenRows>0||i.frozenCols>0,s=r?Xi(e[0],t,n,o,i):Le(e[0],t,n,o),a=r?Xi(e[1],t,n,o,i):Le(e[1],t,n,o);return Un(s,a)}renderAutofillPreview(e,t,n,o,i,r=Hn){const s=this.toRangeRect(t,n,o,i,r);s&&(e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.setLineDash([4,2]),e.strokeRect(s.left,s.top,s.width,s.height),e.setLineDash([]))}renderAutofillHandle(e,t,n,o,i,r,s=Hn){if(n!=="cell"||!t)return;const a=this.toRangeRect(t,o,i,r,s);if(!a)return;const c=8,u=a.left+a.width-c/2,h=a.top+a.height-c/2;e.fillStyle=this.getThemeColor("activeCellColor"),e.fillRect(u,h,c,c),e.strokeStyle=this.getThemeColor("cellBGColor"),e.lineWidth=1,e.strokeRect(u+.5,h+.5,c,c)}resolveAutofillSelectionRange(e,t,n){if(e)return[e[0],e[1]];const o=fe(t),i=(n==null?void 0:n.coverToAnchor.get(o))||o,r=be(i),s=n==null?void 0:n.anchors.get(i);return!s||s.rs===1&&s.cs===1?[r,r]:[r,{r:r.r+s.rs-1,c:r.c+s.cs-1}]}getThemeColor(e){return ve(this.theme,e)}buildMergeRenderData(e){if(!e||e.size===0)return;const t=new Map,n=new Map;for(const[o,i]of e){t.set(o,i);const r=be(o);for(let s=r.r;s<r.r+i.rs;s++)for(let a=r.c;a<r.c+i.cs;a++){const c=fe({r:s,c:a});c!==o&&n.set(c,o)}}return{anchors:t,coverToAnchor:n}}toCellRect(e,t,n,o,i){const r=fe(e),s=(i==null?void 0:i.coverToAnchor.get(r))||r,a=be(s),c=i==null?void 0:i.anchors.get(s),u=Le(a,t,n,o);if(!c||c.rs===1&&c.cs===1)return u;const h=Le({r:a.r+c.rs-1,c:a.c+c.cs-1},t,n,o);return{left:u.left,top:u.top,width:h.left+h.width-u.left,height:h.top+h.height-u.top}}}const po=1e7;class Vy{constructor(e="light"){B(this,"container");B(this,"scrollContainer");B(this,"dummyContainer");B(this,"actualWidth",0);B(this,"actualHeight",0);this.createContainers()}createContainers(){this.container=document.createElement("div"),this.container.style.position="relative",this.container.style.width="100%",this.container.style.height=`calc(100% - ${Up+Hp*2}px)`,this.scrollContainer=document.createElement("div"),this.scrollContainer.style.position="absolute",this.scrollContainer.style.overflow="auto",this.scrollContainer.style.width="100%",this.scrollContainer.style.height="100%",this.scrollContainer.style.zIndex="1",this.dummyContainer=document.createElement("div"),this.dummyContainer.style.margin="0px",this.dummyContainer.style.padding="0px",this.dummyContainer.style.pointerEvents="none",this.scrollContainer.appendChild(this.dummyContainer),this.container.appendChild(this.scrollContainer)}getContainer(){return this.container}getScrollContainer(){return this.scrollContainer}getDummyContainer(){return this.dummyContainer}updateDummySize(e,t){this.actualWidth=e,this.actualHeight=t;const n=Math.min(e,po),o=Math.min(t,po);this.dummyContainer.style.width=n+"px",this.dummyContainer.style.height=o+"px"}appendChild(e){this.container.appendChild(e)}getViewport(){return this.scrollContainer.getBoundingClientRect()}getScrollPosition(){const e=this.scrollContainer.scrollLeft,t=this.scrollContainer.scrollTop,n=this.scrollContainer.getBoundingClientRect();return{left:this.toLogical(e,this.actualWidth,n.width),top:this.toLogical(t,this.actualHeight,n.height)}}setScrollPosition(e){const t=this.scrollContainer.getBoundingClientRect();e.left!==void 0&&(this.scrollContainer.scrollLeft=this.toPhysical(e.left,this.actualWidth,t.width)),e.top!==void 0&&(this.scrollContainer.scrollTop=this.toPhysical(e.top,this.actualHeight,t.height))}scrollBy(e,t){const n=this.scrollContainer.getBoundingClientRect(),o=this.needsRemap(this.actualWidth,n.width)?e*this.physicalMax(this.actualWidth,n.width)/this.logicalMax(this.actualWidth,n.width):e,i=this.needsRemap(this.actualHeight,n.height)?t*this.physicalMax(this.actualHeight,n.height)/this.logicalMax(this.actualHeight,n.height):t;this.scrollContainer.scrollBy(o,i)}addEventListener(e,t,n){this.scrollContainer.addEventListener(e,t,n)}removeEventListener(e,t,n){this.scrollContainer.removeEventListener(e,t,n)}cleanup(){this.container.remove()}needsRemap(e,t){return e>po&&t<e}cappedSize(e){return Math.min(e,po)}physicalMax(e,t){return Math.max(0,this.cappedSize(e)-t)}logicalMax(e,t){return Math.max(0,e-t)}clamp(e,t,n){return n<=t?t:Math.min(n,Math.max(t,e))}toLogical(e,t,n){const o=this.logicalMax(t,n);if(!this.needsRemap(t,n))return this.clamp(e,0,o);const i=this.physicalMax(t,n);return i<=0||o<=0?0:this.clamp(e,0,i)*o/i}toPhysical(e,t,n){const o=this.logicalMax(t,n);if(!this.needsRemap(t,n))return this.clamp(e,0,o);if(o<=0)return 0;const i=this.physicalMax(t,n);return this.clamp(e,0,o)*i/o}}const Wy="M4 6h16 M6 12h12 M9 18h6",ei=class ei{constructor(e="light"){B(this,"canvas");B(this,"theme");this.theme=e,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.pointerEvents="none"}getCanvas(){return this.canvas}render(e,t,n,o,i,r,s,a,c,u=Hn,h=null,f,d,p,y,m,v,x,g,S=null){this.canvas.width=0,this.canvas.height=0;const C=this.canvas.getContext("2d"),A=window.devicePixelRatio||1;this.canvas.width=e.width*A,this.canvas.height=e.height*A,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",C.scale(A,A);const[b,N]=n,R=this.buildMergeRenderData(v);if(!(u.frozenRows>0||u.frozenCols>0))this.renderQuadrantCells(C,b.r,N.r+1,b.c,N.c+1,i,t,r,s,f,d,p,y,m,R,x,g,S),this.renderColumnHeaders(C,b.c,N.c,t.left,ue,e.width,o,a,c,r,s),this.renderRowHeaders(C,b.r,N.r,t.top,oe,e.height,o,a,c,r,s);else{const D=u.frozenWidth,H=u.frozenHeight,J=u.frozenRows,te=u.frozenCols,le=J+1,ge=te+1,ce=Math.max(le,b.r),ee=Math.max(ge,b.c),G=r?r.getOffset(le):J*oe,Q=s?s.getOffset(ge):te*at;C.save(),C.beginPath(),C.rect(ue+D,oe+H,e.width-ue-D,e.height-oe-H),C.clip(),this.renderQuadrantCells(C,ce,N.r+1,ee,N.c+1,i,{left:t.left+Q-D,top:t.top+G-H},r,s,f,d,p,y,m,R,x,g,S),C.restore(),J>0&&(C.save(),C.beginPath(),C.rect(ue+D,oe,e.width-ue-D,H),C.clip(),this.renderQuadrantCells(C,1,J+1,ee,N.c+1,i,{left:t.left+Q-D,top:0},r,s,f,d,p,y,m,R,x,g,S),C.restore()),te>0&&(C.save(),C.beginPath(),C.rect(ue,oe+H,D,e.height-oe-H),C.clip(),this.renderQuadrantCells(C,ce,N.r+1,1,te+1,i,{left:0,top:t.top+G-H},r,s,f,d,p,y,m,R,x,g,S),C.restore()),J>0&&te>0&&(C.save(),C.beginPath(),C.rect(ue,oe,D,H),C.clip(),this.renderQuadrantCells(C,1,J+1,1,te+1,i,{left:0,top:0},r,s,f,d,p,y,m,R,x,g,S),C.restore()),te>0&&this.renderColumnHeaders(C,1,te,0,ue,ue+D,o,a,c,r,s),this.renderColumnHeaders(C,ee,N.c,t.left+Q-D,ue+D,e.width,o,a,c,r,s),J>0&&this.renderRowHeaders(C,1,J,0,oe,oe+H,o,a,c,r,s),this.renderRowHeaders(C,ce,N.r,t.top+G-H,oe+H,e.height,o,a,c,r,s),this.renderFreezeLines(C,e,D,H)}const k=a==="all";C.fillStyle=k?this.getThemeColor("headerSelectedBGColor"):this.getThemeColor("headerBGColor"),C.fillRect(0,0,ue,oe),C.strokeStyle=this.getThemeColor("cellBorderColor"),C.lineWidth=Fa,C.strokeRect(0,0,ue,oe),this.renderFreezeHandles(C,u,h)}renderQuadrantCells(e,t,n,o,i,r,s,a,c,u,h,f,d,p,y,m,v,x=null){const g=new Map,S=(A,b,N)=>{const R=fe({r:A,c:b});if(g.has(R))return g.get(R)||void 0;const P=this.resolveEffectiveStyle(A,b,N,f,u,h,d,p);return g.set(R,P||null),P},C=this.buildTextOverflowRenderData(e,t,n,o,i,r,c,y,S);for(let A=t;A<=n;A++)for(let b=o;b<=i;b++){const N=fe({r:A,c:b});if(y!=null&&y.coverToAnchor.has(N))continue;const R=r==null?void 0:r.get(fe({r:A,c:b})),P=y==null?void 0:y.anchors.get(N),k=S(A,b,R),D=C==null?void 0:C.hiddenVerticalBoundaries.has(this.verticalBoundaryKey(A,b-1)),H=C==null?void 0:C.hiddenVerticalBoundaries.has(this.verticalBoundaryKey(A,b));this.renderCellBackground(e,{r:A,c:b},R,s,a,c,k,P,D,H)}for(let A=t;A<=n;A++)for(let b=o;b<=i;b++){const N=fe({r:A,c:b});if(y!=null&&y.coverToAnchor.has(N))continue;const R=r==null?void 0:r.get(fe({r:A,c:b})),P=y==null?void 0:y.anchors.get(N),k=S(A,b,R);this.renderCellCustomBorders(e,{r:A,c:b},s,a,c,k,P)}for(let A=t;A<=n;A++)for(let b=o;b<=i;b++){const N=fe({r:A,c:b});if(y!=null&&y.coverToAnchor.has(N))continue;const R=r==null?void 0:r.get(fe({r:A,c:b})),P=y==null?void 0:y.anchors.get(N),k=S(A,b,R),D=C==null?void 0:C.anchorToEndCol.get(N);this.renderCellContent(e,{r:A,c:b},R,s,a,c,k,r,i,P,D)}if(m){const A=m[0].r;if(A>=t&&A<=n){const b=Math.max(o,m[0].c),N=Math.min(i,m[1].c);for(let R=b;R<=N;R++){const P=fe({r:A,c:R});if(y!=null&&y.coverToAnchor.has(P))continue;const k=y==null?void 0:y.anchors.get(P);this.renderCellFilterButton(e,{r:A,c:R},s,a,c,k,!!(v!=null&&v.has(R)),x===R)}}}}renderColumnHeaders(e,t,n,o,i,r,s,a,c,u,h){e.save(),e.beginPath(),e.rect(i,0,r-i,oe),e.clip();for(let f=t;f<=n;f++){const d=h?h.getOffset(f):at*(f-1),p=h?h.getSize(f):at,y=ue+d-o,m=0,v=a==="all"||a==="column"&&c&&f>=c[0].c&&f<=c[1].c;this.renderHeader(e,y,m,p,oe,oi(f),s.c===f,v||!1)}e.restore()}renderCellFilterButton(e,t,n,o,i,r,s=!1,a=!1){const c=this.toCellRect(t,n,o,i,r),u=c.width,h=c.height;if(u<=6||h<=6)return;const f=Math.min(16,Math.max(12,u-4)),d=Math.min(16,Math.max(12,h-6)),p=c.left+u-f-2,y=c.top+Math.max(3,(h-d)/2);(s||a)&&(e.fillStyle=s?this.getThemeColor("selectionBGColor"):this.getThemeColor("headerSelectedBGColor"),e.fillRect(p,y,f,d));const m=s||a?this.getThemeColor("resizeHandleColor"):this.getThemeColor("cellTextColor"),v=Math.max(9,Math.min(12,Math.min(f,d)-3)),x=p+(f-v)/2,g=y+(d-v)/2;e.save(),e.translate(x,g),e.scale(v/24,v/24),e.strokeStyle=m,e.lineCap="round",e.lineJoin="round";const S=this.getFilterIconPath2D();S?(e.lineWidth=2,e.stroke(S)):(e.lineWidth=2,e.beginPath(),e.moveTo(4,6),e.lineTo(20,6),e.moveTo(6,12),e.lineTo(18,12),e.moveTo(9,18),e.lineTo(15,18),e.stroke()),e.restore()}getFilterIconPath2D(){return typeof Path2D>"u"?null:(ei.filterIconPath2D===void 0&&(ei.filterIconPath2D=new Path2D(Wy)),ei.filterIconPath2D)}renderRowHeaders(e,t,n,o,i,r,s,a,c,u,h){e.save(),e.beginPath(),e.rect(0,i,ue,r-i),e.clip();for(let f=t;f<=n;f++){const d=u?u.getOffset(f):oe*(f-1),p=u?u.getSize(f):oe;if(p<=0)continue;const y=0,m=d+oe-o,v=a==="all"||a==="row"&&c&&f>=c[0].r&&f<=c[1].r;this.renderHeader(e,y,m,ue,p,String(f),s.r===f,v||!1)}e.restore()}renderFreezeLines(e,t,n,o){if(e.strokeStyle=this.getThemeColor("freezeLineColor"),e.lineWidth=2,o>0){const i=oe+o;e.beginPath(),e.moveTo(0,i),e.lineTo(t.width,i),e.stroke()}if(n>0){const i=ue+n;e.beginPath(),e.moveTo(i,0),e.lineTo(i,t.height),e.stroke()}}renderFreezeHandles(e,t,n){const o=t.frozenRows>0||t.frozenCols>0,i=$p,r=o&&t.frozenRows>0?oe+t.frozenHeight-i/2:oe-i,s=n==="row";e.fillStyle=s?this.getThemeColor("freezeHandleHoverColor"):this.getThemeColor("freezeHandleColor"),e.fillRect(0,r,ue,i);const a=o&&t.frozenCols>0?ue+t.frozenWidth-i/2:ue-i,c=n==="column";e.fillStyle=c?this.getThemeColor("freezeHandleHoverColor"):this.getThemeColor("freezeHandleColor"),e.fillRect(a,0,i,oe)}renderHeader(e,t,n,o,i,r,s,a=!1){o<=0||i<=0||(e.fillStyle=a?this.getThemeColor("headerSelectedBGColor"):s?this.getThemeColor("headerActiveBGColor"):this.getThemeColor("headerBGColor"),e.fillRect(t,n,o,i),e.strokeStyle=this.getThemeColor("cellBorderColor"),e.lineWidth=Fa,e.strokeRect(t,n,o,i),e.fillStyle=this.getThemeColor("cellTextColor"),e.textAlign=ky,e.font=s||a?"bold 10px Arial":"10px Arial",e.fillText(r,t+o/2,n+Math.min(15,i-4)))}renderCellBackground(e,t,n,o,i,r,s,a,c=!1,u=!1){const h=this.toCellRect(t,o,i,r,a),f=s??(n==null?void 0:n.s);if(e.fillStyle=(f==null?void 0:f.bg)||this.getThemeColor("cellBGColor"),e.fillRect(h.left,h.top,h.width,h.height),e.beginPath(),e.strokeStyle=this.getThemeColor("cellBorderColor"),e.lineWidth=Fa,c||(e.moveTo(h.left,h.top),e.lineTo(h.left,h.top+h.height)),!u){const d=h.left+h.width;e.moveTo(d,h.top),e.lineTo(d,h.top+h.height)}e.moveTo(h.left,h.top),e.lineTo(h.left+h.width,h.top),e.moveTo(h.left,h.top+h.height),e.lineTo(h.left+h.width,h.top+h.height),e.stroke()}renderCellCustomBorders(e,t,n,o,i,r,s){if(!r||!r.bt&&!r.br&&!r.bb&&!r.bl)return;const a=this.toCellRect(t,n,o,i,s);if(e.beginPath(),e.strokeStyle=this.getThemeColor("customBorderColor"),e.lineWidth=By,r.bt&&(e.moveTo(a.left,a.top),e.lineTo(a.left+a.width,a.top)),r.br){const c=a.left+a.width;e.moveTo(c,a.top),e.lineTo(c,a.top+a.height)}if(r.bb){const c=a.top+a.height;e.moveTo(a.left,c),e.lineTo(a.left+a.width,c)}r.bl&&(e.moveTo(a.left,a.top),e.lineTo(a.left,a.top+a.height)),e.stroke()}renderCellContent(e,t,n,o,i,r,s,a,c,u,h){const f=this.toCellRect(t,o,i,r,u),d=s??(n==null?void 0:n.s),p=(n==null?void 0:n.v)||"";if(p){const y=qa(p,d==null?void 0:d.nf,d==null?void 0:d.dp),m=y.split(`
`),v=this.toCellFont(d);let x=f.width;const g=(d==null?void 0:d.al)||"left";if(!u&&h&&r&&h>t.c){let N=0;for(let R=t.c+1;R<=h;R++)N+=r.getSize(R);x=f.width+N}else if(!u&&m.length===1&&g==="left"&&a&&r&&c){e.save(),e.font=v;const N=e.measureText(y).width+fo*2;if(e.restore(),N>f.width){let R=0;for(let P=t.c+1;P<=c;P++){const k=a.get(fe({r:t.r,c:P}));if(k&&(k.v||k.f))break;const D=r.getSize(P);if(R+=D,f.width+R>=N)break}x=f.width+R}}e.save(),e.beginPath(),e.rect(f.left,f.top,x,f.height),e.clip(),e.fillStyle=(d==null?void 0:d.tc)||this.getThemeColor("cellTextColor"),e.font=v,e.textBaseline="top";let S;g==="center"?(e.textAlign="center",S=f.left+f.width/2):g==="right"?(e.textAlign="right",S=f.left+f.width-fo):(e.textAlign="left",S=f.left+fo);const C=(d==null?void 0:d.va)||"top",A=m.length*Tr*bo;let b;C==="middle"?b=f.top+(f.height-A)/2:C==="bottom"?b=f.top+f.height-A-Ua:b=f.top+Ua;for(let N=0;N<m.length;N++){const R=b+N*(Tr*bo);if(e.fillText(m[N],S,R),d!=null&&d.u){const P=e.measureText(m[N]),k=R+Tr+1;let D;g==="center"?D=S-P.width/2:g==="right"?D=S-P.width:D=S,e.beginPath(),e.strokeStyle=(d==null?void 0:d.tc)||this.getThemeColor("cellTextColor"),e.lineWidth=1,e.moveTo(D,k),e.lineTo(D+P.width,k),e.stroke()}if(d!=null&&d.st){const P=e.measureText(m[N]),k=R+Tr/2;let D;g==="center"?D=S-P.width/2:g==="right"?D=S-P.width:D=S,e.beginPath(),e.strokeStyle=(d==null?void 0:d.tc)||this.getThemeColor("cellTextColor"),e.lineWidth=1,e.moveTo(D,k),e.lineTo(D+P.width,k),e.stroke()}}e.restore()}}buildTextOverflowRenderData(e,t,n,o,i,r,s,a,c){if(!r||!s)return;const u=new Map,h=new Set;e.save();for(let f=t;f<=n;f++)for(let d=o;d<=i;d++){const p=fe({r:f,c:d});if(a!=null&&a.coverToAnchor.has(p)||a!=null&&a.anchors.has(p))continue;const y=r.get(p),m=(y==null?void 0:y.v)||"";if(!m)continue;const v=c==null?void 0:c(f,d,y);if(((v==null?void 0:v.al)||"left")!=="left")continue;const g=qa(m,v==null?void 0:v.nf,v==null?void 0:v.dp);if(g.split(`
`).length!==1)continue;const C=s.getSize(d);e.font=this.toCellFont(v);const A=e.measureText(g).width+fo*2;if(A<=C)continue;let b=C,N=d;for(let R=d+1;R<=i;R++){const P=c==null?void 0:c(f,R-1,r.get(fe({r:f,c:R-1}))),k=c==null?void 0:c(f,R,r.get(fe({r:f,c:R})));if(P!=null&&P.br||k!=null&&k.bl)break;const D=fe({r:f,c:R});if(a!=null&&a.coverToAnchor.has(D)||a!=null&&a.anchors.has(D))break;const H=r.get(D);if(H&&(H.v||H.f)||(b+=s.getSize(R),N=R,b>=A))break}if(N>d){u.set(p,N);for(let R=d;R<N;R++)h.add(this.verticalBoundaryKey(f,R))}}if(e.restore(),u.size!==0)return{anchorToEndCol:u,hiddenVerticalBoundaries:h}}resolveEffectiveStyle(e,t,n,o,i,r,s,a){const c=i==null?void 0:i.get(t),u=r==null?void 0:r.get(e),h=s?Lp(s,e,t):void 0,f=a?ry(a,e,t,n):void 0;if(!(!o&&!c&&!u&&!h&&!(n!=null&&n.s)&&!f))return{...o,...c,...u,...h,...n==null?void 0:n.s,...f}}buildMergeRenderData(e){if(!e||e.size===0)return;const t=new Map,n=new Map;for(const[o,i]of e){t.set(o,i);const r=be(o);for(let s=r.r;s<r.r+i.rs;s++)for(let a=r.c;a<r.c+i.cs;a++){const c=fe({r:s,c:a});c!==o&&n.set(c,o)}}return{anchors:t,coverToAnchor:n}}toCellRect(e,t,n,o,i){const r=Le(e,t,n,o);if(!i||i.rs===1&&i.cs===1)return r;const s=Le({r:e.r+i.rs-1,c:e.c+i.cs-1},t,n,o);return{left:r.left,top:r.top,width:s.left+s.width-r.left,height:s.top+s.height-r.top}}toCellFont(e){const t=[];return e!=null&&e.b&&t.push("bold"),e!=null&&e.i&&t.push("italic"),t.push(`${Tr}px Arial`),t.join(" ")}verticalBoundaryKey(e,t){return`${e}:${t}`}getThemeColor(e){return ve(this.theme,e)}cleanup(){this.canvas.remove()}};B(ei,"filterIconPath2D");let Ha=ei;class Gy{constructor(e="light"){B(this,"container");B(this,"theme");this.theme=e,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.display="none",this.container.style.zIndex="1000",this.container.style.minWidth="160px",this.container.style.borderRadius="4px",this.container.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)",this.container.style.padding="4px 0",this.container.style.fontSize="13px",this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.applyTheme(),this.handleDocumentClick=this.handleDocumentClick.bind(this)}getContainer(){return this.container}show(e,t,n){this.container.innerHTML="";for(const o of n){const i=document.createElement("div");i.textContent=o.label,i.style.padding="6px 16px",i.style.cursor="pointer",i.style.color=ve(this.theme,"cellTextColor"),i.addEventListener("mouseenter",()=>{i.style.backgroundColor=ve(this.theme,"selectionBGColor")}),i.addEventListener("mouseleave",()=>{i.style.backgroundColor="transparent"}),i.addEventListener("mousedown",r=>{r.preventDefault(),r.stopPropagation(),this.hide(),o.action()}),this.container.appendChild(i)}this.container.style.left=`${e}px`,this.container.style.top=`${t}px`,this.container.style.display="block",document.addEventListener("mousedown",this.handleDocumentClick)}hide(){this.container.style.display="none",document.removeEventListener("mousedown",this.handleDocumentClick)}cleanup(){this.hide(),this.container.remove()}handleDocumentClick(e){this.container.contains(e.target)||this.hide()}applyTheme(){this.container.style.backgroundColor=ve(this.theme,"cellBGColor"),this.container.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`}}const Rl=["Date","Engineering","Filter","Financial","Info","Logical","Lookup","Math","Operator","Statistical","Text","Database","Parser","Array","Web"],Yy=[{name:"SUM",description:"Returns the sum of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"ABS",description:"Returns the absolute value of a number",args:[{name:"number"}]},{name:"ROUND",description:"Rounds a number to a certain number of decimal places",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDUP",description:"Rounds a number away from zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDDOWN",description:"Rounds a number toward zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"INT",description:"Rounds a number down to the nearest integer",args:[{name:"value"}]},{name:"MOD",description:"Returns the remainder after division",args:[{name:"dividend"},{name:"divisor"}]},{name:"SQRT",description:"Returns the positive square root of a number",args:[{name:"value"}]},{name:"POWER",description:"Returns a number raised to a power",args:[{name:"base"},{name:"exponent"}]},{name:"PRODUCT",description:"Multiplies a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MEDIAN",description:"Returns the middle number in a series",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"RAND",description:"Returns a random number between 0 and 1",args:[]},{name:"RANDBETWEEN",description:"Returns a random integer between two values",args:[{name:"low"},{name:"high"}]},{name:"IF",description:"Returns one value if true and another if false",args:[{name:"condition"},{name:"value_if_true"},{name:"value_if_false",optional:!0}]},{name:"IFS",description:"Returns the first value whose condition is true",args:[{name:"condition1"},{name:"value1"},{name:"condition2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0}]},{name:"SWITCH",description:"Matches an expression against case/value pairs",args:[{name:"expression"},{name:"case1"},{name:"value1"},{name:"case2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0},{name:"default",optional:!0}]},{name:"AND",description:"Returns TRUE if all arguments are true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"OR",description:"Returns TRUE if any argument is true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"NOT",description:"Returns the opposite of a logical value",args:[{name:"logical"}]},{name:"AVERAGE",description:"Returns the average of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MIN",description:"Returns the smallest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MAX",description:"Returns the largest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"COUNT",description:"Counts the number of numeric values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTA",description:"Counts the number of non-empty values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTBLANK",description:"Counts empty cells",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTIF",description:"Counts values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"}]},{name:"SUMIF",description:"Sums values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"},{name:"sum_range",optional:!0}]},{name:"COUNTIFS",description:"Counts values that meet multiple criteria",args:[{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"SUMIFS",description:"Sums values that meet multiple criteria",args:[{name:"sum_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"MATCH",description:"Returns the position of an item in a one-dimensional range",args:[{name:"search_key"},{name:"range"},{name:"search_type",optional:!0}]},{name:"INDEX",description:"Returns the value at a given row and column of a range",args:[{name:"reference"},{name:"row",optional:!0},{name:"column",optional:!0}]},{name:"VLOOKUP",description:"Looks up a value in the first column of a range",args:[{name:"search_key"},{name:"range"},{name:"index"},{name:"is_sorted",optional:!0}]},{name:"HLOOKUP",description:"Looks up a value in the first row of a range",args:[{name:"search_key"},{name:"range"},{name:"index"},{name:"is_sorted",optional:!0}]},{name:"TRIM",description:"Removes leading and trailing whitespace from text",args:[{name:"text"}]},{name:"LEN",description:"Returns the number of characters in a text string",args:[{name:"text"}]},{name:"LEFT",description:"Returns the leftmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"RIGHT",description:"Returns the rightmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"MID",description:"Returns characters from the middle of a text string",args:[{name:"text"},{name:"start_num"},{name:"num_chars"}]},{name:"CONCATENATE",description:"Joins two or more text strings into one",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"CONCAT",description:"Joins text values into one string",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"FIND",description:"Finds one text value inside another (case-sensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"SEARCH",description:"Finds one text value inside another (case-insensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"TEXTJOIN",description:"Joins text values with a delimiter",args:[{name:"delimiter"},{name:"ignore_empty"},{name:"text1"},{name:"text2",optional:!0,repeating:!0}]},{name:"LOWER",description:"Converts text to lowercase",args:[{name:"text"}]},{name:"UPPER",description:"Converts text to uppercase",args:[{name:"text"}]},{name:"PROPER",description:"Capitalizes each word in text",args:[{name:"text"}]},{name:"SUBSTITUTE",description:"Replaces existing text with new text in a string",args:[{name:"text"},{name:"search_for"},{name:"replace_with"},{name:"occurrence",optional:!0}]},{name:"TODAY",description:"Returns the current date",args:[]},{name:"NOW",description:"Returns the current date and time",args:[]},{name:"DATE",description:"Returns a date from year, month, and day values",args:[{name:"year"},{name:"month"},{name:"day"}]},{name:"TIME",description:"Returns a time from hour, minute, and second values",args:[{name:"hour"},{name:"minute"},{name:"second"}]},{name:"DAYS",description:"Returns the number of days between two dates",args:[{name:"end_date"},{name:"start_date"}]},{name:"YEAR",description:"Returns the year from a date",args:[{name:"date"}]},{name:"MONTH",description:"Returns the month from a date (1-12)",args:[{name:"date"}]},{name:"DAY",description:"Returns the day of the month from a date (1-31)",args:[{name:"date"}]},{name:"HOUR",description:"Returns the hour from a date/time (0-23)",args:[{name:"time"}]},{name:"MINUTE",description:"Returns the minute from a date/time (0-59)",args:[{name:"time"}]},{name:"SECOND",description:"Returns the second from a date/time (0-59)",args:[{name:"time"}]},{name:"WEEKDAY",description:"Returns day of the week as a number",args:[{name:"date"},{name:"type",optional:!0}]},{name:"ISBLANK",description:"Checks whether a value is blank",args:[{name:"value"}]},{name:"ISNUMBER",description:"Checks whether a value is a number",args:[{name:"value"}]},{name:"ISTEXT",description:"Checks whether a value is text",args:[{name:"value"}]},{name:"ISERROR",description:"Checks whether a value is any error",args:[{name:"value"}]},{name:"ISERR",description:"Checks whether a value is an error except #N/A!",args:[{name:"value"}]},{name:"ISNA",description:"Checks whether a value is the #N/A! error",args:[{name:"value"}]},{name:"ISLOGICAL",description:"Checks whether a value is boolean",args:[{name:"value"}]},{name:"ISNONTEXT",description:"Checks whether a value is not text",args:[{name:"value"}]},{name:"IFERROR",description:"Returns a value if no error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_error"}]},{name:"IFNA",description:"Returns a value if no #N/A! error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_na"}]}],Xy={Date:new Set(["TODAY","NOW","DATE","TIME","DAYS","YEAR","MONTH","DAY","HOUR","MINUTE","SECOND","WEEKDAY"]),Info:new Set(["ISBLANK","ISNUMBER","ISTEXT","ISERROR","ISERR","ISNA","ISLOGICAL","ISNONTEXT"]),Logical:new Set(["IF","IFS","SWITCH","AND","OR","NOT","IFERROR","IFNA"]),Lookup:new Set(["MATCH","INDEX","VLOOKUP","HLOOKUP"]),Math:new Set(["SUM","ABS","ROUND","ROUNDUP","ROUNDDOWN","INT","MOD","SQRT","POWER","PRODUCT","RAND","RANDBETWEEN","COUNTBLANK","COUNTIF","SUMIF","COUNTIFS","SUMIFS"]),Statistical:new Set(["AVERAGE","MIN","MAX","COUNT","COUNTA","MEDIAN"]),Text:new Set(["TRIM","LEN","LEFT","RIGHT","MID","CONCATENATE","CONCAT","FIND","SEARCH","TEXTJOIN","LOWER","UPPER","PROPER","SUBSTITUTE"])};function Ky(l){var e;for(const t of Rl)if((e=Xy[t])!=null&&e.has(l))return t;throw new Error(`Missing Sheets category for function: ${l}`)}const ti=Yy.map(l=>({...l,category:Ky(l.name)}));function Qy(l=ti){const e=new Set(l.map(t=>t.category));return Rl.filter(t=>e.has(t))}function Jy(l){const e=l.toUpperCase();return ti.filter(t=>t.name.startsWith(e))}function Zy(l){const e=l.toUpperCase();return ti.find(t=>t.name===e)}function $a(l){const e=l.args.map(t=>{let n=t.optional?`[${t.name}]`:t.name;return t.repeating&&(n+=", ..."),n});return`${l.name}(${e.join(", ")})`}function ev(l,e){if(!l.startsWith("="))return{type:"none"};const t=l.slice(1,e);let n=0,o=0;for(let r=t.length-1;r>=0;r--){const s=t[r];if(s===")")n++;else if(s==="(")if(n>0)n--;else{const a=t.slice(0,r).match(/([A-Za-z_]\w*)$/);return a?{type:"argument",funcName:a[1].toUpperCase(),argIndex:o}:{type:"none"}}else s===","&&n===0&&o++}const i=t.match(/([A-Za-z_]\w*)$/);return i?{type:"function-name",prefix:i[1]}:{type:"none"}}class tv{constructor(e="light"){B(this,"container");B(this,"theme");B(this,"selectedIndex",0);B(this,"matches",[]);B(this,"mode","hidden");B(this,"currentHint",null);this.theme=e,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.display="none",this.container.style.zIndex="1000",this.container.style.minWidth="220px",this.container.style.maxWidth="360px",this.container.style.borderRadius="4px",this.container.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)",this.container.style.padding="4px 0",this.container.style.fontSize="13px",this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.container.style.overflow="hidden",this.applyTheme()}getContainer(){return this.container}showList(e,t){if(this.matches=Jy(e),this.matches.length===0){this.hide();return}this.mode="list",this.selectedIndex=0,this.renderList(),this.positionAt(t),this.container.style.display="block"}showHint(e,t,n){const o=Zy(e);if(!o){this.hide();return}this.mode="hint",this.currentHint={info:o,argIndex:t},this.renderHint(),this.positionAt(n),this.container.style.display="block"}hide(){this.mode="hidden",this.matches=[],this.currentHint=null,this.container.style.display="none",this.container.innerHTML=""}reposition(e){this.mode!=="hidden"&&this.positionAt(e)}moveUp(){this.mode!=="list"||this.matches.length===0||(this.selectedIndex=(this.selectedIndex-1+this.matches.length)%this.matches.length,this.renderList())}moveDown(){this.mode!=="list"||this.matches.length===0||(this.selectedIndex=(this.selectedIndex+1)%this.matches.length,this.renderList())}getSelectedFunction(){if(this.mode==="list")return this.matches[this.selectedIndex]}isListVisible(){return this.mode==="list"}isHintVisible(){return this.mode==="hint"}cleanup(){this.hide(),this.container.remove()}positionAt(e){this.container.style.left=`${e.left}px`,this.container.style.top=`${e.top}px`}renderList(){this.container.innerHTML="";const e=ve(this.theme,"cellBGColor"),t=ve(this.theme,"cellTextColor"),n=ve(this.theme,"selectionBGColor"),o=ve(this.theme,"activeCellColor");for(let i=0;i<this.matches.length;i++){const r=this.matches[i],s=document.createElement("div");s.style.padding="4px 10px",s.style.cursor="pointer",s.style.display="flex",s.style.flexDirection="column",s.style.gap="1px",s.style.backgroundColor=i===this.selectedIndex?n:e;const a=document.createElement("div");a.style.fontWeight="600",a.style.color=i===this.selectedIndex?o:t,a.textContent=r.name;const c=document.createElement("div");c.style.fontSize="11px",c.style.opacity="0.7",c.style.color=t,c.textContent=r.description,s.appendChild(a),s.appendChild(c),s.addEventListener("mouseenter",()=>{this.selectedIndex=i,this.renderList()}),s.addEventListener("mousedown",u=>{u.preventDefault(),u.stopPropagation()}),this.container.appendChild(s)}}renderHint(){if(this.container.innerHTML="",!this.currentHint)return;const{info:e,argIndex:t}=this.currentHint,n=ve(this.theme,"cellTextColor"),o=ve(this.theme,"activeCellColor"),i=document.createElement("div");i.style.padding="6px 10px",i.style.color=n,i.style.whiteSpace="nowrap";const r=document.createElement("span");r.style.fontWeight="600",r.textContent=e.name+"(",i.appendChild(r);for(let a=0;a<e.args.length;a++){a>0&&i.appendChild(document.createTextNode(", "));const c=e.args[a];let u=c.optional?`[${c.name}]`:c.name;c.repeating&&(u+=", ...");const h=document.createElement("span");(a===t||a===e.args.length-1&&c.repeating&&t>=a)&&(h.style.fontWeight="700",h.style.color=o),h.textContent=u,i.appendChild(h)}i.appendChild(document.createTextNode(")"));const s=document.createElement("div");s.style.fontSize="11px",s.style.opacity="0.7",s.style.color=n,s.style.padding="2px 10px 4px",s.textContent=$a(e)+"  "+e.description,this.container.appendChild(i),this.container.appendChild(s)}applyTheme(){this.container.style.backgroundColor=ve(this.theme,"cellBGColor"),this.container.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`}}class rv{constructor(e="light"){B(this,"theme");B(this,"container");B(this,"panel");B(this,"searchInput");B(this,"status");B(this,"list");B(this,"rows",[]);B(this,"matches",[...ti]);B(this,"selectedIndex",0);B(this,"listTextColor","");B(this,"listSelectedBG","");B(this,"listActiveColor","");B(this,"onInsert");B(this,"onClose");B(this,"boundHandleBackdropMouseDown");B(this,"boundHandleSearchInput");B(this,"boundHandleSearchKeydown");B(this,"boundHandleListPointerDown");B(this,"boundHandleListClick");B(this,"boundHandleListMouseOver");this.theme=e,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.inset="0",this.container.style.display="none",this.container.style.zIndex="1100",this.container.style.backgroundColor="rgba(0, 0, 0, 0.18)",this.container.style.padding="40px 16px 16px",this.container.style.boxSizing="border-box",this.panel=document.createElement("div"),this.panel.style.margin="0 auto",this.panel.style.maxWidth="720px",this.panel.style.height="min(560px, calc(100vh - 72px))",this.panel.style.display="flex",this.panel.style.flexDirection="column",this.panel.style.backgroundColor=ve(this.theme,"cellBGColor"),this.panel.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.panel.style.borderRadius="8px",this.panel.style.boxShadow="0 10px 30px rgba(0, 0, 0, 0.2)",this.panel.style.color=ve(this.theme,"cellTextColor"),this.panel.style.overflow="hidden";const t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between",t.style.padding="12px 14px",t.style.borderBottom=`1px solid ${ve(this.theme,"cellBorderColor")}`;const n=document.createElement("div");n.textContent="Functions",n.style.font="600 14px Arial",t.appendChild(n);const o=document.createElement("button");o.type="button",o.textContent="Close",o.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`,o.style.borderRadius="4px",o.style.backgroundColor=ve(this.theme,"cellBGColor"),o.style.color=ve(this.theme,"cellTextColor"),o.style.padding="4px 8px",o.style.font="12px Arial",o.style.cursor="pointer",o.addEventListener("click",()=>this.hide()),t.appendChild(o);const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="6px",i.style.padding="12px 14px 10px",i.style.borderBottom=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.searchInput=document.createElement("input"),this.searchInput.type="text",this.searchInput.placeholder="Search by name or description",this.searchInput.style.width="100%",this.searchInput.style.boxSizing="border-box",this.searchInput.style.padding="7px 10px",this.searchInput.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.searchInput.style.borderRadius="4px",this.searchInput.style.outline="none",this.searchInput.style.font="13px Arial",this.searchInput.style.color=ve(this.theme,"cellTextColor"),this.searchInput.style.backgroundColor=ve(this.theme,"cellBGColor"),i.appendChild(this.searchInput),this.status=document.createElement("div"),this.status.style.font="12px Arial",this.status.style.opacity="0.75",i.appendChild(this.status),this.list=document.createElement("div"),this.list.style.flex="1",this.list.style.overflow="auto",this.list.style.padding="6px 0",this.panel.appendChild(t),this.panel.appendChild(i),this.panel.appendChild(this.list),this.container.appendChild(this.panel),this.boundHandleBackdropMouseDown=r=>{r.target===this.container&&this.hide()},this.boundHandleSearchInput=()=>{this.selectedIndex=0,this.filterAndRender()},this.boundHandleSearchKeydown=r=>{if(r.key==="ArrowDown"){r.preventDefault(),this.matches.length>0&&(this.setSelectedIndex((this.selectedIndex+1)%this.matches.length),this.scrollSelectedIntoView());return}if(r.key==="ArrowUp"){r.preventDefault(),this.matches.length>0&&(this.setSelectedIndex((this.selectedIndex-1+this.matches.length)%this.matches.length),this.scrollSelectedIntoView());return}if(r.key==="Enter"){r.preventDefault(),this.insertSelected();return}r.key==="Escape"&&(r.preventDefault(),this.hide())},this.boundHandleListPointerDown=r=>{if(r.button!==0)return;const s=this.getRowIndexFromTarget(r.target);s!==null&&(r.preventDefault(),this.setSelectedIndex(s),this.insertSelected())},this.boundHandleListClick=r=>{if(r.button!==0||!this.isVisible())return;const s=this.getRowIndexFromTarget(r.target);s!==null&&(r.preventDefault(),this.setSelectedIndex(s),this.insertSelected())},this.boundHandleListMouseOver=r=>{const s=this.getRowIndexFromTarget(r.target);s===null||s===this.selectedIndex||this.setSelectedIndex(s)},this.container.addEventListener("mousedown",this.boundHandleBackdropMouseDown),this.searchInput.addEventListener("input",this.boundHandleSearchInput),this.searchInput.addEventListener("keydown",this.boundHandleSearchKeydown),this.list.addEventListener("pointerdown",this.boundHandleListPointerDown),this.list.addEventListener("click",this.boundHandleListClick),this.list.addEventListener("mouseover",this.boundHandleListMouseOver),this.filterAndRender()}getContainer(){return this.container}setOnInsert(e){this.onInsert=e}setOnClose(e){this.onClose=e}contains(e){return e instanceof Node&&this.container.contains(e)}isVisible(){return this.container.style.display!=="none"}show(){this.searchInput.value="",this.selectedIndex=0,this.filterAndRender(),this.container.style.display="block",requestAnimationFrame(()=>this.searchInput.focus())}hide(){var e;this.isVisible()&&(this.container.style.display="none",(e=this.onClose)==null||e.call(this))}cleanup(){this.container.removeEventListener("mousedown",this.boundHandleBackdropMouseDown),this.searchInput.removeEventListener("input",this.boundHandleSearchInput),this.searchInput.removeEventListener("keydown",this.boundHandleSearchKeydown),this.list.removeEventListener("pointerdown",this.boundHandleListPointerDown),this.list.removeEventListener("click",this.boundHandleListClick),this.list.removeEventListener("mouseover",this.boundHandleListMouseOver),this.container.remove()}filterAndRender(){const e=this.searchInput.value.trim().toUpperCase(),t=e.length===0?ti:ti.filter(o=>{const i=o.name.toUpperCase(),r=o.description.toUpperCase(),s=$a(o).toUpperCase();return i.includes(e)||r.includes(e)||s.includes(e)}),n=new Map(Rl.map((o,i)=>[o,i]));this.matches=[...t].sort((o,i)=>{const r=n.get(o.category)??Number.MAX_SAFE_INTEGER,s=n.get(i.category)??Number.MAX_SAFE_INTEGER;return r!==s?r-s:o.name.localeCompare(i.name)}),this.selectedIndex>=this.matches.length&&(this.selectedIndex=Math.max(0,this.matches.length-1)),this.renderList()}renderList(){this.list.innerHTML="",this.rows=[];const e=Qy(this.matches);if(this.status.textContent=`${this.matches.length} functions in ${e.length} categories`,this.matches.length===0){const o=document.createElement("div");o.textContent="No matching functions",o.style.padding="16px 14px",o.style.font="13px Arial",o.style.opacity="0.8",this.list.appendChild(o);return}const t=ve(this.theme,"cellBorderColor");this.listTextColor=ve(this.theme,"cellTextColor"),this.listSelectedBG=ve(this.theme,"selectionBGColor"),this.listActiveColor=ve(this.theme,"activeCellColor");let n=null;for(let o=0;o<this.matches.length;o++){const i=this.matches[o];if(i.category!==n){const d=document.createElement("div");d.dataset.funcCategoryHeader=i.category,d.textContent=i.category,d.style.padding="8px 14px 4px",d.style.font="600 11px Arial",d.style.letterSpacing="0.04em",d.style.textTransform="uppercase",d.style.opacity="0.68",d.style.borderBottom=`1px solid ${t}`,d.style.backgroundColor=ve(this.theme,"headerBGColor"),this.list.appendChild(d),n=i.category}const r=document.createElement("div");r.dataset.funcName=i.name,r.dataset.funcIndex=String(o),r.style.display="flex",r.style.gap="10px",r.style.alignItems="flex-start",r.style.justifyContent="flex-start",r.style.padding="10px 14px",r.style.cursor="pointer",r.style.borderBottom=`1px solid ${t}`,r.style.backgroundColor="transparent";const s=document.createElement("div");s.style.minWidth="0",s.style.flex="1";const a=document.createElement("div");a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.gap="8px";const c=document.createElement("div");c.textContent=i.name,c.style.font="600 13px Arial",c.style.color=this.listTextColor,c.style.flex="1";const u=document.createElement("div");u.textContent=i.category,u.style.font="11px Arial",u.style.opacity="0.66",u.style.whiteSpace="nowrap";const h=document.createElement("div");h.textContent=$a(i),h.style.font="12px Arial",h.style.opacity="0.82",h.style.marginTop="2px",h.style.wordBreak="break-word";const f=document.createElement("div");f.textContent=i.description,f.style.font="12px Arial",f.style.opacity="0.72",f.style.marginTop="2px",f.style.wordBreak="break-word",a.appendChild(c),a.appendChild(u),s.appendChild(a),s.appendChild(h),s.appendChild(f),r.appendChild(s),this.list.appendChild(r),this.rows.push({row:r,name:c})}this.updateRowSelection(this.selectedIndex)}scrollSelectedIntoView(){var t;const e=(t=this.rows[this.selectedIndex])==null?void 0:t.row;e&&e.scrollIntoView({block:"nearest"})}getRowIndexFromTarget(e){if(!(e instanceof Element))return null;const t=e.closest("[data-func-index]");if(!(t instanceof HTMLDivElement)||!this.list.contains(t))return null;const n=Number(t.dataset.funcIndex);return Number.isInteger(n)?n:null}setSelectedIndex(e){if(e===this.selectedIndex||e<0||e>=this.matches.length)return;const t=this.selectedIndex;this.selectedIndex=e,this.updateRowSelection(t),this.updateRowSelection(e)}updateRowSelection(e){const t=this.rows[e];if(!t)return;const n=e===this.selectedIndex;t.row.style.backgroundColor=n?this.listSelectedBG:"transparent",t.name.style.color=n?this.listActiveColor:this.listTextColor}insertSelected(){var t;const e=this.matches[this.selectedIndex];e&&((t=this.onInsert)==null||t.call(this,e),this.hide())}}const ld=l=>l.length===1?l.toLowerCase():l,Va=l=>l.metaKey||l.ctrlKey,Pe=(l,e)=>ld(l.key)===ld(e),et=(l,e)=>!(!Pe(l,e.key)||e.mod!==void 0&&Va(l)!==e.mod||e.shift!==void 0&&l.shiftKey!==e.shift||e.alt!==void 0&&l.altKey!==e.alt),ud=async(l,e)=>{for(const t of e)if(t.match(l))return await t.run(l),!0;return!1},mo=6,nv=10,cd=20,hd=120,fd=300,iv=1800,Qn=8,xo=4,ov=200,Jn=8;class sv{constructor(e,t="light",n=!1){B(this,"sheet");B(this,"theme");B(this,"container");B(this,"formulaBar");B(this,"cellInput");B(this,"overlay");B(this,"gridContainer");B(this,"gridCanvas");B(this,"contextMenu");B(this,"autocomplete");B(this,"functionBrowser");B(this,"resizeTooltip");B(this,"filterPanel");B(this,"filterPanelState",null);B(this,"filterPanelOutsideClickUnsub",null);B(this,"filterPanelKeyboardUnsub",null);B(this,"rowDim");B(this,"colDim");B(this,"hiddenRows",new Set);B(this,"hiddenRowSizeBackup",new Map);B(this,"listeners",[]);B(this,"interactionCleanups",new Set);B(this,"resizeObserver");B(this,"preventDocumentSelectStart",e=>{e.preventDefault()});B(this,"resizeHover",null);B(this,"dragMove",null);B(this,"editMode",!1);B(this,"manuallyResizedRows",new Set);B(this,"formulaRanges",[]);B(this,"freezeState",Hn);B(this,"freezeHandleHover",null);B(this,"filterButtonHoverCol",null);B(this,"freezeDrag",null);B(this,"autofillPreview");B(this,"onRenderCallback");B(this,"readOnly");B(this,"formulaRangeAnchor",null);B(this,"activeFormulaInput",null);B(this,"formulaRefInsertPos",null);B(this,"lastFormulaRefTarget",null);B(this,"nativeSelectionBlockDepth",0);B(this,"previousBodyUserSelect","");B(this,"previousBodyWebkitUserSelect","");B(this,"pendingRenderFrame",null);B(this,"renderInFlight",!1);B(this,"renderQueued",!1);B(this,"renderVersion",0);this.container=e,this.theme=t,this.readOnly=n,this.formulaBar=new My(t,n),this.gridContainer=new Vy(t),this.overlay=new $y(t),this.gridCanvas=new Ha(t),this.cellInput=new Hy(t),this.contextMenu=new Gy(t),this.autocomplete=new tv(t),this.functionBrowser=new rv(t),this.resizeTooltip=document.createElement("div"),this.filterPanel=document.createElement("div"),this.rowDim=new Zf(oe),this.colDim=new Zf(at),this.gridContainer.appendChild(this.overlay.getContainer()),this.gridContainer.appendChild(this.gridCanvas.getCanvas()),this.gridContainer.appendChild(this.cellInput.getContainer()),this.container.appendChild(this.formulaBar.getContainer()),this.container.appendChild(this.gridContainer.getContainer()),this.container.appendChild(this.contextMenu.getContainer()),this.container.appendChild(this.autocomplete.getContainer()),document.body.appendChild(this.functionBrowser.getContainer()),this.resizeTooltip.style.position="fixed",this.resizeTooltip.style.display="none",this.resizeTooltip.style.pointerEvents="none",this.resizeTooltip.style.zIndex="1001",this.resizeTooltip.style.padding="4px 8px",this.resizeTooltip.style.borderRadius="4px",this.resizeTooltip.style.border=`1px solid ${ve(t,"cellBorderColor")}`,this.resizeTooltip.style.backgroundColor=ve(t,"cellBGColor"),this.resizeTooltip.style.color=ve(t,"cellTextColor"),this.resizeTooltip.style.fontSize="11px",this.resizeTooltip.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.resizeTooltip.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)",document.body.appendChild(this.resizeTooltip),this.filterPanel.style.position="fixed",this.filterPanel.style.display="none",this.filterPanel.style.zIndex="1002",this.filterPanel.style.width="260px",this.filterPanel.style.maxHeight="360px",this.filterPanel.style.overflow="hidden",this.filterPanel.style.borderRadius="6px",this.filterPanel.style.border=`1px solid ${ve(t,"cellBorderColor")}`,this.filterPanel.style.backgroundColor=ve(t,"cellBGColor"),this.filterPanel.style.color=ve(t,"cellTextColor"),this.filterPanel.style.fontSize="12px",this.filterPanel.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.filterPanel.style.boxShadow="0 4px 14px rgba(0, 0, 0, 0.2)",document.body.appendChild(this.filterPanel),this.functionBrowser.setOnInsert(o=>{this.readOnly||this.insertFunctionFromBrowser(o.name)}),this.resizeObserver=new ResizeObserver(()=>this.render())}async initialize(e){this.sheet=e,this.sheet.setDimensions(this.rowDim,this.colDim),await this.sheet.loadDimensions(),await this.sheet.loadStyles(),await this.sheet.loadMerges(),await this.sheet.loadFreezePane(),await this.sheet.loadFilterState(),this.hiddenRows.clear(),this.hiddenRowSizeBackup.clear(),this.syncHiddenRowsFromSheet(),this.updateFreezeState(),this.formulaBar.initialize(e),this.addEventListeners(),this.resizeObserver.observe(this.container),this.render()}updateFreezeState(){const{frozenRows:e,frozenCols:t}=this.sheet.getFreezePane();this.freezeState=jy(e,t,this.rowDim,this.colDim)}async setFreezePane(e,t){await this.sheet.setFreezePane(e,t),this.updateFreezeState(),this.render()}async reloadFreezePane(){await this.sheet.loadFreezePane(),this.updateFreezeState()}panBy(e,t){this.gridContainer.scrollBy(e,t)}handleMobileDoubleTap(e,t){const{x:n,y:o}=this.clampClientPointToViewport(e,t);this.handleDblClickAt(n,o)}async focusCell(e){await this.finishEditing(),this.focusGrid(),this.sheet.selectStart(e),this.render(),this.scrollIntoView()}cleanup(){this.pendingRenderFrame!==null&&(cancelAnimationFrame(this.pendingRenderFrame),this.pendingRenderFrame=null),this.cancelActiveInteractions(),this.removeAllEventListeners(),this.forceEndNativeSelectionBlock(),this.resizeObserver.disconnect(),this.formulaBar.cleanup(),this.cellInput.cleanup(),this.overlay.cleanup(),this.gridCanvas.cleanup(),this.gridContainer.cleanup(),this.contextMenu.cleanup(),this.autocomplete.cleanup(),this.functionBrowser.cleanup(),this.resizeTooltip.remove(),this.hideFilterPanel(),this.filterPanel.remove(),this.sheet=void 0,this.container.innerHTML=""}beginNativeSelectionBlock(){if(this.nativeSelectionBlockDepth+=1,this.nativeSelectionBlockDepth!==1)return;const e=document.body.style;this.previousBodyUserSelect=e.userSelect,this.previousBodyWebkitUserSelect=e.webkitUserSelect,e.userSelect="none",e.webkitUserSelect="none",document.addEventListener("selectstart",this.preventDocumentSelectStart)}endNativeSelectionBlock(){if(this.nativeSelectionBlockDepth===0||(this.nativeSelectionBlockDepth-=1,this.nativeSelectionBlockDepth>0))return;const e=document.body.style;e.userSelect=this.previousBodyUserSelect,e.webkitUserSelect=this.previousBodyWebkitUserSelect,document.removeEventListener("selectstart",this.preventDocumentSelectStart)}forceEndNativeSelectionBlock(){this.nativeSelectionBlockDepth!==0&&(this.nativeSelectionBlockDepth=1,this.endNativeSelectionBlock())}showResizeTooltip(e,t,n,o,i){const r=e==="column"?"Width":"Height",s=i>1?` (${i} ${e==="column"?"columns":"rows"})`:"";this.resizeTooltip.textContent=`${r}: ${Math.round(t)}px${s}`,this.resizeTooltip.style.left=`${n+12}px`,this.resizeTooltip.style.top=`${o+12}px`,this.resizeTooltip.style.display="block"}hideResizeTooltip(){this.resizeTooltip.style.display="none"}bindEventListener(e,t,n,o){e.addEventListener(t,n,o);let i=!0;return()=>{i&&(i=!1,e.removeEventListener(t,n,o))}}addEventListener(e,t,n,o){const i=this.bindEventListener(e,t,n,o);return this.listeners.push(i),i}registerInteractionCleanup(e){let t=!0;const n=()=>{t&&(t=!1,this.interactionCleanups.delete(n),e())};return this.interactionCleanups.add(n),n}addInteractionEventListener(e,t,n,o){const i=this.bindEventListener(e,t,n,o);return this.registerInteractionCleanup(i)}startMouseDragSession({onMove:e,onComplete:t,onCleanup:n}){let o=()=>{};const i=()=>{try{t==null||t()}finally{o()}},r=this.addInteractionEventListener(document,"mousemove",e),s=this.addInteractionEventListener(document,"mouseup",i);return o=this.registerInteractionCleanup(()=>{r(),s(),n==null||n()}),o}cancelActiveInteractions(){for(const e of Array.from(this.interactionCleanups))e()}removeAllEventListeners(){for(const e of this.listeners)e();this.listeners=[]}focusGrid(){var e;this.formulaBar.blur(),this.cellInput.hide(),this.autocomplete.hide(),this.functionBrowser.hide(),this.formulaRanges=[],this.resetFormulaRangeState(),(e=window.getSelection())==null||e.removeAllRanges()}async finishEditing(){this.autocomplete.hide(),this.functionBrowser.hide();const e=this.sheet.getActiveCell();let t=!1;if(this.formulaBar.isFocused())this.readOnly||(await this.sheet.setData(e,this.formulaBar.getValue()),t=!0),this.formulaBar.blur(),this.cellInput.hide();else if(this.cellInput.isFocused())this.readOnly||(await this.sheet.setData(e,this.cellInput.getValue()),t=!0),this.cellInput.hide();else return;this.formulaRanges=[],this.resetFormulaRangeState(),t&&await this.autoResizeRow(e.r)}isExternalInput(e){if(this.functionBrowser.contains(e))return!0;if(!(e instanceof Element)||this.container.contains(e))return!1;const t=e.tagName;return!!(t==="INPUT"||t==="TEXTAREA"||t==="SELECT"||e.isContentEditable)}handleKeyDown(e){if(this.functionBrowser.isVisible()){e.key==="Escape"&&(e.preventDefault(),this.functionBrowser.hide());return}if(!this.isExternalInput(e.target)){if(this.formulaBar.isFocused()){this.handleFormulaKeydown(e);return}else if(this.cellInput.isFocused()){this.handleCellInputKeydown(e);return}this.handleGridKeydown(e)}}handleKeyUp(e){if(this.functionBrowser.isVisible()||this.isExternalInput(e.target))return;const n=(e.key==="ArrowDown"||e.key==="ArrowUp"||e.key==="Escape"||e.key==="Enter"||e.key==="Tab")&&(this.autocomplete.isListVisible()||this.autocomplete.isHintVisible());let o,i;this.formulaBar.isFocused()?(o=this.formulaBar.getValue(),i=this.formulaBar.getFormulaInput(),this.cellInput.setValue(o)):this.cellInput.isFocused()&&(o=this.cellInput.getValue(),i=this.cellInput.getInput(),this.formulaBar.setValue(o)),o!==void 0&&o.startsWith("=")?(this.formulaRanges=Bi(o).map(r=>r.range),this.renderOverlay()):o!==void 0&&(this.formulaRanges=[],this.renderOverlay()),!n&&(i&&o!==void 0?this.updateAutocomplete(o,i):this.autocomplete.hide())}updateAutocomplete(e,t){if(!e.startsWith("=")){this.autocomplete.hide();return}const n=xr(t);if(!n){this.autocomplete.hide();return}const o=n.end,i=ev(e,o),r=t.getBoundingClientRect(),s={left:r.left,top:r.bottom+2};i.type==="function-name"?this.autocomplete.showList(i.prefix,s):i.type==="argument"?this.autocomplete.showHint(i.funcName,i.argIndex,s):this.autocomplete.hide()}toggleFunctionBrowser(){if(this.functionBrowser.isVisible()){this.functionBrowser.hide();return}this.autocomplete.hide(),this.functionBrowser.show()}insertFunctionCompletion(e,t){const n=t.innerText,o=xr(t);if(!o)return;const i=o.end,s=n.slice(0,i).match(/([A-Za-z_]\w*)$/);if(!s)return;const a=i-s[1].length,c=n.slice(i),u=n.slice(0,a)+e+"("+c;this.formulaBar.setValue(u),this.cellInput.setValue(u);const h=a+e.length+1;_r(t,{start:h,end:h}),this.autocomplete.hide(),this.updateAutocomplete(u,t)}async insertFunctionFromBrowser(e){const t=await this.getInputForFunctionInsert(),n=t.innerText,o=xr(t);let i,r;if(!n.startsWith("="))i=`=${e}(`,r=i.length;else{const s=(o==null?void 0:o.start)??n.length,a=(o==null?void 0:o.end)??n.length;i=n.slice(0,s)+e+"("+n.slice(a),r=s+e.length+1}this.formulaBar.setValue(i),this.cellInput.setValue(i),_r(t,{start:r,end:r}),t.focus(),this.formulaRanges=Bi(i).map(s=>s.range),this.renderOverlay(),this.autocomplete.hide(),this.updateAutocomplete(i,t)}async getInputForFunctionInsert(){if(this.cellInput.isFocused())return this.cellInput.getInput();const e=this.cellInput.getInput(),t=this.formulaBar.getFormulaInput(),n=t.innerText,o=xr(t);this.cellInput.isShown()||await this.showCellInput(!0,!0),this.cellInput.setValue(n);const i=(o==null?void 0:o.end)??n.length;return _r(e,{start:i,end:i}),this.cellInput.isFocused()||e.focus(),e}isInFormulaRangeMode(){let e,t;if(this.cellInput.isFocused()?(e=this.cellInput.getValue(),t=this.cellInput.getInput()):this.formulaBar.isFocused()&&(e=this.formulaBar.getValue(),t=this.formulaBar.getFormulaInput()),!e||!t||!e.startsWith("="))return!1;const n=xr(t);return n?qg(e,n.end):!1}insertReferenceAtCursor(e,t){const n=this.cellInput.isFocused(),o=this.formulaBar.isFocused();if(!n&&!o)return;const i=n?this.cellInput.getInput():this.formulaBar.getFormulaInput(),r=i.innerText,s=xr(i);if(!s)return;const a=t&&(e.r!==t.r||e.c!==t.c)?fe(e)+":"+fe(t):fe(e);let c,u;if(this.formulaRefInsertPos){const{start:h,end:f}=this.formulaRefInsertPos;c=r.slice(0,h)+a+r.slice(f),u=h+a.length,this.formulaRefInsertPos={start:h,end:u}}else{const h=Gf(r,s.end);h?(c=r.slice(0,h.start)+a+r.slice(h.end),u=h.start+a.length,this.formulaRefInsertPos={start:h.start,end:u}):s.start!==s.end?(c=r.slice(0,s.start)+a+r.slice(s.end),u=s.start+a.length,this.formulaRefInsertPos={start:s.start,end:u}):(c=r.slice(0,s.end)+a+r.slice(s.end),u=s.end+a.length,this.formulaRefInsertPos={start:s.end,end:u})}this.formulaBar.setValue(c),this.cellInput.setValue(c),_r(i,{start:u,end:u}),c.startsWith("=")&&(this.formulaRanges=Bi(c).map(h=>h.range),this.renderOverlay()),this.lastFormulaRefTarget=t||e}toggleAbsoluteReference(e){const t=e.innerText;if(!t.startsWith("="))return;const n=xr(e);if(!n)return;const o=Gf(t,n.end);if(!o)return;const i=o.text,r=i.startsWith("$"),s=i.replace(/\$/g,"");let a=0;for(let m=0;m<s.length;m++)if(s.charCodeAt(m)>=48&&s.charCodeAt(m)<=57){a=m;break}const c=s.slice(0,a),u=s.slice(a),h=i.indexOf(u,i.lastIndexOf(c)+c.length),f=h>0&&i[h-1]==="$";let d;!r&&!f?d="$"+c+"$"+u:r&&f?d=c+"$"+u:!r&&f?d="$"+c+u:d=c+u;const p=t.slice(0,o.start)+d+t.slice(o.end),y=o.start+d.length;this.formulaBar.setValue(p),this.cellInput.setValue(p),_r(e,{start:y,end:y}),p.startsWith("=")&&(this.formulaRanges=Bi(p).map(m=>m.range),this.renderOverlay())}resetFormulaRangeState(){this.formulaRangeAnchor=null,this.activeFormulaInput=null,this.formulaRefInsertPos=null,this.lastFormulaRefTarget=null}handleDblClick(e){e.preventDefault(),this.handleDblClickAt(e.offsetX,e.offsetY)}handleDblClickAt(e,t){if(this.readOnly)return;const n=this.detectFreezeHandle(e,t);if(n){const i=this.sheet.getFreezePane();n==="row"?this.setFreezePane(i.frozenRows>0?0:1,i.frozenCols):this.setFreezePane(i.frozenRows,i.frozenCols>0?0:1);return}const o=this.detectResizeEdge(e,t);if(o){this.autoFitSize(o.axis,o.index);return}this.showCellInput()}handleContextMenu(e){if(this.readOnly)return;const t=e.offsetX,n=e.offsetY,o=t<ue,i=n<oe;if(!(!o&&!i)){if(e.preventDefault(),o){const r=this.toRowFromMouse(n);if(r<1)return;const s=this.sheet.getSelectedIndices(),a=s&&s.axis==="row"&&r>=s.from&&r<=s.to,c=a?s.from:r,u=a?s.to-s.from+1:1,h=u>1?`${u} rows`:"row";this.contextMenu.show(e.clientX,e.clientY,[{label:`Insert ${h} above`,action:()=>{this.sheet.insertRows(c,u).then(()=>this.render())}},{label:`Insert ${h} below`,action:()=>{this.sheet.insertRows(c+u,u).then(()=>this.render())}},{label:`Delete ${h}`,action:()=>{this.sheet.deleteRows(c,u).then(()=>this.render())}}])}else if(i){const r=this.toColFromMouse(t);if(r<1)return;const s=this.sheet.getSelectedIndices(),a=s&&s.axis==="column"&&r>=s.from&&r<=s.to,c=a?s.from:r,u=a?s.to-s.from+1:1,h=u>1?`${u} columns`:"column",f=[{label:`Insert ${h} left`,action:()=>{this.sheet.insertColumns(c,u).then(()=>this.render())}},{label:`Insert ${h} right`,action:()=>{this.sheet.insertColumns(c+u,u).then(()=>this.render())}},{label:`Delete ${h}`,action:()=>{this.sheet.deleteColumns(c,u).then(()=>this.render())}}];this.contextMenu.show(e.clientX,e.clientY,f)}}}getFilterButtonRect(e){var s;const t=(s=this.sheet)==null?void 0:s.getFilterRange();if(!t)return null;const n=t[0].r,o=this.getCellRect({r:n,c:e});if(o.width<=6||o.height<=6)return null;const i=Math.min(16,Math.max(12,o.width-4)),r=Math.min(16,Math.max(12,o.height-6));return{left:o.left+o.width-i-2,top:o.top+Math.max(3,(o.height-r)/2),width:i,height:r}}detectFilterButton(e,t){if(!this.sheet||!this.sheet.hasFilter()||e<=ue||t<=oe)return null;const n=this.sheet.getFilterRange();if(!n)return null;const o=this.toRefFromMouse(e,t);if(o.r!==n[0].r||!this.sheet.isColumnInFilter(o.c))return null;const i=this.getFilterButtonRect(o.c);return!i||e<i.left-2||e>i.left+i.width+2||t<i.top-2||t>i.top+i.height+2?null:o.c}async showFilterPanel(e,t){var p,y;if(!this.sheet||!this.sheet.isColumnInFilter(e))return;const n=await this.sheet.getFilterColumnValues(e);if(!n)return;const o=this.sheet.getColumnFilterCondition(e),i=o&&o.op!=="in"&&o.op!=="isEmpty"&&o.op!=="isNotEmpty",r=t==="condition"||i?"condition":"values",s=o?{...o,values:o.values?[...o.values]:void 0}:{op:"contains",value:""};this.filterPanelState={col:e,values:n.values,selected:new Set(n.selected),initialSelected:new Set(n.selected),search:"",mode:r,condition:{...s,values:s.values?[...s.values]:void 0},initialCondition:s,hasExistingCondition:!!o},this.renderFilterPanel();const a=this.getFilterButtonRect(e);if(!a)return;const c=this.viewport,h=Math.min(c.left+Math.max(ue,a.left-6),c.left+Math.max(0,c.width-260-4)),f=c.top+a.top+a.height+4;this.filterPanel.style.left=`${h}px`,this.filterPanel.style.top=`${f}px`,this.filterPanel.style.display="block",(p=this.filterPanelKeyboardUnsub)==null||p.call(this);const d=m=>{if(!this.filterPanelState)return;const v=m.target,x=v?this.filterPanel.contains(v):!1;if(m.key==="Escape"){m.preventDefault(),m.stopPropagation(),this.hideFilterPanel();return}m.key==="Enter"&&x&&(m.preventDefault(),m.stopPropagation(),this.applyFilterPanel())};document.addEventListener("keydown",d,!0),this.filterPanelKeyboardUnsub=()=>{document.removeEventListener("keydown",d,!0)},(y=this.filterPanelOutsideClickUnsub)==null||y.call(this),requestAnimationFrame(()=>{if(!this.filterPanelState)return;const m=v=>{this.filterPanel.contains(v.target)||this.hideFilterPanel()};document.addEventListener("mousedown",m),this.filterPanelOutsideClickUnsub=()=>{document.removeEventListener("mousedown",m)}})}hideFilterPanel(){var e,t;this.filterPanel.style.display="none",this.filterPanel.innerHTML="",this.filterPanelState=null,(e=this.filterPanelOutsideClickUnsub)==null||e.call(this),this.filterPanelOutsideClickUnsub=null,(t=this.filterPanelKeyboardUnsub)==null||t.call(this),this.filterPanelKeyboardUnsub=null}areStringSetsEqual(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}areFilterConditionsEqual(e,t){if(e.op!==t.op)return!1;if(e.op==="in"){const n=Array.from(new Set(e.values||[])).sort(),o=Array.from(new Set(t.values||[])).sort();if(n.length!==o.length)return!1;for(let i=0;i<n.length;i++)if(n[i]!==o[i])return!1;return!0}return e.op==="isEmpty"||e.op==="isNotEmpty"?!0:(e.value||"").trim()===(t.value||"").trim()}isFilterPanelDirty(e){return e.mode==="values"?!this.areStringSetsEqual(e.selected,e.initialSelected):!this.areFilterConditionsEqual(e.condition,e.initialCondition)}async applyFilterPanel(){const e=this.filterPanelState;if(!(!e||!this.sheet)&&this.isFilterPanelDirty(e)){if(e.mode==="values"){await this.sheet.setColumnIncludedValues(e.col,Array.from(e.selected)),this.hideFilterPanel(),this.render();return}await this.sheet.setColumnFilter(e.col,e.condition),this.hideFilterPanel(),this.render()}}syncFilterPanelApplyButtonState(){const e=this.filterPanelState;if(!e)return;const t=this.filterPanel.querySelector('button[data-wb-filter-apply="true"]');if(!t)return;const n=this.isFilterPanelDirty(e);t.disabled=!n,t.style.opacity=n?"1":"0.5",t.style.cursor=n?"pointer":"not-allowed"}syncFilterPanelValuesSelectionState(e){const t=this.filterPanelState;if(!t)return;const n=this.filterPanel.querySelector('[data-wb-filter-summary="true"]');if(n){const i=t.values.filter(r=>t.selected.has(r)).length;n.textContent=`Selected ${i} / ${t.values.length}`}const o=this.filterPanel.querySelector('input[data-wb-filter-select-all="true"]');if(o){const i=e.filter(r=>t.selected.has(r)).length;o.checked=e.length>0&&i===e.length,o.indeterminate=i>0&&i<e.length}this.syncFilterPanelApplyButtonState()}renderFilterPanel(){var N;const e=this.filterPanelState;if(!e)return;const t=document.activeElement,n=t instanceof HTMLInputElement&&t.dataset.wbFilterSearch==="true",o=n?t.selectionStart:null,i=n?t.selectionEnd:null,r=ve(this.theme,"cellBorderColor"),s=ve(this.theme,"selectionBGColor"),a=R=>{const P=document.createElement("button");return P.type="button",P.textContent=R,P.style.height="26px",P.style.padding="0 8px",P.style.border=`1px solid ${r}`,P.style.borderRadius="4px",P.style.background="transparent",P.style.color="inherit",P.style.cursor="pointer",P};this.filterPanel.innerHTML="";const c=document.createElement("div");c.style.display="flex",c.style.flexDirection="column",c.style.maxHeight="360px",c.style.height=e.mode==="values"?"360px":"auto",c.style.overflow="hidden";const u=document.createElement("div");u.style.padding="8px 10px",u.style.borderBottom=`1px solid ${r}`,u.style.fontWeight="600",u.textContent=`Filter ${oi(e.col)}`,c.appendChild(u);const h=document.createElement("div");h.textContent="Sort",h.style.padding="8px 10px 4px",h.style.fontSize="11px",h.style.opacity="0.7",c.appendChild(h);const f=document.createElement("div");f.style.display="flex",f.style.flexWrap="wrap",f.style.gap="6px",f.style.padding="8px 10px 6px";const d=a("Sort A to Z");d.onclick=()=>{this.sheet.sortFilterByColumn(e.col,"asc").then(R=>{R&&(this.hideFilterPanel(),this.render())})};const p=a("Sort Z to A");p.onclick=()=>{this.sheet.sortFilterByColumn(e.col,"desc").then(R=>{R&&(this.hideFilterPanel(),this.render())})},f.append(d,p),c.appendChild(f);const y=document.createElement("div");y.textContent="Filter",y.style.padding="0 10px 4px",y.style.fontSize="11px",y.style.opacity="0.7",c.appendChild(y);const m=document.createElement("div");m.style.display="flex",m.style.flexWrap="wrap",m.style.gap="6px",m.style.padding="0 10px 8px";const v=(R,P)=>{const k=a(R);return e.mode===P&&(k.style.background=s),k.onclick=()=>{this.filterPanelState&&(this.filterPanelState.mode=P,this.renderFilterPanel())},k};m.append(v("Filter by values","values"),v("Filter by condition","condition")),c.appendChild(m);const x=document.createElement("div");if(x.style.flex="1",x.style.minHeight="0",x.style.padding="0 10px",x.style.display="flex",x.style.flexDirection="column",c.appendChild(x),e.mode==="values"){const R=document.createElement("input");R.type="text",R.dataset.wbFilterSearch="true",R.value=e.search,R.placeholder="Search values",R.style.width="100%",R.style.margin="0 0 8px",R.style.height="28px",R.style.padding="0 8px",R.style.border=`1px solid ${r}`,R.style.borderRadius="4px",R.style.background="transparent",R.style.color="inherit",R.oninput=()=>{this.filterPanelState&&(this.filterPanelState.search=R.value,this.renderFilterPanel())},x.appendChild(R);const P=e.values,k=P.filter(G=>e.selected.has(G)).length,D=document.createElement("div");D.dataset.wbFilterSummary="true",D.textContent=`Selected ${k} / ${P.length}`,D.style.margin="0 0 8px",D.style.fontSize="11px",D.style.opacity="0.7",x.appendChild(D);const H=e.search.trim().toLowerCase(),J=P.filter(G=>H?(G===""?"(Blanks)":G).toLowerCase().includes(H):!0).slice(0,ov),te=document.createElement("div");te.style.flex="1",te.style.minHeight="0",te.style.border=`1px solid ${r}`,te.style.borderRadius="4px",te.style.overflow="auto";const le=J.filter(G=>e.selected.has(G)).length,ge=document.createElement("label");ge.style.display="flex",ge.style.alignItems="center",ge.style.gap="8px",ge.style.padding="6px 8px",ge.style.borderBottom=`1px solid ${r}`,ge.style.cursor="pointer";const ce=document.createElement("input");ce.type="checkbox",ce.dataset.wbFilterSelectAll="true",ce.checked=J.length>0&&le===J.length,ce.indeterminate=le>0&&le<J.length,ce.onchange=()=>{if(this.filterPanelState){if(ce.checked)for(const G of J)this.filterPanelState.selected.add(G);else for(const G of J)this.filterPanelState.selected.delete(G);this.renderFilterPanel()}};const ee=document.createElement("span");if(ee.textContent="Select all",ge.append(ce,ee),te.appendChild(ge),J.length===0){const G=document.createElement("div");G.style.padding="10px",G.style.opacity="0.7",G.textContent="No values",te.appendChild(G)}else for(const G of J){const Q=document.createElement("label");Q.style.display="flex",Q.style.alignItems="center",Q.style.gap="8px",Q.style.padding="6px 8px",Q.style.cursor="pointer";const ie=document.createElement("input");ie.type="checkbox",ie.checked=e.selected.has(G),ie.onchange=()=>{this.filterPanelState&&(ie.checked?this.filterPanelState.selected.add(G):this.filterPanelState.selected.delete(G),this.syncFilterPanelValuesSelectionState(J))};const _=document.createElement("span");_.textContent=G===""?"(Blanks)":G,_.style.overflow="hidden",_.style.textOverflow="ellipsis",_.style.whiteSpace="nowrap",Q.append(ie,_),te.appendChild(Q)}x.appendChild(te)}else{const R=document.createElement("div");R.style.display="grid",R.style.gap="8px";const P=document.createElement("select");P.style.height="30px",P.style.border=`1px solid ${r}`,P.style.borderRadius="4px",P.style.background="transparent",P.style.color="inherit";const k=[{value:"contains",label:"Contains"},{value:"notContains",label:"Does not contain"},{value:"equals",label:"Equals"},{value:"notEquals",label:"Does not equal"},{value:"isEmpty",label:"Is empty"},{value:"isNotEmpty",label:"Is not empty"}],D=e.condition.op==="in"?"contains":e.condition.op;for(const J of k){const te=document.createElement("option");te.value=J.value,te.textContent=J.label,te.selected=D===J.value,P.appendChild(te)}if(P.onchange=()=>{if(!this.filterPanelState)return;const J=P.value;this.filterPanelState.condition={op:J,value:this.filterPanelState.condition.value||""},this.renderFilterPanel()},R.appendChild(P),D!=="isEmpty"&&D!=="isNotEmpty"){const J=document.createElement("input");J.type="text",J.value=((N=this.filterPanelState)==null?void 0:N.condition.value)||"",J.placeholder="Enter value",J.style.height="30px",J.style.padding="0 8px",J.style.border=`1px solid ${r}`,J.style.borderRadius="4px",J.style.background="transparent",J.style.color="inherit",J.oninput=()=>{this.filterPanelState&&(this.filterPanelState.condition={...this.filterPanelState.condition,value:J.value},this.syncFilterPanelApplyButtonState())},R.appendChild(J)}x.appendChild(R)}const g=document.createElement("div");g.style.display="flex",g.style.justifyContent="flex-end",g.style.gap="6px",g.style.padding="8px 10px";const S=R=>{R.disabled=!0,R.style.opacity="0.5",R.style.cursor="not-allowed"},C=a("Clear");C.onclick=()=>{this.sheet.clearColumnFilter(e.col).then(()=>{this.hideFilterPanel(),this.render()})},e.hasExistingCondition||S(C);const A=a("Cancel");A.onclick=()=>this.hideFilterPanel();const b=a("Apply");if(b.dataset.wbFilterApply="true",b.onclick=()=>{this.applyFilterPanel()},this.isFilterPanelDirty(e)||S(b),g.append(C,A,b),c.appendChild(g),this.filterPanel.appendChild(c),n&&e.mode==="values"){const R=this.filterPanel.querySelector('input[data-wb-filter-search="true"]');if(R){R.focus();const P=R.value.length,k=Math.max(0,Math.min(P,o??P)),D=Math.max(k,Math.min(P,i??k));R.setSelectionRange(k,D)}}}addEventListeners(){const e=this.gridContainer.getScrollContainer();this.addEventListener(window,"resize",()=>{this.updateCellInputPosition(),this.render()}),this.addEventListener(e,"scroll",()=>{this.hideFilterPanel(),this.updateCellInputPosition(),this.render()}),this.addEventListener(e,"mousedown",t=>{this.handleMouseDown(t)}),this.addEventListener(e,"mousemove",t=>{this.handleMouseMove(t)}),this.addEventListener(e,"mouseleave",()=>{this.handleScrollContainerMouseLeave()}),this.addEventListener(e,"dblclick",t=>{this.handleDblClick(t)}),this.addEventListener(e,"contextmenu",t=>{this.handleContextMenu(t)}),this.addEventListener(document,"keydown",t=>{this.handleKeyDown(t)}),this.addEventListener(document,"keyup",t=>{this.handleKeyUp(t)})}detectResizeEdge(e,t){const n=this.scroll,o=this.freezeState;if(t<oe&&e>ue){const r=o.frozenCols>0&&e<ue+o.frozenWidth?e-ue:e-ue-o.frozenWidth+this.colDim.getOffset(o.frozenCols+1)+n.left,s=this.colDim.findIndex(r),a=this.colDim.getOffset(s)+this.colDim.getSize(s);if(Math.abs(r-a)<mo)return{axis:"column",index:s};if(s>1){const c=this.colDim.getOffset(s-1)+this.colDim.getSize(s-1);if(Math.abs(r-c)<mo)return{axis:"column",index:s-1}}}if(e<ue&&t>oe){const r=o.frozenRows>0&&t<oe+o.frozenHeight?t-oe:t-oe-o.frozenHeight+this.rowDim.getOffset(o.frozenRows+1)+n.top,s=this.rowDim.findIndex(r),a=this.rowDim.getOffset(s)+this.rowDim.getSize(s);if(Math.abs(r-a)<mo)return{axis:"row",index:s};if(s>1){const c=this.rowDim.getOffset(s-1)+this.rowDim.getSize(s-1);if(Math.abs(r-c)<mo)return{axis:"row",index:s-1}}}return null}detectFreezeHandle(e,t){const n=this.freezeState,o=n.frozenRows>0||n.frozenCols>0,i=$p,r=zy,s=o&&n.frozenRows>0?oe+n.frozenHeight-i/2:oe-i;if(e>=0&&e<=ue&&t>=s-r&&t<=s+i+r)return"row";const a=o&&n.frozenCols>0?ue+n.frozenWidth-i/2:ue-i;return e>=a-r&&e<=a+i+r&&t>=0&&t<=oe?"column":null}startFreezeDrag(e,t){const n=this.gridContainer.getScrollContainer();n.style.cursor="grabbing";const o=r=>{const s=this.viewport;if(e==="row"){const a=r.target!==n?Math.max(0,Math.min(s.height,r.clientY-s.top)):r.offsetY;if(a<=oe)return 0;const c=a-oe,u=this.rowDim.findIndex(c),f=this.rowDim.getOffset(u)+this.rowDim.getSize(u)/2;return c<f?Math.max(0,u-1):u}else{const a=r.target!==n?Math.max(0,Math.min(s.width,r.clientX-s.left)):r.offsetX;if(a<=ue)return 0;const c=a-ue,u=this.colDim.findIndex(c),f=this.colDim.getOffset(u)+this.colDim.getSize(u)/2;return c<f?Math.max(0,u-1):u}};this.freezeDrag={axis:e,targetIndex:o(t)},this.renderOverlay();const i=r=>{const s=o(r);this.freezeDrag&&this.freezeDrag.targetIndex!==s&&(this.freezeDrag={axis:e,targetIndex:s},this.renderOverlay())};this.startMouseDragSession({onMove:i,onComplete:()=>{var a;const r=((a=this.freezeDrag)==null?void 0:a.targetIndex)??0,s=this.sheet.getFreezePane();e==="row"?this.setFreezePane(r,s.frozenCols):this.setFreezePane(s.frozenRows,r)},onCleanup:()=>{n.style.cursor="",this.freezeDrag=null,this.freezeHandleHover=null,this.renderOverlay()}})}toRefFromMouse(e,t){const n=this.freezeState;return n.frozenRows>0||n.frozenCols>0?Uy(e,t,this.scroll,this.rowDim,this.colDim,n):qy(e+this.scroll.left,t+this.scroll.top,this.rowDim,this.colDim)}toRowFromMouse(e){const t=this.freezeState,o=t.frozenRows>0&&e<oe+t.frozenHeight?e-oe:e-oe-t.frozenHeight+this.rowDim.getOffset(t.frozenRows+1)+this.scroll.top;return this.rowDim.findIndex(o)}toColFromMouse(e){const t=this.freezeState,o=t.frozenCols>0&&e<ue+t.frozenWidth?e-ue:e-ue-t.frozenWidth+this.colDim.getOffset(t.frozenCols+1)+this.scroll.left;return this.colDim.findIndex(o)}getAutofillSelectionRect(e){if(!this.sheet||this.sheet.getSelectionType()!=="cell")return;const t=e||this.sheet.getRangeOrActiveCell(),n=Xi(t[0],this.scroll,this.rowDim,this.colDim,this.freezeState),o=Xi(t[1],this.scroll,this.rowDim,this.colDim,this.freezeState),i=Math.min(n.left,o.left),r=Math.min(n.top,o.top),s=Math.max(n.left+n.width,o.left+o.width),a=Math.max(n.top+n.height,o.top+o.height);return{left:i,top:r,width:s-i,height:a-r}}detectAutofillHandle(e,t){if(this.readOnly||!this.sheet||this.sheet.getSelectionType()!=="cell")return!1;const n=this.sheet.getRangeOrActiveCell(),o=this.getAutofillSelectionRect(n);if(!o||this.isAutofillHandleHiddenByFreeze(n,o))return!1;const i=o.left+o.width-Qn/2,r=o.top+o.height-Qn/2;return e>=i-xo&&e<=i+Qn+xo&&t>=r-xo&&t<=r+Qn+xo}shouldShowAutofillHandle(){if(this.readOnly||!this.sheet||this.sheet.getSelectionType()!=="cell")return!1;const e=this.sheet.getRangeOrActiveCell(),t=this.getAutofillSelectionRect(e);return t?!this.isAutofillHandleHiddenByFreeze(e,t):!1}isAutofillHandleHiddenByFreeze(e,t){const n=this.freezeState;if(n.frozenRows===0&&n.frozenCols===0)return!1;const o=Math.max(e[0].r,e[1].r),i=Math.max(e[0].c,e[1].c);if(!(o>n.frozenRows&&i>n.frozenCols))return!1;const s=t.left+t.width-Qn/2,a=t.top+t.height-Qn/2,c=ue+n.frozenWidth,u=oe+n.frozenHeight;return s<c||a<u}clampClientPointToViewport(e,t){const n=this.viewport;return{x:Math.max(0,Math.min(n.width,e-n.left)),y:Math.max(0,Math.min(n.height,t-n.top))}}getAutoScrollSpeed(e){const n=Math.min(hd,Math.max(0,e))/hd;return fd+(iv-fd)*n}getAutoScrollVelocity(e,t,n){return e<t?-this.getAutoScrollSpeed(t-e):e>n?this.getAutoScrollSpeed(e-n):0}handleMouseMove(e){var r,s,a;const t=this.gridContainer.getScrollContainer();if((e.buttons&1)===1){this.resizeHover&&(this.resizeHover=null,this.renderOverlay());return}const n=this.detectFreezeHandle(e.offsetX,e.offsetY);if(n!==this.freezeHandleHover&&(this.freezeHandleHover=n,this.render()),n){t.style.cursor="grab",this.setFilterButtonHoverCol(null),this.resizeHover&&(this.resizeHover=null,this.renderOverlay());return}const o=this.detectResizeEdge(e.offsetX,e.offsetY),i=(o==null?void 0:o.axis)!==((r=this.resizeHover)==null?void 0:r.axis)||(o==null?void 0:o.index)!==((s=this.resizeHover)==null?void 0:s.index);if(i&&(this.resizeHover=o),o)t.style.cursor=o.axis==="column"?"col-resize":"row-resize",this.setFilterButtonHoverCol(null);else{if(this.detectAutofillHandle(e.offsetX,e.offsetY)){t.style.cursor="crosshair",this.setFilterButtonHoverCol(null),i&&this.renderOverlay();return}const c=e.offsetX,u=e.offsetY,h=this.detectFilterButton(c,u);if(h!==null){t.style.cursor="pointer",this.setFilterButtonHoverCol(h),i&&this.renderOverlay();return}this.setFilterButtonHoverCol(null);const f=(a=this.sheet)==null?void 0:a.getSelectedIndices();if(f){const d=f.axis==="column"?u<oe&&c>ue&&(()=>{const p=this.toColFromMouse(c);return p>=f.from&&p<=f.to})():c<ue&&u>oe&&(()=>{const p=this.toRowFromMouse(u);return p>=f.from&&p<=f.to})();t.style.cursor=d?"grab":""}else t.style.cursor=""}i&&this.renderOverlay()}handleScrollContainerMouseLeave(){const e=this.gridContainer.getScrollContainer();e.style.cursor="";const t=this.filterButtonHoverCol!==null||this.resizeHover!==null||this.freezeHandleHover!==null;this.filterButtonHoverCol=null,this.resizeHover=null,this.freezeHandleHover=null,t&&this.render()}setFilterButtonHoverCol(e){this.filterButtonHoverCol!==e&&(this.filterButtonHoverCol=e,this.render())}async handleMouseDown(e){const t=this.detectFreezeHandle(e.offsetX,e.offsetY);if(t&&!this.readOnly){e.preventDefault(),this.startFreezeDrag(t,e);return}const n=this.detectResizeEdge(e.offsetX,e.offsetY);if(n&&!this.readOnly){e.preventDefault(),this.startResize(n.axis,n.index,e);return}const o=e.offsetX,i=e.offsetY,r=this.detectFilterButton(o,i);if(r!==null){e.preventDefault(),await this.finishEditing(),await this.showFilterPanel(r);return}if(o<ue&&i<oe){e.preventDefault(),await this.finishEditing(),this.sheet.selectAllCells(),this.render();return}const a=i<oe&&o>ue,c=o<ue&&i>oe;if(a){e.preventDefault(),await this.finishEditing();const g=this.toColFromMouse(o);if(g<1)return;if(e.shiftKey){this.sheet.selectColumnRange(this.sheet.getActiveCell().c,g),this.render();return}const S=this.sheet.getSelectedIndices();if(!this.readOnly&&S&&S.axis==="column"&&g>=S.from&&g<=S.to){this.startDragMove("column",S.from,S.to-S.from+1,e);return}this.sheet.selectColumn(g),this.render();const C=g;let A=g,b=e.clientX,N=null,R=null;const P=()=>{const{x:te}=this.clampClientPointToViewport(b,0),le=this.toColFromMouse(te);le>=1&&le!==A&&(A=le,this.sheet.selectColumnRange(C,A))},k=()=>{N!==null&&(cancelAnimationFrame(N),N=null),R=null},D=te=>{const le=this.viewport,ge=this.getAutoScrollVelocity(b,le.left,le.left+le.width);if(ge===0){N=null,R=null;return}const ce=Math.min(50,R===null?16:te-R);R=te,this.gridContainer.scrollBy(ge*ce/1e3,0),P(),this.render(),N=requestAnimationFrame(D)},H=()=>{N===null&&(N=requestAnimationFrame(D))},J=te=>{b=te.clientX,P(),this.render();const le=this.viewport;this.getAutoScrollVelocity(b,le.left,le.left+le.width)===0?k():H()};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:J,onCleanup:()=>{k(),this.endNativeSelectionBlock()}});return}if(c){e.preventDefault(),await this.finishEditing();const g=this.toRowFromMouse(i);if(g<1)return;if(e.shiftKey){this.sheet.selectRowRange(this.sheet.getActiveCell().r,g),this.render();return}const S=this.sheet.getSelectedIndices();if(!this.readOnly&&S&&S.axis==="row"&&g>=S.from&&g<=S.to){this.startDragMove("row",S.from,S.to-S.from+1,e);return}this.sheet.selectRow(g),this.render();const C=g;let A=g,b=e.clientY,N=null,R=null;const P=()=>{const{y:te}=this.clampClientPointToViewport(0,b),le=this.toRowFromMouse(te);le>=1&&le!==A&&(A=le,this.sheet.selectRowRange(C,A))},k=()=>{N!==null&&(cancelAnimationFrame(N),N=null),R=null},D=te=>{const le=this.viewport,ge=this.getAutoScrollVelocity(b,le.top,le.top+le.height);if(ge===0){N=null,R=null;return}const ce=Math.min(50,R===null?16:te-R);R=te,this.gridContainer.scrollBy(0,ge*ce/1e3),P(),this.render(),N=requestAnimationFrame(D)},H=()=>{N===null&&(N=requestAnimationFrame(D))},J=te=>{b=te.clientY,P(),this.render();const le=this.viewport;this.getAutoScrollVelocity(b,le.top,le.top+le.height)===0?k():H()};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:J,onCleanup:()=>{k(),this.endNativeSelectionBlock()}});return}if(this.isInFormulaRangeMode()){e.preventDefault();const g=this.toRefFromMouse(e.offsetX,e.offsetY);if(this.activeFormulaInput=this.cellInput.isFocused()?"cellInput":"formulaBar",e.shiftKey&&this.formulaRangeAnchor){const A={r:Math.min(this.formulaRangeAnchor.r,g.r),c:Math.min(this.formulaRangeAnchor.c,g.c)},b={r:Math.max(this.formulaRangeAnchor.r,g.r),c:Math.max(this.formulaRangeAnchor.c,g.c)};this.insertReferenceAtCursor(A,b)}else this.formulaRangeAnchor=g,this.formulaRefInsertPos=null,this.insertReferenceAtCursor(g);const S=this.gridContainer.getScrollContainer(),C=A=>{const b=this.viewport,N=A.target!==S?Math.max(0,Math.min(b.width,A.clientX-b.left)):A.offsetX,R=A.target!==S?Math.max(0,Math.min(b.height,A.clientY-b.top)):A.offsetY,P=this.toRefFromMouse(N,R),k={r:Math.min(this.formulaRangeAnchor.r,P.r),c:Math.min(this.formulaRangeAnchor.c,P.c)},D={r:Math.max(this.formulaRangeAnchor.r,P.r),c:Math.max(this.formulaRangeAnchor.c,P.c)};this.insertReferenceAtCursor(k,D)};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:C,onComplete:()=>{this.scrollIntoView(),this.updateCellInputPosition(),this.activeFormulaInput==="cellInput"?this.cellInput.getInput().focus():this.activeFormulaInput==="formulaBar"&&this.formulaBar.getFormulaInput().focus()},onCleanup:()=>{this.endNativeSelectionBlock(),this.formulaRefInsertPos=null}});return}if(this.detectAutofillHandle(e.offsetX,e.offsetY)){e.preventDefault(),await this.finishEditing(),this.startAutofillDrag(e);return}if(await this.finishEditing(),e.shiftKey){const g=this.toRefFromMouse(e.offsetX,e.offsetY);this.sheet.selectEnd(g),this.render();return}this.sheet.selectStart(this.toRefFromMouse(e.offsetX,e.offsetY)),this.render();let u=e.clientX,h=e.clientY,f=null,d=null;const p=()=>{const{x:g,y:S}=this.clampClientPointToViewport(u,h);this.sheet.selectEnd(this.toRefFromMouse(g,S))},y=()=>{f!==null&&(cancelAnimationFrame(f),f=null),d=null},m=g=>{const S=this.viewport,C=this.getAutoScrollVelocity(u,S.left,S.left+S.width),A=this.getAutoScrollVelocity(h,S.top,S.top+S.height);if(C===0&&A===0){f=null,d=null;return}const b=Math.min(50,d===null?16:g-d);d=g,this.gridContainer.scrollBy(C*b/1e3,A*b/1e3),p(),this.render(),f=requestAnimationFrame(m)},v=()=>{f===null&&(f=requestAnimationFrame(m))},x=g=>{u=g.clientX,h=g.clientY,p(),this.renderOverlay();const S=this.viewport,C=this.getAutoScrollVelocity(u,S.left,S.left+S.width),A=this.getAutoScrollVelocity(h,S.top,S.top+S.height);C===0&&A===0?y():v()};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:x,onComplete:()=>{this.render()},onCleanup:()=>{y(),this.endNativeSelectionBlock()}})}startAutofillDrag(e){let t=e.clientX,n=e.clientY,o=null,i=null;const r=()=>{const{x:h,y:f}=this.clampClientPointToViewport(t,n),d=this.toRefFromMouse(h,f);this.autofillPreview=this.sheet.getAutofillPreviewRange(d),this.renderOverlay()},s=()=>{o!==null&&(cancelAnimationFrame(o),o=null),i=null},a=h=>{const f=this.viewport,d=this.getAutoScrollVelocity(t,f.left,f.left+f.width),p=this.getAutoScrollVelocity(n,f.top,f.top+f.height);if(d===0&&p===0){o=null,i=null;return}const y=Math.min(50,i===null?16:h-i);i=h,this.gridContainer.scrollBy(d*y/1e3,p*y/1e3),r(),o=requestAnimationFrame(a)},c=()=>{o===null&&(o=requestAnimationFrame(a))},u=h=>{t=h.clientX,n=h.clientY,r();const f=this.viewport,d=this.getAutoScrollVelocity(t,f.left,f.left+f.width),p=this.getAutoScrollVelocity(n,f.top,f.top+f.height);d===0&&p===0?s():c()};this.beginNativeSelectionBlock(),r(),this.startMouseDragSession({onMove:u,onComplete:()=>{const{x:h,y:f}=this.clampClientPointToViewport(t,n),d=this.toRefFromMouse(h,f),p=this.sheet;(async()=>{const y=await p.autofill(d);this.autofillPreview=void 0,this.sheet&&(y?this.render():this.renderOverlay())})()},onCleanup:()=>{s(),this.endNativeSelectionBlock(),this.autofillPreview=void 0,this.sheet&&this.renderOverlay()}})}startResize(e,t,n){const o=e==="column"?n.clientX:n.clientY,i=e==="column"?this.colDim.getSize(t):this.rowDim.getSize(t),r=this.gridContainer.getScrollContainer();r.style.cursor=e==="column"?"col-resize":"row-resize";const s=e==="column"?this.colDim:this.rowDim,a=this.sheet.getSelectedIndices(),u=a&&a.axis===e&&t>=a.from&&t<=a.to?Array.from({length:a.to-a.from+1},(y,m)=>a.from+m):[t],h=u.length;let f=i,d=null;this.beginNativeSelectionBlock(),this.showResizeTooltip(e,i,n.clientX,n.clientY,h);const p=y=>{const v=(e==="column"?y.clientX:y.clientY)-o;f=Math.max(e==="column"?cd:nv,i+v),d===null&&(d=requestAnimationFrame(()=>{d=null,s.setSize(t,f),this.render()})),this.showResizeTooltip(e,f,y.clientX,y.clientY,h)};this.startMouseDragSession({onMove:p,onComplete:()=>{const y=f;s.setSize(t,y);for(const m of u)s.setSize(m,y),e==="column"?this.sheet.setColumnWidth(m,y):(this.manuallyResizedRows.add(m),this.sheet.setRowHeight(m,y));this.render()},onCleanup:()=>{r.style.cursor="",this.hideResizeTooltip(),this.endNativeSelectionBlock(),d!==null&&(cancelAnimationFrame(d),d=null)}})}async autoFitSize(e,t){const o=document.createElement("canvas").getContext("2d"),i=6;if(e==="column"){o.font=`${Tr}px Arial`;const r=oi(t);let s=o.measureText(r).width+i;const[a,c]=this.viewRange,u=[{r:a.r,c:t},{r:c.r,c:t}],h=await this.sheet.fetchGrid(u);for(const[,d]of h)if(d.v){const p=o.measureText(d.v).width+i;p>s&&(s=p)}const f=Math.max(cd,Math.ceil(s));this.sheet.setColumnWidth(t,f)}else{this.manuallyResizedRows.delete(t);const r=await this.computeContentHeight(t);this.sheet.setRowHeight(t,r)}this.render()}async computeContentHeight(e){const[t,n]=this.viewRange,o=[{r:e,c:t.c},{r:e,c:n.c}],i=await this.sheet.fetchGrid(o);let r=1;for(const[,s]of i)if(s.v){const a=s.v.split(`
`).length;a>r&&(r=a)}return r<=1?oe:Math.max(oe,Math.ceil(r*Tr*bo+2*Ua))}async autoResizeRow(e){if(this.manuallyResizedRows.has(e))return;const t=await this.computeContentHeight(e),n=this.rowDim.getSize(e);t!==n&&(this.sheet.setRowHeight(e,t),this.render())}startDragMove(e,t,n,o){const i=this.gridContainer.getScrollContainer();i.style.cursor="grabbing";const r=e==="column"?this.colDim:this.rowDim,s=c=>{const u=this.viewport;if(e==="column"){const h=c.target!==i?Math.max(0,Math.min(u.width,c.clientX-u.left)):c.offsetX,f=this.toColFromMouse(h),d=this.freezeState,y=d.frozenCols>0&&h<ue+d.frozenWidth?h-ue:h-ue-d.frozenWidth+this.colDim.getOffset(d.frozenCols+1)+this.scroll.left,v=r.getOffset(f)+r.getSize(f)/2;return y<v?f:f+1}else{const h=c.target!==i?Math.max(0,Math.min(u.height,c.clientY-u.top)):c.offsetY,f=this.toRowFromMouse(h),d=this.freezeState,y=d.frozenRows>0&&h<oe+d.frozenHeight?h-oe:h-oe-d.frozenHeight+this.rowDim.getOffset(d.frozenRows+1)+this.scroll.top,v=r.getOffset(f)+r.getSize(f)/2;return y<v?f:f+1}};this.dragMove={axis:e,srcIndex:t,count:n,dropIndex:s(o)},this.renderOverlay();const a=c=>{const u=s(c);this.dragMove&&this.dragMove.dropIndex!==u&&(this.dragMove={axis:e,srcIndex:t,count:n,dropIndex:u},this.renderOverlay())};this.startMouseDragSession({onMove:a,onComplete:()=>{var h;const c=(h=this.dragMove)==null?void 0:h.dropIndex;if(c===void 0||c>=t&&c<=t+n)return;(e==="row"?this.sheet.moveRows(t,n,c):this.sheet.moveColumns(t,n,c)).then(()=>{const f=c<t?c:c-n;e==="row"?(this.sheet.selectRow(f),n>1&&this.sheet.selectRowRange(f,f+n-1)):(this.sheet.selectColumn(f),n>1&&this.sheet.selectColumnRange(f,f+n-1)),this.render()})},onCleanup:()=>{i.style.cursor="",this.dragMove=null,this.renderOverlay()}})}async handleFormulaKeydown(e){await this.handleEditorKeydown(e,"formulaBar")}async handleCellInputKeydown(e){await this.handleEditorKeydown(e,"cellInput")}async handleEditorKeydown(e,t){if(e.isComposing)return;const n=t==="formulaBar"?this.formulaBar.getFormulaInput():this.cellInput.getInput();if(this.handleAutocompleteKeydown(e,n))return;const o=r=>{Pe(r,"ArrowDown")?this.sheet.move("down"):Pe(r,"ArrowUp")?this.sheet.move("up"):Pe(r,"ArrowLeft")?this.sheet.move("left"):Pe(r,"ArrowRight")&&this.sheet.move("right")};!await ud(e,[{match:r=>et(r,{key:"Enter",alt:!0}),run:r=>{r.preventDefault(),document.execCommand("insertLineBreak")}},{match:r=>Pe(r,"Enter"),run:async r=>{r.preventDefault(),await this.finishEditing(),t==="formulaBar"?(this.focusGrid(),this.sheet.move("down")):this.sheet.moveInRange(r.shiftKey?-1:1,0),this.render(),this.scrollIntoView()}},{match:r=>Pe(r,"Tab"),run:async r=>{r.preventDefault(),await this.finishEditing(),t==="formulaBar"&&this.focusGrid(),this.sheet.moveInRange(0,r.shiftKey?-1:1),this.render(),this.scrollIntoView()}},{match:r=>this.isArrowKey(r)&&!this.editMode&&(t==="formulaBar"||this.cellInput.hasFormula())&&this.isInFormulaRangeMode(),run:r=>{r.preventDefault();const s=this.applyFormulaRangeArrowKey(r);this.scrollIntoView(s)}},{match:r=>t==="cellInput"&&this.isArrowKey(r)&&!this.cellInput.hasFormula()&&!this.editMode,run:async r=>{r.preventDefault(),await this.finishEditing(),o(r),this.render(),this.scrollIntoView()}},{match:r=>Pe(r,"F4"),run:r=>{r.preventDefault(),this.toggleAbsoluteReference(n)}},{match:r=>Pe(r,"Escape"),run:r=>{r.preventDefault(),this.focusGrid(),this.render()}}])&&t==="formulaBar"&&!this.cellInput.isShown()&&this.showCellInput(!0,!0)}handleAutocompleteKeydown(e,t){if(this.autocomplete.isListVisible()){if(Pe(e,"ArrowDown"))return e.preventDefault(),this.autocomplete.moveDown(),!0;if(Pe(e,"ArrowUp"))return e.preventDefault(),this.autocomplete.moveUp(),!0;if(Pe(e,"Tab")||Pe(e,"Enter")){const n=this.autocomplete.getSelectedFunction();if(n)return e.preventDefault(),this.insertFunctionCompletion(n.name,t),!0}else Pe(e,"Escape")&&this.autocomplete.hide()}else this.autocomplete.isHintVisible()&&Pe(e,"Escape")&&this.autocomplete.hide();return!1}isArrowKey(e){return Pe(e,"ArrowDown")||Pe(e,"ArrowUp")||Pe(e,"ArrowLeft")||Pe(e,"ArrowRight")}applyFormulaRangeArrowKey(e){const n={...this.lastFormulaRefTarget||this.sheet.getActiveCell()};if(Pe(e,"ArrowDown")?n.r=Math.max(1,n.r+1):Pe(e,"ArrowUp")?n.r=Math.max(1,n.r-1):Pe(e,"ArrowLeft")?n.c=Math.max(1,n.c-1):Pe(e,"ArrowRight")&&(n.c=n.c+1),e.shiftKey&&this.formulaRangeAnchor){const o={r:Math.min(this.formulaRangeAnchor.r,n.r),c:Math.min(this.formulaRangeAnchor.c,n.c)},i={r:Math.max(this.formulaRangeAnchor.r,n.r),c:Math.max(this.formulaRangeAnchor.c,n.c)};this.insertReferenceAtCursor(o,i),this.lastFormulaRefTarget=n}else this.formulaRangeAnchor=n,this.formulaRefInsertPos=null,this.insertReferenceAtCursor(n);return n}async copy(){const{text:e}=await this.sheet.copy();await navigator.clipboard.writeText(e)}async paste(){try{let e,t;if(navigator.clipboard.read)try{const n=await navigator.clipboard.read();for(const o of n)o.types.includes("text/html")&&(t=await(await o.getType("text/html")).text()),o.types.includes("text/plain")&&(e=await(await o.getType("text/plain")).text())}catch{e=await navigator.clipboard.readText()}else e=await navigator.clipboard.readText();await this.sheet.paste({text:e,html:t}),this.sheet.clearCopyBuffer(),this.render()}catch(e){console.error("Failed to paste cell content: ",e)}}async handleGridKeydown(e){const t=async(n,o)=>{if(n.preventDefault(),n.shiftKey?this.sheet.resizeRange(o):Va(n)?await this.sheet.moveToEdge(o):this.sheet.move(o)){this.render();const r=n.shiftKey&&this.sheet.getSelectionType()==="cell"?this.getRangeExtentRef():void 0;this.scrollIntoView(r)}};await ud(e,[{match:n=>Pe(n,"ArrowDown"),run:n=>t(n,"down")},{match:n=>Pe(n,"ArrowUp"),run:n=>t(n,"up")},{match:n=>Pe(n,"ArrowLeft"),run:n=>t(n,"left")},{match:n=>Pe(n,"ArrowRight"),run:n=>t(n,"right")},{match:n=>et(n,{key:"a",mod:!0}),run:async n=>{n.preventDefault(),await this.sheet.selectAll(),this.render()}},{match:n=>Pe(n,"Tab"),run:n=>{n.preventDefault(),this.sheet.moveInRange(0,n.shiftKey?-1:1),this.render(),this.scrollIntoView()}},{match:n=>Pe(n,"Enter"),run:n=>{n.preventDefault(),this.sheet.hasRange()?(this.sheet.moveInRange(n.shiftKey?-1:1,0),this.render(),this.scrollIntoView()):this.readOnly||this.showCellInput()}},{match:n=>Pe(n,"Delete")||Pe(n,"Backspace"),run:async n=>{this.readOnly||(n.preventDefault(),await this.sheet.removeData()&&this.render())}},{match:n=>!Va(n)&&this.isValidCellInput(n.key),run:()=>{this.readOnly||this.showCellInput(!0)}},{match:n=>et(n,{key:"z",mod:!0,shift:!1}),run:async n=>{this.readOnly||(n.preventDefault(),await this.sheet.undo()&&(this.render(),this.scrollIntoView()))}},{match:n=>et(n,{key:"z",mod:!0,shift:!0})||et(n,{key:"y",mod:!0}),run:async n=>{this.readOnly||(n.preventDefault(),await this.sheet.redo()&&(this.render(),this.scrollIntoView()))}},{match:n=>Pe(n,"Escape"),run:n=>{n.preventDefault(),this.sheet.getCopyRange()&&(this.sheet.clearCopyBuffer(),this.renderOverlay())}},{match:n=>et(n,{key:"c",mod:!0}),run:async n=>{n.preventDefault(),await this.copy()}},{match:n=>et(n,{key:"v",mod:!0}),run:async n=>{this.readOnly||(n.preventDefault(),await this.paste())}},{match:n=>et(n,{key:"b",mod:!0}),run:async n=>{this.readOnly||(n.preventDefault(),await this.sheet.toggleRangeStyle("b"),this.render())}},{match:n=>et(n,{key:"i",mod:!0}),run:async n=>{this.readOnly||(n.preventDefault(),await this.sheet.toggleRangeStyle("i"),this.render())}},{match:n=>et(n,{key:"u",mod:!0}),run:async n=>{this.readOnly||(n.preventDefault(),await this.sheet.toggleRangeStyle("u"),this.render())}},{match:n=>et(n,{key:"s",mod:!0,shift:!0}),run:async n=>{this.readOnly||(n.preventDefault(),await this.sheet.toggleRangeStyle("st"),this.render())}},{match:n=>et(n,{key:"m",mod:!0,shift:!0}),run:async n=>{this.readOnly||(n.preventDefault(),await this.sheet.toggleMergeSelection()&&this.render())}}])}getRangeExtentRef(){const e=this.sheet.getActiveCell(),t=this.sheet.getRange();if(!t)return e;const n=Math.abs(e.r-t[0].r)>Math.abs(t[1].r-e.r)?t[0].r:t[1].r,o=Math.abs(e.c-t[0].c)>Math.abs(t[1].c-e.c)?t[0].c:t[1].c;return{r:n,c:o}}async reloadDimensions(){await this.sheet.loadDimensions(),await this.sheet.loadStyles(),await this.sheet.loadMerges(),await this.sheet.loadFreezePane(),await this.sheet.loadFilterState(),this.hiddenRows.clear(),this.hiddenRowSizeBackup.clear(),this.syncHiddenRowsFromSheet(),this.updateFreezeState()}getGridViewportRect(){const e=this.viewport,t=this.container.getBoundingClientRect();return{left:e.left-t.left,top:e.top-t.top,width:e.width,height:e.height}}getScrollableGridViewportRect(){const e=this.getGridViewportRect(),t=this.freezeState,n=ue+t.frozenWidth,o=oe+t.frozenHeight;return{left:e.left+n,top:e.top+o,width:Math.max(0,e.width-n),height:Math.max(0,e.height-o)}}getCellRect(e){const t=this.freezeState;return t.frozenRows>0||t.frozenCols>0?Xi(e,this.scroll,this.rowDim,this.colDim,t):Le(e,this.scroll,this.rowDim,this.colDim)}getCellRectInScrollableViewport(e){const t=this.freezeState,n=this.scroll,o=n.left+this.colDim.getOffset(t.frozenCols+1)-t.frozenWidth,i=n.top+this.rowDim.getOffset(t.frozenRows+1)-t.frozenHeight;return Le(e,{left:o,top:i},this.rowDim,this.colDim)}getRangeRect(e){return Un(this.getCellRect(e[0]),this.getCellRect(e[1]))}setOnRender(e){this.onRenderCallback=e}render(){this.renderVersion+=1,this.requestRenderFrame()}requestRenderFrame(){this.pendingRenderFrame===null&&(this.pendingRenderFrame=requestAnimationFrame(()=>{this.pendingRenderFrame=null,this.handleRenderFrame()}))}handleRenderFrame(){if(this.renderInFlight){this.renderQueued=!0;return}this.renderInFlight=!0;const e=this.renderVersion;this.performRender(e).finally(()=>{this.renderInFlight=!1,(this.renderQueued||this.renderVersion!==e)&&(this.renderQueued=!1,this.requestRenderFrame())})}async performRender(e){var t;this.sheet&&(this.formulaBar.render(),await this.renderSheet(e),!(!this.sheet||e!==this.renderVersion)&&(this.renderOverlay(),(t=this.onRenderCallback)==null||t.call(this)))}renderOverlay(){this.overlay.render(this.viewport,this.scroll,this.sheet.getActiveCell(),this.sheet.getPresences(),this.sheet.getRange(),this.rowDim,this.colDim,this.resizeHover,this.sheet.getSelectionType(),this.dragMove?{axis:this.dragMove.axis,dropIndex:this.dragMove.dropIndex}:null,this.formulaRanges,this.freezeState,this.freezeDrag,this.sheet.getCopyRange(),this.autofillPreview,this.shouldShowAutofillHandle(),this.sheet.getMerges())}get viewRange(){const e=this.scroll,t=this.viewport,n=this.freezeState,o=this.rowDim.getOffset(n.frozenRows+1),i=this.colDim.getOffset(n.frozenCols+1),r=Math.max(n.frozenRows+1,this.rowDim.findIndex(o+e.top)),s=Math.max(r,this.rowDim.findIndex(o+e.top+t.height)+1),a=Math.max(n.frozenCols+1,this.colDim.findIndex(i+e.left)),c=Math.max(a,this.colDim.findIndex(i+e.left+t.width)+1);return[{r,c:a},{r:s,c}]}scrollIntoView(e=this.sheet.getActiveCell()){const t=this.scroll,n=this.freezeState,o=n.frozenRows>0&&e.r<=n.frozenRows,i=n.frozenCols>0&&e.c<=n.frozenCols,r=Le(e,{left:0,top:0},this.rowDim,this.colDim),s=this.sheet.getMerges().get(fe(e));if(s){const d=Le({r:e.r+s.rs-1,c:e.c+s.cs-1},{left:0,top:0},this.rowDim,this.colDim);r.width=d.left+d.width-r.left,r.height=d.top+d.height-r.top}const a=this.colDim.getOffset(n.frozenCols+1),c=this.rowDim.getOffset(n.frozenRows+1),u=this.viewport.width-ue-n.frozenWidth,h=this.viewport.height-oe-n.frozenHeight;let f=!1;if(!i){const d=a+t.left,p=d+u,y=r.left-ue,m=y+r.width;y<d?(this.scroll={left:y-a},f=!0):m>p&&(this.scroll={left:m-u-a},f=!0)}if(!o){const d=c+t.top,p=d+h,y=r.top-oe,m=y+r.height;y<d?(this.scroll={top:y-c},f=!0):m>p&&(this.scroll={top:m-h-c},f=!0)}f&&this.render()}getCellInputRect(e){const t=this.getCellRect(e),n=this.sheet.getMerges().get(fe(e));if(!n)return t;const o=this.getCellRect({r:e.r+n.rs-1,c:e.c+n.cs-1});return t.width=o.left+o.width-t.left,t.height=o.top+o.height-t.top,t}resolveCellInputLayout(e){const t=this.getCellInputRect(e),n=this.viewport,o=ue,i=oe,r=n.width,s=n.height;if(t.left<r&&t.left+t.width>o&&t.top<s&&t.top+t.height>i)return{left:t.left,top:t.top,width:t.width,height:t.height,maxWidth:Math.max(t.width,n.width-t.left),maxHeight:Math.max(t.height,n.height-t.top),pinned:!1};const c=o+Jn,u=i+Jn,h=Math.max(c,n.width-t.width-Jn),f=Math.max(u,n.height-t.height-Jn),d=Math.min(h,Math.max(c,t.left)),p=Math.min(f,Math.max(u,t.top));return{left:d,top:p,width:t.width,height:t.height,maxWidth:Math.max(t.width,n.width-d-Jn),maxHeight:Math.max(t.height,n.height-p-Jn),pinned:!0}}updateAutocompletePositionForActiveInput(){if(!this.autocomplete.isListVisible()&&!this.autocomplete.isHintVisible())return;let e;if(this.cellInput.isFocused()?e=this.cellInput.getInput():this.formulaBar.isFocused()&&(e=this.formulaBar.getFormulaInput()),!e)return;const t=e.getBoundingClientRect();this.autocomplete.reposition({left:t.left,top:t.bottom+2})}updateCellInputPosition(){if(!this.sheet||!this.cellInput.isShown())return;const e=this.sheet.getActiveCell(),t=this.resolveCellInputLayout(e);this.cellInput.updatePlacement(t.left,t.top,t.width,t.height,t.maxWidth,t.maxHeight),this.cellInput.setCellPositionHint(t.pinned?fe(e):void 0),this.updateAutocompletePositionForActiveInput()}async showCellInput(e=!1,t=!1){t||(this.editMode=!e);const n=this.sheet.getActiveCell(),o=this.resolveCellInputLayout(n),i=e?"":await this.sheet.toInputString(n);this.cellInput.show(o.left,o.top,i,!t,o.width,o.height,o.maxWidth,o.maxHeight),this.cellInput.setCellPositionHint(o.pinned?fe(n):void 0);const r=await this.sheet.getStyle(n);this.cellInput.applyStyle(r),i.startsWith("=")&&(this.formulaRanges=Bi(i).map(s=>s.range),this.renderOverlay())}isValidCellInput(e){return e.length===1||e==="Process"}async renderSheet(e=this.renderVersion){const t=this.sheet;if(!t)return;this.syncHiddenRowsFromSheet();const n=this.gridSize,o=this.freezeState;this.gridContainer.updateDummySize(n.width+ue,n.height+oe);const i=this.viewport,r=this.scroll,s=this.viewRange,a=[{r:1,c:1},{r:s[1].r,c:s[1].c}],c=await t.fetchGrid(a);t!==this.sheet||e!==this.renderVersion||this.gridCanvas.render(i,r,s,t.getActiveCell(),c,this.rowDim,this.colDim,t.getSelectionType(),t.getRange(),o,this.freezeHandleHover,t.getColStyles(),t.getRowStyles(),t.getSheetStyle(),t.getRangeStyles(),t.getConditionalFormats(),t.getMerges(),t.getFilterRange(),t.getFilteredColumns(),this.filterButtonHoverCol)}syncHiddenRowsFromSheet(){const e=this.sheet;if(!e)return;const t=e.getHiddenRows();for(const n of this.hiddenRows){if(t.has(n))continue;const o=this.hiddenRowSizeBackup.get(n)??this.rowDim.getDefaultSize();this.rowDim.setSize(n,o),this.hiddenRowSizeBackup.delete(n)}for(const n of t)this.hiddenRows.has(n)||(this.hiddenRowSizeBackup.set(n,this.rowDim.getSize(n)),this.rowDim.setSize(n,0));this.hiddenRows=t}get gridSize(){const e=this.sheet.getDimension();return{width:this.colDim.getOffset(e.columns+1),height:this.rowDim.getOffset(e.rows+1)}}get viewport(){return this.gridContainer.getViewport()}get scroll(){return this.gridContainer.getScrollPosition()}set scroll(e){this.gridContainer.setScrollPosition(e)}}async function ZS(l,e){const t=new av(l,e),n=(e==null?void 0:e.store)||new Iy;return await t.initialize(n),t}class av{constructor(e,t){B(this,"container");B(this,"worksheet");B(this,"sheet");B(this,"theme");B(this,"_readOnly");B(this,"selectionChangeCallbacks",[]);this.container=e,this.container.style.position="relative",this.container.style.overflow="hidden",this.theme=(t==null?void 0:t.theme)||"light",this._readOnly=(t==null?void 0:t.readOnly)||!1,this.worksheet=new sv(this.container,this.theme,this._readOnly)}get readOnly(){return this._readOnly}async initialize(e){this.sheet=new Py(e),this.worksheet.setOnRender(()=>this.notifySelectionChange()),await this.worksheet.initialize(this.sheet)}async reloadDimensions(){await this.worksheet.reloadDimensions()}async setFreezePane(e,t){this._readOnly||await this.worksheet.setFreezePane(e,t)}render(){this.worksheet.render()}renderOverlay(){this.worksheet.renderOverlay()}panBy(e,t){this.worksheet.panBy(e,t)}handleMobileDoubleTap(e,t){this.worksheet.handleMobileDoubleTap(e,t)}async focusCell(e){this.sheet&&(await this.worksheet.focusCell(e),this.notifySelectionChange())}async applyStyle(e){!this.sheet||this._readOnly||(await this.sheet.setRangeStyle(e),this.worksheet.render(),this.notifySelectionChange())}async applyBorders(e){!this.sheet||this._readOnly||await this.sheet.setRangeBorders(e)&&(this.worksheet.render(),this.notifySelectionChange())}async toggleStyle(e){!this.sheet||this._readOnly||(await this.sheet.toggleRangeStyle(e),this.worksheet.render(),this.notifySelectionChange())}async getActiveStyle(){if(this.sheet)return this.sheet.getStyle(this.sheet.getActiveCell())}getConditionalFormats(){var e;return((e=this.sheet)==null?void 0:e.getConditionalFormats())||[]}async setConditionalFormats(e){!this.sheet||this._readOnly||(await this.sheet.setConditionalFormats(e),this.worksheet.render(),this.notifySelectionChange())}onSelectionChange(e){return this.selectionChangeCallbacks.push(e),()=>{this.selectionChangeCallbacks=this.selectionChangeCallbacks.filter(t=>t!==e)}}notifySelectionChange(){for(const e of this.selectionChangeCallbacks)e()}getSelectionType(){var e;return(e=this.sheet)==null?void 0:e.getSelectionType()}getSelectionRangeOrActiveCell(){var e;return(e=this.sheet)==null?void 0:e.getRangeOrActiveCell()}getGridViewportRect(){return this.worksheet.getGridViewportRect()}getScrollableGridViewportRect(){return this.worksheet.getScrollableGridViewportRect()}getCellRect(e){return this.worksheet.getCellRect(e)}getCellRectInScrollableViewport(e){return this.worksheet.getCellRectInScrollableViewport(e)}async increaseDecimals(){if(!this.sheet||this._readOnly)return;const e=await this.sheet.getActiveDecimalPlaces();await this.sheet.setRangeStyle({dp:e+1}),this.worksheet.render(),this.notifySelectionChange()}async decreaseDecimals(){if(!this.sheet||this._readOnly)return;const e=await this.sheet.getActiveDecimalPlaces();await this.sheet.setRangeStyle({dp:Math.max(0,e-1)}),this.worksheet.render(),this.notifySelectionChange()}async toggleMergeCells(){!this.sheet||this._readOnly||await this.sheet.toggleMergeSelection()&&(this.worksheet.render(),this.notifySelectionChange())}isSelectionMerged(){return this.sheet?this.sheet.isSelectionMerged():!1}canMergeSelection(){return this.sheet?this.sheet.canMergeSelection():!1}hasFilter(){var e;return((e=this.sheet)==null?void 0:e.hasFilter())||!1}async createFilterFromSelection(){if(!this.sheet||this._readOnly)return!1;const e=await this.sheet.createFilterFromSelection();return e&&(this.worksheet.render(),this.notifySelectionChange()),e}async clearFilter(){!this.sheet||this._readOnly||(await this.sheet.clearFilter(),this.worksheet.render(),this.notifySelectionChange())}async setColumnFilter(e,t){if(!this.sheet||this._readOnly)return!1;const n=await this.sheet.setColumnFilter(e,t);return n&&(this.worksheet.render(),this.notifySelectionChange()),n}async clearColumnFilter(e){if(!this.sheet||this._readOnly)return!1;const t=await this.sheet.clearColumnFilter(e);return t&&(this.worksheet.render(),this.notifySelectionChange()),t}async undo(){!this.sheet||this._readOnly||await this.sheet.undo()&&(this.worksheet.render(),this.notifySelectionChange())}async redo(){!this.sheet||this._readOnly||await this.sheet.redo()&&(this.worksheet.render(),this.notifySelectionChange())}toggleFunctionBrowser(){this.worksheet.toggleFunctionBrowser()}cleanup(){this.worksheet.cleanup(),this.selectionChangeCallbacks=[]}setGridResolver(e){this.sheet&&this.sheet.setGridResolver(e)}async recalculateCrossSheetFormulas(){this.sheet&&(await this.sheet.recalculateCrossSheetFormulas(),this.worksheet.render())}}const lv=8,uv=280,cv=24;function e1({containerRef:l,sheetRef:e,enabled:t=!0}){const n=Yp();Gp.useEffect(()=>{const o=l.current;if(!t||!n||!o)return;let i=0,r=0,s=0,a=0,c=!1,u=!1,h=0,f=0,d=0;const p=x=>{if(x.touches.length!==1){u=x.touches.length>1,c=!1;return}const g=x.touches[0];i=g.clientX,r=g.clientY,s=g.clientX,a=g.clientY},y=x=>{var b;if(x.touches.length!==1){u=u||x.touches.length>1;return}const g=x.touches[0],S=g.clientX-s,C=g.clientY-a,A=Math.hypot(g.clientX-i,g.clientY-r);!c&&A>=lv&&(c=!0),c&&(x.preventDefault(),(b=e.current)==null||b.panBy(-S,-C)),s=g.clientX,a=g.clientY},m=x=>{var C;if(x.touches.length>0)return;if(u){u=!1,c=!1;return}if(c){c=!1;return}const g=Date.now(),S=Math.hypot(s-f,a-d);if(h!==0&&g-h<=uv&&S<=cv){(C=e.current)==null||C.handleMobileDoubleTap(s,a),h=0;return}h=g,f=s,d=a},v=()=>{c=!1,u=!1};return o.addEventListener("touchstart",p,{passive:!0}),o.addEventListener("touchmove",y,{passive:!1}),o.addEventListener("touchend",m,{passive:!0}),o.addEventListener("touchcancel",v,{passive:!0}),()=>{o.removeEventListener("touchstart",p),o.removeEventListener("touchmove",y),o.removeEventListener("touchend",m),o.removeEventListener("touchcancel",v)}},[l,t,n,e])}export{uy as C,Dr as a,JS as b,Gi as c,$o as d,_p as e,cy as f,li as g,Gg as h,oo as i,Ip as j,bp as k,Mp as l,Vn as m,gr as n,$g as o,be as p,Dp as q,Ye as r,Wg as s,fe as t,Np as u,Bp as v,e1 as w,ZS as x};
