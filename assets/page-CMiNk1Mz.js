import{u as V,a as k,r as l,j as e,b as E,i as H}from"./index-DqYulbeR.js";import{c as K,r as q,d as A,f as I}from"./documents-CQrqX3aE.js";import{u as x,a as L,P as Q,T as z,b as B,c as g,d as O,f,e as $,g as N,h as G,i as J,j as U,k as W,l as X,E as Y,m as Z,n as _}from"./table-BOmUvMyR.js";import{B as i}from"./button-FUhDrNNi.js";import{D as ee,a as te,b as se,c as ae,d as ne,e as ie}from"./dialog-BpmiHJTE.js";import{D as le,a as re,b as oe,c as y}from"./dropdown-menu-BlptbtAb.js";import{I as C}from"./input-BJ6kmz8w.js";import{L as ce}from"./label-CoVKQjfE.js";import"./index-CeYm40aA.js";import"./index-UzSxKt7h.js";import"./index-qayouoRc.js";import"./index-D7OyEzFU.js";function de({data:m}){var j,p;const r=V(),o=k(),c=[{accessorKey:"id",header:"ID",enableHiding:!0},{accessorKey:"title",header:"Title",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("title")})},{accessorKey:"createdAt",header:()=>e.jsx("div",{className:"text-right",children:"Created At"}),cell:({row:t})=>{const s=t.getValue("createdAt"),u=X(new Date(s),{includeSeconds:!0,addSuffix:!0});return e.jsx("div",{className:"text-right font-medium",children:u})}},{id:"actions",enableHiding:!1,cell:({row:t})=>e.jsxs(le,{children:[e.jsx(re,{asChild:!0,children:e.jsxs(i,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Y,{})]})}),e.jsxs(oe,{align:"end",children:[e.jsxs(y,{onClick:s=>{s.stopPropagation(),d({id:String(t.getValue("id")),title:t.getValue("title")})},children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Rename"]}),e.jsxs(y,{className:"text-red-500 focus:text-red-500",onClick:s=>{s.stopPropagation(),D.mutate(String(t.getValue("id")))},children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}],[a,d]=l.useState(null),w=x({mutationFn:async t=>await K(t),onSuccess:t=>o(`/${t.id}`)}),D=x({mutationFn:async t=>await A(t),onSuccess:()=>r.invalidateQueries({queryKey:["documents"]})}),h=x({mutationFn:async({id:t,title:s})=>await q(t,s),onSuccess:()=>{r.invalidateQueries({queryKey:["documents"]}),d(null)}}),[b,v]=l.useState([]),[S,R]=l.useState([]),[M,F]=l.useState({id:!1}),[P,T]=l.useState({}),n=L({data:m,columns:c,onSortingChange:v,onColumnFiltersChange:R,getCoreRowModel:W(),getPaginationRowModel:U(),getSortedRowModel:J(),getFilteredRowModel:G(),onColumnVisibilityChange:F,onRowSelectionChange:T,state:{sorting:b,columnFilters:S,columnVisibility:M,rowSelection:P}});return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsx(C,{placeholder:"Filter by title...",value:((j=n.getColumn("title"))==null?void 0:j.getFilterValue())??"",onChange:t=>{var s;return(s=n.getColumn("title"))==null?void 0:s.setFilterValue(t.target.value)},className:"max-w-sm"}),e.jsxs(i,{onClick:()=>{w.mutate({title:"New Document"})},className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"New Document"]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(z,{children:[e.jsx(B,{children:n.getHeaderGroups().map(t=>e.jsx(g,{children:t.headers.map(s=>e.jsx(O,{children:s.isPlaceholder?null:f(s.column.columnDef.header,s.getContext())},s.id))},t.id))}),e.jsx($,{children:(p=n.getRowModel().rows)!=null&&p.length?n.getRowModel().rows.map(t=>e.jsx(g,{"data-state":t.getIsSelected()&&"selected",className:"cursor-pointer hover:bg-muted",onClick:s=>{s.target.closest("input, button")||o(`/${t.getValue("id")}`)},children:t.getVisibleCells().map(s=>e.jsx(N,{children:f(s.column.columnDef.cell,s.getContext())},s.id))},t.id)):e.jsx(g,{children:e.jsx(N,{colSpan:c.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>n.previousPage(),disabled:!n.getCanPreviousPage(),children:"Previous"}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>n.nextPage(),disabled:!n.getCanNextPage(),children:"Next"})]})]}),e.jsx(ee,{open:a!==null,onOpenChange:t=>{t||d(null)},children:e.jsx(te,{className:"sm:max-w-md",children:e.jsxs("form",{onSubmit:t=>{if(t.preventDefault(),!a)return;const u=new FormData(t.target).get("title");u.trim()&&h.mutate({id:a.id,title:u.trim()})},children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Rename Document"}),e.jsx(ne,{children:"Enter a new name for this document."})]}),e.jsx("div",{className:"grid gap-4 py-2",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(ce,{htmlFor:"rename-title",children:"Title"}),e.jsx(C,{id:"rename-title",name:"title",defaultValue:(a==null?void 0:a.title)??"",autoFocus:!0},a==null?void 0:a.id)]})}),e.jsxs(ie,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>d(null),children:"Cancel"}),e.jsx(i,{type:"submit",disabled:h.isPending,children:"Rename"})]})]})})})]})}function De(){const{data:m=[],isLoading:r,isError:o,error:c}=E({queryKey:["documents"],queryFn:I});return r?e.jsx("div",{className:"flex flex-col items-center justify-center h-64",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"Loading documents..."})}):o?H(c)?null:e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("p",{className:"text-red-500 text-lg",children:"Failed to load documents."}),e.jsx("p",{className:"text-gray-400",children:"Please try again later."})]}):e.jsx("div",{className:"p-4",children:e.jsx(de,{data:m})})}export{De as default};
