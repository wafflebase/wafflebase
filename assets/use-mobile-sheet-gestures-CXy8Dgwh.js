var up=Object.defineProperty;var cp=(u,e,t)=>e in u?up(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t;var k=(u,e,t)=>cp(u,typeof e!="symbol"?e+"":e,t);import{z as $f,r as hp}from"./index-D5oNvs3K.js";import{u as fp}from"./IconDotsVertical-CIzKPvuZ.js";var Dr={},Oo={},ua;function dp(){if(ua)return Oo;ua=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Oo,"__esModule",{value:!0}),Oo}var Fo={},ca;function pp(){if(ca)return Fo;ca=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Fo,"__esModule",{value:!0}),Fo}var Ir={},Po={exports:{}},Do={},Io={},Lo={},Bo,ha;function Pl(){return ha||(ha=1,Bo=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var s=42;e[t]=s;for(var n in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var r=Object.getOwnPropertySymbols(e);if(r.length!==1||r[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==s||o.enumerable!==!0)return!1}return!0}),Bo}var Mo,fa;function ho(){if(fa)return Mo;fa=1;var u=Pl();return Mo=function(){return u()&&!!Symbol.toStringTag},Mo}var ko,da;function Dl(){return da||(da=1,ko=Object),ko}var zo,pa;function xp(){return pa||(pa=1,zo=Error),zo}var jo,xa;function mp(){return xa||(xa=1,jo=EvalError),jo}var qo,ma;function gp(){return ma||(ma=1,qo=RangeError),qo}var Uo,ga;function yp(){return ga||(ga=1,Uo=ReferenceError),Uo}var Ho,ya;function Vf(){return ya||(ya=1,Ho=SyntaxError),Ho}var $o,va;function zi(){return va||(va=1,$o=TypeError),$o}var Vo,Sa;function vp(){return Sa||(Sa=1,Vo=URIError),Vo}var Wo,Aa;function Sp(){return Aa||(Aa=1,Wo=Math.abs),Wo}var Go,Ca;function Ap(){return Ca||(Ca=1,Go=Math.floor),Go}var Yo,Ea;function Cp(){return Ea||(Ea=1,Yo=Math.max),Yo}var Xo,_a;function Ep(){return _a||(_a=1,Xo=Math.min),Xo}var Ko,Ta;function _p(){return Ta||(Ta=1,Ko=Math.pow),Ko}var Qo,ba;function Tp(){return ba||(ba=1,Qo=Math.round),Qo}var Jo,Na;function bp(){return Na||(Na=1,Jo=Number.isNaN||function(e){return e!==e}),Jo}var Zo,Ra;function Np(){if(Ra)return Zo;Ra=1;var u=bp();return Zo=function(t){return u(t)||t===0?t:t<0?-1:1},Zo}var es,wa;function Rp(){return wa||(wa=1,es=Object.getOwnPropertyDescriptor),es}var ts,Oa;function ei(){if(Oa)return ts;Oa=1;var u=Rp();if(u)try{u([],"length")}catch{u=null}return ts=u,ts}var rs,Fa;function fo(){if(Fa)return rs;Fa=1;var u=Object.defineProperty||!1;if(u)try{u({},"a",{value:1})}catch{u=!1}return rs=u,rs}var ns,Pa;function wp(){if(Pa)return ns;Pa=1;var u=typeof Symbol<"u"&&Symbol,e=Pl();return ns=function(){return typeof u!="function"||typeof Symbol!="function"||typeof u("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},ns}var is,Da;function Wf(){return Da||(Da=1,is=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),is}var os,Ia;function Gf(){if(Ia)return os;Ia=1;var u=Dl();return os=u.getPrototypeOf||null,os}var ss,La;function Op(){if(La)return ss;La=1;var u="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,i="[object Function]",s=function(l,c){for(var a=[],h=0;h<l.length;h+=1)a[h]=l[h];for(var f=0;f<c.length;f+=1)a[f+l.length]=c[f];return a},n=function(l,c){for(var a=[],h=c,f=0;h<l.length;h+=1,f+=1)a[f]=l[h];return a},r=function(o,l){for(var c="",a=0;a<o.length;a+=1)c+=o[a],a+1<o.length&&(c+=l);return c};return ss=function(l){var c=this;if(typeof c!="function"||e.apply(c)!==i)throw new TypeError(u+c);for(var a=n(arguments,1),h,f=function(){if(this instanceof h){var y=c.apply(this,s(a,arguments));return Object(y)===y?y:this}return c.apply(l,s(a,arguments))},d=t(0,c.length-a.length),p=[],v=0;v<d;v++)p[v]="$"+v;if(h=Function("binder","return function ("+r(p,",")+"){ return binder.apply(this,arguments); }")(f),c.prototype){var x=function(){};x.prototype=c.prototype,h.prototype=new x,x.prototype=null}return h},ss}var ls,Ba;function ji(){if(Ba)return ls;Ba=1;var u=Op();return ls=Function.prototype.bind||u,ls}var as,Ma;function Il(){return Ma||(Ma=1,as=Function.prototype.call),as}var us,ka;function Ll(){return ka||(ka=1,us=Function.prototype.apply),us}var cs,za;function Fp(){return za||(za=1,cs=typeof Reflect<"u"&&Reflect&&Reflect.apply),cs}var hs,ja;function Yf(){if(ja)return hs;ja=1;var u=ji(),e=Ll(),t=Il(),i=Fp();return hs=i||u.call(t,e),hs}var fs,qa;function Bl(){if(qa)return fs;qa=1;var u=ji(),e=zi(),t=Il(),i=Yf();return fs=function(n){if(n.length<1||typeof n[0]!="function")throw new e("a function is required");return i(u,t,n)},fs}var ds,Ua;function Pp(){if(Ua)return ds;Ua=1;var u=Bl(),e=ei(),t;try{t=[].__proto__===Array.prototype}catch(r){if(!r||typeof r!="object"||!("code"in r)||r.code!=="ERR_PROTO_ACCESS")throw r}var i=!!t&&e&&e(Object.prototype,"__proto__"),s=Object,n=s.getPrototypeOf;return ds=i&&typeof i.get=="function"?u([i.get]):typeof n=="function"?function(o){return n(o==null?o:s(o))}:!1,ds}var ps,Ha;function Ml(){if(Ha)return ps;Ha=1;var u=Wf(),e=Gf(),t=Pp();return ps=u?function(s){return u(s)}:e?function(s){if(!s||typeof s!="object"&&typeof s!="function")throw new TypeError("getProto: not an object");return e(s)}:t?function(s){return t(s)}:null,ps}var xs,$a;function Xf(){if($a)return xs;$a=1;var u=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=ji();return xs=t.call(u,e),xs}var ms,Va;function kl(){if(Va)return ms;Va=1;var u,e=Dl(),t=xp(),i=mp(),s=gp(),n=yp(),r=Vf(),o=zi(),l=vp(),c=Sp(),a=Ap(),h=Cp(),f=Ep(),d=_p(),p=Tp(),v=Np(),x=Function,y=function(D){try{return x('"use strict"; return ('+D+").constructor;")()}catch{}},g=ei(),m=fo(),S=function(){throw new o},T=g?function(){try{return arguments.callee,S}catch{try{return g(arguments,"callee").get}catch{return S}}}():S,A=wp()(),b=Ml(),N=Gf(),R=Wf(),P=Ll(),I=Il(),B={},V=typeof Uint8Array>"u"||!b?u:b(Uint8Array),ee={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?u:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?u:ArrayBuffer,"%ArrayIteratorPrototype%":A&&b?b([][Symbol.iterator]()):u,"%AsyncFromSyncIteratorPrototype%":u,"%AsyncFunction%":B,"%AsyncGenerator%":B,"%AsyncGeneratorFunction%":B,"%AsyncIteratorPrototype%":B,"%Atomics%":typeof Atomics>"u"?u:Atomics,"%BigInt%":typeof BigInt>"u"?u:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?u:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?u:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?u:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":i,"%Float16Array%":typeof Float16Array>"u"?u:Float16Array,"%Float32Array%":typeof Float32Array>"u"?u:Float32Array,"%Float64Array%":typeof Float64Array>"u"?u:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?u:FinalizationRegistry,"%Function%":x,"%GeneratorFunction%":B,"%Int8Array%":typeof Int8Array>"u"?u:Int8Array,"%Int16Array%":typeof Int16Array>"u"?u:Int16Array,"%Int32Array%":typeof Int32Array>"u"?u:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":A&&b?b(b([][Symbol.iterator]())):u,"%JSON%":typeof JSON=="object"?JSON:u,"%Map%":typeof Map>"u"?u:Map,"%MapIteratorPrototype%":typeof Map>"u"||!A||!b?u:b(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":g,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?u:Promise,"%Proxy%":typeof Proxy>"u"?u:Proxy,"%RangeError%":s,"%ReferenceError%":n,"%Reflect%":typeof Reflect>"u"?u:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?u:Set,"%SetIteratorPrototype%":typeof Set>"u"||!A||!b?u:b(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?u:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":A&&b?b(""[Symbol.iterator]()):u,"%Symbol%":A?Symbol:u,"%SyntaxError%":r,"%ThrowTypeError%":T,"%TypedArray%":V,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?u:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?u:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?u:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?u:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?u:WeakMap,"%WeakRef%":typeof WeakRef>"u"?u:WeakRef,"%WeakSet%":typeof WeakSet>"u"?u:WeakSet,"%Function.prototype.call%":I,"%Function.prototype.apply%":P,"%Object.defineProperty%":m,"%Object.getPrototypeOf%":N,"%Math.abs%":c,"%Math.floor%":a,"%Math.max%":h,"%Math.min%":f,"%Math.pow%":d,"%Math.round%":p,"%Math.sign%":v,"%Reflect.getPrototypeOf%":R};if(b)try{null.error}catch(D){var te=b(b(D));ee["%Error.prototype%"]=te}var le=function D(j){var H;if(j==="%AsyncFunction%")H=y("async function () {}");else if(j==="%GeneratorFunction%")H=y("function* () {}");else if(j==="%AsyncGeneratorFunction%")H=y("async function* () {}");else if(j==="%AsyncGenerator%"){var W=D("%AsyncGeneratorFunction%");W&&(H=W.prototype)}else if(j==="%AsyncIteratorPrototype%"){var L=D("%AsyncGenerator%");L&&b&&(H=b(L.prototype))}return ee[j]=H,H},ge={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ce=ji(),Z=Xf(),Y=ce.call(I,Array.prototype.concat),Q=ce.call(P,Array.prototype.splice),ie=ce.call(I,String.prototype.replace),E=ce.call(I,String.prototype.slice),C=ce.call(I,RegExp.prototype.exec),_=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,w=/\\(\\)?/g,F=function(j){var H=E(j,0,1),W=E(j,-1);if(H==="%"&&W!=="%")throw new r("invalid intrinsic syntax, expected closing `%`");if(W==="%"&&H!=="%")throw new r("invalid intrinsic syntax, expected opening `%`");var L=[];return ie(j,_,function(M,U,G,re){L[L.length]=G?ie(re,w,"$1"):U||M}),L},O=function(j,H){var W=j,L;if(Z(ge,W)&&(L=ge[W],W="%"+L[0]+"%"),Z(ee,W)){var M=ee[W];if(M===B&&(M=le(W)),typeof M>"u"&&!H)throw new o("intrinsic "+j+" exists, but is not available. Please file an issue!");return{alias:L,name:W,value:M}}throw new r("intrinsic "+j+" does not exist!")};return ms=function(j,H){if(typeof j!="string"||j.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof H!="boolean")throw new o('"allowMissing" argument must be a boolean');if(C(/^%?[^%]*%?$/,j)===null)throw new r("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var W=F(j),L=W.length>0?W[0]:"",M=O("%"+L+"%",H),U=M.name,G=M.value,re=!1,ne=M.alias;ne&&(L=ne[0],Q(W,Y([0,1],ne)));for(var q=1,X=!0;q<W.length;q+=1){var he=W[q],Te=E(he,0,1),Ne=E(he,-1);if((Te==='"'||Te==="'"||Te==="`"||Ne==='"'||Ne==="'"||Ne==="`")&&Te!==Ne)throw new r("property names with quotes must have matching quotes");if((he==="constructor"||!X)&&(re=!0),L+="."+he,U="%"+L+"%",Z(ee,U))G=ee[U];else if(G!=null){if(!(he in G)){if(!H)throw new o("base intrinsic for "+j+" exists, but the property is not available.");return}if(g&&q+1>=W.length){var z=g(G,he);X=!!z,X&&"get"in z&&!("originalValue"in z.get)?G=z.get:G=G[he]}else X=Z(G,he),G=G[he];X&&!re&&(ee[U]=G)}}return G},ms}var gs,Wa;function ti(){if(Wa)return gs;Wa=1;var u=kl(),e=Bl(),t=e([u("%String.prototype.indexOf%")]);return gs=function(s,n){var r=u(s,!!n);return typeof r=="function"&&t(s,".prototype.")>-1?e([r]):r},gs}var ys,Ga;function Dp(){if(Ga)return ys;Ga=1;var u=ho()(),e=ti(),t=e("Object.prototype.toString"),i=function(o){return u&&o&&typeof o=="object"&&Symbol.toStringTag in o?!1:t(o)==="[object Arguments]"},s=function(o){return i(o)?!0:o!==null&&typeof o=="object"&&"length"in o&&typeof o.length=="number"&&o.length>=0&&t(o)!=="[object Array]"&&"callee"in o&&t(o.callee)==="[object Function]"},n=function(){return i(arguments)}();return i.isLegacyArguments=s,ys=n?i:s,ys}var vs,Ya;function Ip(){if(Ya)return vs;Ya=1;var u=ti(),e=ho()(),t=Xf(),i=ei(),s;if(e){var n=u("RegExp.prototype.exec"),r={},o=function(){throw r},l={toString:o,valueOf:o};typeof Symbol.toPrimitive=="symbol"&&(l[Symbol.toPrimitive]=o),s=function(f){if(!f||typeof f!="object")return!1;var d=i(f,"lastIndex"),p=d&&t(d,"value");if(!p)return!1;try{n(f,l)}catch(v){return v===r}}}else{var c=u("Object.prototype.toString"),a="[object RegExp]";s=function(f){return!f||typeof f!="object"&&typeof f!="function"?!1:c(f)===a}}return vs=s,vs}var Ss,Xa;function Lp(){if(Xa)return Ss;Xa=1;var u=ti(),e=Ip(),t=u("RegExp.prototype.exec"),i=zi();return Ss=function(n){if(!e(n))throw new i("`regex` must be a RegExp");return function(o){return t(n,o)!==null}},Ss}var As,Ka;function Bp(){if(Ka)return As;Ka=1;var u=ti(),e=Lp(),t=e(/^\s*(?:function)?\*/),i=ho()(),s=Ml(),n=u("Object.prototype.toString"),r=u("Function.prototype.toString"),o=function(){if(!i)return!1;try{return Function("return function*() {}")()}catch{}},l;return As=function(a){if(typeof a!="function")return!1;if(t(r(a)))return!0;if(!i){var h=n(a);return h==="[object GeneratorFunction]"}if(!s)return!1;if(typeof l>"u"){var f=o();l=f?s(f):!1}return s(a)===l},As}var Cs,Qa;function Mp(){if(Qa)return Cs;Qa=1;var u=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,i;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw i}}),i={},e(function(){throw 42},null,t)}catch(g){g!==i&&(e=null)}else e=null;var s=/^\s*class\b/,n=function(m){try{var S=u.call(m);return s.test(S)}catch{return!1}},r=function(m){try{return n(m)?!1:(u.call(m),!0)}catch{return!1}},o=Object.prototype.toString,l="[object Object]",c="[object Function]",a="[object GeneratorFunction]",h="[object HTMLAllCollection]",f="[object HTML document.all class]",d="[object HTMLCollection]",p=typeof Symbol=="function"&&!!Symbol.toStringTag,v=!(0 in[,]),x=function(){return!1};if(typeof document=="object"){var y=document.all;o.call(y)===o.call(document.all)&&(x=function(m){if((v||!m)&&(typeof m>"u"||typeof m=="object"))try{var S=o.call(m);return(S===h||S===f||S===d||S===l)&&m("")==null}catch{}return!1})}return Cs=e?function(m){if(x(m))return!0;if(!m||typeof m!="function"&&typeof m!="object")return!1;try{e(m,null,t)}catch(S){if(S!==i)return!1}return!n(m)&&r(m)}:function(m){if(x(m))return!0;if(!m||typeof m!="function"&&typeof m!="object")return!1;if(p)return r(m);if(n(m))return!1;var S=o.call(m);return S!==c&&S!==a&&!/^\[object HTML/.test(S)?!1:r(m)},Cs}var Es,Ja;function kp(){if(Ja)return Es;Ja=1;var u=Mp(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,i=function(l,c,a){for(var h=0,f=l.length;h<f;h++)t.call(l,h)&&(a==null?c(l[h],h,l):c.call(a,l[h],h,l))},s=function(l,c,a){for(var h=0,f=l.length;h<f;h++)a==null?c(l.charAt(h),h,l):c.call(a,l.charAt(h),h,l)},n=function(l,c,a){for(var h in l)t.call(l,h)&&(a==null?c(l[h],h,l):c.call(a,l[h],h,l))};function r(o){return e.call(o)==="[object Array]"}return Es=function(l,c,a){if(!u(c))throw new TypeError("iterator must be a function");var h;arguments.length>=3&&(h=a),r(l)?i(l,c,h):typeof l=="string"?s(l,c,h):n(l,c,h)},Es}var _s,Za;function zp(){return Za||(Za=1,_s=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),_s}var Ts,eu;function jp(){if(eu)return Ts;eu=1;var u=zp(),e=typeof globalThis>"u"?$f:globalThis;return Ts=function(){for(var i=[],s=0;s<u.length;s++)typeof e[u[s]]=="function"&&(i[i.length]=u[s]);return i},Ts}var bs={exports:{}},Ns,tu;function Kf(){if(tu)return Ns;tu=1;var u=fo(),e=Vf(),t=zi(),i=ei();return Ns=function(n,r,o){if(!n||typeof n!="object"&&typeof n!="function")throw new t("`obj` must be an object or a function`");if(typeof r!="string"&&typeof r!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var l=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,h=arguments.length>6?arguments[6]:!1,f=!!i&&i(n,r);if(u)u(n,r,{configurable:a===null&&f?f.configurable:!a,enumerable:l===null&&f?f.enumerable:!l,value:o,writable:c===null&&f?f.writable:!c});else if(h||!l&&!c&&!a)n[r]=o;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Ns}var Rs,ru;function Qf(){if(ru)return Rs;ru=1;var u=fo(),e=function(){return!!u};return e.hasArrayLengthDefineBug=function(){if(!u)return null;try{return u([],"length",{value:1}).length!==1}catch{return!0}},Rs=e,Rs}var ws,nu;function qp(){if(nu)return ws;nu=1;var u=kl(),e=Kf(),t=Qf()(),i=ei(),s=zi(),n=u("%Math.floor%");return ws=function(o,l){if(typeof o!="function")throw new s("`fn` is not a function");if(typeof l!="number"||l<0||l>4294967295||n(l)!==l)throw new s("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],a=!0,h=!0;if("length"in o&&i){var f=i(o,"length");f&&!f.configurable&&(a=!1),f&&!f.writable&&(h=!1)}return(a||h||!c)&&(t?e(o,"length",l,!0,!0):e(o,"length",l)),o},ws}var Os,iu;function Up(){if(iu)return Os;iu=1;var u=ji(),e=Ll(),t=Yf();return Os=function(){return t(u,e,arguments)},Os}var ou;function po(){return ou||(ou=1,function(u){var e=qp(),t=fo(),i=Bl(),s=Up();u.exports=function(r){var o=i(arguments),l=r.length-(arguments.length-1);return e(o,1+(l>0?l:0),!0)},t?t(u.exports,"apply",{value:s}):u.exports.apply=s}(bs)),bs.exports}var Fs,su;function Jf(){if(su)return Fs;su=1;var u=kp(),e=jp(),t=po(),i=ti(),s=ei(),n=Ml(),r=i("Object.prototype.toString"),o=ho()(),l=typeof globalThis>"u"?$f:globalThis,c=e(),a=i("String.prototype.slice"),h=i("Array.prototype.indexOf",!0)||function(x,y){for(var g=0;g<x.length;g+=1)if(x[g]===y)return g;return-1},f={__proto__:null};o&&s&&n?u(c,function(v){var x=new l[v];if(Symbol.toStringTag in x&&n){var y=n(x),g=s(y,Symbol.toStringTag);if(!g&&y){var m=n(y);g=s(m,Symbol.toStringTag)}f["$"+v]=t(g.get)}}):u(c,function(v){var x=new l[v],y=x.slice||x.set;y&&(f["$"+v]=t(y))});var d=function(x){var y=!1;return u(f,function(g,m){if(!y)try{"$"+g(x)===m&&(y=a(m,1))}catch{}}),y},p=function(x){var y=!1;return u(f,function(g,m){if(!y)try{g(x),y=a(m,1)}catch{}}),y};return Fs=function(x){if(!x||typeof x!="object")return!1;if(!o){var y=a(r(x),8,-1);return h(c,y)>-1?y:y!=="Object"?!1:p(x)}return s?d(x):null},Fs}var Ps,lu;function Hp(){if(lu)return Ps;lu=1;var u=Jf();return Ps=function(t){return!!u(t)},Ps}var au;function $p(){return au||(au=1,function(u){var e=Dp(),t=Bp(),i=Jf(),s=Hp();function n(q){return q.call.bind(q)}var r=typeof BigInt<"u",o=typeof Symbol<"u",l=n(Object.prototype.toString),c=n(Number.prototype.valueOf),a=n(String.prototype.valueOf),h=n(Boolean.prototype.valueOf);if(r)var f=n(BigInt.prototype.valueOf);if(o)var d=n(Symbol.prototype.valueOf);function p(q,X){if(typeof q!="object")return!1;try{return X(q),!0}catch{return!1}}u.isArgumentsObject=e,u.isGeneratorFunction=t,u.isTypedArray=s;function v(q){return typeof Promise<"u"&&q instanceof Promise||q!==null&&typeof q=="object"&&typeof q.then=="function"&&typeof q.catch=="function"}u.isPromise=v;function x(q){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(q):s(q)||E(q)}u.isArrayBufferView=x;function y(q){return i(q)==="Uint8Array"}u.isUint8Array=y;function g(q){return i(q)==="Uint8ClampedArray"}u.isUint8ClampedArray=g;function m(q){return i(q)==="Uint16Array"}u.isUint16Array=m;function S(q){return i(q)==="Uint32Array"}u.isUint32Array=S;function T(q){return i(q)==="Int8Array"}u.isInt8Array=T;function A(q){return i(q)==="Int16Array"}u.isInt16Array=A;function b(q){return i(q)==="Int32Array"}u.isInt32Array=b;function N(q){return i(q)==="Float32Array"}u.isFloat32Array=N;function R(q){return i(q)==="Float64Array"}u.isFloat64Array=R;function P(q){return i(q)==="BigInt64Array"}u.isBigInt64Array=P;function I(q){return i(q)==="BigUint64Array"}u.isBigUint64Array=I;function B(q){return l(q)==="[object Map]"}B.working=typeof Map<"u"&&B(new Map);function V(q){return typeof Map>"u"?!1:B.working?B(q):q instanceof Map}u.isMap=V;function ee(q){return l(q)==="[object Set]"}ee.working=typeof Set<"u"&&ee(new Set);function te(q){return typeof Set>"u"?!1:ee.working?ee(q):q instanceof Set}u.isSet=te;function le(q){return l(q)==="[object WeakMap]"}le.working=typeof WeakMap<"u"&&le(new WeakMap);function ge(q){return typeof WeakMap>"u"?!1:le.working?le(q):q instanceof WeakMap}u.isWeakMap=ge;function ce(q){return l(q)==="[object WeakSet]"}ce.working=typeof WeakSet<"u"&&ce(new WeakSet);function Z(q){return ce(q)}u.isWeakSet=Z;function Y(q){return l(q)==="[object ArrayBuffer]"}Y.working=typeof ArrayBuffer<"u"&&Y(new ArrayBuffer);function Q(q){return typeof ArrayBuffer>"u"?!1:Y.working?Y(q):q instanceof ArrayBuffer}u.isArrayBuffer=Q;function ie(q){return l(q)==="[object DataView]"}ie.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&ie(new DataView(new ArrayBuffer(1),0,1));function E(q){return typeof DataView>"u"?!1:ie.working?ie(q):q instanceof DataView}u.isDataView=E;var C=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function _(q){return l(q)==="[object SharedArrayBuffer]"}function w(q){return typeof C>"u"?!1:(typeof _.working>"u"&&(_.working=_(new C)),_.working?_(q):q instanceof C)}u.isSharedArrayBuffer=w;function F(q){return l(q)==="[object AsyncFunction]"}u.isAsyncFunction=F;function O(q){return l(q)==="[object Map Iterator]"}u.isMapIterator=O;function D(q){return l(q)==="[object Set Iterator]"}u.isSetIterator=D;function j(q){return l(q)==="[object Generator]"}u.isGeneratorObject=j;function H(q){return l(q)==="[object WebAssembly.Module]"}u.isWebAssemblyCompiledModule=H;function W(q){return p(q,c)}u.isNumberObject=W;function L(q){return p(q,a)}u.isStringObject=L;function M(q){return p(q,h)}u.isBooleanObject=M;function U(q){return r&&p(q,f)}u.isBigIntObject=U;function G(q){return o&&p(q,d)}u.isSymbolObject=G;function re(q){return W(q)||L(q)||M(q)||U(q)||G(q)}u.isBoxedPrimitive=re;function ne(q){return typeof Uint8Array<"u"&&(Q(q)||w(q))}u.isAnyArrayBuffer=ne,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(q){Object.defineProperty(u,q,{enumerable:!1,value:function(){throw new Error(q+" is not supported in userland")}})})}(Lo)),Lo}var Ds,uu;function Vp(){return uu||(uu=1,Ds=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),Ds}var Ki={exports:{}},cu;function Wp(){return cu||(cu=1,typeof Object.create=="function"?Ki.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Ki.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}),Ki.exports}var hu;function Xn(){return hu||(hu=1,function(u){var e={},t=Object.getOwnPropertyDescriptors||function(C){for(var _=Object.keys(C),w={},F=0;F<_.length;F++)w[_[F]]=Object.getOwnPropertyDescriptor(C,_[F]);return w},i=/%[sdj%]/g;u.format=function(E){if(!A(E)){for(var C=[],_=0;_<arguments.length;_++)C.push(o(arguments[_]));return C.join(" ")}for(var _=1,w=arguments,F=w.length,O=String(E).replace(i,function(j){if(j==="%%")return"%";if(_>=F)return j;switch(j){case"%s":return String(w[_++]);case"%d":return Number(w[_++]);case"%j":try{return JSON.stringify(w[_++])}catch{return"[Circular]"}default:return j}}),D=w[_];_<F;D=w[++_])m(D)||!P(D)?O+=" "+D:O+=" "+o(D);return O},u.deprecate=function(E,C){if(typeof process<"u"&&process.noDeprecation===!0)return E;if(typeof process>"u")return function(){return u.deprecate(E,C).apply(this,arguments)};var _=!1;function w(){if(!_){if(process.throwDeprecation)throw new Error(C);process.traceDeprecation?console.trace(C):console.error(C),_=!0}return E.apply(this,arguments)}return w};var s={},n=/^$/;if(e.NODE_DEBUG){var r=e.NODE_DEBUG;r=r.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),n=new RegExp("^"+r+"$","i")}u.debuglog=function(E){if(E=E.toUpperCase(),!s[E])if(n.test(E)){var C=process.pid;s[E]=function(){var _=u.format.apply(u,arguments);console.error("%s %d: %s",E,C,_)}}else s[E]=function(){};return s[E]};function o(E,C){var _={seen:[],stylize:c};return arguments.length>=3&&(_.depth=arguments[2]),arguments.length>=4&&(_.colors=arguments[3]),g(C)?_.showHidden=C:C&&u._extend(_,C),N(_.showHidden)&&(_.showHidden=!1),N(_.depth)&&(_.depth=2),N(_.colors)&&(_.colors=!1),N(_.customInspect)&&(_.customInspect=!0),_.colors&&(_.stylize=l),h(_,E,_.depth)}u.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function l(E,C){var _=o.styles[C];return _?"\x1B["+o.colors[_][0]+"m"+E+"\x1B["+o.colors[_][1]+"m":E}function c(E,C){return E}function a(E){var C={};return E.forEach(function(_,w){C[_]=!0}),C}function h(E,C,_){if(E.customInspect&&C&&V(C.inspect)&&C.inspect!==u.inspect&&!(C.constructor&&C.constructor.prototype===C)){var w=C.inspect(_,E);return A(w)||(w=h(E,w,_)),w}var F=f(E,C);if(F)return F;var O=Object.keys(C),D=a(O);if(E.showHidden&&(O=Object.getOwnPropertyNames(C)),B(C)&&(O.indexOf("message")>=0||O.indexOf("description")>=0))return d(C);if(O.length===0){if(V(C)){var j=C.name?": "+C.name:"";return E.stylize("[Function"+j+"]","special")}if(R(C))return E.stylize(RegExp.prototype.toString.call(C),"regexp");if(I(C))return E.stylize(Date.prototype.toString.call(C),"date");if(B(C))return d(C)}var H="",W=!1,L=["{","}"];if(y(C)&&(W=!0,L=["[","]"]),V(C)){var M=C.name?": "+C.name:"";H=" [Function"+M+"]"}if(R(C)&&(H=" "+RegExp.prototype.toString.call(C)),I(C)&&(H=" "+Date.prototype.toUTCString.call(C)),B(C)&&(H=" "+d(C)),O.length===0&&(!W||C.length==0))return L[0]+H+L[1];if(_<0)return R(C)?E.stylize(RegExp.prototype.toString.call(C),"regexp"):E.stylize("[Object]","special");E.seen.push(C);var U;return W?U=p(E,C,_,D,O):U=O.map(function(G){return v(E,C,_,D,G,W)}),E.seen.pop(),x(U,H,L)}function f(E,C){if(N(C))return E.stylize("undefined","undefined");if(A(C)){var _="'"+JSON.stringify(C).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return E.stylize(_,"string")}if(T(C))return E.stylize(""+C,"number");if(g(C))return E.stylize(""+C,"boolean");if(m(C))return E.stylize("null","null")}function d(E){return"["+Error.prototype.toString.call(E)+"]"}function p(E,C,_,w,F){for(var O=[],D=0,j=C.length;D<j;++D)Z(C,String(D))?O.push(v(E,C,_,w,String(D),!0)):O.push("");return F.forEach(function(H){H.match(/^\d+$/)||O.push(v(E,C,_,w,H,!0))}),O}function v(E,C,_,w,F,O){var D,j,H;if(H=Object.getOwnPropertyDescriptor(C,F)||{value:C[F]},H.get?H.set?j=E.stylize("[Getter/Setter]","special"):j=E.stylize("[Getter]","special"):H.set&&(j=E.stylize("[Setter]","special")),Z(w,F)||(D="["+F+"]"),j||(E.seen.indexOf(H.value)<0?(m(_)?j=h(E,H.value,null):j=h(E,H.value,_-1),j.indexOf(`
`)>-1&&(O?j=j.split(`
`).map(function(W){return"  "+W}).join(`
`).slice(2):j=`
`+j.split(`
`).map(function(W){return"   "+W}).join(`
`))):j=E.stylize("[Circular]","special")),N(D)){if(O&&F.match(/^\d+$/))return j;D=JSON.stringify(""+F),D.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(D=D.slice(1,-1),D=E.stylize(D,"name")):(D=D.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),D=E.stylize(D,"string"))}return D+": "+j}function x(E,C,_){var w=E.reduce(function(F,O){return O.indexOf(`
`)>=0,F+O.replace(/\u001b\[\d\d?m/g,"").length+1},0);return w>60?_[0]+(C===""?"":C+`
 `)+" "+E.join(`,
  `)+" "+_[1]:_[0]+C+" "+E.join(", ")+" "+_[1]}u.types=$p();function y(E){return Array.isArray(E)}u.isArray=y;function g(E){return typeof E=="boolean"}u.isBoolean=g;function m(E){return E===null}u.isNull=m;function S(E){return E==null}u.isNullOrUndefined=S;function T(E){return typeof E=="number"}u.isNumber=T;function A(E){return typeof E=="string"}u.isString=A;function b(E){return typeof E=="symbol"}u.isSymbol=b;function N(E){return E===void 0}u.isUndefined=N;function R(E){return P(E)&&te(E)==="[object RegExp]"}u.isRegExp=R,u.types.isRegExp=R;function P(E){return typeof E=="object"&&E!==null}u.isObject=P;function I(E){return P(E)&&te(E)==="[object Date]"}u.isDate=I,u.types.isDate=I;function B(E){return P(E)&&(te(E)==="[object Error]"||E instanceof Error)}u.isError=B,u.types.isNativeError=B;function V(E){return typeof E=="function"}u.isFunction=V;function ee(E){return E===null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||typeof E=="symbol"||typeof E>"u"}u.isPrimitive=ee,u.isBuffer=Vp();function te(E){return Object.prototype.toString.call(E)}function le(E){return E<10?"0"+E.toString(10):E.toString(10)}var ge=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ce(){var E=new Date,C=[le(E.getHours()),le(E.getMinutes()),le(E.getSeconds())].join(":");return[E.getDate(),ge[E.getMonth()],C].join(" ")}u.log=function(){console.log("%s - %s",ce(),u.format.apply(u,arguments))},u.inherits=Wp(),u._extend=function(E,C){if(!C||!P(C))return E;for(var _=Object.keys(C),w=_.length;w--;)E[_[w]]=C[_[w]];return E};function Z(E,C){return Object.prototype.hasOwnProperty.call(E,C)}var Y=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;u.promisify=function(C){if(typeof C!="function")throw new TypeError('The "original" argument must be of type Function');if(Y&&C[Y]){var _=C[Y];if(typeof _!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(_,Y,{value:_,enumerable:!1,writable:!1,configurable:!0}),_}function _(){for(var w,F,O=new Promise(function(H,W){w=H,F=W}),D=[],j=0;j<arguments.length;j++)D.push(arguments[j]);D.push(function(H,W){H?F(H):w(W)});try{C.apply(this,D)}catch(H){F(H)}return O}return Object.setPrototypeOf(_,Object.getPrototypeOf(C)),Y&&Object.defineProperty(_,Y,{value:_,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(_,t(C))},u.promisify.custom=Y;function Q(E,C){if(!E){var _=new Error("Promise was rejected with a falsy value");_.reason=E,E=_}return C(E)}function ie(E){if(typeof E!="function")throw new TypeError('The "original" argument must be of type Function');function C(){for(var _=[],w=0;w<arguments.length;w++)_.push(arguments[w]);var F=_.pop();if(typeof F!="function")throw new TypeError("The last argument must be of type Function");var O=this,D=function(){return F.apply(O,arguments)};E.apply(this,_).then(function(j){process.nextTick(D.bind(null,null,j))},function(j){process.nextTick(Q.bind(null,j,D))})}return Object.setPrototypeOf(C,Object.getPrototypeOf(E)),Object.defineProperties(C,t(E)),C}u.callbackify=ie}(Io)),Io}var fu;function Zf(){if(fu)return Do;fu=1;function u(g){"@babel/helpers - typeof";return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},u(g)}function e(g,m,S){return Object.defineProperty(g,"prototype",{writable:!1}),g}function t(g,m){if(!(g instanceof m))throw new TypeError("Cannot call a class as a function")}function i(g,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(m&&m.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),Object.defineProperty(g,"prototype",{writable:!1}),m&&s(g,m)}function s(g,m){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(T,A){return T.__proto__=A,T},s(g,m)}function n(g){var m=l();return function(){var T=c(g),A;if(m){var b=c(this).constructor;A=Reflect.construct(T,arguments,b)}else A=T.apply(this,arguments);return r(this,A)}}function r(g,m){if(m&&(u(m)==="object"||typeof m=="function"))return m;if(m!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o(g)}function o(g){if(g===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function c(g){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(S){return S.__proto__||Object.getPrototypeOf(S)},c(g)}var a={},h,f;function d(g,m,S){S||(S=Error);function T(b,N,R){return typeof m=="string"?m:m(b,N,R)}var A=function(b){i(R,b);var N=n(R);function R(P,I,B){var V;return t(this,R),V=N.call(this,T(P,I,B)),V.code=g,V}return e(R)}(S);a[g]=A}function p(g,m){if(Array.isArray(g)){var S=g.length;return g=g.map(function(T){return String(T)}),S>2?"one of ".concat(m," ").concat(g.slice(0,S-1).join(", "),", or ")+g[S-1]:S===2?"one of ".concat(m," ").concat(g[0]," or ").concat(g[1]):"of ".concat(m," ").concat(g[0])}else return"of ".concat(m," ").concat(String(g))}function v(g,m,S){return g.substr(0,m.length)===m}function x(g,m,S){return(S===void 0||S>g.length)&&(S=g.length),g.substring(S-m.length,S)===m}function y(g,m,S){return typeof S!="number"&&(S=0),S+m.length>g.length?!1:g.indexOf(m,S)!==-1}return d("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),d("ERR_INVALID_ARG_TYPE",function(g,m,S){h===void 0&&(h=$e()),h(typeof g=="string","'name' must be a string");var T;typeof m=="string"&&v(m,"not ")?(T="must not be",m=m.replace(/^not /,"")):T="must be";var A;if(x(g," argument"))A="The ".concat(g," ").concat(T," ").concat(p(m,"type"));else{var b=y(g,".")?"property":"argument";A='The "'.concat(g,'" ').concat(b," ").concat(T," ").concat(p(m,"type"))}return A+=". Received type ".concat(u(S)),A},TypeError),d("ERR_INVALID_ARG_VALUE",function(g,m){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";f===void 0&&(f=Xn());var T=f.inspect(m);return T.length>128&&(T="".concat(T.slice(0,128),"...")),"The argument '".concat(g,"' ").concat(S,". Received ").concat(T)},TypeError),d("ERR_INVALID_RETURN_VALUE",function(g,m,S){var T;return S&&S.constructor&&S.constructor.name?T="instance of ".concat(S.constructor.name):T="type ".concat(u(S)),"Expected ".concat(g,' to be returned from the "').concat(m,'"')+" function but got ".concat(T,".")},TypeError),d("ERR_MISSING_ARGS",function(){for(var g=arguments.length,m=new Array(g),S=0;S<g;S++)m[S]=arguments[S];h===void 0&&(h=$e()),h(m.length>0,"At least one arg needs to be specified");var T="The ",A=m.length;switch(m=m.map(function(b){return'"'.concat(b,'"')}),A){case 1:T+="".concat(m[0]," argument");break;case 2:T+="".concat(m[0]," and ").concat(m[1]," arguments");break;default:T+=m.slice(0,A-1).join(", "),T+=", and ".concat(m[A-1]," arguments");break}return"".concat(T," must be specified")},TypeError),Do.codes=a,Do}var Is,du;function Gp(){if(du)return Is;du=1;function u(Z,Y){var Q=Object.keys(Z);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(Z);Y&&(ie=ie.filter(function(E){return Object.getOwnPropertyDescriptor(Z,E).enumerable})),Q.push.apply(Q,ie)}return Q}function e(Z){for(var Y=1;Y<arguments.length;Y++){var Q=arguments[Y]!=null?arguments[Y]:{};Y%2?u(Object(Q),!0).forEach(function(ie){t(Z,ie,Q[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(Q)):u(Object(Q)).forEach(function(ie){Object.defineProperty(Z,ie,Object.getOwnPropertyDescriptor(Q,ie))})}return Z}function t(Z,Y,Q){return Y=r(Y),Y in Z?Object.defineProperty(Z,Y,{value:Q,enumerable:!0,configurable:!0,writable:!0}):Z[Y]=Q,Z}function i(Z,Y){if(!(Z instanceof Y))throw new TypeError("Cannot call a class as a function")}function s(Z,Y){for(var Q=0;Q<Y.length;Q++){var ie=Y[Q];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(Z,r(ie.key),ie)}}function n(Z,Y,Q){return Y&&s(Z.prototype,Y),Object.defineProperty(Z,"prototype",{writable:!1}),Z}function r(Z){var Y=o(Z,"string");return g(Y)==="symbol"?Y:String(Y)}function o(Z,Y){if(g(Z)!=="object"||Z===null)return Z;var Q=Z[Symbol.toPrimitive];if(Q!==void 0){var ie=Q.call(Z,Y);if(g(ie)!=="object")return ie;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Z)}function l(Z,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Super expression must either be null or a function");Z.prototype=Object.create(Y&&Y.prototype,{constructor:{value:Z,writable:!0,configurable:!0}}),Object.defineProperty(Z,"prototype",{writable:!1}),Y&&x(Z,Y)}function c(Z){var Y=p();return function(){var ie=y(Z),E;if(Y){var C=y(this).constructor;E=Reflect.construct(ie,arguments,C)}else E=ie.apply(this,arguments);return a(this,E)}}function a(Z,Y){if(Y&&(g(Y)==="object"||typeof Y=="function"))return Y;if(Y!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(Z)}function h(Z){if(Z===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Z}function f(Z){var Y=typeof Map=="function"?new Map:void 0;return f=function(ie){if(ie===null||!v(ie))return ie;if(typeof ie!="function")throw new TypeError("Super expression must either be null or a function");if(typeof Y<"u"){if(Y.has(ie))return Y.get(ie);Y.set(ie,E)}function E(){return d(ie,arguments,y(this).constructor)}return E.prototype=Object.create(ie.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x(E,ie)},f(Z)}function d(Z,Y,Q){return p()?d=Reflect.construct.bind():d=function(E,C,_){var w=[null];w.push.apply(w,C);var F=Function.bind.apply(E,w),O=new F;return _&&x(O,_.prototype),O},d.apply(null,arguments)}function p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(Z){return Function.toString.call(Z).indexOf("[native code]")!==-1}function x(Z,Y){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ie,E){return ie.__proto__=E,ie},x(Z,Y)}function y(Z){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Q){return Q.__proto__||Object.getPrototypeOf(Q)},y(Z)}function g(Z){"@babel/helpers - typeof";return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},g(Z)}var m=Xn(),S=m.inspect,T=Zf(),A=T.codes.ERR_INVALID_ARG_TYPE;function b(Z,Y,Q){return(Q===void 0||Q>Z.length)&&(Q=Z.length),Z.substring(Q-Y.length,Q)===Y}function N(Z,Y){if(Y=Math.floor(Y),Z.length==0||Y==0)return"";var Q=Z.length*Y;for(Y=Math.floor(Math.log(Y)/Math.log(2));Y;)Z+=Z,Y--;return Z+=Z.substring(0,Q-Z.length),Z}var R="",P="",I="",B="",V={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},ee=10;function te(Z){var Y=Object.keys(Z),Q=Object.create(Object.getPrototypeOf(Z));return Y.forEach(function(ie){Q[ie]=Z[ie]}),Object.defineProperty(Q,"message",{value:Z.message}),Q}function le(Z){return S(Z,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function ge(Z,Y,Q){var ie="",E="",C=0,_="",w=!1,F=le(Z),O=F.split(`
`),D=le(Y).split(`
`),j=0,H="";if(Q==="strictEqual"&&g(Z)==="object"&&g(Y)==="object"&&Z!==null&&Y!==null&&(Q="strictEqualObject"),O.length===1&&D.length===1&&O[0]!==D[0]){var W=O[0].length+D[0].length;if(W<=ee){if((g(Z)!=="object"||Z===null)&&(g(Y)!=="object"||Y===null)&&(Z!==0||Y!==0))return"".concat(V[Q],`

`)+"".concat(O[0]," !== ").concat(D[0],`
`)}else if(Q!=="strictEqualObject"){var L=process.stderr&&process.stderr.isTTY?process.stderr.columns:80;if(W<L){for(;O[0][j]===D[0][j];)j++;j>2&&(H=`
  `.concat(N(" ",j),"^"),j=0)}}}for(var M=O[O.length-1],U=D[D.length-1];M===U&&(j++<2?_=`
  `.concat(M).concat(_):ie=M,O.pop(),D.pop(),!(O.length===0||D.length===0));)M=O[O.length-1],U=D[D.length-1];var G=Math.max(O.length,D.length);if(G===0){var re=F.split(`
`);if(re.length>30)for(re[26]="".concat(R,"...").concat(B);re.length>27;)re.pop();return"".concat(V.notIdentical,`

`).concat(re.join(`
`),`
`)}j>3&&(_=`
`.concat(R,"...").concat(B).concat(_),w=!0),ie!==""&&(_=`
  `.concat(ie).concat(_),ie="");var ne=0,q=V[Q]+`
`.concat(P,"+ actual").concat(B," ").concat(I,"- expected").concat(B),X=" ".concat(R,"...").concat(B," Lines skipped");for(j=0;j<G;j++){var he=j-C;if(O.length<j+1)he>1&&j>2&&(he>4?(E+=`
`.concat(R,"...").concat(B),w=!0):he>3&&(E+=`
  `.concat(D[j-2]),ne++),E+=`
  `.concat(D[j-1]),ne++),C=j,ie+=`
`.concat(I,"-").concat(B," ").concat(D[j]),ne++;else if(D.length<j+1)he>1&&j>2&&(he>4?(E+=`
`.concat(R,"...").concat(B),w=!0):he>3&&(E+=`
  `.concat(O[j-2]),ne++),E+=`
  `.concat(O[j-1]),ne++),C=j,E+=`
`.concat(P,"+").concat(B," ").concat(O[j]),ne++;else{var Te=D[j],Ne=O[j],z=Ne!==Te&&(!b(Ne,",")||Ne.slice(0,-1)!==Te);z&&b(Te,",")&&Te.slice(0,-1)===Ne&&(z=!1,Ne+=","),z?(he>1&&j>2&&(he>4?(E+=`
`.concat(R,"...").concat(B),w=!0):he>3&&(E+=`
  `.concat(O[j-2]),ne++),E+=`
  `.concat(O[j-1]),ne++),C=j,E+=`
`.concat(P,"+").concat(B," ").concat(Ne),ie+=`
`.concat(I,"-").concat(B," ").concat(Te),ne+=2):(E+=ie,ie="",(he===1||j===0)&&(E+=`
  `.concat(Ne),ne++))}if(ne>20&&j<G-2)return"".concat(q).concat(X,`
`).concat(E,`
`).concat(R,"...").concat(B).concat(ie,`
`)+"".concat(R,"...").concat(B)}return"".concat(q).concat(w?X:"",`
`).concat(E).concat(ie).concat(_).concat(H)}var ce=function(Z,Y){l(ie,Z);var Q=c(ie);function ie(E){var C;if(i(this,ie),g(E)!=="object"||E===null)throw new A("options","Object",E);var _=E.message,w=E.operator,F=E.stackStartFn,O=E.actual,D=E.expected,j=Error.stackTraceLimit;if(Error.stackTraceLimit=0,_!=null)C=Q.call(this,String(_));else if(process.stderr&&process.stderr.isTTY&&(process.stderr&&process.stderr.getColorDepth&&process.stderr.getColorDepth()!==1?(R="\x1B[34m",P="\x1B[32m",B="\x1B[39m",I="\x1B[31m"):(R="",P="",B="",I="")),g(O)==="object"&&O!==null&&g(D)==="object"&&D!==null&&"stack"in O&&O instanceof Error&&"stack"in D&&D instanceof Error&&(O=te(O),D=te(D)),w==="deepStrictEqual"||w==="strictEqual")C=Q.call(this,ge(O,D,w));else if(w==="notDeepStrictEqual"||w==="notStrictEqual"){var H=V[w],W=le(O).split(`
`);if(w==="notStrictEqual"&&g(O)==="object"&&O!==null&&(H=V.notStrictEqualObject),W.length>30)for(W[26]="".concat(R,"...").concat(B);W.length>27;)W.pop();W.length===1?C=Q.call(this,"".concat(H," ").concat(W[0])):C=Q.call(this,"".concat(H,`

`).concat(W.join(`
`),`
`))}else{var L=le(O),M="",U=V[w];w==="notDeepEqual"||w==="notEqual"?(L="".concat(V[w],`

`).concat(L),L.length>1024&&(L="".concat(L.slice(0,1021),"..."))):(M="".concat(le(D)),L.length>512&&(L="".concat(L.slice(0,509),"...")),M.length>512&&(M="".concat(M.slice(0,509),"...")),w==="deepEqual"||w==="equal"?L="".concat(U,`

`).concat(L,`

should equal

`):M=" ".concat(w," ").concat(M)),C=Q.call(this,"".concat(L).concat(M))}return Error.stackTraceLimit=j,C.generatedMessage=!_,Object.defineProperty(h(C),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),C.code="ERR_ASSERTION",C.actual=O,C.expected=D,C.operator=w,Error.captureStackTrace&&Error.captureStackTrace(h(C),F),C.stack,C.name="AssertionError",a(C)}return n(ie,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:Y,value:function(C,_){return S(this,e(e({},_),{},{customInspect:!1,depth:0}))}}]),ie}(f(Error),S.custom);return Is=ce,Is}var Ls,pu;function ed(){if(pu)return Ls;pu=1;var u=Object.prototype.toString;return Ls=function(t){var i=u.call(t),s=i==="[object Arguments]";return s||(s=i!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&u.call(t.callee)==="[object Function]"),s},Ls}var Bs,xu;function Yp(){if(xu)return Bs;xu=1;var u;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,i=ed(),s=Object.prototype.propertyIsEnumerable,n=!s.call({toString:null},"toString"),r=s.call(function(){},"prototype"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(f){var d=f.constructor;return d&&d.prototype===f},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},a=function(){if(typeof window>"u")return!1;for(var f in window)try{if(!c["$"+f]&&e.call(window,f)&&window[f]!==null&&typeof window[f]=="object")try{l(window[f])}catch{return!0}}catch{return!0}return!1}(),h=function(f){if(typeof window>"u"||!a)return l(f);try{return l(f)}catch{return!1}};u=function(d){var p=d!==null&&typeof d=="object",v=t.call(d)==="[object Function]",x=i(d),y=p&&t.call(d)==="[object String]",g=[];if(!p&&!v&&!x)throw new TypeError("Object.keys called on a non-object");var m=r&&v;if(y&&d.length>0&&!e.call(d,0))for(var S=0;S<d.length;++S)g.push(String(S));if(x&&d.length>0)for(var T=0;T<d.length;++T)g.push(String(T));else for(var A in d)!(m&&A==="prototype")&&e.call(d,A)&&g.push(String(A));if(n)for(var b=h(d),N=0;N<o.length;++N)!(b&&o[N]==="constructor")&&e.call(d,o[N])&&g.push(o[N]);return g}}return Bs=u,Bs}var Ms,mu;function td(){if(mu)return Ms;mu=1;var u=Array.prototype.slice,e=ed(),t=Object.keys,i=t?function(r){return t(r)}:Yp(),s=Object.keys;return i.shim=function(){if(Object.keys){var r=function(){var o=Object.keys(arguments);return o&&o.length===arguments.length}(1,2);r||(Object.keys=function(l){return e(l)?s(u.call(l)):s(l)})}else Object.keys=i;return Object.keys||i},Ms=i,Ms}var ks,gu;function Xp(){if(gu)return ks;gu=1;var u=td(),e=Pl()(),t=ti(),i=Dl(),s=t("Array.prototype.push"),n=t("Object.prototype.propertyIsEnumerable"),r=e?i.getOwnPropertySymbols:null;return ks=function(l,c){if(l==null)throw new TypeError("target must be an object");var a=i(l);if(arguments.length===1)return a;for(var h=1;h<arguments.length;++h){var f=i(arguments[h]),d=u(f),p=e&&(i.getOwnPropertySymbols||r);if(p)for(var v=p(f),x=0;x<v.length;++x){var y=v[x];n(f,y)&&s(d,y)}for(var g=0;g<d.length;++g){var m=d[g];if(n(f,m)){var S=f[m];a[m]=S}}}return a},ks}var zs,yu;function Kp(){if(yu)return zs;yu=1;var u=Xp(),e=function(){if(!Object.assign)return!1;for(var i="abcdefghijklmnopqrst",s=i.split(""),n={},r=0;r<s.length;++r)n[s[r]]=s[r];var o=Object.assign({},n),l="";for(var c in o)l+=c;return i!==l},t=function(){if(!Object.assign||!Object.preventExtensions)return!1;var i=Object.preventExtensions({1:2});try{Object.assign(i,"xy")}catch{return i[1]==="y"}return!1};return zs=function(){return!Object.assign||e()||t()?u:Object.assign},zs}var js,vu;function rd(){if(vu)return js;vu=1;var u=function(e){return e!==e};return js=function(t,i){return t===0&&i===0?1/t===1/i:!!(t===i||u(t)&&u(i))},js}var qs,Su;function zl(){if(Su)return qs;Su=1;var u=rd();return qs=function(){return typeof Object.is=="function"?Object.is:u},qs}var Us,Au;function Qp(){if(Au)return Us;Au=1;var u=kl(),e=po(),t=e(u("String.prototype.indexOf"));return Us=function(s,n){var r=u(s,!!n);return typeof r=="function"&&t(s,".prototype.")>-1?e(r):r},Us}var Hs,Cu;function xo(){if(Cu)return Hs;Cu=1;var u=td(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",t=Object.prototype.toString,i=Array.prototype.concat,s=Kf(),n=function(c){return typeof c=="function"&&t.call(c)==="[object Function]"},r=Qf()(),o=function(c,a,h,f){if(a in c){if(f===!0){if(c[a]===h)return}else if(!n(f)||!f())return}r?s(c,a,h,!0):s(c,a,h)},l=function(c,a){var h=arguments.length>2?arguments[2]:{},f=u(a);e&&(f=i.call(f,Object.getOwnPropertySymbols(a)));for(var d=0;d<f.length;d+=1)o(c,f[d],a[f[d]],h[f[d]])};return l.supportsDescriptors=!!r,Hs=l,Hs}var $s,Eu;function Jp(){if(Eu)return $s;Eu=1;var u=zl(),e=xo();return $s=function(){var i=u();return e(Object,{is:i},{is:function(){return Object.is!==i}}),i},$s}var Vs,_u;function Zp(){if(_u)return Vs;_u=1;var u=xo(),e=po(),t=rd(),i=zl(),s=Jp(),n=e(i(),Object);return u(n,{getPolyfill:i,implementation:t,shim:s}),Vs=n,Vs}var Ws,Tu;function nd(){return Tu||(Tu=1,Ws=function(e){return e!==e}),Ws}var Gs,bu;function id(){if(bu)return Gs;bu=1;var u=nd();return Gs=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:u},Gs}var Ys,Nu;function e0(){if(Nu)return Ys;Nu=1;var u=xo(),e=id();return Ys=function(){var i=e();return u(Number,{isNaN:i},{isNaN:function(){return Number.isNaN!==i}}),i},Ys}var Xs,Ru;function t0(){if(Ru)return Xs;Ru=1;var u=po(),e=xo(),t=nd(),i=id(),s=e0(),n=u(i(),Number);return e(n,{getPolyfill:i,implementation:t,shim:s}),Xs=n,Xs}var Ks,wu;function r0(){if(wu)return Ks;wu=1;function u(z,$){return n(z)||s(z,$)||t(z,$)||e()}function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t(z,$){if(z){if(typeof z=="string")return i(z,$);var ae=Object.prototype.toString.call(z).slice(8,-1);if(ae==="Object"&&z.constructor&&(ae=z.constructor.name),ae==="Map"||ae==="Set")return Array.from(z);if(ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ae))return i(z,$)}}function i(z,$){($==null||$>z.length)&&($=z.length);for(var ae=0,de=new Array($);ae<$;ae++)de[ae]=z[ae];return de}function s(z,$){var ae=z==null?null:typeof Symbol<"u"&&z[Symbol.iterator]||z["@@iterator"];if(ae!=null){var de,pe,_e,Se,Re=[],we=!0,ze=!1;try{if(_e=(ae=ae.call(z)).next,$!==0)for(;!(we=(de=_e.call(ae)).done)&&(Re.push(de.value),Re.length!==$);we=!0);}catch(K){ze=!0,pe=K}finally{try{if(!we&&ae.return!=null&&(Se=ae.return(),Object(Se)!==Se))return}finally{if(ze)throw pe}}return Re}}function n(z){if(Array.isArray(z))return z}function r(z){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},r(z)}var o=/a/g.flags!==void 0,l=function($){var ae=[];return $.forEach(function(de){return ae.push(de)}),ae},c=function($){var ae=[];return $.forEach(function(de,pe){return ae.push([pe,de])}),ae},a=Object.is?Object.is:Zp(),h=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},f=Number.isNaN?Number.isNaN:t0();function d(z){return z.call.bind(z)}var p=d(Object.prototype.hasOwnProperty),v=d(Object.prototype.propertyIsEnumerable),x=d(Object.prototype.toString),y=Xn().types,g=y.isAnyArrayBuffer,m=y.isArrayBufferView,S=y.isDate,T=y.isMap,A=y.isRegExp,b=y.isSet,N=y.isNativeError,R=y.isBoxedPrimitive,P=y.isNumberObject,I=y.isStringObject,B=y.isBooleanObject,V=y.isBigIntObject,ee=y.isSymbolObject,te=y.isFloat32Array,le=y.isFloat64Array;function ge(z){if(z.length===0||z.length>10)return!0;for(var $=0;$<z.length;$++){var ae=z.charCodeAt($);if(ae<48||ae>57)return!0}return z.length===10&&z>=Math.pow(2,32)}function ce(z){return Object.keys(z).filter(ge).concat(h(z).filter(Object.prototype.propertyIsEnumerable.bind(z)))}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function Z(z,$){if(z===$)return 0;for(var ae=z.length,de=$.length,pe=0,_e=Math.min(ae,de);pe<_e;++pe)if(z[pe]!==$[pe]){ae=z[pe],de=$[pe];break}return ae<de?-1:de<ae?1:0}var Y=!0,Q=!1,ie=0,E=1,C=2,_=3;function w(z,$){return o?z.source===$.source&&z.flags===$.flags:RegExp.prototype.toString.call(z)===RegExp.prototype.toString.call($)}function F(z,$){if(z.byteLength!==$.byteLength)return!1;for(var ae=0;ae<z.byteLength;ae++)if(z[ae]!==$[ae])return!1;return!0}function O(z,$){return z.byteLength!==$.byteLength?!1:Z(new Uint8Array(z.buffer,z.byteOffset,z.byteLength),new Uint8Array($.buffer,$.byteOffset,$.byteLength))===0}function D(z,$){return z.byteLength===$.byteLength&&Z(new Uint8Array(z),new Uint8Array($))===0}function j(z,$){return P(z)?P($)&&a(Number.prototype.valueOf.call(z),Number.prototype.valueOf.call($)):I(z)?I($)&&String.prototype.valueOf.call(z)===String.prototype.valueOf.call($):B(z)?B($)&&Boolean.prototype.valueOf.call(z)===Boolean.prototype.valueOf.call($):V(z)?V($)&&BigInt.prototype.valueOf.call(z)===BigInt.prototype.valueOf.call($):ee($)&&Symbol.prototype.valueOf.call(z)===Symbol.prototype.valueOf.call($)}function H(z,$,ae,de){if(z===$)return z!==0?!0:ae?a(z,$):!0;if(ae){if(r(z)!=="object")return typeof z=="number"&&f(z)&&f($);if(r($)!=="object"||z===null||$===null||Object.getPrototypeOf(z)!==Object.getPrototypeOf($))return!1}else{if(z===null||r(z)!=="object")return $===null||r($)!=="object"?z==$:!1;if($===null||r($)!=="object")return!1}var pe=x(z),_e=x($);if(pe!==_e)return!1;if(Array.isArray(z)){if(z.length!==$.length)return!1;var Se=ce(z),Re=ce($);return Se.length!==Re.length?!1:L(z,$,ae,de,E,Se)}if(pe==="[object Object]"&&(!T(z)&&T($)||!b(z)&&b($)))return!1;if(S(z)){if(!S($)||Date.prototype.getTime.call(z)!==Date.prototype.getTime.call($))return!1}else if(A(z)){if(!A($)||!w(z,$))return!1}else if(N(z)||z instanceof Error){if(z.message!==$.message||z.name!==$.name)return!1}else if(m(z)){if(!ae&&(te(z)||le(z))){if(!F(z,$))return!1}else if(!O(z,$))return!1;var we=ce(z),ze=ce($);return we.length!==ze.length?!1:L(z,$,ae,de,ie,we)}else{if(b(z))return!b($)||z.size!==$.size?!1:L(z,$,ae,de,C);if(T(z))return!T($)||z.size!==$.size?!1:L(z,$,ae,de,_);if(g(z)){if(!D(z,$))return!1}else if(R(z)&&!j(z,$))return!1}return L(z,$,ae,de,ie)}function W(z,$){return $.filter(function(ae){return v(z,ae)})}function L(z,$,ae,de,pe,_e){if(arguments.length===5){_e=Object.keys(z);var Se=Object.keys($);if(_e.length!==Se.length)return!1}for(var Re=0;Re<_e.length;Re++)if(!p($,_e[Re]))return!1;if(ae&&arguments.length===5){var we=h(z);if(we.length!==0){var ze=0;for(Re=0;Re<we.length;Re++){var K=we[Re];if(v(z,K)){if(!v($,K))return!1;_e.push(K),ze++}else if(v($,K))return!1}var me=h($);if(we.length!==me.length&&W($,me).length!==ze)return!1}else{var ye=h($);if(ye.length!==0&&W($,ye).length!==0)return!1}}if(_e.length===0&&(pe===ie||pe===E&&z.length===0||z.size===0))return!0;if(de===void 0)de={val1:new Map,val2:new Map,position:0};else{var Ce=de.val1.get(z);if(Ce!==void 0){var Pe=de.val2.get($);if(Pe!==void 0)return Ce===Pe}de.position++}de.val1.set(z,de.position),de.val2.set($,de.position);var Ve=he(z,$,ae,_e,de,pe);return de.val1.delete(z),de.val2.delete($),Ve}function M(z,$,ae,de){for(var pe=l(z),_e=0;_e<pe.length;_e++){var Se=pe[_e];if(H($,Se,ae,de))return z.delete(Se),!0}return!1}function U(z){switch(r(z)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":z=+z;case"number":if(f(z))return!1}return!0}function G(z,$,ae){var de=U(ae);return de??($.has(de)&&!z.has(de))}function re(z,$,ae,de,pe){var _e=U(ae);if(_e!=null)return _e;var Se=$.get(_e);return Se===void 0&&!$.has(_e)||!H(de,Se,!1,pe)?!1:!z.has(_e)&&H(de,Se,!1,pe)}function ne(z,$,ae,de){for(var pe=null,_e=l(z),Se=0;Se<_e.length;Se++){var Re=_e[Se];if(r(Re)==="object"&&Re!==null)pe===null&&(pe=new Set),pe.add(Re);else if(!$.has(Re)){if(ae||!G(z,$,Re))return!1;pe===null&&(pe=new Set),pe.add(Re)}}if(pe!==null){for(var we=l($),ze=0;ze<we.length;ze++){var K=we[ze];if(r(K)==="object"&&K!==null){if(!M(pe,K,ae,de))return!1}else if(!ae&&!z.has(K)&&!M(pe,K,ae,de))return!1}return pe.size===0}return!0}function q(z,$,ae,de,pe,_e){for(var Se=l(z),Re=0;Re<Se.length;Re++){var we=Se[Re];if(H(ae,we,pe,_e)&&H(de,$.get(we),pe,_e))return z.delete(we),!0}return!1}function X(z,$,ae,de){for(var pe=null,_e=c(z),Se=0;Se<_e.length;Se++){var Re=u(_e[Se],2),we=Re[0],ze=Re[1];if(r(we)==="object"&&we!==null)pe===null&&(pe=new Set),pe.add(we);else{var K=$.get(we);if(K===void 0&&!$.has(we)||!H(ze,K,ae,de)){if(ae||!re(z,$,we,ze,de))return!1;pe===null&&(pe=new Set),pe.add(we)}}}if(pe!==null){for(var me=c($),ye=0;ye<me.length;ye++){var Ce=u(me[ye],2),Pe=Ce[0],Ve=Ce[1];if(r(Pe)==="object"&&Pe!==null){if(!q(pe,z,Pe,Ve,ae,de))return!1}else if(!ae&&(!z.has(Pe)||!H(z.get(Pe),Ve,!1,de))&&!q(pe,z,Pe,Ve,!1,de))return!1}return pe.size===0}return!0}function he(z,$,ae,de,pe,_e){var Se=0;if(_e===C){if(!ne(z,$,ae,pe))return!1}else if(_e===_){if(!X(z,$,ae,pe))return!1}else if(_e===E)for(;Se<z.length;Se++)if(p(z,Se)){if(!p($,Se)||!H(z[Se],$[Se],ae,pe))return!1}else{if(p($,Se))return!1;for(var Re=Object.keys(z);Se<Re.length;Se++){var we=Re[Se];if(!p($,we)||!H(z[we],$[we],ae,pe))return!1}return Re.length===Object.keys($).length}for(Se=0;Se<de.length;Se++){var ze=de[Se];if(!H(z[ze],$[ze],ae,pe))return!1}return!0}function Te(z,$){return H(z,$,Q)}function Ne(z,$){return H(z,$,Y)}return Ks={isDeepEqual:Te,isDeepStrictEqual:Ne},Ks}var Ou;function $e(){if(Ou)return Po.exports;Ou=1;function u(C){"@babel/helpers - typeof";return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},u(C)}function e(C,_,w){return Object.defineProperty(C,"prototype",{writable:!1}),C}function t(C,_){if(!(C instanceof _))throw new TypeError("Cannot call a class as a function")}var i=Zf(),s=i.codes,n=s.ERR_AMBIGUOUS_ARGUMENT,r=s.ERR_INVALID_ARG_TYPE,o=s.ERR_INVALID_ARG_VALUE,l=s.ERR_INVALID_RETURN_VALUE,c=s.ERR_MISSING_ARGS,a=Gp(),h=Xn(),f=h.inspect,d=Xn().types,p=d.isPromise,v=d.isRegExp,x=Kp()(),y=zl()(),g=Qp()("RegExp.prototype.test"),m,S;function T(){var C=r0();m=C.isDeepEqual,S=C.isDeepStrictEqual}var A=!1,b=Po.exports=B,N={};function R(C){throw C.message instanceof Error?C.message:new a(C)}function P(C,_,w,F,O){var D=arguments.length,j;if(D===0)j="Failed";else if(D===1)w=C,C=void 0;else{if(A===!1){A=!0;var H=process.emitWarning?process.emitWarning:console.warn.bind(console);H("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}D===2&&(F="!=")}if(w instanceof Error)throw w;var W={actual:C,expected:_,operator:F===void 0?"fail":F,stackStartFn:O||P};w!==void 0&&(W.message=w);var L=new a(W);throw j&&(L.message=j,L.generatedMessage=!0),L}b.fail=P,b.AssertionError=a;function I(C,_,w,F){if(!w){var O=!1;if(_===0)O=!0,F="No value argument passed to `assert.ok()`";else if(F instanceof Error)throw F;var D=new a({actual:w,expected:!0,message:F,operator:"==",stackStartFn:C});throw D.generatedMessage=O,D}}function B(){for(var C=arguments.length,_=new Array(C),w=0;w<C;w++)_[w]=arguments[w];I.apply(void 0,[B,_.length].concat(_))}b.ok=B,b.equal=function C(_,w,F){if(arguments.length<2)throw new c("actual","expected");_!=w&&R({actual:_,expected:w,message:F,operator:"==",stackStartFn:C})},b.notEqual=function C(_,w,F){if(arguments.length<2)throw new c("actual","expected");_==w&&R({actual:_,expected:w,message:F,operator:"!=",stackStartFn:C})},b.deepEqual=function C(_,w,F){if(arguments.length<2)throw new c("actual","expected");m===void 0&&T(),m(_,w)||R({actual:_,expected:w,message:F,operator:"deepEqual",stackStartFn:C})},b.notDeepEqual=function C(_,w,F){if(arguments.length<2)throw new c("actual","expected");m===void 0&&T(),m(_,w)&&R({actual:_,expected:w,message:F,operator:"notDeepEqual",stackStartFn:C})},b.deepStrictEqual=function C(_,w,F){if(arguments.length<2)throw new c("actual","expected");m===void 0&&T(),S(_,w)||R({actual:_,expected:w,message:F,operator:"deepStrictEqual",stackStartFn:C})},b.notDeepStrictEqual=V;function V(C,_,w){if(arguments.length<2)throw new c("actual","expected");m===void 0&&T(),S(C,_)&&R({actual:C,expected:_,message:w,operator:"notDeepStrictEqual",stackStartFn:V})}b.strictEqual=function C(_,w,F){if(arguments.length<2)throw new c("actual","expected");y(_,w)||R({actual:_,expected:w,message:F,operator:"strictEqual",stackStartFn:C})},b.notStrictEqual=function C(_,w,F){if(arguments.length<2)throw new c("actual","expected");y(_,w)&&R({actual:_,expected:w,message:F,operator:"notStrictEqual",stackStartFn:C})};var ee=e(function C(_,w,F){var O=this;t(this,C),w.forEach(function(D){D in _&&(F!==void 0&&typeof F[D]=="string"&&v(_[D])&&g(_[D],F[D])?O[D]=F[D]:O[D]=_[D])})});function te(C,_,w,F,O,D){if(!(w in C)||!S(C[w],_[w])){if(!F){var j=new ee(C,O),H=new ee(_,O,C),W=new a({actual:j,expected:H,operator:"deepStrictEqual",stackStartFn:D});throw W.actual=C,W.expected=_,W.operator=D.name,W}R({actual:C,expected:_,message:F,operator:D.name,stackStartFn:D})}}function le(C,_,w,F){if(typeof _!="function"){if(v(_))return g(_,C);if(arguments.length===2)throw new r("expected",["Function","RegExp"],_);if(u(C)!=="object"||C===null){var O=new a({actual:C,expected:_,message:w,operator:"deepStrictEqual",stackStartFn:F});throw O.operator=F.name,O}var D=Object.keys(_);if(_ instanceof Error)D.push("name","message");else if(D.length===0)throw new o("error",_,"may not be an empty object");return m===void 0&&T(),D.forEach(function(j){typeof C[j]=="string"&&v(_[j])&&g(_[j],C[j])||te(C,_,j,w,D,F)}),!0}return _.prototype!==void 0&&C instanceof _?!0:Error.isPrototypeOf(_)?!1:_.call({},C)===!0}function ge(C){if(typeof C!="function")throw new r("fn","Function",C);try{C()}catch(_){return _}return N}function ce(C){return p(C)||C!==null&&u(C)==="object"&&typeof C.then=="function"&&typeof C.catch=="function"}function Z(C){return Promise.resolve().then(function(){var _;if(typeof C=="function"){if(_=C(),!ce(_))throw new l("instance of Promise","promiseFn",_)}else if(ce(C))_=C;else throw new r("promiseFn",["Function","Promise"],C);return Promise.resolve().then(function(){return _}).then(function(){return N}).catch(function(w){return w})})}function Y(C,_,w,F){if(typeof w=="string"){if(arguments.length===4)throw new r("error",["Object","Error","Function","RegExp"],w);if(u(_)==="object"&&_!==null){if(_.message===w)throw new n("error/message",'The error message "'.concat(_.message,'" is identical to the message.'))}else if(_===w)throw new n("error/message",'The error "'.concat(_,'" is identical to the message.'));F=w,w=void 0}else if(w!=null&&u(w)!=="object"&&typeof w!="function")throw new r("error",["Object","Error","Function","RegExp"],w);if(_===N){var O="";w&&w.name&&(O+=" (".concat(w.name,")")),O+=F?": ".concat(F):".";var D=C.name==="rejects"?"rejection":"exception";R({actual:void 0,expected:w,operator:C.name,message:"Missing expected ".concat(D).concat(O),stackStartFn:C})}if(w&&!le(_,w,F,C))throw _}function Q(C,_,w,F){if(_!==N){if(typeof w=="string"&&(F=w,w=void 0),!w||le(_,w)){var O=F?": ".concat(F):".",D=C.name==="doesNotReject"?"rejection":"exception";R({actual:_,expected:w,operator:C.name,message:"Got unwanted ".concat(D).concat(O,`
`)+'Actual message: "'.concat(_&&_.message,'"'),stackStartFn:C})}throw _}}b.throws=function C(_){for(var w=arguments.length,F=new Array(w>1?w-1:0),O=1;O<w;O++)F[O-1]=arguments[O];Y.apply(void 0,[C,ge(_)].concat(F))},b.rejects=function C(_){for(var w=arguments.length,F=new Array(w>1?w-1:0),O=1;O<w;O++)F[O-1]=arguments[O];return Z(_).then(function(D){return Y.apply(void 0,[C,D].concat(F))})},b.doesNotThrow=function C(_){for(var w=arguments.length,F=new Array(w>1?w-1:0),O=1;O<w;O++)F[O-1]=arguments[O];Q.apply(void 0,[C,ge(_)].concat(F))},b.doesNotReject=function C(_){for(var w=arguments.length,F=new Array(w>1?w-1:0),O=1;O<w;O++)F[O-1]=arguments[O];return Z(_).then(function(D){return Q.apply(void 0,[C,D].concat(F))})},b.ifError=function C(_){if(_!=null){var w="ifError got unwanted exception: ";u(_)==="object"&&typeof _.message=="string"?_.message.length===0&&_.constructor?w+=_.constructor.name:w+=_.message:w+=f(_);var F=new a({actual:_,expected:null,operator:"ifError",message:w,stackStartFn:C}),O=_.stack;if(typeof O=="string"){var D=O.split(`
`);D.shift();for(var j=F.stack.split(`
`),H=0;H<D.length;H++){var W=j.indexOf(D[H]);if(W!==-1){j=j.slice(0,W);break}}F.stack="".concat(j.join(`
`),`
`).concat(D.join(`
`))}throw F}};function ie(C,_,w,F,O){if(!v(_))throw new r("regexp","RegExp",_);var D=O==="match";if(typeof C!="string"||g(_,C)!==D){if(w instanceof Error)throw w;var j=!w;w=w||(typeof C!="string"?'The "string" argument must be of type string. Received type '+"".concat(u(C)," (").concat(f(C),")"):(D?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(f(_),`. Input:

`).concat(f(C),`
`));var H=new a({actual:C,expected:_,message:w,operator:O,stackStartFn:F});throw H.generatedMessage=j,H}}b.match=function C(_,w,F){ie(_,w,F,C,"match")},b.doesNotMatch=function C(_,w,F){ie(_,w,F,C,"doesNotMatch")};function E(){for(var C=arguments.length,_=new Array(C),w=0;w<C;w++)_[w]=arguments[w];I.apply(void 0,[E,_.length].concat(_))}return b.strict=x(E,b,{equal:b.strictEqual,deepEqual:b.deepStrictEqual,notEqual:b.notStrictEqual,notDeepEqual:b.notDeepStrictEqual}),b.strict.strict=b.strict,Po.exports}var tt={},Fu;function J(){if(Fu)return tt;Fu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(tt,"__esModule",{value:!0}),tt.SuppressWarnings=tt.Override=tt.Nullable=tt.NotNull=void 0;function u(s,n,r){}tt.NotNull=u;function e(s,n,r){}tt.Nullable=e;function t(s,n,r){}tt.Override=t;function i(s){return(n,r,o)=>{}}return tt.SuppressWarnings=i,tt}var Qs={},Pu;function Tr(){return Pu||(Pu=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(u,"__esModule",{value:!0}),u.IntStream=void 0,function(e){e.EOF=-1,e.UNKNOWN_SOURCE_NAME="<unknown>"}(u.IntStream||(u.IntStream={}))}(Qs)),Qs}var Du;function n0(){if(Du)return Ir;Du=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Ir&&Ir.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.ANTLRInputStream=void 0;const e=$e(),t=J(),i=Tr();let s=class{constructor(r){this.p=0,this.data=r,this.n=r.length}reset(){this.p=0}consume(){if(this.p>=this.n)throw e(this.LA(1)===i.IntStream.EOF),new Error("cannot consume EOF");this.p<this.n&&this.p++}LA(r){return r===0?0:r<0&&(r++,this.p+r-1<0)||this.p+r-1>=this.n?i.IntStream.EOF:this.data.charCodeAt(this.p+r-1)}LT(r){return this.LA(r)}get index(){return this.p}get size(){return this.n}mark(){return-1}release(r){}seek(r){if(r<=this.p){this.p=r;return}for(r=Math.min(r,this.n);this.p<r;)this.consume()}getText(r){let o=r.a,l=r.b;l>=this.n&&(l=this.n-1);let c=l-o+1;return o>=this.n?"":this.data.substr(o,c)}get sourceName(){return this.name?this.name:i.IntStream.UNKNOWN_SOURCE_NAME}toString(){return this.data}};return u([t.Override],s.prototype,"consume",null),u([t.Override],s.prototype,"LA",null),u([t.Override],s.prototype,"index",null),u([t.Override],s.prototype,"size",null),u([t.Override],s.prototype,"mark",null),u([t.Override],s.prototype,"release",null),u([t.Override],s.prototype,"seek",null),u([t.Override],s.prototype,"getText",null),u([t.Override],s.prototype,"sourceName",null),u([t.Override],s.prototype,"toString",null),Ir.ANTLRInputStream=s,Ir}var Lr={},ht={},li={},Iu;function pr(){return Iu||(Iu=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=li&&li.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c};Object.defineProperty(u,"__esModule",{value:!0}),u.ATNState=void 0;const t=J();let i=class gl{constructor(){this.stateNumber=gl.INVALID_STATE_NUMBER,this.ruleIndex=0,this.epsilonOnlyTransitions=!1,this.transitions=[],this.optimizedTransitions=this.transitions}getStateNumber(){return this.stateNumber}get nonStopStateNumber(){return this.getStateNumber()}hashCode(){return this.stateNumber}equals(n){return n instanceof gl?this.stateNumber===n.stateNumber:!1}get isNonGreedyExitState(){return!1}toString(){return String(this.stateNumber)}getTransitions(){return this.transitions.slice(0)}get numberOfTransitions(){return this.transitions.length}addTransition(n,r){if(this.transitions.length===0)this.epsilonOnlyTransitions=n.isEpsilon;else if(this.epsilonOnlyTransitions!==n.isEpsilon)throw this.epsilonOnlyTransitions=!1,new Error("ATN state "+this.stateNumber+" has both epsilon and non-epsilon transitions.");this.transitions.splice(r!==void 0?r:this.transitions.length,0,n)}transition(n){return this.transitions[n]}setTransition(n,r){this.transitions[n]=r}removeTransition(n){return this.transitions.splice(n,1)[0]}get onlyHasEpsilonTransitions(){return this.epsilonOnlyTransitions}setRuleIndex(n){this.ruleIndex=n}get isOptimized(){return this.optimizedTransitions!==this.transitions}get numberOfOptimizedTransitions(){return this.optimizedTransitions.length}getOptimizedTransition(n){return this.optimizedTransitions[n]}addOptimizedTransition(n){this.isOptimized||(this.optimizedTransitions=new Array),this.optimizedTransitions.push(n)}setOptimizedTransition(n,r){if(!this.isOptimized)throw new Error("This ATNState is not optimized.");this.optimizedTransitions[n]=r}removeOptimizedTransition(n){if(!this.isOptimized)throw new Error("This ATNState is not optimized.");this.optimizedTransitions.splice(n,1)}};e([t.Override],i.prototype,"hashCode",null),e([t.Override],i.prototype,"equals",null),e([t.Override],i.prototype,"toString",null),u.ATNState=i,function(s){s.INVALID_STATE_NUMBER=-1}(i=u.ATNState||(u.ATNState={}))}(li)),li}var Js={},Lu;function Ue(){return Lu||(Lu=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(u,"__esModule",{value:!0}),u.ATNStateType=void 0,function(e){e[e.INVALID_TYPE=0]="INVALID_TYPE",e[e.BASIC=1]="BASIC",e[e.RULE_START=2]="RULE_START",e[e.BLOCK_START=3]="BLOCK_START",e[e.PLUS_BLOCK_START=4]="PLUS_BLOCK_START",e[e.STAR_BLOCK_START=5]="STAR_BLOCK_START",e[e.TOKEN_START=6]="TOKEN_START",e[e.RULE_STOP=7]="RULE_STOP",e[e.BLOCK_END=8]="BLOCK_END",e[e.STAR_LOOP_BACK=9]="STAR_LOOP_BACK",e[e.STAR_LOOP_ENTRY=10]="STAR_LOOP_ENTRY",e[e.PLUS_LOOP_BACK=11]="PLUS_LOOP_BACK",e[e.LOOP_END=12]="LOOP_END"}(u.ATNStateType||(u.ATNStateType={}))}(Js)),Js}var ft={},ai={},Bu;function br(){if(Bu)return ai;Bu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(ai,"__esModule",{value:!0}),ai.RecognitionException=void 0;let u=class extends Error{constructor(t,i,s,n){super(n),this._offendingState=-1,this._recognizer=t,this.input=i,this.ctx=s,t&&(this._offendingState=t.state)}get offendingState(){return this._offendingState}setOffendingState(t){this._offendingState=t}get expectedTokens(){if(this._recognizer)return this._recognizer.atn.getExpectedTokens(this._offendingState,this.ctx)}get context(){return this.ctx}get inputStream(){return this.input}getOffendingToken(t){if(!(t&&t!==this._recognizer))return this.offendingToken}setOffendingToken(t,i){t===this._recognizer&&(this.offendingToken=i)}get recognizer(){return this._recognizer}};return ai.RecognitionException=u,ai}var dt={},ui={},pt={},Mu;function Nr(){if(Mu)return pt;Mu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=pt&&pt.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c},e=pt&&pt.__param||function(s,n){return function(r,o){n(r,o,s)}};Object.defineProperty(pt,"__esModule",{value:!0}),pt.Transition=void 0;const t=J();let i=class{constructor(n){if(n==null)throw new Error("target cannot be null.");this.target=n}get isEpsilon(){return!1}get label(){}};return i.serializationNames=["INVALID","EPSILON","RANGE","RULE","PREDICATE","ATOM","ACTION","SET","NOT_SET","WILDCARD","PRECEDENCE"],u([t.NotNull],i.prototype,"target",void 0),i=u([e(0,t.NotNull)],i),pt.Transition=i,pt}var ku;function jl(){if(ku)return ui;ku=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(ui,"__esModule",{value:!0}),ui.AbstractPredicateTransition=void 0;const u=Nr();let e=class extends u.Transition{constructor(i){super(i)}};return ui.AbstractPredicateTransition=e,ui}var Br={},xt={},Mr={},Zs={},zu;function je(){return zu||(zu=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(u,"__esModule",{value:!0}),u.MurmurHash=void 0,function(e){function i(l=0){return l}e.initialize=i;function s(l,c){c==null?c=0:typeof c=="string"?c=o(c):typeof c=="object"&&(c=c.hashCode());let x=c;return x=Math.imul(x,3432918353),x=x<<15|x>>>17,x=Math.imul(x,461845907),l=l^x,l=l<<13|l>>>19,l=Math.imul(l,5)+3864292196,l&4294967295}e.update=s;function n(l,c){return l=l^c*4,l=l^l>>>16,l=Math.imul(l,2246822507),l=l^l>>>13,l=Math.imul(l,3266489909),l=l^l>>>16,l}e.finish=n;function r(l,c=0){let a=i(c),h=0;for(let f of l)a=s(a,f),h++;return a=n(a,h),a}e.hashCode=r;function o(l){let c=l.length;if(c===0)return 0;let a=0;for(let h=0;h<c;h++){let f=l.charCodeAt(h);a=(a<<5>>>0)-a+f,a|=0}return a}}(u.MurmurHash||(u.MurmurHash={}))}(Zs)),Zs}var kr={},ju;function ut(){if(ju)return kr;ju=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=kr&&kr.__decorate||function(i,s,n,r){var o=arguments.length,l=o<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,n):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(i,s,n,r);else for(var a=i.length-1;a>=0;a--)(c=i[a])&&(l=(o<3?c(l):o>3?c(s,n,l):c(s,n))||l);return o>3&&l&&Object.defineProperty(s,n,l),l};Object.defineProperty(kr,"__esModule",{value:!0}),kr.ObjectEqualityComparator=void 0;const e=J();let t=class{hashCode(s){return s==null?0:s.hashCode()}equals(s,n){return s==null?n==null:s.equals(n)}};return t.INSTANCE=new t,u([e.Override],t.prototype,"hashCode",null),u([e.Override],t.prototype,"equals",null),kr.ObjectEqualityComparator=t,kr}var qu;function i0(){if(qu)return Mr;qu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Mr&&Mr.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.DefaultEqualityComparator=void 0;const e=J(),t=je(),i=ut();let s=class{hashCode(r){return r==null?0:typeof r=="string"||typeof r=="number"?t.MurmurHash.hashCode([r]):i.ObjectEqualityComparator.INSTANCE.hashCode(r)}equals(r,o){return r==null?o==null:typeof r=="string"||typeof r=="number"?r===o:i.ObjectEqualityComparator.INSTANCE.equals(r,o)}};return s.INSTANCE=new s,u([e.Override],s.prototype,"hashCode",null),u([e.Override],s.prototype,"equals",null),Mr.DefaultEqualityComparator=s,Mr}var Uu;function Rr(){if(Uu)return xt;Uu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=xt&&xt.__decorate||function(c,a,h,f){var d=arguments.length,p=d<3?a:f===null?f=Object.getOwnPropertyDescriptor(a,h):f,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,a,h,f);else for(var x=c.length-1;x>=0;x--)(v=c[x])&&(p=(d<3?v(p):d>3?v(a,h,p):v(a,h))||p);return d>3&&p&&Object.defineProperty(a,h,p),p},e=xt&&xt.__param||function(c,a){return function(h,f){a(h,f,c)}};Object.defineProperty(xt,"__esModule",{value:!0}),xt.Array2DHashSet=void 0;const t=$e(),i=i0(),s=J(),n=je(),r=16,o=.75;let l=class ro{constructor(a,h=r){if(this.n=0,this.threshold=Math.floor(r*o),a instanceof ro){this.comparator=a.comparator,this.buckets=a.buckets.slice(0);for(let f=0;f<this.buckets.length;f++){let d=this.buckets[f];d&&(this.buckets[f]=d.slice(0))}this.n=a.n,this.threshold=a.threshold}else this.comparator=a||i.DefaultEqualityComparator.INSTANCE,this.buckets=this.createBuckets(h)}getOrAdd(a){return this.n>this.threshold&&this.expand(),this.getOrAddImpl(a)}getOrAddImpl(a){let h=this.getBucket(a),f=this.buckets[h];if(!f)return f=[a],this.buckets[h]=f,this.n++,a;for(let d of f)if(this.comparator.equals(d,a))return d;return f.push(a),this.n++,a}get(a){if(a==null)return a;let h=this.getBucket(a),f=this.buckets[h];if(f){for(let d of f)if(this.comparator.equals(d,a))return d}}getBucket(a){return this.comparator.hashCode(a)&this.buckets.length-1}hashCode(){let a=n.MurmurHash.initialize();for(let h of this.buckets)if(h!=null)for(let f of h){if(f==null)break;a=n.MurmurHash.update(a,this.comparator.hashCode(f))}return a=n.MurmurHash.finish(a,this.size),a}equals(a){return a===this?!0:!(a instanceof ro)||a.size!==this.size?!1:this.containsAll(a)}expand(){let a=this.buckets,h=this.buckets.length*2,f=this.createBuckets(h);this.buckets=f,this.threshold=Math.floor(h*o);let d=this.size;for(let p of a)if(p)for(let v of p){let x=this.getBucket(v),y=this.buckets[x];y||(y=[],this.buckets[x]=y),y.push(v)}t(this.n===d)}add(a){return this.getOrAdd(a)===a}get size(){return this.n}get isEmpty(){return this.n===0}contains(a){return this.containsFast(this.asElementType(a))}containsFast(a){return a==null?!1:this.get(a)!=null}*[Symbol.iterator](){yield*this.toArray()}toArray(){const a=new Array(this.size);let h=0;for(let f of this.buckets)if(f!=null)for(let d of f){if(d==null)break;a[h++]=d}return a}containsAll(a){if(a instanceof ro){let h=a;for(let f of h.buckets)if(f!=null)for(let d of f){if(d==null)break;if(!this.containsFast(this.asElementType(d)))return!1}}else for(let h of a)if(!this.containsFast(this.asElementType(h)))return!1;return!0}addAll(a){let h=!1;for(let f of a)this.getOrAdd(f)!==f&&(h=!0);return h}clear(){this.buckets=this.createBuckets(r),this.n=0,this.threshold=Math.floor(r*o)}toString(){if(this.size===0)return"{}";let a="{",h=!0;for(let f of this.buckets)if(f!=null)for(let d of f){if(d==null)break;h?h=!1:a+=", ",a+=d.toString()}return a+="}",a}toTableString(){let a="";for(let h of this.buckets){if(h==null){a+=`null
`;continue}a+="[";let f=!0;for(let d of h)f?f=!1:a+=" ",d==null?a+="_":a+=d.toString();a+=`]
`}return a}asElementType(a){return a}createBuckets(a){return new Array(a)}};return u([s.NotNull],l.prototype,"comparator",void 0),u([s.Override],l.prototype,"hashCode",null),u([s.Override],l.prototype,"equals",null),u([s.Override],l.prototype,"add",null),u([s.Override],l.prototype,"size",null),u([s.Override],l.prototype,"isEmpty",null),u([s.Override],l.prototype,"contains",null),u([e(0,s.Nullable)],l.prototype,"containsFast",null),u([s.Override],l.prototype,Symbol.iterator,null),u([s.Override],l.prototype,"toArray",null),u([s.Override],l.prototype,"containsAll",null),u([s.Override],l.prototype,"addAll",null),u([s.Override],l.prototype,"clear",null),u([s.Override],l.prototype,"toString",null),u([s.SuppressWarnings("unchecked")],l.prototype,"asElementType",null),u([s.SuppressWarnings("unchecked")],l.prototype,"createBuckets",null),xt.Array2DHashSet=l,xt}var zr={},Hu;function mo(){if(Hu)return zr;Hu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=zr&&zr.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(zr,"__esModule",{value:!0}),zr.ArrayEqualityComparator=void 0;const e=J(),t=je(),i=ut();let s=class{hashCode(r){return r==null?0:t.MurmurHash.hashCode(r,0)}equals(r,o){if(r==null)return o==null;if(o==null||r.length!==o.length)return!1;for(let l=0;l<r.length;l++)if(!i.ObjectEqualityComparator.INSTANCE.equals(r[l],o[l]))return!1;return!0}};return s.INSTANCE=new s,u([e.Override],s.prototype,"hashCode",null),u([e.Override],s.prototype,"equals",null),zr.ArrayEqualityComparator=s,zr}var Ge={},$u;function xr(){if($u)return Ge;$u=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.toCharArray=Ge.toMap=Ge.equals=Ge.join=Ge.escapeWhitespace=void 0;function u(n,r){return r?n.replace(/ /,""):n.replace(/\t/,"\\t").replace(/\n/,"\\n").replace(/\r/,"\\r")}Ge.escapeWhitespace=u;function e(n,r){let o="",l=!0;for(let c of n)l?l=!1:o+=r,o+=c;return o}Ge.join=e;function t(n,r){return n===r?!0:n===void 0||r===void 0?!1:n.equals(r)}Ge.equals=t;function i(n){let r=new Map;for(let o=0;o<n.length;o++)r.set(n[o],o);return r}Ge.toMap=i;function s(n){if(typeof n=="string"){let r=new Uint16Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return r}else return n.toCharArray()}return Ge.toCharArray=s,Ge}var Vu;function ri(){return Vu||(Vu=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Br&&Br.__decorate||function(f,d,p,v){var x=arguments.length,y=x<3?d:v===null?v=Object.getOwnPropertyDescriptor(d,p):v,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(f,d,p,v);else for(var m=f.length-1;m>=0;m--)(g=f[m])&&(y=(x<3?g(y):x>3?g(d,p,y):g(d,p))||y);return x>3&&y&&Object.defineProperty(d,p,y),y},t=Br&&Br.__param||function(f,d){return function(p,v){d(p,v,f)}};Object.defineProperty(u,"__esModule",{value:!0}),u.SemanticContext=void 0;const i=Rr(),s=mo(),n=je(),r=J(),o=ut(),l=xr();function c(f){let d;for(let p of f){if(d===void 0){d=p;continue}d.compareTo(p)<0&&(d=p)}return d}function a(f){let d;for(let p of f){if(d===void 0){d=p;continue}d.compareTo(p)>0&&(d=p)}return d}let h=class Qe{static get NONE(){return Qe._NONE===void 0&&(Qe._NONE=new Qe.Predicate),Qe._NONE}evalPrecedence(d,p){return this}static and(d,p){if(!d||d===Qe.NONE)return p;if(p===Qe.NONE)return d;let v=new Qe.AND(d,p);return v.opnds.length===1?v.opnds[0]:v}static or(d,p){if(!d)return p;if(d===Qe.NONE||p===Qe.NONE)return Qe.NONE;let v=new Qe.OR(d,p);return v.opnds.length===1?v.opnds[0]:v}};u.SemanticContext=h,function(f){function v(T){let A=[];for(let b=0;b<T.length;b++){let N=T[b];N instanceof f.PrecedencePredicate&&(A.push(N),T.splice(b,1),b--)}return A}class x extends f{constructor(A=-1,b=-1,N=!1){super(),this.ruleIndex=A,this.predIndex=b,this.isCtxDependent=N}eval(A,b){let N=this.isCtxDependent?b:void 0;return A.sempred(N,this.ruleIndex,this.predIndex)}hashCode(){let A=n.MurmurHash.initialize();return A=n.MurmurHash.update(A,this.ruleIndex),A=n.MurmurHash.update(A,this.predIndex),A=n.MurmurHash.update(A,this.isCtxDependent?1:0),A=n.MurmurHash.finish(A,3),A}equals(A){return A instanceof x?this===A?!0:this.ruleIndex===A.ruleIndex&&this.predIndex===A.predIndex&&this.isCtxDependent===A.isCtxDependent:!1}toString(){return"{"+this.ruleIndex+":"+this.predIndex+"}?"}}e([r.Override],x.prototype,"eval",null),e([r.Override],x.prototype,"hashCode",null),e([r.Override],x.prototype,"equals",null),e([r.Override],x.prototype,"toString",null),f.Predicate=x;class y extends f{constructor(A){super(),this.precedence=A}eval(A,b){return A.precpred(b,this.precedence)}evalPrecedence(A,b){if(A.precpred(b,this.precedence))return f.NONE}compareTo(A){return this.precedence-A.precedence}hashCode(){let A=1;return A=31*A+this.precedence,A}equals(A){return A instanceof y?this===A?!0:this.precedence===A.precedence:!1}toString(){return"{"+this.precedence+">=prec}?"}}e([r.Override],y.prototype,"eval",null),e([r.Override],y.prototype,"evalPrecedence",null),e([r.Override],y.prototype,"compareTo",null),e([r.Override],y.prototype,"hashCode",null),e([r.Override],y.prototype,"equals",null),e([r.Override],y.prototype,"toString",null),f.PrecedencePredicate=y;class g extends f{}f.Operator=g;let m=class no extends g{constructor(A,b){super();let N=new i.Array2DHashSet(o.ObjectEqualityComparator.INSTANCE);A instanceof no?N.addAll(A.opnds):N.add(A),b instanceof no?N.addAll(b.opnds):N.add(b),this.opnds=N.toArray();let R=v(this.opnds),P=a(R);P&&this.opnds.push(P)}get operands(){return this.opnds}equals(A){return this===A?!0:A instanceof no?s.ArrayEqualityComparator.INSTANCE.equals(this.opnds,A.opnds):!1}hashCode(){return n.MurmurHash.hashCode(this.opnds,40363613)}eval(A,b){for(let N of this.opnds)if(!N.eval(A,b))return!1;return!0}evalPrecedence(A,b){let N=!1,R=[];for(let I of this.opnds){let B=I.evalPrecedence(A,b);if(N=N||B!==I,B==null)return;B!==f.NONE&&R.push(B)}if(!N)return this;if(R.length===0)return f.NONE;let P=R[0];for(let I=1;I<R.length;I++)P=f.and(P,R[I]);return P}toString(){return l.join(this.opnds,"&&")}};e([r.Override],m.prototype,"operands",null),e([r.Override],m.prototype,"equals",null),e([r.Override],m.prototype,"hashCode",null),e([r.Override],m.prototype,"eval",null),e([r.Override],m.prototype,"evalPrecedence",null),e([r.Override],m.prototype,"toString",null),m=e([t(0,r.NotNull),t(1,r.NotNull)],m),f.AND=m;let S=class io extends g{constructor(A,b){super();let N=new i.Array2DHashSet(o.ObjectEqualityComparator.INSTANCE);A instanceof io?N.addAll(A.opnds):N.add(A),b instanceof io?N.addAll(b.opnds):N.add(b),this.opnds=N.toArray();let R=v(this.opnds),P=c(R);P&&this.opnds.push(P)}get operands(){return this.opnds}equals(A){return this===A?!0:A instanceof io?s.ArrayEqualityComparator.INSTANCE.equals(this.opnds,A.opnds):!1}hashCode(){return n.MurmurHash.hashCode(this.opnds,486279973)}eval(A,b){for(let N of this.opnds)if(N.eval(A,b))return!0;return!1}evalPrecedence(A,b){let N=!1,R=[];for(let I of this.opnds){let B=I.evalPrecedence(A,b);if(N=N||B!==I,B===f.NONE)return f.NONE;B&&R.push(B)}if(!N)return this;if(R.length===0)return;let P=R[0];for(let I=1;I<R.length;I++)P=f.or(P,R[I]);return P}toString(){return l.join(this.opnds,"||")}};e([r.Override],S.prototype,"operands",null),e([r.Override],S.prototype,"equals",null),e([r.Override],S.prototype,"hashCode",null),e([r.Override],S.prototype,"eval",null),e([r.Override],S.prototype,"evalPrecedence",null),e([r.Override],S.prototype,"toString",null),S=e([t(0,r.NotNull),t(1,r.NotNull)],S),f.OR=S}(h=u.SemanticContext||(u.SemanticContext={}))}(Br)),Br}var Wu;function od(){if(Wu)return dt;Wu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=dt&&dt.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=dt&&dt.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(dt,"__esModule",{value:!0}),dt.PredicateTransition=void 0;const t=jl(),i=J(),s=ri();let n=class extends t.AbstractPredicateTransition{constructor(o,l,c,a){super(o),this.ruleIndex=l,this.predIndex=c,this.isCtxDependent=a}get serializationType(){return 4}get isEpsilon(){return!0}matches(o,l,c){return!1}get predicate(){return new s.SemanticContext.Predicate(this.ruleIndex,this.predIndex,this.isCtxDependent)}toString(){return"pred_"+this.ruleIndex+":"+this.predIndex}};return u([i.Override],n.prototype,"serializationType",null),u([i.Override],n.prototype,"isEpsilon",null),u([i.Override],n.prototype,"matches",null),u([i.Override,i.NotNull],n.prototype,"toString",null),n=u([e(0,i.NotNull)],n),dt.PredicateTransition=n,dt}var Gu;function go(){if(Gu)return ft;Gu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=ft&&ft.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=ft&&ft.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(ft,"__esModule",{value:!0}),ft.FailedPredicateException=void 0;const t=br(),i=J(),s=od();let n=class sd extends t.RecognitionException{constructor(o,l,c){super(o,o.inputStream,o.context,sd.formatMessage(l,c));let h=o.interpreter.atn.states[o.state].transition(0);h instanceof s.PredicateTransition?(this._ruleIndex=h.ruleIndex,this._predicateIndex=h.predIndex):(this._ruleIndex=0,this._predicateIndex=0),this._predicate=l,super.setOffendingToken(o,o.currentToken)}get ruleIndex(){return this._ruleIndex}get predicateIndex(){return this._predicateIndex}get predicate(){return this._predicate}static formatMessage(o,l){return l||`failed predicate: {${o}}?`}};return u([i.NotNull],n,"formatMessage",null),n=u([e(0,i.NotNull)],n),ft.FailedPredicateException=n,ft}var mt={},Yu;function yo(){if(Yu)return mt;Yu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=mt&&mt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=mt&&mt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(mt,"__esModule",{value:!0}),mt.InputMismatchException=void 0;const t=br(),i=J();let s=class extends t.RecognitionException{constructor(r,o,l){l===void 0&&(l=r.context),super(r,r.inputStream,l),o!==void 0&&this.setOffendingState(o),this.setOffendingToken(r,r.currentToken)}};return s=u([e(0,i.NotNull)],s),mt.InputMismatchException=s,mt}var gt={},jr={},el={},Xu;function ql(){return Xu||(Xu=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(u,"__esModule",{value:!0}),u.Arrays=void 0,function(e){function t(n,r,o,l){return i(n,o!==void 0?o:0,l!==void 0?l:n.length,r)}e.binarySearch=t;function i(n,r,o,l){let c=r,a=o-1;for(;c<=a;){let h=c+a>>>1,f=n[h];if(f<l)c=h+1;else if(f>l)a=h-1;else return h}return-(c+1)}function s(n){let r="[",o=!0;for(let l of n)o?o=!1:r+=", ",l===null?r+="null":l===void 0?r+="undefined":r+=l;return r+="]",r}e.toString=s}(u.Arrays||(u.Arrays={}))}(el)),el}var Ku;function Ul(){if(Ku)return jr;Ku=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=jr&&jr.__decorate||function(o,l,c,a){var h=arguments.length,f=h<3?l:a===null?a=Object.getOwnPropertyDescriptor(l,c):a,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,l,c,a);else for(var p=o.length-1;p>=0;p--)(d=o[p])&&(f=(h<3?d(f):h>3?d(l,c,f):d(l,c))||f);return h>3&&f&&Object.defineProperty(l,c,f),f};Object.defineProperty(jr,"__esModule",{value:!0}),jr.IntegerList=void 0;const e=ql(),t=J(),i=new Int32Array(0),s=4,n=(1<<31>>>0)-1-8;let r=class oo{constructor(l){if(!l)this._data=i,this._size=0;else if(l instanceof oo)this._data=l._data.slice(0),this._size=l._size;else if(typeof l=="number")l===0?(this._data=i,this._size=0):(this._data=new Int32Array(l),this._size=0);else{this._data=i,this._size=0;for(let c of l)this.add(c)}}add(l){this._data.length===this._size&&this.ensureCapacity(this._size+1),this._data[this._size]=l,this._size++}addAll(l){if(Array.isArray(l))this.ensureCapacity(this._size+l.length),this._data.subarray(this._size,this._size+l.length).set(l),this._size+=l.length;else if(l instanceof oo)this.ensureCapacity(this._size+l._size),this._data.subarray(this._size,this._size+l.size).set(l._data),this._size+=l._size;else{this.ensureCapacity(this._size+l.size);let c=0;for(let a of l)this._data[this._size+c]=a,c++;this._size+=l.size}}get(l){if(l<0||l>=this._size)throw RangeError();return this._data[l]}contains(l){for(let c=0;c<this._size;c++)if(this._data[c]===l)return!0;return!1}set(l,c){if(l<0||l>=this._size)throw RangeError();let a=this._data[l];return this._data[l]=c,a}removeAt(l){let c=this.get(l);return this._data.copyWithin(l,l+1,this._size),this._data[this._size-1]=0,this._size--,c}removeRange(l,c){if(l<0||c<0||l>this._size||c>this._size||l>c)throw RangeError();this._data.copyWithin(c,l,this._size),this._data.fill(0,this._size-(c-l),this._size),this._size-=c-l}get isEmpty(){return this._size===0}get size(){return this._size}trimToSize(){this._data.length!==this._size&&(this._data=this._data.slice(0,this._size))}clear(){this._data.fill(0,0,this._size),this._size=0}toArray(){return this._size===0?[]:Array.from(this._data.subarray(0,this._size))}sort(){this._data.subarray(0,this._size).sort()}equals(l){if(l===this)return!0;if(!(l instanceof oo)||this._size!==l._size)return!1;for(let c=0;c<this._size;c++)if(this._data[c]!==l._data[c])return!1;return!0}hashCode(){let l=1;for(let c=0;c<this._size;c++)l=31*l+this._data[c];return l}toString(){return this._data.toString()}binarySearch(l,c,a){if(c===void 0&&(c=0),a===void 0&&(a=this._size),c<0||a<0||c>this._size||a>this._size)throw new RangeError;if(c>a)throw new RangeError;return e.Arrays.binarySearch(this._data,l,c,a)}ensureCapacity(l){if(l<0||l>n)throw new RangeError;let c;for(this._data.length===0?c=s:c=this._data.length;c<l;)c=c*2,(c<0||c>n)&&(c=n);let a=new Int32Array(c);a.set(this._data),this._data=a}toCharArray(){let l=new Uint16Array(this._size),c=0,a=!1;for(let h=0;h<this._size;h++){let f=this._data[h];if(f>=0&&f<65536){l[c]=f,c++;continue}if(!a){let p=new Uint16Array(this.charArraySize());p.set(l,0),l=p,a=!0}let d=String.fromCodePoint(f);l[c]=d.charCodeAt(0),l[c+1]=d.charCodeAt(1),c+=2}return l}charArraySize(){let l=0;for(let c=0;c<this._size;c++)l+=this._data[c]>=65536?2:1;return l}};return u([t.NotNull],r.prototype,"_data",void 0),u([t.Override],r.prototype,"equals",null),u([t.Override],r.prototype,"hashCode",null),u([t.Override],r.prototype,"toString",null),jr.IntegerList=r,jr}var qr={},Qu;function We(){if(Qu)return qr;Qu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=qr&&qr.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c};Object.defineProperty(qr,"__esModule",{value:!0}),qr.Interval=void 0;const e=J(),t=1e3;let i=class Je{constructor(n,r){this.a=n,this.b=r}static get INVALID(){return Je._INVALID}static of(n,r){return n!==r||n<0||n>t?new Je(n,r):(Je.cache[n]==null&&(Je.cache[n]=new Je(n,n)),Je.cache[n])}get length(){return this.b<this.a?0:this.b-this.a+1}equals(n){return n===this?!0:n instanceof Je?this.a===n.a&&this.b===n.b:!1}hashCode(){let n=23;return n=n*31+this.a,n=n*31+this.b,n}startsBeforeDisjoint(n){return this.a<n.a&&this.b<n.a}startsBeforeNonDisjoint(n){return this.a<=n.a&&this.b>=n.a}startsAfter(n){return this.a>n.a}startsAfterDisjoint(n){return this.a>n.b}startsAfterNonDisjoint(n){return this.a>n.a&&this.a<=n.b}disjoint(n){return this.startsBeforeDisjoint(n)||this.startsAfterDisjoint(n)}adjacent(n){return this.a===n.b+1||this.b===n.a-1}properlyContains(n){return n.a>=this.a&&n.b<=this.b}union(n){return Je.of(Math.min(this.a,n.a),Math.max(this.b,n.b))}intersection(n){return Je.of(Math.max(this.a,n.a),Math.min(this.b,n.b))}differenceNotProperlyContained(n){let r;return n.startsBeforeNonDisjoint(this)?r=Je.of(Math.max(this.a,n.b+1),this.b):n.startsAfterNonDisjoint(this)&&(r=Je.of(this.a,n.a-1)),r}toString(){return this.a+".."+this.b}};return i._INVALID=new i(-1,-2),i.cache=new Array(t+1),u([e.Override],i.prototype,"equals",null),u([e.Override],i.prototype,"hashCode",null),u([e.Override],i.prototype,"toString",null),qr.Interval=i,qr}var Ur={},ci={},yt={},tl={},Ju;function Be(){return Ju||(Ju=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(u,"__esModule",{value:!0}),u.Token=void 0;const e=Tr();(function(t){t.INVALID_TYPE=0,t.EPSILON=-2,t.MIN_USER_TOKEN_TYPE=1,t.EOF=e.IntStream.EOF,t.DEFAULT_CHANNEL=0,t.HIDDEN_CHANNEL=1,t.MIN_USER_CHANNEL_VALUE=2})(u.Token||(u.Token={}))}(tl)),tl}var Zu;function qi(){if(Zu)return yt;Zu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=yt&&yt.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=yt&&yt.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(yt,"__esModule",{value:!0}),yt.CommonToken=void 0;const t=We(),i=J(),s=Be();let n=class Fi{constructor(o,l,c=Fi.EMPTY_SOURCE,a=s.Token.DEFAULT_CHANNEL,h=0,f=0){this._line=0,this._charPositionInLine=-1,this._channel=s.Token.DEFAULT_CHANNEL,this.index=-1,this._text=l,this._type=o,this.source=c,this._channel=a,this.start=h,this.stop=f,c.source!=null&&(this._line=c.source.line,this._charPositionInLine=c.source.charPositionInLine)}static fromToken(o){let l=new Fi(o.type,void 0,Fi.EMPTY_SOURCE,o.channel,o.startIndex,o.stopIndex);return l._line=o.line,l.index=o.tokenIndex,l._charPositionInLine=o.charPositionInLine,o instanceof Fi?(l._text=o._text,l.source=o.source):(l._text=o.text,l.source={source:o.tokenSource,stream:o.inputStream}),l}get type(){return this._type}set type(o){this._type=o}get line(){return this._line}set line(o){this._line=o}get text(){if(this._text!=null)return this._text;let o=this.inputStream;if(o==null)return;let l=o.size;return this.start<l&&this.stop<l?o.getText(t.Interval.of(this.start,this.stop)):"<EOF>"}set text(o){this._text=o}get charPositionInLine(){return this._charPositionInLine}set charPositionInLine(o){this._charPositionInLine=o}get channel(){return this._channel}set channel(o){this._channel=o}get startIndex(){return this.start}set startIndex(o){this.start=o}get stopIndex(){return this.stop}set stopIndex(o){this.stop=o}get tokenIndex(){return this.index}set tokenIndex(o){this.index=o}get tokenSource(){return this.source.source}get inputStream(){return this.source.stream}toString(o){let l="";this._channel>0&&(l=",channel="+this._channel);let c=this.text;c!=null?(c=c.replace(/\n/g,"\\n"),c=c.replace(/\r/g,"\\r"),c=c.replace(/\t/g,"\\t")):c="<no text>";let a=String(this._type);return o&&(a=o.vocabulary.getDisplayName(this._type)),"[@"+this.tokenIndex+","+this.start+":"+this.stop+"='"+c+"',<"+a+">"+l+","+this._line+":"+this.charPositionInLine+"]"}};return n.EMPTY_SOURCE={source:void 0,stream:void 0},u([i.NotNull],n.prototype,"source",void 0),u([i.Override],n.prototype,"type",null),u([i.Override],n.prototype,"line",null),u([i.Override],n.prototype,"text",null),u([i.Override],n.prototype,"charPositionInLine",null),u([i.Override],n.prototype,"channel",null),u([i.Override],n.prototype,"startIndex",null),u([i.Override],n.prototype,"stopIndex",null),u([i.Override],n.prototype,"tokenIndex",null),u([i.Override],n.prototype,"tokenSource",null),u([i.Override],n.prototype,"inputStream",null),u([i.Override],n.prototype,"toString",null),u([e(0,i.NotNull)],n,"fromToken",null),n=u([e(2,i.NotNull)],n),yt.CommonToken=n,yt}var ec;function Hl(){return ec||(ec=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=ci&&ci.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h};Object.defineProperty(u,"__esModule",{value:!0}),u.CommonTokenFactory=void 0;const t=qi(),i=We(),s=J();let n=class{constructor(o=!1){this.copyText=o}create(o,l,c,a,h,f,d,p){let v=new t.CommonToken(l,c,o,a,h,f);return v.line=d,v.charPositionInLine=p,c==null&&this.copyText&&o.stream!=null&&(v.text=o.stream.getText(i.Interval.of(h,f))),v}createSimple(o,l){return new t.CommonToken(o,l)}};e([s.Override],n.prototype,"create",null),e([s.Override],n.prototype,"createSimple",null),u.CommonTokenFactory=n,function(r){r.DEFAULT=new r}(n=u.CommonTokenFactory||(u.CommonTokenFactory={}))}(ci)),ci}var hi={},tc;function ld(){if(tc)return hi;tc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(hi,"__esModule",{value:!0}),hi.IntegerStack=void 0;const u=Ul();let e=class extends u.IntegerList{constructor(i){super(i)}push(i){this.add(i)}pop(){return this.removeAt(this.size-1)}peek(){return this.get(this.size-1)}};return hi.IntegerStack=e,hi}var Hr={},fi={},rc;function ad(){if(rc)return fi;rc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(fi,"__esModule",{value:!0}),fi.AcceptStateInfo=void 0;let u=class{constructor(t,i){this._prediction=t,this._lexerActionExecutor=i}get prediction(){return this._prediction}get lexerActionExecutor(){return this._lexerActionExecutor}};return fi.AcceptStateInfo=u,fi}var $r={},di={},nc;function ni(){if(nc)return di;nc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(di,"__esModule",{value:!0}),di.Array2DHashMap=void 0;const u=Rr();class e{constructor(s){this.keyComparator=s}hashCode(s){return this.keyComparator.hashCode(s.key)}equals(s,n){return this.keyComparator.equals(s.key,n.key)}}let t=class yl{constructor(s){s instanceof yl?this.backingStore=new u.Array2DHashSet(s.backingStore):this.backingStore=new u.Array2DHashSet(new e(s))}clear(){this.backingStore.clear()}containsKey(s){return this.backingStore.contains({key:s})}get(s){let n=this.backingStore.get({key:s});if(n)return n.value}get isEmpty(){return this.backingStore.isEmpty}put(s,n){let r=this.backingStore.get({key:s,value:n}),o;return r?(o=r.value,r.value=n):this.backingStore.add({key:s,value:n}),o}putIfAbsent(s,n){let r=this.backingStore.get({key:s,value:n}),o;return r?o=r.value:this.backingStore.add({key:s,value:n}),o}get size(){return this.backingStore.size}hashCode(){return this.backingStore.hashCode()}equals(s){return s instanceof yl?this.backingStore.equals(s.backingStore):!1}};return di.Array2DHashMap=t,di}var vt={},Vr={},St={},pi={},ic;function Un(){if(ic)return pi;ic=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(pi,"__esModule",{value:!0}),pi.DecisionState=void 0;const u=pr();let e=class extends u.ATNState{constructor(){super(...arguments),this.decision=-1,this.nonGreedy=!1,this.sll=!1}};return pi.DecisionState=e,pi}var Wr={},xi={},oc;function $l(){return oc||(oc=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=xi&&xi.__decorate||function(l,c,a,h){var f=arguments.length,d=f<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,a):h,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(l,c,a,h);else for(var v=l.length-1;v>=0;v--)(p=l[v])&&(d=(f<3?p(d):f>3?p(c,a,d):p(c,a))||d);return f>3&&d&&Object.defineProperty(c,a,d),d};Object.defineProperty(u,"__esModule",{value:!0}),u.PredictionContextCache=void 0;const t=ni(),i=J(),s=ut(),n=it(),r=$e();let o=class vl{constructor(c=!0){this.contexts=new t.Array2DHashMap(s.ObjectEqualityComparator.INSTANCE),this.childContexts=new t.Array2DHashMap(s.ObjectEqualityComparator.INSTANCE),this.joinContexts=new t.Array2DHashMap(s.ObjectEqualityComparator.INSTANCE),this.enableCache=c}getAsCached(c){if(!this.enableCache)return c;let a=this.contexts.get(c);return a||(a=c,this.contexts.put(c,c)),a}getChild(c,a){if(!this.enableCache)return c.getChild(a);let h=new vl.PredictionContextAndInt(c,a),f=this.childContexts.get(h);return f||(f=c.getChild(a),f=this.getAsCached(f),this.childContexts.put(h,f)),f}join(c,a){if(!this.enableCache)return n.PredictionContext.join(c,a,this);let h=new vl.IdentityCommutativePredictionContextOperands(c,a),f=this.joinContexts.get(h);return f||(f=n.PredictionContext.join(c,a,this),f=this.getAsCached(f),this.joinContexts.put(h,f),f)}};u.PredictionContextCache=o,o.UNCACHED=new o(!1),function(l){class c{constructor(f,d){this.obj=f,this.value=d}equals(f){if(f instanceof c){if(f===this)return!0}else return!1;let d=f;return this.value===d.value&&(this.obj===d.obj||this.obj!=null&&this.obj.equals(d.obj))}hashCode(){let f=5;return f=7*f+(this.obj!=null?this.obj.hashCode():0),f=7*f+this.value,f}}e([i.Override],c.prototype,"equals",null),e([i.Override],c.prototype,"hashCode",null),l.PredictionContextAndInt=c;class a{constructor(f,d){r(f!=null),r(d!=null),this._x=f,this._y=d}get x(){return this._x}get y(){return this._y}equals(f){if(f instanceof a){if(this===f)return!0}else return!1;let d=f;return this._x===d._x&&this._y===d._y||this._x===d._y&&this._y===d._x}hashCode(){return this._x.hashCode()^this._y.hashCode()}}e([i.Override],a.prototype,"equals",null),e([i.Override],a.prototype,"hashCode",null),l.IdentityCommutativePredictionContextOperands=a}(o=u.PredictionContextCache||(u.PredictionContextCache={}))}(xi)),xi}var sc;function it(){return sc||(sc=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Wr&&Wr.__decorate||function(v,x,y,g){var m=arguments.length,S=m<3?x:g===null?g=Object.getOwnPropertyDescriptor(x,y):g,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(v,x,y,g);else for(var A=v.length-1;A>=0;A--)(T=v[A])&&(S=(m<3?T(S):m>3?T(x,y,S):T(x,y))||S);return m>3&&S&&Object.defineProperty(x,y,S),S},t=Wr&&Wr.__param||function(v,x){return function(y,g){x(y,g,v)}};Object.defineProperty(u,"__esModule",{value:!0}),u.SingletonPredictionContext=u.PredictionContext=void 0;const i=ni(),s=Rr(),n=ql(),r=je(),o=J(),l=$l(),c=$e(),a=1;let h=class He{constructor(x){this.cachedHashCode=x}static calculateEmptyHashCode(){let x=r.MurmurHash.initialize(a);return x=r.MurmurHash.finish(x,0),x}static calculateSingleHashCode(x,y){let g=r.MurmurHash.initialize(a);return g=r.MurmurHash.update(g,x),g=r.MurmurHash.update(g,y),g=r.MurmurHash.finish(g,2),g}static calculateHashCode(x,y){let g=r.MurmurHash.initialize(a);for(let m of x)g=r.MurmurHash.update(g,m);for(let m of y)g=r.MurmurHash.update(g,m);return g=r.MurmurHash.finish(g,2*x.length),g}static fromRuleContext(x,y,g=!0){if(y.isEmpty)return g?He.EMPTY_FULL:He.EMPTY_LOCAL;let m;y._parent?m=He.fromRuleContext(x,y._parent,g):m=g?He.EMPTY_FULL:He.EMPTY_LOCAL;let T=x.states[y.invokingState].transition(0);return m.getChild(T.followState.stateNumber)}static addEmptyContext(x){return x.addEmptyContext()}static removeEmptyContext(x){return x.removeEmptyContext()}static join(x,y,g=l.PredictionContextCache.UNCACHED){if(x===y)return x;if(x.isEmpty)return He.isEmptyLocal(x)?x:He.addEmptyContext(y);if(y.isEmpty)return He.isEmptyLocal(y)?y:He.addEmptyContext(x);let m=x.size,S=y.size;if(m===1&&S===1&&x.getReturnState(0)===y.getReturnState(0)){let B=g.join(x.getParent(0),y.getParent(0));return B===x.getParent(0)?x:B===y.getParent(0)?y:B.getChild(x.getReturnState(0))}let T=0,A=new Array(m+S),b=new Array(A.length),N=0,R=0,P=!0,I=!0;for(;N<m&&R<S;)x.getReturnState(N)===y.getReturnState(R)?(A[T]=g.join(x.getParent(N),y.getParent(R)),b[T]=x.getReturnState(N),P=P&&A[T]===x.getParent(N),I=I&&A[T]===y.getParent(R),N++,R++):x.getReturnState(N)<y.getReturnState(R)?(A[T]=x.getParent(N),b[T]=x.getReturnState(N),I=!1,N++):(c(y.getReturnState(R)<x.getReturnState(N)),A[T]=y.getParent(R),b[T]=y.getReturnState(R),P=!1,R++),T++;for(;N<m;)A[T]=x.getParent(N),b[T]=x.getReturnState(N),N++,I=!1,T++;for(;R<S;)A[T]=y.getParent(R),b[T]=y.getReturnState(R),R++,P=!1,T++;return P?x:I?y:(T<A.length&&(A=A.slice(0,T),b=b.slice(0,T)),A.length===0?He.EMPTY_FULL:A.length===1?new p(A[0],b[0]):new d(A,b))}static isEmptyLocal(x){return x===He.EMPTY_LOCAL}static getCachedContext(x,y,g){if(x.isEmpty)return x;let m=g.get(x);if(m)return m;if(m=y.get(x),m)return g.put(x,m),m;let S=!1,T=new Array(x.size);for(let b=0;b<T.length;b++){let N=He.getCachedContext(x.getParent(b),y,g);if(S||N!==x.getParent(b)){if(!S){T=new Array(x.size);for(let R=0;R<x.size;R++)T[R]=x.getParent(R);S=!0}T[b]=N}}if(!S)return m=y.putIfAbsent(x,x),g.put(x,m??x),x;let A;if(T.length===1)A=new p(T[0],x.getReturnState(0));else{let b=new Array(x.size);for(let N=0;N<x.size;N++)b[N]=x.getReturnState(N);A=new d(T,b,x.hashCode())}return m=y.putIfAbsent(A,A),g.put(A,m||A),g.put(x,m||A),A}appendSingleContext(x,y){return this.appendContext(He.EMPTY_FULL.getChild(x),y)}getChild(x){return new p(this,x)}hashCode(){return this.cachedHashCode}toStrings(x,y,g=He.EMPTY_FULL){let m=[];e:for(let S=0;;S++){let T=0,A=!0,b=this,N=y,R="";for(R+="[";!b.isEmpty&&b!==g;){let P=0;if(b.size>0){let I=1;for(;1<<I>>>0<b.size;)I++;let B=(1<<I>>>0)-1;if(P=S>>T&B,A=A&&P>=b.size-1,P>=b.size)continue e;T+=I}if(x){R.length>1&&(R+=" ");let B=x.atn.states[N],V=x.ruleNames[B.ruleIndex];R+=V}else b.getReturnState(P)!==He.EMPTY_FULL_STATE_KEY&&(b.isEmpty||(R.length>1&&(R+=" "),R+=b.getReturnState(P)));N=b.getReturnState(P),b=b.getParent(P)}if(R+="]",m.push(R),A)break}return m}};e([o.Override],h.prototype,"hashCode",null),e([t(0,o.NotNull),t(1,o.NotNull),t(2,o.NotNull)],h,"join",null),e([t(0,o.NotNull),t(1,o.NotNull),t(2,o.NotNull)],h,"getCachedContext",null),u.PredictionContext=h;class f extends h{constructor(x){super(h.calculateEmptyHashCode()),this.fullContext=x}get isFullContext(){return this.fullContext}addEmptyContext(){return this}removeEmptyContext(){throw new Error("Cannot remove the empty context from itself.")}getParent(x){throw new Error("index out of bounds")}getReturnState(x){throw new Error("index out of bounds")}findReturnState(x){return-1}get size(){return 0}appendSingleContext(x,y){return y.getChild(this,x)}appendContext(x,y){return x}get isEmpty(){return!0}get hasEmpty(){return!0}equals(x){return this===x}toStrings(x,y,g){return["[]"]}}e([o.Override],f.prototype,"addEmptyContext",null),e([o.Override],f.prototype,"removeEmptyContext",null),e([o.Override],f.prototype,"getParent",null),e([o.Override],f.prototype,"getReturnState",null),e([o.Override],f.prototype,"findReturnState",null),e([o.Override],f.prototype,"size",null),e([o.Override],f.prototype,"appendSingleContext",null),e([o.Override],f.prototype,"appendContext",null),e([o.Override],f.prototype,"isEmpty",null),e([o.Override],f.prototype,"hasEmpty",null),e([o.Override],f.prototype,"equals",null),e([o.Override],f.prototype,"toStrings",null);let d=class Mn extends h{constructor(x,y,g){super(g||h.calculateHashCode(x,y)),c(x.length===y.length),c(y.length>1||y[0]!==h.EMPTY_FULL_STATE_KEY,"Should be using PredictionContext.EMPTY instead."),this.parents=x,this.returnStates=y}getParent(x){return this.parents[x]}getReturnState(x){return this.returnStates[x]}findReturnState(x){return n.Arrays.binarySearch(this.returnStates,x)}get size(){return this.returnStates.length}get isEmpty(){return!1}get hasEmpty(){return this.returnStates[this.returnStates.length-1]===h.EMPTY_FULL_STATE_KEY}addEmptyContext(){if(this.hasEmpty)return this;let x=this.parents.slice(0),y=this.returnStates.slice(0);return x.push(h.EMPTY_FULL),y.push(h.EMPTY_FULL_STATE_KEY),new Mn(x,y)}removeEmptyContext(){if(!this.hasEmpty)return this;if(this.returnStates.length===2)return new p(this.parents[0],this.returnStates[0]);{let x=this.parents.slice(0,this.parents.length-1),y=this.returnStates.slice(0,this.returnStates.length-1);return new Mn(x,y)}}appendContext(x,y){return Mn.appendContextImpl(this,x,new h.IdentityHashMap)}static appendContextImpl(x,y,g){if(y.isEmpty){if(h.isEmptyLocal(y)){if(x.hasEmpty)return h.EMPTY_LOCAL;throw new Error("what to do here?")}return x}if(y.size!==1)throw new Error("Appending a tree suffix is not yet supported.");let m=g.get(x);if(!m){if(x.isEmpty)m=y;else{let S=x.size;x.hasEmpty&&S--;let T=new Array(S),A=new Array(S);for(let b=0;b<S;b++)A[b]=x.getReturnState(b);for(let b=0;b<S;b++)T[b]=Mn.appendContextImpl(x.getParent(b),y,g);T.length===1?m=new p(T[0],A[0]):(c(T.length>1),m=new Mn(T,A)),x.hasEmpty&&(m=h.join(m,y))}g.put(x,m)}return m}equals(x){if(this===x)return!0;if(!(x instanceof Mn)||this.hashCode()!==x.hashCode())return!1;let y=x;return this.equalsImpl(y,new s.Array2DHashSet)}equalsImpl(x,y){let g=[],m=[];for(g.push(this),m.push(x);;){let S=g.pop(),T=m.pop();if(!S||!T)break;let A=new l.PredictionContextCache.IdentityCommutativePredictionContextOperands(S,T);if(!y.add(A))continue;let b=A.x.size;if(b===0){if(!A.x.equals(A.y))return!1;continue}let N=A.y.size;if(b!==N)return!1;for(let R=0;R<b;R++){if(A.x.getReturnState(R)!==A.y.getReturnState(R))return!1;let P=A.x.getParent(R),I=A.y.getParent(R);if(P.hashCode()!==I.hashCode())return!1;P!==I&&(g.push(P),m.push(I))}}return!0}};e([o.NotNull],d.prototype,"parents",void 0),e([o.NotNull],d.prototype,"returnStates",void 0),e([o.Override],d.prototype,"getParent",null),e([o.Override],d.prototype,"getReturnState",null),e([o.Override],d.prototype,"findReturnState",null),e([o.Override],d.prototype,"size",null),e([o.Override],d.prototype,"isEmpty",null),e([o.Override],d.prototype,"hasEmpty",null),e([o.Override],d.prototype,"addEmptyContext",null),e([o.Override],d.prototype,"removeEmptyContext",null),e([o.Override],d.prototype,"appendContext",null),e([o.Override],d.prototype,"equals",null),d=e([t(0,o.NotNull)],d);let p=class ud extends h{constructor(x,y){super(h.calculateSingleHashCode(x,y)),this.parent=x,this.returnState=y}getParent(x){return this.parent}getReturnState(x){return this.returnState}findReturnState(x){return this.returnState===x?0:-1}get size(){return 1}get isEmpty(){return!1}get hasEmpty(){return!1}appendContext(x,y){return y.getChild(this.parent.appendContext(x,y),this.returnState)}addEmptyContext(){let x=[this.parent,h.EMPTY_FULL],y=[this.returnState,h.EMPTY_FULL_STATE_KEY];return new d(x,y)}removeEmptyContext(){return this}equals(x){if(x===this)return!0;if(!(x instanceof ud))return!1;let y=x;return this.hashCode()!==y.hashCode()?!1:this.returnState===y.returnState&&this.parent.equals(y.parent)}};e([o.NotNull],p.prototype,"parent",void 0),e([o.Override],p.prototype,"getParent",null),e([o.Override],p.prototype,"getReturnState",null),e([o.Override],p.prototype,"findReturnState",null),e([o.Override],p.prototype,"size",null),e([o.Override],p.prototype,"isEmpty",null),e([o.Override],p.prototype,"hasEmpty",null),e([o.Override],p.prototype,"appendContext",null),e([o.Override],p.prototype,"addEmptyContext",null),e([o.Override],p.prototype,"removeEmptyContext",null),e([o.Override],p.prototype,"equals",null),p=e([t(0,o.NotNull)],p),u.SingletonPredictionContext=p,function(v){v.EMPTY_LOCAL=new f(!1),v.EMPTY_FULL=new f(!0),v.EMPTY_LOCAL_STATE_KEY=-2147483648,v.EMPTY_FULL_STATE_KEY=(1<<31>>>0)-1;class x extends i.Array2DHashMap{constructor(){super(y.INSTANCE)}}v.IdentityHashMap=x;class y{IdentityEqualityComparator(){}hashCode(m){return m.hashCode()}equals(m,S){return m===S}}y.INSTANCE=new y,e([o.Override],y.prototype,"hashCode",null),e([o.Override],y.prototype,"equals",null),v.IdentityEqualityComparator=y}(h=u.PredictionContext||(u.PredictionContext={}))}(Wr)),Wr}var lc;function vo(){if(lc)return St;lc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=St&&St.__decorate||function(v,x,y,g){var m=arguments.length,S=m<3?x:g===null?g=Object.getOwnPropertyDescriptor(x,y):g,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(v,x,y,g);else for(var A=v.length-1;A>=0;A--)(T=v[A])&&(S=(m<3?T(S):m>3?T(x,y,S):T(x,y))||S);return m>3&&S&&Object.defineProperty(x,y,S),S},e=St&&St.__param||function(v,x){return function(y,g){x(y,g,v)}};Object.defineProperty(St,"__esModule",{value:!0}),St.ATNConfig=void 0;const t=ni(),i=Un(),s=je(),n=J(),r=ut(),o=it(),l=ri(),c=$e(),a=2147483648;let h=class Pi{constructor(x,y,g){typeof y=="number"?(c((y&16777215)===y),this._state=x,this.altAndOuterContextDepth=y,this._context=g):(this._state=x,this.altAndOuterContextDepth=y.altAndOuterContextDepth,this._context=g)}static create(x,y,g,m=l.SemanticContext.NONE,S){return m!==l.SemanticContext.NONE?S!=null?new p(S,m,x,y,g,!1):new f(m,x,y,g):S!=null?new d(S,x,y,g,!1):new Pi(x,y,g)}get state(){return this._state}get alt(){return this.altAndOuterContextDepth&16777215}get context(){return this._context}set context(x){this._context=x}get reachesIntoOuterContext(){return this.outerContextDepth!==0}get outerContextDepth(){return this.altAndOuterContextDepth>>>24&127}set outerContextDepth(x){c(x>=0),x=Math.min(x,127),this.altAndOuterContextDepth=x<<24|(this.altAndOuterContextDepth&-2130706433)>>>0}get lexerActionExecutor(){}get semanticContext(){return l.SemanticContext.NONE}get hasPassedThroughNonGreedyDecision(){return!1}clone(){return this.transform(this.state,!1)}transform(x,y,g){return g==null?this.transformImpl(x,this._context,this.semanticContext,y,this.lexerActionExecutor):g instanceof o.PredictionContext?this.transformImpl(x,g,this.semanticContext,y,this.lexerActionExecutor):g instanceof l.SemanticContext?this.transformImpl(x,this._context,g,y,this.lexerActionExecutor):this.transformImpl(x,this._context,this.semanticContext,y,g)}transformImpl(x,y,g,m,S){let T=m&&Pi.checkNonGreedyDecision(this,x);return g!==l.SemanticContext.NONE?S!=null||T?new p(S,g,x,this,y,T):new f(g,x,this,y):S!=null||T?new d(S,x,this,y,T):new Pi(x,this,y)}static checkNonGreedyDecision(x,y){return x.hasPassedThroughNonGreedyDecision||y instanceof i.DecisionState&&y.nonGreedy}appendContext(x,y){if(typeof x=="number"){let g=this.context.appendSingleContext(x,y);return this.transform(this.state,!1,g)}else{let g=this.context.appendContext(x,y);return this.transform(this.state,!1,g)}}contains(x){if(this.state.stateNumber!==x.state.stateNumber||this.alt!==x.alt||!this.semanticContext.equals(x.semanticContext))return!1;let y=[],g=[];for(y.push(this.context),g.push(x.context);;){let m=y.pop(),S=g.pop();if(!m||!S)break;if(m===S)return!0;if(m.size<S.size)return!1;if(S.isEmpty)return m.hasEmpty;for(let T=0;T<S.size;T++){let A=m.findReturnState(S.getReturnState(T));if(A<0)return!1;y.push(m.getParent(A)),g.push(S.getParent(T))}}return!1}get isPrecedenceFilterSuppressed(){return(this.altAndOuterContextDepth&a)!==0}set isPrecedenceFilterSuppressed(x){x?this.altAndOuterContextDepth|=a:this.altAndOuterContextDepth&=2147483647}equals(x){return this===x?!0:x instanceof Pi?this.state.stateNumber===x.state.stateNumber&&this.alt===x.alt&&this.reachesIntoOuterContext===x.reachesIntoOuterContext&&this.context.equals(x.context)&&this.semanticContext.equals(x.semanticContext)&&this.isPrecedenceFilterSuppressed===x.isPrecedenceFilterSuppressed&&this.hasPassedThroughNonGreedyDecision===x.hasPassedThroughNonGreedyDecision&&r.ObjectEqualityComparator.INSTANCE.equals(this.lexerActionExecutor,x.lexerActionExecutor):!1}hashCode(){let x=s.MurmurHash.initialize(7);return x=s.MurmurHash.update(x,this.state.stateNumber),x=s.MurmurHash.update(x,this.alt),x=s.MurmurHash.update(x,this.reachesIntoOuterContext?1:0),x=s.MurmurHash.update(x,this.context),x=s.MurmurHash.update(x,this.semanticContext),x=s.MurmurHash.update(x,this.hasPassedThroughNonGreedyDecision?1:0),x=s.MurmurHash.update(x,this.lexerActionExecutor),x=s.MurmurHash.finish(x,7),x}toDotString(){let x="";x+=`digraph G {
`,x+=`rankdir=LR;
`;let y=new t.Array2DHashMap(o.PredictionContext.IdentityEqualityComparator.INSTANCE),g=[];function m(S){let T=y.size,A=y.putIfAbsent(S,T);return A??(g.push(S),T)}for(g.push(this.context),y.put(this.context,0);;){let S=g.pop();if(!S)break;for(let T=0;T<S.size;T++)x+="  s"+m(S),x+="->",x+="s"+m(S.getParent(T)),x+='[label="'+S.getReturnState(T)+`"];
`}return x+=`}
`,x.toString()}toString(x,y,g){g==null&&(g=y!=null),y==null&&(y=!0);let m="",S;g?S=this.context.toStrings(x,this.state.stateNumber):S=["?"];let T=!0;for(let A of S)T?T=!1:m+=", ",m+="(",m+=this.state,y&&(m+=",",m+=this.alt),this.context&&(m+=",",m+=A),this.semanticContext!==l.SemanticContext.NONE&&(m+=",",m+=this.semanticContext),this.reachesIntoOuterContext&&(m+=",up="+this.outerContextDepth),m+=")";return m.toString()}};u([n.NotNull],h.prototype,"_state",void 0),u([n.NotNull],h.prototype,"_context",void 0),u([n.NotNull],h.prototype,"state",null),u([n.NotNull,e(0,n.NotNull)],h.prototype,"context",null),u([n.NotNull],h.prototype,"semanticContext",null),u([n.Override],h.prototype,"clone",null),u([e(0,n.NotNull),e(2,n.NotNull)],h.prototype,"transformImpl",null),u([n.Override],h.prototype,"equals",null),u([n.Override],h.prototype,"hashCode",null),u([e(0,n.NotNull),e(3,n.NotNull)],h,"create",null),h=u([e(0,n.NotNull),e(2,n.NotNull)],h),St.ATNConfig=h;let f=class extends h{constructor(x,y,g,m){typeof g=="number"?super(y,g,m):super(y,g,m),this._semanticContext=x}get semanticContext(){return this._semanticContext}};u([n.NotNull],f.prototype,"_semanticContext",void 0),u([n.Override],f.prototype,"semanticContext",null),f=u([e(1,n.NotNull),e(2,n.NotNull)],f);let d=class extends h{constructor(x,y,g,m,S){if(typeof g=="number")super(y,g,m);else if(super(y,g,m),g.semanticContext!==l.SemanticContext.NONE)throw new Error("Not supported");this._lexerActionExecutor=x,this.passedThroughNonGreedyDecision=S}get lexerActionExecutor(){return this._lexerActionExecutor}get hasPassedThroughNonGreedyDecision(){return this.passedThroughNonGreedyDecision}};u([n.Override],d.prototype,"lexerActionExecutor",null),u([n.Override],d.prototype,"hasPassedThroughNonGreedyDecision",null),d=u([e(1,n.NotNull),e(2,n.NotNull)],d);let p=class extends f{constructor(x,y,g,m,S,T){typeof m=="number"?super(y,g,m,S):super(y,g,m,S),this._lexerActionExecutor=x,this.passedThroughNonGreedyDecision=T}get lexerActionExecutor(){return this._lexerActionExecutor}get hasPassedThroughNonGreedyDecision(){return this.passedThroughNonGreedyDecision}};return u([n.Override],p.prototype,"lexerActionExecutor",null),u([n.Override],p.prototype,"hasPassedThroughNonGreedyDecision",null),p=u([e(1,n.NotNull),e(2,n.NotNull)],p),St}var mi={},ac;function wr(){if(ac)return mi;ac=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(mi,"__esModule",{value:!0}),mi.BitSet=void 0;const u=Xn(),e=je(),t=new Uint16Array(0);function i(h){return h>>>4}function s(h){return h*16}function n(h){let f=1;for(let d=0;d<16;d++){if((h&f)!==0)return d;f=f<<1>>>0}throw new RangeError("No specified bit found")}function r(h){let f=32768;for(let d=15;d>=0;d--){if((h&f)!==0)return d;f=f>>>1}throw new RangeError("No specified bit found")}function o(h,f){return h&=15,f&=15,h===f?1<<h>>>0:65535>>>15-f^65535>>>16-h}const l=new Uint8Array(65536);for(let h=0;h<16;h++){const f=1<<h>>>0;let d=0;for(;d<l.length;){d+=f;for(let p=0;p<f;p++)l[d]++,d++}}let c=class Di{constructor(f){if(!f)this.data=t;else if(typeof f=="number"){if(f<0)throw new RangeError("nbits cannot be negative");this.data=new Uint16Array(i(f-1)+1)}else if(f instanceof Di)this.data=f.data.slice(0);else{let d=-1;for(let p of f)d<p&&(d=p);this.data=new Uint16Array(i(d-1)+1);for(let p of f)this.set(p)}}and(f){const d=this.data,p=f.data,v=Math.min(d.length,p.length);let x=-1;for(let y=0;y<v;y++)(d[y]&=p[y])!==0&&(x=y);x===-1&&(this.data=t),x<d.length-1&&(this.data=d.slice(0,x+1))}andNot(f){const d=this.data,p=f.data,v=Math.min(d.length,p.length);let x=-1;for(let y=0;y<v;y++)(d[y]&=p[y]^65535)!==0&&(x=y);x===-1&&(this.data=t),x<d.length-1&&(this.data=d.slice(0,x+1))}cardinality(){if(this.isEmpty)return 0;const f=this.data,d=f.length;let p=0;for(let v=0;v<d;v++)p+=l[f[v]];return p}clear(f,d){f==null?this.data.fill(0):d==null?this.set(f,!1):this.set(f,d,!1)}flip(f,d){if(d==null&&(d=f),f<0||d<f)throw new RangeError;let p=i(f);const v=i(d);if(p===v)this.data[p]^=o(f,d);else{for(this.data[p++]^=o(f,15);p<v;)this.data[p++]^=65535;this.data[p++]^=o(0,d)}}get(f,d){if(d===void 0)return!!(this.data[i(f)]&o(f,f));{let p=new Di(d+1);for(let v=f;v<=d;v++)p.set(v,this.get(v));return p}}intersects(f){let d=Math.min(this.length(),f.length());if(d===0)return!1;let p=i(d-1);for(let v=0;v<=p;v++)if((this.data[v]&f.data[v])!==0)return!0;return!1}get isEmpty(){return this.length()===0}length(){return this.data.length?this.previousSetBit(s(this.data.length)-1)+1:0}nextClearBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let v=i(f);if(v>p)return-1;let x=65535^o(f,15);if((d[v]|x)===65535){for(v++,x=0;v<p&&d[v]===65535;v++);if(v===p)return-1}return s(v)+n((d[v]|x)^65535)}nextSetBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let v=i(f);if(v>p)return-1;let x=o(f,15);if((d[v]&x)===0){for(v++,x=65535;v<p&&d[v]===0;v++);if(v>=p)return-1}return s(v)+n(d[v]&x)}or(f){const d=this.data,p=f.data,v=Math.min(d.length,p.length),x=Math.max(d.length,p.length),y=d.length===x?d:new Uint16Array(x);let g=-1;for(let S=0;S<v;S++)(y[S]=d[S]|p[S])!==0&&(g=S);const m=d.length>p.length?d:p;for(let S=v;S<x;S++)(y[S]=m[S])!==0&&(g=S);g===-1?this.data=t:y.length===g+1?this.data=y:this.data=y.slice(0,g)}previousClearBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let v=i(f);v>=p&&(v=p-1);let x=65535^o(0,f);if((d[v]|x)===65535){for(x=0,v--;v>=0&&d[v]===65535;v--);if(v<0)return-1}return s(v)+r((d[v]|x)^65535)}previousSetBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let v=i(f);v>=p&&(v=p-1);let x=o(0,f);if((d[v]&x)===0){for(v--,x=65535;v>=0&&d[v]===0;v--);if(v<0)return-1}return s(v)+r(d[v]&x)}set(f,d,p){if(d===void 0?(d=f,p=!0):typeof d=="boolean"&&(p=d,d=f),p===void 0&&(p=!0),f<0||f>d)throw new RangeError;let v=i(f),x=i(d);if(p&&x>=this.data.length){let y=new Uint16Array(x+1);this.data.forEach((g,m)=>y[m]=g),this.data=y}else if(!p){if(v>=this.data.length)return;x>=this.data.length&&(x=this.data.length-1,d=this.data.length*16-1)}if(v===x)this._setBits(v,p,o(f,d));else{for(this._setBits(v++,p,o(f,15));v<x;)this.data[v++]=p?65535:0;this._setBits(v,p,o(0,d))}}_setBits(f,d,p){d?this.data[f]|=p:this.data[f]&=65535^p}get size(){return this.data.byteLength*8}hashCode(){return e.MurmurHash.hashCode(this.data,22)}equals(f){if(f===this)return!0;if(!(f instanceof Di))return!1;const d=this.length();if(d!==f.length())return!1;if(d===0)return!0;let p=i(d-1);for(let v=0;v<=p;v++)if(this.data[v]!==f.data[v])return!1;return!0}toString(){let f="{",d=!0;for(let p=this.nextSetBit(0);p>=0;p=this.nextSetBit(p+1))d?d=!1:f+=", ",f+=p;return f+="}",f}xor(f){const d=this.data,p=f.data,v=Math.min(d.length,p.length),x=Math.max(d.length,p.length),y=d.length===x?d:new Uint16Array(x);let g=-1;for(let S=0;S<v;S++)(y[S]=d[S]^p[S])!==0&&(g=S);const m=d.length>p.length?d:p;for(let S=v;S<x;S++)(y[S]=m[S])!==0&&(g=S);g===-1?this.data=t:y.length===g+1?this.data=y:this.data=y.slice(0,g+1)}clone(){return new Di(this)}[Symbol.iterator](){return new a(this.data)}[u.inspect.custom](){return"BitSet "+this.toString()}};mi.BitSet=c;class a{constructor(f){this.data=f,this.index=0,this.mask=65535}next(){for(;this.index<this.data.length;){const f=this.data[this.index]&this.mask;if(f!==0){const d=s(this.index)+n(f);return this.mask=o(d+1,15),{done:!1,value:d}}this.index++,this.mask=65535}return{done:!0,value:-1}}[Symbol.iterator](){return this}}return mi}var uc;function Ui(){if(uc)return Vr;uc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Vr&&Vr.__decorate||function(y,g,m,S){var T=arguments.length,A=T<3?g:S===null?S=Object.getOwnPropertyDescriptor(g,m):S,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(y,g,m,S);else for(var N=y.length-1;N>=0;N--)(b=y[N])&&(A=(T<3?b(A):T>3?b(g,m,A):b(g,m))||A);return T>3&&A&&Object.defineProperty(g,m,A),A};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.ATNConfigSet=void 0;const e=ni(),t=Rr(),i=mo(),s=ct(),n=vo(),r=wr(),o=J(),l=ut(),c=it(),a=$l(),h=ri(),f=$e(),d=xr();class p{hashCode(g){return g.state^g.alt}equals(g,m){return g.state===m.state&&g.alt===m.alt}}p.INSTANCE=new p;function v(y){return y?new e.Array2DHashMap(y):new e.Array2DHashMap(p.INSTANCE)}let x=class Sl{constructor(g,m){this._uniqueAlt=0,this._hasSemanticContext=!1,this._dipsIntoOuterContext=!1,this.outermostConfigSet=!1,this.cachedHashCode=-1,g?(m?(this.mergedConfigs=void 0,this.unmerged=void 0):g.isReadOnly?(this.mergedConfigs=v(),this.unmerged=[]):(this.mergedConfigs=v(g.mergedConfigs),this.unmerged=g.unmerged.slice(0)),this.configs=g.configs.slice(0),this._dipsIntoOuterContext=g._dipsIntoOuterContext,this._hasSemanticContext=g._hasSemanticContext,this.outermostConfigSet=g.outermostConfigSet,(m||!g.isReadOnly)&&(this._uniqueAlt=g._uniqueAlt,this._conflictInfo=g._conflictInfo)):(this.mergedConfigs=v(),this.unmerged=[],this.configs=[],this._uniqueAlt=s.ATN.INVALID_ALT_NUMBER)}getRepresentedAlternatives(){if(this._conflictInfo!=null)return this._conflictInfo.conflictedAlts.clone();let g=new r.BitSet;for(let m of this)g.set(m.alt);return g}get isReadOnly(){return this.mergedConfigs==null}get isOutermostConfigSet(){return this.outermostConfigSet}set isOutermostConfigSet(g){if(this.outermostConfigSet&&!g)throw new Error("IllegalStateException");f(!g||!this._dipsIntoOuterContext),this.outermostConfigSet=g}getStates(){let g=new t.Array2DHashSet(l.ObjectEqualityComparator.INSTANCE);for(let m of this.configs)g.add(m.state);return g}optimizeConfigs(g){if(this.configs.length!==0)for(let m of this.configs)m.context=g.atn.getCachedContext(m.context)}clone(g){let m=new Sl(this,g);return!g&&this.isReadOnly&&m.addAll(this.configs),m}get size(){return this.configs.length}get isEmpty(){return this.configs.length===0}contains(g){if(!(g instanceof n.ATNConfig))return!1;if(this.mergedConfigs&&this.unmerged){let m=g,S=this.getKey(m),T=this.mergedConfigs.get(S);if(T!=null&&this.canMerge(m,S,T))return T.contains(m);for(let A of this.unmerged)if(A.contains(g))return!0}else for(let m of this.configs)if(m.contains(g))return!0;return!1}*[Symbol.iterator](){yield*this.configs}toArray(){return this.configs}add(g,m){if(this.ensureWritable(),!this.mergedConfigs||!this.unmerged)throw new Error("Covered by ensureWritable but duplicated here for strict null check limitation");f(!this.outermostConfigSet||!g.reachesIntoOuterContext),m==null&&(m=a.PredictionContextCache.UNCACHED);let S,T=this.getKey(g),A=this.mergedConfigs.get(T);if(S=A==null,A!=null&&this.canMerge(g,T,A)){A.outerContextDepth=Math.max(A.outerContextDepth,g.outerContextDepth),g.isPrecedenceFilterSuppressed&&(A.isPrecedenceFilterSuppressed=!0);let b=c.PredictionContext.join(A.context,g.context,m);return this.updatePropertiesForMergedConfig(g),A.context===b?!1:(A.context=b,!0)}for(let b=0;b<this.unmerged.length;b++){let N=this.unmerged[b];if(this.canMerge(g,T,N)){N.outerContextDepth=Math.max(N.outerContextDepth,g.outerContextDepth),g.isPrecedenceFilterSuppressed&&(N.isPrecedenceFilterSuppressed=!0);let R=c.PredictionContext.join(N.context,g.context,m);return this.updatePropertiesForMergedConfig(g),N.context===R?!1:(N.context=R,S&&(this.mergedConfigs.put(T,N),this.unmerged.splice(b,1)),!0)}}return this.configs.push(g),S?this.mergedConfigs.put(T,g):this.unmerged.push(g),this.updatePropertiesForAddedConfig(g),!0}updatePropertiesForMergedConfig(g){this._dipsIntoOuterContext=this._dipsIntoOuterContext||g.reachesIntoOuterContext,f(!this.outermostConfigSet||!this._dipsIntoOuterContext)}updatePropertiesForAddedConfig(g){this.configs.length===1?this._uniqueAlt=g.alt:this._uniqueAlt!==g.alt&&(this._uniqueAlt=s.ATN.INVALID_ALT_NUMBER),this._hasSemanticContext=this._hasSemanticContext||!h.SemanticContext.NONE.equals(g.semanticContext),this._dipsIntoOuterContext=this._dipsIntoOuterContext||g.reachesIntoOuterContext,f(!this.outermostConfigSet||!this._dipsIntoOuterContext)}canMerge(g,m,S){return g.state.stateNumber!==S.state.stateNumber||m.alt!==S.alt?!1:g.semanticContext.equals(S.semanticContext)}getKey(g){return{state:g.state.stateNumber,alt:g.alt}}containsAll(g){for(let m of g)if(!(m instanceof n.ATNConfig)||!this.contains(m))return!1;return!0}addAll(g,m){this.ensureWritable();let S=!1;for(let T of g)this.add(T,m)&&(S=!0);return S}clear(){if(this.ensureWritable(),!this.mergedConfigs||!this.unmerged)throw new Error("Covered by ensureWritable but duplicated here for strict null check limitation");this.mergedConfigs.clear(),this.unmerged.length=0,this.configs.length=0,this._dipsIntoOuterContext=!1,this._hasSemanticContext=!1,this._uniqueAlt=s.ATN.INVALID_ALT_NUMBER,this._conflictInfo=void 0}equals(g){return this===g?!0:g instanceof Sl?this.outermostConfigSet===g.outermostConfigSet&&d.equals(this._conflictInfo,g._conflictInfo)&&i.ArrayEqualityComparator.INSTANCE.equals(this.configs,g.configs):!1}hashCode(){if(this.isReadOnly&&this.cachedHashCode!==-1)return this.cachedHashCode;let g=1;return g=5*g^(this.outermostConfigSet?1:0),g=5*g^i.ArrayEqualityComparator.INSTANCE.hashCode(this.configs),this.isReadOnly&&(this.cachedHashCode=g),g}toString(g){g==null&&(g=!1);let m="",S=this.configs.slice(0);S.sort((T,A)=>T.alt!==A.alt?T.alt-A.alt:T.state.stateNumber!==A.state.stateNumber?T.state.stateNumber-A.state.stateNumber:T.semanticContext.toString().localeCompare(A.semanticContext.toString())),m+="[";for(let T=0;T<S.length;T++)T>0&&(m+=", "),m+=S[T].toString(void 0,!0,g);return m+="]",this._hasSemanticContext&&(m+=",hasSemanticContext="+this._hasSemanticContext),this._uniqueAlt!==s.ATN.INVALID_ALT_NUMBER&&(m+=",uniqueAlt="+this._uniqueAlt),this._conflictInfo!=null&&(m+=",conflictingAlts="+this._conflictInfo.conflictedAlts,this._conflictInfo.isExact||(m+="*")),this._dipsIntoOuterContext&&(m+=",dipsIntoOuterContext"),m.toString()}get uniqueAlt(){return this._uniqueAlt}get hasSemanticContext(){return this._hasSemanticContext}set hasSemanticContext(g){this.ensureWritable(),this._hasSemanticContext=g}get conflictInfo(){return this._conflictInfo}set conflictInfo(g){this.ensureWritable(),this._conflictInfo=g}get conflictingAlts(){if(this._conflictInfo!=null)return this._conflictInfo.conflictedAlts}get isExactConflict(){return this._conflictInfo==null?!1:this._conflictInfo.isExact}get dipsIntoOuterContext(){return this._dipsIntoOuterContext}get(g){return this.configs[g]}ensureWritable(){if(this.isReadOnly)throw new Error("This ATNConfigSet is read only.")}};return u([o.NotNull],x.prototype,"getRepresentedAlternatives",null),u([o.Override],x.prototype,"size",null),u([o.Override],x.prototype,"isEmpty",null),u([o.Override],x.prototype,"contains",null),u([o.Override],x.prototype,Symbol.iterator,null),u([o.Override],x.prototype,"toArray",null),u([o.Override],x.prototype,"containsAll",null),u([o.Override],x.prototype,"clear",null),u([o.Override],x.prototype,"equals",null),u([o.Override],x.prototype,"hashCode",null),Vr.ATNConfigSet=x,Vr}var Gr={},Yr={},Xr={},cc;function So(){return cc||(cc=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Xr&&Xr.__decorate||function(a,h,f,d){var p=arguments.length,v=p<3?h:d===null?d=Object.getOwnPropertyDescriptor(h,f):d,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(a,h,f,d);else for(var y=a.length-1;y>=0;y--)(x=a[y])&&(v=(p<3?x(v):p>3?x(h,f,v):x(h,f))||v);return p>3&&v&&Object.defineProperty(h,f,v),v},t=Xr&&Xr.__param||function(a,h){return function(f,d){h(f,d,a)}};Object.defineProperty(u,"__esModule",{value:!0}),u.DFAState=void 0;const i=ct(),s=wr(),n=je(),r=J(),o=it(),l=$e();let c=class cd{constructor(h){this.stateNumber=-1,this.configs=h,this.edges=new Map,this.contextEdges=new Map}get isContextSensitive(){return!!this.contextSymbols}isContextSymbol(h){return this.isContextSensitive?this.contextSymbols.get(h):!1}setContextSymbol(h){l(this.isContextSensitive),this.contextSymbols.set(h)}setContextSensitive(h){l(!this.configs.isOutermostConfigSet),!this.isContextSensitive&&(this.contextSymbols||(this.contextSymbols=new s.BitSet))}get acceptStateInfo(){return this._acceptStateInfo}set acceptStateInfo(h){this._acceptStateInfo=h}get isAcceptState(){return!!this._acceptStateInfo}get prediction(){return this._acceptStateInfo?this._acceptStateInfo.prediction:i.ATN.INVALID_ALT_NUMBER}get lexerActionExecutor(){if(this._acceptStateInfo)return this._acceptStateInfo.lexerActionExecutor}getTarget(h){return this.edges.get(h)}setTarget(h,f){this.edges.set(h,f)}getEdgeMap(){return this.edges}getContextTarget(h){return h===o.PredictionContext.EMPTY_FULL_STATE_KEY&&(h=-1),this.contextEdges.get(h)}setContextTarget(h,f){if(!this.isContextSensitive)throw new Error("The state is not context sensitive.");h===o.PredictionContext.EMPTY_FULL_STATE_KEY&&(h=-1),this.contextEdges.set(h,f)}getContextEdgeMap(){let h=new Map(this.contextEdges),f=h.get(-1);if(f!==void 0)if(h.size===1){let d=new Map;return d.set(o.PredictionContext.EMPTY_FULL_STATE_KEY,f),d}else h.delete(-1),h.set(o.PredictionContext.EMPTY_FULL_STATE_KEY,f);return h}hashCode(){let h=n.MurmurHash.initialize(7);return h=n.MurmurHash.update(h,this.configs.hashCode()),h=n.MurmurHash.finish(h,1),h}equals(h){if(this===h)return!0;if(!(h instanceof cd))return!1;let f=h;return this.configs.equals(f.configs)}toString(){let h="";return h+=this.stateNumber+":"+this.configs,this.isAcceptState&&(h+="=>",this.predicates?h+=this.predicates:h+=this.prediction),h.toString()}};e([r.NotNull],c.prototype,"configs",void 0),e([r.NotNull],c.prototype,"edges",void 0),e([r.NotNull],c.prototype,"contextEdges",void 0),e([r.Override],c.prototype,"hashCode",null),e([r.Override],c.prototype,"equals",null),e([r.Override],c.prototype,"toString",null),u.DFAState=c,function(a){let h=class{constructor(d,p){this.alt=p,this.pred=d}toString(){return"("+this.pred+", "+this.alt+")"}};e([r.NotNull],h.prototype,"pred",void 0),e([r.Override],h.prototype,"toString",null),h=e([t(0,r.NotNull)],h),a.PredPrediction=h}(c=u.DFAState||(u.DFAState={}))}(Xr)),Xr}var hc;function Ao(){return hc||(hc=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Yr&&Yr.__decorate||function(l,c,a,h){var f=arguments.length,d=f<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,a):h,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(l,c,a,h);else for(var v=l.length-1;v>=0;v--)(p=l[v])&&(d=(f<3?p(d):f>3?p(c,a,d):p(c,a))||d);return f>3&&d&&Object.defineProperty(c,a,d),d},t=Yr&&Yr.__param||function(l,c){return function(a,h){c(a,h,l)}};Object.defineProperty(u,"__esModule",{value:!0}),u.ATNSimulator=void 0;const i=Ui(),s=So(),n=J(),r=it();let o=class Ii{constructor(c){this.atn=c}static get ERROR(){return Ii._ERROR||(Ii._ERROR=new s.DFAState(new i.ATNConfigSet),Ii._ERROR.stateNumber=r.PredictionContext.EMPTY_FULL_STATE_KEY),Ii._ERROR}clearDFA(){this.atn.clearDFA()}};e([n.NotNull],o.prototype,"atn",void 0),e([n.NotNull],o,"ERROR",null),o=e([t(0,n.NotNull)],o),u.ATNSimulator=o,o=u.ATNSimulator||(u.ATNSimulator={}),u.ATNSimulator=o}(Yr)),Yr}var At={},gi={},fc;function hd(){if(fc)return gi;fc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(gi,"__esModule",{value:!0}),gi.ConsoleErrorListener=void 0;let u=class{syntaxError(t,i,s,n,r,o){console.error(`line ${s}:${n} ${r}`)}};return gi.ConsoleErrorListener=u,u.INSTANCE=new u,gi}var Ct={},dc;function Vl(){if(dc)return Ct;dc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Ct&&Ct.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c},e=Ct&&Ct.__param||function(s,n){return function(r,o){n(r,o,s)}};Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.ProxyErrorListener=void 0;const t=J();let i=class{constructor(n){if(this.delegates=n,!n)throw new Error("Invalid delegates")}getDelegates(){return this.delegates}syntaxError(n,r,o,l,c,a){this.delegates.forEach(h=>{h.syntaxError&&h.syntaxError(n,r,o,l,c,a)})}};return u([t.Override,e(0,t.NotNull),e(4,t.NotNull)],i.prototype,"syntaxError",null),Ct.ProxyErrorListener=i,Ct}var pc;function Hi(){if(pc)return At;pc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=At&&At.__decorate||function(l,c,a,h){var f=arguments.length,d=f<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,a):h,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(l,c,a,h);else for(var v=l.length-1;v>=0;v--)(p=l[v])&&(d=(f<3?p(d):f>3?p(c,a,d):p(c,a))||d);return f>3&&d&&Object.defineProperty(c,a,d),d},e=At&&At.__param||function(l,c){return function(a,h){c(a,h,l)}};Object.defineProperty(At,"__esModule",{value:!0}),At.Recognizer=void 0;const t=hd(),i=Vl(),s=J(),n=Be(),r=xr();let o=class Li{constructor(){this._listeners=[t.ConsoleErrorListener.INSTANCE],this._stateNumber=-1}getTokenTypeMap(){let c=this.vocabulary,a=Li.tokenTypeMapCache.get(c);if(a==null){let h=new Map;for(let f=0;f<=this.atn.maxTokenType;f++){let d=c.getLiteralName(f);d!=null&&h.set(d,f);let p=c.getSymbolicName(f);p!=null&&h.set(p,f)}h.set("EOF",n.Token.EOF),a=h,Li.tokenTypeMapCache.set(c,a)}return a}getRuleIndexMap(){let c=this.ruleNames;if(c==null)throw new Error("The current recognizer does not provide a list of rule names.");let a=Li.ruleIndexMapCache.get(c);return a==null&&(a=r.toMap(c),Li.ruleIndexMapCache.set(c,a)),a}getTokenType(c){let a=this.getTokenTypeMap().get(c);return a??n.Token.INVALID_TYPE}get serializedATN(){throw new Error("there is no serialized ATN")}get atn(){return this._interp.atn}get interpreter(){return this._interp}set interpreter(c){this._interp=c}get parseInfo(){return Promise.resolve(void 0)}getErrorHeader(c){let a=c.getOffendingToken();if(!a)return"";let h=a.line,f=a.charPositionInLine;return"line "+h+":"+f}addErrorListener(c){if(!c)throw new TypeError("listener must not be null");this._listeners.push(c)}removeErrorListener(c){let a=this._listeners.indexOf(c);a!==-1&&this._listeners.splice(a,1)}removeErrorListeners(){this._listeners.length=0}getErrorListeners(){return this._listeners.slice(0)}getErrorListenerDispatch(){return new i.ProxyErrorListener(this.getErrorListeners())}sempred(c,a,h){return!0}precpred(c,a){return!0}action(c,a,h){}get state(){return this._stateNumber}set state(c){this._stateNumber=c}};return o.EOF=-1,o.tokenTypeMapCache=new WeakMap,o.ruleIndexMapCache=new WeakMap,u([s.SuppressWarnings("serial"),s.NotNull],o.prototype,"_listeners",void 0),u([s.NotNull],o.prototype,"getTokenTypeMap",null),u([s.NotNull],o.prototype,"getRuleIndexMap",null),u([s.NotNull],o.prototype,"serializedATN",null),u([s.NotNull],o.prototype,"atn",null),u([s.NotNull,e(0,s.NotNull)],o.prototype,"interpreter",null),u([s.NotNull,e(0,s.NotNull)],o.prototype,"getErrorHeader",null),u([e(0,s.NotNull)],o.prototype,"addErrorListener",null),u([e(0,s.NotNull)],o.prototype,"removeErrorListener",null),u([s.NotNull],o.prototype,"getErrorListeners",null),At.Recognizer=o,At}var Kr={},xc;function Hn(){if(xc)return Kr;xc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Kr&&Kr.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c};Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.VocabularyImpl=void 0;const e=J(),t=Be();let i=class{constructor(n,r,o){this.literalNames=n,this.symbolicNames=r,this.displayNames=o,this._maxTokenType=Math.max(this.displayNames.length,Math.max(this.literalNames.length,this.symbolicNames.length))-1}get maxTokenType(){return this._maxTokenType}getLiteralName(n){if(n>=0&&n<this.literalNames.length)return this.literalNames[n]}getSymbolicName(n){if(n>=0&&n<this.symbolicNames.length)return this.symbolicNames[n];if(n===t.Token.EOF)return"EOF"}getDisplayName(n){if(n>=0&&n<this.displayNames.length){let l=this.displayNames[n];if(l)return l}let r=this.getLiteralName(n);if(r)return r;let o=this.getSymbolicName(n);return o||String(n)}};return i.EMPTY_VOCABULARY=new i([],[],[]),u([e.NotNull],i.prototype,"literalNames",void 0),u([e.NotNull],i.prototype,"symbolicNames",void 0),u([e.NotNull],i.prototype,"displayNames",void 0),u([e.Override],i.prototype,"maxTokenType",null),u([e.Override],i.prototype,"getLiteralName",null),u([e.Override],i.prototype,"getSymbolicName",null),u([e.Override,e.NotNull],i.prototype,"getDisplayName",null),u([e.NotNull],i,"EMPTY_VOCABULARY",void 0),Kr.VocabularyImpl=i,Kr}var mc;function fd(){if(mc)return Gr;mc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Gr&&Gr.__decorate||function(o,l,c,a){var h=arguments.length,f=h<3?l:a===null?a=Object.getOwnPropertyDescriptor(l,c):a,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,l,c,a);else for(var p=o.length-1;p>=0;p--)(d=o[p])&&(f=(h<3?d(f):h>3?d(l,c,f):d(l,c))||f);return h>3&&f&&Object.defineProperty(l,c,f),f};Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.DFASerializer=void 0;const e=Ao(),t=J(),i=it(),s=Hi(),n=Hn();let r=class{constructor(l,c,a,h){c instanceof s.Recognizer?(a=c.ruleNames,h=c.atn,c=c.vocabulary):c||(c=n.VocabularyImpl.EMPTY_VOCABULARY),this.dfa=l,this.vocabulary=c,this.ruleNames=a,this.atn=h}toString(){if(!this.dfa.s0)return"";let l="";if(this.dfa.states){let a=new Array(...this.dfa.states.toArray());a.sort((h,f)=>h.stateNumber-f.stateNumber);for(let h of a){let f=h.getEdgeMap(),d=[...f.keys()].sort((x,y)=>x-y),p=h.getContextEdgeMap(),v=[...p.keys()].sort((x,y)=>x-y);for(let x of d){let y=f.get(x);if((y==null||y===e.ATNSimulator.ERROR)&&!h.isContextSymbol(x))continue;let g=!1;l+=this.getStateString(h)+"-"+this.getEdgeLabel(x)+"->",h.isContextSymbol(x)&&(l+="!",g=!0);let m=y;m&&m.stateNumber!==e.ATNSimulator.ERROR.stateNumber?l+=this.getStateString(m)+`
`:g&&(l+=`ctx
`)}if(h.isContextSensitive)for(let x of v)l+=this.getStateString(h)+"-"+this.getContextLabel(x)+"->"+this.getStateString(p.get(x))+`
`}}let c=l;return c.length===0?"":c}getContextLabel(l){if(l===i.PredictionContext.EMPTY_FULL_STATE_KEY)return"ctx:EMPTY_FULL";if(l===i.PredictionContext.EMPTY_LOCAL_STATE_KEY)return"ctx:EMPTY_LOCAL";if(this.atn&&l>0&&l<=this.atn.states.length){let a=this.atn.states[l].ruleIndex;if(this.ruleNames&&a>=0&&a<this.ruleNames.length)return"ctx:"+String(l)+"("+this.ruleNames[a]+")"}return"ctx:"+String(l)}getEdgeLabel(l){return this.vocabulary.getDisplayName(l)}getStateString(l){if(l===e.ATNSimulator.ERROR)return"ERROR";let c=l.stateNumber,a="s"+c;if(l.isAcceptState&&(l.predicates?a=":s"+c+"=>"+l.predicates:a=":s"+c+"=>"+l.prediction),l.isContextSensitive){a+="*";for(let h of l.configs)if(h.reachesIntoOuterContext){a+="*";break}}return a}};return u([t.NotNull],r.prototype,"dfa",void 0),u([t.NotNull],r.prototype,"vocabulary",void 0),u([t.Override],r.prototype,"toString",null),Gr.DFASerializer=r,Gr}var Et={},gc;function o0(){if(gc)return Et;gc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Et&&Et.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=Et&&Et.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(Et,"__esModule",{value:!0}),Et.LexerDFASerializer=void 0;const t=fd(),i=J(),s=Hn();let n=class extends t.DFASerializer{constructor(o){super(o,s.VocabularyImpl.EMPTY_VOCABULARY)}getEdgeLabel(o){return"'"+String.fromCodePoint(o)+"'"}};return u([i.Override,i.NotNull],n.prototype,"getEdgeLabel",null),n=u([e(0,i.NotNull)],n),Et.LexerDFASerializer=n,Et}var Qr={},yc;function Wl(){if(yc)return Qr;yc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Qr&&Qr.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h};Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.StarLoopEntryState=void 0;const e=Ue(),t=wr(),i=Un(),s=J();let n=class extends i.DecisionState{constructor(){super(...arguments),this.precedenceRuleDecision=!1,this.precedenceLoopbackStates=new t.BitSet}get stateType(){return e.ATNStateType.STAR_LOOP_ENTRY}};return u([s.Override],n.prototype,"stateType",null),Qr.StarLoopEntryState=n,Qr}var vc;function dd(){if(vc)return vt;vc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=vt&&vt.__decorate||function(f,d,p,v){var x=arguments.length,y=x<3?d:v===null?v=Object.getOwnPropertyDescriptor(d,p):v,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(f,d,p,v);else for(var m=f.length-1;m>=0;m--)(g=f[m])&&(y=(x<3?g(y):x>3?g(d,p,y):g(d,p))||y);return x>3&&y&&Object.defineProperty(d,p,y),y},e=vt&&vt.__param||function(f,d){return function(p,v){d(p,v,f)}};Object.defineProperty(vt,"__esModule",{value:!0}),vt.DFA=void 0;const t=Rr(),i=Ui(),s=fd(),n=So(),r=o0(),o=J(),l=ut(),c=Wl(),a=Hn();let h=class{constructor(d,p=0){if(this.states=new t.Array2DHashSet(l.ObjectEqualityComparator.INSTANCE),this.nextStateNumber=0,!d.atn)throw new Error("The ATNState must be associated with an ATN");this.atnStartState=d,this.atn=d.atn,this.decision=p;let v=!1;d instanceof c.StarLoopEntryState&&d.precedenceRuleDecision&&(v=!0,this.s0=new n.DFAState(new i.ATNConfigSet),this.s0full=new n.DFAState(new i.ATNConfigSet)),this.precedenceDfa=v}get isPrecedenceDfa(){return this.precedenceDfa}getPrecedenceStartState(d,p){if(!this.isPrecedenceDfa)throw new Error("Only precedence DFAs may contain a precedence start state.");return p?this.s0full.getTarget(d):this.s0.getTarget(d)}setPrecedenceStartState(d,p,v){if(!this.isPrecedenceDfa)throw new Error("Only precedence DFAs may contain a precedence start state.");d<0||(p?this.s0full.setTarget(d,v):this.s0.setTarget(d,v))}get isEmpty(){return this.isPrecedenceDfa?this.s0.getEdgeMap().size===0&&this.s0full.getEdgeMap().size===0:this.s0==null&&this.s0full==null}get isContextSensitive(){return this.isPrecedenceDfa?this.s0full.getEdgeMap().size>0:this.s0full!=null}addState(d){return d.stateNumber=this.nextStateNumber++,this.states.getOrAdd(d)}toString(d,p){if(d||(d=a.VocabularyImpl.EMPTY_VOCABULARY),!this.s0)return"";let v;return p?v=new s.DFASerializer(this,d,p,this.atnStartState.atn):v=new s.DFASerializer(this,d),v.toString()}toLexerString(){return this.s0?new r.LexerDFASerializer(this).toString():""}};return u([o.NotNull],h.prototype,"states",void 0),u([o.NotNull],h.prototype,"atnStartState",void 0),u([o.NotNull],h.prototype,"atn",void 0),h=u([e(0,o.NotNull)],h),vt.DFA=h,vt}var Jr={},Zr={},Sc;function pd(){if(Sc)return Zr;Sc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Zr&&Zr.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.BasicState=void 0;const e=pr(),t=Ue(),i=J();let s=class extends e.ATNState{get stateType(){return t.ATNStateType.BASIC}};return u([i.Override],s.prototype,"stateType",null),Zr.BasicState=s,Zr}var Ac;function xd(){if(Ac)return Jr;Ac=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Jr&&Jr.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.InvalidState=void 0;const e=Ue(),t=pd(),i=J();let s=class extends t.BasicState{get stateType(){return e.ATNStateType.INVALID_TYPE}};return u([i.Override],s.prototype,"stateType",null),Jr.InvalidState=s,Jr}var _t={},Tt={},bt={},Cc;function Gl(){if(Cc)return bt;Cc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=bt&&bt.__decorate||function(o,l,c,a){var h=arguments.length,f=h<3?l:a===null?a=Object.getOwnPropertyDescriptor(l,c):a,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,l,c,a);else for(var p=o.length-1;p>=0;p--)(d=o[p])&&(f=(h<3?d(f):h>3?d(l,c,f):d(l,c))||f);return h>3&&f&&Object.defineProperty(l,c,f),f},e=bt&&bt.__param||function(o,l){return function(c,a){l(c,a,o)}};Object.defineProperty(bt,"__esModule",{value:!0}),bt.SetTransition=void 0;const t=$n(),i=J(),s=Be(),n=Nr();let r=class extends n.Transition{constructor(l,c){super(l),c==null&&(c=t.IntervalSet.of(s.Token.INVALID_TYPE)),this.set=c}get serializationType(){return 7}get label(){return this.set}matches(l,c,a){return this.set.contains(l)}toString(){return this.set.toString()}};return u([i.NotNull],r.prototype,"set",void 0),u([i.Override],r.prototype,"serializationType",null),u([i.Override,i.NotNull],r.prototype,"label",null),u([i.Override],r.prototype,"matches",null),u([i.Override,i.NotNull],r.prototype,"toString",null),r=u([e(0,i.NotNull),e(1,i.Nullable)],r),bt.SetTransition=r,bt}var Ec;function Yl(){if(Ec)return Tt;Ec=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Tt&&Tt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Tt&&Tt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.NotSetTransition=void 0;const t=J(),i=Gl();let s=class extends i.SetTransition{constructor(r,o){super(r,o)}get serializationType(){return 8}matches(r,o,l){return r>=o&&r<=l&&!super.matches(r,o,l)}toString(){return"~"+super.toString()}};return u([t.Override],s.prototype,"serializationType",null),u([t.Override],s.prototype,"matches",null),u([t.Override],s.prototype,"toString",null),s=u([e(0,t.NotNull),e(1,t.Nullable)],s),Tt.NotSetTransition=s,Tt}var en={},_c;function $i(){if(_c)return en;_c=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=en&&en.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(en,"__esModule",{value:!0}),en.RuleStopState=void 0;const e=pr(),t=Ue(),i=J();let s=class extends e.ATNState{get nonStopStateNumber(){return-1}get stateType(){return t.ATNStateType.RULE_STOP}};return u([i.Override],s.prototype,"nonStopStateNumber",null),u([i.Override],s.prototype,"stateType",null),en.RuleStopState=s,en}var Nt={},Tc;function Xl(){if(Tc)return Nt;Tc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Nt&&Nt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Nt&&Nt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.RuleTransition=void 0;const t=J(),i=Nr();let s=class extends i.Transition{constructor(r,o,l,c){super(r),this.tailCall=!1,this.optimizedTailCall=!1,this.ruleIndex=o,this.precedence=l,this.followState=c}get serializationType(){return 3}get isEpsilon(){return!0}matches(r,o,l){return!1}};return u([t.NotNull],s.prototype,"followState",void 0),u([t.Override],s.prototype,"serializationType",null),u([t.Override],s.prototype,"isEpsilon",null),u([t.Override],s.prototype,"matches",null),s=u([e(0,t.NotNull),e(3,t.NotNull)],s),Nt.RuleTransition=s,Nt}var Rt={},bc;function md(){if(bc)return Rt;bc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Rt&&Rt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Rt&&Rt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.WildcardTransition=void 0;const t=J(),i=Nr();let s=class extends i.Transition{constructor(r){super(r)}get serializationType(){return 9}matches(r,o,l){return r>=o&&r<=l}toString(){return"."}};return u([t.Override],s.prototype,"serializationType",null),u([t.Override],s.prototype,"matches",null),u([t.Override,t.NotNull],s.prototype,"toString",null),s=u([e(0,t.NotNull)],s),Rt.WildcardTransition=s,Rt}var Nc;function s0(){if(Nc)return _t;Nc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=_t&&_t.__decorate||function(x,y,g,m){var S=arguments.length,T=S<3?y:m===null?m=Object.getOwnPropertyDescriptor(y,g):m,A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(x,y,g,m);else for(var b=x.length-1;b>=0;b--)(A=x[b])&&(T=(S<3?A(T):S>3?A(y,g,T):A(y,g))||T);return S>3&&T&&Object.defineProperty(y,g,T),T},e=_t&&_t.__param||function(x,y){return function(g,m){y(g,m,x)}};Object.defineProperty(_t,"__esModule",{value:!0}),_t.LL1Analyzer=void 0;const t=jl(),i=Rr(),s=vo(),n=wr(),r=$n(),o=J(),l=Yl(),c=ut(),a=it(),h=$i(),f=Xl(),d=Be(),p=md();let v=class Al{constructor(y){this.atn=y}getDecisionLookahead(y){if(y==null)return;let g=new Array(y.numberOfTransitions);for(let m=0;m<y.numberOfTransitions;m++){let S=new r.IntervalSet;g[m]=S;let T=new i.Array2DHashSet(c.ObjectEqualityComparator.INSTANCE);this._LOOK(y.transition(m).target,void 0,a.PredictionContext.EMPTY_LOCAL,S,T,new n.BitSet,!1,!1),(S.size===0||S.contains(Al.HIT_PRED))&&(S=void 0,g[m]=S)}return g}LOOK(y,g,m){if(m===void 0){if(y.atn==null)throw new Error("Illegal state");m=y.atn.ruleToStopState[y.ruleIndex]}else m===null&&(m=void 0);let S=new r.IntervalSet;return this._LOOK(y,m,g,S,new i.Array2DHashSet,new n.BitSet,!0,!0),S}_LOOK(y,g,m,S,T,A,b,N){let R=s.ATNConfig.create(y,0,m);if(!T.add(R))return;if(y===g){if(a.PredictionContext.isEmptyLocal(m)){S.add(d.Token.EPSILON);return}else if(m.isEmpty){N&&S.add(d.Token.EOF);return}}if(y instanceof h.RuleStopState){if(m.isEmpty&&!a.PredictionContext.isEmptyLocal(m)){N&&S.add(d.Token.EOF);return}let I=A.get(y.ruleIndex);try{A.clear(y.ruleIndex);for(let B=0;B<m.size;B++){if(m.getReturnState(B)===a.PredictionContext.EMPTY_FULL_STATE_KEY)continue;let V=this.atn.states[m.getReturnState(B)];this._LOOK(V,g,m.getParent(B),S,T,A,b,N)}}finally{I&&A.set(y.ruleIndex)}}let P=y.numberOfTransitions;for(let I=0;I<P;I++){let B=y.transition(I);if(B instanceof f.RuleTransition){if(A.get(B.ruleIndex))continue;let V=m.getChild(B.followState.stateNumber);try{A.set(B.ruleIndex),this._LOOK(B.target,g,V,S,T,A,b,N)}finally{A.clear(B.ruleIndex)}}else if(B instanceof t.AbstractPredicateTransition)b?this._LOOK(B.target,g,m,S,T,A,b,N):S.add(Al.HIT_PRED);else if(B.isEpsilon)this._LOOK(B.target,g,m,S,T,A,b,N);else if(B instanceof p.WildcardTransition)S.addAll(r.IntervalSet.of(d.Token.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType));else{let V=B.label;V!=null&&(B instanceof l.NotSetTransition&&(V=V.complement(r.IntervalSet.of(d.Token.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType))),S.addAll(V))}}}};return v.HIT_PRED=d.Token.INVALID_TYPE,u([o.NotNull],v.prototype,"atn",void 0),u([o.NotNull,e(0,o.NotNull),e(1,o.NotNull)],v.prototype,"LOOK",null),u([e(0,o.NotNull),e(2,o.NotNull),e(3,o.NotNull),e(4,o.NotNull),e(5,o.NotNull)],v.prototype,"_LOOK",null),v=u([e(0,o.NotNull)],v),_t.LL1Analyzer=v,_t}var Rc;function ct(){return Rc||(Rc=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=$r&&$r.__decorate||function(p,v,x,y){var g=arguments.length,m=g<3?v:y===null?y=Object.getOwnPropertyDescriptor(v,x):y,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(p,v,x,y);else for(var T=p.length-1;T>=0;T--)(S=p[T])&&(m=(g<3?S(m):g>3?S(v,x,m):S(v,x))||m);return g>3&&m&&Object.defineProperty(v,x,m),m},t=$r&&$r.__param||function(p,v){return function(x,y){v(x,y,p)}};Object.defineProperty(u,"__esModule",{value:!0}),u.ATN=void 0;const i=ni(),s=dd(),n=$n(),r=xd(),o=s0(),l=J(),c=ut(),a=it(),h=Be(),f=$e();let d=class{constructor(v,x){this.states=[],this.decisionToState=[],this.modeNameToStartState=new Map,this.modeToStartState=[],this.contextCache=new i.Array2DHashMap(c.ObjectEqualityComparator.INSTANCE),this.decisionToDFA=[],this.modeToDFA=[],this.LL1Table=new Map,this.grammarType=v,this.maxTokenType=x}clearDFA(){this.decisionToDFA=new Array(this.decisionToState.length);for(let v=0;v<this.decisionToDFA.length;v++)this.decisionToDFA[v]=new s.DFA(this.decisionToState[v],v);this.modeToDFA=new Array(this.modeToStartState.length);for(let v=0;v<this.modeToDFA.length;v++)this.modeToDFA[v]=new s.DFA(this.modeToStartState[v]);this.contextCache.clear(),this.LL1Table.clear()}get contextCacheSize(){return this.contextCache.size}getCachedContext(v){return a.PredictionContext.getCachedContext(v,this.contextCache,new a.PredictionContext.IdentityHashMap)}getDecisionToDFA(){return f(this.decisionToDFA!=null&&this.decisionToDFA.length===this.decisionToState.length),this.decisionToDFA}nextTokens(v,x){return x?new o.LL1Analyzer(this).LOOK(v,x):(v.nextTokenWithinRule||(v.nextTokenWithinRule=this.nextTokens(v,a.PredictionContext.EMPTY_LOCAL),v.nextTokenWithinRule.setReadonly(!0)),v.nextTokenWithinRule)}addState(v){v.atn=this,v.stateNumber=this.states.length,this.states.push(v)}removeState(v){let x=new r.InvalidState;x.atn=this,x.stateNumber=v.stateNumber,this.states[v.stateNumber]=x}defineMode(v,x){this.modeNameToStartState.set(v,x),this.modeToStartState.push(x),this.modeToDFA.push(new s.DFA(x)),this.defineDecisionState(x)}defineDecisionState(v){return this.decisionToState.push(v),v.decision=this.decisionToState.length-1,this.decisionToDFA.push(new s.DFA(v,v.decision)),v.decision}getDecisionState(v){if(this.decisionToState.length>0)return this.decisionToState[v]}get numberOfDecisions(){return this.decisionToState.length}getExpectedTokens(v,x){if(v<0||v>=this.states.length)throw new RangeError("Invalid state number.");let y=x,g=this.states[v],m=this.nextTokens(g);if(!m.contains(h.Token.EPSILON))return m;let S=new n.IntervalSet;for(S.addAll(m),S.remove(h.Token.EPSILON);y!=null&&y.invokingState>=0&&m.contains(h.Token.EPSILON);){let A=this.states[y.invokingState].transition(0);m=this.nextTokens(A.followState),S.addAll(m),S.remove(h.Token.EPSILON),y=y._parent}return m.contains(h.Token.EPSILON)&&S.add(h.Token.EOF),S}};e([l.NotNull],d.prototype,"states",void 0),e([l.NotNull],d.prototype,"decisionToState",void 0),e([l.NotNull],d.prototype,"modeNameToStartState",void 0),e([l.NotNull],d.prototype,"modeToStartState",void 0),e([l.NotNull],d.prototype,"decisionToDFA",void 0),e([l.NotNull],d.prototype,"modeToDFA",void 0),e([l.NotNull],d.prototype,"nextTokens",null),e([t(0,l.NotNull)],d.prototype,"removeState",null),e([t(0,l.NotNull),t(1,l.NotNull)],d.prototype,"defineMode",null),e([t(0,l.NotNull)],d.prototype,"defineDecisionState",null),e([l.NotNull],d.prototype,"getExpectedTokens",null),d=e([t(0,l.NotNull)],d),u.ATN=d,function(p){p.INVALID_ALT_NUMBER=0}(d=u.ATN||(u.ATN={})),u.ATN=d}($r)),$r}var wt={},Ot={},wc;function l0(){if(wc)return Ot;wc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Ot&&Ot.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Ot&&Ot.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.LexerIndexedCustomAction=void 0;const t=je(),i=J();let s=class gd{constructor(r,o){this._offset=r,this._action=o}get offset(){return this._offset}get action(){return this._action}get actionType(){return this._action.actionType}get isPositionDependent(){return!0}execute(r){this._action.execute(r)}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this._offset),r=t.MurmurHash.update(r,this._action),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof gd?this._offset===r._offset&&this._action.equals(r._action):!1}};return u([i.NotNull],s.prototype,"action",null),u([i.Override],s.prototype,"actionType",null),u([i.Override],s.prototype,"isPositionDependent",null),u([i.Override],s.prototype,"execute",null),u([i.Override],s.prototype,"hashCode",null),u([i.Override],s.prototype,"equals",null),s=u([e(1,i.NotNull)],s),Ot.LexerIndexedCustomAction=s,Ot}var Oc;function a0(){if(Oc)return wt;Oc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=wt&&wt.__decorate||function(o,l,c,a){var h=arguments.length,f=h<3?l:a===null?a=Object.getOwnPropertyDescriptor(l,c):a,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,l,c,a);else for(var p=o.length-1;p>=0;p--)(d=o[p])&&(f=(h<3?d(f):h>3?d(l,c,f):d(l,c))||f);return h>3&&f&&Object.defineProperty(l,c,f),f},e=wt&&wt.__param||function(o,l){return function(c,a){l(c,a,o)}};Object.defineProperty(wt,"__esModule",{value:!0}),wt.LexerActionExecutor=void 0;const t=mo(),i=l0(),s=je(),n=J();let r=class Bi{constructor(l){this._lexerActions=l;let c=s.MurmurHash.initialize();for(let a of l)c=s.MurmurHash.update(c,a);this.cachedHashCode=s.MurmurHash.finish(c,l.length)}static append(l,c){if(!l)return new Bi([c]);let a=l._lexerActions.slice(0);return a.push(c),new Bi(a)}fixOffsetBeforeMatch(l){let c;for(let a=0;a<this._lexerActions.length;a++)this._lexerActions[a].isPositionDependent&&!(this._lexerActions[a]instanceof i.LexerIndexedCustomAction)&&(c||(c=this._lexerActions.slice(0)),c[a]=new i.LexerIndexedCustomAction(l,this._lexerActions[a]));return c?new Bi(c):this}get lexerActions(){return this._lexerActions}execute(l,c,a){let h=!1,f=c.index;try{for(let d of this._lexerActions){if(d instanceof i.LexerIndexedCustomAction){let p=d.offset;c.seek(a+p),d=d.action,h=a+p!==f}else d.isPositionDependent&&(c.seek(f),h=!1);d.execute(l)}}finally{h&&c.seek(f)}}hashCode(){return this.cachedHashCode}equals(l){return l===this?!0:l instanceof Bi?this.cachedHashCode===l.cachedHashCode&&t.ArrayEqualityComparator.INSTANCE.equals(this._lexerActions,l._lexerActions):!1}};return u([n.NotNull],r.prototype,"_lexerActions",void 0),u([n.NotNull],r.prototype,"lexerActions",null),u([e(0,n.NotNull)],r.prototype,"execute",null),u([n.Override],r.prototype,"hashCode",null),u([n.Override],r.prototype,"equals",null),u([n.NotNull,e(1,n.NotNull)],r,"append",null),r=u([e(0,n.NotNull)],r),wt.LexerActionExecutor=r,wt}var Ft={},Fc;function Co(){if(Fc)return Ft;Fc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Ft&&Ft.__decorate||function(o,l,c,a){var h=arguments.length,f=h<3?l:a===null?a=Object.getOwnPropertyDescriptor(l,c):a,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,l,c,a);else for(var p=o.length-1;p>=0;p--)(d=o[p])&&(f=(h<3?d(f):h>3?d(l,c,f):d(l,c))||f);return h>3&&f&&Object.defineProperty(l,c,f),f},e=Ft&&Ft.__param||function(o,l){return function(c,a){l(c,a,o)}};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.LexerNoViableAltException=void 0;const t=br(),i=J(),s=We(),n=xr();let r=class extends t.RecognitionException{constructor(l,c,a,h){super(l,c),this._startIndex=a,this._deadEndConfigs=h}get startIndex(){return this._startIndex}get deadEndConfigs(){return this._deadEndConfigs}get inputStream(){return super.inputStream}toString(){let l="";return this._startIndex>=0&&this._startIndex<this.inputStream.size&&(l=this.inputStream.getText(s.Interval.of(this._startIndex,this._startIndex)),l=n.escapeWhitespace(l,!1)),`LexerNoViableAltException('${l}')`}};return u([i.Override],r.prototype,"inputStream",null),u([i.Override],r.prototype,"toString",null),r=u([e(1,i.NotNull)],r),Ft.LexerNoViableAltException=r,Ft}var tn={},Pc;function u0(){if(Pc)return tn;Pc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=tn&&tn.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c};Object.defineProperty(tn,"__esModule",{value:!0}),tn.OrderedATNConfigSet=void 0;const e=Ui(),t=J();let i=class yd extends e.ATNConfigSet{constructor(n,r){n!=null&&r!=null?super(n,r):super()}clone(n){let r=new yd(this,n);return!n&&this.isReadOnly&&r.addAll(this),r}getKey(n){return{state:0,alt:n.hashCode()}}canMerge(n,r,o){return n.equals(o)}};return u([t.Override],i.prototype,"clone",null),u([t.Override],i.prototype,"getKey",null),u([t.Override],i.prototype,"canMerge",null),tn.OrderedATNConfigSet=i,tn}var Dc;function Eo(){return Dc||(Dc=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Hr&&Hr.__decorate||function(T,A,b,N){var R=arguments.length,P=R<3?A:N===null?N=Object.getOwnPropertyDescriptor(A,b):N,I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(T,A,b,N);else for(var B=T.length-1;B>=0;B--)(I=T[B])&&(P=(R<3?I(P):R>3?I(A,b,P):I(A,b))||P);return R>3&&P&&Object.defineProperty(A,b,P),P},t=Hr&&Hr.__param||function(T,A){return function(b,N){A(b,N,T)}};Object.defineProperty(u,"__esModule",{value:!0}),u.LexerATNSimulator=void 0;const i=ad(),s=ct(),n=vo(),r=Ui(),o=Ao(),l=So(),c=We(),a=Tr(),h=Or(),f=a0(),d=Co(),p=J(),v=u0(),x=it(),y=$i(),g=Be(),m=$e();let S=class Ye extends o.ATNSimulator{constructor(A,b){super(A),this.optimize_tail_calls=!0,this.startIndex=-1,this._line=1,this._charPositionInLine=0,this.mode=h.Lexer.DEFAULT_MODE,this.prevAccept=new Ye.SimState,this.recog=b}copyState(A){this._charPositionInLine=A.charPositionInLine,this._line=A._line,this.mode=A.mode,this.startIndex=A.startIndex}match(A,b){this.mode=b;let N=A.mark();try{this.startIndex=A.index,this.prevAccept.reset();let R=this.atn.modeToDFA[b].s0;return R==null?this.matchATN(A):this.execATN(A,R)}finally{A.release(N)}}reset(){this.prevAccept.reset(),this.startIndex=-1,this._line=1,this._charPositionInLine=0,this.mode=h.Lexer.DEFAULT_MODE}matchATN(A){let b=this.atn.modeToStartState[this.mode];Ye.debug&&console.log(`matchATN mode ${this.mode} start: ${b}`);let N=this.mode,R=this.computeStartState(A,b),P=R.hasSemanticContext;P&&(R.hasSemanticContext=!1);let I=this.addDFAState(R);if(!P){let V=this.atn.modeToDFA[this.mode];V.s0?I=V.s0:V.s0=I}let B=this.execATN(A,I);return Ye.debug&&console.log(`DFA after matchATN: ${this.atn.modeToDFA[N].toLexerString()}`),B}execATN(A,b){Ye.debug&&console.log(`start state closure=${b.configs}`),b.isAcceptState&&this.captureSimState(this.prevAccept,A,b);let N=A.LA(1),R=b;for(;;){Ye.debug&&console.log(`execATN loop starting closure: ${R.configs}`);let P=this.getExistingTargetState(R,N);if(P==null&&(P=this.computeTargetState(A,R,N)),P===o.ATNSimulator.ERROR||(N!==a.IntStream.EOF&&this.consume(A),P.isAcceptState&&(this.captureSimState(this.prevAccept,A,P),N===a.IntStream.EOF)))break;N=A.LA(1),R=P}return this.failOrAccept(this.prevAccept,A,R.configs,N)}getExistingTargetState(A,b){let N=A.getTarget(b);return Ye.debug&&N!=null&&console.log("reuse state "+A.stateNumber+" edge to "+N.stateNumber),N}computeTargetState(A,b,N){let R=new v.OrderedATNConfigSet;return this.getReachableConfigSet(A,b.configs,R,N),R.isEmpty?(R.hasSemanticContext||this.addDFAEdge(b,N,o.ATNSimulator.ERROR),o.ATNSimulator.ERROR):this.addDFAEdge(b,N,R)}failOrAccept(A,b,N,R){if(A.dfaState!=null){let P=A.dfaState.lexerActionExecutor;return this.accept(b,P,this.startIndex,A.index,A.line,A.charPos),A.dfaState.prediction}else{if(R===a.IntStream.EOF&&b.index===this.startIndex)return g.Token.EOF;throw new d.LexerNoViableAltException(this.recog,b,this.startIndex,N)}}getReachableConfigSet(A,b,N,R){let P=s.ATN.INVALID_ALT_NUMBER;for(let I of b){let B=I.alt===P;if(B&&I.hasPassedThroughNonGreedyDecision)continue;Ye.debug&&console.log(`testing ${this.getTokenName(R)} at ${I.toString(this.recog,!0)}`);let V=I.state.numberOfOptimizedTransitions;for(let ee=0;ee<V;ee++){let te=I.state.getOptimizedTransition(ee),le=this.getReachableTarget(te,R);if(le!=null){let ge=I.lexerActionExecutor,ce;ge!=null?(ge=ge.fixOffsetBeforeMatch(A.index-this.startIndex),ce=I.transform(le,!0,ge)):(m(I.lexerActionExecutor==null),ce=I.transform(le,!0));let Z=R===a.IntStream.EOF;if(this.closure(A,ce,N,B,!0,Z)){P=I.alt;break}}}}}accept(A,b,N,R,P,I){Ye.debug&&console.log(`ACTION ${b}`),A.seek(R),this._line=P,this._charPositionInLine=I,b!=null&&this.recog!=null&&b.execute(this.recog,A,N)}getReachableTarget(A,b){if(A.matches(b,h.Lexer.MIN_CHAR_VALUE,h.Lexer.MAX_CHAR_VALUE))return A.target}computeStartState(A,b){let N=x.PredictionContext.EMPTY_FULL,R=new v.OrderedATNConfigSet;for(let P=0;P<b.numberOfTransitions;P++){let I=b.transition(P).target,B=n.ATNConfig.create(I,P+1,N);this.closure(A,B,R,!1,!1,!1)}return R}closure(A,b,N,R,P,I){if(Ye.debug&&console.log("closure("+b.toString(this.recog,!0)+")"),b.state instanceof y.RuleStopState){Ye.debug&&(this.recog!=null?console.log(`closure at ${this.recog.ruleNames[b.state.ruleIndex]} rule stop ${b}`):console.log(`closure at rule stop ${b}`));let V=b.context;if(V.isEmpty)return N.add(b),!0;V.hasEmpty&&(N.add(b.transform(b.state,!0,x.PredictionContext.EMPTY_FULL)),R=!0);for(let ee=0;ee<V.size;ee++){let te=V.getReturnState(ee);if(te===x.PredictionContext.EMPTY_FULL_STATE_KEY)continue;let le=V.getParent(ee),ge=this.atn.states[te],ce=b.transform(ge,!1,le);R=this.closure(A,ce,N,R,P,I)}return R}b.state.onlyHasEpsilonTransitions||(!R||!b.hasPassedThroughNonGreedyDecision)&&N.add(b);let B=b.state;for(let V=0;V<B.numberOfOptimizedTransitions;V++){let ee=B.getOptimizedTransition(V),te=this.getEpsilonTarget(A,b,ee,N,P,I);te!=null&&(R=this.closure(A,te,N,R,P,I))}return R}getEpsilonTarget(A,b,N,R,P,I){let B;switch(N.serializationType){case 3:let V=N;if(this.optimize_tail_calls&&V.optimizedTailCall&&!b.context.hasEmpty)B=b.transform(N.target,!0);else{let te=b.context.getChild(V.followState.stateNumber);B=b.transform(N.target,!0,te)}break;case 10:throw new Error("Precedence predicates are not supported in lexers.");case 4:let ee=N;Ye.debug&&console.log("EVAL rule "+ee.ruleIndex+":"+ee.predIndex),R.hasSemanticContext=!0,this.evaluatePredicate(A,ee.ruleIndex,ee.predIndex,P)?B=b.transform(N.target,!0):B=void 0;break;case 6:if(b.context.hasEmpty){let te=f.LexerActionExecutor.append(b.lexerActionExecutor,this.atn.lexerActions[N.actionIndex]);B=b.transform(N.target,!0,te);break}else{B=b.transform(N.target,!0);break}case 1:B=b.transform(N.target,!0);break;case 5:case 2:case 7:if(I&&N.matches(a.IntStream.EOF,h.Lexer.MIN_CHAR_VALUE,h.Lexer.MAX_CHAR_VALUE)){B=b.transform(N.target,!1);break}B=void 0;break;default:B=void 0;break}return B}evaluatePredicate(A,b,N,R){if(this.recog==null)return!0;if(!R)return this.recog.sempred(void 0,b,N);let P=this._charPositionInLine,I=this._line,B=A.index,V=A.mark();try{return this.consume(A),this.recog.sempred(void 0,b,N)}finally{this._charPositionInLine=P,this._line=I,A.seek(B),A.release(V)}}captureSimState(A,b,N){A.index=b.index,A.line=this._line,A.charPos=this._charPositionInLine,A.dfaState=N}addDFAEdge(A,b,N){if(N instanceof r.ATNConfigSet){let R=N.hasSemanticContext;R&&(N.hasSemanticContext=!1);let P=this.addDFAState(N);return R||this.addDFAEdge(A,b,P),P}else Ye.debug&&console.log("EDGE "+A+" -> "+N+" upon "+String.fromCharCode(b)),A!=null&&A.setTarget(b,N)}addDFAState(A){m(!A.hasSemanticContext);let b=new l.DFAState(A),N=this.atn.modeToDFA[this.mode].states.get(b);if(N!=null)return N;A.optimizeConfigs(this);let R=new l.DFAState(A.clone(!0)),P;for(let I of A)if(I.state instanceof y.RuleStopState){P=I;break}if(P!=null){let I=this.atn.ruleToTokenType[P.state.ruleIndex],B=P.lexerActionExecutor;R.acceptStateInfo=new i.AcceptStateInfo(I,B)}return this.atn.modeToDFA[this.mode].addState(R)}getDFA(A){return this.atn.modeToDFA[A]}getText(A){return A.getText(c.Interval.of(this.startIndex,A.index-1))}get line(){return this._line}set line(A){this._line=A}get charPositionInLine(){return this._charPositionInLine}set charPositionInLine(A){this._charPositionInLine=A}consume(A){A.LA(1)===10?(this._line++,this._charPositionInLine=0):this._charPositionInLine++,A.consume()}getTokenName(A){return A===-1?"EOF":"'"+String.fromCharCode(A)+"'"}};e([p.NotNull],S.prototype,"prevAccept",void 0),e([t(0,p.NotNull)],S.prototype,"copyState",null),e([t(0,p.NotNull)],S.prototype,"match",null),e([p.Override],S.prototype,"reset",null),e([t(0,p.NotNull)],S.prototype,"matchATN",null),e([t(0,p.NotNull),t(1,p.NotNull)],S.prototype,"execATN",null),e([t(0,p.NotNull)],S.prototype,"getExistingTargetState",null),e([p.NotNull,t(0,p.NotNull),t(1,p.NotNull)],S.prototype,"computeTargetState",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull)],S.prototype,"getReachableConfigSet",null),e([t(0,p.NotNull)],S.prototype,"accept",null),e([p.NotNull,t(0,p.NotNull),t(1,p.NotNull)],S.prototype,"computeStartState",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull)],S.prototype,"closure",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull),t(3,p.NotNull)],S.prototype,"getEpsilonTarget",null),e([t(0,p.NotNull)],S.prototype,"evaluatePredicate",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull)],S.prototype,"captureSimState",null),e([p.NotNull,t(0,p.NotNull)],S.prototype,"addDFAState",null),e([p.NotNull],S.prototype,"getDFA",null),e([p.NotNull,t(0,p.NotNull)],S.prototype,"getText",null),e([t(0,p.NotNull)],S.prototype,"consume",null),e([p.NotNull],S.prototype,"getTokenName",null),S=e([t(0,p.NotNull)],S),u.LexerATNSimulator=S,function(T){T.debug=!1,T.dfa_debug=!1;class A{constructor(){this.index=-1,this.line=0,this.charPos=-1}reset(){this.index=-1,this.line=0,this.charPos=-1,this.dfaState=void 0}}T.SimState=A}(S=u.LexerATNSimulator||(u.LexerATNSimulator={})),u.LexerATNSimulator=S}(Hr)),Hr}var Ic;function Or(){if(Ic)return Ur;Ic=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Ur&&Ur.__decorate||function(h,f,d,p){var v=arguments.length,x=v<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,d):p,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(h,f,d,p);else for(var g=h.length-1;g>=0;g--)(y=h[g])&&(x=(v<3?y(x):v>3?y(f,d,x):y(f,d))||x);return v>3&&x&&Object.defineProperty(f,d,x),x};Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.Lexer=void 0;const e=Hl(),t=ld(),i=We(),s=Tr(),n=Eo(),r=Co(),o=J(),l=Hi(),c=Be();let a=class yr extends l.Recognizer{constructor(f){super(),this._factory=e.CommonTokenFactory.DEFAULT,this._tokenStartCharIndex=-1,this._tokenStartLine=0,this._tokenStartCharPositionInLine=0,this._hitEOF=!1,this._channel=0,this._type=0,this._modeStack=new t.IntegerStack,this._mode=yr.DEFAULT_MODE,this._input=f,this._tokenFactorySourcePair={source:this,stream:f}}static get DEFAULT_TOKEN_CHANNEL(){return c.Token.DEFAULT_CHANNEL}static get HIDDEN(){return c.Token.HIDDEN_CHANNEL}reset(f){(f===void 0||f)&&this._input.seek(0),this._token=void 0,this._type=c.Token.INVALID_TYPE,this._channel=c.Token.DEFAULT_CHANNEL,this._tokenStartCharIndex=-1,this._tokenStartCharPositionInLine=-1,this._tokenStartLine=-1,this._text=void 0,this._hitEOF=!1,this._mode=yr.DEFAULT_MODE,this._modeStack.clear(),this.interpreter.reset()}nextToken(){if(this._input==null)throw new Error("nextToken requires a non-null input stream.");let f=this._input.mark();try{e:for(;;){if(this._hitEOF)return this.emitEOF();this._token=void 0,this._channel=c.Token.DEFAULT_CHANNEL,this._tokenStartCharIndex=this._input.index,this._tokenStartCharPositionInLine=this.interpreter.charPositionInLine,this._tokenStartLine=this.interpreter.line,this._text=void 0;do{this._type=c.Token.INVALID_TYPE;let d;try{d=this.interpreter.match(this._input,this._mode)}catch(p){if(p instanceof r.LexerNoViableAltException)this.notifyListeners(p),this.recover(p),d=yr.SKIP;else throw p}if(this._input.LA(1)===s.IntStream.EOF&&(this._hitEOF=!0),this._type===c.Token.INVALID_TYPE&&(this._type=d),this._type===yr.SKIP)continue e}while(this._type===yr.MORE);return this._token==null?this.emit():this._token}}finally{this._input.release(f)}}skip(){this._type=yr.SKIP}more(){this._type=yr.MORE}mode(f){this._mode=f}pushMode(f){n.LexerATNSimulator.debug&&console.log("pushMode "+f),this._modeStack.push(this._mode),this.mode(f)}popMode(){if(this._modeStack.isEmpty)throw new Error("EmptyStackException");return n.LexerATNSimulator.debug&&console.log("popMode back to "+this._modeStack.peek()),this.mode(this._modeStack.pop()),this._mode}get tokenFactory(){return this._factory}set tokenFactory(f){this._factory=f}get inputStream(){return this._input}set inputStream(f){this.reset(!1),this._input=f,this._tokenFactorySourcePair={source:this,stream:this._input}}get sourceName(){return this._input.sourceName}emit(f){return f||(f=this._factory.create(this._tokenFactorySourcePair,this._type,this._text,this._channel,this._tokenStartCharIndex,this.charIndex-1,this._tokenStartLine,this._tokenStartCharPositionInLine)),this._token=f,f}emitEOF(){let f=this.charPositionInLine,d=this.line,p=this._factory.create(this._tokenFactorySourcePair,c.Token.EOF,void 0,c.Token.DEFAULT_CHANNEL,this._input.index,this._input.index-1,d,f);return this.emit(p),p}get line(){return this.interpreter.line}set line(f){this.interpreter.line=f}get charPositionInLine(){return this.interpreter.charPositionInLine}set charPositionInLine(f){this.interpreter.charPositionInLine=f}get charIndex(){return this._input.index}get text(){return this._text!=null?this._text:this.interpreter.getText(this._input)}set text(f){this._text=f}get token(){return this._token}set token(f){this._token=f}set type(f){this._type=f}get type(){return this._type}set channel(f){this._channel=f}get channel(){return this._channel}getAllTokens(){let f=[],d=this.nextToken();for(;d.type!==c.Token.EOF;)f.push(d),d=this.nextToken();return f}notifyListeners(f){let d=this._input.getText(i.Interval.of(this._tokenStartCharIndex,this._input.index)),p="token recognition error at: '"+this.getErrorDisplay(d)+"'",v=this.getErrorListenerDispatch();v.syntaxError&&v.syntaxError(this,void 0,this._tokenStartLine,this._tokenStartCharPositionInLine,p,f)}getErrorDisplay(f){if(typeof f=="number"){switch(f){case c.Token.EOF:return"<EOF>";case 10:return"\\n";case 9:return"\\t";case 13:return"\\r"}return String.fromCharCode(f)}return f.replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}getCharErrorDisplay(f){return"'"+this.getErrorDisplay(f)+"'"}recover(f){f instanceof r.LexerNoViableAltException?this._input.LA(1)!==s.IntStream.EOF&&this.interpreter.consume(this._input):this._input.consume()}};return a.DEFAULT_MODE=0,a.MORE=-2,a.SKIP=-3,a.MIN_CHAR_VALUE=0,a.MAX_CHAR_VALUE=1114111,u([o.Override],a.prototype,"nextToken",null),u([o.Override],a.prototype,"tokenFactory",null),u([o.Override],a.prototype,"inputStream",null),u([o.Override],a.prototype,"sourceName",null),u([o.Override],a.prototype,"line",null),u([o.Override],a.prototype,"charPositionInLine",null),Ur.Lexer=a,Ur}var Lc;function $n(){if(Lc)return gt;Lc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=gt&&gt.__decorate||function(a,h,f,d){var p=arguments.length,v=p<3?h:d===null?d=Object.getOwnPropertyDescriptor(h,f):d,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(a,h,f,d);else for(var y=a.length-1;y>=0;y--)(x=a[y])&&(v=(p<3?x(v):p>3?x(h,f,v):x(h,f))||v);return p>3&&v&&Object.defineProperty(h,f,v),v},e=gt&&gt.__param||function(a,h){return function(f,d){h(f,d,a)}};Object.defineProperty(gt,"__esModule",{value:!0}),gt.IntervalSet=void 0;const t=mo(),i=Ul(),s=We(),n=Or(),r=je(),o=J(),l=Be();let c=class Oe{constructor(h){this.readonly=!1,h!=null?this._intervals=h.slice(0):this._intervals=[]}static get COMPLETE_CHAR_SET(){return Oe._COMPLETE_CHAR_SET===void 0&&(Oe._COMPLETE_CHAR_SET=Oe.of(n.Lexer.MIN_CHAR_VALUE,n.Lexer.MAX_CHAR_VALUE),Oe._COMPLETE_CHAR_SET.setReadonly(!0)),Oe._COMPLETE_CHAR_SET}static get EMPTY_SET(){return Oe._EMPTY_SET==null&&(Oe._EMPTY_SET=new Oe,Oe._EMPTY_SET.setReadonly(!0)),Oe._EMPTY_SET}static of(h,f=h){let d=new Oe;return d.add(h,f),d}clear(){if(this.readonly)throw new Error("can't alter readonly IntervalSet");this._intervals.length=0}add(h,f=h){this.addRange(s.Interval.of(h,f))}addRange(h){if(this.readonly)throw new Error("can't alter readonly IntervalSet");if(!(h.b<h.a)){for(let f=0;f<this._intervals.length;f++){let d=this._intervals[f];if(h.equals(d))return;if(h.adjacent(d)||!h.disjoint(d)){let p=h.union(d);for(this._intervals[f]=p;f<this._intervals.length-1;){f++;let v=this._intervals[f];if(!p.adjacent(v)&&p.disjoint(v))break;this._intervals.splice(f,1),f--,this._intervals[f]=p.union(v)}return}if(h.startsBeforeDisjoint(d)){this._intervals.splice(f,0,h);return}}this._intervals.push(h)}}static or(h){let f=new Oe;for(let d of h)f.addAll(d);return f}addAll(h){if(h==null)return this;if(h instanceof Oe){let f=h,d=f._intervals.length;for(let p=0;p<d;p++){let v=f._intervals[p];this.add(v.a,v.b)}}else for(let f of h.toArray())this.add(f);return this}complementRange(h,f){return this.complement(Oe.of(h,f))}complement(h){if(h.isNil)return Oe.EMPTY_SET;let f;return h instanceof Oe?f=h:(f=new Oe,f.addAll(h)),f.subtract(this)}subtract(h){if(h==null||h.isNil)return new Oe(this._intervals);if(h instanceof Oe)return Oe.subtract(this,h);let f=new Oe;return f.addAll(h),Oe.subtract(this,f)}static subtract(h,f){if(h.isNil)return new Oe;let d=new Oe(h._intervals);if(f.isNil)return d;let p=0,v=0;for(;p<d._intervals.length&&v<f._intervals.length;){let x=d._intervals[p],y=f._intervals[v];if(y.b<x.a){v++;continue}if(y.a>x.b){p++;continue}let g,m;if(y.a>x.a&&(g=new s.Interval(x.a,y.a-1)),y.b<x.b&&(m=new s.Interval(y.b+1,x.b)),g)if(m){d._intervals[p]=g,d._intervals.splice(p+1,0,m),p++,v++;continue}else{d._intervals[p]=g,p++;continue}else if(m){d._intervals[p]=m,v++;continue}else{d._intervals.splice(p,1);continue}}return d}or(h){let f=new Oe;return f.addAll(this),f.addAll(h),f}and(h){if(h.isNil)return new Oe;let f=this._intervals,d=h._intervals,p,v=f.length,x=d.length,y=0,g=0;for(;y<v&&g<x;){let m=f[y],S=d[g];m.startsBeforeDisjoint(S)?y++:S.startsBeforeDisjoint(m)?g++:m.properlyContains(S)?(p||(p=new Oe),p.addRange(m.intersection(S)),g++):S.properlyContains(m)?(p||(p=new Oe),p.addRange(m.intersection(S)),y++):m.disjoint(S)||(p||(p=new Oe),p.addRange(m.intersection(S)),m.startsAfterNonDisjoint(S)?g++:S.startsAfterNonDisjoint(m)&&y++)}return p||new Oe}contains(h){let f=this._intervals.length,d=0,p=f-1;for(;d<=p;){let v=d+p>>1,x=this._intervals[v],y=x.a;if(x.b<h)d=v+1;else if(y>h)p=v-1;else return!0}return!1}get isNil(){return this._intervals==null||this._intervals.length===0}get maxElement(){if(this.isNil)throw new RangeError("set is empty");return this._intervals[this._intervals.length-1].b}get minElement(){if(this.isNil)throw new RangeError("set is empty");return this._intervals[0].a}get intervals(){return this._intervals}hashCode(){let h=r.MurmurHash.initialize();for(let f of this._intervals)h=r.MurmurHash.update(h,f.a),h=r.MurmurHash.update(h,f.b);return h=r.MurmurHash.finish(h,this._intervals.length*2),h}equals(h){return h==null||!(h instanceof Oe)?!1:t.ArrayEqualityComparator.INSTANCE.equals(this._intervals,h._intervals)}toString(h=!1){let f="";if(this._intervals==null||this._intervals.length===0)return"{}";this.size>1&&(f+="{");let d=!0;for(let p of this._intervals){d?d=!1:f+=", ";let v=p.a,x=p.b;v===x?v===l.Token.EOF?f+="<EOF>":h?f+="'"+String.fromCodePoint(v)+"'":f+=v:h?f+="'"+String.fromCodePoint(v)+"'..'"+String.fromCodePoint(x)+"'":f+=v+".."+x}return this.size>1&&(f+="}"),f}toStringVocabulary(h){if(this._intervals==null||this._intervals.length===0)return"{}";let f="";this.size>1&&(f+="{");let d=!0;for(let p of this._intervals){d?d=!1:f+=", ";let v=p.a,x=p.b;if(v===x)f+=this.elementName(h,v);else for(let y=v;y<=x;y++)y>v&&(f+=", "),f+=this.elementName(h,y)}return this.size>1&&(f+="}"),f}elementName(h,f){return f===l.Token.EOF?"<EOF>":f===l.Token.EPSILON?"<EPSILON>":h.getDisplayName(f)}get size(){let h=0,f=this._intervals.length;if(f===1){let d=this._intervals[0];return d.b-d.a+1}for(let d=0;d<f;d++){let p=this._intervals[d];h+=p.b-p.a+1}return h}toIntegerList(){let h=new i.IntegerList(this.size),f=this._intervals.length;for(let d=0;d<f;d++){let p=this._intervals[d],v=p.a,x=p.b;for(let y=v;y<=x;y++)h.add(y)}return h}toSet(){let h=new Set;for(let f of this._intervals){let d=f.a,p=f.b;for(let v=d;v<=p;v++)h.add(v)}return h}toArray(){let h=new Array,f=this._intervals.length;for(let d=0;d<f;d++){let p=this._intervals[d],v=p.a,x=p.b;for(let y=v;y<=x;y++)h.push(y)}return h}remove(h){if(this.readonly)throw new Error("can't alter readonly IntervalSet");let f=this._intervals.length;for(let d=0;d<f;d++){let p=this._intervals[d],v=p.a,x=p.b;if(h<v)break;if(h===v&&h===x){this._intervals.splice(d,1);break}if(h===v){this._intervals[d]=s.Interval.of(p.a+1,p.b);break}if(h===x){this._intervals[d]=s.Interval.of(p.a,p.b-1);break}if(h>v&&h<x){let y=p.b;this._intervals[d]=s.Interval.of(p.a,h-1),this.add(h+1,y)}}}get isReadonly(){return this.readonly}setReadonly(h){if(this.readonly&&!h)throw new Error("can't alter readonly IntervalSet");this.readonly=h}};return u([o.Override],c.prototype,"addAll",null),u([o.Override],c.prototype,"complement",null),u([o.Override],c.prototype,"subtract",null),u([o.Override],c.prototype,"or",null),u([o.Override],c.prototype,"and",null),u([o.Override],c.prototype,"contains",null),u([o.Override],c.prototype,"isNil",null),u([o.Override],c.prototype,"hashCode",null),u([o.Override],c.prototype,"equals",null),u([e(0,o.NotNull)],c.prototype,"toStringVocabulary",null),u([o.NotNull,e(0,o.NotNull)],c.prototype,"elementName",null),u([o.Override],c.prototype,"size",null),u([o.Override],c.prototype,"remove",null),u([o.NotNull],c,"of",null),u([o.NotNull],c,"subtract",null),gt.IntervalSet=c,gt}var rn={},rt={},nn={},Bc;function vd(){if(Bc)return nn;Bc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=nn&&nn.__decorate||function(i,s,n,r){var o=arguments.length,l=o<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,n):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(i,s,n,r);else for(var a=i.length-1;a>=0;a--)(c=i[a])&&(l=(o<3?c(l):o>3?c(s,n,l):c(s,n))||l);return o>3&&l&&Object.defineProperty(s,n,l),l};Object.defineProperty(nn,"__esModule",{value:!0}),nn.ATNDeserializationOptions=void 0;const e=J();let t=class Gn{constructor(s){this.readOnly=!1,s?(this.verifyATN=s.verifyATN,this.generateRuleBypassTransitions=s.generateRuleBypassTransitions,this.optimize=s.optimize):(this.verifyATN=!0,this.generateRuleBypassTransitions=!1,this.optimize=!0)}static get defaultOptions(){return Gn._defaultOptions==null&&(Gn._defaultOptions=new Gn,Gn._defaultOptions.makeReadOnly()),Gn._defaultOptions}get isReadOnly(){return this.readOnly}makeReadOnly(){this.readOnly=!0}get isVerifyATN(){return this.verifyATN}set isVerifyATN(s){this.throwIfReadOnly(),this.verifyATN=s}get isGenerateRuleBypassTransitions(){return this.generateRuleBypassTransitions}set isGenerateRuleBypassTransitions(s){this.throwIfReadOnly(),this.generateRuleBypassTransitions=s}get isOptimize(){return this.optimize}set isOptimize(s){this.throwIfReadOnly(),this.optimize=s}throwIfReadOnly(){if(this.isReadOnly)throw new Error("The object is read only.")}};return u([e.NotNull],t,"defaultOptions",null),nn.ATNDeserializationOptions=t,nn}var Pt={},Dt={},Mc;function Sd(){if(Mc)return Dt;Mc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Dt&&Dt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Dt&&Dt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.ActionTransition=void 0;const t=J(),i=Nr();let s=class extends i.Transition{constructor(r,o,l=-1,c=!1){super(r),this.ruleIndex=o,this.actionIndex=l,this.isCtxDependent=c}get serializationType(){return 6}get isEpsilon(){return!0}matches(r,o,l){return!1}toString(){return"action_"+this.ruleIndex+":"+this.actionIndex}};return u([t.Override],s.prototype,"serializationType",null),u([t.Override],s.prototype,"isEpsilon",null),u([t.Override],s.prototype,"matches",null),u([t.Override],s.prototype,"toString",null),s=u([e(0,t.NotNull)],s),Dt.ActionTransition=s,Dt}var It={},kc;function Ad(){if(kc)return It;kc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=It&&It.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=It&&It.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(It,"__esModule",{value:!0}),It.AtomTransition=void 0;const t=$n(),i=J(),s=Nr();let n=class extends s.Transition{constructor(o,l){super(o),this._label=l}get serializationType(){return 5}get label(){return t.IntervalSet.of(this._label)}matches(o,l,c){return this._label===o}toString(){return String(this.label)}};return u([i.Override],n.prototype,"serializationType",null),u([i.Override,i.NotNull],n.prototype,"label",null),u([i.Override],n.prototype,"matches",null),u([i.Override,i.NotNull],n.prototype,"toString",null),n=u([e(0,i.NotNull)],n),It.AtomTransition=n,It}var on={},yi={},zc;function _o(){if(zc)return yi;zc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(yi,"__esModule",{value:!0}),yi.BlockStartState=void 0;const u=Un();let e=class extends u.DecisionState{};return yi.BlockStartState=e,yi}var jc;function c0(){if(jc)return on;jc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=on&&on.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(on,"__esModule",{value:!0}),on.BasicBlockStartState=void 0;const e=Ue(),t=_o(),i=J();let s=class extends t.BlockStartState{get stateType(){return e.ATNStateType.BLOCK_START}};return u([i.Override],s.prototype,"stateType",null),on.BasicBlockStartState=s,on}var sn={},qc;function h0(){if(qc)return sn;qc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=sn&&sn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(sn,"__esModule",{value:!0}),sn.BlockEndState=void 0;const e=pr(),t=Ue(),i=J();let s=class extends e.ATNState{get stateType(){return t.ATNStateType.BLOCK_END}};return u([i.Override],s.prototype,"stateType",null),sn.BlockEndState=s,sn}var Lt={},Uc;function f0(){if(Uc)return Lt;Uc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Lt&&Lt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Lt&&Lt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.EpsilonTransition=void 0;const t=J(),i=Nr();let s=class extends i.Transition{constructor(r,o=-1){super(r),this._outermostPrecedenceReturn=o}get outermostPrecedenceReturn(){return this._outermostPrecedenceReturn}get serializationType(){return 1}get isEpsilon(){return!0}matches(r,o,l){return!1}toString(){return"epsilon"}};return u([t.Override],s.prototype,"serializationType",null),u([t.Override],s.prototype,"isEpsilon",null),u([t.Override],s.prototype,"matches",null),u([t.Override,t.NotNull],s.prototype,"toString",null),s=u([e(0,t.NotNull)],s),Lt.EpsilonTransition=s,Lt}var Bt={},Hc;function d0(){if(Hc)return Bt;Hc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Bt&&Bt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Bt&&Bt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.LexerChannelAction=void 0;const t=je(),i=J();let s=class Cd{constructor(r){this._channel=r}get channel(){return this._channel}get actionType(){return 0}get isPositionDependent(){return!1}execute(r){r.channel=this._channel}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._channel),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof Cd?this._channel===r._channel:!1}toString(){return`channel(${this._channel})`}};return u([i.Override],s.prototype,"actionType",null),u([i.Override],s.prototype,"isPositionDependent",null),u([i.Override,e(0,i.NotNull)],s.prototype,"execute",null),u([i.Override],s.prototype,"hashCode",null),u([i.Override],s.prototype,"equals",null),u([i.Override],s.prototype,"toString",null),Bt.LexerChannelAction=s,Bt}var Mt={},$c;function p0(){if($c)return Mt;$c=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Mt&&Mt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Mt&&Mt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.LexerCustomAction=void 0;const t=je(),i=J();let s=class Ed{constructor(r,o){this._ruleIndex=r,this._actionIndex=o}get ruleIndex(){return this._ruleIndex}get actionIndex(){return this._actionIndex}get actionType(){return 1}get isPositionDependent(){return!0}execute(r){r.action(void 0,this._ruleIndex,this._actionIndex)}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._ruleIndex),r=t.MurmurHash.update(r,this._actionIndex),t.MurmurHash.finish(r,3)}equals(r){return r===this?!0:r instanceof Ed?this._ruleIndex===r._ruleIndex&&this._actionIndex===r._actionIndex:!1}};return u([i.Override],s.prototype,"actionType",null),u([i.Override],s.prototype,"isPositionDependent",null),u([i.Override,e(0,i.NotNull)],s.prototype,"execute",null),u([i.Override],s.prototype,"hashCode",null),u([i.Override],s.prototype,"equals",null),Mt.LexerCustomAction=s,Mt}var kt={},Vc;function x0(){if(Vc)return kt;Vc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=kt&&kt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=kt&&kt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(kt,"__esModule",{value:!0}),kt.LexerModeAction=void 0;const t=je(),i=J();let s=class _d{constructor(r){this._mode=r}get mode(){return this._mode}get actionType(){return 2}get isPositionDependent(){return!1}execute(r){r.mode(this._mode)}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._mode),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof _d?this._mode===r._mode:!1}toString(){return`mode(${this._mode})`}};return u([i.Override],s.prototype,"actionType",null),u([i.Override],s.prototype,"isPositionDependent",null),u([i.Override,e(0,i.NotNull)],s.prototype,"execute",null),u([i.Override],s.prototype,"hashCode",null),u([i.Override],s.prototype,"equals",null),u([i.Override],s.prototype,"toString",null),kt.LexerModeAction=s,kt}var ln={},Wc;function m0(){return Wc||(Wc=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=ln&&ln.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},t=ln&&ln.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(u,"__esModule",{value:!0}),u.LexerMoreAction=void 0;const i=je(),s=J();let n=class{constructor(){}get actionType(){return 3}get isPositionDependent(){return!1}execute(o){o.more()}hashCode(){let o=i.MurmurHash.initialize();return o=i.MurmurHash.update(o,this.actionType),i.MurmurHash.finish(o,1)}equals(o){return o===this}toString(){return"more"}};e([s.Override],n.prototype,"actionType",null),e([s.Override],n.prototype,"isPositionDependent",null),e([s.Override,t(0,s.NotNull)],n.prototype,"execute",null),e([s.Override],n.prototype,"hashCode",null),e([s.Override],n.prototype,"equals",null),e([s.Override],n.prototype,"toString",null),u.LexerMoreAction=n,function(r){r.INSTANCE=new r}(n=u.LexerMoreAction||(u.LexerMoreAction={}))}(ln)),ln}var an={},Gc;function g0(){return Gc||(Gc=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=an&&an.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},t=an&&an.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(u,"__esModule",{value:!0}),u.LexerPopModeAction=void 0;const i=je(),s=J();let n=class{constructor(){}get actionType(){return 4}get isPositionDependent(){return!1}execute(o){o.popMode()}hashCode(){let o=i.MurmurHash.initialize();return o=i.MurmurHash.update(o,this.actionType),i.MurmurHash.finish(o,1)}equals(o){return o===this}toString(){return"popMode"}};e([s.Override],n.prototype,"actionType",null),e([s.Override],n.prototype,"isPositionDependent",null),e([s.Override,t(0,s.NotNull)],n.prototype,"execute",null),e([s.Override],n.prototype,"hashCode",null),e([s.Override],n.prototype,"equals",null),e([s.Override],n.prototype,"toString",null),u.LexerPopModeAction=n,function(r){r.INSTANCE=new r}(n=u.LexerPopModeAction||(u.LexerPopModeAction={}))}(an)),an}var zt={},Yc;function y0(){if(Yc)return zt;Yc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=zt&&zt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=zt&&zt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(zt,"__esModule",{value:!0}),zt.LexerPushModeAction=void 0;const t=je(),i=J();let s=class Td{constructor(r){this._mode=r}get mode(){return this._mode}get actionType(){return 5}get isPositionDependent(){return!1}execute(r){r.pushMode(this._mode)}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._mode),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof Td?this._mode===r._mode:!1}toString(){return`pushMode(${this._mode})`}};return u([i.Override],s.prototype,"actionType",null),u([i.Override],s.prototype,"isPositionDependent",null),u([i.Override,e(0,i.NotNull)],s.prototype,"execute",null),u([i.Override],s.prototype,"hashCode",null),u([i.Override],s.prototype,"equals",null),u([i.Override],s.prototype,"toString",null),zt.LexerPushModeAction=s,zt}var un={},Xc;function v0(){return Xc||(Xc=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=un&&un.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},t=un&&un.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(u,"__esModule",{value:!0}),u.LexerSkipAction=void 0;const i=je(),s=J();let n=class{constructor(){}get actionType(){return 6}get isPositionDependent(){return!1}execute(o){o.skip()}hashCode(){let o=i.MurmurHash.initialize();return o=i.MurmurHash.update(o,this.actionType),i.MurmurHash.finish(o,1)}equals(o){return o===this}toString(){return"skip"}};e([s.Override],n.prototype,"actionType",null),e([s.Override],n.prototype,"isPositionDependent",null),e([s.Override,t(0,s.NotNull)],n.prototype,"execute",null),e([s.Override],n.prototype,"hashCode",null),e([s.Override],n.prototype,"equals",null),e([s.Override],n.prototype,"toString",null),u.LexerSkipAction=n,function(r){r.INSTANCE=new r}(n=u.LexerSkipAction||(u.LexerSkipAction={}))}(un)),un}var jt={},Kc;function S0(){if(Kc)return jt;Kc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=jt&&jt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=jt&&jt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(jt,"__esModule",{value:!0}),jt.LexerTypeAction=void 0;const t=je(),i=J();let s=class bd{constructor(r){this._type=r}get type(){return this._type}get actionType(){return 7}get isPositionDependent(){return!1}execute(r){r.type=this._type}hashCode(){let r=t.MurmurHash.initialize();return r=t.MurmurHash.update(r,this.actionType),r=t.MurmurHash.update(r,this._type),t.MurmurHash.finish(r,2)}equals(r){return r===this?!0:r instanceof bd?this._type===r._type:!1}toString(){return`type(${this._type})`}};return u([i.Override],s.prototype,"actionType",null),u([i.Override],s.prototype,"isPositionDependent",null),u([i.Override,e(0,i.NotNull)],s.prototype,"execute",null),u([i.Override],s.prototype,"hashCode",null),u([i.Override],s.prototype,"equals",null),u([i.Override],s.prototype,"toString",null),jt.LexerTypeAction=s,jt}var cn={},Qc;function Nd(){if(Qc)return cn;Qc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=cn&&cn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(cn,"__esModule",{value:!0}),cn.LoopEndState=void 0;const e=pr(),t=Ue(),i=J();let s=class extends e.ATNState{get stateType(){return t.ATNStateType.LOOP_END}};return u([i.Override],s.prototype,"stateType",null),cn.LoopEndState=s,cn}var qt={},hn={},Jc;function A0(){if(Jc)return hn;Jc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=hn&&hn.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c};Object.defineProperty(hn,"__esModule",{value:!0}),hn.ConflictInfo=void 0;const e=J(),t=xr();let i=class Rd{constructor(n,r){this._conflictedAlts=n,this.exact=r}get conflictedAlts(){return this._conflictedAlts}get isExact(){return this.exact}equals(n){return n===this?!0:n instanceof Rd?this.isExact===n.isExact&&t.equals(this.conflictedAlts,n.conflictedAlts):!1}hashCode(){return this.conflictedAlts.hashCode()}};return u([e.Override],i.prototype,"equals",null),u([e.Override],i.prototype,"hashCode",null),hn.ConflictInfo=i,hn}var fn={},dn={},pn={},Zc;function ii(){if(Zc)return pn;Zc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=pn&&pn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(pn,"__esModule",{value:!0}),pn.TerminalNode=void 0;const e=We(),t=J(),i=Be();let s=class{constructor(r){this._symbol=r}getChild(r){throw new RangeError("Terminal Node has no children.")}get symbol(){return this._symbol}get parent(){return this._parent}setParent(r){this._parent=r}get payload(){return this._symbol}get sourceInterval(){let r=this._symbol.tokenIndex;return new e.Interval(r,r)}get childCount(){return 0}accept(r){return r.visitTerminal(this)}get text(){return this._symbol.text||""}toStringTree(r){return this.toString()}toString(){return this._symbol.type===i.Token.EOF?"<EOF>":this._symbol.text||""}};return u([t.Override],s.prototype,"getChild",null),u([t.Override],s.prototype,"parent",null),u([t.Override],s.prototype,"setParent",null),u([t.Override],s.prototype,"payload",null),u([t.Override],s.prototype,"sourceInterval",null),u([t.Override],s.prototype,"childCount",null),u([t.Override],s.prototype,"accept",null),u([t.Override],s.prototype,"text",null),u([t.Override],s.prototype,"toStringTree",null),u([t.Override],s.prototype,"toString",null),pn.TerminalNode=s,pn}var eh;function Kl(){if(eh)return dn;eh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=dn&&dn.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c};Object.defineProperty(dn,"__esModule",{value:!0}),dn.ErrorNode=void 0;const e=J(),t=ii();let i=class extends t.TerminalNode{constructor(n){super(n)}accept(n){return n.visitErrorNode(this)}};return u([e.Override],i.prototype,"accept",null),dn.ErrorNode=i,dn}var xn={},vi={},th;function Ql(){if(th)return vi;th=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(vi,"__esModule",{value:!0}),vi.RuleNode=void 0;let u=class{};return vi.RuleNode=u,vi}var Ut={},rh;function Vn(){if(rh)return Ut;rh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Ut&&Ut.__decorate||function(d,p,v,x){var y=arguments.length,g=y<3?p:x===null?x=Object.getOwnPropertyDescriptor(p,v):x,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(d,p,v,x);else for(var S=d.length-1;S>=0;S--)(m=d[S])&&(g=(y<3?m(g):y>3?m(p,v,g):m(p,v))||g);return y>3&&g&&Object.defineProperty(p,v,g),g},e=Ut&&Ut.__param||function(d,p){return function(v,x){p(v,x,d)}};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.Trees=void 0;const t=ct(),i=qi(),s=Kl(),n=J(),r=Gi(),o=ot(),l=Ql(),c=ii(),a=Be(),h=xr();let f=class vr{static toStringTree(p,v){let x;v instanceof r.Parser?x=v.ruleNames:x=v;let y=h.escapeWhitespace(this.getNodeText(p,x),!1);if(p.childCount===0)return y;let g="";g+="(",y=h.escapeWhitespace(this.getNodeText(p,x),!1),g+=y,g+=" ";for(let m=0;m<p.childCount;m++)m>0&&(g+=" "),g+=this.toStringTree(p.getChild(m),x);return g+=")",g}static getNodeText(p,v){let x;if(v instanceof r.Parser)x=v.ruleNames;else if(v)x=v;else{let y=p.payload;return typeof y.text=="string"?y.text:p.payload.toString()}if(p instanceof l.RuleNode){let y=p.ruleContext,g=y.ruleIndex,m=x[g],S=y.altNumber;return S!==t.ATN.INVALID_ALT_NUMBER?m+":"+S:m}else{if(p instanceof s.ErrorNode)return p.toString();if(p instanceof c.TerminalNode)return p.symbol.text||""}throw new TypeError("Unexpected node type")}static getChildren(p){let v=[];for(let x=0;x<p.childCount;x++)v.push(p.getChild(x));return v}static getAncestors(p){let v=[],x=p.parent;for(;x;)v.unshift(x),x=x.parent;return v}static isAncestorOf(p,v){if(!p||!v||!p.parent)return!1;let x=v.parent;for(;x;){if(p===x)return!0;x=x.parent}return!1}static findAllTokenNodes(p,v){return vr.findAllNodes(p,v,!0)}static findAllRuleNodes(p,v){return vr.findAllNodes(p,v,!1)}static findAllNodes(p,v,x){let y=[];return vr._findAllNodes(p,v,x,y),y}static _findAllNodes(p,v,x,y){x&&p instanceof c.TerminalNode?p.symbol.type===v&&y.push(p):!x&&p instanceof o.ParserRuleContext&&p.ruleIndex===v&&y.push(p);for(let g=0;g<p.childCount;g++)vr._findAllNodes(p.getChild(g),v,x,y)}static getDescendants(p){let v=[];function x(y){v.push(y);const g=y.childCount;for(let m=0;m<g;m++)x(y.getChild(m))}return x(p),v}static getRootOfSubtreeEnclosingRegion(p,v,x){let y=p.childCount;for(let g=0;g<y;g++){let m=p.getChild(g),S=vr.getRootOfSubtreeEnclosingRegion(m,v,x);if(S)return S}if(p instanceof o.ParserRuleContext){let g=p.stop;if(v>=p.start.tokenIndex&&(g==null||x<=g.tokenIndex))return p}}static stripChildrenOutOfRange(p,v,x,y){if(!p)return;let g=p.childCount;for(let m=0;m<g;m++){let S=p.getChild(m),T=S.sourceInterval;if(S instanceof o.ParserRuleContext&&(T.b<x||T.a>y)&&vr.isAncestorOf(S,v)){let A=new i.CommonToken(a.Token.INVALID_TYPE,"...");p.children[m]=new c.TerminalNode(A)}}}static findNodeSuchThat(p,v){if(v(p))return p;let x=p.childCount;for(let y=0;y<x;y++){let g=vr.findNodeSuchThat(p.getChild(y),v);if(g!==void 0)return g}}};return u([e(0,n.NotNull)],f,"toStringTree",null),u([n.NotNull,e(0,n.NotNull)],f,"getAncestors",null),u([e(0,n.NotNull)],f,"getRootOfSubtreeEnclosingRegion",null),Ut.Trees=f,Ut}var nh;function Od(){if(nh)return xn;nh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=xn&&xn.__decorate||function(c,a,h,f){var d=arguments.length,p=d<3?a:f===null?f=Object.getOwnPropertyDescriptor(a,h):f,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,a,h,f);else for(var x=c.length-1;x>=0;x--)(v=c[x])&&(p=(d<3?v(p):d>3?v(a,h,p):v(a,h))||p);return d>3&&p&&Object.defineProperty(a,h,p),p};Object.defineProperty(xn,"__esModule",{value:!0}),xn.RuleContext=void 0;const e=ct(),t=Hi(),i=Ql(),s=We(),n=J(),r=Vn(),o=ot();let l=class wd extends i.RuleNode{constructor(a,h){super(),this._parent=a,this.invokingState=h??-1}static getChildContext(a,h){return new wd(a,h)}depth(){let a=0,h=this;for(;h;)h=h._parent,a++;return a}get isEmpty(){return this.invokingState===-1}get sourceInterval(){return s.Interval.INVALID}get ruleContext(){return this}get parent(){return this._parent}setParent(a){this._parent=a}get payload(){return this}get text(){if(this.childCount===0)return"";let a="";for(let h=0;h<this.childCount;h++)a+=this.getChild(h).text;return a.toString()}get ruleIndex(){return-1}get altNumber(){return e.ATN.INVALID_ALT_NUMBER}set altNumber(a){}getChild(a){throw new RangeError("i must be greater than or equal to 0 and less than childCount")}get childCount(){return 0}accept(a){return a.visitChildren(this)}toStringTree(a){return r.Trees.toStringTree(this,a)}toString(a,h){const f=a instanceof t.Recognizer?a.ruleNames:a;h=h||o.ParserRuleContext.emptyContext();let d="",p=this;for(d+="[";p&&p!==h;){if(!f)p.isEmpty||(d+=p.invokingState);else{let v=p.ruleIndex,x=v>=0&&v<f.length?f[v]:v.toString();d+=x}p._parent&&(f||!p._parent.isEmpty)&&(d+=" "),p=p._parent}return d+="]",d.toString()}};return u([n.Override],l.prototype,"sourceInterval",null),u([n.Override],l.prototype,"ruleContext",null),u([n.Override],l.prototype,"parent",null),u([n.Override],l.prototype,"setParent",null),u([n.Override],l.prototype,"payload",null),u([n.Override],l.prototype,"text",null),u([n.Override],l.prototype,"getChild",null),u([n.Override],l.prototype,"childCount",null),u([n.Override],l.prototype,"accept",null),u([n.Override],l.prototype,"toStringTree",null),xn.RuleContext=l,xn}var ih;function ot(){if(ih)return fn;ih=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=fn&&fn.__decorate||function(o,l,c,a){var h=arguments.length,f=h<3?l:a===null?a=Object.getOwnPropertyDescriptor(l,c):a,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,l,c,a);else for(var p=o.length-1;p>=0;p--)(d=o[p])&&(f=(h<3?d(f):h>3?d(l,c,f):d(l,c))||f);return h>3&&f&&Object.defineProperty(l,c,f),f};Object.defineProperty(fn,"__esModule",{value:!0}),fn.ParserRuleContext=void 0;const e=Kl(),t=We(),i=J(),s=Od(),n=ii();let r=class Cl extends s.RuleContext{constructor(l,c){c==null?super():super(l,c)}static emptyContext(){return Cl.EMPTY}copyFrom(l){if(this._parent=l._parent,this.invokingState=l.invokingState,this._start=l._start,this._stop=l._stop,l.children){this.children=[];for(let c of l.children)c instanceof e.ErrorNode&&this.addChild(c)}}enterRule(l){}exitRule(l){}addAnyChild(l){return this.children?this.children.push(l):this.children=[l],l}addChild(l){if(l instanceof n.TerminalNode){l.setParent(this),this.addAnyChild(l);return}else if(l instanceof s.RuleContext){this.addAnyChild(l);return}else return l=new n.TerminalNode(l),this.addAnyChild(l),l.setParent(this),l}addErrorNode(l){if(l instanceof e.ErrorNode){const c=l;return c.setParent(this),this.addAnyChild(c)}else{const c=l;let a=new e.ErrorNode(c);return this.addAnyChild(a),a.setParent(this),a}}removeLastChild(){this.children&&this.children.pop()}get parent(){let l=super.parent;if(l===void 0||l instanceof Cl)return l;throw new TypeError("Invalid parent type for ParserRuleContext")}getChild(l,c){if(!this.children||l<0||l>=this.children.length)throw new RangeError("index parameter must be between >= 0 and <= number of children.");if(c==null)return this.children[l];let a=this.tryGetChild(l,c);if(a===void 0)throw new Error("The specified node does not exist");return a}tryGetChild(l,c){if(!this.children||l<0||l>=this.children.length)return;let a=-1;for(let h of this.children)if(h instanceof c&&(a++,a===l))return h}getToken(l,c){let a=this.tryGetToken(l,c);if(a===void 0)throw new Error("The specified token does not exist");return a}tryGetToken(l,c){if(!this.children||c<0||c>=this.children.length)return;let a=-1;for(let h of this.children)if(h instanceof n.TerminalNode&&h.symbol.type===l&&(a++,a===c))return h}getTokens(l){let c=[];if(!this.children)return c;for(let a of this.children)a instanceof n.TerminalNode&&a.symbol.type===l&&c.push(a);return c}get ruleContext(){return this}getRuleContext(l,c){return this.getChild(l,c)}tryGetRuleContext(l,c){return this.tryGetChild(l,c)}getRuleContexts(l){let c=[];if(!this.children)return c;for(let a of this.children)a instanceof l&&c.push(a);return c}get childCount(){return this.children?this.children.length:0}get sourceInterval(){return this._start?!this._stop||this._stop.tokenIndex<this._start.tokenIndex?t.Interval.of(this._start.tokenIndex,this._start.tokenIndex-1):t.Interval.of(this._start.tokenIndex,this._stop.tokenIndex):t.Interval.INVALID}get start(){return this._start}get stop(){return this._stop}toInfoString(l){return"ParserRuleContext"+l.getRuleInvocationStack(this).reverse()+"{start="+this._start+", stop="+this._stop+"}"}};return r.EMPTY=new r,u([i.Override],r.prototype,"parent",null),u([i.Override],r.prototype,"childCount",null),u([i.Override],r.prototype,"sourceInterval",null),fn.ParserRuleContext=r,fn}var Si={},oh;function C0(){return oh||(oh=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Si&&Si.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h};Object.defineProperty(u,"__esModule",{value:!0}),u.PredictionMode=void 0;const t=ni(),i=je(),s=J(),n=$i();(function(r){r[r.SLL=0]="SLL",r[r.LL=1]="LL",r[r.LL_EXACT_AMBIG_DETECTION=2]="LL_EXACT_AMBIG_DETECTION"})(u.PredictionMode||(u.PredictionMode={})),function(r){class o extends t.Array2DHashMap{constructor(){super(l.INSTANCE)}}class l{AltAndContextConfigEqualityComparator(){}hashCode(f){let d=i.MurmurHash.initialize(7);return d=i.MurmurHash.update(d,f.state.stateNumber),d=i.MurmurHash.update(d,f.context),d=i.MurmurHash.finish(d,2),d}equals(f,d){return f===d?!0:f==null||d==null?!1:f.state.stateNumber===d.state.stateNumber&&f.context.equals(d.context)}}l.INSTANCE=new l,e([s.Override],l.prototype,"hashCode",null),e([s.Override],l.prototype,"equals",null);function c(h){for(let f of h)if(f.state instanceof n.RuleStopState)return!0;return!1}r.hasConfigInRuleStopState=c;function a(h){for(let f of h)if(!(f.state instanceof n.RuleStopState))return!1;return!0}r.allConfigsInRuleStopStates=a}(u.PredictionMode||(u.PredictionMode={}))}(Si)),Si}var Ht={},sh;function Fd(){if(sh)return Ht;sh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Ht&&Ht.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Ht&&Ht.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.SimulatorState=void 0;const t=J(),i=ot();let s=class{constructor(r,o,l,c){this.outerContext=r??i.ParserRuleContext.emptyContext(),this.s0=o,this.useContext=l,this.remainingOuterContext=c}};return s=u([e(1,t.NotNull)],s),Ht.SimulatorState=s,Ht}var lh;function Vi(){if(lh)return qt;lh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=qt&&qt.__decorate||function(ie,E,C,_){var w=arguments.length,F=w<3?E:_===null?_=Object.getOwnPropertyDescriptor(E,C):_,O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(ie,E,C,_);else for(var D=ie.length-1;D>=0;D--)(O=ie[D])&&(F=(w<3?O(F):w>3?O(E,C,F):O(E,C))||F);return w>3&&F&&Object.defineProperty(E,C,F),F},e=qt&&qt.__param||function(ie,E){return function(C,_){E(C,_,ie)}};Object.defineProperty(qt,"__esModule",{value:!0}),qt.ParserATNSimulator=void 0;const t=ad(),i=Sd(),s=Rr(),n=ql(),r=ct(),o=vo(),l=Ui(),c=Ao(),a=Ue(),h=Ad(),f=wr(),d=A0(),p=Un(),v=So(),x=Ul(),y=We(),g=Tr(),m=J(),S=Yl(),T=To(),A=ut(),b=ot(),N=it(),R=$l(),P=C0(),I=$i(),B=Xl(),V=ri(),ee=Gl(),te=Fd(),le=Be(),ge=Hn(),ce=$e(),Z=65535,Y=-2147483648;let Q=class Ee extends c.ATNSimulator{constructor(E,C){super(E),this.predictionMode=P.PredictionMode.LL,this.force_global_context=!1,this.always_try_local_context=!0,this.enable_global_context_dfa=!1,this.optimize_unique_closure=!0,this.optimize_ll1=!0,this.optimize_tail_calls=!0,this.tail_call_preserves_sll=!0,this.treat_sllk1_conflict_as_ambiguity=!1,this.reportAmbiguities=!1,this.userWantsCtxSensitive=!0,this._parser=C}getPredictionMode(){return this.predictionMode}setPredictionMode(E){this.predictionMode=E}reset(){}adaptivePredict(E,C,_,w){w===void 0&&(w=!1);let F=this.atn.decisionToDFA[C];if(ce(F!=null),this.optimize_ll1&&!F.isPrecedenceDfa&&!F.isEmpty){let H=E.LA(1);if(H>=0&&H<=65535){let W=(C<<16>>>0)+H,L=this.atn.LL1Table.get(W);if(L!=null)return L}}this.dfa=F,this.force_global_context?w=!0:this.always_try_local_context||(w=w||F.isContextSensitive),this.userWantsCtxSensitive=w||this.predictionMode!==P.PredictionMode.SLL&&_!=null&&!this.atn.decisionToState[C].sll,_==null&&(_=b.ParserRuleContext.emptyContext());let O;F.isEmpty||(O=this.getStartState(F,E,_,w)),O==null&&(_==null&&(_=b.ParserRuleContext.emptyContext()),Ee.debug&&console.log("ATN decision "+F.decision+" exec LA(1)=="+this.getLookaheadName(E)+", outerContext="+_.toString(this._parser)),O=this.computeStartState(F,_,w));let D=E.mark(),j=E.index;try{let H=this.execDFA(F,E,j,O);return Ee.debug&&console.log("DFA after predictATN: "+F.toString(this._parser.vocabulary,this._parser.ruleNames)),H}finally{this.dfa=void 0,E.seek(j),E.release(D)}}getStartState(E,C,_,w){if(!w)if(E.isPrecedenceDfa){let D=E.getPrecedenceStartState(this._parser.precedence,!1);return D==null?void 0:new te.SimulatorState(_,D,!1,_)}else return E.s0==null?void 0:new te.SimulatorState(_,E.s0,!1,_);if(!this.enable_global_context_dfa)return;let F=_;ce(_!=null);let O;for(E.isPrecedenceDfa?O=E.getPrecedenceStartState(this._parser.precedence,!0):O=E.s0full;F!=null&&O!=null&&O.isContextSensitive;)F=this.skipTailCalls(F),O=O.getContextTarget(this.getReturnState(F)),F.isEmpty?ce(O==null||!O.isContextSensitive):F=F.parent;if(O!=null)return new te.SimulatorState(_,O,w,F)}execDFA(E,C,_,w){let F=w.outerContext;Ee.dfa_debug&&console.log("DFA decision "+E.decision+" exec LA(1)=="+this.getLookaheadName(C)+", outerContext="+F.toString(this._parser)),Ee.dfa_debug&&console.log(E.toString(this._parser.vocabulary,this._parser.ruleNames));let O=w.s0,D=C.LA(1),j=w.remainingOuterContext;for(;;){if(Ee.dfa_debug&&console.log("DFA state "+O.stateNumber+" LA(1)=="+this.getLookaheadName(C)),w.useContext)for(;O.isContextSymbol(D);){let L;if(j!=null&&(j=this.skipTailCalls(j),L=O.getContextTarget(this.getReturnState(j))),L==null){let M=new te.SimulatorState(w.outerContext,O,w.useContext,j);return this.execATN(E,C,_,M)}ce(j!=null),j=j.parent,O=L}if(this.isAcceptState(O,w.useContext)){O.predicates!=null?Ee.dfa_debug&&console.log("accept "+O):Ee.dfa_debug&&console.log("accept; predict "+O.prediction+" in state "+O.stateNumber);break}ce(!this.isAcceptState(O,w.useContext));let W=this.getExistingTargetState(O,D);if(W==null){Ee.dfa_debug&&D>=0&&console.log("no edge for "+this._parser.vocabulary.getDisplayName(D));let L;if(Ee.dfa_debug){let U=y.Interval.of(_,this._parser.inputStream.index);console.log("ATN exec upon "+this._parser.inputStream.getText(U)+" at DFA state "+O.stateNumber)}let M=new te.SimulatorState(F,O,w.useContext,j);return L=this.execATN(E,C,_,M),Ee.dfa_debug&&console.log("back from DFA update, alt="+L+`, dfa=
`+E.toString(this._parser.vocabulary,this._parser.ruleNames)),Ee.dfa_debug&&console.log("DFA decision "+E.decision+" predicts "+L),L}else if(W===c.ATNSimulator.ERROR){let L=new te.SimulatorState(F,O,w.useContext,j);return this.handleNoViableAlt(C,_,L)}O=W,!this.isAcceptState(O,w.useContext)&&D!==g.IntStream.EOF&&(C.consume(),D=C.LA(1))}if(!w.useContext&&O.configs.conflictInfo!=null&&E.atnStartState instanceof p.DecisionState&&!(!this.userWantsCtxSensitive||!O.configs.dipsIntoOuterContext&&O.configs.isExactConflict||this.treat_sllk1_conflict_as_ambiguity&&C.index===_)){ce(!w.useContext);let W,L=O.predicates;if(L!=null){let M=C.index;if(M!==_&&C.seek(_),W=this.evalSemanticContext(L,F,!0),W.cardinality()===1)return W.nextSetBit(0);M!==_&&C.seek(M)}if(this.reportAmbiguities){let M=new te.SimulatorState(F,O,w.useContext,j);this.reportAttemptingFullContext(E,W,M,_,C.index)}return C.seek(_),this.adaptivePredict(C,E.decision,F,!0)}let H=O.predicates;if(H!=null){let W=C.index;_!==W&&C.seek(_);let L=this.evalSemanticContext(H,F,this.reportAmbiguities&&this.predictionMode===P.PredictionMode.LL_EXACT_AMBIG_DETECTION);switch(L.cardinality()){case 0:throw this.noViableAlt(C,F,O.configs,_);case 1:return L.nextSetBit(0);default:return _!==W&&C.seek(W),this.reportAmbiguity(E,O,_,W,O.configs.isExactConflict,L,O.configs),L.nextSetBit(0)}}return Ee.dfa_debug&&console.log("DFA decision "+E.decision+" predicts "+O.prediction),O.prediction}isAcceptState(E,C){return E.isAcceptState?E.configs.conflictingAlts==null?!0:C&&this.predictionMode===P.PredictionMode.LL_EXACT_AMBIG_DETECTION?E.configs.isExactConflict:!0:!1}execATN(E,C,_,w){Ee.debug&&console.log("execATN decision "+E.decision+" exec LA(1)=="+this.getLookaheadName(C));let F=w.outerContext,O=w.useContext,D=C.LA(1),j=w,H=new R.PredictionContextCache;for(;;){let W=this.computeReachSet(E,j,D,H);if(W==null)return this.setDFAEdge(j.s0,C.LA(1),c.ATNSimulator.ERROR),this.handleNoViableAlt(C,_,j);let L=W.s0;if(ce(L.isAcceptState||L.prediction===r.ATN.INVALID_ALT_NUMBER),ce(L.isAcceptState||L.configs.conflictInfo==null),this.isAcceptState(L,O)){let M=L.configs.conflictingAlts,U=M==null?L.prediction:r.ATN.INVALID_ALT_NUMBER;if(U!==r.ATN.INVALID_ALT_NUMBER){if(this.optimize_ll1&&C.index===_&&!E.isPrecedenceDfa&&W.outerContext===W.remainingOuterContext&&E.decision>=0&&!L.configs.hasSemanticContext&&D>=0&&D<=Z){let re=(E.decision<<16>>>0)+D;this.atn.LL1Table.set(re,U)}O&&this.always_try_local_context&&this.reportContextSensitivity(E,U,W,_,C.index)}U=L.prediction;let G=M!=null&&this.userWantsCtxSensitive;if(G&&(G=!O&&(L.configs.dipsIntoOuterContext||!L.configs.isExactConflict)&&(!this.treat_sllk1_conflict_as_ambiguity||C.index!==_)),L.configs.hasSemanticContext){let re=L.predicates;if(re!=null){let ne=C.index;switch(ne!==_&&C.seek(_),M=this.evalSemanticContext(re,F,G||this.reportAmbiguities),M.cardinality()){case 0:throw this.noViableAlt(C,F,L.configs,_);case 1:return M.nextSetBit(0)}ne!==_&&C.seek(ne)}}if(G){ce(!O),ce(this.isAcceptState(L,!1)),Ee.debug&&console.log("RETRY with outerContext="+F);let re=this.computeStartState(E,F,!0);return this.reportAmbiguities&&this.reportAttemptingFullContext(E,M,W,_,C.index),C.seek(_),this.execATN(E,C,_,re)}else return M!=null&&(this.reportAmbiguities&&M.cardinality()>1&&this.reportAmbiguity(E,L,_,C.index,L.configs.isExactConflict,M,L.configs),U=M.nextSetBit(0)),U}j=W,D!==g.IntStream.EOF&&(C.consume(),D=C.LA(1))}}handleNoViableAlt(E,C,_){if(_.s0!=null){let w=new f.BitSet,F=0;for(let O of _.s0.configs)(O.reachesIntoOuterContext||O.state instanceof I.RuleStopState)&&(w.set(O.alt),F=Math.max(F,O.alt));switch(w.cardinality()){case 0:break;case 1:return w.nextSetBit(0);default:if(!_.s0.configs.hasSemanticContext)return w.nextSetBit(0);let O=new l.ATNConfigSet;for(let j of _.s0.configs)(j.reachesIntoOuterContext||j.state instanceof I.RuleStopState)&&O.add(j);let D=this.getPredsForAmbigAlts(w,O,F);if(D!=null){let j=this.getPredicatePredictions(w,D);if(j!=null){let H=E.index;try{E.seek(C);let W=this.evalSemanticContext(j,_.outerContext,!1);if(!W.isEmpty)return W.nextSetBit(0)}finally{E.seek(H)}}}return w.nextSetBit(0)}}throw this.noViableAlt(E,_.outerContext,_.s0.configs,C)}computeReachSet(E,C,_,w){let F=C.useContext,O=C.remainingOuterContext,D=C.s0;if(F)for(;D.isContextSymbol(_);){let W;if(O!=null&&(O=this.skipTailCalls(O),W=D.getContextTarget(this.getReturnState(O))),W==null)break;ce(O!=null),O=O.parent,D=W}if(ce(!this.isAcceptState(D,F)),this.isAcceptState(D,F))return new te.SimulatorState(C.outerContext,D,F,O);let j=D,H=this.getExistingTargetState(j,_);if(H==null){let W=this.computeTargetState(E,j,O,_,F,w);H=W[0],O=W[1]}if(H!==c.ATNSimulator.ERROR)return ce(!F||!H.configs.dipsIntoOuterContext),new te.SimulatorState(C.outerContext,H,F,O)}getExistingTargetState(E,C){return E.getTarget(C)}computeTargetState(E,C,_,w,F,O){let D=C.configs.toArray(),j,H=new l.ATNConfigSet,W;do{let M=!F||_!=null;M||(H.isOutermostConfigSet=!0);let U=new l.ATNConfigSet,G;for(let q of D){if(Ee.debug&&console.log("testing "+this.getTokenName(w)+" at "+q.toString()),q.state instanceof I.RuleStopState){ce(q.context.isEmpty),(F&&!q.reachesIntoOuterContext||w===g.IntStream.EOF)&&(G==null&&(G=[]),G.push(q));continue}let X=q.state.numberOfOptimizedTransitions;for(let he=0;he<X;he++){let Te=q.state.getOptimizedTransition(he),Ne=this.getReachableTarget(q,Te,w);Ne!=null&&U.add(q.transform(Ne,!1),O)}}if(this.optimize_unique_closure&&G==null&&w!==le.Token.EOF&&U.uniqueAlt!==r.ATN.INVALID_ALT_NUMBER){U.isOutermostConfigSet=H.isOutermostConfigSet,H=U;break}let re=!1,ne=w===le.Token.EOF;if(this.closure(U,H,re,M,O,ne),W=H.dipsIntoOuterContext,w===g.IntStream.EOF&&(H=this.removeAllConfigsNotInRuleStopState(H,O)),G!=null&&(!F||!P.PredictionMode.hasConfigInRuleStopState(H))){ce(G.length>0);for(let q of G)H.add(q,O)}if(F&&W){H.clear(),_=_,_=this.skipTailCalls(_);let q=this.getReturnState(_);if(j==null&&(j=new x.IntegerList),_.isEmpty?_=void 0:_=_.parent,j.add(q),q!==N.PredictionContext.EMPTY_FULL_STATE_KEY)for(let X=0;X<D.length;X++)D[X]=D[X].appendContext(q,O)}}while(F&&W);return H.isEmpty?(this.setDFAEdge(C,w,c.ATNSimulator.ERROR),[c.ATNSimulator.ERROR,_]):[this.addDFAEdge(E,C,w,j,H,O),_]}removeAllConfigsNotInRuleStopState(E,C){if(P.PredictionMode.allConfigsInRuleStopStates(E))return E;let _=new l.ATNConfigSet;for(let w of E)w.state instanceof I.RuleStopState&&_.add(w,C);return _}computeStartState(E,C,_){let w=E.isPrecedenceDfa?E.getPrecedenceStartState(this._parser.precedence,_):_?E.s0full:E.s0;if(w!=null){if(!_)return new te.SimulatorState(C,w,_,C);w.setContextSensitive(this.atn)}E.decision;let F=E.atnStartState,O=0,D=C,j=_?N.PredictionContext.EMPTY_FULL:N.PredictionContext.EMPTY_LOCAL,H=new R.PredictionContextCache;if(_){if(!this.enable_global_context_dfa)for(;D!=null;)D.isEmpty?(O=N.PredictionContext.EMPTY_FULL_STATE_KEY,D=void 0):(O=this.getReturnState(D),j=j.appendSingleContext(O,H),D=D.parent);for(;w!=null&&w.isContextSensitive&&D!=null;){let L;if(D=this.skipTailCalls(D),D.isEmpty?(L=w.getContextTarget(N.PredictionContext.EMPTY_FULL_STATE_KEY),O=N.PredictionContext.EMPTY_FULL_STATE_KEY,D=void 0):(O=this.getReturnState(D),L=w.getContextTarget(O),j=j.appendSingleContext(O,H),D=D.parent),L==null)break;w=L}}if(w!=null&&!w.isContextSensitive)return new te.SimulatorState(C,w,_,D);let W=new l.ATNConfigSet;for(;;){let L=new l.ATNConfigSet,M=F.numberOfTransitions;for(let X=0;X<M;X++){let he=F.transition(X).target;L.add(o.ATNConfig.create(he,X+1,j))}let U=D!=null;U||(W.isOutermostConfigSet=!0),this.closure(L,W,!0,U,H,!1);let re=W.dipsIntoOuterContext,ne;if(_&&!this.enable_global_context_dfa){w=this.addDFAState(E,W,H);break}else w==null?E.isPrecedenceDfa?(W=this.applyPrecedenceFilter(W,C,H),ne=this.addDFAState(E,W,H),E.setPrecedenceStartState(this._parser.precedence,_,ne)):(ne=this.addDFAState(E,W,H),_?E.s0full?ne=E.s0full:E.s0full=ne:E.s0?ne=E.s0:E.s0=ne):(E.isPrecedenceDfa&&(W=this.applyPrecedenceFilter(W,C,H)),ne=this.addDFAState(E,W,H),w.setContextTarget(O,ne));if(w=ne,!_||!re)break;ne.setContextSensitive(this.atn),D=D,W.clear(),D=this.skipTailCalls(D);let q=this.getReturnState(D);D.isEmpty?D=void 0:D=D.parent,q!==N.PredictionContext.EMPTY_FULL_STATE_KEY&&(j=j.appendSingleContext(q,H)),O=q}return new te.SimulatorState(C,w,_,D)}applyPrecedenceFilter(E,C,_){let w=new Map,F=new l.ATNConfigSet;for(let O of E){if(O.alt!==1)continue;let D=O.semanticContext.evalPrecedence(this._parser,C);D!=null&&(w.set(O.state.stateNumber,O.context),D!==O.semanticContext?F.add(O.transform(O.state,!1,D),_):F.add(O,_))}for(let O of E)if(O.alt!==1){if(!O.isPrecedenceFilterSuppressed){let D=w.get(O.state.stateNumber);if(D!=null&&D.equals(O.context))continue}F.add(O,_)}return F}getReachableTarget(E,C,_){if(C.matches(_,0,this.atn.maxTokenType))return C.target}predicateDFAState(E,C,_){let w=this.getConflictingAltsFromConfigSet(C);if(!w)throw new Error("This unhandled scenario is intended to be unreachable, but I'm currently not sure of why we know that's the case.");Ee.debug&&console.log("predicateDFAState "+E);let F=this.getPredsForAmbigAlts(w,C,_),O;return F!=null&&(O=this.getPredicatePredictions(w,F),E.predicates=O),O}getPredsForAmbigAlts(E,C,_){let w=new Array(_+1),F=w.length;for(let j of C)E.get(j.alt)&&(w[j.alt]=V.SemanticContext.or(w[j.alt],j.semanticContext));let O=0;for(let j=0;j<F;j++)w[j]==null?w[j]=V.SemanticContext.NONE:w[j]!==V.SemanticContext.NONE&&O++;let D=w;return O===0&&(D=void 0),Ee.debug&&console.log("getPredsForAmbigAlts result "+(D?n.Arrays.toString(D):"undefined")),D}getPredicatePredictions(E,C){let _=[],w=!1;for(let F=1;F<C.length;F++){let O=C[F];ce(O!=null),E!=null&&E.get(F)&&O===V.SemanticContext.NONE?_.push(new v.DFAState.PredPrediction(O,F)):O!==V.SemanticContext.NONE&&(w=!0,_.push(new v.DFAState.PredPrediction(O,F)))}if(w)return _}evalSemanticContext(E,C,_){let w=new f.BitSet;for(let F of E){if(F.pred===V.SemanticContext.NONE){if(w.set(F.alt),!_)break;continue}let O=this.evalSemanticContextImpl(F.pred,C,F.alt);if((Ee.debug||Ee.dfa_debug)&&console.log("eval pred "+F+"="+O),O&&((Ee.debug||Ee.dfa_debug)&&console.log("PREDICT "+F.alt),w.set(F.alt),!_))break}return w}evalSemanticContextImpl(E,C,_){return E.eval(this._parser,C)}closure(E,C,_,w,F,O){F==null&&(F=R.PredictionContextCache.UNCACHED);let D=E,j=new s.Array2DHashSet(A.ObjectEqualityComparator.INSTANCE);for(;D.size>0;){let H=new l.ATNConfigSet;for(let W of D)this.closureImpl(W,C,H,j,_,w,F,0,O);D=H}}closureImpl(E,C,_,w,F,O,D,j,H){if(Ee.debug&&console.log("closure("+E.toString(this._parser,!0)+")"),E.state instanceof I.RuleStopState)if(E.context.isEmpty)if(O)Ee.debug&&console.log("FALLING off rule "+this.getRuleName(E.state.ruleIndex)),E.context===N.PredictionContext.EMPTY_FULL?E=E.transform(E.state,!1,N.PredictionContext.EMPTY_LOCAL):!E.reachesIntoOuterContext&&N.PredictionContext.isEmptyLocal(E.context)&&C.add(E,D);else{C.add(E,D);return}else{let L=E.context.hasEmpty,M=E.context.size-(L?1:0);for(let U=0;U<M;U++){let G=E.context.getParent(U),re=this.atn.states[E.context.getReturnState(U)],ne=o.ATNConfig.create(re,E.alt,G,E.semanticContext);ne.outerContextDepth=E.outerContextDepth,ne.isPrecedenceFilterSuppressed=E.isPrecedenceFilterSuppressed,ce(j>Y),this.closureImpl(ne,C,_,w,F,O,D,j-1,H)}if(!L||!O)return;E=E.transform(E.state,!1,N.PredictionContext.EMPTY_LOCAL)}let W=E.state;W.onlyHasEpsilonTransitions||(C.add(E,D),Ee.debug&&console.log("added config "+C));for(let L=0;L<W.numberOfOptimizedTransitions;L++){if(L===0&&W.stateType===a.ATNStateType.STAR_LOOP_ENTRY&&W.precedenceRuleDecision&&!E.context.hasEmpty){let re=W,ne=!0;for(let q=0;q<E.context.size;q++)if(!re.precedenceLoopbackStates.get(E.context.getReturnState(q))){ne=!1;break}if(ne)continue}let M=W.getOptimizedTransition(L),U=!(M instanceof i.ActionTransition)&&F,G=this.getEpsilonTarget(E,M,U,j===0,D,H);if(G!=null){if(M instanceof B.RuleTransition&&_!=null&&!F){_.add(G,D);continue}let re=j;if(E.state instanceof I.RuleStopState){if(this.dfa!=null&&this.dfa.isPrecedenceDfa&&M.outermostPrecedenceReturn===this.dfa.atnStartState.ruleIndex&&(G.isPrecedenceFilterSuppressed=!0),G.outerContextDepth=G.outerContextDepth+1,!w.add(G))continue;ce(re>Y),re--,Ee.debug&&console.log("dips into outer ctx: "+G)}else if(M instanceof B.RuleTransition)this.optimize_tail_calls&&M.optimizedTailCall&&(!this.tail_call_preserves_sll||!N.PredictionContext.isEmptyLocal(E.context))?(ce(G.context===E.context),re===0&&(re--,!this.tail_call_preserves_sll&&N.PredictionContext.isEmptyLocal(E.context)&&(G.outerContextDepth=G.outerContextDepth+1))):re>=0&&re++;else if(!M.isEpsilon&&!w.add(G))continue;this.closureImpl(G,C,_,w,U,O,D,re,H)}}}getRuleName(E){return this._parser!=null&&E>=0?this._parser.ruleNames[E]:"<rule "+E+">"}getEpsilonTarget(E,C,_,w,F,O){switch(C.serializationType){case 3:return this.ruleTransition(E,C,F);case 10:return this.precedenceTransition(E,C,_,w);case 4:return this.predTransition(E,C,_,w);case 6:return this.actionTransition(E,C);case 1:return E.transform(C.target,!1);case 5:case 2:case 7:return O&&C.matches(le.Token.EOF,0,1)?E.transform(C.target,!1):void 0;default:return}}actionTransition(E,C){return Ee.debug&&console.log("ACTION edge "+C.ruleIndex+":"+C.actionIndex),E.transform(C.target,!1)}precedenceTransition(E,C,_,w){Ee.debug&&(console.log("PRED (collectPredicates="+_+") "+C.precedence+">=_p, ctx dependent=true"),this._parser!=null&&console.log("context surrounding pred is "+this._parser.getRuleInvocationStack()));let F;if(_&&w){let O=V.SemanticContext.and(E.semanticContext,C.predicate);F=E.transform(C.target,!1,O)}else F=E.transform(C.target,!1);return Ee.debug&&console.log("config from pred transition="+F),F}predTransition(E,C,_,w){Ee.debug&&(console.log("PRED (collectPredicates="+_+") "+C.ruleIndex+":"+C.predIndex+", ctx dependent="+C.isCtxDependent),this._parser!=null&&console.log("context surrounding pred is "+this._parser.getRuleInvocationStack()));let F;if(_&&(!C.isCtxDependent||C.isCtxDependent&&w)){let O=V.SemanticContext.and(E.semanticContext,C.predicate);F=E.transform(C.target,!1,O)}else F=E.transform(C.target,!1);return Ee.debug&&console.log("config from pred transition="+F),F}ruleTransition(E,C,_){Ee.debug&&console.log("CALL rule "+this.getRuleName(C.target.ruleIndex)+", ctx="+E.context);let w=C.followState,F;return this.optimize_tail_calls&&C.optimizedTailCall&&(!this.tail_call_preserves_sll||!N.PredictionContext.isEmptyLocal(E.context))?F=E.context:_!=null?F=_.getChild(E.context,w.stateNumber):F=E.context.getChild(w.stateNumber),E.transform(C.target,!1,F)}isConflicted(E,C){if(E.uniqueAlt!==r.ATN.INVALID_ALT_NUMBER||E.size<=1)return;let _=E.toArray();_.sort(Ee.STATE_ALT_SORT_COMPARATOR);let w=!E.dipsIntoOuterContext,F=new f.BitSet,O=_[0].alt;F.set(O);let D=_[0].state.nonStopStateNumber;for(let M of _){let U=M.state.nonStopStateNumber;if(U!==D){if(M.alt!==O)return;D=U}}let j;if(w){D=_[0].state.nonStopStateNumber,j=new f.BitSet;let M=O;for(let G of _){if(G.state.nonStopStateNumber!==D)break;let re=G.alt;j.set(re),M=re}D=_[0].state.nonStopStateNumber;let U=O;for(let G of _){let re=G.state.nonStopStateNumber,ne=G.alt;if(re!==D){if(U!==M){w=!1;break}D=re,U=O}else if(ne!==U){if(ne!==j.nextSetBit(U+1)){w=!1;break}U=ne}}}D=_[0].state.nonStopStateNumber;let H=0,W=0,L=_[0].context;for(let M=1;M<_.length;M++){let U=_[M];if(U.alt!==O||U.state.nonStopStateNumber!==D)break;W=M,L=C.join(L,_[M].context)}for(let M=W+1;M<_.length;M++){let U=_[M],G=U.state;if(F.set(U.alt),G.nonStopStateNumber!==D){D=G.nonStopStateNumber,H=M,W=M,L=U.context;for(let he=H+1;he<_.length;he++){let Te=_[he];if(Te.alt!==O||Te.state.nonStopStateNumber!==D)break;W=he,L=C.join(L,Te.context)}M=W;continue}let re=U.context,ne=U.alt,q=M;for(let he=q+1;he<_.length;he++){let Te=_[he];if(Te.alt!==ne||Te.state.nonStopStateNumber!==D)break;q=he,re=C.join(re,Te.context)}M=q;let X=C.join(L,re);if(!L.equals(X))return;w=w&&L.equals(re)}return new d.ConflictInfo(F,w)}getConflictingAltsFromConfigSet(E){let C=E.conflictingAlts;return C==null&&E.uniqueAlt!==r.ATN.INVALID_ALT_NUMBER&&(C=new f.BitSet,C.set(E.uniqueAlt)),C}getTokenName(E){if(E===le.Token.EOF)return"EOF";let _=(this._parser!=null?this._parser.vocabulary:ge.VocabularyImpl.EMPTY_VOCABULARY).getDisplayName(E);return _===String(E)?_:_+"<"+E+">"}getLookaheadName(E){return this.getTokenName(E.LA(1))}dumpDeadEndConfigs(E){console.log("dead end configs: ");let C=E.deadEndConfigs;if(C)for(let _ of C){let w="no edges";if(_.state.numberOfOptimizedTransitions>0){let F=_.state.getOptimizedTransition(0);F instanceof h.AtomTransition?w="Atom "+this.getTokenName(F._label):F instanceof ee.SetTransition&&(w=(F instanceof S.NotSetTransition?"~":"")+"Set "+F.set.toString())}console.log(_.toString(this._parser,!0)+":"+w)}}noViableAlt(E,C,_,w){return new T.NoViableAltException(this._parser,E,E.get(w),E.LT(1),_,C)}getUniqueAlt(E){let C=r.ATN.INVALID_ALT_NUMBER;for(let _ of E)if(C===r.ATN.INVALID_ALT_NUMBER)C=_.alt;else if(_.alt!==C)return r.ATN.INVALID_ALT_NUMBER;return C}configWithAltAtStopState(E,C){for(let _ of E)if(_.alt===C&&_.state instanceof I.RuleStopState)return!0;return!1}addDFAEdge(E,C,_,w,F,O){ce(w==null||w.isEmpty||E.isContextSensitive);let D=C,j=this.addDFAState(E,F,O);if(w!=null)for(let H of w.toArray()){if(H===N.PredictionContext.EMPTY_FULL_STATE_KEY&&D.configs.isOutermostConfigSet)continue;D.setContextSensitive(this.atn),D.setContextSymbol(_);let W=D.getContextTarget(H);if(W!=null){D=W;continue}W=this.addDFAContextState(E,D.configs,H,O),ce(H!==N.PredictionContext.EMPTY_FULL_STATE_KEY||W.configs.isOutermostConfigSet),D.setContextTarget(H,W),D=W}return Ee.debug&&console.log("EDGE "+D+" -> "+j+" upon "+this.getTokenName(_)),this.setDFAEdge(D,_,j),Ee.debug&&console.log(`DFA=
`+E.toString(this._parser!=null?this._parser.vocabulary:ge.VocabularyImpl.EMPTY_VOCABULARY,this._parser!=null?this._parser.ruleNames:void 0)),j}setDFAEdge(E,C,_){E!=null&&E.setTarget(C,_)}addDFAContextState(E,C,_,w){if(_!==N.PredictionContext.EMPTY_FULL_STATE_KEY){let F=new l.ATNConfigSet;for(let O of C)F.add(O.appendContext(_,w));return this.addDFAState(E,F,w)}else return ce(!C.isOutermostConfigSet,"Shouldn't be adding a duplicate edge."),C=C.clone(!0),C.isOutermostConfigSet=!0,this.addDFAState(E,C,w)}addDFAState(E,C,_){let w=this.enable_global_context_dfa||!C.isOutermostConfigSet;if(w){C.isReadOnly||C.optimizeConfigs(this);let H=this.createDFAState(E,C),W=E.states.get(H);if(W!=null)return W}C.isReadOnly||C.conflictInfo==null&&(C.conflictInfo=this.isConflicted(C,_));let F=this.createDFAState(E,C.clone(!0)),O=this.atn.getDecisionState(E.decision),D=this.getUniqueAlt(C);if(D!==r.ATN.INVALID_ALT_NUMBER)F.acceptStateInfo=new t.AcceptStateInfo(D);else if(C.conflictingAlts!=null){let H=C.conflictingAlts;H&&(F.acceptStateInfo=new t.AcceptStateInfo(H.nextSetBit(0)))}if(F.isAcceptState&&C.hasSemanticContext&&this.predicateDFAState(F,C,O.numberOfTransitions),!w)return F;let j=E.addState(F);return Ee.debug&&j===F&&console.log("adding new DFA state: "+F),j}createDFAState(E,C){return new v.DFAState(C)}reportAttemptingFullContext(E,C,_,w,F){if(Ee.debug||Ee.retry_debug){let O=y.Interval.of(w,F);console.log("reportAttemptingFullContext decision="+E.decision+":"+_.s0.configs+", input="+this._parser.inputStream.getText(O))}if(this._parser!=null){let O=this._parser.getErrorListenerDispatch();O.reportAttemptingFullContext&&O.reportAttemptingFullContext(this._parser,E,w,F,C,_)}}reportContextSensitivity(E,C,_,w,F){if(Ee.debug||Ee.retry_debug){let O=y.Interval.of(w,F);console.log("reportContextSensitivity decision="+E.decision+":"+_.s0.configs+", input="+this._parser.inputStream.getText(O))}if(this._parser!=null){let O=this._parser.getErrorListenerDispatch();O.reportContextSensitivity&&O.reportContextSensitivity(this._parser,E,w,F,C,_)}}reportAmbiguity(E,C,_,w,F,O,D){if(Ee.debug||Ee.retry_debug){let j=y.Interval.of(_,w);console.log("reportAmbiguity "+O+":"+D+", input="+this._parser.inputStream.getText(j))}if(this._parser!=null){let j=this._parser.getErrorListenerDispatch();j.reportAmbiguity&&j.reportAmbiguity(this._parser,E,_,w,F,O,D)}}getReturnState(E){return E.isEmpty?N.PredictionContext.EMPTY_FULL_STATE_KEY:this.atn.states[E.invokingState].transition(0).followState.stateNumber}skipTailCalls(E){if(!this.optimize_tail_calls)return E;for(;!E.isEmpty;){let C=this.atn.states[E.invokingState];if(ce(C.numberOfTransitions===1&&C.transition(0).serializationType===3),!C.transition(0).tailCall)break;E=E.parent}return E}get parser(){return this._parser}};return Q.debug=!1,Q.dfa_debug=!1,Q.retry_debug=!1,Q.STATE_ALT_SORT_COMPARATOR=(ie,E)=>{let C=ie.state.nonStopStateNumber-E.state.nonStopStateNumber;return C!==0||(C=ie.alt-E.alt,C!==0)?C:0},u([m.NotNull],Q.prototype,"predictionMode",void 0),u([m.NotNull],Q.prototype,"getPredictionMode",null),u([e(0,m.NotNull)],Q.prototype,"setPredictionMode",null),u([m.Override],Q.prototype,"reset",null),u([e(0,m.NotNull)],Q.prototype,"adaptivePredict",null),u([e(0,m.NotNull),e(1,m.NotNull),e(2,m.NotNull)],Q.prototype,"getStartState",null),u([e(0,m.NotNull),e(1,m.NotNull),e(3,m.NotNull)],Q.prototype,"execDFA",null),u([e(0,m.NotNull),e(1,m.NotNull),e(3,m.NotNull)],Q.prototype,"execATN",null),u([e(0,m.NotNull),e(2,m.NotNull)],Q.prototype,"handleNoViableAlt",null),u([e(0,m.NotNull)],Q.prototype,"getExistingTargetState",null),u([m.NotNull,e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"computeTargetState",null),u([m.NotNull,e(0,m.NotNull)],Q.prototype,"removeAllConfigsNotInRuleStopState",null),u([m.NotNull],Q.prototype,"computeStartState",null),u([m.NotNull,e(0,m.NotNull)],Q.prototype,"applyPrecedenceFilter",null),u([e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"getReachableTarget",null),u([e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"getPredsForAmbigAlts",null),u([e(0,m.NotNull)],Q.prototype,"evalSemanticContext",null),u([e(0,m.NotNull)],Q.prototype,"evalSemanticContextImpl",null),u([e(1,m.NotNull),e(4,m.Nullable)],Q.prototype,"closure",null),u([e(0,m.NotNull),e(1,m.NotNull),e(2,m.Nullable),e(3,m.NotNull),e(6,m.NotNull)],Q.prototype,"closureImpl",null),u([m.NotNull],Q.prototype,"getRuleName",null),u([e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"getEpsilonTarget",null),u([m.NotNull,e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"actionTransition",null),u([m.Nullable,e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"precedenceTransition",null),u([m.Nullable,e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"predTransition",null),u([m.NotNull,e(0,m.NotNull),e(1,m.NotNull),e(2,m.Nullable)],Q.prototype,"ruleTransition",null),u([e(0,m.NotNull)],Q.prototype,"isConflicted",null),u([m.NotNull],Q.prototype,"getTokenName",null),u([e(0,m.NotNull)],Q.prototype,"dumpDeadEndConfigs",null),u([m.NotNull,e(0,m.NotNull),e(1,m.NotNull),e(2,m.NotNull)],Q.prototype,"noViableAlt",null),u([e(0,m.NotNull)],Q.prototype,"getUniqueAlt",null),u([e(0,m.NotNull)],Q.prototype,"configWithAltAtStopState",null),u([m.NotNull,e(0,m.NotNull),e(1,m.NotNull),e(4,m.NotNull)],Q.prototype,"addDFAEdge",null),u([e(0,m.Nullable),e(2,m.Nullable)],Q.prototype,"setDFAEdge",null),u([m.NotNull,e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"addDFAContextState",null),u([m.NotNull,e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"addDFAState",null),u([m.NotNull,e(0,m.NotNull),e(1,m.NotNull)],Q.prototype,"createDFAState",null),u([e(0,m.NotNull),e(2,m.NotNull)],Q.prototype,"reportAttemptingFullContext",null),u([e(0,m.NotNull),e(2,m.NotNull)],Q.prototype,"reportContextSensitivity",null),u([e(0,m.NotNull),e(5,m.NotNull),e(6,m.NotNull)],Q.prototype,"reportAmbiguity",null),Q=u([e(0,m.NotNull)],Q),qt.ParserATNSimulator=Q,qt}var mn={},ah;function E0(){if(ah)return mn;ah=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=mn&&mn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(mn,"__esModule",{value:!0}),mn.PlusBlockStartState=void 0;const e=Ue(),t=_o(),i=J();let s=class extends t.BlockStartState{get stateType(){return e.ATNStateType.PLUS_BLOCK_START}};return u([i.Override],s.prototype,"stateType",null),mn.PlusBlockStartState=s,mn}var gn={},uh;function _0(){if(uh)return gn;uh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=gn&&gn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(gn,"__esModule",{value:!0}),gn.PlusLoopbackState=void 0;const e=Ue(),t=Un(),i=J();let s=class extends t.DecisionState{get stateType(){return e.ATNStateType.PLUS_LOOP_BACK}};return u([i.Override],s.prototype,"stateType",null),gn.PlusLoopbackState=s,gn}var $t={},ch;function T0(){if(ch)return $t;ch=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=$t&&$t.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=$t&&$t.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty($t,"__esModule",{value:!0}),$t.PrecedencePredicateTransition=void 0;const t=jl(),i=J(),s=ri();let n=class extends t.AbstractPredicateTransition{constructor(o,l){super(o),this.precedence=l}get serializationType(){return 10}get isEpsilon(){return!0}matches(o,l,c){return!1}get predicate(){return new s.SemanticContext.PrecedencePredicate(this.precedence)}toString(){return this.precedence+" >= _p"}};return u([i.Override],n.prototype,"serializationType",null),u([i.Override],n.prototype,"isEpsilon",null),u([i.Override],n.prototype,"matches",null),u([i.Override],n.prototype,"toString",null),n=u([e(0,i.NotNull)],n),$t.PrecedencePredicateTransition=n,$t}var Vt={},hh;function b0(){if(hh)return Vt;hh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Vt&&Vt.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=Vt&&Vt.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.RangeTransition=void 0;const t=$n(),i=J(),s=Nr();let n=class extends s.Transition{constructor(o,l,c){super(o),this.from=l,this.to=c}get serializationType(){return 2}get label(){return t.IntervalSet.of(this.from,this.to)}matches(o,l,c){return o>=this.from&&o<=this.to}toString(){return"'"+String.fromCodePoint(this.from)+"'..'"+String.fromCodePoint(this.to)+"'"}};return u([i.Override],n.prototype,"serializationType",null),u([i.Override,i.NotNull],n.prototype,"label",null),u([i.Override],n.prototype,"matches",null),u([i.Override,i.NotNull],n.prototype,"toString",null),n=u([e(0,i.NotNull)],n),Vt.RangeTransition=n,Vt}var yn={},fh;function N0(){if(fh)return yn;fh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=yn&&yn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(yn,"__esModule",{value:!0}),yn.RuleStartState=void 0;const e=pr(),t=Ue(),i=J();let s=class extends e.ATNState{constructor(){super(...arguments),this.isPrecedenceRule=!1,this.leftFactored=!1}get stateType(){return t.ATNStateType.RULE_START}};return u([i.Override],s.prototype,"stateType",null),yn.RuleStartState=s,yn}var vn={},dh;function R0(){if(dh)return vn;dh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=vn&&vn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(vn,"__esModule",{value:!0}),vn.StarBlockStartState=void 0;const e=Ue(),t=_o(),i=J();let s=class extends t.BlockStartState{get stateType(){return e.ATNStateType.STAR_BLOCK_START}};return u([i.Override],s.prototype,"stateType",null),vn.StarBlockStartState=s,vn}var Sn={},ph;function w0(){if(ph)return Sn;ph=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Sn&&Sn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.StarLoopbackState=void 0;const e=pr(),t=Ue(),i=J();let s=class extends e.ATNState{get loopEntryState(){return this.transition(0).target}get stateType(){return t.ATNStateType.STAR_LOOP_BACK}};return u([i.Override],s.prototype,"stateType",null),Sn.StarLoopbackState=s,Sn}var An={},xh;function O0(){if(xh)return An;xh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=An&&An.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(An,"__esModule",{value:!0}),An.TokensStartState=void 0;const e=Ue(),t=Un(),i=J();let s=class extends t.DecisionState{get stateType(){return e.ATNStateType.TOKEN_START}};return u([i.Override],s.prototype,"stateType",null),An.TokensStartState=s,An}var Ai={},mh;function F0(){if(mh)return Ai;mh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.UUID=void 0;const u=je();let e=class El{constructor(i,s,n,r){this.data=new Uint32Array(4),this.data[0]=i,this.data[1]=s,this.data[2]=n,this.data[3]=r}static fromString(i){if(!/^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$/.test(i))throw new Error("Incorrectly formatted UUID");let s=i.split("-"),n=parseInt(s[0],16),r=(parseInt(s[1],16)<<16>>>0)+parseInt(s[2],16),o=(parseInt(s[3],16)<<16>>>0)+parseInt(s[4].substr(0,4),16),l=parseInt(s[4].substr(-8),16);return new El(n,r,o,l)}hashCode(){return u.MurmurHash.hashCode([this.data[0],this.data[1],this.data[2],this.data[3]])}equals(i){return i===this?!0:i instanceof El?this.data[0]===i.data[0]&&this.data[1]===i.data[1]&&this.data[2]===i.data[2]&&this.data[3]===i.data[3]:!1}toString(){return("00000000"+this.data[0].toString(16)).substr(-8)+"-"+("0000"+(this.data[1]>>>16).toString(16)).substr(-4)+"-"+("0000"+this.data[1].toString(16)).substr(-4)+"-"+("0000"+(this.data[2]>>>16).toString(16)).substr(-4)+"-"+("0000"+this.data[2].toString(16)).substr(-4)+("00000000"+this.data[3].toString(16)).substr(-8)}};return Ai.UUID=e,Ai}var gh;function Jl(){if(gh)return Pt;gh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Pt&&Pt.__decorate||function(W,L,M,U){var G=arguments.length,re=G<3?L:U===null?U=Object.getOwnPropertyDescriptor(L,M):U,ne;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")re=Reflect.decorate(W,L,M,U);else for(var q=W.length-1;q>=0;q--)(ne=W[q])&&(re=(G<3?ne(re):G>3?ne(L,M,re):ne(L,M))||re);return G>3&&re&&Object.defineProperty(L,M,re),re},e=Pt&&Pt.__param||function(W,L){return function(M,U){L(M,U,W)}};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.ATNDeserializer=void 0;const t=Sd(),i=Rr(),s=ct(),n=vd(),r=Ue(),o=Ad(),l=c0(),c=pd(),a=wr(),h=h0(),f=_o(),d=Un(),p=dd(),v=f0(),x=$n(),y=xd(),g=d0(),m=p0(),S=x0(),T=m0(),A=g0(),b=y0(),N=v0(),R=S0(),P=Nd(),I=J(),B=Yl(),V=Vi(),ee=E0(),te=_0(),le=T0(),ge=od(),ce=b0(),Z=N0(),Y=$i(),Q=Xl(),ie=Gl(),E=R0(),C=w0(),_=Wl(),w=Be(),F=O0(),O=F0(),D=md();var j;(function(W){W[W.UNICODE_BMP=0]="UNICODE_BMP",W[W.UNICODE_SMP=1]="UNICODE_SMP"})(j||(j={}));let H=class fe{constructor(L){L===void 0&&(L=n.ATNDeserializationOptions.defaultOptions),this.deserializationOptions=L}static get SERIALIZED_VERSION(){return 3}static isFeatureSupported(L,M){let U=fe.SUPPORTED_UUIDS.findIndex(G=>G.equals(L));return U<0?!1:fe.SUPPORTED_UUIDS.findIndex(G=>G.equals(M))>=U}static getUnicodeDeserializer(L){return L===0?{readUnicode:(M,U)=>fe.toInt(M[U]),size:1}:{readUnicode:(M,U)=>fe.toInt32(M,U),size:2}}deserialize(L){L=L.slice(0);for(let K=1;K<L.length;K++)L[K]=L[K]-2&65535;let M=0,U=fe.toInt(L[M++]);if(U!==fe.SERIALIZED_VERSION){let K=`Could not deserialize ATN with version ${U} (expected ${fe.SERIALIZED_VERSION}).`;throw new Error(K)}let G=fe.toUUID(L,M);if(M+=8,fe.SUPPORTED_UUIDS.findIndex(K=>K.equals(G))<0){let K=`Could not deserialize ATN with UUID ${G} (expected ${fe.SERIALIZED_UUID} or a legacy UUID).`;throw new Error(K)}let re=fe.isFeatureSupported(fe.ADDED_LEXER_ACTIONS,G),ne=fe.toInt(L[M++]),q=fe.toInt(L[M++]),X=new s.ATN(ne,q),he=[],Te=[],Ne=fe.toInt(L[M++]);for(let K=0;K<Ne;K++){let me=fe.toInt(L[M++]);if(me===r.ATNStateType.INVALID_TYPE){X.addState(new y.InvalidState);continue}let ye=fe.toInt(L[M++]);ye===65535&&(ye=-1);let Ce=this.stateFactory(me,ye);if(me===r.ATNStateType.LOOP_END){let Pe=fe.toInt(L[M++]);he.push([Ce,Pe])}else if(Ce instanceof f.BlockStartState){let Pe=fe.toInt(L[M++]);Te.push([Ce,Pe])}X.addState(Ce)}for(let K of he)K[0].loopBackState=X.states[K[1]];for(let K of Te)K[0].endState=X.states[K[1]];let z=fe.toInt(L[M++]);for(let K=0;K<z;K++){let me=fe.toInt(L[M++]);X.states[me].nonGreedy=!0}let $=fe.toInt(L[M++]);for(let K=0;K<$;K++){let me=fe.toInt(L[M++]);X.states[me].sll=!0}let ae=fe.toInt(L[M++]);for(let K=0;K<ae;K++){let me=fe.toInt(L[M++]);X.states[me].isPrecedenceRule=!0}let de=fe.toInt(L[M++]);X.grammarType===0&&(X.ruleToTokenType=new Int32Array(de)),X.ruleToStartState=new Array(de);for(let K=0;K<de;K++){let me=fe.toInt(L[M++]),ye=X.states[me];if(ye.leftFactored=fe.toInt(L[M++])!==0,X.ruleToStartState[K]=ye,X.grammarType===0){let Ce=fe.toInt(L[M++]);Ce===65535&&(Ce=w.Token.EOF),X.ruleToTokenType[K]=Ce,fe.isFeatureSupported(fe.ADDED_LEXER_ACTIONS,G)||fe.toInt(L[M++])}}X.ruleToStopState=new Array(de);for(let K of X.states)K instanceof Y.RuleStopState&&(X.ruleToStopState[K.ruleIndex]=K,X.ruleToStartState[K.ruleIndex].stopState=K);let pe=fe.toInt(L[M++]);for(let K=0;K<pe;K++){let me=fe.toInt(L[M++]);X.modeToStartState.push(X.states[me])}X.modeToDFA=new Array(pe);for(let K=0;K<pe;K++)X.modeToDFA[K]=new p.DFA(X.modeToStartState[K]);let _e=[];M=this.deserializeSets(L,M,_e,fe.getUnicodeDeserializer(0)),fe.isFeatureSupported(fe.ADDED_UNICODE_SMP,G)&&(M=this.deserializeSets(L,M,_e,fe.getUnicodeDeserializer(1)));let Se=fe.toInt(L[M++]);for(let K=0;K<Se;K++){let me=fe.toInt(L[M]),ye=fe.toInt(L[M+1]),Ce=fe.toInt(L[M+2]),Pe=fe.toInt(L[M+3]),Ve=fe.toInt(L[M+4]),qe=fe.toInt(L[M+5]),Ke=this.edgeFactory(X,Ce,me,ye,Pe,Ve,qe,_e);X.states[me].addTransition(Ke),M+=6}let Re=new i.Array2DHashSet({hashCode:K=>K.stopState^K.returnState^K.outermostPrecedenceReturn,equals:(K,me)=>K.stopState===me.stopState&&K.returnState===me.returnState&&K.outermostPrecedenceReturn===me.outermostPrecedenceReturn}),we=[];for(let K of X.states){let me=K.ruleIndex>=0&&X.ruleToStartState[K.ruleIndex].leftFactored;for(let ye=0;ye<K.numberOfTransitions;ye++){let Ce=K.transition(ye);if(!(Ce instanceof Q.RuleTransition))continue;let Pe=Ce;if(!X.ruleToStartState[Pe.target.ruleIndex].leftFactored&&me)continue;let qe=-1;X.ruleToStartState[Pe.target.ruleIndex].isPrecedenceRule&&Pe.precedence===0&&(qe=Pe.target.ruleIndex);let Ke={stopState:Pe.target.ruleIndex,returnState:Pe.followState.stateNumber,outermostPrecedenceReturn:qe};Re.add(Ke)&&we.push(Ke)}}for(let K of we){let me=new v.EpsilonTransition(X.states[K.returnState],K.outermostPrecedenceReturn);X.ruleToStopState[K.stopState].addTransition(me)}for(let K of X.states){if(K instanceof f.BlockStartState){if(K.endState===void 0)throw new Error("IllegalStateException");if(K.endState.startState!==void 0)throw new Error("IllegalStateException");K.endState.startState=K}if(K instanceof te.PlusLoopbackState){let me=K;for(let ye=0;ye<me.numberOfTransitions;ye++){let Ce=me.transition(ye).target;Ce instanceof ee.PlusBlockStartState&&(Ce.loopBackState=me)}}else if(K instanceof C.StarLoopbackState){let me=K;for(let ye=0;ye<me.numberOfTransitions;ye++){let Ce=me.transition(ye).target;Ce instanceof _.StarLoopEntryState&&(Ce.loopBackState=me)}}}let ze=fe.toInt(L[M++]);for(let K=1;K<=ze;K++){let me=fe.toInt(L[M++]),ye=X.states[me];X.decisionToState.push(ye),ye.decision=K-1}if(X.grammarType===0)if(re){X.lexerActions=new Array(fe.toInt(L[M++]));for(let K=0;K<X.lexerActions.length;K++){let me=fe.toInt(L[M++]),ye=fe.toInt(L[M++]);ye===65535&&(ye=-1);let Ce=fe.toInt(L[M++]);Ce===65535&&(Ce=-1);let Pe=this.lexerActionFactory(me,ye,Ce);X.lexerActions[K]=Pe}}else{let K=[];for(let me of X.states)for(let ye=0;ye<me.numberOfTransitions;ye++){let Ce=me.transition(ye);if(!(Ce instanceof t.ActionTransition))continue;let Pe=Ce.ruleIndex,Ve=Ce.actionIndex,qe=new m.LexerCustomAction(Pe,Ve);me.setTransition(ye,new t.ActionTransition(Ce.target,Pe,K.length,!1)),K.push(qe)}X.lexerActions=K}this.markPrecedenceDecisions(X),X.decisionToDFA=new Array(ze);for(let K=0;K<ze;K++)X.decisionToDFA[K]=new p.DFA(X.decisionToState[K],K);if(this.deserializationOptions.isVerifyATN&&this.verifyATN(X),this.deserializationOptions.isGenerateRuleBypassTransitions&&X.grammarType===1){X.ruleToTokenType=new Int32Array(X.ruleToStartState.length);for(let K=0;K<X.ruleToStartState.length;K++)X.ruleToTokenType[K]=X.maxTokenType+K+1;for(let K=0;K<X.ruleToStartState.length;K++){let me=new l.BasicBlockStartState;me.ruleIndex=K,X.addState(me);let ye=new h.BlockEndState;ye.ruleIndex=K,X.addState(ye),me.endState=ye,X.defineDecisionState(me),ye.startState=me;let Ce,Pe;if(X.ruleToStartState[K].isPrecedenceRule){Ce=void 0;for(let qe of X.states){if(qe.ruleIndex!==K||!(qe instanceof _.StarLoopEntryState))continue;let Ke=qe.transition(qe.numberOfTransitions-1).target;if(Ke instanceof P.LoopEndState&&Ke.epsilonOnlyTransitions&&Ke.transition(0).target instanceof Y.RuleStopState){Ce=qe;break}}if(!Ce)throw new Error("Couldn't identify final state of the precedence rule prefix section.");Pe=Ce.loopBackState.transition(0)}else Ce=X.ruleToStopState[K];for(let qe of X.states)for(let Ke=0;Ke<qe.numberOfTransitions;Ke++){let Xi=qe.transition(Ke);Xi!==Pe&&Xi.target===Ce&&(Xi.target=ye)}for(;X.ruleToStartState[K].numberOfTransitions>0;){let qe=X.ruleToStartState[K].removeTransition(X.ruleToStartState[K].numberOfTransitions-1);me.addTransition(qe)}X.ruleToStartState[K].addTransition(new v.EpsilonTransition(me)),ye.addTransition(new v.EpsilonTransition(Ce));let Ve=new c.BasicState;X.addState(Ve),Ve.addTransition(new o.AtomTransition(ye,X.ruleToTokenType[K])),me.addTransition(new v.EpsilonTransition(Ve))}this.deserializationOptions.isVerifyATN&&this.verifyATN(X)}if(this.deserializationOptions.isOptimize){for(;;){let K=0;K+=fe.inlineSetRules(X),K+=fe.combineChainedEpsilons(X);let me=X.grammarType===0;if(K+=fe.optimizeSets(X,me),K===0)break}this.deserializationOptions.isVerifyATN&&this.verifyATN(X)}return fe.identifyTailCalls(X),X}deserializeSets(L,M,U,G){let re=fe.toInt(L[M++]);for(let ne=0;ne<re;ne++){let q=fe.toInt(L[M]);M++;let X=new x.IntervalSet;U.push(X),fe.toInt(L[M++])!==0&&X.add(-1);for(let Te=0;Te<q;Te++){let Ne=G.readUnicode(L,M);M+=G.size;let z=G.readUnicode(L,M);M+=G.size,X.add(Ne,z)}}return M}markPrecedenceDecisions(L){let M=new Map;for(let U of L.states)if(U instanceof _.StarLoopEntryState&&L.ruleToStartState[U.ruleIndex].isPrecedenceRule){let G=U.transition(U.numberOfTransitions-1).target;G instanceof P.LoopEndState&&G.epsilonOnlyTransitions&&G.transition(0).target instanceof Y.RuleStopState&&(M.set(U.ruleIndex,U),U.precedenceRuleDecision=!0,U.precedenceLoopbackStates=new a.BitSet(L.states.length))}for(let U of M)for(let G of L.ruleToStopState[U[0]].getTransitions())G.serializationType!==1||G.outermostPrecedenceReturn!==-1||U[1].precedenceLoopbackStates.set(G.target.stateNumber)}verifyATN(L){for(let M of L.states)if(this.checkCondition(M!==void 0,"ATN states should not be undefined."),M.stateType!==r.ATNStateType.INVALID_TYPE){if(this.checkCondition(M.onlyHasEpsilonTransitions||M.numberOfTransitions<=1),M instanceof ee.PlusBlockStartState&&this.checkCondition(M.loopBackState!==void 0),M instanceof _.StarLoopEntryState){let U=M;if(this.checkCondition(U.loopBackState!==void 0),this.checkCondition(U.numberOfTransitions===2),U.transition(0).target instanceof E.StarBlockStartState)this.checkCondition(U.transition(1).target instanceof P.LoopEndState),this.checkCondition(!U.nonGreedy);else if(U.transition(0).target instanceof P.LoopEndState)this.checkCondition(U.transition(1).target instanceof E.StarBlockStartState),this.checkCondition(U.nonGreedy);else throw new Error("IllegalStateException")}if(M instanceof C.StarLoopbackState&&(this.checkCondition(M.numberOfTransitions===1),this.checkCondition(M.transition(0).target instanceof _.StarLoopEntryState)),M instanceof P.LoopEndState&&this.checkCondition(M.loopBackState!==void 0),M instanceof Z.RuleStartState&&this.checkCondition(M.stopState!==void 0),M instanceof f.BlockStartState&&this.checkCondition(M.endState!==void 0),M instanceof h.BlockEndState&&this.checkCondition(M.startState!==void 0),M instanceof d.DecisionState){let U=M;this.checkCondition(U.numberOfTransitions<=1||U.decision>=0)}else this.checkCondition(M.numberOfTransitions<=1||M instanceof Y.RuleStopState)}}checkCondition(L,M){if(!L)throw new Error("IllegalStateException: "+M)}static inlineSetRules(L){let M=0,U=new Array(L.ruleToStartState.length);for(let G=0;G<L.ruleToStartState.length;G++){let ne=L.ruleToStartState[G];for(;ne.onlyHasEpsilonTransitions&&ne.numberOfOptimizedTransitions===1&&ne.getOptimizedTransition(0).serializationType===1;)ne=ne.getOptimizedTransition(0).target;if(ne.numberOfOptimizedTransitions!==1)continue;let q=ne.getOptimizedTransition(0),X=q.target;if(!(q.isEpsilon||!X.onlyHasEpsilonTransitions||X.numberOfOptimizedTransitions!==1||!(X.getOptimizedTransition(0).target instanceof Y.RuleStopState)))switch(q.serializationType){case 5:case 2:case 7:U[G]=q;break;case 8:case 9:continue;default:continue}}for(let G of L.states){if(G.ruleIndex<0)continue;let re;for(let ne=0;ne<G.numberOfOptimizedTransitions;ne++){let q=G.getOptimizedTransition(ne);if(!(q instanceof Q.RuleTransition)){re!==void 0&&re.push(q);continue}let X=q,he=U[X.target.ruleIndex];if(he===void 0){re!==void 0&&re.push(q);continue}if(re===void 0){re=[];for(let z=0;z<ne;z++)re.push(G.getOptimizedTransition(ne))}M++;let Te=X.followState,Ne=new c.BasicState;switch(Ne.setRuleIndex(Te.ruleIndex),L.addState(Ne),re.push(new v.EpsilonTransition(Ne)),he.serializationType){case 5:Ne.addTransition(new o.AtomTransition(Te,he._label));break;case 2:Ne.addTransition(new ce.RangeTransition(Te,he.from,he.to));break;case 7:Ne.addTransition(new ie.SetTransition(Te,he.label));break;default:throw new Error("UnsupportedOperationException")}}if(re!==void 0){if(G.isOptimized)for(;G.numberOfOptimizedTransitions>0;)G.removeOptimizedTransition(G.numberOfOptimizedTransitions-1);for(let ne of re)G.addOptimizedTransition(ne)}}return V.ParserATNSimulator.debug&&console.log("ATN runtime optimizer removed "+M+" rule invocations by inlining sets."),M}static combineChainedEpsilons(L){let M=0;for(let U of L.states){if(!U.onlyHasEpsilonTransitions||U instanceof Y.RuleStopState)continue;let G;e:for(let re=0;re<U.numberOfOptimizedTransitions;re++){let ne=U.getOptimizedTransition(re),q=ne.target;if(ne.serializationType!==1||ne.outermostPrecedenceReturn!==-1||q.stateType!==r.ATNStateType.BASIC||!q.onlyHasEpsilonTransitions){G!==void 0&&G.push(ne);continue e}for(let X=0;X<q.numberOfOptimizedTransitions;X++)if(q.getOptimizedTransition(X).serializationType!==1||q.getOptimizedTransition(X).outermostPrecedenceReturn!==-1){G!==void 0&&G.push(ne);continue e}if(M++,G===void 0){G=[];for(let X=0;X<re;X++)G.push(U.getOptimizedTransition(X))}for(let X=0;X<q.numberOfOptimizedTransitions;X++){let he=q.getOptimizedTransition(X).target;G.push(new v.EpsilonTransition(he))}}if(G!==void 0){if(U.isOptimized)for(;U.numberOfOptimizedTransitions>0;)U.removeOptimizedTransition(U.numberOfOptimizedTransitions-1);for(let re of G)U.addOptimizedTransition(re)}}return V.ParserATNSimulator.debug&&console.log("ATN runtime optimizer removed "+M+" transitions by combining chained epsilon transitions."),M}static optimizeSets(L,M){if(M)return 0;let U=0,G=L.decisionToState;for(let re of G){let ne=new x.IntervalSet;for(let z=0;z<re.numberOfOptimizedTransitions;z++){let $=re.getOptimizedTransition(z);if(!($ instanceof v.EpsilonTransition)||$.target.numberOfOptimizedTransitions!==1)continue;let ae=$.target.getOptimizedTransition(0);ae.target instanceof h.BlockEndState&&(ae instanceof B.NotSetTransition||(ae instanceof o.AtomTransition||ae instanceof ce.RangeTransition||ae instanceof ie.SetTransition)&&ne.add(z))}if(ne.size<=1)continue;let q=[];for(let z=0;z<re.numberOfOptimizedTransitions;z++)ne.contains(z)||q.push(re.getOptimizedTransition(z));let X=re.getOptimizedTransition(ne.minElement).target.getOptimizedTransition(0).target,he=new x.IntervalSet;for(let z of ne.intervals)for(let $=z.a;$<=z.b;$++){let ae=re.getOptimizedTransition($).target.getOptimizedTransition(0);if(ae instanceof B.NotSetTransition)throw new Error("Not yet implemented.");he.addAll(ae.label)}let Te;if(he.intervals.length===1)if(he.size===1)Te=new o.AtomTransition(X,he.minElement);else{let z=he.intervals[0];Te=new ce.RangeTransition(X,z.a,z.b)}else Te=new ie.SetTransition(X,he);let Ne=new c.BasicState;if(Ne.setRuleIndex(re.ruleIndex),L.addState(Ne),Ne.addTransition(Te),q.push(new v.EpsilonTransition(Ne)),U+=re.numberOfOptimizedTransitions-q.length,re.isOptimized)for(;re.numberOfOptimizedTransitions>0;)re.removeOptimizedTransition(re.numberOfOptimizedTransitions-1);for(let z of q)re.addOptimizedTransition(z)}return V.ParserATNSimulator.debug&&console.log("ATN runtime optimizer removed "+U+" paths by collapsing sets."),U}static identifyTailCalls(L){for(let M of L.states){for(let U=0;U<M.numberOfTransitions;U++){let G=M.transition(U);G instanceof Q.RuleTransition&&(G.tailCall=this.testTailCall(L,G,!1),G.optimizedTailCall=this.testTailCall(L,G,!0))}if(M.isOptimized)for(let U=0;U<M.numberOfOptimizedTransitions;U++){let G=M.getOptimizedTransition(U);G instanceof Q.RuleTransition&&(G.tailCall=this.testTailCall(L,G,!1),G.optimizedTailCall=this.testTailCall(L,G,!0))}}}static testTailCall(L,M,U){if(!U&&M.tailCall||U&&M.optimizedTailCall)return!0;let G=new a.BitSet(L.states.length),re=[];for(re.push(M.followState);;){let ne=re.pop();if(!ne)break;if(G.get(ne.stateNumber)||ne instanceof Y.RuleStopState)continue;if(!ne.onlyHasEpsilonTransitions)return!1;let q=U?ne.numberOfOptimizedTransitions:ne.numberOfTransitions;for(let X=0;X<q;X++){let he=U?ne.getOptimizedTransition(X):ne.transition(X);if(he.serializationType!==1)return!1;re.push(he.target)}}return!0}static toInt(L){return L}static toInt32(L,M){return(L[M]|L[M+1]<<16)>>>0}static toUUID(L,M){let U=fe.toInt32(L,M),G=fe.toInt32(L,M+2),re=fe.toInt32(L,M+4),ne=fe.toInt32(L,M+6);return new O.UUID(ne,re,G,U)}edgeFactory(L,M,U,G,re,ne,q,X){let he=L.states[G];switch(M){case 1:return new v.EpsilonTransition(he);case 2:return q!==0?new ce.RangeTransition(he,w.Token.EOF,ne):new ce.RangeTransition(he,re,ne);case 3:return new Q.RuleTransition(L.states[re],ne,q,he);case 4:return new ge.PredicateTransition(he,re,ne,q!==0);case 10:return new le.PrecedencePredicateTransition(he,re);case 5:return q!==0?new o.AtomTransition(he,w.Token.EOF):new o.AtomTransition(he,re);case 6:return new t.ActionTransition(he,re,ne,q!==0);case 7:return new ie.SetTransition(he,X[re]);case 8:return new B.NotSetTransition(he,X[re]);case 9:return new D.WildcardTransition(he)}throw new Error("The specified transition type is not valid.")}stateFactory(L,M){let U;switch(L){case r.ATNStateType.INVALID_TYPE:return new y.InvalidState;case r.ATNStateType.BASIC:U=new c.BasicState;break;case r.ATNStateType.RULE_START:U=new Z.RuleStartState;break;case r.ATNStateType.BLOCK_START:U=new l.BasicBlockStartState;break;case r.ATNStateType.PLUS_BLOCK_START:U=new ee.PlusBlockStartState;break;case r.ATNStateType.STAR_BLOCK_START:U=new E.StarBlockStartState;break;case r.ATNStateType.TOKEN_START:U=new F.TokensStartState;break;case r.ATNStateType.RULE_STOP:U=new Y.RuleStopState;break;case r.ATNStateType.BLOCK_END:U=new h.BlockEndState;break;case r.ATNStateType.STAR_LOOP_BACK:U=new C.StarLoopbackState;break;case r.ATNStateType.STAR_LOOP_ENTRY:U=new _.StarLoopEntryState;break;case r.ATNStateType.PLUS_LOOP_BACK:U=new te.PlusLoopbackState;break;case r.ATNStateType.LOOP_END:U=new P.LoopEndState;break;default:let G=`The specified state type ${L} is not valid.`;throw new Error(G)}return U.ruleIndex=M,U}lexerActionFactory(L,M,U){switch(L){case 0:return new g.LexerChannelAction(M);case 1:return new m.LexerCustomAction(M,U);case 2:return new S.LexerModeAction(M);case 3:return T.LexerMoreAction.INSTANCE;case 4:return A.LexerPopModeAction.INSTANCE;case 5:return new b.LexerPushModeAction(M);case 6:return N.LexerSkipAction.INSTANCE;case 7:return new R.LexerTypeAction(M);default:let G=`The specified lexer action type ${L} is not valid.`;throw new Error(G)}}};return H.BASE_SERIALIZED_UUID=O.UUID.fromString("E4178468-DF95-44D0-AD87-F22A5D5FB6D3"),H.ADDED_LEXER_ACTIONS=O.UUID.fromString("AB35191A-1603-487E-B75A-479B831EAF6D"),H.ADDED_UNICODE_SMP=O.UUID.fromString("C23FEA89-0605-4f51-AFB8-058BCAB8C91B"),H.SUPPORTED_UUIDS=[H.BASE_SERIALIZED_UUID,H.ADDED_LEXER_ACTIONS,H.ADDED_UNICODE_SMP],H.SERIALIZED_UUID=H.ADDED_UNICODE_SMP,u([I.NotNull],H.prototype,"deserializationOptions",void 0),u([e(0,I.NotNull)],H.prototype,"deserialize",null),u([e(0,I.NotNull)],H.prototype,"markPrecedenceDecisions",null),u([I.NotNull,e(0,I.NotNull)],H.prototype,"edgeFactory",null),Pt.ATNDeserializer=H,Pt}var Wt={},yh;function P0(){if(yh)return Wt;yh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Wt&&Wt.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c},e=Wt&&Wt.__param||function(s,n){return function(r,o){n(r,o,s)}};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ParseInfo=void 0;const t=J();let i=class{constructor(n){this.atnSimulator=n}getDecisionInfo(){return this.atnSimulator.getDecisionInfo()}getLLDecisions(){let n=this.atnSimulator.getDecisionInfo(),r=[];for(let o=0;o<n.length;o++)n[o].LL_Fallback>0&&r.push(o);return r}getTotalTimeInPrediction(){let n=this.atnSimulator.getDecisionInfo(),r=0;for(let o of n)r+=o.timeInPrediction;return r}getTotalSLLLookaheadOps(){let n=this.atnSimulator.getDecisionInfo(),r=0;for(let o of n)r+=o.SLL_TotalLook;return r}getTotalLLLookaheadOps(){let n=this.atnSimulator.getDecisionInfo(),r=0;for(let o of n)r+=o.LL_TotalLook;return r}getTotalSLLATNLookaheadOps(){let n=this.atnSimulator.getDecisionInfo(),r=0;for(let o of n)r+=o.SLL_ATNTransitions;return r}getTotalLLATNLookaheadOps(){let n=this.atnSimulator.getDecisionInfo(),r=0;for(let o of n)r+=o.LL_ATNTransitions;return r}getTotalATNLookaheadOps(){let n=this.atnSimulator.getDecisionInfo(),r=0;for(let o of n)r+=o.SLL_ATNTransitions,r+=o.LL_ATNTransitions;return r}getDFASize(n){if(n)return this.atnSimulator.atn.decisionToDFA[n].states.size;{let r=0,o=this.atnSimulator.atn.decisionToDFA;for(let l=0;l<o.length;l++)r+=this.getDFASize(l);return r}}};return u([t.NotNull],i.prototype,"getDecisionInfo",null),u([t.NotNull],i.prototype,"getLLDecisions",null),i=u([e(0,t.NotNull)],i),Wt.ParseInfo=i,Wt}var Cn={},vh;function Pd(){if(vh)return Cn;vh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Cn&&Cn.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.ProxyParserErrorListener=void 0;const e=Vl(),t=J();let i=class extends e.ProxyErrorListener{constructor(n){super(n)}reportAmbiguity(n,r,o,l,c,a,h){this.getDelegates().forEach(f=>{f.reportAmbiguity&&f.reportAmbiguity(n,r,o,l,c,a,h)})}reportAttemptingFullContext(n,r,o,l,c,a){this.getDelegates().forEach(h=>{h.reportAttemptingFullContext&&h.reportAttemptingFullContext(n,r,o,l,c,a)})}reportContextSensitivity(n,r,o,l,c,a){this.getDelegates().forEach(h=>{h.reportContextSensitivity&&h.reportContextSensitivity(n,r,o,l,c,a)})}};return u([t.Override],i.prototype,"reportAmbiguity",null),u([t.Override],i.prototype,"reportAttemptingFullContext",null),u([t.Override],i.prototype,"reportContextSensitivity",null),Cn.ProxyParserErrorListener=i,Cn}var En={},rl={},nl={},Gt={},Sh;function D0(){if(Sh)return Gt;Sh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.isSupplementaryCodePoint=Gt.isLowSurrogate=Gt.isHighSurrogate=void 0;function u(i){return i>=55296&&i<=56319}Gt.isHighSurrogate=u;function e(i){return i>=56320&&i<=57343}Gt.isLowSurrogate=e;function t(i){return i>=65536}return Gt.isSupplementaryCodePoint=t,Gt}var Ah;function Dd(){return Ah||(Ah=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(u,"__esModule",{value:!0}),u.CodePointBuffer=void 0;const e=$e(),t=D0();class i{constructor(n,r){this.buffer=n,this._position=0,this._size=r}static withArray(n){return new i(n,n.length)}get position(){return this._position}set position(n){if(n<0||n>this._size)throw new RangeError;this._position=n}get remaining(){return this._size-this.position}get(n){return this.buffer[n]}array(){return this.buffer.slice(0,this._size)}static builder(n){return new i.Builder(n)}}u.CodePointBuffer=i,function(s){let n;(function(o){o[o.BYTE=0]="BYTE",o[o.CHAR=1]="CHAR",o[o.INT=2]="INT"})(n||(n={}));class r{constructor(l){this.type=0,this.buffer=new Uint8Array(l),this.prevHighSurrogate=-1,this.position=0}build(){return new s(this.buffer,this.position)}static roundUpToNextPowerOfTwo(l){let c=32-Math.clz32(l-1);return Math.pow(2,c)}ensureRemaining(l){switch(this.type){case 0:if(this.buffer.length-this.position<l){let c=r.roundUpToNextPowerOfTwo(this.buffer.length+l),a=new Uint8Array(c);a.set(this.buffer.subarray(0,this.position),0),this.buffer=a}break;case 1:if(this.buffer.length-this.position<l){let c=r.roundUpToNextPowerOfTwo(this.buffer.length+l),a=new Uint16Array(c);a.set(this.buffer.subarray(0,this.position),0),this.buffer=a}break;case 2:if(this.buffer.length-this.position<l){let c=r.roundUpToNextPowerOfTwo(this.buffer.length+l),a=new Int32Array(c);a.set(this.buffer.subarray(0,this.position),0),this.buffer=a}break}}append(l){this.ensureRemaining(l.length),this.appendArray(l)}appendArray(l){switch(this.type){case 0:this.appendArrayByte(l);break;case 1:this.appendArrayChar(l);break;case 2:this.appendArrayInt(l);break}}appendArrayByte(l){e(this.prevHighSurrogate===-1);let c=l,a=0,h=l.length,f=this.buffer,d=this.position;for(;a<h;){let p=c[a];if(p<=255)f[d]=p;else if(l=l.subarray(a,h),this.position=d,t.isHighSurrogate(p)){this.byteToIntBuffer(l.length),this.appendArrayInt(l);return}else{this.byteToCharBuffer(l.length),this.appendArrayChar(l);return}a++,d++}this.position=d}appendArrayChar(l){e(this.prevHighSurrogate===-1);let c=l,a=0,h=l.length,f=this.buffer,d=this.position;for(;a<h;){let p=c[a];if(!t.isHighSurrogate(p))f[d]=p;else{l=l.subarray(a,h),this.position=d,this.charToIntBuffer(l.length),this.appendArrayInt(l);return}a++,d++}this.position=d}appendArrayInt(l){let c=l,a=0,h=l.length,f=this.buffer,d=this.position;for(;a<h;){let p=c[a];a++,this.prevHighSurrogate!==-1?t.isLowSurrogate(p)?(f[d]=String.fromCharCode(this.prevHighSurrogate,p).codePointAt(0),d++,this.prevHighSurrogate=-1):(f[d]=this.prevHighSurrogate,d++,t.isHighSurrogate(p)?this.prevHighSurrogate=p:(f[d]=p,d++,this.prevHighSurrogate=-1)):t.isHighSurrogate(p)?this.prevHighSurrogate=p:(f[d]=p,d++)}this.prevHighSurrogate!==-1&&(f[d]=this.prevHighSurrogate,d++),this.position=d}byteToCharBuffer(l){let c=new Uint16Array(Math.max(this.position+l,this.buffer.length>>1));c.set(this.buffer.subarray(0,this.position),0),this.type=1,this.buffer=c}byteToIntBuffer(l){let c=new Int32Array(Math.max(this.position+l,this.buffer.length>>2));c.set(this.buffer.subarray(0,this.position),0),this.type=2,this.buffer=c}charToIntBuffer(l){let c=new Int32Array(Math.max(this.position+l,this.buffer.length>>1));c.set(this.buffer.subarray(0,this.position),0),this.type=2,this.buffer=c}}s.Builder=r}(i=u.CodePointBuffer||(u.CodePointBuffer={}))}(nl)),nl}var _n={},Ch;function Ld(){if(Ch)return _n;Ch=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=_n&&_n.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h};Object.defineProperty(_n,"__esModule",{value:!0}),_n.CodePointCharStream=void 0;const e=$e(),t=Tr(),i=We(),s=J();let n=class Id{constructor(o,l,c,a){e(l===0),this._array=o,this._size=c,this._name=a,this._position=0}get internalStorage(){return this._array}static fromBuffer(o,l){return(l===void 0||l.length===0)&&(l=t.IntStream.UNKNOWN_SOURCE_NAME),new Id(o.array(),o.position,o.remaining,l)}consume(){if(this._size-this._position===0)throw e(this.LA(1)===t.IntStream.EOF),new RangeError("cannot consume EOF");this._position++}get index(){return this._position}get size(){return this._size}mark(){return-1}release(o){}seek(o){this._position=o}get sourceName(){return this._name}toString(){return this.getText(i.Interval.of(0,this.size-1))}LA(o){let l;switch(Math.sign(o)){case-1:return l=this.index+o,l<0?t.IntStream.EOF:this._array[l];case 0:return 0;case 1:return l=this.index+o-1,l>=this.size?t.IntStream.EOF:this._array[l]}throw new RangeError("Not reached")}getText(o){const l=Math.min(o.a,this.size),c=Math.min(o.b-o.a+1,this.size-l);return this._array instanceof Int32Array?String.fromCodePoint(...Array.from(this._array.subarray(l,l+c))):String.fromCharCode(...Array.from(this._array.subarray(l,l+c)))}};return u([s.Override],n.prototype,"consume",null),u([s.Override],n.prototype,"index",null),u([s.Override],n.prototype,"size",null),u([s.Override],n.prototype,"mark",null),u([s.Override],n.prototype,"release",null),u([s.Override],n.prototype,"seek",null),u([s.Override],n.prototype,"sourceName",null),u([s.Override],n.prototype,"toString",null),u([s.Override],n.prototype,"LA",null),u([s.Override],n.prototype,"getText",null),_n.CodePointCharStream=n,_n}var Eh;function Zl(){return Eh||(Eh=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(u,"__esModule",{value:!0}),u.CharStreams=void 0;const e=Dd(),t=Ld(),i=Tr();(function(s){function n(r,o){(o===void 0||o.length===0)&&(o=i.IntStream.UNKNOWN_SOURCE_NAME);let l=e.CodePointBuffer.builder(r.length),c=new Uint16Array(r.length);for(let a=0;a<r.length;a++)c[a]=r.charCodeAt(a);return l.append(c),t.CodePointCharStream.fromBuffer(l.build(),o)}s.fromString=n})(u.CharStreams||(u.CharStreams={}))}(rl)),rl}var Yt={},Xt={},_h;function Bd(){if(_h)return Xt;_h=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Xt&&Xt.__decorate||function(c,a,h,f){var d=arguments.length,p=d<3?a:f===null?f=Object.getOwnPropertyDescriptor(a,h):f,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,a,h,f);else for(var x=c.length-1;x>=0;x--)(v=c[x])&&(p=(d<3?v(p):d>3?v(a,h,p):v(a,h))||p);return d>3&&p&&Object.defineProperty(a,h,p),p},e=Xt&&Xt.__param||function(c,a){return function(h,f){a(h,f,c)}};Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.BufferedTokenStream=void 0;const t=$e(),i=qi(),s=We(),n=Or(),r=J(),o=Be();let l=class{constructor(a){if(this.tokens=[],this.p=-1,this.fetchedEOF=!1,a==null)throw new Error("tokenSource cannot be null");this._tokenSource=a}get tokenSource(){return this._tokenSource}set tokenSource(a){this._tokenSource=a,this.tokens.length=0,this.p=-1,this.fetchedEOF=!1}get index(){return this.p}mark(){return 0}release(a){}seek(a){this.lazyInit(),this.p=this.adjustSeekIndex(a)}get size(){return this.tokens.length}consume(){let a;if(this.p>=0?this.fetchedEOF?a=this.p<this.tokens.length-1:a=this.p<this.tokens.length:a=!1,!a&&this.LA(1)===o.Token.EOF)throw new Error("cannot consume EOF");this.sync(this.p+1)&&(this.p=this.adjustSeekIndex(this.p+1))}sync(a){t(a>=0);let h=a-this.tokens.length+1;return h>0?this.fetch(h)>=h:!0}fetch(a){if(this.fetchedEOF)return 0;for(let h=0;h<a;h++){let f=this.tokenSource.nextToken();if(this.isWritableToken(f)&&(f.tokenIndex=this.tokens.length),this.tokens.push(f),f.type===o.Token.EOF)return this.fetchedEOF=!0,h+1}return a}get(a){if(a<0||a>=this.tokens.length)throw new RangeError("token index "+a+" out of range 0.."+(this.tokens.length-1));return this.tokens[a]}getRange(a,h){if(a<0||h<0)return[];this.lazyInit();let f=new Array;h>=this.tokens.length&&(h=this.tokens.length-1);for(let d=a;d<=h;d++){let p=this.tokens[d];if(p.type===o.Token.EOF)break;f.push(p)}return f}LA(a){let h=this.LT(a);return h?h.type:o.Token.INVALID_TYPE}tryLB(a){if(!(this.p-a<0))return this.tokens[this.p-a]}LT(a){let h=this.tryLT(a);if(h===void 0)throw new RangeError("requested lookback index out of range");return h}tryLT(a){if(this.lazyInit(),a===0)throw new RangeError("0 is not a valid lookahead index");if(a<0)return this.tryLB(-a);let h=this.p+a-1;return this.sync(h),h>=this.tokens.length?this.tokens[this.tokens.length-1]:this.tokens[h]}adjustSeekIndex(a){return a}lazyInit(){this.p===-1&&this.setup()}setup(){this.sync(0),this.p=this.adjustSeekIndex(0)}getTokens(a,h,f){if(this.lazyInit(),a===void 0)return t(h===void 0&&f===void 0),this.tokens;if(h===void 0&&(h=this.tokens.length-1),a<0||h>=this.tokens.length||h<0||a>=this.tokens.length)throw new RangeError("start "+a+" or stop "+h+" not in 0.."+(this.tokens.length-1));if(a>h)return[];if(f===void 0)return this.tokens.slice(a,h+1);typeof f=="number"&&(f=new Set().add(f));let d=f,p=this.tokens.slice(a,h+1);return p=p.filter(v=>d.has(v.type)),p}nextTokenOnChannel(a,h){if(this.sync(a),a>=this.size)return this.size-1;let f=this.tokens[a];for(;f.channel!==h;){if(f.type===o.Token.EOF)return a;a++,this.sync(a),f=this.tokens[a]}return a}previousTokenOnChannel(a,h){if(this.sync(a),a>=this.size)return this.size-1;for(;a>=0;){let f=this.tokens[a];if(f.type===o.Token.EOF||f.channel===h)return a;a--}return a}getHiddenTokensToRight(a,h=-1){if(this.lazyInit(),a<0||a>=this.tokens.length)throw new RangeError(a+" not in 0.."+(this.tokens.length-1));let f=this.nextTokenOnChannel(a+1,n.Lexer.DEFAULT_TOKEN_CHANNEL),d,p=a+1;return f===-1?d=this.size-1:d=f,this.filterForChannel(p,d,h)}getHiddenTokensToLeft(a,h=-1){if(this.lazyInit(),a<0||a>=this.tokens.length)throw new RangeError(a+" not in 0.."+(this.tokens.length-1));if(a===0)return[];let f=this.previousTokenOnChannel(a-1,n.Lexer.DEFAULT_TOKEN_CHANNEL);if(f===a-1)return[];let d=f+1,p=a-1;return this.filterForChannel(d,p,h)}filterForChannel(a,h,f){let d=new Array;for(let p=a;p<=h;p++){let v=this.tokens[p];f===-1?v.channel!==n.Lexer.DEFAULT_TOKEN_CHANNEL&&d.push(v):v.channel===f&&d.push(v)}return d}get sourceName(){return this.tokenSource.sourceName}getText(a){a===void 0?a=s.Interval.of(0,this.size-1):a instanceof s.Interval||(a=a.sourceInterval);let h=a.a,f=a.b;if(h<0||f<0)return"";this.fill(),f>=this.tokens.length&&(f=this.tokens.length-1);let d="";for(let p=h;p<=f;p++){let v=this.tokens[p];if(v.type===o.Token.EOF)break;d+=v.text}return d.toString()}getTextFromRange(a,h){return this.isToken(a)&&this.isToken(h)?this.getText(s.Interval.of(a.tokenIndex,h.tokenIndex)):""}fill(){this.lazyInit();const a=1e3;for(;;)if(this.fetch(a)<a)return}isWritableToken(a){return a instanceof i.CommonToken}isToken(a){return a instanceof i.CommonToken}};return u([r.NotNull],l.prototype,"_tokenSource",void 0),u([r.Override],l.prototype,"tokenSource",null),u([r.Override],l.prototype,"index",null),u([r.Override],l.prototype,"mark",null),u([r.Override],l.prototype,"release",null),u([r.Override],l.prototype,"seek",null),u([r.Override],l.prototype,"size",null),u([r.Override],l.prototype,"consume",null),u([r.Override],l.prototype,"get",null),u([r.Override],l.prototype,"LA",null),u([r.NotNull,r.Override],l.prototype,"LT",null),u([r.Override],l.prototype,"sourceName",null),u([r.NotNull,r.Override],l.prototype,"getText",null),u([r.NotNull,r.Override],l.prototype,"getTextFromRange",null),l=u([e(0,r.NotNull)],l),Xt.BufferedTokenStream=l,Xt}var Th;function ea(){if(Th)return Yt;Th=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Yt&&Yt.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=Yt&&Yt.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.CommonTokenStream=void 0;const t=Bd(),i=J(),s=Be();let n=class extends t.BufferedTokenStream{constructor(o,l=s.Token.DEFAULT_CHANNEL){super(o),this.channel=l}adjustSeekIndex(o){return this.nextTokenOnChannel(o,this.channel)}tryLB(o){if(this.p-o<0)return;let l=this.p,c=1;for(;c<=o&&l>0;)l=this.previousTokenOnChannel(l-1,this.channel),c++;if(!(l<0))return this.tokens[l]}tryLT(o){if(this.lazyInit(),o===0)throw new RangeError("0 is not a valid lookahead index");if(o<0)return this.tryLB(-o);let l=this.p,c=1;for(;c<o;)this.sync(l+1)&&(l=this.nextTokenOnChannel(l+1,this.channel)),c++;return this.tokens[l]}getNumberOfOnChannelTokens(){let o=0;this.fill();for(let l of this.tokens)if(l.channel===this.channel&&o++,l.type===s.Token.EOF)break;return o}};return u([i.Override],n.prototype,"adjustSeekIndex",null),u([i.Override],n.prototype,"tryLB",null),u([i.Override],n.prototype,"tryLT",null),n=u([e(0,i.NotNull)],n),Yt.CommonTokenStream=n,Yt}var Kt={},bh;function Md(){if(bh)return Kt;bh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Kt&&Kt.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=Kt&&Kt.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.ListTokenSource=void 0;const t=Hl(),i=J(),s=Be();let n=class{constructor(o,l){if(this.i=0,this._factory=t.CommonTokenFactory.DEFAULT,o==null)throw new Error("tokens cannot be null");this.tokens=o,this._sourceName=l}get charPositionInLine(){if(this.i<this.tokens.length)return this.tokens[this.i].charPositionInLine;if(this.eofToken!=null)return this.eofToken.charPositionInLine;if(this.tokens.length>0){let o=this.tokens[this.tokens.length-1],l=o.text;if(l!=null){let c=l.lastIndexOf(`
`);if(c>=0)return l.length-c-1}return o.charPositionInLine+o.stopIndex-o.startIndex+1}return 0}nextToken(){if(this.i>=this.tokens.length){if(this.eofToken==null){let l=-1;if(this.tokens.length>0){let a=this.tokens[this.tokens.length-1].stopIndex;a!==-1&&(l=a+1)}let c=Math.max(-1,l-1);this.eofToken=this._factory.create({source:this,stream:this.inputStream},s.Token.EOF,"EOF",s.Token.DEFAULT_CHANNEL,l,c,this.line,this.charPositionInLine)}return this.eofToken}let o=this.tokens[this.i];return this.i===this.tokens.length-1&&o.type===s.Token.EOF&&(this.eofToken=o),this.i++,o}get line(){if(this.i<this.tokens.length)return this.tokens[this.i].line;if(this.eofToken!=null)return this.eofToken.line;if(this.tokens.length>0){let o=this.tokens[this.tokens.length-1],l=o.line,c=o.text;if(c!=null)for(let a=0;a<c.length;a++)c.charAt(a)===`
`&&l++;return l}return 1}get inputStream(){if(this.i<this.tokens.length)return this.tokens[this.i].inputStream;if(this.eofToken!=null)return this.eofToken.inputStream;if(this.tokens.length>0)return this.tokens[this.tokens.length-1].inputStream}get sourceName(){if(this._sourceName)return this._sourceName;let o=this.inputStream;return o!=null?o.sourceName:"List"}set tokenFactory(o){this._factory=o}get tokenFactory(){return this._factory}};return u([i.Override],n.prototype,"charPositionInLine",null),u([i.Override],n.prototype,"nextToken",null),u([i.Override],n.prototype,"line",null),u([i.Override],n.prototype,"inputStream",null),u([i.Override],n.prototype,"sourceName",null),u([i.Override,i.NotNull,e(0,i.NotNull)],n.prototype,"tokenFactory",null),n=u([e(0,i.NotNull)],n),Kt.ListTokenSource=n,Kt}var Ci={},Nh;function I0(){if(Nh)return Ci;Nh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.MultiMap=void 0;let u=class extends Map{constructor(){super()}map(t,i){let s=super.get(t);s||(s=[],super.set(t,s)),s.push(i)}getPairs(){let t=[];return this.forEach((i,s)=>{i.forEach(n=>{t.push([s,n])})}),t}};return Ci.MultiMap=u,Ci}var Ei={},Rh;function kd(){if(Rh)return Ei;Rh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.ParseCancellationException=void 0;let u=class extends Error{constructor(t){super(t.message),this.cause=t,this.stack=t.stack}getCause(){return this.cause}};return Ei.ParseCancellationException=u,Ei}var Qt={},Tn={},wh;function zd(){if(wh)return Tn;wh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Tn&&Tn.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c};Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.InterpreterRuleContext=void 0;const e=J(),t=ot();let i=class extends t.ParserRuleContext{constructor(n,r,o){o!==void 0?super(r,o):super(),this._ruleIndex=n}get ruleIndex(){return this._ruleIndex}};return u([e.Override],i.prototype,"ruleIndex",null),Tn.InterpreterRuleContext=i,Tn}var Oh;function jd(){if(Oh)return Qt;Oh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Qt&&Qt.__decorate||function(y,g,m,S){var T=arguments.length,A=T<3?g:S===null?S=Object.getOwnPropertyDescriptor(g,m):S,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(y,g,m,S);else for(var N=y.length-1;N>=0;N--)(b=y[N])&&(A=(T<3?b(A):T>3?b(g,m,A):b(g,m))||A);return T>3&&A&&Object.defineProperty(g,m,A),A},e=Qt&&Qt.__param||function(y,g){return function(m,S){g(m,S,y)}};Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.ParserInterpreter=void 0;const t=pr(),i=Ue(),s=wr(),n=go(),r=yo(),o=zd(),l=Nd(),c=J(),a=J(),h=Gi(),f=Vi(),d=br(),p=Wl(),v=Be();let x=class _l extends h.Parser{constructor(g,m,S,T,A){if(super(g instanceof _l?g.inputStream:A),this._parentContextStack=[],this.overrideDecision=-1,this.overrideDecisionInputIndex=-1,this.overrideDecisionAlt=-1,this.overrideDecisionReached=!1,this._overrideDecisionRoot=void 0,g instanceof _l){let b=g;this._grammarFileName=b._grammarFileName,this._atn=b._atn,this.pushRecursionContextStates=b.pushRecursionContextStates,this._ruleNames=b._ruleNames,this._vocabulary=b._vocabulary,this.interpreter=new f.ParserATNSimulator(this._atn,this)}else{m=m,S=S,T=T,this._grammarFileName=g,this._atn=T,this._ruleNames=S.slice(0),this._vocabulary=m,this.pushRecursionContextStates=new s.BitSet(T.states.length);for(let b of T.states)b instanceof p.StarLoopEntryState&&b.precedenceRuleDecision&&this.pushRecursionContextStates.set(b.stateNumber);this.interpreter=new f.ParserATNSimulator(T,this)}}reset(g){g===void 0?super.reset():super.reset(g),this.overrideDecisionReached=!1,this._overrideDecisionRoot=void 0}get atn(){return this._atn}get vocabulary(){return this._vocabulary}get ruleNames(){return this._ruleNames}get grammarFileName(){return this._grammarFileName}parse(g){let m=this._atn.ruleToStartState[g];for(this._rootContext=this.createInterpreterRuleContext(void 0,t.ATNState.INVALID_STATE_NUMBER,g),m.isPrecedenceRule?this.enterRecursionRule(this._rootContext,m.stateNumber,g,0):this.enterRule(this._rootContext,m.stateNumber,g);;){let S=this.atnState;switch(S.stateType){case i.ATNStateType.RULE_STOP:if(this._ctx.isEmpty)if(m.isPrecedenceRule){let T=this._ctx,A=this._parentContextStack.pop();return this.unrollRecursionContexts(A[0]),T}else return this.exitRule(),this._rootContext;this.visitRuleStopState(S);break;default:try{this.visitState(S)}catch(T){if(T instanceof d.RecognitionException)this.state=this._atn.ruleToStopState[S.ruleIndex].stateNumber,this.context.exception=T,this.errorHandler.reportError(this,T),this.recover(T);else throw T}break}}}enterRecursionRule(g,m,S,T){this._parentContextStack.push([this._ctx,g.invokingState]),super.enterRecursionRule(g,m,S,T)}get atnState(){return this._atn.states[this.state]}visitState(g){let m=1;g.numberOfTransitions>1&&(m=this.visitDecisionState(g));let S=g.transition(m-1);switch(S.serializationType){case 1:if(this.pushRecursionContextStates.get(g.stateNumber)&&!(S.target instanceof l.LoopEndState)){let P=this._parentContextStack[this._parentContextStack.length-1],I=this.createInterpreterRuleContext(P[0],P[1],this._ctx.ruleIndex);this.pushNewRecursionContext(I,this._atn.ruleToStartState[g.ruleIndex].stateNumber,this._ctx.ruleIndex)}break;case 5:this.match(S._label);break;case 2:case 7:case 8:S.matches(this._input.LA(1),v.Token.MIN_USER_TOKEN_TYPE,65535)||this.recoverInline(),this.matchWildcard();break;case 9:this.matchWildcard();break;case 3:let T=S.target,A=T.ruleIndex,b=this.createInterpreterRuleContext(this._ctx,g.stateNumber,A);T.isPrecedenceRule?this.enterRecursionRule(b,T.stateNumber,A,S.precedence):this.enterRule(b,S.target.stateNumber,A);break;case 4:let N=S;if(!this.sempred(this._ctx,N.ruleIndex,N.predIndex))throw new n.FailedPredicateException(this);break;case 6:let R=S;this.action(this._ctx,R.ruleIndex,R.actionIndex);break;case 10:if(!this.precpred(this._ctx,S.precedence)){let P=S.precedence;throw new n.FailedPredicateException(this,`precpred(_ctx, ${P})`)}break;default:throw new Error("UnsupportedOperationException: Unrecognized ATN transition type.")}this.state=S.target.stateNumber}visitDecisionState(g){let m;this.errorHandler.sync(this);let S=g.decision;return S===this.overrideDecision&&this._input.index===this.overrideDecisionInputIndex&&!this.overrideDecisionReached?(m=this.overrideDecisionAlt,this.overrideDecisionReached=!0):m=this.interpreter.adaptivePredict(this._input,S,this._ctx),m}createInterpreterRuleContext(g,m,S){return new o.InterpreterRuleContext(S,g,m)}visitRuleStopState(g){if(this._atn.ruleToStartState[g.ruleIndex].isPrecedenceRule){let T=this._parentContextStack.pop();this.unrollRecursionContexts(T[0]),this.state=T[1]}else this.exitRule();let S=this._atn.states[this.state].transition(0);this.state=S.followState.stateNumber}addDecisionOverride(g,m,S){this.overrideDecision=g,this.overrideDecisionInputIndex=m,this.overrideDecisionAlt=S}get overrideDecisionRoot(){return this._overrideDecisionRoot}recover(g){let m=this._input.index;if(this.errorHandler.recover(this,g),this._input.index===m){let S=g.getOffendingToken();if(!S)throw new Error("Expected exception to have an offending token");let T=S.tokenSource,A=T!==void 0?T.inputStream:void 0,b={source:T,stream:A};if(g instanceof r.InputMismatchException){let N=g.expectedTokens;if(N===void 0)throw new Error("Expected the exception to provide expected tokens");let R=v.Token.INVALID_TYPE;N.isNil||(R=N.minElement);let P=this.tokenFactory.create(b,R,S.text,v.Token.DEFAULT_CHANNEL,-1,-1,S.line,S.charPositionInLine);this._ctx.addErrorNode(this.createErrorNode(this._ctx,P))}else{S.tokenSource;let N=this.tokenFactory.create(b,v.Token.INVALID_TYPE,S.text,v.Token.DEFAULT_CHANNEL,-1,-1,S.line,S.charPositionInLine);this._ctx.addErrorNode(this.createErrorNode(this._ctx,N))}}}recoverInline(){return this._errHandler.recoverInline(this)}get rootContext(){return this._rootContext}};return u([c.NotNull],x.prototype,"_vocabulary",void 0),u([a.Override],x.prototype,"reset",null),u([a.Override],x.prototype,"atn",null),u([a.Override],x.prototype,"vocabulary",null),u([a.Override],x.prototype,"ruleNames",null),u([a.Override],x.prototype,"grammarFileName",null),u([a.Override],x.prototype,"enterRecursionRule",null),x=u([e(1,c.NotNull)],x),Qt.ParserInterpreter=x,Qt}var Jt={},Fh;function L0(){if(Fh)return Jt;Fh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Jt&&Jt.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c},e=Jt&&Jt.__param||function(s,n){return function(r,o){n(r,o,s)}};Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.ParseTreeMatch=void 0;const t=J();let i=class{constructor(n,r,o,l){if(!n)throw new Error("tree cannot be null");if(!r)throw new Error("pattern cannot be null");if(!o)throw new Error("labels cannot be null");this._tree=n,this._pattern=r,this._labels=o,this._mismatchedNode=l}get(n){let r=this._labels.get(n);if(!(!r||r.length===0))return r[r.length-1]}getAll(n){const r=this._labels.get(n);return r||[]}get labels(){return this._labels}get mismatchedNode(){return this._mismatchedNode}get succeeded(){return!this._mismatchedNode}get pattern(){return this._pattern}get tree(){return this._tree}toString(){return`Match ${this.succeeded?"succeeded":"failed"}; found ${this.labels.size} labels`}};return u([t.NotNull,e(0,t.NotNull)],i.prototype,"getAll",null),u([t.NotNull],i.prototype,"labels",null),u([t.NotNull],i.prototype,"pattern",null),u([t.NotNull],i.prototype,"tree",null),u([t.Override],i.prototype,"toString",null),i=u([e(0,t.NotNull),e(1,t.NotNull),e(2,t.NotNull)],i),Jt.ParseTreeMatch=i,Jt}var Zt={},_i={},Ti={},Ph;function B0(){if(Ph)return Ti;Ph=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.XPathLexer=void 0;const u=Jl(),e=Or(),t=Eo(),i=Hn(),s=xr();let n=class Xe extends e.Lexer{constructor(o){super(o),this._interp=new t.LexerATNSimulator(Xe._ATN,this)}get vocabulary(){return Xe.VOCABULARY}get grammarFileName(){return"XPathLexer.g4"}get ruleNames(){return Xe.ruleNames}get serializedATN(){return Xe._serializedATN}get channelNames(){return Xe.channelNames}get modeNames(){return Xe.modeNames}action(o,l,c){switch(l){case 4:this.ID_action(o,c);break}}ID_action(o,l){switch(l){case 0:let c=this.text;c.charAt(0)===c.charAt(0).toUpperCase()?this.type=Xe.TOKEN_REF:this.type=Xe.RULE_REF;break}}static get _ATN(){return Xe.__ATN||(Xe.__ATN=new u.ATNDeserializer().deserialize(s.toCharArray(Xe._serializedATN))),Xe.__ATN}};return Ti.XPathLexer=n,n.TOKEN_REF=1,n.RULE_REF=2,n.ANYWHERE=3,n.ROOT=4,n.WILDCARD=5,n.BANG=6,n.ID=7,n.STRING=8,n.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"],n.modeNames=["DEFAULT_MODE"],n.ruleNames=["ANYWHERE","ROOT","WILDCARD","BANG","ID","NameChar","NameStartChar","STRING"],n._LITERAL_NAMES=[void 0,void 0,void 0,"'//'","'/'","'*'","'!'"],n._SYMBOLIC_NAMES=[void 0,"TOKEN_REF","RULE_REF","ANYWHERE","ROOT","WILDCARD","BANG","ID","STRING"],n.VOCABULARY=new i.VocabularyImpl(n._LITERAL_NAMES,n._SYMBOLIC_NAMES,[]),n._serializedATNSegments=2,n._serializedATNSegment0=`
2\b					\x07	\x07\b	\b			\x07
\f"\v\x07\x07\b\b		\x07	,
	\f		/\v			-
\x07\x07	\b\v	\r

2;C\\aac|\r(*<>?AOR_\uD801\uDA02\uDA38\uDA3D\uDA6E\uDA77\uDA77\uDA86\uDA86\uDA9D\uDAA1\uDAA3\uDAB1"C\\c|\r(*<>?AOR_`,n._serializedATNSegment1=`1\x07	\v\x07	\v\r%')\x071\x071\x071\x07,\b\x1B\x07#\x1B
 \b\r\x07"  !!#" #$\b$\f%&	&'(	()-\x07)*,\v+*,/-.-+.0/-01\x07)1 -`,n._serializedATN=s.join([n._serializedATNSegment0,n._serializedATNSegment1],""),Ti}var bn={},Dh;function M0(){if(Dh)return bn;Dh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=bn&&bn.__decorate||function(i,s,n,r){var o=arguments.length,l=o<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,n):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(i,s,n,r);else for(var a=i.length-1;a>=0;a--)(c=i[a])&&(l=(o<3?c(l):o>3?c(s,n,l):c(s,n))||l);return o>3&&l&&Object.defineProperty(s,n,l),l};Object.defineProperty(bn,"__esModule",{value:!0}),bn.XPathLexerErrorListener=void 0;const e=J();let t=class{syntaxError(s,n,r,o,l,c){}};return u([e.Override],t.prototype,"syntaxError",null),bn.XPathLexerErrorListener=t,bn}var Nn={},Rn={},Ih;function oi(){if(Ih)return Rn;Ih=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Rn&&Rn.__decorate||function(i,s,n,r){var o=arguments.length,l=o<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,n):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(i,s,n,r);else for(var a=i.length-1;a>=0;a--)(c=i[a])&&(l=(o<3?c(l):o>3?c(s,n,l):c(s,n))||l);return o>3&&l&&Object.defineProperty(s,n,l),l};Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.XPathElement=void 0;const e=J();let t=class{constructor(s){this.nodeName=s,this.invert=!1}toString(){let s=this.invert?"!":"";return Object.constructor.name+"["+s+this.nodeName+"]"}};return u([e.Override],t.prototype,"toString",null),Rn.XPathElement=t,Rn}var Lh;function k0(){if(Lh)return Nn;Lh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Nn&&Nn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.XPathRuleAnywhereElement=void 0;const e=J(),t=Vn(),i=oi();let s=class extends i.XPathElement{constructor(r,o){super(r),this.ruleIndex=o}evaluate(r){return t.Trees.findAllRuleNodes(r,this.ruleIndex)}};return u([e.Override],s.prototype,"evaluate",null),Nn.XPathRuleAnywhereElement=s,Nn}var wn={},Bh;function z0(){if(Bh)return wn;Bh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=wn&&wn.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h};Object.defineProperty(wn,"__esModule",{value:!0}),wn.XPathRuleElement=void 0;const e=ot(),t=J(),i=Vn(),s=oi();let n=class extends s.XPathElement{constructor(o,l){super(o),this.ruleIndex=l}evaluate(o){let l=[];for(let c of i.Trees.getChildren(o))c instanceof e.ParserRuleContext&&(c.ruleIndex===this.ruleIndex&&!this.invert||c.ruleIndex!==this.ruleIndex&&this.invert)&&l.push(c);return l}};return u([t.Override],n.prototype,"evaluate",null),wn.XPathRuleElement=n,wn}var On={},Mh;function j0(){if(Mh)return On;Mh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=On&&On.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(On,"__esModule",{value:!0}),On.XPathTokenAnywhereElement=void 0;const e=J(),t=Vn(),i=oi();let s=class extends i.XPathElement{constructor(r,o){super(r),this.tokenType=o}evaluate(r){return t.Trees.findAllTokenNodes(r,this.tokenType)}};return u([e.Override],s.prototype,"evaluate",null),On.XPathTokenAnywhereElement=s,On}var Fn={},kh;function q0(){if(kh)return Fn;kh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Fn&&Fn.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h};Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.XPathTokenElement=void 0;const e=J(),t=ii(),i=Vn(),s=oi();let n=class extends s.XPathElement{constructor(o,l){super(o),this.tokenType=l}evaluate(o){let l=[];for(let c of i.Trees.getChildren(o))c instanceof t.TerminalNode&&(c.symbol.type===this.tokenType&&!this.invert||c.symbol.type!==this.tokenType&&this.invert)&&l.push(c);return l}};return u([e.Override],n.prototype,"evaluate",null),Fn.XPathTokenElement=n,Fn}var Pn={},zh;function U0(){if(zh)return Pn;zh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Pn&&Pn.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h};Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.XPathWildcardAnywhereElement=void 0;const e=J(),t=Vn(),i=ta(),s=oi();let n=class extends s.XPathElement{constructor(){super(i.XPath.WILDCARD)}evaluate(o){return this.invert?[]:t.Trees.getDescendants(o)}};return u([e.Override],n.prototype,"evaluate",null),Pn.XPathWildcardAnywhereElement=n,Pn}var Dn={},jh;function H0(){if(jh)return Dn;jh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Dn&&Dn.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.XPathWildcardElement=void 0;const e=J(),t=Vn(),i=ta(),s=oi();let n=class extends s.XPathElement{constructor(){super(i.XPath.WILDCARD)}evaluate(o){let l=[];if(this.invert)return l;for(let c of t.Trees.getChildren(o))l.push(c);return l}};return u([e.Override],n.prototype,"evaluate",null),Dn.XPathWildcardElement=n,Dn}var qh;function ta(){if(qh)return _i;qh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(_i,"__esModule",{value:!0}),_i.XPath=void 0;const u=Zl(),e=ea(),t=Co(),i=ot(),s=Be(),n=B0(),r=M0(),o=k0(),l=z0(),c=j0(),a=q0(),h=U0(),f=H0();let d=class qd{constructor(v,x){this.parser=v,this.path=x,this.elements=this.split(x)}split(v){let x=new n.XPathLexer(u.CharStreams.fromString(v));x.recover=A=>{throw A},x.removeErrorListeners(),x.addErrorListener(new r.XPathLexerErrorListener);let y=new e.CommonTokenStream(x);try{y.fill()}catch(A){if(A instanceof t.LexerNoViableAltException){let N="Invalid tokens or characters at index "+x.charPositionInLine+" in path '"+v+"' -- "+A.message;throw new RangeError(N)}throw A}let g=y.getTokens(),m=[],S=g.length,T=0;e:for(;T<S;){let A=g[T],b;switch(A.type){case n.XPathLexer.ROOT:case n.XPathLexer.ANYWHERE:let N=A.type===n.XPathLexer.ANYWHERE;T++,b=g[T];let R=b.type===n.XPathLexer.BANG;R&&(T++,b=g[T]);let P=this.getXPathElement(b,N);P.invert=R,m.push(P),T++;break;case n.XPathLexer.TOKEN_REF:case n.XPathLexer.RULE_REF:case n.XPathLexer.WILDCARD:m.push(this.getXPathElement(A,!1)),T++;break;case s.Token.EOF:break e;default:throw new Error("Unknowth path element "+A)}}return m}getXPathElement(v,x){if(v.type===s.Token.EOF)throw new Error("Missing path element at end of path");let y=v.text;if(y==null)throw new Error("Expected wordToken to have text content.");let g=this.parser.getTokenType(y),m=this.parser.getRuleIndex(y);switch(v.type){case n.XPathLexer.WILDCARD:return x?new h.XPathWildcardAnywhereElement:new f.XPathWildcardElement;case n.XPathLexer.TOKEN_REF:case n.XPathLexer.STRING:if(g===s.Token.INVALID_TYPE)throw new Error(y+" at index "+v.startIndex+" isn't a valid token name");return x?new c.XPathTokenAnywhereElement(y,g):new a.XPathTokenElement(y,g);default:if(m===-1)throw new Error(y+" at index "+v.startIndex+" isn't a valid rule name");return x?new o.XPathRuleAnywhereElement(y,m):new l.XPathRuleElement(y,m)}}static findAll(v,x,y){return new qd(y,x).evaluate(v)}evaluate(v){let x=new i.ParserRuleContext;x.addChild(v);let y=new Set([x]),g=0;for(;g<this.elements.length;){let m=new Set;for(let S of y)S.childCount>0&&this.elements[g].evaluate(S).forEach(m.add,m);g++,y=m}return y}};return _i.XPath=d,d.WILDCARD="*",d.NOT="!",_i}var Uh;function $0(){if(Uh)return Zt;Uh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Zt&&Zt.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=Zt&&Zt.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.ParseTreePattern=void 0;const t=J(),i=ta();let s=class{constructor(r,o,l,c){this._matcher=r,this._patternRuleIndex=l,this._pattern=o,this._patternTree=c}match(r){return this._matcher.match(r,this)}matches(r){return this._matcher.match(r,this).succeeded}findAll(r,o){let l=i.XPath.findAll(r,o,this._matcher.parser),c=[];for(let a of l){let h=this.match(a);h.succeeded&&c.push(h)}return c}get matcher(){return this._matcher}get pattern(){return this._pattern}get patternRuleIndex(){return this._patternRuleIndex}get patternTree(){return this._patternTree}};return u([t.NotNull],s.prototype,"_pattern",void 0),u([t.NotNull],s.prototype,"_patternTree",void 0),u([t.NotNull],s.prototype,"_matcher",void 0),u([t.NotNull,e(0,t.NotNull)],s.prototype,"match",null),u([e(0,t.NotNull)],s.prototype,"matches",null),u([t.NotNull,e(0,t.NotNull),e(1,t.NotNull)],s.prototype,"findAll",null),u([t.NotNull],s.prototype,"matcher",null),u([t.NotNull],s.prototype,"pattern",null),u([t.NotNull],s.prototype,"patternTree",null),s=u([e(0,t.NotNull),e(1,t.NotNull),e(3,t.NotNull)],s),Zt.ParseTreePattern=s,Zt}var er={},Hh;function V0(){if(Hh)return er;Hh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=er&&er.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=er&&er.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(er,"__esModule",{value:!0}),er.RuleTagToken=void 0;const t=J(),i=Be();let s=class{constructor(r,o,l){if(r==null||r.length===0)throw new Error("ruleName cannot be null or empty.");this._ruleName=r,this.bypassTokenType=o,this._label=l}get ruleName(){return this._ruleName}get label(){return this._label}get channel(){return i.Token.DEFAULT_CHANNEL}get text(){return this._label!=null?"<"+this._label+":"+this._ruleName+">":"<"+this._ruleName+">"}get type(){return this.bypassTokenType}get line(){return 0}get charPositionInLine(){return-1}get tokenIndex(){return-1}get startIndex(){return-1}get stopIndex(){return-1}get tokenSource(){}get inputStream(){}toString(){return this._ruleName+":"+this.bypassTokenType}};return u([t.NotNull],s.prototype,"ruleName",null),u([t.Override],s.prototype,"channel",null),u([t.Override],s.prototype,"text",null),u([t.Override],s.prototype,"type",null),u([t.Override],s.prototype,"line",null),u([t.Override],s.prototype,"charPositionInLine",null),u([t.Override],s.prototype,"tokenIndex",null),u([t.Override],s.prototype,"startIndex",null),u([t.Override],s.prototype,"stopIndex",null),u([t.Override],s.prototype,"tokenSource",null),u([t.Override],s.prototype,"inputStream",null),u([t.Override],s.prototype,"toString",null),s=u([e(0,t.NotNull)],s),er.RuleTagToken=s,er}var In={},bi={},$h;function Ud(){if($h)return bi;$h=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(bi,"__esModule",{value:!0}),bi.Chunk=void 0;let u=class{};return bi.Chunk=u,bi}var Vh;function W0(){if(Vh)return In;Vh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=In&&In.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c};Object.defineProperty(In,"__esModule",{value:!0}),In.TagChunk=void 0;const e=Ud(),t=J();let i=class extends e.Chunk{constructor(n,r){if(super(),n==null||n.length===0)throw new Error("tag cannot be null or empty");this._tag=n,this._label=r}get tag(){return this._tag}get label(){return this._label}toString(){return this._label!=null?this._label+":"+this._tag:this._tag}};return u([t.NotNull],i.prototype,"tag",null),u([t.Override],i.prototype,"toString",null),In.TagChunk=i,In}var tr={},Wh;function G0(){if(Wh)return tr;Wh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=tr&&tr.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=tr&&tr.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(tr,"__esModule",{value:!0}),tr.TextChunk=void 0;const t=Ud(),i=J();let s=class extends t.Chunk{constructor(r){if(super(),r==null)throw new Error("text cannot be null");this._text=r}get text(){return this._text}toString(){return"'"+this._text+"'"}};return u([i.NotNull],s.prototype,"_text",void 0),u([i.NotNull],s.prototype,"text",null),u([i.Override],s.prototype,"toString",null),s=u([e(0,i.NotNull)],s),tr.TextChunk=s,tr}var rr={},Gh;function Y0(){if(Gh)return rr;Gh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=rr&&rr.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=rr&&rr.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(rr,"__esModule",{value:!0}),rr.TokenTagToken=void 0;const t=qi(),i=J();let s=class extends t.CommonToken{constructor(r,o,l){super(o),this._tokenName=r,this._label=l}get tokenName(){return this._tokenName}get label(){return this._label}get text(){return this._label!=null?"<"+this._label+":"+this._tokenName+">":"<"+this._tokenName+">"}toString(){return this._tokenName+":"+this.type}};return u([i.NotNull],s.prototype,"_tokenName",void 0),u([i.NotNull],s.prototype,"tokenName",null),u([i.Override],s.prototype,"text",null),u([i.Override],s.prototype,"toString",null),s=u([e(0,i.NotNull)],s),rr.TokenTagToken=s,rr}var Yh;function X0(){return Yh||(Yh=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=En&&En.__decorate||function(b,N,R,P){var I=arguments.length,B=I<3?N:P===null?P=Object.getOwnPropertyDescriptor(N,R):P,V;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(b,N,R,P);else for(var ee=b.length-1;ee>=0;ee--)(V=b[ee])&&(B=(I<3?V(B):I>3?V(N,R,B):V(N,R))||B);return I>3&&B&&Object.defineProperty(N,R,B),B},t=En&&En.__param||function(b,N){return function(R,P){N(R,P,b)}};Object.defineProperty(u,"__esModule",{value:!0}),u.ParseTreePatternMatcher=void 0;const i=Hd(),s=Zl(),n=ea(),r=Md(),o=I0(),l=J(),c=kd(),a=jd(),h=ot(),f=L0(),d=$0(),p=br(),v=Ql(),x=V0(),y=W0(),g=ii(),m=G0(),S=Be(),T=Y0();let A=class Tl{constructor(N,R){this.start="<",this.stop=">",this.escape="\\",this.escapeRE=/\\/g,this._lexer=N,this._parser=R}setDelimiters(N,R,P){if(!N)throw new Error("start cannot be null or empty");if(!R)throw new Error("stop cannot be null or empty");this.start=N,this.stop=R,this.escape=P,this.escapeRE=new RegExp(P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g")}matches(N,R,P=0){if(typeof R=="string"){let I=this.compile(R,P);return this.matches(N,I)}else{let I=new o.MultiMap;return!this.matchImpl(N,R.patternTree,I)}}match(N,R,P=0){if(typeof R=="string"){let I=this.compile(R,P);return this.match(N,I)}else{let I=new o.MultiMap,B=this.matchImpl(N,R.patternTree,I);return new f.ParseTreeMatch(N,R,I,B)}}compile(N,R){let P=this.tokenize(N),I=new r.ListTokenSource(P),B=new n.CommonTokenStream(I);const V=this._parser;let ee=new a.ParserInterpreter(V.grammarFileName,V.vocabulary,V.ruleNames,V.getATNWithBypassAlts(),B),te;try{ee.errorHandler=new i.BailErrorStrategy,te=ee.parse(R)}catch(le){throw le instanceof c.ParseCancellationException?le.getCause():le instanceof p.RecognitionException?le:le instanceof Error?new Tl.CannotInvokeStartRule(le):le}if(B.LA(1)!==S.Token.EOF)throw new Tl.StartRuleDoesNotConsumeFullPattern;return new d.ParseTreePattern(this,N,R,te)}get lexer(){return this._lexer}get parser(){return this._parser}matchImpl(N,R,P){if(!N)throw new TypeError("tree cannot be null");if(!R)throw new TypeError("patternTree cannot be null");if(N instanceof g.TerminalNode&&R instanceof g.TerminalNode){let I;if(N.symbol.type===R.symbol.type)if(R.symbol instanceof T.TokenTagToken){let B=R.symbol;P.map(B.tokenName,N);const V=B.label;V&&P.map(V,N)}else N.text===R.text||I||(I=N);else I||(I=N);return I}if(N instanceof h.ParserRuleContext&&R instanceof h.ParserRuleContext){let I,B=this.getRuleTagToken(R);if(B){if(N.ruleContext.ruleIndex===R.ruleContext.ruleIndex){P.map(B.ruleName,N);const ee=B.label;ee&&P.map(ee,N)}else I||(I=N);return I}if(N.childCount!==R.childCount)return I||(I=N),I;let V=N.childCount;for(let ee=0;ee<V;ee++){let te=this.matchImpl(N.getChild(ee),R.getChild(ee),P);if(te)return te}return I}return N}getRuleTagToken(N){if(N instanceof v.RuleNode&&N.childCount===1&&N.getChild(0)instanceof g.TerminalNode){let R=N.getChild(0);if(R.symbol instanceof x.RuleTagToken)return R.symbol}}tokenize(N){let R=this.split(N),P=[];for(let I of R)if(I instanceof y.TagChunk){let B=I;const V=B.tag.substr(0,1);if(V===V.toUpperCase()){let ee=this._parser.getTokenType(B.tag);if(ee===S.Token.INVALID_TYPE)throw new Error("Unknown token "+B.tag+" in pattern: "+N);let te=new T.TokenTagToken(B.tag,ee,B.label);P.push(te)}else if(V===V.toLowerCase()){let ee=this._parser.getRuleIndex(B.tag);if(ee===-1)throw new Error("Unknown rule "+B.tag+" in pattern: "+N);let te=this._parser.getATNWithBypassAlts().ruleToTokenType[ee];P.push(new x.RuleTagToken(B.tag,te,B.label))}else throw new Error("invalid tag: "+B.tag+" in pattern: "+N)}else{let B=I;this._lexer.inputStream=s.CharStreams.fromString(B.text);let V=this._lexer.nextToken();for(;V.type!==S.Token.EOF;)P.push(V),V=this._lexer.nextToken()}return P}split(N){let R=0,P=N.length,I=[],B=[],V=[];for(;R<P;)R===N.indexOf(this.escape+this.start,R)?R+=this.escape.length+this.start.length:R===N.indexOf(this.escape+this.stop,R)?R+=this.escape.length+this.stop.length:R===N.indexOf(this.start,R)?(B.push(R),R+=this.start.length):R===N.indexOf(this.stop,R)?(V.push(R),R+=this.stop.length):R++;if(B.length>V.length)throw new Error("unterminated tag in pattern: "+N);if(B.length<V.length)throw new Error("missing start tag in pattern: "+N);let ee=B.length;for(let te=0;te<ee;te++)if(B[te]>=V[te])throw new Error("tag delimiters out of order in pattern: "+N);if(ee===0){let te=N.substring(0,P);I.push(new m.TextChunk(te))}if(ee>0&&B[0]>0){let te=N.substring(0,B[0]);I.push(new m.TextChunk(te))}for(let te=0;te<ee;te++){let le=N.substring(B[te]+this.start.length,V[te]),ge=le,ce,Z=le.indexOf(":");if(Z>=0&&(ce=le.substring(0,Z),ge=le.substring(Z+1,le.length)),I.push(new y.TagChunk(ge,ce)),te+1<ee){let Y=N.substring(V[te]+this.stop.length,B[te+1]);I.push(new m.TextChunk(Y))}}if(ee>0){let te=V[ee-1]+this.stop.length;if(te<P){let le=N.substring(te,P);I.push(new m.TextChunk(le))}}for(let te=0;te<I.length;te++){let le=I[te];if(le instanceof m.TextChunk){let ge=le.text.replace(this.escapeRE,"");ge.length<le.text.length&&(I[te]=new m.TextChunk(ge))}}return I}};e([l.NotNull,t(1,l.NotNull)],A.prototype,"match",null),e([l.NotNull],A.prototype,"lexer",null),e([l.NotNull],A.prototype,"parser",null),e([t(0,l.NotNull),t(1,l.NotNull),t(2,l.NotNull)],A.prototype,"matchImpl",null),u.ParseTreePatternMatcher=A,function(b){class N extends Error{constructor(I){super(`CannotInvokeStartRule: ${I}`),this.error=I}}b.CannotInvokeStartRule=N;class R extends Error{constructor(){super("StartRuleDoesNotConsumeFullPattern")}}b.StartRuleDoesNotConsumeFullPattern=R}(A=u.ParseTreePatternMatcher||(u.ParseTreePatternMatcher={}))}(En)),En}var nr={},ir={},or={},Xh;function Wi(){if(Xh)return or;Xh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=or&&or.__decorate||function(s,n,r,o){var l=arguments.length,c=l<3?n:o===null?o=Object.getOwnPropertyDescriptor(n,r):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,n,r,o);else for(var h=s.length-1;h>=0;h--)(a=s[h])&&(c=(l<3?a(c):l>3?a(n,r,c):a(n,r))||c);return l>3&&c&&Object.defineProperty(n,r,c),c},e=or&&or.__param||function(s,n){return function(r,o){n(r,o,s)}};Object.defineProperty(or,"__esModule",{value:!0}),or.DecisionEventInfo=void 0;const t=J();let i=class{constructor(n,r,o,l,c,a){this.decision=n,this.fullCtx=a,this.stopIndex=c,this.input=o,this.startIndex=l,this.state=r}};return u([t.NotNull],i.prototype,"input",void 0),i=u([e(2,t.NotNull)],i),or.DecisionEventInfo=i,or}var Kh;function K0(){if(Kh)return ir;Kh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=ir&&ir.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=ir&&ir.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(ir,"__esModule",{value:!0}),ir.AmbiguityInfo=void 0;const t=Wi(),i=J();let s=class extends t.DecisionEventInfo{constructor(r,o,l,c,a,h){super(r,o,c,a,h,o.useContext),this.ambigAlts=l}get ambiguousAlternatives(){return this.ambigAlts}};return u([i.NotNull],s.prototype,"ambigAlts",void 0),u([i.NotNull],s.prototype,"ambiguousAlternatives",null),s=u([e(1,i.NotNull),e(2,i.NotNull),e(3,i.NotNull)],s),ir.AmbiguityInfo=s,ir}var sr={},Qh;function Q0(){if(Qh)return sr;Qh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=sr&&sr.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=sr&&sr.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(sr,"__esModule",{value:!0}),sr.ContextSensitivityInfo=void 0;const t=Wi(),i=J();let s=class extends t.DecisionEventInfo{constructor(r,o,l,c,a){super(r,o,l,c,a,!0)}};return s=u([e(1,i.NotNull),e(2,i.NotNull)],s),sr.ContextSensitivityInfo=s,sr}var Ln={},Jh;function J0(){if(Jh)return Ln;Jh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Ln&&Ln.__decorate||function(i,s,n,r){var o=arguments.length,l=o<3?s:r===null?r=Object.getOwnPropertyDescriptor(s,n):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(i,s,n,r);else for(var a=i.length-1;a>=0;a--)(c=i[a])&&(l=(o<3?c(l):o>3?c(s,n,l):c(s,n))||l);return o>3&&l&&Object.defineProperty(s,n,l),l};Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.DecisionInfo=void 0;const e=J();let t=class{constructor(s){this.invocations=0,this.timeInPrediction=0,this.SLL_TotalLook=0,this.SLL_MinLook=0,this.SLL_MaxLook=0,this.LL_TotalLook=0,this.LL_MinLook=0,this.LL_MaxLook=0,this.contextSensitivities=[],this.errors=[],this.ambiguities=[],this.predicateEvals=[],this.SLL_ATNTransitions=0,this.SLL_DFATransitions=0,this.LL_Fallback=0,this.LL_ATNTransitions=0,this.LL_DFATransitions=0,this.decision=s}toString(){return"{decision="+this.decision+", contextSensitivities="+this.contextSensitivities.length+", errors="+this.errors.length+", ambiguities="+this.ambiguities.length+", SLL_lookahead="+this.SLL_TotalLook+", SLL_ATNTransitions="+this.SLL_ATNTransitions+", SLL_DFATransitions="+this.SLL_DFATransitions+", LL_Fallback="+this.LL_Fallback+", LL_lookahead="+this.LL_TotalLook+", LL_ATNTransitions="+this.LL_ATNTransitions+"}"}};return u([e.Override],t.prototype,"toString",null),Ln.DecisionInfo=t,Ln}var lr={},Zh;function Z0(){if(Zh)return lr;Zh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=lr&&lr.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=lr&&lr.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(lr,"__esModule",{value:!0}),lr.ErrorInfo=void 0;const t=Wi(),i=J();let s=class extends t.DecisionEventInfo{constructor(r,o,l,c,a){super(r,o,l,c,a,o.useContext)}};return s=u([e(1,i.NotNull),e(2,i.NotNull)],s),lr.ErrorInfo=s,lr}var ar={},ef;function ex(){if(ef)return ar;ef=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=ar&&ar.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=ar&&ar.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(ar,"__esModule",{value:!0}),ar.LookaheadEventInfo=void 0;const t=Wi(),i=J();let s=class extends t.DecisionEventInfo{constructor(r,o,l,c,a,h,f){super(r,o,c,a,h,f),this.predictedAlt=l}};return s=u([e(3,i.NotNull)],s),ar.LookaheadEventInfo=s,ar}var ur={},tf;function tx(){if(tf)return ur;tf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=ur&&ur.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a},e=ur&&ur.__param||function(n,r){return function(o,l){r(o,l,n)}};Object.defineProperty(ur,"__esModule",{value:!0}),ur.PredicateEvalInfo=void 0;const t=Wi(),i=J();let s=class extends t.DecisionEventInfo{constructor(r,o,l,c,a,h,f,d){super(o,r,l,c,a,r.useContext),this.semctx=h,this.evalResult=f,this.predictedAlt=d}};return s=u([e(0,i.NotNull),e(2,i.NotNull),e(5,i.NotNull)],s),ur.PredicateEvalInfo=s,ur}var rf;function nf(){if(rf)return nr;rf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=nr&&nr.__decorate||function(v,x,y,g){var m=arguments.length,S=m<3?x:g===null?g=Object.getOwnPropertyDescriptor(x,y):g,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(v,x,y,g);else for(var A=v.length-1;A>=0;A--)(T=v[A])&&(S=(m<3?T(S):m>3?T(x,y,S):T(x,y))||S);return m>3&&S&&Object.defineProperty(x,y,S),S},e=nr&&nr.__param||function(v,x){return function(y,g){x(y,g,v)}};Object.defineProperty(nr,"__esModule",{value:!0}),nr.ProfilingATNSimulator=void 0;const t=K0(),i=ct(),s=Ao(),n=Q0(),r=J0(),o=Z0(),l=J(),c=ex(),a=Vi(),h=tx(),f=ri(),d=Fd();let p=class extends a.ParserATNSimulator{constructor(x){super(x.interpreter.atn,x),this._startIndex=0,this._sllStopIndex=0,this._llStopIndex=0,this.currentDecision=0,this.conflictingAltResolvedBySLL=0,this.optimize_ll1=!1,this.reportAmbiguities=!0,this.numDecisions=this.atn.decisionToState.length,this.decisions=[];for(let y=0;y<this.numDecisions;y++)this.decisions.push(new r.DecisionInfo(y))}adaptivePredict(x,y,g,m){if(m!==void 0)return super.adaptivePredict(x,y,g,m);try{this._input=x,this._startIndex=x.index,this._sllStopIndex=this._startIndex-1,this._llStopIndex=-1,this.currentDecision=y,this.currentState=void 0,this.conflictingAltResolvedBySLL=i.ATN.INVALID_ALT_NUMBER;let S=process.hrtime(),T=super.adaptivePredict(x,y,g),A=process.hrtime(),b=(A[0]-S[0])*1e9;b===0?b=A[1]-S[1]:b+=1e9-S[1]+A[1],this.decisions[y].timeInPrediction+=b,this.decisions[y].invocations++;let N=this._sllStopIndex-this._startIndex+1;if(this.decisions[y].SLL_TotalLook+=N,this.decisions[y].SLL_MinLook=this.decisions[y].SLL_MinLook===0?N:Math.min(this.decisions[y].SLL_MinLook,N),N>this.decisions[y].SLL_MaxLook&&(this.decisions[y].SLL_MaxLook=N,this.decisions[y].SLL_MaxLookEvent=new c.LookaheadEventInfo(y,void 0,T,x,this._startIndex,this._sllStopIndex,!1)),this._llStopIndex>=0){let R=this._llStopIndex-this._startIndex+1;this.decisions[y].LL_TotalLook+=R,this.decisions[y].LL_MinLook=this.decisions[y].LL_MinLook===0?R:Math.min(this.decisions[y].LL_MinLook,R),R>this.decisions[y].LL_MaxLook&&(this.decisions[y].LL_MaxLook=R,this.decisions[y].LL_MaxLookEvent=new c.LookaheadEventInfo(y,void 0,T,x,this._startIndex,this._llStopIndex,!0))}return T}finally{this._input=void 0,this.currentDecision=-1}}getStartState(x,y,g,m){let S=super.getStartState(x,y,g,m);return this.currentState=S,S}computeStartState(x,y,g){let m=super.computeStartState(x,y,g);return this.currentState=m,m}computeReachSet(x,y,g,m){if(this._input===void 0)throw new Error("Invalid state");let S=super.computeReachSet(x,y,g,m);return S==null&&this.decisions[this.currentDecision].errors.push(new o.ErrorInfo(this.currentDecision,y,this._input,this._startIndex,this._input.index)),this.currentState=S,S}getExistingTargetState(x,y){if(this.currentState===void 0||this._input===void 0)throw new Error("Invalid state");this.currentState.useContext?this._llStopIndex=this._input.index:this._sllStopIndex=this._input.index;let g=super.getExistingTargetState(x,y);if(g!=null&&(this.currentState=new d.SimulatorState(this.currentState.outerContext,g,this.currentState.useContext,this.currentState.remainingOuterContext),this.currentState.useContext?this.decisions[this.currentDecision].LL_DFATransitions++:this.decisions[this.currentDecision].SLL_DFATransitions++,g===s.ATNSimulator.ERROR)){let m=new d.SimulatorState(this.currentState.outerContext,x,this.currentState.useContext,this.currentState.remainingOuterContext);this.decisions[this.currentDecision].errors.push(new o.ErrorInfo(this.currentDecision,m,this._input,this._startIndex,this._input.index))}return g}computeTargetState(x,y,g,m,S,T){let A=super.computeTargetState(x,y,g,m,S,T);return S?this.decisions[this.currentDecision].LL_ATNTransitions++:this.decisions[this.currentDecision].SLL_ATNTransitions++,A}evalSemanticContextImpl(x,y,g){if(this.currentState===void 0||this._input===void 0)throw new Error("Invalid state");let m=super.evalSemanticContextImpl(x,y,g);if(!(x instanceof f.SemanticContext.PrecedencePredicate)){let T=this._llStopIndex>=0?this._llStopIndex:this._sllStopIndex;this.decisions[this.currentDecision].predicateEvals.push(new h.PredicateEvalInfo(this.currentState,this.currentDecision,this._input,this._startIndex,T,x,m,g))}return m}reportContextSensitivity(x,y,g,m,S){if(this._input===void 0)throw new Error("Invalid state");y!==this.conflictingAltResolvedBySLL&&this.decisions[this.currentDecision].contextSensitivities.push(new n.ContextSensitivityInfo(this.currentDecision,g,this._input,m,S)),super.reportContextSensitivity(x,y,g,m,S)}reportAttemptingFullContext(x,y,g,m,S){y!=null?this.conflictingAltResolvedBySLL=y.nextSetBit(0):this.conflictingAltResolvedBySLL=g.s0.configs.getRepresentedAlternatives().nextSetBit(0),this.decisions[this.currentDecision].LL_Fallback++,super.reportAttemptingFullContext(x,y,g,m,S)}reportAmbiguity(x,y,g,m,S,T,A){if(this.currentState===void 0||this._input===void 0)throw new Error("Invalid state");let b;T!=null?b=T.nextSetBit(0):b=A.getRepresentedAlternatives().nextSetBit(0),this.conflictingAltResolvedBySLL!==i.ATN.INVALID_ALT_NUMBER&&b!==this.conflictingAltResolvedBySLL&&this.decisions[this.currentDecision].contextSensitivities.push(new n.ContextSensitivityInfo(this.currentDecision,this.currentState,this._input,g,m)),this.decisions[this.currentDecision].ambiguities.push(new t.AmbiguityInfo(this.currentDecision,this.currentState,T,this._input,g,m)),super.reportAmbiguity(x,y,g,m,S,T,A)}getDecisionInfo(){return this.decisions}getCurrentState(){return this.currentState}};return u([l.Override,e(0,l.NotNull)],p.prototype,"adaptivePredict",null),u([l.Override],p.prototype,"getStartState",null),u([l.Override],p.prototype,"computeStartState",null),u([l.Override],p.prototype,"computeReachSet",null),u([l.Override],p.prototype,"getExistingTargetState",null),u([l.Override],p.prototype,"computeTargetState",null),u([l.Override],p.prototype,"evalSemanticContextImpl",null),u([l.Override],p.prototype,"reportContextSensitivity",null),u([l.Override],p.prototype,"reportAttemptingFullContext",null),u([l.Override,e(0,l.NotNull),e(5,l.NotNull),e(6,l.NotNull)],p.prototype,"reportAmbiguity",null),nr.ProfilingATNSimulator=p,nr}var of;function Gi(){if(of)return rt;of=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=rt&&rt.__decorate||function(m,S,T,A){var b=arguments.length,N=b<3?S:A===null?A=Object.getOwnPropertyDescriptor(S,T):A,R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(m,S,T,A);else for(var P=m.length-1;P>=0;P--)(R=m[P])&&(N=(b<3?R(N):b>3?R(S,T,N):R(S,T))||N);return b>3&&N&&Object.defineProperty(S,T,N),N},e=rt&&rt.__param||function(m,S){return function(T,A){S(T,A,m)}},t=rt&&rt.__awaiter||function(m,S,T,A){function b(N){return N instanceof T?N:new T(function(R){R(N)})}return new(T||(T=Promise))(function(N,R){function P(V){try{B(A.next(V))}catch(ee){R(ee)}}function I(V){try{B(A.throw(V))}catch(ee){R(ee)}}function B(V){V.done?N(V.value):b(V.value).then(P,I)}B((A=A.apply(m,S||[])).next())})};Object.defineProperty(rt,"__esModule",{value:!0}),rt.Parser=void 0;const i=xr(),s=vd(),n=Jl(),r=ra(),o=Kl(),l=ld(),c=Or(),a=J(),h=P0(),f=Vi(),d=Pd(),p=Hi(),v=ii(),x=Be();class y{constructor(S,T){this.ruleNames=S,this.tokenStream=T}enterEveryRule(S){console.log("enter   "+this.ruleNames[S.ruleIndex]+", LT(1)="+this.tokenStream.LT(1).text)}exitEveryRule(S){console.log("exit    "+this.ruleNames[S.ruleIndex]+", LT(1)="+this.tokenStream.LT(1).text)}visitErrorNode(S){}visitTerminal(S){let T=S.parent.ruleContext,A=S.symbol;console.log("consume "+A+" rule "+this.ruleNames[T.ruleIndex])}}u([a.Override],y.prototype,"enterEveryRule",null),u([a.Override],y.prototype,"exitEveryRule",null),u([a.Override],y.prototype,"visitErrorNode",null),u([a.Override],y.prototype,"visitTerminal",null);let g=class so extends p.Recognizer{constructor(S){super(),this._errHandler=new r.DefaultErrorStrategy,this._precedenceStack=new l.IntegerStack,this._buildParseTrees=!0,this._parseListeners=[],this._syntaxErrors=0,this.matchedEOF=!1,this._precedenceStack.push(0),this.inputStream=S}reset(S){(S===void 0||S)&&this.inputStream.seek(0),this._errHandler.reset(this),this._ctx=void 0,this._syntaxErrors=0,this.matchedEOF=!1,this.isTrace=!1,this._precedenceStack.clear(),this._precedenceStack.push(0);let T=this.interpreter;T!=null&&T.reset()}match(S){let T=this.currentToken;return T.type===S?(S===x.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):(T=this._errHandler.recoverInline(this),this._buildParseTrees&&T.tokenIndex===-1&&this._ctx.addErrorNode(this.createErrorNode(this._ctx,T))),T}matchWildcard(){let S=this.currentToken;return S.type>0?(this._errHandler.reportMatch(this),this.consume()):(S=this._errHandler.recoverInline(this),this._buildParseTrees&&S.tokenIndex===-1&&this._ctx.addErrorNode(this.createErrorNode(this._ctx,S))),S}set buildParseTree(S){this._buildParseTrees=S}get buildParseTree(){return this._buildParseTrees}getParseListeners(){return this._parseListeners}addParseListener(S){if(S==null)throw new TypeError("listener cannot be null");this._parseListeners.push(S)}removeParseListener(S){let T=this._parseListeners.findIndex(A=>A===S);T!==-1&&this._parseListeners.splice(T,1)}removeParseListeners(){this._parseListeners.length=0}triggerEnterRuleEvent(){for(let S of this._parseListeners)S.enterEveryRule&&S.enterEveryRule(this._ctx),this._ctx.enterRule(S)}triggerExitRuleEvent(){for(let S=this._parseListeners.length-1;S>=0;S--){let T=this._parseListeners[S];this._ctx.exitRule(T),T.exitEveryRule&&T.exitEveryRule(this._ctx)}}get numberOfSyntaxErrors(){return this._syntaxErrors}get tokenFactory(){return this._input.tokenSource.tokenFactory}getATNWithBypassAlts(){let S=this.serializedATN;if(S==null)throw new Error("The current parser does not support an ATN with bypass alternatives.");let T=so.bypassAltsAtnCache.get(S);if(T==null){let A=new s.ATNDeserializationOptions;A.isGenerateRuleBypassTransitions=!0,T=new n.ATNDeserializer(A).deserialize(i.toCharArray(S)),so.bypassAltsAtnCache.set(S,T)}return T}compileParseTreePattern(S,T,A){return t(this,void 0,void 0,function*(){if(!A){if(this.inputStream){let P=this.inputStream.tokenSource;P instanceof c.Lexer&&(A=P)}if(!A)throw new Error("Parser can't discover a lexer to use")}let b=A,N=yield Promise.resolve().then(()=>X0());return new N.ParseTreePatternMatcher(b,this).compile(S,T)})}get errorHandler(){return this._errHandler}set errorHandler(S){this._errHandler=S}get inputStream(){return this._input}set inputStream(S){this.reset(!1),this._input=S}get currentToken(){return this._input.LT(1)}notifyErrorListeners(S,T,A){T===void 0?T=this.currentToken:T===null&&(T=void 0),this._syntaxErrors++;let b=-1,N=-1;T!=null&&(b=T.line,N=T.charPositionInLine);let R=this.getErrorListenerDispatch();R.syntaxError&&R.syntaxError(this,T,b,N,S,A)}consume(){let S=this.currentToken;S.type!==so.EOF&&this.inputStream.consume();let T=this._parseListeners.length!==0;if(this._buildParseTrees||T)if(this._errHandler.inErrorRecoveryMode(this)){let A=this._ctx.addErrorNode(this.createErrorNode(this._ctx,S));if(T)for(let b of this._parseListeners)b.visitErrorNode&&b.visitErrorNode(A)}else{let A=this.createTerminalNode(this._ctx,S);if(this._ctx.addChild(A),T)for(let b of this._parseListeners)b.visitTerminal&&b.visitTerminal(A)}return S}createTerminalNode(S,T){return new v.TerminalNode(T)}createErrorNode(S,T){return new o.ErrorNode(T)}addContextToParseTree(){let S=this._ctx._parent;S!=null&&S.addChild(this._ctx)}enterRule(S,T,A){this.state=T,this._ctx=S,this._ctx._start=this._input.LT(1),this._buildParseTrees&&this.addContextToParseTree(),this.triggerEnterRuleEvent()}enterLeftFactoredRule(S,T,A){if(this.state=T,this._buildParseTrees){let b=this._ctx.getChild(this._ctx.childCount-1);this._ctx.removeLastChild(),b._parent=S,S.addChild(b)}this._ctx=S,this._ctx._start=this._input.LT(1),this._buildParseTrees&&this.addContextToParseTree(),this.triggerEnterRuleEvent()}exitRule(){this.matchedEOF?this._ctx._stop=this._input.LT(1):this._ctx._stop=this._input.tryLT(-1),this.triggerExitRuleEvent(),this.state=this._ctx.invokingState,this._ctx=this._ctx._parent}enterOuterAlt(S,T){if(S.altNumber=T,this._buildParseTrees&&this._ctx!==S){let A=this._ctx._parent;A!=null&&(A.removeLastChild(),A.addChild(S))}this._ctx=S}get precedence(){return this._precedenceStack.isEmpty?-1:this._precedenceStack.peek()}enterRecursionRule(S,T,A,b){this.state=T,this._precedenceStack.push(b),this._ctx=S,this._ctx._start=this._input.LT(1),this.triggerEnterRuleEvent()}pushNewRecursionContext(S,T,A){let b=this._ctx;b._parent=S,b.invokingState=T,b._stop=this._input.tryLT(-1),this._ctx=S,this._ctx._start=b._start,this._buildParseTrees&&this._ctx.addChild(b),this.triggerEnterRuleEvent()}unrollRecursionContexts(S){this._precedenceStack.pop(),this._ctx._stop=this._input.tryLT(-1);let T=this._ctx;if(this._parseListeners.length>0)for(;this._ctx!==S;)this.triggerExitRuleEvent(),this._ctx=this._ctx._parent;else this._ctx=S;T._parent=S,this._buildParseTrees&&S!=null&&S.addChild(T)}getInvokingContext(S){let T=this._ctx;for(;T&&T.ruleIndex!==S;)T=T._parent;return T}get context(){return this._ctx}set context(S){this._ctx=S}precpred(S,T){return T>=this._precedenceStack.peek()}getErrorListenerDispatch(){return new d.ProxyParserErrorListener(this.getErrorListeners())}inContext(S){return!1}isExpectedToken(S){let T=this.interpreter.atn,A=this._ctx,b=T.states[this.state],N=T.nextTokens(b);if(N.contains(S))return!0;if(!N.contains(x.Token.EPSILON))return!1;for(;A!=null&&A.invokingState>=0&&N.contains(x.Token.EPSILON);){let P=T.states[A.invokingState].transition(0);if(N=T.nextTokens(P.followState),N.contains(S))return!0;A=A._parent}return!!(N.contains(x.Token.EPSILON)&&S===x.Token.EOF)}get isMatchedEOF(){return this.matchedEOF}getExpectedTokens(){return this.atn.getExpectedTokens(this.state,this.context)}getExpectedTokensWithinCurrentRule(){let S=this.interpreter.atn,T=S.states[this.state];return S.nextTokens(T)}getRuleIndex(S){let T=this.getRuleIndexMap().get(S);return T??-1}get ruleContext(){return this._ctx}getRuleInvocationStack(S=this._ctx){let T=S,A=this.ruleNames,b=[];for(;T!=null;){let N=T.ruleIndex;N<0?b.push("n/a"):b.push(A[N]),T=T._parent}return b}getDFAStrings(){let S=[];for(let T of this._interp.atn.decisionToDFA)S.push(T.toString(this.vocabulary,this.ruleNames));return S}dumpDFA(){let S=!1;for(let T of this._interp.atn.decisionToDFA)T.isEmpty||(S&&console.log(),console.log("Decision "+T.decision+":"),process.stdout.write(T.toString(this.vocabulary,this.ruleNames)),S=!0)}get sourceName(){return this._input.sourceName}get parseInfo(){return Promise.resolve().then(()=>nf()).then(S=>{let T=this.interpreter;if(T instanceof S.ProfilingATNSimulator)return new h.ParseInfo(T)})}setProfile(S){return t(this,void 0,void 0,function*(){let T=yield Promise.resolve().then(()=>nf()),A=this.interpreter;S?A instanceof T.ProfilingATNSimulator||(this.interpreter=new T.ProfilingATNSimulator(this)):A instanceof T.ProfilingATNSimulator&&(this.interpreter=new f.ParserATNSimulator(this.atn,this)),this.interpreter.setPredictionMode(A.getPredictionMode())})}set isTrace(S){S?(this._tracer?this.removeParseListener(this._tracer):this._tracer=new y(this.ruleNames,this._input),this.addParseListener(this._tracer)):this._tracer&&(this.removeParseListener(this._tracer),this._tracer=void 0)}get isTrace(){return this._tracer!=null}};return g.bypassAltsAtnCache=new Map,u([a.NotNull],g.prototype,"_errHandler",void 0),u([a.NotNull],g.prototype,"match",null),u([a.NotNull],g.prototype,"matchWildcard",null),u([a.NotNull],g.prototype,"getParseListeners",null),u([e(0,a.NotNull)],g.prototype,"addParseListener",null),u([a.NotNull],g.prototype,"getATNWithBypassAlts",null),u([a.NotNull,e(0,a.NotNull)],g.prototype,"errorHandler",null),u([a.Override],g.prototype,"inputStream",null),u([a.NotNull],g.prototype,"currentToken",null),u([e(0,a.NotNull)],g.prototype,"enterRule",null),u([a.Override,e(0,a.Nullable)],g.prototype,"precpred",null),u([a.Override],g.prototype,"getErrorListenerDispatch",null),u([a.NotNull],g.prototype,"getExpectedTokens",null),u([a.NotNull],g.prototype,"getExpectedTokensWithinCurrentRule",null),u([a.Override],g.prototype,"parseInfo",null),rt.Parser=g,rt}var sf;function To(){if(sf)return rn;sf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=rn&&rn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(rn,"__esModule",{value:!0}),rn.NoViableAltException=void 0;const e=Gi(),t=br(),i=J();let s=class extends t.RecognitionException{constructor(r,o,l,c,a,h){r instanceof e.Parser&&(o===void 0&&(o=r.inputStream),l===void 0&&(l=r.currentToken),c===void 0&&(c=r.currentToken),h===void 0&&(h=r.context)),super(r,o,h),this._deadEndConfigs=a,this._startToken=l,this.setOffendingToken(r,c)}get startToken(){return this._startToken}get deadEndConfigs(){return this._deadEndConfigs}};return u([i.NotNull],s.prototype,"_startToken",void 0),rn.NoViableAltException=s,rn}var lf;function ra(){if(lf)return ht;lf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=ht&&ht.__decorate||function(f,d,p,v){var x=arguments.length,y=x<3?d:v===null?v=Object.getOwnPropertyDescriptor(d,p):v,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(f,d,p,v);else for(var m=f.length-1;m>=0;m--)(g=f[m])&&(y=(x<3?g(y):x>3?g(d,p,y):g(d,p))||y);return x>3&&y&&Object.defineProperty(d,p,y),y},e=ht&&ht.__param||function(f,d){return function(p,v){d(p,v,f)}};Object.defineProperty(ht,"__esModule",{value:!0}),ht.DefaultErrorStrategy=void 0;const t=pr(),i=Ue(),s=go(),n=yo(),r=$n(),o=To(),l=it(),c=Be(),a=J();let h=class{constructor(){this.errorRecoveryMode=!1,this.lastErrorIndex=-1,this.nextTokensState=t.ATNState.INVALID_STATE_NUMBER}reset(d){this.endErrorCondition(d)}beginErrorCondition(d){this.errorRecoveryMode=!0}inErrorRecoveryMode(d){return this.errorRecoveryMode}endErrorCondition(d){this.errorRecoveryMode=!1,this.lastErrorStates=void 0,this.lastErrorIndex=-1}reportMatch(d){this.endErrorCondition(d)}reportError(d,p){this.inErrorRecoveryMode(d)||(this.beginErrorCondition(d),p instanceof o.NoViableAltException?this.reportNoViableAlternative(d,p):p instanceof n.InputMismatchException?this.reportInputMismatch(d,p):p instanceof s.FailedPredicateException?this.reportFailedPredicate(d,p):(console.error(`unknown recognition error type: ${p}`),this.notifyErrorListeners(d,p.toString(),p)))}notifyErrorListeners(d,p,v){let x=v.getOffendingToken(d);x===void 0&&(x=null),d.notifyErrorListeners(p,x,v)}recover(d,p){this.lastErrorIndex===d.inputStream.index&&this.lastErrorStates&&this.lastErrorStates.contains(d.state)&&d.consume(),this.lastErrorIndex=d.inputStream.index,this.lastErrorStates||(this.lastErrorStates=new r.IntervalSet),this.lastErrorStates.add(d.state);let v=this.getErrorRecoverySet(d);this.consumeUntil(d,v)}sync(d){let p=d.interpreter.atn.states[d.state];if(this.inErrorRecoveryMode(d))return;let x=d.inputStream.LA(1),y=d.atn.nextTokens(p);if(y.contains(x)){this.nextTokensContext=void 0,this.nextTokensState=t.ATNState.INVALID_STATE_NUMBER;return}if(y.contains(c.Token.EPSILON)){this.nextTokensContext===void 0&&(this.nextTokensContext=d.context,this.nextTokensState=d.state);return}switch(p.stateType){case i.ATNStateType.BLOCK_START:case i.ATNStateType.STAR_BLOCK_START:case i.ATNStateType.PLUS_BLOCK_START:case i.ATNStateType.STAR_LOOP_ENTRY:if(this.singleTokenDeletion(d))return;throw new n.InputMismatchException(d);case i.ATNStateType.PLUS_LOOP_BACK:case i.ATNStateType.STAR_LOOP_BACK:this.reportUnwantedToken(d);let m=d.getExpectedTokens().or(this.getErrorRecoverySet(d));this.consumeUntil(d,m);break}}reportNoViableAlternative(d,p){let v=d.inputStream,x;v?p.startToken.type===c.Token.EOF?x="<EOF>":x=v.getTextFromRange(p.startToken,p.getOffendingToken()):x="<unknown input>";let y="no viable alternative at input "+this.escapeWSAndQuote(x);this.notifyErrorListeners(d,y,p)}reportInputMismatch(d,p){let v=p.expectedTokens,x=v?v.toStringVocabulary(d.vocabulary):"",y="mismatched input "+this.getTokenErrorDisplay(p.getOffendingToken(d))+" expecting "+x;this.notifyErrorListeners(d,y,p)}reportFailedPredicate(d,p){let x="rule "+d.ruleNames[d.context.ruleIndex]+" "+p.message;this.notifyErrorListeners(d,x,p)}reportUnwantedToken(d){if(this.inErrorRecoveryMode(d))return;this.beginErrorCondition(d);let p=d.currentToken,v=this.getTokenErrorDisplay(p),x=this.getExpectedTokens(d),y="extraneous input "+v+" expecting "+x.toStringVocabulary(d.vocabulary);d.notifyErrorListeners(y,p,void 0)}reportMissingToken(d){if(this.inErrorRecoveryMode(d))return;this.beginErrorCondition(d);let p=d.currentToken,x="missing "+this.getExpectedTokens(d).toStringVocabulary(d.vocabulary)+" at "+this.getTokenErrorDisplay(p);d.notifyErrorListeners(x,p,void 0)}recoverInline(d){let p=this.singleTokenDeletion(d);if(p)return d.consume(),p;if(this.singleTokenInsertion(d))return this.getMissingSymbol(d);throw this.nextTokensContext===void 0?new n.InputMismatchException(d):new n.InputMismatchException(d,this.nextTokensState,this.nextTokensContext)}singleTokenInsertion(d){let p=d.inputStream.LA(1),x=d.interpreter.atn.states[d.state].transition(0).target,y=d.interpreter.atn;return y.nextTokens(x,l.PredictionContext.fromRuleContext(y,d.context)).contains(p)?(this.reportMissingToken(d),!0):!1}singleTokenDeletion(d){let p=d.inputStream.LA(2);if(this.getExpectedTokens(d).contains(p)){this.reportUnwantedToken(d),d.consume();let x=d.currentToken;return this.reportMatch(d),x}}getMissingSymbol(d){let p=d.currentToken,v=this.getExpectedTokens(d),x=c.Token.INVALID_TYPE;v.isNil||(x=v.minElement);let y;x===c.Token.EOF?y="<missing EOF>":y="<missing "+d.vocabulary.getDisplayName(x)+">";let g=p,m=d.inputStream.tryLT(-1);return g.type===c.Token.EOF&&m!=null&&(g=m),this.constructToken(d.inputStream.tokenSource,x,y,g)}constructToken(d,p,v,x){let y=d.tokenFactory,g=x.tokenSource,m=g?g.inputStream:void 0;return y.create({source:d,stream:m},p,v,c.Token.DEFAULT_CHANNEL,-1,-1,x.line,x.charPositionInLine)}getExpectedTokens(d){return d.getExpectedTokens()}getTokenErrorDisplay(d){if(!d)return"<no token>";let p=this.getSymbolText(d);return p||(this.getSymbolType(d)===c.Token.EOF?p="<EOF>":p=`<${this.getSymbolType(d)}>`),this.escapeWSAndQuote(p)}getSymbolText(d){return d.text}getSymbolType(d){return d.type}escapeWSAndQuote(d){return d=d.replace(`
`,"\\n"),d=d.replace("\r","\\r"),d=d.replace("	","\\t"),"'"+d+"'"}getErrorRecoverySet(d){let p=d.interpreter.atn,v=d.context,x=new r.IntervalSet;for(;v&&v.invokingState>=0;){let g=p.states[v.invokingState].transition(0),m=p.nextTokens(g.followState);x.addAll(m),v=v._parent}return x.remove(c.Token.EPSILON),x}consumeUntil(d,p){let v=d.inputStream.LA(1);for(;v!==c.Token.EOF&&!p.contains(v);)d.consume(),v=d.inputStream.LA(1)}};return u([a.Override],h.prototype,"reset",null),u([e(0,a.NotNull)],h.prototype,"beginErrorCondition",null),u([a.Override],h.prototype,"inErrorRecoveryMode",null),u([e(0,a.NotNull)],h.prototype,"endErrorCondition",null),u([a.Override],h.prototype,"reportMatch",null),u([a.Override],h.prototype,"reportError",null),u([e(0,a.NotNull)],h.prototype,"notifyErrorListeners",null),u([a.Override],h.prototype,"recover",null),u([a.Override],h.prototype,"sync",null),u([e(0,a.NotNull),e(1,a.NotNull)],h.prototype,"reportNoViableAlternative",null),u([e(0,a.NotNull),e(1,a.NotNull)],h.prototype,"reportInputMismatch",null),u([e(0,a.NotNull),e(1,a.NotNull)],h.prototype,"reportFailedPredicate",null),u([e(0,a.NotNull)],h.prototype,"reportUnwantedToken",null),u([e(0,a.NotNull)],h.prototype,"reportMissingToken",null),u([a.Override],h.prototype,"recoverInline",null),u([e(0,a.NotNull)],h.prototype,"singleTokenInsertion",null),u([e(0,a.NotNull)],h.prototype,"singleTokenDeletion",null),u([a.NotNull,e(0,a.NotNull)],h.prototype,"getMissingSymbol",null),u([a.NotNull,e(0,a.NotNull)],h.prototype,"getExpectedTokens",null),u([e(0,a.NotNull)],h.prototype,"getSymbolText",null),u([e(0,a.NotNull)],h.prototype,"getSymbolType",null),u([a.NotNull,e(0,a.NotNull)],h.prototype,"escapeWSAndQuote",null),u([a.NotNull,e(0,a.NotNull)],h.prototype,"getErrorRecoverySet",null),u([e(0,a.NotNull),e(1,a.NotNull)],h.prototype,"consumeUntil",null),ht.DefaultErrorStrategy=h,ht}var af;function Hd(){if(af)return Lr;af=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Lr&&Lr.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h};Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.BailErrorStrategy=void 0;const e=ra(),t=yo(),i=J(),s=kd();let n=class extends e.DefaultErrorStrategy{recover(o,l){for(let c=o.context;c;c=c.parent)c.exception=l;throw new s.ParseCancellationException(l)}recoverInline(o){let l=new t.InputMismatchException(o);for(let c=o.context;c;c=c.parent)c.exception=l;throw new s.ParseCancellationException(l)}sync(o){}};return u([i.Override],n.prototype,"recover",null),u([i.Override],n.prototype,"recoverInline",null),u([i.Override],n.prototype,"sync",null),Lr.BailErrorStrategy=n,Lr}var il={},uf;function rx(){if(uf)return il;uf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(il,"__esModule",{value:!0}),il}var ol={},cf;function nx(){return cf||(cf=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(u,"__esModule",{value:!0}),u.Dependents=void 0,function(e){e[e.SELF=0]="SELF",e[e.PARENTS=1]="PARENTS",e[e.CHILDREN=2]="CHILDREN",e[e.ANCESTORS=3]="ANCESTORS",e[e.DESCENDANTS=4]="DESCENDANTS",e[e.SIBLINGS=5]="SIBLINGS",e[e.PRECEEDING_SIBLINGS=6]="PRECEEDING_SIBLINGS",e[e.FOLLOWING_SIBLINGS=7]="FOLLOWING_SIBLINGS",e[e.PRECEEDING=8]="PRECEEDING",e[e.FOLLOWING=9]="FOLLOWING"}(u.Dependents||(u.Dependents={}))}(ol)),ol}var cr={},hf;function ix(){if(hf)return cr;hf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=cr&&cr.__decorate||function(r,o,l,c){var a=arguments.length,h=a<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,l):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,o,l,c);else for(var d=r.length-1;d>=0;d--)(f=r[d])&&(h=(a<3?f(h):a>3?f(o,l,h):f(o,l))||h);return a>3&&h&&Object.defineProperty(o,l,h),h},e=cr&&cr.__param||function(r,o){return function(l,c){o(l,c,r)}};Object.defineProperty(cr,"__esModule",{value:!0}),cr.DiagnosticErrorListener=void 0;const t=wr(),i=J(),s=We();let n=class{constructor(o=!0){this.exactOnly=o,this.exactOnly=o}syntaxError(o,l,c,a,h,f){}reportAmbiguity(o,l,c,a,h,f,d){if(this.exactOnly&&!h)return;let p=this.getDecisionDescription(o,l),v=this.getConflictingAlts(f,d),x=o.inputStream.getText(s.Interval.of(c,a)),y=`reportAmbiguity d=${p}: ambigAlts=${v}, input='${x}'`;o.notifyErrorListeners(y)}reportAttemptingFullContext(o,l,c,a,h,f){let d=this.getDecisionDescription(o,l),p=o.inputStream.getText(s.Interval.of(c,a)),v=`reportAttemptingFullContext d=${d}, input='${p}'`;o.notifyErrorListeners(v)}reportContextSensitivity(o,l,c,a,h,f){let d=this.getDecisionDescription(o,l),p=o.inputStream.getText(s.Interval.of(c,a)),v=`reportContextSensitivity d=${d}, input='${p}'`;o.notifyErrorListeners(v)}getDecisionDescription(o,l){let c=l.decision,a=l.atnStartState.ruleIndex,h=o.ruleNames;if(a<0||a>=h.length)return c.toString();let f=h[a];return f?`${c} (${f})`:c.toString()}getConflictingAlts(o,l){if(o!=null)return o;let c=new t.BitSet;for(let a of l)c.set(a.alt);return c}};return u([i.Override],n.prototype,"syntaxError",null),u([i.Override,e(0,i.NotNull),e(1,i.NotNull),e(6,i.NotNull)],n.prototype,"reportAmbiguity",null),u([i.Override,e(0,i.NotNull),e(1,i.NotNull),e(5,i.NotNull)],n.prototype,"reportAttemptingFullContext",null),u([i.Override,e(0,i.NotNull),e(1,i.NotNull),e(5,i.NotNull)],n.prototype,"reportContextSensitivity",null),u([e(0,i.NotNull),e(1,i.NotNull)],n.prototype,"getDecisionDescription",null),u([i.NotNull,e(1,i.NotNull)],n.prototype,"getConflictingAlts",null),cr.DiagnosticErrorListener=n,cr}var hr={},ff;function ox(){if(ff)return hr;ff=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=hr&&hr.__decorate||function(o,l,c,a){var h=arguments.length,f=h<3?l:a===null?a=Object.getOwnPropertyDescriptor(l,c):a,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,l,c,a);else for(var p=o.length-1;p>=0;p--)(d=o[p])&&(f=(h<3?d(f):h>3?d(l,c,f):d(l,c))||f);return h>3&&f&&Object.defineProperty(l,c,f),f},e=hr&&hr.__param||function(o,l){return function(c,a){l(c,a,o)}};Object.defineProperty(hr,"__esModule",{value:!0}),hr.LexerInterpreter=void 0;const t=Or(),i=Eo(),s=J(),n=J();let r=class extends t.Lexer{constructor(l,c,a,h,f,d,p){if(super(p),d.grammarType!==0)throw new Error("IllegalArgumentException: The ATN must be a lexer ATN.");this._grammarFileName=l,this._atn=d,this._ruleNames=a.slice(0),this._channelNames=h.slice(0),this._modeNames=f.slice(0),this._vocabulary=c,this._interp=new i.LexerATNSimulator(d,this)}get atn(){return this._atn}get grammarFileName(){return this._grammarFileName}get ruleNames(){return this._ruleNames}get channelNames(){return this._channelNames}get modeNames(){return this._modeNames}get vocabulary(){return this._vocabulary}};return u([s.NotNull],r.prototype,"_vocabulary",void 0),u([n.Override],r.prototype,"atn",null),u([n.Override],r.prototype,"grammarFileName",null),u([n.Override],r.prototype,"ruleNames",null),u([n.Override],r.prototype,"channelNames",null),u([n.Override],r.prototype,"modeNames",null),u([n.Override],r.prototype,"vocabulary",null),r=u([e(1,s.NotNull)],r),hr.LexerInterpreter=r,hr}var sl={},df;function sx(){if(df)return sl;df=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(sl,"__esModule",{value:!0}),sl}var Bn={},pf;function lx(){if(pf)return Bn;pf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=Bn&&Bn.__decorate||function(n,r,o,l){var c=arguments.length,a=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,o):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,r,o,l);else for(var f=n.length-1;f>=0;f--)(h=n[f])&&(a=(c<3?h(a):c>3?h(r,o,a):h(r,o))||a);return c>3&&a&&Object.defineProperty(r,o,a),a};Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.RuleContextWithAltNum=void 0;const e=ct(),t=J(),i=ot();let s=class extends i.ParserRuleContext{constructor(r,o){o!==void 0?super(r,o):super(),this._altNumber=e.ATN.INVALID_ALT_NUMBER}get altNumber(){return this._altNumber}set altNumber(r){this._altNumber=r}};return u([t.Override],s.prototype,"altNumber",null),Bn.RuleContextWithAltNum=s,Bn}var Ni={},xf;function ax(){if(xf)return Ni;xf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.RuleDependency=void 0;function u(e){return(t,i,s)=>{}}return Ni.RuleDependency=u,Ni}var Ri={},mf;function ux(){if(mf)return Ri;mf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.RuleVersion=void 0;function u(e){return(t,i,s)=>{}}return Ri.RuleVersion=u,Ri}var ll={},gf;function cx(){if(gf)return ll;gf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(ll,"__esModule",{value:!0}),ll}var al={},yf;function hx(){if(yf)return al;yf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(al,"__esModule",{value:!0}),al}var ul={},vf;function fx(){if(vf)return ul;vf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(ul,"__esModule",{value:!0}),ul}var fr={},Sf;function dx(){if(Sf)return fr;Sf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var u=fr&&fr.__decorate||function(c,a,h,f){var d=arguments.length,p=d<3?a:f===null?f=Object.getOwnPropertyDescriptor(a,h):f,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,a,h,f);else for(var x=c.length-1;x>=0;x--)(v=c[x])&&(p=(d<3?v(p):d>3?v(a,h,p):v(a,h))||p);return d>3&&p&&Object.defineProperty(a,h,p),p};Object.defineProperty(fr,"__esModule",{value:!0}),fr.RewriteOperation=fr.TokenStreamRewriter=void 0;const e=We(),t=J(),i=Be();let s=class Ze{constructor(a){this.tokens=a,this.programs=new Map,this.programs.set(Ze.DEFAULT_PROGRAM_NAME,[]),this.lastRewriteTokenIndexes=new Map}getTokenStream(){return this.tokens}rollback(a,h=Ze.DEFAULT_PROGRAM_NAME){let f=this.programs.get(h);f!=null&&this.programs.set(h,f.slice(Ze.MIN_TOKEN_INDEX,a))}deleteProgram(a=Ze.DEFAULT_PROGRAM_NAME){this.rollback(Ze.MIN_TOKEN_INDEX,a)}insertAfter(a,h,f=Ze.DEFAULT_PROGRAM_NAME){let d;typeof a=="number"?d=a:d=a.tokenIndex;let p=this.getProgram(f),v=new o(this.tokens,d,p.length,h);p.push(v)}insertBefore(a,h,f=Ze.DEFAULT_PROGRAM_NAME){let d;typeof a=="number"?d=a:d=a.tokenIndex;let p=this.getProgram(f),v=new r(this.tokens,d,p.length,h);p.push(v)}replaceSingle(a,h){typeof a=="number"?this.replace(a,a,h):this.replace(a,a,h)}replace(a,h,f,d=Ze.DEFAULT_PROGRAM_NAME){if(typeof a!="number"&&(a=a.tokenIndex),typeof h!="number"&&(h=h.tokenIndex),a>h||a<0||h<0||h>=this.tokens.size)throw new RangeError(`replace: range invalid: ${a}..${h}(size=${this.tokens.size})`);let p=this.getProgram(d),v=new l(this.tokens,a,h,p.length,f);p.push(v)}delete(a,h,f=Ze.DEFAULT_PROGRAM_NAME){h===void 0&&(h=a),typeof a=="number"?this.replace(a,h,"",f):this.replace(a,h,"",f)}getLastRewriteTokenIndex(a=Ze.DEFAULT_PROGRAM_NAME){let h=this.lastRewriteTokenIndexes.get(a);return h??-1}setLastRewriteTokenIndex(a,h){this.lastRewriteTokenIndexes.set(a,h)}getProgram(a){let h=this.programs.get(a);return h==null&&(h=this.initializeProgram(a)),h}initializeProgram(a){let h=[];return this.programs.set(a,h),h}getText(a,h=Ze.DEFAULT_PROGRAM_NAME){let f;a instanceof e.Interval?f=a:f=e.Interval.of(0,this.tokens.size-1),typeof a=="string"&&(h=a);let d=this.programs.get(h),p=f.a,v=f.b;if(v>this.tokens.size-1&&(v=this.tokens.size-1),p<0&&(p=0),d==null||d.length===0)return this.tokens.getText(f);let x=[],y=this.reduceToSingleOperationPerIndex(d),g=p;for(;g<=v&&g<this.tokens.size;){let m=y.get(g);y.delete(g);let S=this.tokens.get(g);m==null?(S.type!==i.Token.EOF&&x.push(String(S.text)),g++):g=m.execute(x)}if(v===this.tokens.size-1)for(let m of y.values())m.index>=this.tokens.size-1&&x.push(m.text.toString());return x.join("")}reduceToSingleOperationPerIndex(a){for(let f=0;f<a.length;f++){let d=a[f];if(d==null||!(d instanceof l))continue;let p=d,v=this.getKindOfOps(a,r,f);for(let y of v)y.index===p.index?(a[y.instructionIndex]=void 0,p.text=y.text.toString()+(p.text!=null?p.text.toString():"")):y.index>p.index&&y.index<=p.lastIndex&&(a[y.instructionIndex]=void 0);let x=this.getKindOfOps(a,l,f);for(let y of x){if(y.index>=p.index&&y.lastIndex<=p.lastIndex){a[y.instructionIndex]=void 0;continue}let g=y.lastIndex<p.index||y.index>p.lastIndex;if(y.text==null&&p.text==null&&!g)a[y.instructionIndex]=void 0,p.index=Math.min(y.index,p.index),p.lastIndex=Math.max(y.lastIndex,p.lastIndex);else if(!g)throw new Error(`replace op boundaries of ${p} overlap with previous ${y}`)}}for(let f=0;f<a.length;f++){let d=a[f];if(d==null||!(d instanceof r))continue;let p=d,v=this.getKindOfOps(a,r,f);for(let y of v)y.index===p.index&&(y instanceof o?(p.text=this.catOpText(y.text,p.text),a[y.instructionIndex]=void 0):y instanceof r&&(p.text=this.catOpText(p.text,y.text),a[y.instructionIndex]=void 0));let x=this.getKindOfOps(a,l,f);for(let y of x){if(p.index===y.index){y.text=this.catOpText(p.text,y.text),a[f]=void 0;continue}if(p.index>=y.index&&p.index<=y.lastIndex)throw new Error(`insert op ${p} within boundaries of previous ${y}`)}}let h=new Map;for(let f of a)if(f!=null){if(h.get(f.index)!=null)throw new Error("should only be one op per index");h.set(f.index,f)}return h}catOpText(a,h){let f="",d="";return a!=null&&(f=a.toString()),h!=null&&(d=h.toString()),f+d}getKindOfOps(a,h,f){let d=[];for(let p=0;p<f&&p<a.length;p++){let v=a[p];v!=null&&v instanceof h&&d.push(v)}return d}};fr.TokenStreamRewriter=s,s.DEFAULT_PROGRAM_NAME="default",s.PROGRAM_INIT_SIZE=100,s.MIN_TOKEN_INDEX=0;class n{constructor(a,h,f,d){this.tokens=a,this.instructionIndex=f,this.index=h,this.text=d===void 0?"":d}execute(a){return this.index}toString(){let a=this.constructor.name,h=a.indexOf("$");return a=a.substring(h+1,a.length),"<"+a+"@"+this.tokens.get(this.index)+':"'+this.text+'">'}}u([t.Override],n.prototype,"toString",null),fr.RewriteOperation=n;class r extends n{constructor(a,h,f,d){super(a,h,f,d)}execute(a){return a.push(this.text.toString()),this.tokens.get(this.index).type!==i.Token.EOF&&a.push(String(this.tokens.get(this.index).text)),this.index+1}}u([t.Override],r.prototype,"execute",null);class o extends r{constructor(a,h,f,d){super(a,h+1,f,d)}}class l extends n{constructor(a,h,f,d,p){super(a,h,d,p),this.lastIndex=f}execute(a){return this.text!=null&&a.push(this.text.toString()),this.lastIndex+1}toString(){return this.text==null?"<DeleteOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+">":"<ReplaceOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+':"'+this.text+'">'}}return u([t.Override],l.prototype,"execute",null),u([t.Override],l.prototype,"toString",null),fr}var cl={},Af;function px(){if(Af)return cl;Af=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(cl,"__esModule",{value:!0}),cl}var hl={},Cf;function xx(){if(Cf)return hl;Cf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(hl,"__esModule",{value:!0}),hl}var Ef;function mx(){return Ef||(Ef=1,function(u){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Dr&&Dr.__createBinding||(Object.create?function(i,s,n,r){r===void 0&&(r=n),Object.defineProperty(i,r,{enumerable:!0,get:function(){return s[n]}})}:function(i,s,n,r){r===void 0&&(r=n),i[r]=s[n]}),t=Dr&&Dr.__exportStar||function(i,s){for(var n in i)n!=="default"&&!Object.prototype.hasOwnProperty.call(s,n)&&e(s,i,n)};Object.defineProperty(u,"__esModule",{value:!0}),t(dp(),u),t(pp(),u),t(n0(),u),t(Hd(),u),t(Bd(),u),t(rx(),u),t(Zl(),u),t(Dd(),u),t(Ld(),u),t(qi(),u),t(Hl(),u),t(ea(),u),t(hd(),u),t(ra(),u),t(nx(),u),t(ix(),u),t(go(),u),t(yo(),u),t(zd(),u),t(Tr(),u),t(Or(),u),t(ox(),u),t(Co(),u),t(Md(),u),t(To(),u),t(Gi(),u),t(sx(),u),t(jd(),u),t(ot(),u),t(Vl(),u),t(Pd(),u),t(br(),u),t(Hi(),u),t(Od(),u),t(lx(),u),t(ax(),u),t(ux(),u),t(Be(),u),t(cx(),u),t(hx(),u),t(fx(),u),t(dx(),u),t(px(),u),t(Hn(),u),t(xx(),u)}(Dr)),Dr}var Kn=mx(),$d=Jl(),gx=Or(),yx=Eo(),Vd=Hn(),Wd=xr();const Ae=class Ae extends gx.Lexer{get vocabulary(){return Ae.VOCABULARY}constructor(e){super(e),this._interp=new yx.LexerATNSimulator(Ae._ATN,this)}get grammarFileName(){return"Formula.g4"}get ruleNames(){return Ae.ruleNames}get serializedATN(){return Ae._serializedATN}get channelNames(){return Ae.channelNames}get modeNames(){return Ae.modeNames}action(e,t,i){switch(t){case 6:this.REF_action(e,i);break}}REF_action(e,t){}static get _ATN(){return Ae.__ATN||(Ae.__ATN=new $d.ATNDeserializer().deserialize(Wd.toCharArray(Ae._serializedATN))),Ae.__ATN}};k(Ae,"T__0",1),k(Ae,"T__1",2),k(Ae,"T__2",3),k(Ae,"REFERENCE",4),k(Ae,"REF",5),k(Ae,"REFRANGE",6),k(Ae,"BOOL",7),k(Ae,"STRING",8),k(Ae,"NUM",9),k(Ae,"FUNCNAME",10),k(Ae,"WS",11),k(Ae,"MUL",12),k(Ae,"DIV",13),k(Ae,"ADD",14),k(Ae,"SUB",15),k(Ae,"EQ",16),k(Ae,"NEQ",17),k(Ae,"LTE",18),k(Ae,"GTE",19),k(Ae,"LT",20),k(Ae,"GT",21),k(Ae,"channelNames",["DEFAULT_TOKEN_CHANNEL","HIDDEN"]),k(Ae,"modeNames",["DEFAULT_MODE"]),k(Ae,"ruleNames",["T__0","T__1","T__2","REFERENCE","SHEET_NAME","QUOTED_SHEET_NAME","REF","REFRANGE","BOOL","STRING","NUM","FUNCNAME","WS","MUL","DIV","ADD","SUB","EQ","NEQ","LTE","GTE","LT","GT"]),k(Ae,"_LITERAL_NAMES",[void 0,"'('","')'","','",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"'*'","'/'","'+'","'-'","'='","'<>'","'<='","'>='","'<'","'>'"]),k(Ae,"_SYMBOLIC_NAMES",[void 0,void 0,void 0,void 0,"REFERENCE","REF","REFRANGE","BOOL","STRING","NUM","FUNCNAME","WS","MUL","DIV","ADD","SUB","EQ","NEQ","LTE","GTE","LT","GT"]),k(Ae,"VOCABULARY",new Vd.VocabularyImpl(Ae._LITERAL_NAMES,Ae._SYMBOLIC_NAMES,[])),k(Ae,"_serializedATN",`\b					\x07	\x07\b	\b			
	
\v	\v\f	\f\r	\r											J
\x07N
\fQ\v\x07\x07\x07U
\x07\r\x07\x07V\x07\x07\b\b\\
\b\b\b\b\ba
\b\b\b\x07\be
\b\f\b\bh\v\b				




















\v\v\x07\v
\v\f\v\v\v\v\v\v\f\f
\f\r\f\f\f\f\f
\f\r\f\f\f
\f\r\r\x07\r
\r\f\r\r\v\r
\r\x07	\v\r\x07\b	
\v\f\x1B\r!#%')+-/
C\\c|2;C\\c|))3;2;$$\x07002;C\\aac|\v\v""\x07	\x1B!#%')+-/13\x075	I\vK\rR[i\x1B!#%')+-/12\x07*234\x07+456\x07.6\b78\r\x0789\x07#9:	:J;<\r\x07<=\x07#=>\b>J?@\v@A\x07#AB	BJCD\vDE\x07#EF\bFJGJ	HJ\bI7I;I?ICIGIHJ
KO	LN	MLNQOMOPP\fQORT\x07)SU
TSUVVTVWWXXY\x07)YZ\\\x07&[Z[\\\\]]^	^\`\b\b_a\x07&\`_\`aabbf	ce	dcehfdfgghfij\bjk\x07<kl\blmn\x07Vno\x07Top\x07Wp\x07Gqr\x07Hrs\x07Cst\x07Ntu\x07Uu\x07Gvw\x07vwx\x07txy\x07wy\x07gz{\x07h{|\x07c|}\x07n}~\x07u~\x07gmqvz\x07$
\x07\x07$	\x070			\b		\b\x07,\x071 \x07-"\x07/$\x07?&\x07>\x07@(\x07>\x07?*\x07@\x07?,\x07>.\x07@0IOV[\`f\b\b`),k(Ae,"__ATN");let Qn=Ae;var vx=ct(),Sx=go(),Ax=To(),Cx=Gi(),na=ot(),Ex=Vi(),fl=br(),dl=Be();const se=class se extends Cx.Parser{get vocabulary(){return se.VOCABULARY}get grammarFileName(){return"Formula.g4"}get ruleNames(){return se.ruleNames}get serializedATN(){return se._serializedATN}createFailedPredicateException(e,t){return new Sx.FailedPredicateException(this,e,t)}constructor(e){super(e),this._interp=new Ex.ParserATNSimulator(se._ATN,this)}formula(){let e=new _x(this._ctx,this.state);this.enterRule(e,0,se.RULE_formula);let t;try{this.enterOuterAlt(e,1);{this.state=7,this._errHandler.sync(this),t=this._input.LA(1);do this.state=6,this.expr(0),this.state=9,this._errHandler.sync(this),t=this._input.LA(1);while((t&-32)===0&&(1<<t&(1<<se.T__0|1<<se.REFERENCE|1<<se.BOOL|1<<se.STRING|1<<se.NUM|1<<se.FUNCNAME))!==0)}}catch(i){if(i instanceof fl.RecognitionException)e.exception=i,this._errHandler.reportError(this,i),this._errHandler.recover(this,i);else throw i}finally{this.exitRule()}return e}expr(e){e===void 0&&(e=0);let t=this._ctx,i=this.state,s=new Me(this._ctx,i),n=s,r=2;this.enterRecursionRule(s,2,se.RULE_expr,e);let o;try{let l;this.enterOuterAlt(s,1);{switch(this.state=26,this._errHandler.sync(this),this._input.LA(1)){case se.FUNCNAME:s=new Tx(s),this._ctx=s,n=s,this.state=12,this.match(se.FUNCNAME),this.state=13,this.match(se.T__0),this.state=15,this._errHandler.sync(this),o=this._input.LA(1),(o&-32)===0&&(1<<o&(1<<se.T__0|1<<se.REFERENCE|1<<se.BOOL|1<<se.STRING|1<<se.NUM|1<<se.FUNCNAME))!==0&&(this.state=14,this.args()),this.state=17,this.match(se.T__1);break;case se.NUM:s=new wx(s),this._ctx=s,n=s,this.state=18,this.match(se.NUM);break;case se.BOOL:s=new Ox(s),this._ctx=s,n=s,this.state=19,this.match(se.BOOL);break;case se.STRING:s=new Fx(s),this._ctx=s,n=s,this.state=20,this.match(se.STRING);break;case se.REFERENCE:s=new Px(s),this._ctx=s,n=s,this.state=21,this.match(se.REFERENCE);break;case se.T__0:s=new Dx(s),this._ctx=s,n=s,this.state=22,this.match(se.T__0),this.state=23,this.expr(0),this.state=24,this.match(se.T__1);break;default:throw new Ax.NoViableAltException(this)}for(this._ctx._stop=this._input.tryLT(-1),this.state=39,this._errHandler.sync(this),l=this.interpreter.adaptivePredict(this._input,4,this._ctx);l!==2&&l!==vx.ATN.INVALID_ALT_NUMBER;){if(l===1)switch(this._parseListeners!=null&&this.triggerExitRuleEvent(),n=s,this.state=37,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,3,this._ctx)){case 1:{if(s=new bx(new Me(t,i)),this.pushNewRecursionContext(s,r,se.RULE_expr),this.state=28,!this.precpred(this._ctx,8))throw this.createFailedPredicateException("this.precpred(this._ctx, 8)");this.state=29,s._op=this._input.LT(1),o=this._input.LA(1),o===se.MUL||o===se.DIV?(this._input.LA(1)===dl.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):s._op=this._errHandler.recoverInline(this),this.state=30,this.expr(9)}break;case 2:{if(s=new Nx(new Me(t,i)),this.pushNewRecursionContext(s,r,se.RULE_expr),this.state=31,!this.precpred(this._ctx,7))throw this.createFailedPredicateException("this.precpred(this._ctx, 7)");this.state=32,s._op=this._input.LT(1),o=this._input.LA(1),o===se.ADD||o===se.SUB?(this._input.LA(1)===dl.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):s._op=this._errHandler.recoverInline(this),this.state=33,this.expr(8)}break;case 3:{if(s=new Rx(new Me(t,i)),this.pushNewRecursionContext(s,r,se.RULE_expr),this.state=34,!this.precpred(this._ctx,6))throw this.createFailedPredicateException("this.precpred(this._ctx, 6)");this.state=35,s._op=this._input.LT(1),o=this._input.LA(1),(o&-32)===0&&(1<<o&(1<<se.EQ|1<<se.NEQ|1<<se.LTE|1<<se.GTE|1<<se.LT|1<<se.GT))!==0?(this._input.LA(1)===dl.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):s._op=this._errHandler.recoverInline(this),this.state=36,this.expr(7)}break}this.state=41,this._errHandler.sync(this),l=this.interpreter.adaptivePredict(this._input,4,this._ctx)}}}catch(l){if(l instanceof fl.RecognitionException)s.exception=l,this._errHandler.reportError(this,l),this._errHandler.recover(this,l);else throw l}finally{this.unrollRecursionContexts(t)}return s}args(){let e=new Gd(this._ctx,this.state);this.enterRule(e,4,se.RULE_args);let t;try{for(this.enterOuterAlt(e,1),this.state=42,this.expr(0),this.state=47,this._errHandler.sync(this),t=this._input.LA(1);t===se.T__2;)this.state=43,this.match(se.T__2),this.state=44,this.expr(0),this.state=49,this._errHandler.sync(this),t=this._input.LA(1)}catch(i){if(i instanceof fl.RecognitionException)e.exception=i,this._errHandler.reportError(this,i),this._errHandler.recover(this,i);else throw i}finally{this.exitRule()}return e}sempred(e,t,i){switch(t){case 1:return this.expr_sempred(e,i)}return!0}expr_sempred(e,t){switch(t){case 0:return this.precpred(this._ctx,8);case 1:return this.precpred(this._ctx,7);case 2:return this.precpred(this._ctx,6)}return!0}static get _ATN(){return se.__ATN||(se.__ATN=new $d.ATNDeserializer().deserialize(Wd.toCharArray(se._serializedATN))),se.__ATN}};k(se,"T__0",1),k(se,"T__1",2),k(se,"T__2",3),k(se,"REFERENCE",4),k(se,"REF",5),k(se,"REFRANGE",6),k(se,"BOOL",7),k(se,"STRING",8),k(se,"NUM",9),k(se,"FUNCNAME",10),k(se,"WS",11),k(se,"MUL",12),k(se,"DIV",13),k(se,"ADD",14),k(se,"SUB",15),k(se,"EQ",16),k(se,"NEQ",17),k(se,"LTE",18),k(se,"GTE",19),k(se,"LT",20),k(se,"GT",21),k(se,"RULE_formula",0),k(se,"RULE_expr",1),k(se,"RULE_args",2),k(se,"ruleNames",["formula","expr","args"]),k(se,"_LITERAL_NAMES",[void 0,"'('","')'","','",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"'*'","'/'","'+'","'-'","'='","'<>'","'<='","'>='","'<'","'>'"]),k(se,"_SYMBOLIC_NAMES",[void 0,void 0,void 0,void 0,"REFERENCE","REF","REFRANGE","BOOL","STRING","NUM","FUNCNAME","WS","MUL","DIV","ADD","SUB","EQ","NEQ","LTE","GTE","LT","GT"]),k(se,"VOCABULARY",new Vd.VocabularyImpl(se._LITERAL_NAMES,se._SYMBOLIC_NAMES,[])),k(se,"_serializedATN",`5			

\r\v

\x07(
\f+\v\x070
\f3\v<	,\b
	\b
\v\v	\v\f\f\r\b\x07\f\x07\x07\x07\v\x07	\x07
\x07\x07\x1B\x07\x1B\r)\f
 	 (\v!"\f	"#	#(
$%\f\b%&	&(	''!'$(+)')**+),1-.\x07.0/-031/122\x0731\b\v')1`),k(se,"__ATN");let Ie=se;class _x extends na.ParserRuleContext{expr(e){return e===void 0?this.getRuleContexts(Me):this.getRuleContext(e,Me)}constructor(e,t){super(e,t)}get ruleIndex(){return Ie.RULE_formula}enterRule(e){e.enterFormula&&e.enterFormula(this)}exitRule(e){e.exitFormula&&e.exitFormula(this)}accept(e){return e.visitFormula?e.visitFormula(this):e.visitChildren(this)}}class Me extends na.ParserRuleContext{constructor(e,t){super(e,t)}get ruleIndex(){return Ie.RULE_expr}copyFrom(e){super.copyFrom(e)}}class Tx extends Me{FUNCNAME(){return this.getToken(Ie.FUNCNAME,0)}args(){return this.tryGetRuleContext(0,Gd)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterFunction&&e.enterFunction(this)}exitRule(e){e.exitFunction&&e.exitFunction(this)}accept(e){return e.visitFunction?e.visitFunction(this):e.visitChildren(this)}}class bx extends Me{constructor(t){super(t.parent,t.invokingState);k(this,"_op");this.copyFrom(t)}expr(t){return t===void 0?this.getRuleContexts(Me):this.getRuleContext(t,Me)}MUL(){return this.tryGetToken(Ie.MUL,0)}DIV(){return this.tryGetToken(Ie.DIV,0)}enterRule(t){t.enterMulDiv&&t.enterMulDiv(this)}exitRule(t){t.exitMulDiv&&t.exitMulDiv(this)}accept(t){return t.visitMulDiv?t.visitMulDiv(this):t.visitChildren(this)}}class Nx extends Me{constructor(t){super(t.parent,t.invokingState);k(this,"_op");this.copyFrom(t)}expr(t){return t===void 0?this.getRuleContexts(Me):this.getRuleContext(t,Me)}ADD(){return this.tryGetToken(Ie.ADD,0)}SUB(){return this.tryGetToken(Ie.SUB,0)}enterRule(t){t.enterAddSub&&t.enterAddSub(this)}exitRule(t){t.exitAddSub&&t.exitAddSub(this)}accept(t){return t.visitAddSub?t.visitAddSub(this):t.visitChildren(this)}}class Rx extends Me{constructor(t){super(t.parent,t.invokingState);k(this,"_op");this.copyFrom(t)}expr(t){return t===void 0?this.getRuleContexts(Me):this.getRuleContext(t,Me)}EQ(){return this.tryGetToken(Ie.EQ,0)}NEQ(){return this.tryGetToken(Ie.NEQ,0)}LT(){return this.tryGetToken(Ie.LT,0)}GT(){return this.tryGetToken(Ie.GT,0)}LTE(){return this.tryGetToken(Ie.LTE,0)}GTE(){return this.tryGetToken(Ie.GTE,0)}enterRule(t){t.enterComparison&&t.enterComparison(this)}exitRule(t){t.exitComparison&&t.exitComparison(this)}accept(t){return t.visitComparison?t.visitComparison(this):t.visitChildren(this)}}class wx extends Me{NUM(){return this.getToken(Ie.NUM,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterNumber&&e.enterNumber(this)}exitRule(e){e.exitNumber&&e.exitNumber(this)}accept(e){return e.visitNumber?e.visitNumber(this):e.visitChildren(this)}}class Ox extends Me{BOOL(){return this.getToken(Ie.BOOL,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterBoolean&&e.enterBoolean(this)}exitRule(e){e.exitBoolean&&e.exitBoolean(this)}accept(e){return e.visitBoolean?e.visitBoolean(this):e.visitChildren(this)}}class Fx extends Me{STRING(){return this.getToken(Ie.STRING,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterStr&&e.enterStr(this)}exitRule(e){e.exitStr&&e.exitStr(this)}accept(e){return e.visitStr?e.visitStr(this):e.visitChildren(this)}}class Px extends Me{REFERENCE(){return this.getToken(Ie.REFERENCE,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterReference&&e.enterReference(this)}exitRule(e){e.exitReference&&e.exitReference(this)}accept(e){return e.visitReference?e.visitReference(this):e.visitChildren(this)}}class Dx extends Me{expr(){return this.getRuleContext(0,Me)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterParentheses&&e.enterParentheses(this)}exitRule(e){e.exitParentheses&&e.exitParentheses(this)}accept(e){return e.visitParentheses?e.visitParentheses(this):e.visitChildren(this)}}class Gd extends na.ParserRuleContext{expr(e){return e===void 0?this.getRuleContexts(Me):this.getRuleContext(e,Me)}constructor(e,t){super(e,t)}get ruleIndex(){return Ie.RULE_args}enterRule(e){e.enterArgs&&e.enterArgs(this)}exitRule(e){e.exitArgs&&e.exitArgs(this)}accept(e){return e.visitArgs?e.visitArgs(this):e.visitChildren(this)}}function*_f(u){const[e,t]=u;for(let i=e.r;i<=t.r;i++)for(let s=e.c;s<=t.c;s++)yield{r:i,c:s}}function Sr(u,e){const[t,i]=e;return t.r<=u.r&&u.r<=i.r&&t.c<=u.c&&u.c<=i.c}function Ix(u,e){const[t,i]=u,[s,n]=e;return s.r<=t.r&&i.r<=n.r&&s.c<=t.c&&i.c<=n.c}function st(u,e){return[{r:Math.min(u.r,e.r),c:Math.min(u.c,e.c)},{r:Math.max(u.r,e.r),c:Math.max(u.c,e.c)}]}function mr(u){return[Tf(u[0]),Tf(u[1])]}function lo(u,e){return Mi(u[0],e[0])&&Mi(u[1],e[1])}function Lx(u,e){const t=[];return u[0].r>e[0].r&&t.push([{r:u[0].r-1,c:u[0].c},{r:u[0].r-1,c:u[1].c}]),u[1].r<e[1].r&&t.push([{r:u[1].r+1,c:u[0].c},{r:u[1].r+1,c:u[1].c}]),u[0].c>e[0].c&&t.push([{r:u[0].r,c:u[0].c-1},{r:u[1].r,c:u[0].c-1}]),u[1].c<e[1].c&&t.push([{r:u[0].r,c:u[1].c+1},{r:u[1].r,c:u[1].c+1}]),t}function pl(u,e){const[t,i]=u,[s,n]=e;return[{r:Math.min(t.r,s.r),c:Math.min(t.c,s.c)},{r:Math.max(i.r,n.r),c:Math.max(i.c,n.c)}]}function Mi(u,e){return u.r===e.r&&u.c===e.c}function Tf(u){return{r:u.r,c:u.c}}function et(u){return u.includes(":")}function bo(u){return u.includes("!")}function Yd(u){const e=u.indexOf("!");if(e===-1)throw new Error(`Not a cross-sheet reference: ${u}`);let t=u.substring(0,e);t.startsWith("'")&&t.endsWith("'")&&(t=t.slice(1,-1));const i=u.substring(e+1);return{sheetName:t,localRef:i}}function*Fr(u){for(const e of u){if(bo(e)){const{sheetName:t,localRef:i}=Yd(e);if(i.includes(":")){const s=bl(i);for(const n of _f(s))yield`${t}!${xe(n)}`}else yield e;continue}if(et(e)){const t=bl(e);for(const i of _f(t))yield xe(i);continue}yield e}}function xe(u){return Jn(u.c)+u.r}function Bx(u){const[e,t]=u;return`${xe(e)}:${xe(t)}`}function Jn(u){let e="";for(;u>0;){const t=u%26;t===0?(e="Z"+e,u=Math.floor(u/26)-1):(e=String.fromCharCode(t+64)+e,u=Math.floor(u/26))}return e}function be(u){const e=u.replace(/\$/g,"");let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);if(48<=r&&r<=57){t=n;break}}if(t===0)throw new Error("Invalid Reference");const i=parseInt(e.substring(t)),s=e.substring(0,t).split("").reverse().reduce((n,r,o)=>n+Math.pow(26,o)*(r.charCodeAt(0)-65+1),0);if(isNaN(i)||isNaN(s))throw new Error("Invalid Reference");return{r:i,c:s}}function bl(u){const[e,t]=u.split(":");return[be(e),be(t)]}class Yi{constructor(){k(this,"ref");k(this,"bool");k(this,"num");k(this,"str")}static create(){return new Yi}setRef(e){return this.ref=e,this}setBool(e){return this.bool=e,this}setNum(e){return this.num=e,this}setStr(e){return this.str=e,this}map(e,t){return e.t==="bool"&&this.bool?this.bool(e):e.t==="num"&&this.num?this.num(e):e.t==="str"&&this.str?this.str(e):e.t==="ref"&&this.ref&&t?this.ref(e,t):e}*iterate(e,t,i){for(const s of e.expr()){const n=t(s);if(n.t==="ref"&&i)for(const r of Fr([n.v]))yield this.ref({t:"ref",v:r},i);else yield this.map(n)}}}function Mx(u){return{t:"num",v:u.v?1:0}}function kx(u){const e=Number(u);return{t:"num",v:isNaN(e)?0:e}}function zx(u,e){var s;if(et(u.v))return{t:"err",v:"#VALUE!"};const t=((s=e.get(u.v))==null?void 0:s.v)||"",i=Number(t);return{t:"num",v:isNaN(i)?0:i}}const Le=Yi.create().setRef(zx).setBool(Mx).setStr(kx);function jx(u){return{t:"bool",v:u.v!==0}}function qx(u,e){var s;if(et(u.v))return{t:"err",v:"#VALUE!"};const t=((s=e.get(u.v))==null?void 0:s.v)||"";if(t==="TRUE"||t==="true")return{t:"bool",v:!0};if(t==="FALSE"||t==="false"||t==="")return{t:"bool",v:!1};const i=Number(t);return isNaN(i)?{t:"err",v:"#VALUE!"}:{t:"bool",v:i!==0}}const si=Yi.create().setRef(qx).setNum(jx).setStr(()=>({t:"err",v:"#VALUE!"}));function Ux(u){return{t:"str",v:u.v.toString()}}function Hx(u){return{t:"str",v:u.v?"TRUE":"FALSE"}}function Xd(u,e){var i;return et(u.v)?{t:"err",v:"#VALUE!"}:{t:"str",v:((i=e.get(u.v))==null?void 0:i.v)||""}}Yi.create().setRef(Xd).setNum(Ux).setBool(Hx);const bf=new Map([["SUM",$x],["ABS",Vx],["ROUND",Gx],["ROUNDUP",Yx],["ROUNDDOWN",Xx],["INT",Kx],["MOD",Qx],["SQRT",Jx],["POWER",Zx],["PRODUCT",em],["MEDIAN",tm],["IF",rm],["IFS",nm],["SWITCH",im],["AND",om],["OR",sm],["NOT",lm],["AVERAGE",am],["MIN",um],["MAX",cm],["COUNT",hm],["COUNTA",fm],["COUNTBLANK",dm],["COUNTIF",pm],["SUMIF",xm],["COUNTIFS",mm],["SUMIFS",gm],["TRIM",ym],["LEN",vm],["LEFT",Sm],["RIGHT",Am],["MID",Cm],["CONCATENATE",Qd],["CONCAT",Em],["FIND",_m],["SEARCH",Tm],["TEXTJOIN",bm],["LOWER",Nm],["UPPER",Rm],["PROPER",wm],["SUBSTITUTE",Om],["TODAY",Fm],["NOW",Pm],["YEAR",Dm],["MONTH",Im],["DAY",Lm],["ISBLANK",Bm],["ISNUMBER",Mm],["ISTEXT",km],["IFERROR",zm]]);function $x(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};let s=0;for(const n of Le.iterate(i,e,t)){if(n.t==="err")return n;s+=n.v}return{t:"num",v:s}}function Vx(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=Le.map(e(s[0]),t);return n.t==="err"?n:{t:"num",v:Math.abs(n.v)}}function Wx(u){return u>=0?Math.floor(u+.5):Math.ceil(u-.5)}function ia(u,e,t){if(!u)return{t:"num",v:0};const i=Le.map(e(u),t);return i.t==="err"?i:{t:"num",v:Math.trunc(i.v)}}function No(u){return u.t==="err"}function Zn(u,e,t){const i=e(u);return i.t==="err"?i:i.t!=="ref"||!t?{t:"err",v:"#VALUE!"}:{t:"refs",v:Array.from(Fr([i.v]))}}function Kd(u){const e=Number(u);return isNaN(e)?0:e}function Ro(u,e){if(u.t==="err")return u;if(u.t==="num")return{op:"=",value:u.v.toString(),numericValue:u.v};if(u.t==="bool")return{op:"=",value:u.v?"TRUE":"FALSE",boolValue:u.v};const t=ke(u,e);if(t.t==="err")return t;const i=/^(<=|>=|<>|=|<|>)(.*)$/.exec(t.v),s=(i==null?void 0:i[1])||"=",n=i?i[2]:t.v;let r,o;if(n!==""){const c=Number(n);isNaN(c)?n.toUpperCase()==="TRUE"?o=!0:n.toUpperCase()==="FALSE"&&(o=!1):r=c}let l;return(s==="="||s==="<>")&&/(^|[^~])[*?]/.test(n)&&(l=new RegExp(`^${Zd(n)}$`,"i")),{op:s,value:n,numericValue:r,boolValue:o,wildcardPattern:l}}function wo(u,e){const t=u===""?void 0:Number(u),i=t!==void 0&&!isNaN(t),s=u.toUpperCase(),n=s==="TRUE"?!0:s==="FALSE"?!1:void 0,r=u.toLowerCase(),o=e.value.toLowerCase();if(e.op==="<"||e.op==="<="||e.op===">"||e.op===">=")return e.numericValue!==void 0?i?e.op==="<"?t<e.numericValue:e.op==="<="?t<=e.numericValue:e.op===">"?t>e.numericValue:t>=e.numericValue:!1:e.op==="<"?r<o:e.op==="<="?r<=o:e.op===">"?r>o:r>=o;let l=!1;return e.wildcardPattern?l=e.wildcardPattern.test(u):e.numericValue!==void 0&&i?l=t===e.numericValue:e.boolValue!==void 0&&n!==void 0?l=n===e.boolValue:l=r===o,e.op==="="?l:!l}function Gx(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<1||s.length>2)return{t:"err",v:"#N/A!"};const n=Le.map(e(s[0]),t);if(n.t==="err")return n;const r=ia(s[1],e,t);if(r.t==="err")return r;const o=10**r.v;return{t:"num",v:Wx(n.v*o)/o}}function Yx(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<1||s.length>2)return{t:"err",v:"#N/A!"};const n=Le.map(e(s[0]),t);if(n.t==="err")return n;const r=ia(s[1],e,t);if(r.t==="err")return r;const o=10**r.v,l=n.v*o;return{t:"num",v:(l>=0?Math.ceil(l):Math.floor(l))/o}}function Xx(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<1||s.length>2)return{t:"err",v:"#N/A!"};const n=Le.map(e(s[0]),t);if(n.t==="err")return n;const r=ia(s[1],e,t);if(r.t==="err")return r;const o=10**r.v,l=n.v*o;return{t:"num",v:(l>=0?Math.floor(l):Math.ceil(l))/o}}function Kx(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=Le.map(e(s[0]),t);return n.t==="err"?n:{t:"num",v:Math.floor(n.v)}}function Qx(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==2)return{t:"err",v:"#N/A!"};const n=Le.map(e(s[0]),t);if(n.t==="err")return n;const r=Le.map(e(s[1]),t);return r.t==="err"?r:r.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:n.v-r.v*Math.floor(n.v/r.v)}}function Jx(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=Le.map(e(s[0]),t);return n.t==="err"?n:n.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.sqrt(n.v)}}function Zx(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==2)return{t:"err",v:"#N/A!"};const n=Le.map(e(s[0]),t);if(n.t==="err")return n;const r=Le.map(e(s[1]),t);if(r.t==="err")return r;const o=Math.pow(n.v,r.v);return isFinite(o)?{t:"num",v:o}:{t:"err",v:"#VALUE!"}}function em(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};let s=1;for(const n of Le.iterate(i,e,t)){if(n.t==="err")return n;s*=n.v}return{t:"num",v:s}}function tm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=[];for(const r of Le.iterate(i,e,t)){if(r.t==="err")return r;s.push(r.v)}if(s.length===0)return{t:"err",v:"#VALUE!"};s.sort((r,o)=>r-o);const n=Math.floor(s.length/2);return s.length%2===1?{t:"num",v:s[n]}:{t:"num",v:(s[n-1]+s[n])/2}}function rm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<2||s.length>3)return{t:"err",v:"#N/A!"};const n=si.map(e(s[0]),t);return n.t==="err"?n:n.v?e(s[1]):s.length===3?e(s[2]):{t:"bool",v:!1}}function nm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<2||s.length%2!==0)return{t:"err",v:"#N/A!"};for(let n=0;n<s.length;n+=2){const r=si.map(e(s[n]),t);if(r.t==="err")return r;if(r.v)return e(s[n+1])}return{t:"err",v:"#N/A!"}}function im(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<3)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);if(n.t==="err")return n;const r=s.length-1,o=r%2===1,l=o?(r-1)/2:r/2;for(let c=0;c<l;c++){const a=ke(e(s[1+c*2]),t);if(a.t==="err")return a;if(a.v===n.v)return e(s[2+c*2])}return o?e(s[s.length-1]):{t:"err",v:"#N/A!"}}function om(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};for(const s of si.iterate(i,e,t)){if(s.t==="err")return s;if(!s.v)return{t:"bool",v:!1}}return{t:"bool",v:!0}}function sm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};for(const s of si.iterate(i,e,t)){if(s.t==="err")return s;if(s.v)return{t:"bool",v:!0}}return{t:"bool",v:!1}}function lm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=si.map(e(s[0]),t);return n.t==="err"?n:{t:"bool",v:!n.v}}function am(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};let s=0,n=0;for(const r of Le.iterate(i,e,t)){if(r.t==="err")return r;s+=r.v,n++}return n===0?{t:"err",v:"#VALUE!"}:{t:"num",v:s/n}}function um(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};let s=1/0;for(const n of Le.iterate(i,e,t)){if(n.t==="err")return n;n.v<s&&(s=n.v)}return{t:"num",v:s}}function cm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};let s=-1/0;for(const n of Le.iterate(i,e,t)){if(n.t==="err")return n;n.v>s&&(s=n.v)}return{t:"num",v:s}}function hm(u,e,t){var n,r;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};let s=0;for(const o of i.expr()){const l=e(o);if(l.t==="num")s++;else if(l.t==="bool")s++;else if(l.t==="ref"&&t)if(et(l.v))for(const c of Fr([l.v])){const a=((n=t.get(c))==null?void 0:n.v)||"";a!==""&&!isNaN(Number(a))&&s++}else{const c=((r=t.get(l.v))==null?void 0:r.v)||"";c!==""&&!isNaN(Number(c))&&s++}}return{t:"num",v:s}}function fm(u,e,t){var n,r;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};let s=0;for(const o of i.expr()){const l=e(o);if(l.t==="num"||l.t==="bool")s++;else if(l.t==="str")l.v!==""&&s++;else if(l.t==="ref"&&t)if(et(l.v))for(const c of Fr([l.v]))(((n=t.get(c))==null?void 0:n.v)||"")!==""&&s++;else(((r=t.get(l.v))==null?void 0:r.v)||"")!==""&&s++}return{t:"num",v:s}}function dm(u,e,t){var n,r;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};let s=0;for(const o of i.expr()){const l=e(o);if(l.t==="str"){l.v===""&&s++;continue}if(l.t!=="ref"||!t)continue;if(et(l.v)){for(const a of Fr([l.v]))(((n=t.get(a))==null?void 0:n.v)||"")===""&&s++;continue}(((r=t.get(l.v))==null?void 0:r.v)||"")===""&&s++}return{t:"num",v:s}}function pm(u,e,t){var l;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==2)return{t:"err",v:"#N/A!"};const n=Zn(s[0],e,t);if(n.t==="err")return n;const r=Ro(e(s[1]),t);if(No(r))return r;let o=0;for(const c of n.v){const a=((l=t==null?void 0:t.get(c))==null?void 0:l.v)||"";wo(a,r)&&o++}return{t:"num",v:o}}function xm(u,e,t){var c,a;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<2||s.length>3)return{t:"err",v:"#N/A!"};const n=Zn(s[0],e,t);if(n.t==="err")return n;const r=Ro(e(s[1]),t);if(No(r))return r;const o=s.length===3?Zn(s[2],e,t):n;if(o.t==="err")return o;if(n.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};let l=0;for(let h=0;h<n.v.length;h++){const f=((c=t==null?void 0:t.get(n.v[h]))==null?void 0:c.v)||"";if(!wo(f,r))continue;const d=((a=t==null?void 0:t.get(o.v[h]))==null?void 0:a.v)||"";l+=Kd(d)}return{t:"num",v:l}}function mm(u,e,t){var c;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<2||s.length%2!==0)return{t:"err",v:"#N/A!"};const n=[],r=[];for(let a=0;a<s.length;a+=2){const h=Zn(s[a],e,t);if(h.t==="err")return h;n.push(h.v);const f=Ro(e(s[a+1]),t);if(No(f))return f;r.push(f)}const o=n[0].length;if(n.some(a=>a.length!==o))return{t:"err",v:"#VALUE!"};let l=0;for(let a=0;a<o;a++){let h=!0;for(let f=0;f<n.length;f++){const d=((c=t==null?void 0:t.get(n[f][a]))==null?void 0:c.v)||"";if(!wo(d,r[f])){h=!1;break}}h&&l++}return{t:"num",v:l}}function gm(u,e,t){var c,a;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<3||(s.length-1)%2!==0)return{t:"err",v:"#N/A!"};const n=Zn(s[0],e,t);if(n.t==="err")return n;const r=[],o=[];for(let h=1;h<s.length;h+=2){const f=Zn(s[h],e,t);if(f.t==="err")return f;r.push(f.v);const d=Ro(e(s[h+1]),t);if(No(d))return d;o.push(d)}if(r.some(h=>h.length!==n.v.length))return{t:"err",v:"#VALUE!"};let l=0;for(let h=0;h<n.v.length;h++){let f=!0;for(let d=0;d<r.length;d++){const p=((c=t==null?void 0:t.get(r[d][h]))==null?void 0:c.v)||"";if(!wo(p,o[d])){f=!1;break}}f&&(l+=Kd(((a=t==null?void 0:t.get(n.v[h]))==null?void 0:a.v)||""))}return{t:"num",v:l}}function ke(u,e){return u.t==="err"||u.t==="str"?u:u.t==="num"?{t:"str",v:u.v.toString()}:u.t==="bool"?{t:"str",v:u.v?"TRUE":"FALSE"}:u.t==="ref"&&e?Xd(u,e):{t:"err",v:"#VALUE!"}}function ym(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);return n.t==="err"?n:{t:"str",v:n.v.trim()}}function vm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);return n.t==="err"?n:{t:"num",v:n.v.length}}function Sm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<1||s.length>2)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);if(n.t==="err")return n;let r=1;if(s.length===2){const o=Le.map(e(s[1]),t);if(o.t==="err")return o;r=o.v}return{t:"str",v:n.v.slice(0,r)}}function Am(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<1||s.length>2)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);if(n.t==="err")return n;let r=1;if(s.length===2){const o=Le.map(e(s[1]),t);if(o.t==="err")return o;r=o.v}return{t:"str",v:n.v.slice(-r)}}function Cm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==3)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);if(n.t==="err")return n;const r=Le.map(e(s[1]),t);if(r.t==="err")return r;const o=Le.map(e(s[2]),t);if(o.t==="err")return o;const l=r.v-1;return{t:"str",v:n.v.slice(l,l+o.v)}}function Qd(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<2)return{t:"err",v:"#N/A!"};let n="";for(const r of s){const o=ke(e(r),t);if(o.t==="err")return o;n+=o.v}return{t:"str",v:n}}function Em(u,e,t){return Qd(u,e,t)}function Jd(u,e,t,i){if(!u)return{t:"num",v:1};const s=Le.map(t(u),i);if(s.t==="err")return s;const n=Math.trunc(s.v);return n<1||n>e.length+1?{t:"err",v:"#VALUE!"}:{t:"num",v:n}}function _m(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<2||s.length>3)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);if(n.t==="err")return n;const r=ke(e(s[1]),t);if(r.t==="err")return r;const o=Jd(s[2],r.v,e,t);if(o.t==="err")return o;if(n.v==="")return{t:"num",v:o.v};const l=r.v.indexOf(n.v,o.v-1);return l<0?{t:"err",v:"#VALUE!"}:{t:"num",v:l+1}}function Zd(u){let e="";for(let t=0;t<u.length;t++){const i=u[t];if(i==="~"&&t+1<u.length){e+=u[t+1].replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),t++;continue}if(i==="*"){e+=".*";continue}if(i==="?"){e+=".";continue}e+=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}return e}function Tm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<2||s.length>3)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);if(n.t==="err")return n;const r=ke(e(s[1]),t);if(r.t==="err")return r;const o=Jd(s[2],r.v,e,t);if(o.t==="err")return o;if(n.v==="")return{t:"num",v:o.v};const l=Zd(n.v),c=new RegExp(l,"i"),a=r.v.slice(o.v-1),h=c.exec(a);return!h||h.index===void 0?{t:"err",v:"#VALUE!"}:{t:"num",v:o.v+h.index}}function bm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<3)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);if(n.t==="err")return n;const r=si.map(e(s[1]),t);if(r.t==="err")return r;const o=[];for(const l of s.slice(2)){const c=e(l);if(c.t==="ref"&&t&&et(c.v)){for(const h of Fr([c.v])){const f=ke({t:"ref",v:h},t);if(f.t==="err")return f;r.v&&f.v===""||o.push(f.v)}continue}const a=ke(c,t);if(a.t==="err")return a;r.v&&a.v===""||o.push(a.v)}return{t:"str",v:o.join(n.v)}}function Nm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);return n.t==="err"?n:{t:"str",v:n.v.toLowerCase()}}function Rm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);return n.t==="err"?n:{t:"str",v:n.v.toUpperCase()}}function wm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);return n.t==="err"?n:{t:"str",v:n.v.toLowerCase().replace(/\b([a-z])([a-z]*)/g,(o,l,c)=>l.toUpperCase()+c)}}function Om(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length<3||s.length>4)return{t:"err",v:"#N/A!"};const n=ke(e(s[0]),t);if(n.t==="err")return n;const r=ke(e(s[1]),t);if(r.t==="err")return r;const o=ke(e(s[2]),t);if(o.t==="err")return o;if(r.v==="")return{t:"str",v:n.v};if(s.length===3)return{t:"str",v:n.v.split(r.v).join(o.v)};const l=Le.map(e(s[3]),t);if(l.t==="err")return l;const c=Math.trunc(l.v);if(c<=0)return{t:"err",v:"#VALUE!"};let a=0,h=0;for(;;){const f=n.v.indexOf(r.v,a);if(f<0)return{t:"str",v:n.v};if(h++,h===c)return{t:"str",v:n.v.slice(0,f)+o.v+n.v.slice(f+r.v.length)};a=f+r.v.length}}function Fm(u,e,t){const i=u.args();if(i&&i.expr().length>0)return{t:"err",v:"#N/A!"};const s=new Date,n=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0");return{t:"str",v:`${n}-${r}-${o}`}}function Pm(u,e,t){const i=u.args();if(i&&i.expr().length>0)return{t:"err",v:"#N/A!"};const s=new Date,n=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0"),l=String(s.getHours()).padStart(2,"0"),c=String(s.getMinutes()).padStart(2,"0"),a=String(s.getSeconds()).padStart(2,"0");return{t:"str",v:`${n}-${r}-${o} ${l}:${c}:${a}`}}function oa(u,e){const t=ke(u,e);if(t.t==="err")return t;const i=new Date(t.v);return isNaN(i.getTime())?{t:"err",v:"#VALUE!"}:i}function Dm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=oa(e(s[0]),t);return n instanceof Date?{t:"num",v:n.getFullYear()}:n}function Im(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=oa(e(s[0]),t);return n instanceof Date?{t:"num",v:n.getMonth()+1}:n}function Lm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=oa(e(s[0]),t);return n instanceof Date?{t:"num",v:n.getDate()}:n}function Bm(u,e,t){var o;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=e(s[0]);return n.t==="err"?n:n.t!=="ref"||!t?{t:"bool",v:!1}:et(n.v)?{t:"err",v:"#VALUE!"}:{t:"bool",v:(((o=t.get(n.v))==null?void 0:o.v)||"")===""}}function Mm(u,e,t){var c;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=e(s[0]);if(n.t==="err")return n;if(n.t==="num")return{t:"bool",v:!0};if(n.t!=="ref"||!t)return{t:"bool",v:!1};if(et(n.v))return{t:"err",v:"#VALUE!"};const r=((c=t.get(n.v))==null?void 0:c.v)||"",o=r.toUpperCase();return{t:"bool",v:r!==""&&!(o==="TRUE"||o==="FALSE")&&!isNaN(Number(r))}}function km(u,e,t){var a;const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==1)return{t:"err",v:"#N/A!"};const n=e(s[0]);if(n.t==="err")return n;if(n.t==="str")return{t:"bool",v:!0};if(n.t!=="ref"||!t)return{t:"bool",v:!1};if(et(n.v))return{t:"err",v:"#VALUE!"};const r=((a=t.get(n.v))==null?void 0:a.v)||"";if(r==="")return{t:"bool",v:!1};const o=r.toUpperCase(),l=o==="TRUE"||o==="FALSE",c=!isNaN(Number(r));return{t:"bool",v:!l&&!c}}function zm(u,e,t){const i=u.args();if(!i)return{t:"err",v:"#N/A!"};const s=i.expr();if(s.length!==2)return{t:"err",v:"#N/A!"};const n=e(s[0]);return n.t==="err"?e(s[1]):n}function ep(u){const e=Kn.CharStreams.fromString(u.slice(1)),t=new Qn(e),i=new Kn.CommonTokenStream(t);t.removeErrorListeners(),i.fill();const s=new Set;for(const n of i.getTokens())n.type===Ie.REFERENCE&&s.add(n.text.toUpperCase());return s}function Pr(u){const e=Kn.CharStreams.fromString(u.slice(1)),t=new Qn(e),i=new Kn.CommonTokenStream(t);t.removeErrorListeners(),i.fill();const s=[];for(const o of i.getTokens())o.type!=Qn.EOF&&s.push({type:t.vocabulary.getSymbolicName(o.type)||"STRING",start:o.startIndex,stop:o.stopIndex,text:o.text});const n=[];let r;for(const o of s)!r&&o.start>0?n.push({type:"STRING",start:0,stop:o.start-1,text:u.slice(1,o.start+1)}):r&&r.stop+1!==o.start&&n.push({type:"STRING",start:r.stop+1,stop:o.start-1,text:u.slice(r.stop+2,o.start+1)}),n.push(o),r=o;return r&&r.stop+2<u.length&&n.push({type:"STRING",start:r.stop+1,stop:u.length-1,text:u.slice(r.stop+2)}),n}function wi(u){const e=Pr(u),t=[];for(const i of e)if(i.type==="REFERENCE")try{const s=i.text.toUpperCase();if(bo(s))continue;if(s.includes(":"))t.push({text:s,range:bl(s)});else{const n=be(s);t.push({text:s,range:[n,n]})}}catch{}return t}function jm(u,e){if(!u.startsWith("=")||e<=0)return!1;if(e===1)return!0;const t=Pr(u);for(const o of t){const l=o.start+1,c=o.stop+2;if(o.type==="REFERENCE"&&e>=l&&e<=c)return!0}const s=u.slice(0,e).trimEnd();if(s.length===0)return!1;const n=s[s.length-1];return new Set(["=","(",",","+","-","*","/","<",">",":"]).has(n)}function Nf(u,e){if(!u.startsWith("="))return;const t=Pr(u);for(const i of t){if(i.type!=="REFERENCE")continue;const s=i.start+1,n=i.stop+2;if(e>=s&&e<=n)return{start:s,end:n,text:i.text}}}function qm(u,e){var t;try{const i=Kn.CharStreams.fromString(u.slice(1)),s=new Qn(i),n=new Kn.CommonTokenStream(s),r=new Ie(n),o=r.expr(),l=new Um(e);s.removeErrorListeners(),r.removeErrorListeners();const c=l.visit(o);return c.t==="ref"&&e?et(c.v)?"#VALUE!":((t=e.get(c.v))==null?void 0:t.v)||"":c.v.toString()}catch{return"#ERROR!"}}class Um{constructor(e){k(this,"grid");this.visit=this.visit.bind(this),this.grid=e}visitChildren(){throw new Error("Method not implemented.")}visitTerminal(){throw new Error("Method not implemented.")}visitErrorNode(){throw new Error("Method not implemented.")}visitFormula(){throw new Error("Method not implemented.")}visitExpr(){throw new Error("Method not implemented.")}visitArgs(){throw new Error("Method not implemented.")}visit(e){return e.accept(this)}visitFunction(e){const t=e.FUNCNAME().text.toUpperCase();if(bf.has(t))return bf.get(t)(e,this.visit,this.grid);throw new Error("Function not implemented.")}visitReference(e){return this.grid?{t:"ref",v:e.text.toUpperCase()}:{t:"err",v:"#REF!"}}visitParentheses(e){return this.visit(e.expr())}visitNumber(e){return{t:"num",v:Number(e.text)}}visitBoolean(e){return{t:"bool",v:e.text==="TRUE"||e.text==="true"}}visitAddSub(e){const t=Le.map(this.visit(e.expr(0)),this.grid);if(t.t==="err")return t;const i=Le.map(this.visit(e.expr(1)),this.grid);return i.t==="err"?i:e._op.type===Ie.ADD?{t:"num",v:t.v+i.v}:{t:"num",v:t.v-i.v}}visitMulDiv(e){const t=Le.map(this.visit(e.expr(0)),this.grid);if(t.t==="err")return t;const i=Le.map(this.visit(e.expr(1)),this.grid);return i.t==="err"?i:e._op.type===Ie.MUL?{t:"num",v:t.v*i.v}:{t:"num",v:t.v/i.v}}visitComparison(e){const t=Le.map(this.visit(e.expr(0)),this.grid);if(t.t==="err")return t;const i=Le.map(this.visit(e.expr(1)),this.grid);if(i.t==="err")return i;switch(e._op.type){case Ie.EQ:return{t:"bool",v:t.v===i.v};case Ie.NEQ:return{t:"bool",v:t.v!==i.v};case Ie.LT:return{t:"bool",v:t.v<i.v};case Ie.GT:return{t:"bool",v:t.v>i.v};case Ie.LTE:return{t:"bool",v:t.v<=i.v};case Ie.GTE:return{t:"bool",v:t.v>=i.v};default:return{t:"err",v:"#ERROR!"}}}visitStr(e){return{t:"str",v:e.text.slice(1,-1)}}}function lt(u,e,t,i){const s=e+t;return i<=e?u>=e&&u<s?i+(u-e):u>=i&&u<e?u+t:u:u>=e&&u<s?i-t+(u-e):u>=s&&u<i?u-t:u}function qn(u,e,t,i,s){return e==="row"?{r:lt(u.r,t,i,s),c:u.c}:{r:u.r,c:lt(u.c,t,i,s)}}function Hm(u,e,t,i,s){const n=Pr(u);let r="=";for(const o of n)if(o.type==="REFERENCE"){const l=o.text;if(l.includes("!"))r+=l;else if(l.includes(":")){const[c,a]=l.split(":"),h=be(c.toUpperCase()),f=be(a.toUpperCase()),d=qn(h,e,t,i,s),p=qn(f,e,t,i,s);r+=xe(d)+":"+xe(p)}else{const c=be(l.toUpperCase()),a=qn(c,e,t,i,s);r+=xe(a)}}else r+=o.text;return r}function $m(u,e,t,i,s){const n=new Map;for(const[r,o]of u){const l=be(r),c=qn(l,e,t,i,s),a=xe(c);let h;o.f?h={...o,f:Hm(o.f,e,t,i,s)}:h={...o},n.set(a,h)}return n}function Er(u,e,t,i){const s=new Map;for(const[n,r]of u)s.set(lt(n,e,t,i),r);return s}function Rf(u,e,t){const i=Pr(u);let s="=";for(const n of i)if(n.type==="REFERENCE"){const r=n.text;if(r.includes("!"))s+=r;else if(r.includes(":")){const[o,l]=r.split(":"),c=be(o.toUpperCase()),a=be(l.toUpperCase()),h={r:c.r+e,c:c.c+t},f={r:a.r+e,c:a.c+t};h.r<1||h.c<1||f.r<1||f.c<1?s+="#REF!":s+=xe(h)+":"+xe(f)}else{const o=be(r.toUpperCase()),l={r:o.r+e,c:o.c+t};l.r<1||l.c<1?s+="#REF!":s+=xe(l)}}else s+=n.text;return s}function ao(u,e,t,i){const s=e==="row"?u.r:u.c;if(i>0)return s>=t?e==="row"?{r:u.r+i,c:u.c}:{r:u.r,c:u.c+i}:u;const n=Math.abs(i);return s>=t&&s<t+n?null:s>=t+n?e==="row"?{r:u.r+i,c:u.c}:{r:u.r,c:u.c+i}:u}function Vm(u,e,t,i){const s=be(u),n=ao(s,e,t,i);return n?xe(n):null}function Wm(u,e,t,i){const s=Pr(u);let n="=";for(const r of s)if(r.type==="REFERENCE"){const o=r.text;if(o.includes("!"))n+=o;else if(o.includes(":")){const[l,c]=o.split(":"),a=be(l.toUpperCase()),h=be(c.toUpperCase()),f=ao(a,e,t,i),d=ao(h,e,t,i);!f||!d?n+="#REF!":n+=xe(f)+":"+xe(d)}else{const l=be(o.toUpperCase()),c=ao(l,e,t,i);c?n+=xe(c):n+="#REF!"}}else n+=r.text;return n}function _r(u,e,t){const i=new Map;for(const[s,n]of u)if(t>0)s>=e?i.set(s+t,n):i.set(s,n);else{const r=Math.abs(t);s>=e&&s<e+r||(s>=e+r?i.set(s+t,n):i.set(s,n))}return i}function Gm(u,e,t,i){const s=new Map;for(const[n,r]of u){const o=Vm(n,e,t,i);if(o===null)continue;let l;r.f?l={...r,f:Wm(r.f,e,t,i)}:l={...r},s.set(o,l)}return s}function Oi(u,e){return[{r:u.r,c:u.c},{r:u.r+e.rs-1,c:u.c+e.cs-1}]}function wf(u,e,t,i){if(i>0)return t<=u?[u+i,e+i]:t<=e?[u,e+i]:[u,e];const s=Math.abs(i),n=t,r=t+s-1;if(r<u)return[u+i,e+i];if(n>e)return[u,e];const o=Math.max(u,n),c=Math.min(e,r)-o+1,a=e-u+1-c;return a<=0?null:n<=u?[n,n+a-1]:[u,u+a-1]}function Ym(u,e,t,i,s){const n=wf(u.r,u.r+e.rs-1,t==="row"?i:Number.NEGATIVE_INFINITY,t==="row"?s:0);if(!n)return null;const r=wf(u.c,u.c+e.cs-1,t==="column"?i:Number.NEGATIVE_INFINITY,t==="column"?s:0);if(!r)return null;const[o,l]=n,[c,a]=r,h=l-o+1,f=a-c+1;return h<=1&&f<=1?null:{anchor:{r:o,c},span:{rs:h,cs:f}}}function Xm(u,e,t,i,s,n){const r=t==="row"?u.r+e.rs-1:u.c+e.cs-1,o=t==="row"?u.r:u.c,l=lt(o,i,s,n),c=lt(r,i,s,n),a=Math.min(l,c),f=Math.max(l,c)-a+1;if(t==="row"){const v=f,x=e.cs;return v<=1&&x<=1?null:{anchor:{r:a,c:u.c},span:{rs:v,cs:x}}}const d=e.rs,p=f;return d<=1&&p<=1?null:{anchor:{r:u.r,c:a},span:{rs:d,cs:p}}}function tp(u,e,t,i){const s=new Map;for(const[n,r]of u){const o=be(n),l=Ym(o,r,e,t,i);l&&s.set(xe(l.anchor),l.span)}return s}function rp(u,e,t,i,s){const n=new Map;for(const[r,o]of u){const l=be(r),c=Xm(l,o,e,t,i,s);c&&n.set(xe(c.anchor),c.span)}return n}function Km(u,e,t,i,s){const n=t==="row"?u.r:u.c,r=t==="row"?u.r+e.rs-1:u.c+e.cs-1,o=i+s-1;return r<i||n>o?!1:!(n>=i&&r<=o)}class Of{constructor(e){k(this,"customSizes");k(this,"defaultSize");k(this,"cacheDirty",!0);k(this,"sortedIndices",[]);k(this,"sortedSizes",[]);k(this,"prefixDeltas",[]);k(this,"customStarts",[]);this.defaultSize=e,this.customSizes=new Map}getSize(e){return this.customSizes.get(e)??this.defaultSize}setSize(e,t){t===this.defaultSize?this.customSizes.delete(e):this.customSizes.set(e,t),this.cacheDirty=!0}getDefaultSize(){return this.defaultSize}getOffset(e){let t=(e-1)*this.defaultSize;if(this.customSizes.size===0)return t;this.ensureCache();const i=this.lowerBound(this.sortedIndices,e)-1;return i>=0&&(t+=this.prefixDeltas[i]),t}findIndex(e){if(e<0)return 1;if(this.customSizes.size===0)return Math.floor(e/this.defaultSize)+1;this.ensureCache();const t=this.customStarts[0];if(e<t)return Math.floor(e/this.defaultSize)+1;const i=this.upperBound(this.customStarts,e)-1,s=this.sortedIndices[i],n=this.customStarts[i],r=this.sortedSizes[i];if(e<n+r)return s;const o=e-(n+r);return s+1+Math.floor(o/this.defaultSize)}shift(e,t){const i=new Map;for(const[s,n]of this.customSizes)if(t>0)s>=e?i.set(s+t,n):i.set(s,n);else{const r=Math.abs(t);s>=e&&s<e+r||(s>=e+r?i.set(s+t,n):i.set(s,n))}this.customSizes=i,this.cacheDirty=!0}move(e,t,i){const s=new Map;for(const[n,r]of this.customSizes)s.set(lt(n,e,t,i),r);this.customSizes=s,this.cacheDirty=!0}clear(){this.customSizes.clear(),this.cacheDirty=!0}hasCustomSizes(){return this.customSizes.size>0}ensureCache(){if(!this.cacheDirty)return;if(this.customSizes.size===0){this.sortedIndices=[],this.sortedSizes=[],this.prefixDeltas=[],this.customStarts=[],this.cacheDirty=!1;return}const e=Array.from(this.customSizes.entries()).sort((i,s)=>i[0]-s[0]);this.sortedIndices=[],this.sortedSizes=[],this.prefixDeltas=[],this.customStarts=[];let t=0;for(const[i,s]of e)this.sortedIndices.push(i),this.sortedSizes.push(s),this.customStarts.push((i-1)*this.defaultSize+t),t+=s-this.defaultSize,this.prefixDeltas.push(t);this.cacheDirty=!1}lowerBound(e,t){let i=0,s=e.length;for(;i<s;){const n=i+Math.floor((s-i)/2);e[n]<t?i=n+1:s=n}return i}upperBound(e,t){let i=0,s=e.length;for(;i<s;){const n=i+Math.floor((s-i)/2);e[n]<=t?i=n+1:s=n}return i}}class Qm{constructor(){k(this,"rowIndex",new Map);k(this,"colIndex",new Map)}add(e,t){let i=this.rowIndex.get(e);i||(i=new Set,this.rowIndex.set(e,i)),i.add(t);let s=this.colIndex.get(t);s||(s=new Set,this.colIndex.set(t,s)),s.add(e)}remove(e,t){const i=this.rowIndex.get(e);i&&(i.delete(t),i.size===0&&this.rowIndex.delete(e));const s=this.colIndex.get(t);s&&(s.delete(e),s.size===0&&this.colIndex.delete(t))}has(e,t){const i=this.rowIndex.get(e);return i!==void 0&&i.has(t)}clear(){this.rowIndex.clear(),this.colIndex.clear()}rebuild(e){this.clear();for(const[t,i]of e)this.add(t,i)}*cellsInRange(e){const[t,i]=e;for(const[s,n]of this.rowIndex)if(!(s<t.r||s>i.r))for(const r of n)r>=t.c&&r<=i.c&&(yield[s,r])}hasAnyInRange(e){return!this.cellsInRange(e).next().done}getOccupiedColsInRow(e){return this.rowIndex.get(e)}getOccupiedRowsInCol(e){return this.colIndex.get(e)}get size(){let e=0;for(const t of this.rowIndex.values())e+=t.size;return e}}function Jm(u,e,t,i,s){const n=t==="left"||t==="right",r=t==="down"||t==="right",o=n?e.c:e.r,l=n?i[0].c:i[0].r,c=n?i[1].c:i[1].r,a=n?u.getOccupiedColsInRow(e.r):u.getOccupiedRowsInCol(e.c);let h;if(a&&s){const y=new Set;for(const g of a){const m=n?e.r:g,S=n?g:e.c;s(m,S)&&y.add(g)}h=y.size>0?y:void 0}else h=a;if(!h||h.size===0)return Ff(e,t,i);const f=Array.from(h).sort((y,g)=>y-g);r||f.reverse();const d=r?f.filter(y=>y>o):f.filter(y=>y<o),p=h.has(o),v=r?o+1:o-1,x=Sr(n?{r:e.r,c:v}:{r:v,c:e.c},i)&&h.has(v);if(p&&x){let y=o,g=v;for(;(r?g<=c:g>=l)&&h.has(g);)y=g,g=r?g+1:g-1;return n?{r:e.r,c:y}:{r:y,c:e.c}}if(d.length>0){const y=d[0];return n?{r:e.r,c:y}:{r:y,c:e.c}}return Ff(e,t,i)}function Ff(u,e,t){switch(e){case"up":return{r:t[0].r,c:u.c};case"down":return{r:t[1].r,c:u.c};case"left":return{r:u.r,c:t[0].c};case"right":return{r:u.r,c:t[1].c}}}async function gr(u,e,t){const[i,s]=Zm(e,t);for(const n of i){const r=be(n);if(!await u.hasFormula(r))continue;const o=await u.getCell(r);if(s.has(n)){await u.setCell(r,{v:"#REF!",f:o.f,s:o.s});continue}const l=ep(o.f),c=await u.fetchGridByReferences(l),a=await qm(o.f,c);await u.setCell(r,{v:a,f:o.f,s:o.s})}}function Zm(u,e){const t=[],i=new Set,s=new Set,n=new Set,r=o=>{if(n.has(o))for(const l of n)i.add(l);if(n.add(o),!s.has(o)){if(s.add(o),u.has(o))for(const l of u.get(o))r(l);t.push(o)}n.delete(o)};for(const o of e)r(o);return[t.reverse(),i]}function eg(u){let e=1/0,t=1/0,i=0,s=0;for(const[r]of u.entries()){const{r:o,c:l}=be(r);e=Math.min(e,o),t=Math.min(t,l),i=Math.max(i,o),s=Math.max(s,l)}const n=Array.from({length:i-e+1},()=>Array(s-t+1).fill(""));for(const[r,o]of u.entries()){const{r:l,c}=be(r);n[l-e][c-t]=o.v||o.f||""}return n.map(r=>r.join("	")).join(`
`)}function tg(u,e){let t=u.r,i=u.c;const s=new Map,n=e.split(`
`);for(const r of n){const o=r.split("	");for(const l of o)s.set(xe({r:t,c:i}),{v:l}),i+=1;t+=1,i=u.c}return s}function Pf(u){const e=u.match(/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/);if(!e)return;const t=parseInt(e[1],10),i=parseInt(e[2],10),s=parseInt(e[3],10);if(!(t===255&&i===255&&s===255))return"#"+t.toString(16).padStart(2,"0")+i.toString(16).padStart(2,"0")+s.toString(16).padStart(2,"0")}function rg(u){return u.includes("google-sheets-html-origin")||u.includes("data-sheets-value")||u.includes("urn:schemas-microsoft-com:office:excel")||u.includes('xmlns:x="urn:schemas-microsoft-com:office:excel"')}function ng(u,e){const s=new DOMParser().parseFromString(u,"text/html").querySelector("table");if(!s)return new Map;const n=new Map,r=s.querySelectorAll("tr");for(let o=0;o<r.length;o++){const l=r[o].querySelectorAll("td, th");for(let c=0;c<l.length;c++){const a=l[c],h=a.textContent||"";if(!h&&!a.style.cssText)continue;const f={v:h},d={};let p=!1;const v=a.style.fontWeight;if((v==="bold"||v==="700")&&(d.b=!0,p=!0),a.style.fontStyle==="italic"&&(d.i=!0,p=!0),a.style.backgroundColor){const x=Pf(a.style.backgroundColor);x&&(d.bg=x,p=!0)}if(a.style.color){const x=Pf(a.style.color);x&&(d.tc=x,p=!0)}if(a.style.textAlign){const x=a.style.textAlign;(x==="left"||x==="center"||x==="right")&&(d.al=x,p=!0)}p&&(f.s=d),n.set(xe({r:e.r+o,c:e.c+c}),f)}}return n}const sa="en-US",Df="USD",ig=new Set(["AT","BE","CY","DE","EE","ES","FI","FR","GR","HR","IE","IT","LT","LU","LV","MT","NL","PT","SI","SK"]),og={AE:"AED",AR:"ARS",AU:"AUD",BD:"BDT",BR:"BRL",CA:"CAD",CH:"CHF",CL:"CLP",CN:"CNY",CO:"COP",CZ:"CZK",DK:"DKK",EG:"EGP",GB:"GBP",HK:"HKD",HU:"HUF",ID:"IDR",IL:"ILS",IN:"INR",JP:"JPY",KE:"KES",KR:"KRW",KW:"KWD",MX:"MXN",MY:"MYR",NG:"NGN",NO:"NOK",NZ:"NZD",PE:"PEN",PH:"PHP",PK:"PKR",PL:"PLN",QA:"QAR",RO:"RON",RU:"RUB",SA:"SAR",SE:"SEK",SG:"SGD",TH:"THB",TR:"TRY",TW:"TWD",UA:"UAH",US:"USD",VN:"VND",ZA:"ZAR"},If=new Map;function la(u){return u&&u.trim()?u.trim():typeof navigator<"u"&&navigator.language?navigator.language:Intl.DateTimeFormat().resolvedOptions().locale||sa}function sg(u){const[e]=u.replace(/_/g,"-").split("-u-"),t=e.split("-").filter(Boolean);for(let i=1;i<t.length;i++){const s=t[i];if(/^[a-z]{2}$/i.test(s))return s.toUpperCase()}try{const i=new Intl.Locale(u).maximize().region;if(i)return i.toUpperCase()}catch{}}function xl(u,e,t){try{return new Intl.NumberFormat(e,t).format(u)}catch{return new Intl.NumberFormat(sa,t).format(u)}}function lg(u,e){try{return new Intl.DateTimeFormat(e,{dateStyle:"medium"}).format(u)}catch{return new Intl.DateTimeFormat(sa,{year:"numeric",month:"short",day:"numeric"}).format(u)}}function ag(){return la()}function np(u){const e=la(u),t=If.get(e);if(t)return t;const i=sg(e);let s=Df;return i&&(s=ig.has(i)?"EUR":og[i]??Df),If.set(e,s),s}function Bv(u){const e=la(u),t=np(e);return{locale:e,currency:t,number:xl(1234.56,e,{minimumFractionDigits:2,maximumFractionDigits:2}),currencyValue:xl(1234.56,e,{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}),percent:xl(.1234,e,{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),date:lg(new Date(2026,1,18),e)}}function Qi(u,e,t){try{return u.toLocaleString(e,t)}catch{return u.toLocaleString("en-US",t)}}function ug(u){const e=u.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(e){const i=Number(e[1]),s=Number(e[2]),n=Number(e[3]),r=new Date(i,s-1,n);return r.getFullYear()===i&&r.getMonth()===s-1&&r.getDate()===n?r:void 0}const t=new Date(u);if(!isNaN(t.getTime()))return t}function cg(u,e){const t=ug(u);if(!t)return u;try{return new Intl.DateTimeFormat(e,{dateStyle:"medium"}).format(t)}catch{return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t)}}function Nl(u,e,t,i){if(!e||e==="plain"||u==="")return u;const s=t??2,n=(i==null?void 0:i.locale)??ag(),r=(i==null?void 0:i.currency)??np(n);switch(e){case"number":{const o=Number(u);return isNaN(o)?u:Qi(o,n,{minimumFractionDigits:s,maximumFractionDigits:s})}case"currency":{const o=Number(u);return isNaN(o)?u:t===void 0?Qi(o,n,{style:"currency",currency:r}):Qi(o,n,{style:"currency",currency:r,minimumFractionDigits:s,maximumFractionDigits:s})}case"percent":{const o=Number(u);return isNaN(o)?u:Qi(o,n,{style:"percent",minimumFractionDigits:s,maximumFractionDigits:s})}case"date":return cg(u,n);default:return u}}const hg={$:"USD","":"KRW"};function Lf(u){return u.length>1&&u.startsWith("0")}function fg(u){if(!u.includes(","))return/^\d+$/.test(u)?u:void 0;const e=u.split(",");if(/^\d{1,3}$/.test(e[0])){for(let t=1;t<e.length;t++)if(!/^\d{3}$/.test(e[t]))return;return e.join("")}}function aa(u,e){if(u.length===0||/\s/.test(u))return;if(e.allowExponent&&/[eE]/.test(u)){const i=u.match(/^([+-])?(\d+(?:\.\d+)?|\.\d+)[eE]([+-]?\d+)$/);if(!i)return;const s=i[1]??"",n=i[2],r=i[3],o=n.startsWith(".")?"0":n.split(".")[0];if(!e.allowPaddedInteger&&Lf(o))return;const l=+`${s}${n}e${r}`;return Number.isFinite(l)?l:void 0}const t=u.match(/^([+-])?(\d[\d,]*)(?:\.(\d*))?$/);if(t){const i=t[1]??"",s=t[2],n=t[3],r=fg(s);if(!r||!e.allowPaddedInteger&&Lf(r))return;const o=n!==void 0?`${i}${r}.${n}`:`${i}${r}`,l=Number(o);return Number.isFinite(l)?l:void 0}if(e.allowLeadingDot){const i=u.match(/^([+-])?\.(\d+)$/);if(!i)return;const s=i[1]??"",n=i[2],r=+`${s}0.${n}`;return Number.isFinite(r)?r:void 0}}function ip(u,e,t){const i=new Date(u,e-1,t);if(!(i.getFullYear()!==u||i.getMonth()!==e-1||i.getDate()!==t))return`${String(u).padStart(4,"0")}-${String(e).padStart(2,"0")}-${String(t).padStart(2,"0")}`}function dg(u){const e=u.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!e)return;const t=Number(e[1]),i=Number(e[2]),s=Number(e[3]);return ip(t,i,s)}function pg(u,e){const t=u.match(/^(\d{1,2})\/(\d{1,2})$/);if(!t)return;const i=Number(t[1]),s=Number(t[2]);return ip(e,i,s)}function xg(u){const e=u.match(/^([+-])?\s*([$])\s*([0-9][0-9,]*(?:\.[0-9]+)?|\.\d+)$/);if(!e)return;const t=e[1]??"",i=e[2],s=e[3],n=aa(`${t}${s}`,{allowExponent:!1,allowLeadingDot:!0,allowPaddedInteger:!0});if(n!==void 0)return{code:hg[i],value:n}}function mg(u){const e=u.match(/^([+-])?\s*([0-9][0-9,]*(?:\.[0-9]+)?|\.\d+)\s*%$/);if(!e)return;const t=e[1]??"",i=e[2],s=aa(`${t}${i}`,{allowExponent:!1,allowLeadingDot:!0,allowPaddedInteger:!0});if(s!==void 0)return s/100}function Bf(u,e){const t=u.trim();if(t.startsWith("="))return{type:"formula",value:t.slice(1).trimStart()};const i=t.toLowerCase();if(i==="true")return{type:"boolean",value:!0};if(i==="false")return{type:"boolean",value:!1};const s=xg(t);if(s)return{type:"number",value:s.value,format:`currency:${s.code}`};const n=mg(t);if(n!==void 0)return{type:"number",value:n,format:"percent"};const r=dg(t);if(r)return{type:"date",value:r,format:"yyyy-mm-dd"};const o=new Date().getFullYear(),l=pg(t,o);if(l)return{type:"date",value:l,format:"yyyy-mm-dd"};const c=aa(t,{allowExponent:!0,allowLeadingDot:!0,allowPaddedInteger:!1});return c!==void 0?{type:"number",value:c}:{type:"text",value:t}}const gg={rows:1e6,columns:18278},yg=5e4,vg={b:!1,i:!1,u:!1,st:!1,bt:!1,br:!1,bb:!1,bl:!1,al:"left",va:"top",nf:"plain",dp:2};class Sg{constructor(e){k(this,"store");k(this,"dimension");k(this,"activeCell");k(this,"range");k(this,"selectionType","cell");k(this,"rowDimensions");k(this,"colDimensions");k(this,"frozenRows",0);k(this,"frozenCols",0);k(this,"colStyles",new Map);k(this,"rowStyles",new Map);k(this,"sheetStyle");k(this,"merges",new Map);k(this,"mergeCoverMap",new Map);k(this,"filterRange");k(this,"filterColumns",new Map);k(this,"hiddenRows",new Set);k(this,"copyBuffer");k(this,"gridResolver");this.store=e,this.dimension={...gg},this.activeCell={r:1,c:1}}get dimensionRange(){return[{r:1,c:1},{r:this.dimension.rows,c:this.dimension.columns}]}getDimension(){return this.dimension}setDimensions(e,t){this.rowDimensions=e,this.colDimensions=t}getRowDimensions(){return this.rowDimensions}getColDimensions(){return this.colDimensions}setRowHeight(e,t){var i;(i=this.rowDimensions)==null||i.setSize(e,t),this.store.setDimensionSize("row",e,t)}setColumnWidth(e,t){var i;(i=this.colDimensions)==null||i.setSize(e,t),this.store.setDimensionSize("column",e,t)}async loadDimensions(){if(this.rowDimensions){this.rowDimensions.clear();const e=await this.store.getDimensionSizes("row");for(const[t,i]of e)this.rowDimensions.setSize(t,i)}if(this.colDimensions){this.colDimensions.clear();const e=await this.store.getDimensionSizes("column");for(const[t,i]of e)this.colDimensions.setSize(t,i)}}getFreezePane(){return{frozenRows:this.frozenRows,frozenCols:this.frozenCols}}async setFreezePane(e,t){this.frozenRows=e,this.frozenCols=t,await this.store.setFreezePane(e,t)}async loadFreezePane(){const{frozenRows:e,frozenCols:t}=await this.store.getFreezePane();this.frozenRows=e,this.frozenCols=t}async loadStyles(){this.colStyles=await this.store.getColumnStyles(),this.rowStyles=await this.store.getRowStyles(),this.sheetStyle=await this.store.getSheetStyle()}async loadMerges(){this.merges=await this.store.getMerges(),this.rebuildMergeCoverMap()}async loadFilterState(){const e=await this.store.getFilterState();if(!e){this.filterRange=void 0,this.filterColumns.clear(),this.hiddenRows.clear();return}this.filterRange=st(e.range[0],e.range[1]),this.filterColumns=new Map;for(const[t,i]of Object.entries(e.columns)){const s=Number(t);Number.isFinite(s)&&this.filterColumns.set(s,{...i})}this.normalizeFilterColumnsToRange(),this.hiddenRows=new Set(e.hiddenRows.filter(t=>t>0)),this.pruneHiddenRowsOutsideFilter(),this.ensureActiveCellVisibleAfterFiltering()}hasFilter(){return!!this.filterRange}getFilterRange(){return this.filterRange?mr(this.filterRange):void 0}getHiddenRows(){return new Set(this.hiddenRows)}getFilteredColumns(){return new Set(this.filterColumns.keys())}getColumnFilterCondition(e){const t=this.filterColumns.get(e);if(t)return{...t,values:t.values?[...t.values]:void 0}}isColumnInFilter(e){return this.filterRange?e>=this.filterRange[0].c&&e<=this.filterRange[1].c:!1}getFilterState(){return this.buildFilterStatePayload()}getColStyles(){return this.colStyles}getRowStyles(){return this.rowStyles}getSheetStyle(){return this.sheetStyle}getMerges(){return this.merges}rebuildMergeCoverMap(){this.mergeCoverMap.clear();for(const[e,t]of this.merges){const i=be(e);for(let s=i.r;s<i.r+t.rs;s++)for(let n=i.c;n<i.c+t.cs;n++){const r=xe({r:s,c:n});r!==e&&this.mergeCoverMap.set(r,e)}}}getAnchorSrefForRef(e){const t=xe(e);return this.merges.has(t)?t:this.mergeCoverMap.get(t)||t}normalizeRefToAnchor(e){return be(this.getAnchorSrefForRef(e))}getMergeForRef(e){const t=this.getAnchorSrefForRef(e),i=this.merges.get(t);if(!i)return;const s=be(t);return{anchorSref:t,anchor:s,span:i,range:Oi(s,i)}}expandRangeToMergedBoundaries(e){let t=mr(e),i=!0;for(;i;){i=!1;for(const[s,n]of this.merges){const r=Oi(be(s),n);if(!Sr(r[0],t)&&!Sr(r[1],t)&&!(r[0].r<=t[1].r&&r[1].r>=t[0].r&&r[0].c<=t[1].c&&r[1].c>=t[0].c))continue;const o=pl(t,r);lo(o,t)||(t=o,i=!0)}}return t}*mergeCoveredSrefs(e,t){for(let i=e.r;i<e.r+t.rs;i++)for(let s=e.c;s<e.c+t.cs;s++)yield xe({r:i,c:s})}expandChangedSrefsWithMergeAliases(e){const t=new Set;for(const i of e){const s=this.getAnchorSrefForRef(be(i)),n=this.merges.get(s);if(!n){t.add(i);continue}const r=be(s);for(const o of this.mergeCoveredSrefs(r,n))t.add(o)}return t}getMergesIntersecting(e){const t=[];for(const[i,s]of this.merges){const n=be(i),r=Oi(n,s);r[0].r<=e[1].r&&r[1].r>=e[0].r&&r[0].c<=e[1].c&&r[1].c>=e[0].c&&t.push({anchorSref:i,anchor:n,span:s,range:r})}return t}resolveEffectiveStyle(e,t,i){const s=this.sheetStyle,n=this.colStyles.get(t),r=this.rowStyles.get(e);if(!(!s&&!n&&!r&&!i))return{...s,...n,...r,...i}}async getCell(e){return this.store.get(this.normalizeRefToAnchor(e))}async setCell(e,t){await this.store.set(this.normalizeRefToAnchor(e),t)}async setGrid(e){await this.store.setGrid(e)}async hasFormula(e){const t=await this.getCell(e);return!!(t&&t.f)}async toInputString(e){const t=await this.getCell(e);return t?t.f?t.f:t.v||"":""}async toDisplayString(e){const t=this.normalizeRefToAnchor(e),i=await this.store.get(t);if(!i||!i.v)return"";const s=this.resolveEffectiveStyle(t.r,t.c,i.s);return Nl(i.v,s==null?void 0:s.nf,s==null?void 0:s.dp,{currency:s==null?void 0:s.cu})}toStoredValue(e){switch(e.type){case"number":return e.value.toString();case"date":case"text":return e.value;case"boolean":return e.value?"TRUE":"FALSE"}}applyInferredFormat(e,t){var i;if(t.type==="date"){const s={...e||{},nf:"date"};return delete s.cu,s}if(t.type==="number"&&t.format==="percent"){const s={...e||{},nf:"percent"};return delete s.cu,s}return t.type==="number"&&((i=t.format)!=null&&i.startsWith("currency:"))?{...e||{},nf:"currency",cu:t.format.slice(9)}:e?{...e}:void 0}applyInputInferenceToGrid(e){const t=new Map;for(const[i,s]of e){if(s.f){t.set(i,{...s});continue}const n=Bf(s.v??""),r=this.applyInferredFormat(s.s,n),o=n.type==="formula"?{f:`=${n.value}`}:{v:this.toStoredValue(n)};t.set(i,this.compactCell(o,r))}return t}async setData(e,t){const i=this.normalizeRefToAnchor(e);this.store.beginBatch();try{const s=await this.store.get(i),n=Bf(t),r=this.applyInferredFormat(s==null?void 0:s.s,n),o=n.type==="formula"?{f:`=${n.value}`}:{v:this.toStoredValue(n)},l=this.compactCell(o,r);this.isEmptyCell(l)?await this.store.delete(i):await this.store.set(i,l);const c=this.expandChangedSrefsWithMergeAliases([xe(i)]),a=await this.store.buildDependantsMap(c);await gr(this,a,c),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}async removeData(){this.store.beginBatch();try{const e=this.getRangeOrActiveCell(),t=await this.store.getGrid(e),i=new Set;for(const[r,o]of t){const l=be(r);o.s&&Object.keys(o.s).length>0?await this.store.set(l,{s:o.s}):await this.store.delete(l),i.add(r)}if(i.size===0)return!1;const s=this.expandChangedSrefsWithMergeAliases(i),n=await this.store.buildDependantsMap(s);return await gr(this,n,s),this.filterRange&&await this.recomputeFilterHiddenRows(),!0}finally{this.store.endBatch()}}async insertRows(e,t=1){await this.shiftCells("row",e,t)}async deleteRows(e,t=1){await this.shiftCells("row",e,-t)}async insertColumns(e,t=1){await this.shiftCells("column",e,t)}async deleteColumns(e,t=1){await this.shiftCells("column",e,-t)}async moveRows(e,t,i){await this.moveCells("row",e,t,i)}async moveColumns(e,t,i){await this.moveCells("column",e,t,i)}async shiftCells(e,t,i){var n,r;await this.store.shiftCells(e,t,i),e==="row"?((n=this.rowDimensions)==null||n.shift(t,i),this.rowStyles=_r(this.rowStyles,t,i)):((r=this.colDimensions)==null||r.shift(t,i),this.colStyles=_r(this.colStyles,t,i)),this.merges=tp(this.merges,e,t,i),this.rebuildMergeCoverMap(),this.shiftFilterState(e,t,i);const s=e==="row"?this.activeCell.r:this.activeCell.c;if(i>0&&s>=t)e==="row"?this.activeCell={r:this.activeCell.r+i,c:this.activeCell.c}:this.activeCell={r:this.activeCell.r,c:this.activeCell.c+i};else if(i<0){const o=Math.abs(i);s>=t&&s<t+o?e==="row"?this.activeCell={r:Math.max(1,t),c:this.activeCell.c}:this.activeCell={r:this.activeCell.r,c:Math.max(1,t)}:s>=t+o&&(e==="row"?this.activeCell={r:this.activeCell.r+i,c:this.activeCell.c}:this.activeCell={r:this.activeCell.r,c:this.activeCell.c+i})}this.activeCell=this.normalizeRefToAnchor(this.activeCell),this.store.beginBatch();try{const o=e==="row"?this.frozenRows:this.frozenCols;if(o>0){if(i>0&&t<=o){const l=o+i;e==="row"?this.frozenRows=l:this.frozenCols=l,await this.store.setFreezePane(this.frozenRows,this.frozenCols)}else if(i<0){const l=Math.abs(i);if(t<=o){const c=Math.min(l,o-t+1),a=Math.max(0,o-c);e==="row"?this.frozenRows=a:this.frozenCols=a,await this.store.setFreezePane(this.frozenRows,this.frozenCols)}}}await this.recalculateAllFormulaCells(),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}async moveCells(e,t,i,s,n){var r,o;if(!(s>=t&&s<=t+i)){for(const[l,c]of this.merges){const a=be(l);if(Km(a,c,e,t,i))return}if(await this.store.moveCells(e,t,i,s),e==="row"?((r=this.rowDimensions)==null||r.move(t,i,s),this.rowStyles=Er(this.rowStyles,t,i,s)):((o=this.colDimensions)==null||o.move(t,i,s),this.colStyles=Er(this.colStyles,t,i,s)),this.merges=rp(this.merges,e,t,i,s),this.rebuildMergeCoverMap(),this.moveFilterState(e,t,i,s),this.activeCell=this.normalizeRefToAnchor(qn(this.activeCell,e,t,i,s)),this.range&&(this.range=this.expandRangeToMergedBoundaries([qn(this.range[0],e,t,i,s),qn(this.range[1],e,t,i,s)])),!(n!=null&&n.skipPostRecalculate)){this.store.beginBatch();try{await this.recalculateAllFormulaCells(),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}}}async recalculateAllFormulaCells(){const e=new Set,t=[{r:1,c:1},{r:1e3,c:100}],i=await this.store.getGrid(t);for(const[s,n]of i)n.f&&e.add(s);if(e.size>0){const s=await this.store.buildDependantsMap(e);await gr(this,s,e)}}buildFilterStatePayload(){if(!this.filterRange)return;const e={},t=Array.from(this.filterColumns.entries()).sort((i,s)=>i[0]-s[0]);for(const[i,s]of t)this.isColumnInFilter(i)&&(e[String(i)]={...s});return{range:mr(this.filterRange),columns:e,hiddenRows:Array.from(this.hiddenRows).sort((i,s)=>i-s)}}normalizeFilterColumnsToRange(){if(!this.filterRange){this.filterColumns.clear();return}for(const e of this.filterColumns.keys())this.isColumnInFilter(e)||this.filterColumns.delete(e)}pruneHiddenRowsOutsideFilter(){if(!this.filterRange){this.hiddenRows.clear();return}const e=this.filterRange[0].r+1,t=this.filterRange[1].r,i=new Set;for(const s of this.hiddenRows)s>=e&&s<=t&&i.add(s);this.hiddenRows=i}normalizeFilterText(e){if(typeof e=="string")return e;if(e==null)return"";if(typeof e=="number"||typeof e=="boolean")return String(e);if(typeof e=="object"){const t=e;if(t.value!==void 0&&t.value!==e)return this.normalizeFilterText(t.value);if(typeof t.toJSON=="function")try{const i=t.toJSON.call(e);if(i!==e)return this.normalizeFilterText(i)}catch{}}return String(e)}normalizeFilterCondition(e){const t=e.op;if(t==="in"){const s=Array.from(new Set((e.values||[]).map(n=>this.normalizeFilterText(n).trim())));return{op:t,values:s}}if(t==="isEmpty"||t==="isNotEmpty")return{op:t};const i=this.normalizeFilterText(e.value).trim();if(i.length!==0)return{op:t,value:i}}matchesFilterCondition(e,t){const i=this.normalizeFilterText(e).trim(),s=i.toLowerCase(),n=this.normalizeFilterText(t.value).trim().toLowerCase();switch(t.op){case"in":return new Set((t.values||[]).map(r=>this.normalizeFilterText(r).trim())).has(i);case"contains":return s.includes(n);case"notContains":return!s.includes(n);case"equals":return s===n;case"notEquals":return s!==n;case"isEmpty":return s.length===0;case"isNotEmpty":return s.length>0;default:return!0}}async rowMatchesFilters(e,t){for(const[i,s]of this.filterColumns){if(i===t)continue;const n=await this.getCell({r:e,c:i}),r=this.normalizeFilterText(n==null?void 0:n.v);if(!this.matchesFilterCondition(r,s))return!1}return!0}async recomputeFilterHiddenRows(){if(!this.filterRange){this.hiddenRows.clear(),await this.store.setFilterState(void 0);return}if(this.filterRange=st({r:Math.max(1,this.filterRange[0].r),c:Math.max(1,this.filterRange[0].c)},{r:Math.min(this.dimension.rows,this.filterRange[1].r),c:Math.min(this.dimension.columns,this.filterRange[1].c)}),this.filterRange[1].r<=this.filterRange[0].r){this.filterRange=void 0,this.filterColumns.clear(),this.hiddenRows.clear(),await this.store.setFilterState(void 0);return}this.normalizeFilterColumnsToRange();const e=new Set,t=this.filterRange[0].r+1,i=this.filterRange[1].r;if(this.filterColumns.size>0)for(let s=t;s<=i;s++)await this.rowMatchesFilters(s)||e.add(s);this.hiddenRows=e,this.ensureActiveCellVisibleAfterFiltering(),await this.store.setFilterState(this.buildFilterStatePayload())}shiftFilterBoundary(e,t,i){if(i>0)return e>=t?e+i:e;const s=Math.abs(i);return e>=t&&e<t+s?t:e>=t+s?e+i:e}shiftFilterState(e,t,i){if(!this.filterRange)return;if(e==="row"){const o=this.shiftFilterBoundary(this.filterRange[0].r,t,i),l=this.shiftFilterBoundary(this.filterRange[1].r,t,i);this.filterRange=st({r:Math.max(1,o),c:this.filterRange[0].c},{r:Math.max(1,l),c:this.filterRange[1].c});const c=new Map;for(const h of this.hiddenRows)c.set(h,1);const a=_r(c,t,i);this.hiddenRows=new Set(a.keys()),this.pruneHiddenRowsOutsideFilter();return}const s=this.shiftFilterBoundary(this.filterRange[0].c,t,i),n=this.shiftFilterBoundary(this.filterRange[1].c,t,i);this.filterRange=st({r:this.filterRange[0].r,c:Math.max(1,s)},{r:this.filterRange[1].r,c:Math.max(1,n)});const r=new Map;for(const[o,l]of this.filterColumns)r.set(o,l);this.filterColumns=_r(r,t,i),this.normalizeFilterColumnsToRange()}moveFilterState(e,t,i,s){if(!this.filterRange)return;if(e==="row"){const l=lt(this.filterRange[0].r,t,i,s),c=lt(this.filterRange[1].r,t,i,s);this.filterRange=st({r:l,c:this.filterRange[0].c},{r:c,c:this.filterRange[1].c});const a=new Map;for(const f of this.hiddenRows)a.set(f,1);const h=Er(a,t,i,s);this.hiddenRows=new Set(h.keys()),this.pruneHiddenRowsOutsideFilter();return}const n=lt(this.filterRange[0].c,t,i,s),r=lt(this.filterRange[1].c,t,i,s);this.filterRange=st({r:this.filterRange[0].r,c:n},{r:this.filterRange[1].r,c:r});const o=new Map;for(const[l,c]of this.filterColumns)o.set(l,c);this.filterColumns=Er(o,t,i,s),this.normalizeFilterColumnsToRange()}ensureActiveCellVisibleAfterFiltering(){if(!this.hiddenRows.has(this.activeCell.r))return;let e;if(this.filterRange&&this.activeCell.r>this.filterRange[0].r&&this.activeCell.r<=this.filterRange[1].r)e=this.filterRange[0].r;else{for(let t=this.activeCell.r+1;t<=this.dimension.rows;t++)if(!this.hiddenRows.has(t)){e=t;break}if(e===void 0){for(let t=this.activeCell.r-1;t>=1;t--)if(!this.hiddenRows.has(t)){e=t;break}}}e!==void 0&&(this.range=void 0,this.setActiveCell({r:e,c:this.activeCell.c}))}findNextVisibleRow(e,t){const i=t==="down"?1:-1;let s=e;for(;s>=1&&s<=this.dimension.rows;){if(!this.hiddenRows.has(s))return s;s+=i}}async fetchGrid(e){return this.store.getGrid(e)}isEmptyCell(e){const t=e.v!==void 0&&e.v!==""&&e.v!==null,i=!!e.f,s=e.s!==void 0&&Object.keys(e.s).length>0;return!t&&!i&&!s}isDefaultStyleValue(e,t){return vg[e]===t}compactCell(e,t){const i={};return e.v!==void 0&&(i.v=e.v),e.f!==void 0&&(i.f=e.f),t&&Object.keys(t).length>0&&(i.s=t),i}getCopyRange(){var e;return(e=this.copyBuffer)==null?void 0:e.sourceRange}clearCopyBuffer(){this.copyBuffer=void 0}async copy(){const e=this.getRangeOrActiveCell(),t=await this.fetchGrid(e),i=eg(t);return this.copyBuffer={sourceRange:e,grid:t,text:i},{text:i}}async paste(e){const{text:t,html:i}=e;let s,n=!1;if(this.copyBuffer&&t===this.copyBuffer.text)s=this.relocateGrid(this.copyBuffer.grid,this.copyBuffer.sourceRange,this.activeCell);else if(i&&rg(i))s=ng(i,this.activeCell),n=!0;else if(t)s=tg(this.activeCell,t),n=!0;else return;n&&(s=this.applyInputInferenceToGrid(s)),this.store.beginBatch();try{await this.setGrid(s);const r=new Set;for(const[o]of s)r.add(o);if(r.size>0){const o=this.expandChangedSrefsWithMergeAliases(r),l=await this.store.buildDependantsMap(o);await gr(this,l,o)}this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}this.selectPastedRange(s)}selectPastedRange(e){if(e.size===0)return;let t=1/0,i=-1/0,s=1/0,n=-1/0;for(const r of e.keys()){const o=be(r);o.r<t&&(t=o.r),o.r>i&&(i=o.r),o.c<s&&(s=o.c),o.c>n&&(n=o.c)}t===i&&s===n?this.selectStart({r:t,c:s}):(this.selectionType="cell",this.activeCell={r:t,c:s},this.range=[{r:t,c:s},{r:i,c:n}],this.store.updateActiveCell(this.activeCell))}relocateGrid(e,t,i){const s=i.r-t[0].r,n=i.c-t[0].c,r=new Map;for(const[o,l]of e){const c=be(o),a={r:c.r+s,c:c.c+n},h=xe(a);if(l.f){const f=Rf(l.f,s,n);r.set(h,{f,s:l.s})}else r.set(h,{...l})}return r}computeAutofillRange(e,t){if(!Sr(t,e))return pl(e,[t,t])}getAutofillPreviewRange(e){if(this.selectionType!=="cell")return;const t=this.getRangeOrActiveCell();return this.computeAutofillRange(t,e)}positiveMod(e,t){return(e%t+t)%t}cloneCellForAutofill(e,t,i){if(e.f){const n=Rf(e.f,t,i);return e.s?{f:n,s:{...e.s}}:{f:n}}const s={};return e.v!==void 0&&(s.v=e.v),e.s&&(s.s={...e.s}),s}async autofill(e){if(this.selectionType!=="cell")return!1;const t=mr(this.getRangeOrActiveCell()),i=this.computeAutofillRange(t,e);if(!i||this.getMergesIntersecting(i).length>0)return!1;const s=await this.store.getGrid(t),n=t[1].r-t[0].r+1,r=t[1].c-t[0].c+1,o=new Set;this.store.beginBatch();try{for(let l=i[0].r;l<=i[1].r;l++)for(let c=i[0].c;c<=i[1].c;c++){const a={r:l,c};if(Sr(a,t))continue;const h={r:t[0].r+this.positiveMod(a.r-t[0].r,n),c:t[0].c+this.positiveMod(a.c-t[0].c,r)},f=s.get(xe(h)),d=this.normalizeRefToAnchor(a),p=xe(d);if(!f){await this.store.delete(d),o.add(p);continue}const v=a.r-h.r,x=a.c-h.c,y=this.cloneCellForAutofill(f,v,x);this.isEmptyCell(y)?await this.store.delete(d):await this.store.set(d,y),o.add(p)}if(o.size>0){const l=this.expandChangedSrefsWithMergeAliases(o),c=await this.store.buildDependantsMap(l);await gr(this,c,l)}this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return o.size===0?!1:(this.selectionType="cell",this.range=i,!0)}async hasContents(e){return(await this.store.getGrid(e)).size>0}async fetchGridByReferences(e){const t=new Map,i=new Map;for(const s of Fr(e))if(bo(s)){const{sheetName:n,localRef:r}=Yd(s);i.has(n.toUpperCase())||i.set(n.toUpperCase(),new Set),i.get(n.toUpperCase()).add(r)}else{const n=this.normalizeRefToAnchor(be(s)),r=await this.store.get(n);r&&t.set(s,r)}if(this.gridResolver&&i.size>0)for(const[s,n]of i){const r=this.gridResolver(s,n);if(r)for(const[o,l]of r)t.set(`${s}!${o}`,l)}return t}setGridResolver(e){this.gridResolver=e}async recalculateCrossSheetFormulas(){const e=await this.store.getFormulaGrid(),t=new Set;for(const[i]of e)t.add(i);if(t.size!==0){this.store.beginBatch();try{const i=await this.store.buildDependantsMap(t);await gr(this,i,t),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}}getActiveCell(){return this.activeCell}setActiveCell(e){const t=this.normalizeRefToAnchor(e);this.activeCell=t,this.store.updateActiveCell(t)}getRange(){return this.range}getPresences(){return this.store.getPresences()}getRangeOrActiveCell(){if(this.range)return this.expandRangeToMergedBoundaries(this.range);const e=this.getMergeForRef(this.activeCell);return e?e.range:[this.activeCell,this.activeCell]}getSelectionType(){return this.selectionType}selectRow(e){this.selectionType="row",this.activeCell={r:e,c:1},this.range=[{r:e,c:1},{r:e,c:this.dimension.columns}],this.store.updateActiveCell(this.activeCell)}selectColumn(e){this.selectionType="column",this.activeCell={r:1,c:e},this.range=[{r:1,c:e},{r:this.dimension.rows,c:e}],this.store.updateActiveCell(this.activeCell)}selectRowRange(e,t){this.selectionType="row";const i=Math.min(e,t),s=Math.max(e,t);this.range=[{r:i,c:1},{r:s,c:this.dimension.columns}]}selectColumnRange(e,t){this.selectionType="column";const i=Math.min(e,t),s=Math.max(e,t);this.range=[{r:1,c:i},{r:this.dimension.rows,c:s}]}selectAllCells(){this.selectionType="all",this.activeCell={r:1,c:1},this.range=mr(this.dimensionRange),this.store.updateActiveCell(this.activeCell)}getSelectedIndices(){return this.selectionType==="cell"||this.selectionType==="all"||!this.range?null:this.selectionType==="row"?{axis:"row",from:this.range[0].r,to:this.range[1].r}:{axis:"column",from:this.range[0].c,to:this.range[1].c}}async createFilterFromSelection(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell();return this.setFilterRange(e)}async setFilterRange(e){const t=st(e[0],e[1]);if(t[1].r<=t[0].r)return!1;this.store.beginBatch();try{this.filterRange=t,this.normalizeFilterColumnsToRange(),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async clearFilter(){this.store.beginBatch();try{this.filterRange=void 0,this.filterColumns.clear(),this.hiddenRows.clear(),await this.store.setFilterState(void 0)}finally{this.store.endBatch()}}async setColumnFilter(e,t){if(!this.filterRange||!this.isColumnInFilter(e))return!1;this.store.beginBatch();try{const i=this.normalizeFilterCondition(t);i?this.filterColumns.set(e,i):this.filterColumns.delete(e),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async filterColumnByValue(e,t){return this.setColumnFilter(e,{op:"equals",value:t})}async clearColumnFilter(e){if(!this.filterRange||!this.isColumnInFilter(e)||!this.filterColumns.has(e))return!1;this.store.beginBatch();try{this.filterColumns.delete(e),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async getFilterColumnValues(e){if(!this.filterRange||!this.isColumnInFilter(e))return;const t=new Set,i=this.filterRange[0].r+1,s=this.filterRange[1].r;for(let o=i;o<=s;o++){if(!await this.rowMatchesFilters(o,e))continue;const l=await this.getCell({r:o,c:e}),c=this.normalizeFilterText(l==null?void 0:l.v);t.add(c.trim())}const n=Array.from(t).sort((o,l)=>o.localeCompare(l,void 0,{sensitivity:"base"})),r=this.filterColumns.get(e);return r?r.op==="in"?{values:n,selected:new Set((r.values||[]).map(o=>this.normalizeFilterText(o).trim()))}:{values:n,selected:new Set(n.filter(o=>this.matchesFilterCondition(o,r)))}:{values:n,selected:new Set(n)}}async setColumnIncludedValues(e,t){if(!this.filterRange||!this.isColumnInFilter(e))return!1;const i=Array.from(new Set(t.map(o=>this.normalizeFilterText(o).trim()))).sort((o,l)=>o.localeCompare(l,void 0,{sensitivity:"base"})),s=await this.getFilterColumnValues(e);if(!s)return!1;const n=new Set(s.values),r=i.filter(o=>n.has(o));this.store.beginBatch();try{r.length===s.values.length?this.filterColumns.delete(e):this.filterColumns.set(e,{op:"in",values:r}),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async sortFilterByColumn(e,t){if(!this.filterRange||!this.isColumnInFilter(e))return!1;const i=this.filterRange[0].r+1,s=this.filterRange[1].r;if(s<=i)return!1;const n=[{r:i,c:1},{r:s,c:this.dimension.columns}];if(this.getMergesIntersecting(n).length>0)return!1;const r=[];for(let a=i;a<=s;a++){const h=await this.getCell({r:a,c:e}),f=this.normalizeFilterText(h==null?void 0:h.v).trim(),d=f.length>0&&Number.isFinite(Number(f))?Number(f):null;r.push({row:a,text:f,lower:f.toLowerCase(),numeric:d})}r.sort((a,h)=>{const f=a.text.length===0,d=h.text.length===0;if(f&&!d)return 1;if(!f&&d)return-1;let p=0;return a.numeric!==null&&h.numeric!==null?p=a.numeric-h.numeric:p=a.lower.localeCompare(h.lower,void 0,{sensitivity:"base"}),p===0&&(p=a.row-h.row),t==="asc"?p:-p});const o=r.map(a=>a.row),l=Array.from({length:s-i+1},(a,h)=>i+h),c=[];for(let a=0;a<o.length;a++){const h=o[a],f=l.indexOf(h);if(f===-1||f===a)continue;const d=i+f,p=i+a;c.push({srcIndex:d,dstIndex:p}),l.splice(f,1),l.splice(a,0,h)}if(c.length===0)return!0;this.store.beginBatch();try{for(const a of c)await this.moveCells("row",a.srcIndex,1,a.dstIndex,{skipPostRecalculate:!0});await this.recalculateAllFormulaCells(),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}selectStart(e){Sr(e,this.dimensionRange)&&(this.selectionType="cell",this.setActiveCell(this.normalizeRefToAnchor(e)),this.range=void 0)}selectEnd(e){if(!Sr(e,this.dimensionRange))return;const t=this.normalizeRefToAnchor(e);if(Mi(this.activeCell,t)){this.range=void 0;return}this.range=this.expandRangeToMergedBoundaries(st(this.activeCell,t))}hasRange(){return!!this.range}async selectAll(){let e=this.getRangeOrActiveCell(),t=mr(e),i=!0;for(;i;){i=!1;for(const s of Lx(t,this.dimensionRange))await this.hasContents(s)&&(t=pl(t,s),i=!0)}if(lo(e,t)){this.range=mr(this.dimensionRange);return}this.range=t}async moveToEdge(e){const t=this.getMergeForRef(this.activeCell),i={...this.activeCell};t&&(e==="right"?i.c=t.range[1].c:e==="down"&&(i.r=t.range[1].r));const s=await this.store.findEdge(i,e,this.dimensionRange);let n=this.normalizeRefToAnchor(s);if((e==="up"||e==="down")&&this.hiddenRows.has(n.r)){const r=this.findNextVisibleRow(n.r,e);if(r===void 0)return!1;n=this.normalizeRefToAnchor({r,c:n.c})}return Mi(this.activeCell,n)?!1:(this.range=void 0,this.setActiveCell(n),!0)}move(e){const t=e==="up"?-1:e==="down"?1:0,i=e==="left"?-1:e==="right"?1:0;let s=this.activeCell.r,n=this.activeCell.c;const r=this.getMergeForRef(this.activeCell);if(r?e==="right"?n=r.range[1].c+1:e==="down"?s=r.range[1].r+1:e==="left"?n-=1:s-=1:(s+=t,n+=i),(e==="up"||e==="down")&&this.hiddenRows.has(s)){const l=this.findNextVisibleRow(s,e);if(l===void 0)return!1;s=l}if(!Sr({r:s,c:n},this.dimensionRange))return!1;const o=this.normalizeRefToAnchor({r:s,c:n});return Mi(this.activeCell,o)?!1:(this.range=void 0,this.setActiveCell(o),!0)}resizeRange(e){const t=e==="up"?-1:e==="down"?1:0,i=e==="left"?-1:e==="right"?1:0;let s=mr(this.getRangeOrActiveCell());if(t!==0){const n=t>0?"down":"up",r=o=>this.hiddenRows.has(o)?this.findNextVisibleRow(o,n):o;if(this.activeCell.r===s[1].r){const o=r(s[0].r+t);if(o===void 0)return!1;s[0].r=o}else{const o=r(s[1].r+t);if(o===void 0)return!1;s[1].r=o}}return i!==0&&(this.activeCell.c===s[1].c?s[0].c+=i:s[1].c+=i),s=st(s[0],s[1]),Ix(s,this.dimensionRange)?(this.range=this.expandRangeToMergedBoundaries(s),!0):!1}async getStyle(e){const t=this.normalizeRefToAnchor(e),i=await this.store.get(t);return this.resolveEffectiveStyle(t.r,t.c,i==null?void 0:i.s)}async setStyle(e,t){const i=this.normalizeRefToAnchor(e),s=await this.store.get(i)||{},n={...s.s,...t},r=this.resolveEffectiveStyle(i.r,i.c);for(const l of Object.keys(n))(n[l]===void 0||n[l]==="")&&delete n[l];for(const l of Object.keys(n)){const c=n[l];if(c===(r==null?void 0:r[l])){delete n[l];continue}(r==null?void 0:r[l])===void 0&&this.isDefaultStyleValue(l,c)&&delete n[l]}const o=this.compactCell(s,Object.keys(n).length>0?n:void 0);if(this.isEmptyCell(o)){await this.store.delete(i);return}await this.store.set(i,o)}async setRangeStyle(e){this.store.beginBatch();try{if(this.selectionType==="column"){const i=this.getRangeOrActiveCell();for(let s=i[0].c;s<=i[1].c;s++){const r={...this.colStyles.get(s)||{},...e};for(const o of Object.keys(r))!r[o]&&r[o]!==0&&delete r[o];this.colStyles.set(s,r),await this.store.setColumnStyle(s,r)}return}if(this.selectionType==="row"){const i=this.getRangeOrActiveCell();for(let s=i[0].r;s<=i[1].r;s++){const r={...this.rowStyles.get(s)||{},...e};for(const o of Object.keys(r))!r[o]&&r[o]!==0&&delete r[o];this.rowStyles.set(s,r),await this.store.setRowStyle(s,r)}return}if(this.selectionType==="all"){const s={...this.sheetStyle||{},...e};for(const n of Object.keys(s))!s[n]&&s[n]!==0&&delete s[n];this.sheetStyle=s,await this.store.setSheetStyle(s);return}const t=this.getRangeOrActiveCell();for(let i=t[0].r;i<=t[1].r;i++)for(let s=t[0].c;s<=t[1].c;s++)await this.setStyle({r:i,c:s},e)}finally{this.store.endBatch()}}async setRangeBorders(e){if(this.selectionType!=="cell")return!1;const t=this.getRangeOrActiveCell(),i=t[1].r-t[0].r+1,s=t[1].c-t[0].c+1;if(i*s>yg)return!1;const n=this.collectBorderTargets(t);this.store.beginBatch();try{for(const{anchor:r,range:o}of n){const l=this.toBorderPatchForPreset(e,t,o);await this.setStyle(r,l)}}finally{this.store.endBatch()}return!0}async toggleRangeStyle(e){const t=await this.getStyle(this.activeCell),i=!(t!=null&&t[e]);await this.setRangeStyle({[e]:i})}collectBorderTargets(e){const t=[],i=new Set;for(let s=e[0].r;s<=e[1].r;s++)for(let n=e[0].c;n<=e[1].c;n++){const r=this.normalizeRefToAnchor({r:s,c:n}),o=xe(r);if(i.has(o))continue;i.add(o);const l=this.merges.get(o),c=l?Oi(r,l):st(r,r);t.push({anchor:r,range:c})}return t}toBorderPatchForPreset(e,t,i){const s=i[0].r===t[0].r,n=i[1].r===t[1].r,r=i[0].c===t[0].c,o=i[1].c===t[1].c;switch(e){case"all":return{bt:!0,bl:!0,br:o,bb:n};case"outer":return{bt:s,bl:r,br:o,bb:n};case"inner":return{bt:!s,bl:!r,br:!1,bb:!1};case"top":return{bt:s};case"bottom":return{bb:n};case"left":return{bl:r};case"right":return{br:o};case"clear":default:return{bt:!1,bl:!1,br:!1,bb:!1}}}isSelectionMerged(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell(),t=this.getMergesIntersecting(e);return t.length===1&&lo(t[0].range,e)}canMergeSelection(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell();if(e[0].r===e[1].r&&e[0].c===e[1].c)return!1;const i=this.frozenRows>0&&e[0].r<=this.frozenRows&&e[1].r>this.frozenRows,s=this.frozenCols>0&&e[0].c<=this.frozenCols&&e[1].c>this.frozenCols;return i||s?!1:this.getMergesIntersecting(e).length===0}async toggleMergeSelection(){return this.isSelectionMerged()?this.unmergeSelection():this.mergeSelection()}async mergeSelection(){if(!this.canMergeSelection())return!1;const e=this.getRangeOrActiveCell(),t=e[0],i={rs:e[1].r-e[0].r+1,cs:e[1].c-e[0].c+1},s=new Set;for(const n of this.mergeCoveredSrefs(t,i))s.add(n);this.store.beginBatch();try{for(let o=e[0].r;o<=e[1].r;o++)for(let l=e[0].c;l<=e[1].c;l++){if(o===t.r&&l===t.c)continue;const c={r:o,c:l},a=await this.store.get(c);a&&(a.s&&Object.keys(a.s).length>0?await this.store.set(c,{s:a.s}):await this.store.delete(c))}await this.store.setMerge(t,i),this.merges.set(xe(t),i),this.rebuildMergeCoverMap();const n=this.expandChangedSrefsWithMergeAliases(s),r=await this.store.buildDependantsMap(n);await gr(this,r,n)}finally{this.store.endBatch()}return this.selectionType="cell",this.setActiveCell(t),this.range=Oi(t,i),!0}async unmergeSelection(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell(),t=this.getMergesIntersecting(e);if(t.length===0)return!1;const i=new Set;for(const s of t)for(const n of this.mergeCoveredSrefs(s.anchor,s.span))i.add(n);this.store.beginBatch();try{for(const r of t)await this.store.deleteMerge(r.anchor),this.merges.delete(r.anchorSref);this.rebuildMergeCoverMap();const s=this.expandChangedSrefsWithMergeAliases(i),n=await this.store.buildDependantsMap(s);await gr(this,n,s)}finally{this.store.endBatch()}return this.selectionType="cell",this.range=void 0,!0}async getActiveDecimalPlaces(){const e=await this.getStyle(this.activeCell);return(e==null?void 0:e.dp)??2}async undo(){const e=await this.store.undo();if(e.success&&(await this.loadDimensions(),await this.loadStyles(),await this.loadMerges(),await this.loadFreezePane(),await this.loadFilterState(),e.affectedRange)){const[t,i]=e.affectedRange;this.selectionType="cell",this.activeCell=t,t.r===i.r&&t.c===i.c?this.range=void 0:this.range=e.affectedRange,this.store.updateActiveCell(this.activeCell)}return e.success}async redo(){const e=await this.store.redo();if(e.success&&(await this.loadDimensions(),await this.loadStyles(),await this.loadMerges(),await this.loadFreezePane(),await this.loadFilterState(),e.affectedRange)){const[t,i]=e.affectedRange;this.selectionType="cell",this.activeCell=t,t.r===i.r&&t.c===i.c?this.range=void 0:this.range=e.affectedRange,this.store.updateActiveCell(this.activeCell)}return e.success}moveInRange(e,t){const i=this.range||this.dimensionRange;let s=this.activeCell.r,n=this.activeCell.c;const r=this.getMergeForRef(this.activeCell),o=i[1].r-i[0].r+1,l=i[1].c-i[0].c+1;if(e!==0){const c=e>0?r?r.span.rs:e:e<0?-1:0;s+c>i[1].r?(s=i[0].r,n=(n+1-i[0].c+l)%l+i[0].c):s+c<i[0].r?(s=i[1].r,n=(n-1-i[0].c+l)%l+i[0].c):s+=c}if(t!==0){const c=t>0?r?r.span.cs:t:t<0?-1:0;n+c>i[1].c?(n=i[0].c,s=(s+1-i[0].r+o)%o+i[0].r):n+c<i[0].c?(n=i[1].c,s=(s-1-i[0].r+o)%o+i[0].r):n+=c}this.setActiveCell(this.normalizeRefToAnchor({r:s,c:n}))}}class Ag{constructor(e){k(this,"grid");k(this,"cellIndex",new Qm);k(this,"rowHeights",new Map);k(this,"colWidths",new Map);k(this,"colStyles",new Map);k(this,"rowStyles",new Map);k(this,"sheetStyle");k(this,"merges",new Map);k(this,"filterState");k(this,"frozenRows",0);k(this,"frozenCols",0);this.grid=e||new Map,this.rebuildIndex()}async set(e,t){this.grid.set(xe(e),t),this.cellIndex.add(e.r,e.c)}async get(e){return this.grid.get(xe(e))}async has(e){return this.grid.has(xe(e))}async delete(e){const t=this.grid.delete(xe(e));return t&&this.cellIndex.remove(e.r,e.c),t}async deleteRange(e){const t=new Set,i=[];for(const[s,n]of this.cellIndex.cellsInRange(e)){const r=xe({r:s,c:n});this.grid.delete(r),t.add(r),i.push([s,n])}for(const[s,n]of i)this.cellIndex.remove(s,n);return t}async setGrid(e){for(const[t,i]of e){this.grid.set(t,i);const s=be(t);this.cellIndex.add(s.r,s.c)}}async getGrid(e){const t=new Map;for(const[i,s]of this.cellIndex.cellsInRange(e)){const n=xe({r:i,c:s}),r=this.grid.get(n);r!==void 0&&t.set(n,r)}return t}async findEdge(e,t,i){return Jm(this.cellIndex,e,t,i,(s,n)=>{const r=this.grid.get(xe({r:s,c:n}));return r!==void 0&&(!!r.v||!!r.f)})}async shiftCells(e,t,i){this.grid=Gm(this.grid,e,t,i),this.rebuildIndex(),e==="row"?(this.rowHeights=_r(this.rowHeights,t,i),this.rowStyles=_r(this.rowStyles,t,i)):(this.colWidths=_r(this.colWidths,t,i),this.colStyles=_r(this.colStyles,t,i)),this.merges=tp(this.merges,e,t,i)}async moveCells(e,t,i,s){this.grid=$m(this.grid,e,t,i,s),this.rebuildIndex(),e==="row"?(this.rowHeights=Er(this.rowHeights,t,i,s),this.rowStyles=Er(this.rowStyles,t,i,s)):(this.colWidths=Er(this.colWidths,t,i,s),this.colStyles=Er(this.colStyles,t,i,s)),this.merges=rp(this.merges,e,t,i,s)}async getFormulaGrid(){const e=new Map;for(const[t,i]of this.grid)i.f&&e.set(t,i);return e}async buildDependantsMap(e){const t=Array.from(this.grid.entries()),i=new Map;for(const[s,n]of t)if(n.f)for(const r of Fr(ep(n.f)))bo(r)||(i.has(r)||i.set(r,new Set),i.get(r).add(s));return i}getPresences(){return[]}async setDimensionSize(e,t,i){(e==="row"?this.rowHeights:this.colWidths).set(t,i)}async getDimensionSizes(e){return new Map(e==="row"?this.rowHeights:this.colWidths)}updateActiveCell(e){}async setColumnStyle(e,t){this.colStyles.set(e,t)}async getColumnStyles(){return new Map(this.colStyles)}async setRowStyle(e,t){this.rowStyles.set(e,t)}async getRowStyles(){return new Map(this.rowStyles)}async setSheetStyle(e){this.sheetStyle=e}async getSheetStyle(){return this.sheetStyle?{...this.sheetStyle}:void 0}async setMerge(e,t){this.merges.set(xe(e),{...t})}async deleteMerge(e){return this.merges.delete(xe(e))}async getMerges(){return new Map(this.merges)}async setFilterState(e){if(!e){this.filterState=void 0;return}this.filterState={range:[{...e.range[0]},{...e.range[1]}],columns:Object.fromEntries(Object.entries(e.columns).map(([t,i])=>[t,{...i}])),hiddenRows:[...e.hiddenRows]}}async getFilterState(){if(this.filterState)return{range:[{...this.filterState.range[0]},{...this.filterState.range[1]}],columns:Object.fromEntries(Object.entries(this.filterState.columns).map(([e,t])=>[e,{...t}])),hiddenRows:[...this.filterState.hiddenRows]}}async setFreezePane(e,t){this.frozenRows=e,this.frozenCols=t}async getFreezePane(){return{frozenRows:this.frozenRows,frozenCols:this.frozenCols}}beginBatch(){}endBatch(){}async undo(){return{success:!1}}async redo(){return{success:!1}}canUndo(){return!1}canRedo(){return!1}rebuildIndex(){this.cellIndex.rebuild(Array.from(this.grid.keys()).map(e=>{const t=be(e);return[t.r,t.c]}))}}const Cg={cellBorderColor:"#D3D3D3",customBorderColor:"#000000",cellBGColor:"#FFFFFF",cellTextColor:"#000000",activeCellColor:"#E6C746",selectionBGColor:"rgba(230, 199, 70, 0.1)",headerBGColor:"#F0F0F0",headerActiveBGColor:"#E6C746","tokens.REFERENCE":"#E6C746","tokens.NUM":"#4DA6FF",peerCursor1:"#FF6B6B",peerCursor2:"#4ECDC4",peerCursor3:"#45B7D1",peerCursor4:"#96CEB4",peerCursor5:"#FFEAA7",peerCursor6:"#DDA0DD",peerCursor7:"#98D8C8",peerCursor8:"#F7DC6F",resizeHandleColor:"#1A73E8",headerSelectedBGColor:"rgba(26, 115, 232, 0.3)",dropIndicatorColor:"#1A73E8",freezeLineColor:"#BBBBBB",freezeHandleColor:"#9E9E9E",freezeHandleHoverColor:"#5F6368",formulaRange1:"#1A73E8",formulaRange2:"#E84C3D",formulaRange3:"#9B59B6",formulaRange4:"#27AE60",formulaRange5:"#F39C12",formulaRange6:"#00ACC1"},Eg={cellBorderColor:"#4A4A4A",customBorderColor:"#FFFFFF",cellBGColor:"#1E1E1E",cellTextColor:"#FFFFFF",activeCellColor:"#D4B73E",selectionBGColor:"rgba(212, 183, 62, 0.1)",headerBGColor:"#2D2D2D",headerActiveBGColor:"#D4B73E","tokens.REFERENCE":"#D4B73E","tokens.NUM":"#4DA6FF",peerCursor1:"#FF7979",peerCursor2:"#55EFC4",peerCursor3:"#74B9FF",peerCursor4:"#A4D4C4",peerCursor5:"#FDCB6E",peerCursor6:"#E17055",peerCursor7:"#81ECEC",peerCursor8:"#F8D84F",resizeHandleColor:"#8AB4F8",headerSelectedBGColor:"rgba(138, 180, 248, 0.3)",dropIndicatorColor:"#8AB4F8",freezeLineColor:"#5A5A5A",freezeHandleColor:"#8E8E8E",freezeHandleHoverColor:"#CCCCCC",formulaRange1:"#8AB4F8",formulaRange2:"#FF7979",formulaRange3:"#BB86FC",formulaRange4:"#66BB6A",formulaRange5:"#FFB74D",formulaRange6:"#4DD0E1"};function ve(u,e){return u==="light"?Cg[e]:Eg[e]}const Mf=["formulaRange1","formulaRange2","formulaRange3","formulaRange4","formulaRange5","formulaRange6"];function uo(u,e){return ve(u,Mf[e%Mf.length])}function kf(u,e){const t=["peerCursor1","peerCursor2","peerCursor3","peerCursor4","peerCursor5","peerCursor6","peerCursor7","peerCursor8"];let i=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);i=(i<<5)-i+r,i=i&i}const s=Math.abs(i)%t.length;return ve(u,t[s])}function dr(u){const e=window.getSelection();if(e.rangeCount===0)return;const t=e.getRangeAt(0);if(!u.contains(t.commonAncestorContainer))return;let i=0,s=0,n=0;function r(o){if(o.nodeType===Node.TEXT_NODE){const l=o.textContent;o===t.startContainer&&(s=i+t.startOffset),o===t.endContainer&&(n=i+t.endOffset),i+=l.length}for(const l of o.childNodes)r(l)}return r(u),{start:s,end:n}}function Ar(u,e){let t=0,i=null,s=null;const n=document.createRange();function r(l){if(l.nodeType===Node.TEXT_NODE){const c=l.textContent;i===null&&t+c.length>=e.start&&(i=l,n.setStart(l,e.start-t)),s===null&&t+c.length>=e.end&&(s=l,n.setEnd(l,e.end-t)),t+=c.length}for(const c of l.childNodes)r(c)}r(u);const o=window.getSelection();o.removeAllRanges(),o.addRange(n),u.focus()}function op(u){return u=u.replace(/&/g,"&amp;"),u=u.replace(/</g,"&lt;"),u=u.replace(/>/g,"&gt;"),u=u.replace(/"/g,"&quot;"),u=u.replace(/'/g,"&#039;"),u=u.replace(/\n/g,"<br>"),u=u.replace(/ /g,"&nbsp;"),u}const sp=23,lp=10;class _g{constructor(e="light"){k(this,"sheet");k(this,"theme");k(this,"container");k(this,"cellLabel");k(this,"formulaInput");k(this,"boundRenderInput");this.theme=e,this.container=document.createElement("div"),this.container.style.height=`${sp}px`,this.container.style.margin=`${lp}px 0px`,this.container.style.display="flex",this.container.style.alignItems="center",this.container.style.borderTop=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.container.style.borderBottom=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.container.style.justifyContent="flex-start",this.cellLabel=document.createElement("div"),this.cellLabel.style.width="120px",this.cellLabel.style.textAlign="center",this.cellLabel.style.font="12px Arial",this.cellLabel.style.borderRight=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.container.appendChild(this.cellLabel),this.formulaInput=document.createElement("div"),this.formulaInput.contentEditable="true",this.formulaInput.style.margin="0 20px",this.formulaInput.style.width="100%",this.formulaInput.style.height="12px",this.formulaInput.style.border="none",this.formulaInput.style.font="12px Arial",this.formulaInput.style.outline="none",this.formulaInput.style.overflow="hidden",this.formulaInput.style.whiteSpace="nowrap",this.formulaInput.style.lineHeight="12px",this.container.appendChild(this.formulaInput),this.boundRenderInput=this.renderInput.bind(this),this.formulaInput.addEventListener("input",this.boundRenderInput)}getContainer(){return this.container}initialize(e){this.sheet=e}cleanup(){this.formulaInput.removeEventListener("input",this.boundRenderInput),this.sheet=void 0,this.container.remove()}async render(){if(!this.sheet)return;const e=this.sheet.getActiveCell(),t=this.sheet.getSelectionType(),i=this.sheet.getSelectedIndices();let s;if(t==="row"&&i)s=`${i.from}:${i.to}`;else if(t==="column"&&i){const n=Jn(i.from),r=Jn(i.to);s=`${n}:${r}`}else{const n=this.sheet.getRange();s=n?Bx(n):xe(e)}this.cellLabel.textContent=s,this.formulaInput.innerText=await this.sheet.toInputString(e),this.renderInput()}getFormulaInput(){return this.formulaInput}getValue(){return this.formulaInput.innerText}setValue(e){this.formulaInput.innerText=e,this.renderInput()}focus(){this.formulaInput.focus()}blur(){this.formulaInput.blur()}isFocused(){return document.activeElement===this.formulaInput}renderInput(){const e=this.formulaInput.innerText;if(!e.startsWith("="))return;const t=Pr(e),i=[];let s=0;for(const r of t){if(r.type==="REFERENCE"){i.push(`<span style="color: ${uo(this.theme,s)}">${r.text}</span>`),s++;continue}if(r.type==="NUM"){i.push(`<span style="color: ${this.getThemeColor("tokens.NUM")}">${r.text}</span>`);continue}i.push(op(r.text))}const n=dr(this.formulaInput);this.formulaInput.innerHTML="="+i.join(""),n&&Ar(this.formulaInput,n)}getThemeColor(e){return ve(this.theme,e)}}const at=100,oe=23,ue=50,Cr=13,co=1.5,Ji=4,Rl=5,ml=.5,Tg=1.5,bg="center",ap=4,Ng=10;function De(u,e={left:0,top:0},t,i){const s=i?i.getOffset(u.c):(u.c-1)*at,n=t?t.getOffset(u.r):(u.r-1)*oe,r=i?i.getSize(u.c):at,o=t?t.getSize(u.r):oe;return{left:s+ue-e.left,top:n+oe-e.top,width:r,height:o}}function kn(u,e){const t=Math.min(u.left,e.left),i=Math.min(u.top,e.top),s=Math.max(u.left+u.width,e.left+e.width),n=Math.max(u.top+u.height,e.top+e.height);return{left:t,top:i,width:s-t,height:n-i}}const jn={frozenRows:0,frozenCols:0,frozenWidth:0,frozenHeight:0};function Rg(u,e,t,i){return u===0&&e===0?jn:{frozenRows:u,frozenCols:e,frozenWidth:e>0?i.getOffset(e+1):0,frozenHeight:u>0?t.getOffset(u+1):0}}function wg(u,e,t,i){const s=t?t.findIndex(e-oe):Math.floor(e/oe),n=i?i.findIndex(u-ue):Math.floor((u+ue)/at);return{r:s,c:n}}function Og(u,e,t,i,s,n){const r=n.frozenCols>0&&u<ue+n.frozenWidth,o=n.frozenRows>0&&e<oe+n.frozenHeight,l=r?u-ue:u-ue-n.frozenWidth+s.getOffset(n.frozenCols+1)+t.left,c=o?e-oe:e-oe-n.frozenHeight+i.getOffset(n.frozenRows+1)+t.top,a=s.findIndex(l),h=i.findIndex(c);return{r:Math.max(1,h),c:Math.max(1,a)}}function zn(u,e,t,i,s){const n=i.getOffset(u.c),r=t.getOffset(u.r),o=i.getSize(u.c),l=t.getSize(u.r),c=s.frozenCols>0&&u.c<=s.frozenCols,a=s.frozenRows>0&&u.r<=s.frozenRows,h=c?n+ue:n+ue-e.left-i.getOffset(s.frozenCols+1)+s.frozenWidth,f=a?r+oe:r+oe-e.top-t.getOffset(s.frozenRows+1)+s.frozenHeight;return{left:h,top:f,width:o,height:l}}class Fg{constructor(e="light"){k(this,"container");k(this,"input");k(this,"theme");k(this,"boundHandleInput");k(this,"minWidth",at);k(this,"minHeight",oe);k(this,"maxWidth",1/0);k(this,"maxHeight",1/0);k(this,"composing",!1);this.theme=e,this.container=document.createElement("div"),this.container.style.position="absolute",this.container.style.left="-1000px",this.container.style.width=at+"px",this.container.style.height=oe+"px",this.container.style.zIndex="1",this.container.style.margin="0px",this.container.style.pointerEvents="none",this.input=document.createElement("div"),this.input.contentEditable="true",this.input.style.border="none",this.input.style.outline=`2px solid ${this.getThemeColor("activeCellColor")}`,this.input.style.fontFamily="Arial, sans-serif",this.input.style.fontSize=Cr+"px",this.input.style.fontWeight="normal",this.input.style.lineHeight=String(co),this.input.style.color=this.getThemeColor("cellTextColor"),this.input.style.backgroundColor=this.getThemeColor("cellBGColor"),this.input.style.whiteSpace="pre",this.input.style.overflow="hidden",this.container.appendChild(this.input),this.boundHandleInput=this.handleInput.bind(this),this.input.addEventListener("input",this.boundHandleInput),this.input.addEventListener("compositionstart",()=>{this.composing=!0}),this.input.addEventListener("compositionend",()=>{this.composing=!1,this.adjustSize()})}cleanup(){this.input.removeEventListener("input",this.boundHandleInput),this.container.remove()}getContainer(){return this.container}getInput(){return this.input}show(e,t,i="",s=!0,n,r,o,l){this.minWidth=n??at,this.minHeight=r??oe,this.maxWidth=o??1/0,this.maxHeight=l??1/0,this.container.style.left=e+"px",this.container.style.top=t+"px",this.container.style.pointerEvents="auto",this.input.innerText=i,this.renderInput(),this.adjustSize(),s&&(Ar(this.input,{start:this.input.innerText.length,end:this.input.innerText.length}),this.input.focus())}hide(){this.container.style.left="-1000px",this.container.style.pointerEvents="none",this.input.innerText="",this.input.blur()}isShown(){return this.container.style.left!=="-1000px"}isFocused(){return document.activeElement===this.input}getValue(){return this.input.innerText}setValue(e){this.input.innerText=e,this.renderInput(),this.adjustSize()}hasFormula(){return this.input.innerText.startsWith("=")}applyStyle(e){this.input.style.fontWeight=e!=null&&e.b?"bold":"normal",this.input.style.fontStyle=e!=null&&e.i?"italic":"normal";const t=[];e!=null&&e.u&&t.push("underline"),e!=null&&e.st&&t.push("line-through"),this.input.style.textDecoration=t.length?t.join(" "):"none",this.input.style.color=(e==null?void 0:e.tc)||this.getThemeColor("cellTextColor"),this.input.style.backgroundColor=(e==null?void 0:e.bg)||this.getThemeColor("cellBGColor"),this.input.style.textAlign=(e==null?void 0:e.al)||"left";const i=(e==null?void 0:e.va)||"top";this.container.style.display="flex",this.container.style.alignItems=i==="middle"?"center":i==="bottom"?"flex-end":"flex-start"}handleInput(){this.renderInput(),this.composing||this.adjustSize()}adjustSize(){this.input.style.width=this.minWidth+"px",this.input.style.height=this.minHeight+"px";const e=Math.min(Math.max(this.minWidth,this.input.scrollWidth),this.maxWidth),t=Math.min(Math.max(this.minHeight,this.input.scrollHeight),this.maxHeight);this.container.style.width=e+"px",this.container.style.height=t+"px",this.input.style.width=e+"px",this.input.style.height=t+"px",this.input.style.overflowY=this.input.scrollHeight>this.maxHeight?"auto":"hidden"}renderInput(){const e=this.input.innerText;if(!e.startsWith("="))return;const t=Pr(e),i=[];let s=0;for(const r of t){if(r.type==="REFERENCE"){i.push(`<span style="color: ${uo(this.theme,s)}">${r.text}</span>`),s++;continue}if(r.type==="NUM"){i.push(`<span style="color: ${this.getThemeColor("tokens.NUM")}">${r.text}</span>`);continue}i.push(op(r.text))}const n=dr(this.input);this.input.innerHTML="="+i.join(""),n&&Ar(this.input,n)}getThemeColor(e){return ve(this.theme,e)}}class Pg{constructor(e="light"){k(this,"canvas");k(this,"theme");this.theme=e,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.zIndex="1",this.canvas.style.pointerEvents="none"}cleanup(){this.canvas.remove()}getContainer(){return this.canvas}render(e,t,i,s,n,r,o,l,c,a,h,f=jn,d,p,v,x=!0,y){this.canvas.width=0,this.canvas.height=0;const g=this.canvas.getContext("2d"),m=window.devicePixelRatio||1;this.canvas.width=e.width*m,this.canvas.height=e.height*m,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",g.scale(m,m);const S=f.frozenRows>0||f.frozenCols>0,T=this.buildMergeRenderData(y),A=n?[n[0],n[1]]:[i,i];if(!S)this.renderActiveCellSimple(g,i,t,r,o,T),this.renderSelectionSimple(g,e,t,n,c,r,o),this.renderPeerCursorsSimple(g,e,s,t,r,o,T),this.renderFormulaRangesSimple(g,h,t,r,o),this.renderCopyRangeSimple(g,p,t,r,o);else{const b=this.buildQuadrants(e,t,f,r,o);this.renderSelectionFrozen(g,e,t,n,c,r,o,f,b);for(const N of b){g.save(),g.beginPath(),g.rect(N.x,N.y,N.width,N.height),g.clip();const R=this.toCellRect(i,{left:N.scrollLeft,top:N.scrollTop},r,o,T);g.strokeStyle=this.getThemeColor("activeCellColor"),g.lineWidth=2,g.strokeRect(R.left,R.top,R.width,R.height),g.restore()}for(const{clientID:N,presence:R}of s){if(!R.activeCell)continue;const P=be(R.activeCell),I=kf(this.theme,N);for(const B of b){g.save(),g.beginPath(),g.rect(B.x,B.y,B.width,B.height),g.clip();const V=this.toCellRect(P,{left:B.scrollLeft,top:B.scrollTop},r,o,T);V.left>=-V.width&&V.left<e.width&&V.top>=-V.height&&V.top<e.height&&(g.strokeStyle=I,g.lineWidth=2,g.strokeRect(V.left,V.top,V.width,V.height)),g.restore()}}if(h&&h.length>0)for(let N=0;N<h.length;N++){const R=h[N],P=uo(this.theme,N);for(const I of b){g.save(),g.beginPath(),g.rect(I.x,I.y,I.width,I.height),g.clip();const B={left:I.scrollLeft,top:I.scrollTop},V=kn(De(R[0],B,r,o),De(R[1],B,r,o));g.strokeStyle=P,g.lineWidth=2,g.strokeRect(V.left,V.top,V.width,V.height),g.fillStyle=P+"20",g.fillRect(V.left,V.top,V.width,V.height),g.restore()}}if(p)for(const N of b){g.save(),g.beginPath(),g.rect(N.x,N.y,N.width,N.height),g.clip();const R={left:N.scrollLeft,top:N.scrollTop};this.drawCopyRangeBorder(g,p,R,r,o),g.restore()}}v&&!lo(v,A)&&this.renderAutofillPreview(g,v,t,r,o,f),x&&this.renderAutofillHandle(g,A,c,t,r,o,f),l&&o&&r&&this.renderResizeHover(g,e,t,l,r,o,f),a&&o&&r&&this.renderDragMoveIndicator(g,e,t,a,r,o,f),d&&o&&r&&this.renderFreezeDragPreview(g,e,d,r,o)}buildQuadrants(e,t,i,s,n){const r=i.frozenWidth,o=i.frozenHeight,l=s?s.getOffset(i.frozenRows+1):0,c=n?n.getOffset(i.frozenCols+1):0,a=[];return a.push({x:ue+r,y:oe+o,width:e.width-ue-r,height:e.height-oe-o,scrollLeft:t.left+c-r,scrollTop:t.top+l-o}),i.frozenRows>0&&a.push({x:ue+r,y:oe,width:e.width-ue-r,height:o,scrollLeft:t.left+c-r,scrollTop:0}),i.frozenCols>0&&a.push({x:ue,y:oe+o,width:r,height:e.height-oe-o,scrollLeft:0,scrollTop:t.top+l-o}),i.frozenRows>0&&i.frozenCols>0&&a.push({x:ue,y:oe,width:r,height:o,scrollLeft:0,scrollTop:0}),a}renderActiveCellSimple(e,t,i,s,n,r){const o=this.toCellRect(t,i,s,n,r);e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=2,e.strokeRect(o.left,o.top,o.width,o.height)}renderSelectionSimple(e,t,i,s,n,r,o){if(n==="all")e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,oe,t.width-ue,t.height-oe);else if(s)if(n==="row"){const l=De(s[0],i,r,o),c=De(s[1],i,r,o),a=l.top,h=c.top+c.height-l.top;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,a,t.width-ue,h),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(ue,a,t.width-ue,h)}else if(n==="column"){const l=De(s[0],i,r,o),c=De(s[1],i,r,o),a=l.left,h=c.left+c.width-l.left;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(a,oe,h,t.height-oe),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(a,oe,h,t.height-oe)}else{const l=kn(De(s[0],i,r,o),De(s[1],i,r,o));e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(l.left,l.top,l.width,l.height),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(l.left,l.top,l.width,l.height)}}renderPeerCursorsSimple(e,t,i,s,n,r,o){for(const{clientID:l,presence:c}of i){if(!c.activeCell)continue;const a=be(c.activeCell),h=this.toCellRect(a,s,n,r,o);if(h.left>=-h.width&&h.left<t.width&&h.top>=-h.height&&h.top<t.height){const f=kf(this.theme,l);e.strokeStyle=f,e.lineWidth=2,e.strokeRect(h.left,h.top,h.width,h.height)}}}renderFormulaRangesSimple(e,t,i,s,n){if(!(!t||t.length===0))for(let r=0;r<t.length;r++){const o=t[r],l=kn(De(o[0],i,s,n),De(o[1],i,s,n)),c=uo(this.theme,r);e.strokeStyle=c,e.lineWidth=2,e.strokeRect(l.left,l.top,l.width,l.height),e.fillStyle=c+"20",e.fillRect(l.left,l.top,l.width,l.height)}}renderCopyRangeSimple(e,t,i,s,n){t&&this.drawCopyRangeBorder(e,t,i,s,n)}drawCopyRangeBorder(e,t,i,s,n){const r=kn(De(t[0],i,s,n),De(t[1],i,s,n));e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=2,e.setLineDash([5,3]),e.strokeRect(r.left,r.top,r.width,r.height),e.setLineDash([])}renderSelectionFrozen(e,t,i,s,n,r,o,l,c){if(n==="all"){e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,oe,t.width-ue,t.height-oe);return}if(s)for(const a of c){e.save(),e.beginPath(),e.rect(a.x,a.y,a.width,a.height),e.clip();const h={left:a.scrollLeft,top:a.scrollTop};if(n==="row"){const f=De(s[0],h,r,o),d=De(s[1],h,r,o),p=f.top,v=d.top+d.height-f.top;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,p,t.width-ue,v),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(ue,p,t.width-ue,v)}else if(n==="column"){const f=De(s[0],h,r,o),d=De(s[1],h,r,o),p=f.left,v=d.left+d.width-f.left;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(p,oe,v,t.height-oe),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(p,oe,v,t.height-oe)}else{const f=kn(De(s[0],h,r,o),De(s[1],h,r,o));e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(f.left,f.top,f.width,f.height),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(f.left,f.top,f.width,f.height)}e.restore()}}renderResizeHover(e,t,i,s,n,r,o){if(e.strokeStyle=this.getThemeColor("resizeHandleColor"),e.lineWidth=2,s.axis==="column"){const c=o.frozenCols>0&&s.index<=o.frozenCols?0:i.left+r.getOffset(o.frozenCols+1)-o.frozenWidth,a=ue+r.getOffset(s.index)+r.getSize(s.index)-c;e.beginPath(),e.moveTo(a,0),e.lineTo(a,t.height),e.stroke()}else{const c=o.frozenRows>0&&s.index<=o.frozenRows?0:i.top+n.getOffset(o.frozenRows+1)-o.frozenHeight,a=oe+n.getOffset(s.index)+n.getSize(s.index)-c;e.beginPath(),e.moveTo(0,a),e.lineTo(t.width,a),e.stroke()}}renderDragMoveIndicator(e,t,i,s,n,r,o){if(e.strokeStyle=this.getThemeColor("dropIndicatorColor"),e.lineWidth=3,s.axis==="column"){const c=o.frozenCols>0&&s.dropIndex<=o.frozenCols?0:i.left+r.getOffset(o.frozenCols+1)-o.frozenWidth,a=ue+r.getOffset(s.dropIndex)-c;e.beginPath(),e.moveTo(a,0),e.lineTo(a,t.height),e.stroke()}else{const c=o.frozenRows>0&&s.dropIndex<=o.frozenRows?0:i.top+n.getOffset(o.frozenRows+1)-o.frozenHeight,a=oe+n.getOffset(s.dropIndex)-c;e.beginPath(),e.moveTo(0,a),e.lineTo(t.width,a),e.stroke()}}renderFreezeDragPreview(e,t,i,s,n){if(e.strokeStyle=this.getThemeColor("freezeLineColor"),e.lineWidth=2,i.axis==="row"){const r=i.targetIndex===0?oe:oe+s.getOffset(i.targetIndex+1);e.beginPath(),e.moveTo(0,r),e.lineTo(t.width,r),e.stroke()}else{const r=i.targetIndex===0?ue:ue+n.getOffset(i.targetIndex+1);e.beginPath(),e.moveTo(r,0),e.lineTo(r,t.height),e.stroke()}}toRangeRect(e,t,i,s,n=jn){if(!i||!s)return;const r=n.frozenRows>0||n.frozenCols>0,o=r?zn(e[0],t,i,s,n):De(e[0],t,i,s),l=r?zn(e[1],t,i,s,n):De(e[1],t,i,s);return kn(o,l)}renderAutofillPreview(e,t,i,s,n,r=jn){const o=this.toRangeRect(t,i,s,n,r);o&&(e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.setLineDash([4,2]),e.strokeRect(o.left,o.top,o.width,o.height),e.setLineDash([]))}renderAutofillHandle(e,t,i,s,n,r,o=jn){if(i!=="cell"||!t)return;const l=this.toRangeRect(t,s,n,r,o);if(!l)return;const c=8,a=l.left+l.width-c/2,h=l.top+l.height-c/2;e.fillStyle=this.getThemeColor("activeCellColor"),e.fillRect(a,h,c,c),e.strokeStyle=this.getThemeColor("cellBGColor"),e.lineWidth=1,e.strokeRect(a+.5,h+.5,c,c)}getThemeColor(e){return ve(this.theme,e)}buildMergeRenderData(e){if(!e||e.size===0)return;const t=new Map,i=new Map;for(const[s,n]of e){t.set(s,n);const r=be(s);for(let o=r.r;o<r.r+n.rs;o++)for(let l=r.c;l<r.c+n.cs;l++){const c=xe({r:o,c:l});c!==s&&i.set(c,s)}}return{anchors:t,coverToAnchor:i}}toCellRect(e,t,i,s,n){const r=xe(e),o=(n==null?void 0:n.coverToAnchor.get(r))||r,l=be(o),c=n==null?void 0:n.anchors.get(o),a=De(l,t,i,s);if(!c||c.rs===1&&c.cs===1)return a;const h=De({r:l.r+c.rs-1,c:l.c+c.cs-1},t,i,s);return{left:a.left,top:a.top,width:h.left+h.width-a.left,height:h.top+h.height-a.top}}}const Zi=1e7;class Dg{constructor(e="light"){k(this,"container");k(this,"scrollContainer");k(this,"dummyContainer");k(this,"actualWidth",0);k(this,"actualHeight",0);this.createContainers()}createContainers(){this.container=document.createElement("div"),this.container.style.position="relative",this.container.style.width="100%",this.container.style.height=`calc(100% - ${sp+lp*2}px)`,this.scrollContainer=document.createElement("div"),this.scrollContainer.style.position="absolute",this.scrollContainer.style.overflow="auto",this.scrollContainer.style.width="100%",this.scrollContainer.style.height="100%",this.scrollContainer.style.zIndex="1",this.dummyContainer=document.createElement("div"),this.dummyContainer.style.margin="0px",this.dummyContainer.style.padding="0px",this.dummyContainer.style.pointerEvents="none",this.scrollContainer.appendChild(this.dummyContainer),this.container.appendChild(this.scrollContainer)}getContainer(){return this.container}getScrollContainer(){return this.scrollContainer}getDummyContainer(){return this.dummyContainer}updateDummySize(e,t){this.actualWidth=e,this.actualHeight=t;const i=Math.min(e,Zi),s=Math.min(t,Zi);this.dummyContainer.style.width=i+"px",this.dummyContainer.style.height=s+"px"}appendChild(e){this.container.appendChild(e)}getViewport(){return this.scrollContainer.getBoundingClientRect()}getScrollPosition(){const e=this.scrollContainer.scrollLeft,t=this.scrollContainer.scrollTop,i=this.scrollContainer.getBoundingClientRect();return{left:this.toLogical(e,this.actualWidth,i.width),top:this.toLogical(t,this.actualHeight,i.height)}}setScrollPosition(e){const t=this.scrollContainer.getBoundingClientRect();e.left!==void 0&&(this.scrollContainer.scrollLeft=this.toPhysical(e.left,this.actualWidth,t.width)),e.top!==void 0&&(this.scrollContainer.scrollTop=this.toPhysical(e.top,this.actualHeight,t.height))}scrollBy(e,t){const i=this.scrollContainer.getBoundingClientRect(),s=this.needsRemap(this.actualWidth,i.width)?e*this.physicalMax(this.actualWidth,i.width)/this.logicalMax(this.actualWidth,i.width):e,n=this.needsRemap(this.actualHeight,i.height)?t*this.physicalMax(this.actualHeight,i.height)/this.logicalMax(this.actualHeight,i.height):t;this.scrollContainer.scrollBy(s,n)}addEventListener(e,t,i){this.scrollContainer.addEventListener(e,t,i)}removeEventListener(e,t,i){this.scrollContainer.removeEventListener(e,t,i)}cleanup(){this.container.remove()}needsRemap(e,t){return e>Zi&&t<e}cappedSize(e){return Math.min(e,Zi)}physicalMax(e,t){return Math.max(0,this.cappedSize(e)-t)}logicalMax(e,t){return Math.max(0,e-t)}clamp(e,t,i){return i<=t?t:Math.min(i,Math.max(t,e))}toLogical(e,t,i){const s=this.logicalMax(t,i);if(!this.needsRemap(t,i))return this.clamp(e,0,s);const n=this.physicalMax(t,i);return n<=0||s<=0?0:this.clamp(e,0,n)*s/n}toPhysical(e,t,i){const s=this.logicalMax(t,i);if(!this.needsRemap(t,i))return this.clamp(e,0,s);if(s<=0)return 0;const n=this.physicalMax(t,i);return this.clamp(e,0,s)*n/s}}const Ig="M4 6h16 M6 12h12 M9 18h6",Yn=class Yn{constructor(e="light"){k(this,"canvas");k(this,"theme");this.theme=e,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.pointerEvents="none"}getCanvas(){return this.canvas}render(e,t,i,s,n,r,o,l,c,a=jn,h=null,f,d,p,v,x,y,g=null){this.canvas.width=0,this.canvas.height=0;const m=this.canvas.getContext("2d"),S=window.devicePixelRatio||1;this.canvas.width=e.width*S,this.canvas.height=e.height*S,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",m.scale(S,S);const[T,A]=i,b=this.buildMergeRenderData(v);if(!(a.frozenRows>0||a.frozenCols>0))this.renderQuadrantCells(m,T.r,A.r+1,T.c,A.c+1,n,t,r,o,f,d,p,b,x,y,g),this.renderColumnHeaders(m,T.c,A.c,t.left,ue,e.width,s,l,c,r,o),this.renderRowHeaders(m,T.r,A.r,t.top,oe,e.height,s,l,c,r,o);else{const P=a.frozenWidth,I=a.frozenHeight,B=a.frozenRows,V=a.frozenCols,ee=B+1,te=V+1,le=Math.max(ee,T.r),ge=Math.max(te,T.c),ce=r?r.getOffset(ee):B*oe,Z=o?o.getOffset(te):V*at;m.save(),m.beginPath(),m.rect(ue+P,oe+I,e.width-ue-P,e.height-oe-I),m.clip(),this.renderQuadrantCells(m,le,A.r+1,ge,A.c+1,n,{left:t.left+Z-P,top:t.top+ce-I},r,o,f,d,p,b,x,y,g),m.restore(),B>0&&(m.save(),m.beginPath(),m.rect(ue+P,oe,e.width-ue-P,I),m.clip(),this.renderQuadrantCells(m,1,B+1,ge,A.c+1,n,{left:t.left+Z-P,top:0},r,o,f,d,p,b,x,y,g),m.restore()),V>0&&(m.save(),m.beginPath(),m.rect(ue,oe+I,P,e.height-oe-I),m.clip(),this.renderQuadrantCells(m,le,A.r+1,1,V+1,n,{left:0,top:t.top+ce-I},r,o,f,d,p,b,x,y,g),m.restore()),B>0&&V>0&&(m.save(),m.beginPath(),m.rect(ue,oe,P,I),m.clip(),this.renderQuadrantCells(m,1,B+1,1,V+1,n,{left:0,top:0},r,o,f,d,p,b,x,y,g),m.restore()),V>0&&this.renderColumnHeaders(m,1,V,0,ue,ue+P,s,l,c,r,o),this.renderColumnHeaders(m,ge,A.c,t.left+Z-P,ue+P,e.width,s,l,c,r,o),B>0&&this.renderRowHeaders(m,1,B,0,oe,oe+I,s,l,c,r,o),this.renderRowHeaders(m,le,A.r,t.top+ce-I,oe+I,e.height,s,l,c,r,o),this.renderFreezeLines(m,e,P,I)}const R=l==="all";m.fillStyle=R?this.getThemeColor("headerSelectedBGColor"):this.getThemeColor("headerBGColor"),m.fillRect(0,0,ue,oe),m.strokeStyle=this.getThemeColor("cellBorderColor"),m.lineWidth=ml,m.strokeRect(0,0,ue,oe),this.renderFreezeHandles(m,a,h)}renderQuadrantCells(e,t,i,s,n,r,o,l,c,a,h,f,d,p,v,x=null){const y=this.buildTextOverflowRenderData(e,t,i,s,n,r,c,a,h,f,d);for(let g=t;g<=i;g++)for(let m=s;m<=n;m++){const S=xe({r:g,c:m});if(d!=null&&d.coverToAnchor.has(S))continue;const T=r==null?void 0:r.get(xe({r:g,c:m})),A=d==null?void 0:d.anchors.get(S),b=this.resolveEffectiveStyle(g,m,T,f,a,h),N=y==null?void 0:y.hiddenVerticalBoundaries.has(this.verticalBoundaryKey(g,m-1)),R=y==null?void 0:y.hiddenVerticalBoundaries.has(this.verticalBoundaryKey(g,m));this.renderCellBackground(e,{r:g,c:m},T,o,l,c,b,A,N,R)}for(let g=t;g<=i;g++)for(let m=s;m<=n;m++){const S=xe({r:g,c:m});if(d!=null&&d.coverToAnchor.has(S))continue;const T=r==null?void 0:r.get(xe({r:g,c:m})),A=d==null?void 0:d.anchors.get(S),b=this.resolveEffectiveStyle(g,m,T,f,a,h);this.renderCellCustomBorders(e,{r:g,c:m},o,l,c,b,A)}for(let g=t;g<=i;g++)for(let m=s;m<=n;m++){const S=xe({r:g,c:m});if(d!=null&&d.coverToAnchor.has(S))continue;const T=r==null?void 0:r.get(xe({r:g,c:m})),A=d==null?void 0:d.anchors.get(S),b=this.resolveEffectiveStyle(g,m,T,f,a,h),N=y==null?void 0:y.anchorToEndCol.get(S);this.renderCellContent(e,{r:g,c:m},T,o,l,c,b,r,n,A,N)}if(p){const g=p[0].r;if(g>=t&&g<=i){const m=Math.max(s,p[0].c),S=Math.min(n,p[1].c);for(let T=m;T<=S;T++){const A=xe({r:g,c:T});if(d!=null&&d.coverToAnchor.has(A))continue;const b=d==null?void 0:d.anchors.get(A);this.renderCellFilterButton(e,{r:g,c:T},o,l,c,b,!!(v!=null&&v.has(T)),x===T)}}}}renderColumnHeaders(e,t,i,s,n,r,o,l,c,a,h){e.save(),e.beginPath(),e.rect(n,0,r-n,oe),e.clip();for(let f=t;f<=i;f++){const d=h?h.getOffset(f):at*(f-1),p=h?h.getSize(f):at,v=ue+d-s,x=0,y=l==="all"||l==="column"&&c&&f>=c[0].c&&f<=c[1].c;this.renderHeader(e,v,x,p,oe,Jn(f),o.c===f,y||!1)}e.restore()}renderCellFilterButton(e,t,i,s,n,r,o=!1,l=!1){const c=this.toCellRect(t,i,s,n,r),a=c.width,h=c.height;if(a<=6||h<=6)return;const f=Math.min(16,Math.max(12,a-4)),d=Math.min(16,Math.max(12,h-6)),p=c.left+a-f-2,v=c.top+Math.max(3,(h-d)/2);(o||l)&&(e.fillStyle=o?this.getThemeColor("selectionBGColor"):this.getThemeColor("headerSelectedBGColor"),e.fillRect(p,v,f,d));const x=o||l?this.getThemeColor("resizeHandleColor"):this.getThemeColor("cellTextColor"),y=Math.max(9,Math.min(12,Math.min(f,d)-3)),g=p+(f-y)/2,m=v+(d-y)/2;e.save(),e.translate(g,m),e.scale(y/24,y/24),e.strokeStyle=x,e.lineCap="round",e.lineJoin="round";const S=this.getFilterIconPath2D();S?(e.lineWidth=2,e.stroke(S)):(e.lineWidth=2,e.beginPath(),e.moveTo(4,6),e.lineTo(20,6),e.moveTo(6,12),e.lineTo(18,12),e.moveTo(9,18),e.lineTo(15,18),e.stroke()),e.restore()}getFilterIconPath2D(){return typeof Path2D>"u"?null:(Yn.filterIconPath2D===void 0&&(Yn.filterIconPath2D=new Path2D(Ig)),Yn.filterIconPath2D)}renderRowHeaders(e,t,i,s,n,r,o,l,c,a,h){e.save(),e.beginPath(),e.rect(0,n,ue,r-n),e.clip();for(let f=t;f<=i;f++){const d=a?a.getOffset(f):oe*(f-1),p=a?a.getSize(f):oe;if(p<=0)continue;const v=0,x=d+oe-s,y=l==="all"||l==="row"&&c&&f>=c[0].r&&f<=c[1].r;this.renderHeader(e,v,x,ue,p,String(f),o.r===f,y||!1)}e.restore()}renderFreezeLines(e,t,i,s){if(e.strokeStyle=this.getThemeColor("freezeLineColor"),e.lineWidth=2,s>0){const n=oe+s;e.beginPath(),e.moveTo(0,n),e.lineTo(t.width,n),e.stroke()}if(i>0){const n=ue+i;e.beginPath(),e.moveTo(n,0),e.lineTo(n,t.height),e.stroke()}}renderFreezeHandles(e,t,i){const s=t.frozenRows>0||t.frozenCols>0,n=ap,r=s&&t.frozenRows>0?oe+t.frozenHeight-n/2:oe-n,o=i==="row";e.fillStyle=o?this.getThemeColor("freezeHandleHoverColor"):this.getThemeColor("freezeHandleColor"),e.fillRect(0,r,ue,n);const l=s&&t.frozenCols>0?ue+t.frozenWidth-n/2:ue-n,c=i==="column";e.fillStyle=c?this.getThemeColor("freezeHandleHoverColor"):this.getThemeColor("freezeHandleColor"),e.fillRect(l,0,n,oe)}renderHeader(e,t,i,s,n,r,o,l=!1){s<=0||n<=0||(e.fillStyle=l?this.getThemeColor("headerSelectedBGColor"):o?this.getThemeColor("headerActiveBGColor"):this.getThemeColor("headerBGColor"),e.fillRect(t,i,s,n),e.strokeStyle=this.getThemeColor("cellBorderColor"),e.lineWidth=ml,e.strokeRect(t,i,s,n),e.fillStyle=this.getThemeColor("cellTextColor"),e.textAlign=bg,e.font=o||l?"bold 10px Arial":"10px Arial",e.fillText(r,t+s/2,i+Math.min(15,n-4)))}renderCellBackground(e,t,i,s,n,r,o,l,c=!1,a=!1){const h=this.toCellRect(t,s,n,r,l),f=o??(i==null?void 0:i.s);if(e.fillStyle=(f==null?void 0:f.bg)||this.getThemeColor("cellBGColor"),e.fillRect(h.left,h.top,h.width,h.height),e.beginPath(),e.strokeStyle=this.getThemeColor("cellBorderColor"),e.lineWidth=ml,c||(e.moveTo(h.left,h.top),e.lineTo(h.left,h.top+h.height)),!a){const d=h.left+h.width;e.moveTo(d,h.top),e.lineTo(d,h.top+h.height)}e.moveTo(h.left,h.top),e.lineTo(h.left+h.width,h.top),e.moveTo(h.left,h.top+h.height),e.lineTo(h.left+h.width,h.top+h.height),e.stroke()}renderCellCustomBorders(e,t,i,s,n,r,o){if(!r||!r.bt&&!r.br&&!r.bb&&!r.bl)return;const l=this.toCellRect(t,i,s,n,o);if(e.beginPath(),e.strokeStyle=this.getThemeColor("customBorderColor"),e.lineWidth=Tg,r.bt&&(e.moveTo(l.left,l.top),e.lineTo(l.left+l.width,l.top)),r.br){const c=l.left+l.width;e.moveTo(c,l.top),e.lineTo(c,l.top+l.height)}if(r.bb){const c=l.top+l.height;e.moveTo(l.left,c),e.lineTo(l.left+l.width,c)}r.bl&&(e.moveTo(l.left,l.top),e.lineTo(l.left,l.top+l.height)),e.stroke()}renderCellContent(e,t,i,s,n,r,o,l,c,a,h){const f=this.toCellRect(t,s,n,r,a),d=o??(i==null?void 0:i.s),p=(i==null?void 0:i.v)||"";if(p){const v=Nl(p,d==null?void 0:d.nf,d==null?void 0:d.dp),x=v.split(`
`),y=this.toCellFont(d);let g=f.width;const m=(d==null?void 0:d.al)||"left";if(!a&&h&&r&&h>t.c){let N=0;for(let R=t.c+1;R<=h;R++)N+=r.getSize(R);g=f.width+N}else if(!a&&x.length===1&&m==="left"&&l&&r&&c){e.save(),e.font=y;const N=e.measureText(v).width+Ji*2;if(e.restore(),N>f.width){let R=0;for(let P=t.c+1;P<=c;P++){const I=l.get(xe({r:t.r,c:P}));if(I&&(I.v||I.f))break;const B=r.getSize(P);if(R+=B,f.width+R>=N)break}g=f.width+R}}e.save(),e.beginPath(),e.rect(f.left,f.top,g,f.height),e.clip(),e.fillStyle=(d==null?void 0:d.tc)||this.getThemeColor("cellTextColor"),e.font=y,e.textBaseline="top";let S;m==="center"?(e.textAlign="center",S=f.left+f.width/2):m==="right"?(e.textAlign="right",S=f.left+f.width-Ji):(e.textAlign="left",S=f.left+Ji);const T=(d==null?void 0:d.va)||"top",A=x.length*Cr*co;let b;T==="middle"?b=f.top+(f.height-A)/2:T==="bottom"?b=f.top+f.height-A-Rl:b=f.top+Rl;for(let N=0;N<x.length;N++){const R=b+N*(Cr*co);if(e.fillText(x[N],S,R),d!=null&&d.u){const P=e.measureText(x[N]),I=R+Cr+1;let B;m==="center"?B=S-P.width/2:m==="right"?B=S-P.width:B=S,e.beginPath(),e.strokeStyle=(d==null?void 0:d.tc)||this.getThemeColor("cellTextColor"),e.lineWidth=1,e.moveTo(B,I),e.lineTo(B+P.width,I),e.stroke()}if(d!=null&&d.st){const P=e.measureText(x[N]),I=R+Cr/2;let B;m==="center"?B=S-P.width/2:m==="right"?B=S-P.width:B=S,e.beginPath(),e.strokeStyle=(d==null?void 0:d.tc)||this.getThemeColor("cellTextColor"),e.lineWidth=1,e.moveTo(B,I),e.lineTo(B+P.width,I),e.stroke()}}e.restore()}}buildTextOverflowRenderData(e,t,i,s,n,r,o,l,c,a,h){if(!r||!o)return;const f=new Map,d=new Set;e.save();for(let p=t;p<=i;p++)for(let v=s;v<=n;v++){const x=xe({r:p,c:v});if(h!=null&&h.coverToAnchor.has(x)||h!=null&&h.anchors.has(x))continue;const y=r.get(x),g=(y==null?void 0:y.v)||"";if(!g)continue;const m=this.resolveEffectiveStyle(p,v,y,a,l,c);if(((m==null?void 0:m.al)||"left")!=="left")continue;const T=Nl(g,m==null?void 0:m.nf,m==null?void 0:m.dp);if(T.split(`
`).length!==1)continue;const b=o.getSize(v);e.font=this.toCellFont(m);const N=e.measureText(T).width+Ji*2;if(N<=b)continue;let R=b,P=v;for(let I=v+1;I<=n;I++){const B=this.resolveEffectiveStyle(p,I-1,r.get(xe({r:p,c:I-1})),a,l,c),V=this.resolveEffectiveStyle(p,I,r.get(xe({r:p,c:I})),a,l,c);if(B!=null&&B.br||V!=null&&V.bl)break;const ee=xe({r:p,c:I});if(h!=null&&h.coverToAnchor.has(ee)||h!=null&&h.anchors.has(ee))break;const te=r.get(ee);if(te&&(te.v||te.f)||(R+=o.getSize(I),P=I,R>=N))break}if(P>v){f.set(x,P);for(let I=v;I<P;I++)d.add(this.verticalBoundaryKey(p,I))}}if(e.restore(),f.size!==0)return{anchorToEndCol:f,hiddenVerticalBoundaries:d}}resolveEffectiveStyle(e,t,i,s,n,r){const o=n==null?void 0:n.get(t),l=r==null?void 0:r.get(e);if(!(!s&&!o&&!l&&!(i!=null&&i.s)))return{...s,...o,...l,...i==null?void 0:i.s}}buildMergeRenderData(e){if(!e||e.size===0)return;const t=new Map,i=new Map;for(const[s,n]of e){t.set(s,n);const r=be(s);for(let o=r.r;o<r.r+n.rs;o++)for(let l=r.c;l<r.c+n.cs;l++){const c=xe({r:o,c:l});c!==s&&i.set(c,s)}}return{anchors:t,coverToAnchor:i}}toCellRect(e,t,i,s,n){const r=De(e,t,i,s);if(!n||n.rs===1&&n.cs===1)return r;const o=De({r:e.r+n.rs-1,c:e.c+n.cs-1},t,i,s);return{left:r.left,top:r.top,width:o.left+o.width-r.left,height:o.top+o.height-r.top}}toCellFont(e){const t=[];return e!=null&&e.b&&t.push("bold"),e!=null&&e.i&&t.push("italic"),t.push(`${Cr}px Arial`),t.join(" ")}verticalBoundaryKey(e,t){return`${e}:${t}`}getThemeColor(e){return ve(this.theme,e)}cleanup(){this.canvas.remove()}};k(Yn,"filterIconPath2D");let wl=Yn;class Lg{constructor(e="light"){k(this,"container");k(this,"theme");this.theme=e,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.display="none",this.container.style.zIndex="1000",this.container.style.minWidth="160px",this.container.style.borderRadius="4px",this.container.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)",this.container.style.padding="4px 0",this.container.style.fontSize="13px",this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.applyTheme(),this.handleDocumentClick=this.handleDocumentClick.bind(this)}getContainer(){return this.container}show(e,t,i){this.container.innerHTML="";for(const s of i){const n=document.createElement("div");n.textContent=s.label,n.style.padding="6px 16px",n.style.cursor="pointer",n.style.color=ve(this.theme,"cellTextColor"),n.addEventListener("mouseenter",()=>{n.style.backgroundColor=ve(this.theme,"selectionBGColor")}),n.addEventListener("mouseleave",()=>{n.style.backgroundColor="transparent"}),n.addEventListener("mousedown",r=>{r.preventDefault(),r.stopPropagation(),this.hide(),s.action()}),this.container.appendChild(n)}this.container.style.left=`${e}px`,this.container.style.top=`${t}px`,this.container.style.display="block",document.addEventListener("mousedown",this.handleDocumentClick)}hide(){this.container.style.display="none",document.removeEventListener("mousedown",this.handleDocumentClick)}cleanup(){this.hide(),this.container.remove()}handleDocumentClick(e){this.container.contains(e.target)||this.hide()}applyTheme(){this.container.style.backgroundColor=ve(this.theme,"cellBGColor"),this.container.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`}}const ki=[{name:"SUM",description:"Returns the sum of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"ABS",description:"Returns the absolute value of a number",args:[{name:"number"}]},{name:"ROUND",description:"Rounds a number to a certain number of decimal places",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDUP",description:"Rounds a number away from zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDDOWN",description:"Rounds a number toward zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"INT",description:"Rounds a number down to the nearest integer",args:[{name:"value"}]},{name:"MOD",description:"Returns the remainder after division",args:[{name:"dividend"},{name:"divisor"}]},{name:"SQRT",description:"Returns the positive square root of a number",args:[{name:"value"}]},{name:"POWER",description:"Returns a number raised to a power",args:[{name:"base"},{name:"exponent"}]},{name:"PRODUCT",description:"Multiplies a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MEDIAN",description:"Returns the middle number in a series",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"IF",description:"Returns one value if true and another if false",args:[{name:"condition"},{name:"value_if_true"},{name:"value_if_false",optional:!0}]},{name:"IFS",description:"Returns the first value whose condition is true",args:[{name:"condition1"},{name:"value1"},{name:"condition2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0}]},{name:"SWITCH",description:"Matches an expression against case/value pairs",args:[{name:"expression"},{name:"case1"},{name:"value1"},{name:"case2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0},{name:"default",optional:!0}]},{name:"AND",description:"Returns TRUE if all arguments are true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"OR",description:"Returns TRUE if any argument is true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"NOT",description:"Returns the opposite of a logical value",args:[{name:"logical"}]},{name:"AVERAGE",description:"Returns the average of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MIN",description:"Returns the smallest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MAX",description:"Returns the largest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"COUNT",description:"Counts the number of numeric values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTA",description:"Counts the number of non-empty values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTBLANK",description:"Counts empty cells",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTIF",description:"Counts values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"}]},{name:"SUMIF",description:"Sums values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"},{name:"sum_range",optional:!0}]},{name:"COUNTIFS",description:"Counts values that meet multiple criteria",args:[{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"SUMIFS",description:"Sums values that meet multiple criteria",args:[{name:"sum_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"TRIM",description:"Removes leading and trailing whitespace from text",args:[{name:"text"}]},{name:"LEN",description:"Returns the number of characters in a text string",args:[{name:"text"}]},{name:"LEFT",description:"Returns the leftmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"RIGHT",description:"Returns the rightmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"MID",description:"Returns characters from the middle of a text string",args:[{name:"text"},{name:"start_num"},{name:"num_chars"}]},{name:"CONCATENATE",description:"Joins two or more text strings into one",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"CONCAT",description:"Joins text values into one string",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"FIND",description:"Finds one text value inside another (case-sensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"SEARCH",description:"Finds one text value inside another (case-insensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"TEXTJOIN",description:"Joins text values with a delimiter",args:[{name:"delimiter"},{name:"ignore_empty"},{name:"text1"},{name:"text2",optional:!0,repeating:!0}]},{name:"LOWER",description:"Converts text to lowercase",args:[{name:"text"}]},{name:"UPPER",description:"Converts text to uppercase",args:[{name:"text"}]},{name:"PROPER",description:"Capitalizes each word in text",args:[{name:"text"}]},{name:"SUBSTITUTE",description:"Replaces existing text with new text in a string",args:[{name:"text"},{name:"search_for"},{name:"replace_with"},{name:"occurrence",optional:!0}]},{name:"TODAY",description:"Returns the current date",args:[]},{name:"NOW",description:"Returns the current date and time",args:[]},{name:"YEAR",description:"Returns the year from a date",args:[{name:"date"}]},{name:"MONTH",description:"Returns the month from a date (1-12)",args:[{name:"date"}]},{name:"DAY",description:"Returns the day of the month from a date (1-31)",args:[{name:"date"}]},{name:"ISBLANK",description:"Checks whether a value is blank",args:[{name:"value"}]},{name:"ISNUMBER",description:"Checks whether a value is a number",args:[{name:"value"}]},{name:"ISTEXT",description:"Checks whether a value is text",args:[{name:"value"}]},{name:"IFERROR",description:"Returns a value if no error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_error"}]}];function Bg(u){const e=u.toUpperCase();return ki.filter(t=>t.name.startsWith(e))}function Mg(u){const e=u.toUpperCase();return ki.find(t=>t.name===e)}function Ol(u){const e=u.args.map(t=>{let i=t.optional?`[${t.name}]`:t.name;return t.repeating&&(i+=", ..."),i});return`${u.name}(${e.join(", ")})`}function kg(u,e){if(!u.startsWith("="))return{type:"none"};const t=u.slice(1,e);let i=0,s=0;for(let r=t.length-1;r>=0;r--){const o=t[r];if(o===")")i++;else if(o==="(")if(i>0)i--;else{const l=t.slice(0,r).match(/([A-Za-z_]\w*)$/);return l?{type:"argument",funcName:l[1].toUpperCase(),argIndex:s}:{type:"none"}}else o===","&&i===0&&s++}const n=t.match(/([A-Za-z_]\w*)$/);return n?{type:"function-name",prefix:n[1]}:{type:"none"}}class zg{constructor(e="light"){k(this,"container");k(this,"theme");k(this,"selectedIndex",0);k(this,"matches",[]);k(this,"mode","hidden");k(this,"currentHint",null);this.theme=e,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.display="none",this.container.style.zIndex="1000",this.container.style.minWidth="220px",this.container.style.maxWidth="360px",this.container.style.borderRadius="4px",this.container.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)",this.container.style.padding="4px 0",this.container.style.fontSize="13px",this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.container.style.overflow="hidden",this.applyTheme()}getContainer(){return this.container}showList(e,t){if(this.matches=Bg(e),this.matches.length===0){this.hide();return}this.mode="list",this.selectedIndex=0,this.renderList(),this.positionAt(t),this.container.style.display="block"}showHint(e,t,i){const s=Mg(e);if(!s){this.hide();return}this.mode="hint",this.currentHint={info:s,argIndex:t},this.renderHint(),this.positionAt(i),this.container.style.display="block"}hide(){this.mode="hidden",this.matches=[],this.currentHint=null,this.container.style.display="none",this.container.innerHTML=""}moveUp(){this.mode!=="list"||this.matches.length===0||(this.selectedIndex=(this.selectedIndex-1+this.matches.length)%this.matches.length,this.renderList())}moveDown(){this.mode!=="list"||this.matches.length===0||(this.selectedIndex=(this.selectedIndex+1)%this.matches.length,this.renderList())}getSelectedFunction(){if(this.mode==="list")return this.matches[this.selectedIndex]}isListVisible(){return this.mode==="list"}isHintVisible(){return this.mode==="hint"}cleanup(){this.hide(),this.container.remove()}positionAt(e){this.container.style.left=`${e.left}px`,this.container.style.top=`${e.top}px`}renderList(){this.container.innerHTML="";const e=ve(this.theme,"cellBGColor"),t=ve(this.theme,"cellTextColor"),i=ve(this.theme,"selectionBGColor"),s=ve(this.theme,"activeCellColor");for(let n=0;n<this.matches.length;n++){const r=this.matches[n],o=document.createElement("div");o.style.padding="4px 10px",o.style.cursor="pointer",o.style.display="flex",o.style.flexDirection="column",o.style.gap="1px",o.style.backgroundColor=n===this.selectedIndex?i:e;const l=document.createElement("div");l.style.fontWeight="600",l.style.color=n===this.selectedIndex?s:t,l.textContent=r.name;const c=document.createElement("div");c.style.fontSize="11px",c.style.opacity="0.7",c.style.color=t,c.textContent=r.description,o.appendChild(l),o.appendChild(c),o.addEventListener("mouseenter",()=>{this.selectedIndex=n,this.renderList()}),o.addEventListener("mousedown",a=>{a.preventDefault(),a.stopPropagation()}),this.container.appendChild(o)}}renderHint(){if(this.container.innerHTML="",!this.currentHint)return;const{info:e,argIndex:t}=this.currentHint,i=ve(this.theme,"cellTextColor"),s=ve(this.theme,"activeCellColor"),n=document.createElement("div");n.style.padding="6px 10px",n.style.color=i,n.style.whiteSpace="nowrap";const r=document.createElement("span");r.style.fontWeight="600",r.textContent=e.name+"(",n.appendChild(r);for(let l=0;l<e.args.length;l++){l>0&&n.appendChild(document.createTextNode(", "));const c=e.args[l];let a=c.optional?`[${c.name}]`:c.name;c.repeating&&(a+=", ...");const h=document.createElement("span");(l===t||l===e.args.length-1&&c.repeating&&t>=l)&&(h.style.fontWeight="700",h.style.color=s),h.textContent=a,n.appendChild(h)}n.appendChild(document.createTextNode(")"));const o=document.createElement("div");o.style.fontSize="11px",o.style.opacity="0.7",o.style.color=i,o.style.padding="2px 10px 4px",o.textContent=Ol(e)+"  "+e.description,this.container.appendChild(n),this.container.appendChild(o)}applyTheme(){this.container.style.backgroundColor=ve(this.theme,"cellBGColor"),this.container.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`}}class jg{constructor(e="light"){k(this,"theme");k(this,"container");k(this,"panel");k(this,"searchInput");k(this,"status");k(this,"list");k(this,"rows",[]);k(this,"matches",[...ki]);k(this,"selectedIndex",0);k(this,"listTextColor","");k(this,"listSelectedBG","");k(this,"listActiveColor","");k(this,"onInsert");k(this,"onClose");k(this,"boundHandleBackdropMouseDown");k(this,"boundHandleSearchInput");k(this,"boundHandleSearchKeydown");k(this,"boundHandleListPointerDown");k(this,"boundHandleListClick");k(this,"boundHandleListMouseOver");this.theme=e,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.inset="0",this.container.style.display="none",this.container.style.zIndex="1100",this.container.style.backgroundColor="rgba(0, 0, 0, 0.18)",this.container.style.padding="40px 16px 16px",this.container.style.boxSizing="border-box",this.panel=document.createElement("div"),this.panel.style.margin="0 auto",this.panel.style.maxWidth="720px",this.panel.style.height="min(560px, calc(100vh - 72px))",this.panel.style.display="flex",this.panel.style.flexDirection="column",this.panel.style.backgroundColor=ve(this.theme,"cellBGColor"),this.panel.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.panel.style.borderRadius="8px",this.panel.style.boxShadow="0 10px 30px rgba(0, 0, 0, 0.2)",this.panel.style.color=ve(this.theme,"cellTextColor"),this.panel.style.overflow="hidden";const t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between",t.style.padding="12px 14px",t.style.borderBottom=`1px solid ${ve(this.theme,"cellBorderColor")}`;const i=document.createElement("div");i.textContent="Functions",i.style.font="600 14px Arial",t.appendChild(i);const s=document.createElement("button");s.type="button",s.textContent="Close",s.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`,s.style.borderRadius="4px",s.style.backgroundColor=ve(this.theme,"cellBGColor"),s.style.color=ve(this.theme,"cellTextColor"),s.style.padding="4px 8px",s.style.font="12px Arial",s.style.cursor="pointer",s.addEventListener("click",()=>this.hide()),t.appendChild(s);const n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.gap="6px",n.style.padding="12px 14px 10px",n.style.borderBottom=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.searchInput=document.createElement("input"),this.searchInput.type="text",this.searchInput.placeholder="Search by name or description",this.searchInput.style.width="100%",this.searchInput.style.boxSizing="border-box",this.searchInput.style.padding="7px 10px",this.searchInput.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.searchInput.style.borderRadius="4px",this.searchInput.style.outline="none",this.searchInput.style.font="13px Arial",this.searchInput.style.color=ve(this.theme,"cellTextColor"),this.searchInput.style.backgroundColor=ve(this.theme,"cellBGColor"),n.appendChild(this.searchInput),this.status=document.createElement("div"),this.status.style.font="12px Arial",this.status.style.opacity="0.75",n.appendChild(this.status),this.list=document.createElement("div"),this.list.style.flex="1",this.list.style.overflow="auto",this.list.style.padding="6px 0",this.panel.appendChild(t),this.panel.appendChild(n),this.panel.appendChild(this.list),this.container.appendChild(this.panel),this.boundHandleBackdropMouseDown=r=>{r.target===this.container&&this.hide()},this.boundHandleSearchInput=()=>{this.selectedIndex=0,this.filterAndRender()},this.boundHandleSearchKeydown=r=>{if(r.key==="ArrowDown"){r.preventDefault(),this.matches.length>0&&(this.setSelectedIndex((this.selectedIndex+1)%this.matches.length),this.scrollSelectedIntoView());return}if(r.key==="ArrowUp"){r.preventDefault(),this.matches.length>0&&(this.setSelectedIndex((this.selectedIndex-1+this.matches.length)%this.matches.length),this.scrollSelectedIntoView());return}if(r.key==="Enter"){r.preventDefault(),this.insertSelected();return}r.key==="Escape"&&(r.preventDefault(),this.hide())},this.boundHandleListPointerDown=r=>{if(r.button!==0)return;const o=this.getRowIndexFromTarget(r.target);o!==null&&(r.preventDefault(),this.setSelectedIndex(o),this.insertSelected())},this.boundHandleListClick=r=>{if(r.button!==0||!this.isVisible())return;const o=this.getRowIndexFromTarget(r.target);o!==null&&(r.preventDefault(),this.setSelectedIndex(o),this.insertSelected())},this.boundHandleListMouseOver=r=>{const o=this.getRowIndexFromTarget(r.target);o===null||o===this.selectedIndex||this.setSelectedIndex(o)},this.container.addEventListener("mousedown",this.boundHandleBackdropMouseDown),this.searchInput.addEventListener("input",this.boundHandleSearchInput),this.searchInput.addEventListener("keydown",this.boundHandleSearchKeydown),this.list.addEventListener("pointerdown",this.boundHandleListPointerDown),this.list.addEventListener("click",this.boundHandleListClick),this.list.addEventListener("mouseover",this.boundHandleListMouseOver),this.filterAndRender()}getContainer(){return this.container}setOnInsert(e){this.onInsert=e}setOnClose(e){this.onClose=e}contains(e){return e instanceof Node&&this.container.contains(e)}isVisible(){return this.container.style.display!=="none"}show(){this.searchInput.value="",this.selectedIndex=0,this.filterAndRender(),this.container.style.display="block",requestAnimationFrame(()=>this.searchInput.focus())}hide(){var e;this.isVisible()&&(this.container.style.display="none",(e=this.onClose)==null||e.call(this))}cleanup(){this.container.removeEventListener("mousedown",this.boundHandleBackdropMouseDown),this.searchInput.removeEventListener("input",this.boundHandleSearchInput),this.searchInput.removeEventListener("keydown",this.boundHandleSearchKeydown),this.list.removeEventListener("pointerdown",this.boundHandleListPointerDown),this.list.removeEventListener("click",this.boundHandleListClick),this.list.removeEventListener("mouseover",this.boundHandleListMouseOver),this.container.remove()}filterAndRender(){const e=this.searchInput.value.trim().toUpperCase();this.matches=e.length===0?[...ki]:ki.filter(t=>{const i=t.name.toUpperCase(),s=t.description.toUpperCase(),n=Ol(t).toUpperCase();return i.includes(e)||s.includes(e)||n.includes(e)}),this.selectedIndex>=this.matches.length&&(this.selectedIndex=Math.max(0,this.matches.length-1)),this.renderList()}renderList(){if(this.list.innerHTML="",this.rows=[],this.status.textContent=`${this.matches.length} functions`,this.matches.length===0){const t=document.createElement("div");t.textContent="No matching functions",t.style.padding="16px 14px",t.style.font="13px Arial",t.style.opacity="0.8",this.list.appendChild(t);return}const e=ve(this.theme,"cellBorderColor");this.listTextColor=ve(this.theme,"cellTextColor"),this.listSelectedBG=ve(this.theme,"selectionBGColor"),this.listActiveColor=ve(this.theme,"activeCellColor");for(let t=0;t<this.matches.length;t++){const i=this.matches[t],s=document.createElement("div");s.dataset.funcName=i.name,s.dataset.funcIndex=String(t),s.style.display="flex",s.style.gap="10px",s.style.alignItems="flex-start",s.style.justifyContent="flex-start",s.style.padding="10px 14px",s.style.cursor="pointer",s.style.borderBottom=`1px solid ${e}`,s.style.backgroundColor="transparent";const n=document.createElement("div");n.style.minWidth="0",n.style.flex="1";const r=document.createElement("div");r.textContent=i.name,r.style.font="600 13px Arial",r.style.color=this.listTextColor;const o=document.createElement("div");o.textContent=Ol(i),o.style.font="12px Arial",o.style.opacity="0.82",o.style.marginTop="2px",o.style.wordBreak="break-word";const l=document.createElement("div");l.textContent=i.description,l.style.font="12px Arial",l.style.opacity="0.72",l.style.marginTop="2px",l.style.wordBreak="break-word",n.appendChild(r),n.appendChild(o),n.appendChild(l),s.appendChild(n),this.list.appendChild(s),this.rows.push({row:s,name:r})}this.updateRowSelection(this.selectedIndex)}scrollSelectedIntoView(){var t;const e=(t=this.rows[this.selectedIndex])==null?void 0:t.row;e&&e.scrollIntoView({block:"nearest"})}getRowIndexFromTarget(e){if(!(e instanceof Element))return null;const t=e.closest("[data-func-index]");if(!(t instanceof HTMLDivElement)||!this.list.contains(t))return null;const i=Number(t.dataset.funcIndex);return Number.isInteger(i)?i:null}setSelectedIndex(e){if(e===this.selectedIndex||e<0||e>=this.matches.length)return;const t=this.selectedIndex;this.selectedIndex=e,this.updateRowSelection(t),this.updateRowSelection(e)}updateRowSelection(e){const t=this.rows[e];if(!t)return;const i=e===this.selectedIndex;t.row.style.backgroundColor=i?this.listSelectedBG:"transparent",t.name.style.color=i?this.listActiveColor:this.listTextColor}insertSelected(){var t;const e=this.matches[this.selectedIndex];e&&((t=this.onInsert)==null||t.call(this,e),this.hide())}}const zf=u=>u.length===1?u.toLowerCase():u,Fl=u=>u.metaKey||u.ctrlKey,Fe=(u,e)=>zf(u.key)===zf(e),nt=(u,e)=>!(!Fe(u,e.key)||e.mod!==void 0&&Fl(u)!==e.mod||e.shift!==void 0&&u.shiftKey!==e.shift||e.alt!==void 0&&u.altKey!==e.alt),jf=async(u,e)=>{for(const t of e)if(t.match(u))return await t.run(u),!0;return!1},eo=6,qg=10,qf=20,Uf=120,Hf=300,Ug=1800,Wn=8,to=4,Hg=200;class $g{constructor(e,t="light",i=!1){k(this,"sheet");k(this,"theme");k(this,"container");k(this,"formulaBar");k(this,"cellInput");k(this,"overlay");k(this,"gridContainer");k(this,"gridCanvas");k(this,"contextMenu");k(this,"autocomplete");k(this,"functionBrowser");k(this,"resizeTooltip");k(this,"filterPanel");k(this,"filterPanelState",null);k(this,"filterPanelOutsideClickUnsub",null);k(this,"filterPanelKeyboardUnsub",null);k(this,"rowDim");k(this,"colDim");k(this,"hiddenRows",new Set);k(this,"hiddenRowSizeBackup",new Map);k(this,"listeners",[]);k(this,"interactionCleanups",new Set);k(this,"resizeObserver");k(this,"preventDocumentSelectStart",e=>{e.preventDefault()});k(this,"resizeHover",null);k(this,"dragMove",null);k(this,"editMode",!1);k(this,"manuallyResizedRows",new Set);k(this,"formulaRanges",[]);k(this,"freezeState",jn);k(this,"freezeHandleHover",null);k(this,"filterButtonHoverCol",null);k(this,"freezeDrag",null);k(this,"autofillPreview");k(this,"onRenderCallback");k(this,"readOnly");k(this,"formulaRangeAnchor",null);k(this,"activeFormulaInput",null);k(this,"formulaRefInsertPos",null);k(this,"lastFormulaRefTarget",null);k(this,"nativeSelectionBlockDepth",0);k(this,"previousBodyUserSelect","");k(this,"previousBodyWebkitUserSelect","");k(this,"pendingRenderFrame",null);k(this,"renderInFlight",!1);k(this,"renderQueued",!1);k(this,"renderVersion",0);this.container=e,this.theme=t,this.readOnly=i,this.formulaBar=new _g(t),this.gridContainer=new Dg(t),this.overlay=new Pg(t),this.gridCanvas=new wl(t),this.cellInput=new Fg(t),this.contextMenu=new Lg(t),this.autocomplete=new zg(t),this.functionBrowser=new jg(t),this.resizeTooltip=document.createElement("div"),this.filterPanel=document.createElement("div"),this.rowDim=new Of(oe),this.colDim=new Of(at),this.gridContainer.appendChild(this.overlay.getContainer()),this.gridContainer.appendChild(this.gridCanvas.getCanvas()),this.gridContainer.appendChild(this.cellInput.getContainer()),this.container.appendChild(this.formulaBar.getContainer()),this.container.appendChild(this.gridContainer.getContainer()),this.container.appendChild(this.contextMenu.getContainer()),this.container.appendChild(this.autocomplete.getContainer()),document.body.appendChild(this.functionBrowser.getContainer()),this.resizeTooltip.style.position="fixed",this.resizeTooltip.style.display="none",this.resizeTooltip.style.pointerEvents="none",this.resizeTooltip.style.zIndex="1001",this.resizeTooltip.style.padding="4px 8px",this.resizeTooltip.style.borderRadius="4px",this.resizeTooltip.style.border=`1px solid ${ve(t,"cellBorderColor")}`,this.resizeTooltip.style.backgroundColor=ve(t,"cellBGColor"),this.resizeTooltip.style.color=ve(t,"cellTextColor"),this.resizeTooltip.style.fontSize="11px",this.resizeTooltip.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.resizeTooltip.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)",document.body.appendChild(this.resizeTooltip),this.filterPanel.style.position="fixed",this.filterPanel.style.display="none",this.filterPanel.style.zIndex="1002",this.filterPanel.style.width="260px",this.filterPanel.style.maxHeight="360px",this.filterPanel.style.overflow="hidden",this.filterPanel.style.borderRadius="6px",this.filterPanel.style.border=`1px solid ${ve(t,"cellBorderColor")}`,this.filterPanel.style.backgroundColor=ve(t,"cellBGColor"),this.filterPanel.style.color=ve(t,"cellTextColor"),this.filterPanel.style.fontSize="12px",this.filterPanel.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.filterPanel.style.boxShadow="0 4px 14px rgba(0, 0, 0, 0.2)",document.body.appendChild(this.filterPanel),this.functionBrowser.setOnInsert(s=>{this.readOnly||this.insertFunctionFromBrowser(s.name)}),this.resizeObserver=new ResizeObserver(()=>this.render())}async initialize(e){this.sheet=e,this.sheet.setDimensions(this.rowDim,this.colDim),await this.sheet.loadDimensions(),await this.sheet.loadStyles(),await this.sheet.loadMerges(),await this.sheet.loadFreezePane(),await this.sheet.loadFilterState(),this.hiddenRows.clear(),this.hiddenRowSizeBackup.clear(),this.syncHiddenRowsFromSheet(),this.updateFreezeState(),this.formulaBar.initialize(e),this.addEventListeners(),this.resizeObserver.observe(this.container),this.render()}updateFreezeState(){const{frozenRows:e,frozenCols:t}=this.sheet.getFreezePane();this.freezeState=Rg(e,t,this.rowDim,this.colDim)}async setFreezePane(e,t){await this.sheet.setFreezePane(e,t),this.updateFreezeState(),this.render()}async reloadFreezePane(){await this.sheet.loadFreezePane(),this.updateFreezeState()}panBy(e,t){this.gridContainer.scrollBy(e,t)}handleMobileDoubleTap(e,t){const{x:i,y:s}=this.clampClientPointToViewport(e,t);this.handleDblClickAt(i,s)}cleanup(){this.pendingRenderFrame!==null&&(cancelAnimationFrame(this.pendingRenderFrame),this.pendingRenderFrame=null),this.cancelActiveInteractions(),this.removeAllEventListeners(),this.forceEndNativeSelectionBlock(),this.resizeObserver.disconnect(),this.formulaBar.cleanup(),this.cellInput.cleanup(),this.overlay.cleanup(),this.gridCanvas.cleanup(),this.gridContainer.cleanup(),this.contextMenu.cleanup(),this.autocomplete.cleanup(),this.functionBrowser.cleanup(),this.resizeTooltip.remove(),this.hideFilterPanel(),this.filterPanel.remove(),this.sheet=void 0,this.container.innerHTML=""}beginNativeSelectionBlock(){if(this.nativeSelectionBlockDepth+=1,this.nativeSelectionBlockDepth!==1)return;const e=document.body.style;this.previousBodyUserSelect=e.userSelect,this.previousBodyWebkitUserSelect=e.webkitUserSelect,e.userSelect="none",e.webkitUserSelect="none",document.addEventListener("selectstart",this.preventDocumentSelectStart)}endNativeSelectionBlock(){if(this.nativeSelectionBlockDepth===0||(this.nativeSelectionBlockDepth-=1,this.nativeSelectionBlockDepth>0))return;const e=document.body.style;e.userSelect=this.previousBodyUserSelect,e.webkitUserSelect=this.previousBodyWebkitUserSelect,document.removeEventListener("selectstart",this.preventDocumentSelectStart)}forceEndNativeSelectionBlock(){this.nativeSelectionBlockDepth!==0&&(this.nativeSelectionBlockDepth=1,this.endNativeSelectionBlock())}showResizeTooltip(e,t,i,s,n){const r=e==="column"?"Width":"Height",o=n>1?` (${n} ${e==="column"?"columns":"rows"})`:"";this.resizeTooltip.textContent=`${r}: ${Math.round(t)}px${o}`,this.resizeTooltip.style.left=`${i+12}px`,this.resizeTooltip.style.top=`${s+12}px`,this.resizeTooltip.style.display="block"}hideResizeTooltip(){this.resizeTooltip.style.display="none"}bindEventListener(e,t,i,s){e.addEventListener(t,i,s);let n=!0;return()=>{n&&(n=!1,e.removeEventListener(t,i,s))}}addEventListener(e,t,i,s){const n=this.bindEventListener(e,t,i,s);return this.listeners.push(n),n}registerInteractionCleanup(e){let t=!0;const i=()=>{t&&(t=!1,this.interactionCleanups.delete(i),e())};return this.interactionCleanups.add(i),i}addInteractionEventListener(e,t,i,s){const n=this.bindEventListener(e,t,i,s);return this.registerInteractionCleanup(n)}startMouseDragSession({onMove:e,onComplete:t,onCleanup:i}){let s=()=>{};const n=()=>{try{t==null||t()}finally{s()}},r=this.addInteractionEventListener(document,"mousemove",e),o=this.addInteractionEventListener(document,"mouseup",n);return s=this.registerInteractionCleanup(()=>{r(),o(),i==null||i()}),s}cancelActiveInteractions(){for(const e of Array.from(this.interactionCleanups))e()}removeAllEventListeners(){for(const e of this.listeners)e();this.listeners=[]}focusGrid(){var e;this.formulaBar.blur(),this.cellInput.hide(),this.autocomplete.hide(),this.functionBrowser.hide(),this.formulaRanges=[],this.resetFormulaRangeState(),(e=window.getSelection())==null||e.removeAllRanges()}async finishEditing(){this.autocomplete.hide(),this.functionBrowser.hide();const e=this.sheet.getActiveCell();if(this.formulaBar.isFocused())await this.sheet.setData(e,this.formulaBar.getValue()),this.formulaBar.blur(),this.cellInput.hide();else if(this.cellInput.isFocused())await this.sheet.setData(e,this.cellInput.getValue()),this.cellInput.hide();else return;this.formulaRanges=[],this.resetFormulaRangeState(),await this.autoResizeRow(e.r)}isExternalInput(e){if(this.functionBrowser.contains(e))return!0;if(!(e instanceof Element)||this.container.contains(e))return!1;const t=e.tagName;return!!(t==="INPUT"||t==="TEXTAREA"||t==="SELECT"||e.isContentEditable)}handleKeyDown(e){if(this.functionBrowser.isVisible()){e.key==="Escape"&&(e.preventDefault(),this.functionBrowser.hide());return}if(!this.isExternalInput(e.target)){if(this.formulaBar.isFocused()){this.handleFormulaKeydown(e);return}else if(this.cellInput.isFocused()){this.handleCellInputKeydown(e);return}this.handleGridKeydown(e)}}handleKeyUp(e){if(this.functionBrowser.isVisible()||this.isExternalInput(e.target))return;const i=(e.key==="ArrowDown"||e.key==="ArrowUp"||e.key==="Escape"||e.key==="Enter"||e.key==="Tab")&&(this.autocomplete.isListVisible()||this.autocomplete.isHintVisible());let s,n;this.formulaBar.isFocused()?(s=this.formulaBar.getValue(),n=this.formulaBar.getFormulaInput(),this.cellInput.setValue(s)):this.cellInput.isFocused()&&(s=this.cellInput.getValue(),n=this.cellInput.getInput(),this.formulaBar.setValue(s)),s!==void 0&&s.startsWith("=")?(this.formulaRanges=wi(s).map(r=>r.range),this.renderOverlay()):s!==void 0&&(this.formulaRanges=[],this.renderOverlay()),!i&&(n&&s!==void 0?this.updateAutocomplete(s,n):this.autocomplete.hide())}updateAutocomplete(e,t){if(!e.startsWith("=")){this.autocomplete.hide();return}const i=dr(t);if(!i){this.autocomplete.hide();return}const s=i.end,n=kg(e,s),r=t.getBoundingClientRect(),o={left:r.left,top:r.bottom+2};n.type==="function-name"?this.autocomplete.showList(n.prefix,o):n.type==="argument"?this.autocomplete.showHint(n.funcName,n.argIndex,o):this.autocomplete.hide()}toggleFunctionBrowser(){if(this.functionBrowser.isVisible()){this.functionBrowser.hide();return}this.autocomplete.hide(),this.functionBrowser.show()}insertFunctionCompletion(e,t){const i=t.innerText,s=dr(t);if(!s)return;const n=s.end,o=i.slice(0,n).match(/([A-Za-z_]\w*)$/);if(!o)return;const l=n-o[1].length,c=i.slice(n),a=i.slice(0,l)+e+"("+c;this.formulaBar.setValue(a),this.cellInput.setValue(a);const h=l+e.length+1;Ar(t,{start:h,end:h}),this.autocomplete.hide(),this.updateAutocomplete(a,t)}async insertFunctionFromBrowser(e){const t=await this.getInputForFunctionInsert(),i=t.innerText,s=dr(t);let n,r;if(!i.startsWith("="))n=`=${e}(`,r=n.length;else{const o=(s==null?void 0:s.start)??i.length,l=(s==null?void 0:s.end)??i.length;n=i.slice(0,o)+e+"("+i.slice(l),r=o+e.length+1}this.formulaBar.setValue(n),this.cellInput.setValue(n),Ar(t,{start:r,end:r}),t.focus(),this.formulaRanges=wi(n).map(o=>o.range),this.renderOverlay(),this.autocomplete.hide(),this.updateAutocomplete(n,t)}async getInputForFunctionInsert(){if(this.cellInput.isFocused())return this.cellInput.getInput();const e=this.cellInput.getInput(),t=this.formulaBar.getFormulaInput(),i=t.innerText,s=dr(t);this.cellInput.isShown()||await this.showCellInput(!0,!0),this.cellInput.setValue(i);const n=(s==null?void 0:s.end)??i.length;return Ar(e,{start:n,end:n}),this.cellInput.isFocused()||e.focus(),e}isInFormulaRangeMode(){let e,t;if(this.cellInput.isFocused()?(e=this.cellInput.getValue(),t=this.cellInput.getInput()):this.formulaBar.isFocused()&&(e=this.formulaBar.getValue(),t=this.formulaBar.getFormulaInput()),!e||!t||!e.startsWith("="))return!1;const i=dr(t);return i?jm(e,i.end):!1}insertReferenceAtCursor(e,t){const i=this.cellInput.isFocused(),s=this.formulaBar.isFocused();if(!i&&!s)return;const n=i?this.cellInput.getInput():this.formulaBar.getFormulaInput(),r=n.innerText,o=dr(n);if(!o)return;const l=t&&(e.r!==t.r||e.c!==t.c)?xe(e)+":"+xe(t):xe(e);let c,a;if(this.formulaRefInsertPos){const{start:h,end:f}=this.formulaRefInsertPos;c=r.slice(0,h)+l+r.slice(f),a=h+l.length,this.formulaRefInsertPos={start:h,end:a}}else{const h=Nf(r,o.end);h?(c=r.slice(0,h.start)+l+r.slice(h.end),a=h.start+l.length,this.formulaRefInsertPos={start:h.start,end:a}):o.start!==o.end?(c=r.slice(0,o.start)+l+r.slice(o.end),a=o.start+l.length,this.formulaRefInsertPos={start:o.start,end:a}):(c=r.slice(0,o.end)+l+r.slice(o.end),a=o.end+l.length,this.formulaRefInsertPos={start:o.end,end:a})}this.formulaBar.setValue(c),this.cellInput.setValue(c),Ar(n,{start:a,end:a}),c.startsWith("=")&&(this.formulaRanges=wi(c).map(h=>h.range),this.renderOverlay()),this.lastFormulaRefTarget=t||e}toggleAbsoluteReference(e){const t=e.innerText;if(!t.startsWith("="))return;const i=dr(e);if(!i)return;const s=Nf(t,i.end);if(!s)return;const n=s.text,r=n.startsWith("$"),o=n.replace(/\$/g,"");let l=0;for(let x=0;x<o.length;x++)if(o.charCodeAt(x)>=48&&o.charCodeAt(x)<=57){l=x;break}const c=o.slice(0,l),a=o.slice(l),h=n.indexOf(a,n.lastIndexOf(c)+c.length),f=h>0&&n[h-1]==="$";let d;!r&&!f?d="$"+c+"$"+a:r&&f?d=c+"$"+a:!r&&f?d="$"+c+a:d=c+a;const p=t.slice(0,s.start)+d+t.slice(s.end),v=s.start+d.length;this.formulaBar.setValue(p),this.cellInput.setValue(p),Ar(e,{start:v,end:v}),p.startsWith("=")&&(this.formulaRanges=wi(p).map(x=>x.range),this.renderOverlay())}resetFormulaRangeState(){this.formulaRangeAnchor=null,this.activeFormulaInput=null,this.formulaRefInsertPos=null,this.lastFormulaRefTarget=null}handleDblClick(e){e.preventDefault(),this.handleDblClickAt(e.offsetX,e.offsetY)}handleDblClickAt(e,t){if(this.readOnly)return;const i=this.detectFreezeHandle(e,t);if(i){const n=this.sheet.getFreezePane();i==="row"?this.setFreezePane(n.frozenRows>0?0:1,n.frozenCols):this.setFreezePane(n.frozenRows,n.frozenCols>0?0:1);return}const s=this.detectResizeEdge(e,t);if(s){this.autoFitSize(s.axis,s.index);return}this.showCellInput()}handleContextMenu(e){if(this.readOnly)return;const t=e.offsetX,i=e.offsetY,s=t<ue,n=i<oe;if(!(!s&&!n)){if(e.preventDefault(),s){const r=this.toRowFromMouse(i);if(r<1)return;const o=this.sheet.getSelectedIndices(),l=o&&o.axis==="row"&&r>=o.from&&r<=o.to,c=l?o.from:r,a=l?o.to-o.from+1:1,h=a>1?`${a} rows`:"row";this.contextMenu.show(e.clientX,e.clientY,[{label:`Insert ${h} above`,action:()=>{this.sheet.insertRows(c,a).then(()=>this.render())}},{label:`Insert ${h} below`,action:()=>{this.sheet.insertRows(c+a,a).then(()=>this.render())}},{label:`Delete ${h}`,action:()=>{this.sheet.deleteRows(c,a).then(()=>this.render())}}])}else if(n){const r=this.toColFromMouse(t);if(r<1)return;const o=this.sheet.getSelectedIndices(),l=o&&o.axis==="column"&&r>=o.from&&r<=o.to,c=l?o.from:r,a=l?o.to-o.from+1:1,h=a>1?`${a} columns`:"column",f=[{label:`Insert ${h} left`,action:()=>{this.sheet.insertColumns(c,a).then(()=>this.render())}},{label:`Insert ${h} right`,action:()=>{this.sheet.insertColumns(c+a,a).then(()=>this.render())}},{label:`Delete ${h}`,action:()=>{this.sheet.deleteColumns(c,a).then(()=>this.render())}}];this.contextMenu.show(e.clientX,e.clientY,f)}}}getFilterButtonRect(e){var o;const t=(o=this.sheet)==null?void 0:o.getFilterRange();if(!t)return null;const i=t[0].r,s=this.getCellRect({r:i,c:e});if(s.width<=6||s.height<=6)return null;const n=Math.min(16,Math.max(12,s.width-4)),r=Math.min(16,Math.max(12,s.height-6));return{left:s.left+s.width-n-2,top:s.top+Math.max(3,(s.height-r)/2),width:n,height:r}}detectFilterButton(e,t){if(!this.sheet||!this.sheet.hasFilter()||e<=ue||t<=oe)return null;const i=this.sheet.getFilterRange();if(!i)return null;const s=this.toRefFromMouse(e,t);if(s.r!==i[0].r||!this.sheet.isColumnInFilter(s.c))return null;const n=this.getFilterButtonRect(s.c);return!n||e<n.left-2||e>n.left+n.width+2||t<n.top-2||t>n.top+n.height+2?null:s.c}async showFilterPanel(e,t){var p,v;if(!this.sheet||!this.sheet.isColumnInFilter(e))return;const i=await this.sheet.getFilterColumnValues(e);if(!i)return;const s=this.sheet.getColumnFilterCondition(e),n=s&&s.op!=="in"&&s.op!=="isEmpty"&&s.op!=="isNotEmpty",r=t==="condition"||n?"condition":"values",o=s?{...s,values:s.values?[...s.values]:void 0}:{op:"contains",value:""};this.filterPanelState={col:e,values:i.values,selected:new Set(i.selected),initialSelected:new Set(i.selected),search:"",mode:r,condition:{...o,values:o.values?[...o.values]:void 0},initialCondition:o,hasExistingCondition:!!s},this.renderFilterPanel();const l=this.getFilterButtonRect(e);if(!l)return;const c=this.viewport,h=Math.min(c.left+Math.max(ue,l.left-6),c.left+Math.max(0,c.width-260-4)),f=c.top+l.top+l.height+4;this.filterPanel.style.left=`${h}px`,this.filterPanel.style.top=`${f}px`,this.filterPanel.style.display="block",(p=this.filterPanelKeyboardUnsub)==null||p.call(this);const d=x=>{if(!this.filterPanelState)return;const y=x.target,g=y?this.filterPanel.contains(y):!1;if(x.key==="Escape"){x.preventDefault(),x.stopPropagation(),this.hideFilterPanel();return}x.key==="Enter"&&g&&(x.preventDefault(),x.stopPropagation(),this.applyFilterPanel())};document.addEventListener("keydown",d,!0),this.filterPanelKeyboardUnsub=()=>{document.removeEventListener("keydown",d,!0)},(v=this.filterPanelOutsideClickUnsub)==null||v.call(this),requestAnimationFrame(()=>{if(!this.filterPanelState)return;const x=y=>{this.filterPanel.contains(y.target)||this.hideFilterPanel()};document.addEventListener("mousedown",x),this.filterPanelOutsideClickUnsub=()=>{document.removeEventListener("mousedown",x)}})}hideFilterPanel(){var e,t;this.filterPanel.style.display="none",this.filterPanel.innerHTML="",this.filterPanelState=null,(e=this.filterPanelOutsideClickUnsub)==null||e.call(this),this.filterPanelOutsideClickUnsub=null,(t=this.filterPanelKeyboardUnsub)==null||t.call(this),this.filterPanelKeyboardUnsub=null}areStringSetsEqual(e,t){if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}areFilterConditionsEqual(e,t){if(e.op!==t.op)return!1;if(e.op==="in"){const i=Array.from(new Set(e.values||[])).sort(),s=Array.from(new Set(t.values||[])).sort();if(i.length!==s.length)return!1;for(let n=0;n<i.length;n++)if(i[n]!==s[n])return!1;return!0}return e.op==="isEmpty"||e.op==="isNotEmpty"?!0:(e.value||"").trim()===(t.value||"").trim()}isFilterPanelDirty(e){return e.mode==="values"?!this.areStringSetsEqual(e.selected,e.initialSelected):!this.areFilterConditionsEqual(e.condition,e.initialCondition)}async applyFilterPanel(){const e=this.filterPanelState;if(!(!e||!this.sheet)&&this.isFilterPanelDirty(e)){if(e.mode==="values"){await this.sheet.setColumnIncludedValues(e.col,Array.from(e.selected)),this.hideFilterPanel(),this.render();return}await this.sheet.setColumnFilter(e.col,e.condition),this.hideFilterPanel(),this.render()}}syncFilterPanelApplyButtonState(){const e=this.filterPanelState;if(!e)return;const t=this.filterPanel.querySelector('button[data-wb-filter-apply="true"]');if(!t)return;const i=this.isFilterPanelDirty(e);t.disabled=!i,t.style.opacity=i?"1":"0.5",t.style.cursor=i?"pointer":"not-allowed"}syncFilterPanelValuesSelectionState(e){const t=this.filterPanelState;if(!t)return;const i=this.filterPanel.querySelector('[data-wb-filter-summary="true"]');if(i){const n=t.values.filter(r=>t.selected.has(r)).length;i.textContent=`Selected ${n} / ${t.values.length}`}const s=this.filterPanel.querySelector('input[data-wb-filter-select-all="true"]');if(s){const n=e.filter(r=>t.selected.has(r)).length;s.checked=e.length>0&&n===e.length,s.indeterminate=n>0&&n<e.length}this.syncFilterPanelApplyButtonState()}renderFilterPanel(){var N;const e=this.filterPanelState;if(!e)return;const t=document.activeElement,i=t instanceof HTMLInputElement&&t.dataset.wbFilterSearch==="true",s=i?t.selectionStart:null,n=i?t.selectionEnd:null,r=ve(this.theme,"cellBorderColor"),o=ve(this.theme,"selectionBGColor"),l=R=>{const P=document.createElement("button");return P.type="button",P.textContent=R,P.style.height="26px",P.style.padding="0 8px",P.style.border=`1px solid ${r}`,P.style.borderRadius="4px",P.style.background="transparent",P.style.color="inherit",P.style.cursor="pointer",P};this.filterPanel.innerHTML="";const c=document.createElement("div");c.style.display="flex",c.style.flexDirection="column",c.style.maxHeight="360px",c.style.height=e.mode==="values"?"360px":"auto",c.style.overflow="hidden";const a=document.createElement("div");a.style.padding="8px 10px",a.style.borderBottom=`1px solid ${r}`,a.style.fontWeight="600",a.textContent=`Filter ${Jn(e.col)}`,c.appendChild(a);const h=document.createElement("div");h.textContent="Sort",h.style.padding="8px 10px 4px",h.style.fontSize="11px",h.style.opacity="0.7",c.appendChild(h);const f=document.createElement("div");f.style.display="flex",f.style.flexWrap="wrap",f.style.gap="6px",f.style.padding="8px 10px 6px";const d=l("Sort A to Z");d.onclick=()=>{this.sheet.sortFilterByColumn(e.col,"asc").then(R=>{R&&(this.hideFilterPanel(),this.render())})};const p=l("Sort Z to A");p.onclick=()=>{this.sheet.sortFilterByColumn(e.col,"desc").then(R=>{R&&(this.hideFilterPanel(),this.render())})},f.append(d,p),c.appendChild(f);const v=document.createElement("div");v.textContent="Filter",v.style.padding="0 10px 4px",v.style.fontSize="11px",v.style.opacity="0.7",c.appendChild(v);const x=document.createElement("div");x.style.display="flex",x.style.flexWrap="wrap",x.style.gap="6px",x.style.padding="0 10px 8px";const y=(R,P)=>{const I=l(R);return e.mode===P&&(I.style.background=o),I.onclick=()=>{this.filterPanelState&&(this.filterPanelState.mode=P,this.renderFilterPanel())},I};x.append(y("Filter by values","values"),y("Filter by condition","condition")),c.appendChild(x);const g=document.createElement("div");if(g.style.flex="1",g.style.minHeight="0",g.style.padding="0 10px",g.style.display="flex",g.style.flexDirection="column",c.appendChild(g),e.mode==="values"){const R=document.createElement("input");R.type="text",R.dataset.wbFilterSearch="true",R.value=e.search,R.placeholder="Search values",R.style.width="100%",R.style.margin="0 0 8px",R.style.height="28px",R.style.padding="0 8px",R.style.border=`1px solid ${r}`,R.style.borderRadius="4px",R.style.background="transparent",R.style.color="inherit",R.oninput=()=>{this.filterPanelState&&(this.filterPanelState.search=R.value,this.renderFilterPanel())},g.appendChild(R);const P=e.values,I=P.filter(Y=>e.selected.has(Y)).length,B=document.createElement("div");B.dataset.wbFilterSummary="true",B.textContent=`Selected ${I} / ${P.length}`,B.style.margin="0 0 8px",B.style.fontSize="11px",B.style.opacity="0.7",g.appendChild(B);const V=e.search.trim().toLowerCase(),ee=P.filter(Y=>V?(Y===""?"(Blanks)":Y).toLowerCase().includes(V):!0).slice(0,Hg),te=document.createElement("div");te.style.flex="1",te.style.minHeight="0",te.style.border=`1px solid ${r}`,te.style.borderRadius="4px",te.style.overflow="auto";const le=ee.filter(Y=>e.selected.has(Y)).length,ge=document.createElement("label");ge.style.display="flex",ge.style.alignItems="center",ge.style.gap="8px",ge.style.padding="6px 8px",ge.style.borderBottom=`1px solid ${r}`,ge.style.cursor="pointer";const ce=document.createElement("input");ce.type="checkbox",ce.dataset.wbFilterSelectAll="true",ce.checked=ee.length>0&&le===ee.length,ce.indeterminate=le>0&&le<ee.length,ce.onchange=()=>{if(this.filterPanelState){if(ce.checked)for(const Y of ee)this.filterPanelState.selected.add(Y);else for(const Y of ee)this.filterPanelState.selected.delete(Y);this.renderFilterPanel()}};const Z=document.createElement("span");if(Z.textContent="Select all",ge.append(ce,Z),te.appendChild(ge),ee.length===0){const Y=document.createElement("div");Y.style.padding="10px",Y.style.opacity="0.7",Y.textContent="No values",te.appendChild(Y)}else for(const Y of ee){const Q=document.createElement("label");Q.style.display="flex",Q.style.alignItems="center",Q.style.gap="8px",Q.style.padding="6px 8px",Q.style.cursor="pointer";const ie=document.createElement("input");ie.type="checkbox",ie.checked=e.selected.has(Y),ie.onchange=()=>{this.filterPanelState&&(ie.checked?this.filterPanelState.selected.add(Y):this.filterPanelState.selected.delete(Y),this.syncFilterPanelValuesSelectionState(ee))};const E=document.createElement("span");E.textContent=Y===""?"(Blanks)":Y,E.style.overflow="hidden",E.style.textOverflow="ellipsis",E.style.whiteSpace="nowrap",Q.append(ie,E),te.appendChild(Q)}g.appendChild(te)}else{const R=document.createElement("div");R.style.display="grid",R.style.gap="8px";const P=document.createElement("select");P.style.height="30px",P.style.border=`1px solid ${r}`,P.style.borderRadius="4px",P.style.background="transparent",P.style.color="inherit";const I=[{value:"contains",label:"Contains"},{value:"notContains",label:"Does not contain"},{value:"equals",label:"Equals"},{value:"notEquals",label:"Does not equal"},{value:"isEmpty",label:"Is empty"},{value:"isNotEmpty",label:"Is not empty"}],B=e.condition.op==="in"?"contains":e.condition.op;for(const ee of I){const te=document.createElement("option");te.value=ee.value,te.textContent=ee.label,te.selected=B===ee.value,P.appendChild(te)}if(P.onchange=()=>{if(!this.filterPanelState)return;const ee=P.value;this.filterPanelState.condition={op:ee,value:this.filterPanelState.condition.value||""},this.renderFilterPanel()},R.appendChild(P),B!=="isEmpty"&&B!=="isNotEmpty"){const ee=document.createElement("input");ee.type="text",ee.value=((N=this.filterPanelState)==null?void 0:N.condition.value)||"",ee.placeholder="Enter value",ee.style.height="30px",ee.style.padding="0 8px",ee.style.border=`1px solid ${r}`,ee.style.borderRadius="4px",ee.style.background="transparent",ee.style.color="inherit",ee.oninput=()=>{this.filterPanelState&&(this.filterPanelState.condition={...this.filterPanelState.condition,value:ee.value},this.syncFilterPanelApplyButtonState())},R.appendChild(ee)}g.appendChild(R)}const m=document.createElement("div");m.style.display="flex",m.style.justifyContent="flex-end",m.style.gap="6px",m.style.padding="8px 10px";const S=R=>{R.disabled=!0,R.style.opacity="0.5",R.style.cursor="not-allowed"},T=l("Clear");T.onclick=()=>{this.sheet.clearColumnFilter(e.col).then(()=>{this.hideFilterPanel(),this.render()})},e.hasExistingCondition||S(T);const A=l("Cancel");A.onclick=()=>this.hideFilterPanel();const b=l("Apply");if(b.dataset.wbFilterApply="true",b.onclick=()=>{this.applyFilterPanel()},this.isFilterPanelDirty(e)||S(b),m.append(T,A,b),c.appendChild(m),this.filterPanel.appendChild(c),i&&e.mode==="values"){const R=this.filterPanel.querySelector('input[data-wb-filter-search="true"]');if(R){R.focus();const P=R.value.length,I=Math.max(0,Math.min(P,s??P)),B=Math.max(I,Math.min(P,n??I));R.setSelectionRange(I,B)}}}addEventListeners(){const e=this.gridContainer.getScrollContainer();this.addEventListener(window,"resize",()=>this.render()),this.addEventListener(e,"scroll",()=>{this.hideFilterPanel(),this.render()}),this.addEventListener(e,"mousedown",t=>{this.handleMouseDown(t)}),this.addEventListener(e,"mousemove",t=>{this.handleMouseMove(t)}),this.addEventListener(e,"mouseleave",()=>{const t=this.gridContainer.getScrollContainer();t.style.cursor="",this.setFilterButtonHoverCol(null)}),this.addEventListener(e,"dblclick",t=>{this.handleDblClick(t)}),this.addEventListener(e,"contextmenu",t=>{this.handleContextMenu(t)}),this.addEventListener(document,"keydown",t=>{this.handleKeyDown(t)}),this.addEventListener(document,"keyup",t=>{this.handleKeyUp(t)})}detectResizeEdge(e,t){const i=this.scroll,s=this.freezeState;if(t<oe&&e>ue){const r=s.frozenCols>0&&e<ue+s.frozenWidth?e-ue:e-ue-s.frozenWidth+this.colDim.getOffset(s.frozenCols+1)+i.left,o=this.colDim.findIndex(r),l=this.colDim.getOffset(o)+this.colDim.getSize(o);if(Math.abs(r-l)<eo)return{axis:"column",index:o};if(o>1){const c=this.colDim.getOffset(o-1)+this.colDim.getSize(o-1);if(Math.abs(r-c)<eo)return{axis:"column",index:o-1}}}if(e<ue&&t>oe){const r=s.frozenRows>0&&t<oe+s.frozenHeight?t-oe:t-oe-s.frozenHeight+this.rowDim.getOffset(s.frozenRows+1)+i.top,o=this.rowDim.findIndex(r),l=this.rowDim.getOffset(o)+this.rowDim.getSize(o);if(Math.abs(r-l)<eo)return{axis:"row",index:o};if(o>1){const c=this.rowDim.getOffset(o-1)+this.rowDim.getSize(o-1);if(Math.abs(r-c)<eo)return{axis:"row",index:o-1}}}return null}detectFreezeHandle(e,t){const i=this.freezeState,s=i.frozenRows>0||i.frozenCols>0,n=ap,r=Ng,o=s&&i.frozenRows>0?oe+i.frozenHeight-n/2:oe-n;if(e>=0&&e<=ue&&t>=o-r&&t<=o+n+r)return"row";const l=s&&i.frozenCols>0?ue+i.frozenWidth-n/2:ue-n;return e>=l-r&&e<=l+n+r&&t>=0&&t<=oe?"column":null}startFreezeDrag(e,t){const i=this.gridContainer.getScrollContainer();i.style.cursor="grabbing";const s=r=>{const o=this.viewport;if(e==="row"){const l=r.target!==i?Math.max(0,Math.min(o.height,r.clientY-o.top)):r.offsetY;if(l<=oe)return 0;const c=l-oe,a=this.rowDim.findIndex(c),f=this.rowDim.getOffset(a)+this.rowDim.getSize(a)/2;return c<f?Math.max(0,a-1):a}else{const l=r.target!==i?Math.max(0,Math.min(o.width,r.clientX-o.left)):r.offsetX;if(l<=ue)return 0;const c=l-ue,a=this.colDim.findIndex(c),f=this.colDim.getOffset(a)+this.colDim.getSize(a)/2;return c<f?Math.max(0,a-1):a}};this.freezeDrag={axis:e,targetIndex:s(t)},this.renderOverlay();const n=r=>{const o=s(r);this.freezeDrag&&this.freezeDrag.targetIndex!==o&&(this.freezeDrag={axis:e,targetIndex:o},this.renderOverlay())};this.startMouseDragSession({onMove:n,onComplete:()=>{var l;const r=((l=this.freezeDrag)==null?void 0:l.targetIndex)??0,o=this.sheet.getFreezePane();e==="row"?this.setFreezePane(r,o.frozenCols):this.setFreezePane(o.frozenRows,r)},onCleanup:()=>{i.style.cursor="",this.freezeDrag=null,this.freezeHandleHover=null,this.renderOverlay()}})}toRefFromMouse(e,t){const i=this.freezeState;return i.frozenRows>0||i.frozenCols>0?Og(e,t,this.scroll,this.rowDim,this.colDim,i):wg(e+this.scroll.left,t+this.scroll.top,this.rowDim,this.colDim)}toRowFromMouse(e){const t=this.freezeState,s=t.frozenRows>0&&e<oe+t.frozenHeight?e-oe:e-oe-t.frozenHeight+this.rowDim.getOffset(t.frozenRows+1)+this.scroll.top;return this.rowDim.findIndex(s)}toColFromMouse(e){const t=this.freezeState,s=t.frozenCols>0&&e<ue+t.frozenWidth?e-ue:e-ue-t.frozenWidth+this.colDim.getOffset(t.frozenCols+1)+this.scroll.left;return this.colDim.findIndex(s)}getAutofillSelectionRect(e){if(!this.sheet||this.sheet.getSelectionType()!=="cell")return;const t=e||this.sheet.getRangeOrActiveCell(),i=zn(t[0],this.scroll,this.rowDim,this.colDim,this.freezeState),s=zn(t[1],this.scroll,this.rowDim,this.colDim,this.freezeState),n=Math.min(i.left,s.left),r=Math.min(i.top,s.top),o=Math.max(i.left+i.width,s.left+s.width),l=Math.max(i.top+i.height,s.top+s.height);return{left:n,top:r,width:o-n,height:l-r}}detectAutofillHandle(e,t){if(this.readOnly||!this.sheet||this.sheet.getSelectionType()!=="cell")return!1;const i=this.sheet.getRangeOrActiveCell(),s=this.getAutofillSelectionRect(i);if(!s||this.isAutofillHandleHiddenByFreeze(i,s))return!1;const n=s.left+s.width-Wn/2,r=s.top+s.height-Wn/2;return e>=n-to&&e<=n+Wn+to&&t>=r-to&&t<=r+Wn+to}shouldShowAutofillHandle(){if(this.readOnly||!this.sheet||this.sheet.getSelectionType()!=="cell")return!1;const e=this.sheet.getRangeOrActiveCell(),t=this.getAutofillSelectionRect(e);return t?!this.isAutofillHandleHiddenByFreeze(e,t):!1}isAutofillHandleHiddenByFreeze(e,t){const i=this.freezeState;if(i.frozenRows===0&&i.frozenCols===0)return!1;const s=Math.max(e[0].r,e[1].r),n=Math.max(e[0].c,e[1].c);if(!(s>i.frozenRows&&n>i.frozenCols))return!1;const o=t.left+t.width-Wn/2,l=t.top+t.height-Wn/2,c=ue+i.frozenWidth,a=oe+i.frozenHeight;return o<c||l<a}clampClientPointToViewport(e,t){const i=this.viewport;return{x:Math.max(0,Math.min(i.width,e-i.left)),y:Math.max(0,Math.min(i.height,t-i.top))}}getAutoScrollSpeed(e){const i=Math.min(Uf,Math.max(0,e))/Uf;return Hf+(Ug-Hf)*i}getAutoScrollVelocity(e,t,i){return e<t?-this.getAutoScrollSpeed(t-e):e>i?this.getAutoScrollSpeed(e-i):0}handleMouseMove(e){var r,o,l;const t=this.gridContainer.getScrollContainer(),i=this.detectFreezeHandle(e.offsetX,e.offsetY);if(i!==this.freezeHandleHover&&(this.freezeHandleHover=i,this.render()),i){t.style.cursor="grab",this.setFilterButtonHoverCol(null),this.resizeHover&&(this.resizeHover=null,this.renderOverlay());return}const s=this.detectResizeEdge(e.offsetX,e.offsetY),n=(s==null?void 0:s.axis)!==((r=this.resizeHover)==null?void 0:r.axis)||(s==null?void 0:s.index)!==((o=this.resizeHover)==null?void 0:o.index);if(n&&(this.resizeHover=s),s)t.style.cursor=s.axis==="column"?"col-resize":"row-resize",this.setFilterButtonHoverCol(null);else{if(this.detectAutofillHandle(e.offsetX,e.offsetY)){t.style.cursor="crosshair",this.setFilterButtonHoverCol(null),n&&this.renderOverlay();return}const c=e.offsetX,a=e.offsetY,h=this.detectFilterButton(c,a);if(h!==null){t.style.cursor="pointer",this.setFilterButtonHoverCol(h),n&&this.renderOverlay();return}this.setFilterButtonHoverCol(null);const f=(l=this.sheet)==null?void 0:l.getSelectedIndices();if(f){const d=f.axis==="column"?a<oe&&c>ue&&(()=>{const p=this.toColFromMouse(c);return p>=f.from&&p<=f.to})():c<ue&&a>oe&&(()=>{const p=this.toRowFromMouse(a);return p>=f.from&&p<=f.to})();t.style.cursor=d?"grab":""}else t.style.cursor=""}n&&this.renderOverlay()}setFilterButtonHoverCol(e){this.filterButtonHoverCol!==e&&(this.filterButtonHoverCol=e,this.render())}async handleMouseDown(e){const t=this.detectFreezeHandle(e.offsetX,e.offsetY);if(t&&!this.readOnly){e.preventDefault(),this.startFreezeDrag(t,e);return}const i=this.detectResizeEdge(e.offsetX,e.offsetY);if(i&&!this.readOnly){e.preventDefault(),this.startResize(i.axis,i.index,e);return}const s=e.offsetX,n=e.offsetY,r=this.detectFilterButton(s,n);if(r!==null){e.preventDefault(),await this.finishEditing(),await this.showFilterPanel(r);return}if(s<ue&&n<oe){e.preventDefault(),await this.finishEditing(),this.sheet.selectAllCells(),this.render();return}const l=n<oe&&s>ue,c=s<ue&&n>oe;if(l){e.preventDefault(),await this.finishEditing();const m=this.toColFromMouse(s);if(m<1)return;if(e.shiftKey){this.sheet.selectColumnRange(this.sheet.getActiveCell().c,m),this.render();return}const S=this.sheet.getSelectedIndices();if(!this.readOnly&&S&&S.axis==="column"&&m>=S.from&&m<=S.to){this.startDragMove("column",S.from,S.to-S.from+1,e);return}this.sheet.selectColumn(m),this.render();const T=m;let A=m,b=e.clientX,N=null,R=null;const P=()=>{const{x:te}=this.clampClientPointToViewport(b,0),le=this.toColFromMouse(te);le>=1&&le!==A&&(A=le,this.sheet.selectColumnRange(T,A))},I=()=>{N!==null&&(cancelAnimationFrame(N),N=null),R=null},B=te=>{const le=this.viewport,ge=this.getAutoScrollVelocity(b,le.left,le.left+le.width);if(ge===0){N=null,R=null;return}const ce=Math.min(50,R===null?16:te-R);R=te,this.gridContainer.scrollBy(ge*ce/1e3,0),P(),this.render(),N=requestAnimationFrame(B)},V=()=>{N===null&&(N=requestAnimationFrame(B))},ee=te=>{b=te.clientX,P(),this.render();const le=this.viewport;this.getAutoScrollVelocity(b,le.left,le.left+le.width)===0?I():V()};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:ee,onCleanup:()=>{I(),this.endNativeSelectionBlock()}});return}if(c){e.preventDefault(),await this.finishEditing();const m=this.toRowFromMouse(n);if(m<1)return;if(e.shiftKey){this.sheet.selectRowRange(this.sheet.getActiveCell().r,m),this.render();return}const S=this.sheet.getSelectedIndices();if(!this.readOnly&&S&&S.axis==="row"&&m>=S.from&&m<=S.to){this.startDragMove("row",S.from,S.to-S.from+1,e);return}this.sheet.selectRow(m),this.render();const T=m;let A=m,b=e.clientY,N=null,R=null;const P=()=>{const{y:te}=this.clampClientPointToViewport(0,b),le=this.toRowFromMouse(te);le>=1&&le!==A&&(A=le,this.sheet.selectRowRange(T,A))},I=()=>{N!==null&&(cancelAnimationFrame(N),N=null),R=null},B=te=>{const le=this.viewport,ge=this.getAutoScrollVelocity(b,le.top,le.top+le.height);if(ge===0){N=null,R=null;return}const ce=Math.min(50,R===null?16:te-R);R=te,this.gridContainer.scrollBy(0,ge*ce/1e3),P(),this.render(),N=requestAnimationFrame(B)},V=()=>{N===null&&(N=requestAnimationFrame(B))},ee=te=>{b=te.clientY,P(),this.render();const le=this.viewport;this.getAutoScrollVelocity(b,le.top,le.top+le.height)===0?I():V()};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:ee,onCleanup:()=>{I(),this.endNativeSelectionBlock()}});return}if(this.isInFormulaRangeMode()){e.preventDefault();const m=this.toRefFromMouse(e.offsetX,e.offsetY);if(this.activeFormulaInput=this.cellInput.isFocused()?"cellInput":"formulaBar",e.shiftKey&&this.formulaRangeAnchor){const A={r:Math.min(this.formulaRangeAnchor.r,m.r),c:Math.min(this.formulaRangeAnchor.c,m.c)},b={r:Math.max(this.formulaRangeAnchor.r,m.r),c:Math.max(this.formulaRangeAnchor.c,m.c)};this.insertReferenceAtCursor(A,b)}else this.formulaRangeAnchor=m,this.formulaRefInsertPos=null,this.insertReferenceAtCursor(m);const S=this.gridContainer.getScrollContainer(),T=A=>{const b=this.viewport,N=A.target!==S?Math.max(0,Math.min(b.width,A.clientX-b.left)):A.offsetX,R=A.target!==S?Math.max(0,Math.min(b.height,A.clientY-b.top)):A.offsetY,P=this.toRefFromMouse(N,R),I={r:Math.min(this.formulaRangeAnchor.r,P.r),c:Math.min(this.formulaRangeAnchor.c,P.c)},B={r:Math.max(this.formulaRangeAnchor.r,P.r),c:Math.max(this.formulaRangeAnchor.c,P.c)};this.insertReferenceAtCursor(I,B)};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:T,onComplete:()=>{this.activeFormulaInput==="cellInput"?this.cellInput.getInput().focus():this.activeFormulaInput==="formulaBar"&&this.formulaBar.getFormulaInput().focus()},onCleanup:()=>{this.endNativeSelectionBlock(),this.formulaRefInsertPos=null}});return}if(this.detectAutofillHandle(e.offsetX,e.offsetY)){e.preventDefault(),await this.finishEditing(),this.startAutofillDrag(e);return}if(await this.finishEditing(),e.shiftKey){const m=this.toRefFromMouse(e.offsetX,e.offsetY);this.sheet.selectEnd(m),this.render();return}this.sheet.selectStart(this.toRefFromMouse(e.offsetX,e.offsetY)),this.render();let a=e.clientX,h=e.clientY,f=null,d=null;const p=()=>{const{x:m,y:S}=this.clampClientPointToViewport(a,h);this.sheet.selectEnd(this.toRefFromMouse(m,S))},v=()=>{f!==null&&(cancelAnimationFrame(f),f=null),d=null},x=m=>{const S=this.viewport,T=this.getAutoScrollVelocity(a,S.left,S.left+S.width),A=this.getAutoScrollVelocity(h,S.top,S.top+S.height);if(T===0&&A===0){f=null,d=null;return}const b=Math.min(50,d===null?16:m-d);d=m,this.gridContainer.scrollBy(T*b/1e3,A*b/1e3),p(),this.render(),f=requestAnimationFrame(x)},y=()=>{f===null&&(f=requestAnimationFrame(x))},g=m=>{a=m.clientX,h=m.clientY,p(),this.renderOverlay();const S=this.viewport,T=this.getAutoScrollVelocity(a,S.left,S.left+S.width),A=this.getAutoScrollVelocity(h,S.top,S.top+S.height);T===0&&A===0?v():y()};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:g,onComplete:()=>{this.render()},onCleanup:()=>{v(),this.endNativeSelectionBlock()}})}startAutofillDrag(e){let t=e.clientX,i=e.clientY,s=null,n=null;const r=()=>{const{x:h,y:f}=this.clampClientPointToViewport(t,i),d=this.toRefFromMouse(h,f);this.autofillPreview=this.sheet.getAutofillPreviewRange(d),this.renderOverlay()},o=()=>{s!==null&&(cancelAnimationFrame(s),s=null),n=null},l=h=>{const f=this.viewport,d=this.getAutoScrollVelocity(t,f.left,f.left+f.width),p=this.getAutoScrollVelocity(i,f.top,f.top+f.height);if(d===0&&p===0){s=null,n=null;return}const v=Math.min(50,n===null?16:h-n);n=h,this.gridContainer.scrollBy(d*v/1e3,p*v/1e3),r(),s=requestAnimationFrame(l)},c=()=>{s===null&&(s=requestAnimationFrame(l))},a=h=>{t=h.clientX,i=h.clientY,r();const f=this.viewport,d=this.getAutoScrollVelocity(t,f.left,f.left+f.width),p=this.getAutoScrollVelocity(i,f.top,f.top+f.height);d===0&&p===0?o():c()};this.beginNativeSelectionBlock(),r(),this.startMouseDragSession({onMove:a,onComplete:()=>{const{x:h,y:f}=this.clampClientPointToViewport(t,i),d=this.toRefFromMouse(h,f),p=this.sheet;(async()=>{const v=await p.autofill(d);this.autofillPreview=void 0,this.sheet&&(v?this.render():this.renderOverlay())})()},onCleanup:()=>{o(),this.endNativeSelectionBlock(),this.autofillPreview=void 0,this.sheet&&this.renderOverlay()}})}startResize(e,t,i){const s=e==="column"?i.clientX:i.clientY,n=e==="column"?this.colDim.getSize(t):this.rowDim.getSize(t),r=this.gridContainer.getScrollContainer();r.style.cursor=e==="column"?"col-resize":"row-resize";const o=e==="column"?this.colDim:this.rowDim,l=this.sheet.getSelectedIndices(),a=l&&l.axis===e&&t>=l.from&&t<=l.to?Array.from({length:l.to-l.from+1},(v,x)=>l.from+x):[t],h=a.length;let f=n,d=null;this.beginNativeSelectionBlock(),this.showResizeTooltip(e,n,i.clientX,i.clientY,h);const p=v=>{const y=(e==="column"?v.clientX:v.clientY)-s;f=Math.max(e==="column"?qf:qg,n+y),d===null&&(d=requestAnimationFrame(()=>{d=null,o.setSize(t,f),this.render()})),this.showResizeTooltip(e,f,v.clientX,v.clientY,h)};this.startMouseDragSession({onMove:p,onComplete:()=>{const v=f;o.setSize(t,v);for(const x of a)o.setSize(x,v),e==="column"?this.sheet.setColumnWidth(x,v):(this.manuallyResizedRows.add(x),this.sheet.setRowHeight(x,v));this.render()},onCleanup:()=>{r.style.cursor="",this.hideResizeTooltip(),this.endNativeSelectionBlock(),d!==null&&(cancelAnimationFrame(d),d=null)}})}async autoFitSize(e,t){const s=document.createElement("canvas").getContext("2d"),n=6;if(e==="column"){s.font=`${Cr}px Arial`;const r=Jn(t);let o=s.measureText(r).width+n;const[l,c]=this.viewRange,a=[{r:l.r,c:t},{r:c.r,c:t}],h=await this.sheet.fetchGrid(a);for(const[,d]of h)if(d.v){const p=s.measureText(d.v).width+n;p>o&&(o=p)}const f=Math.max(qf,Math.ceil(o));this.sheet.setColumnWidth(t,f)}else{this.manuallyResizedRows.delete(t);const r=await this.computeContentHeight(t);this.sheet.setRowHeight(t,r)}this.render()}async computeContentHeight(e){const[t,i]=this.viewRange,s=[{r:e,c:t.c},{r:e,c:i.c}],n=await this.sheet.fetchGrid(s);let r=1;for(const[,o]of n)if(o.v){const l=o.v.split(`
`).length;l>r&&(r=l)}return r<=1?oe:Math.max(oe,Math.ceil(r*Cr*co+2*Rl))}async autoResizeRow(e){if(this.manuallyResizedRows.has(e))return;const t=await this.computeContentHeight(e),i=this.rowDim.getSize(e);t!==i&&(this.sheet.setRowHeight(e,t),this.render())}startDragMove(e,t,i,s){const n=this.gridContainer.getScrollContainer();n.style.cursor="grabbing";const r=e==="column"?this.colDim:this.rowDim,o=c=>{const a=this.viewport;if(e==="column"){const h=c.target!==n?Math.max(0,Math.min(a.width,c.clientX-a.left)):c.offsetX,f=this.toColFromMouse(h),d=this.freezeState,v=d.frozenCols>0&&h<ue+d.frozenWidth?h-ue:h-ue-d.frozenWidth+this.colDim.getOffset(d.frozenCols+1)+this.scroll.left,y=r.getOffset(f)+r.getSize(f)/2;return v<y?f:f+1}else{const h=c.target!==n?Math.max(0,Math.min(a.height,c.clientY-a.top)):c.offsetY,f=this.toRowFromMouse(h),d=this.freezeState,v=d.frozenRows>0&&h<oe+d.frozenHeight?h-oe:h-oe-d.frozenHeight+this.rowDim.getOffset(d.frozenRows+1)+this.scroll.top,y=r.getOffset(f)+r.getSize(f)/2;return v<y?f:f+1}};this.dragMove={axis:e,srcIndex:t,count:i,dropIndex:o(s)},this.renderOverlay();const l=c=>{const a=o(c);this.dragMove&&this.dragMove.dropIndex!==a&&(this.dragMove={axis:e,srcIndex:t,count:i,dropIndex:a},this.renderOverlay())};this.startMouseDragSession({onMove:l,onComplete:()=>{var h;const c=(h=this.dragMove)==null?void 0:h.dropIndex;if(c===void 0||c>=t&&c<=t+i)return;(e==="row"?this.sheet.moveRows(t,i,c):this.sheet.moveColumns(t,i,c)).then(()=>{const f=c<t?c:c-i;e==="row"?(this.sheet.selectRow(f),i>1&&this.sheet.selectRowRange(f,f+i-1)):(this.sheet.selectColumn(f),i>1&&this.sheet.selectColumnRange(f,f+i-1)),this.render()})},onCleanup:()=>{n.style.cursor="",this.dragMove=null,this.renderOverlay()}})}async handleFormulaKeydown(e){await this.handleEditorKeydown(e,"formulaBar")}async handleCellInputKeydown(e){await this.handleEditorKeydown(e,"cellInput")}async handleEditorKeydown(e,t){if(e.isComposing)return;const i=t==="formulaBar"?this.formulaBar.getFormulaInput():this.cellInput.getInput();if(this.handleAutocompleteKeydown(e,i))return;const s=r=>{Fe(r,"ArrowDown")?this.sheet.move("down"):Fe(r,"ArrowUp")?this.sheet.move("up"):Fe(r,"ArrowLeft")?this.sheet.move("left"):Fe(r,"ArrowRight")&&this.sheet.move("right")};!await jf(e,[{match:r=>nt(r,{key:"Enter",alt:!0}),run:r=>{r.preventDefault(),document.execCommand("insertLineBreak")}},{match:r=>Fe(r,"Enter"),run:async r=>{r.preventDefault(),await this.finishEditing(),t==="formulaBar"?(this.focusGrid(),this.sheet.move("down")):this.sheet.moveInRange(r.shiftKey?-1:1,0),this.render(),this.scrollIntoView()}},{match:r=>Fe(r,"Tab"),run:async r=>{r.preventDefault(),await this.finishEditing(),t==="formulaBar"&&this.focusGrid(),this.sheet.moveInRange(0,r.shiftKey?-1:1),this.render(),this.scrollIntoView()}},{match:r=>this.isArrowKey(r)&&!this.editMode&&(t==="formulaBar"||this.cellInput.hasFormula())&&this.isInFormulaRangeMode(),run:r=>{r.preventDefault(),this.applyFormulaRangeArrowKey(r)}},{match:r=>t==="cellInput"&&this.isArrowKey(r)&&!this.cellInput.hasFormula()&&!this.editMode,run:async r=>{r.preventDefault(),await this.finishEditing(),s(r),this.render(),this.scrollIntoView()}},{match:r=>Fe(r,"F4"),run:r=>{r.preventDefault(),this.toggleAbsoluteReference(i)}},{match:r=>Fe(r,"Escape"),run:r=>{r.preventDefault(),this.focusGrid(),this.render()}}])&&t==="formulaBar"&&!this.cellInput.isShown()&&this.showCellInput(!0,!0)}handleAutocompleteKeydown(e,t){if(this.autocomplete.isListVisible()){if(Fe(e,"ArrowDown"))return e.preventDefault(),this.autocomplete.moveDown(),!0;if(Fe(e,"ArrowUp"))return e.preventDefault(),this.autocomplete.moveUp(),!0;if(Fe(e,"Tab")||Fe(e,"Enter")){const i=this.autocomplete.getSelectedFunction();if(i)return e.preventDefault(),this.insertFunctionCompletion(i.name,t),!0}else Fe(e,"Escape")&&this.autocomplete.hide()}else this.autocomplete.isHintVisible()&&Fe(e,"Escape")&&this.autocomplete.hide();return!1}isArrowKey(e){return Fe(e,"ArrowDown")||Fe(e,"ArrowUp")||Fe(e,"ArrowLeft")||Fe(e,"ArrowRight")}applyFormulaRangeArrowKey(e){const i={...this.lastFormulaRefTarget||this.sheet.getActiveCell()};if(Fe(e,"ArrowDown")?i.r=Math.max(1,i.r+1):Fe(e,"ArrowUp")?i.r=Math.max(1,i.r-1):Fe(e,"ArrowLeft")?i.c=Math.max(1,i.c-1):Fe(e,"ArrowRight")&&(i.c=i.c+1),e.shiftKey&&this.formulaRangeAnchor){const s={r:Math.min(this.formulaRangeAnchor.r,i.r),c:Math.min(this.formulaRangeAnchor.c,i.c)},n={r:Math.max(this.formulaRangeAnchor.r,i.r),c:Math.max(this.formulaRangeAnchor.c,i.c)};this.insertReferenceAtCursor(s,n),this.lastFormulaRefTarget=i}else this.formulaRangeAnchor=i,this.formulaRefInsertPos=null,this.insertReferenceAtCursor(i)}async copy(){const{text:e}=await this.sheet.copy();await navigator.clipboard.writeText(e)}async paste(){try{let e,t;if(navigator.clipboard.read)try{const i=await navigator.clipboard.read();for(const s of i)s.types.includes("text/html")&&(t=await(await s.getType("text/html")).text()),s.types.includes("text/plain")&&(e=await(await s.getType("text/plain")).text())}catch{e=await navigator.clipboard.readText()}else e=await navigator.clipboard.readText();await this.sheet.paste({text:e,html:t}),this.sheet.clearCopyBuffer(),this.render()}catch(e){console.error("Failed to paste cell content: ",e)}}async handleGridKeydown(e){const t=async(i,s)=>{i.preventDefault(),(i.shiftKey?this.sheet.resizeRange(s):Fl(i)?await this.sheet.moveToEdge(s):this.sheet.move(s))&&(this.render(),this.scrollIntoView())};await jf(e,[{match:i=>Fe(i,"ArrowDown"),run:i=>t(i,"down")},{match:i=>Fe(i,"ArrowUp"),run:i=>t(i,"up")},{match:i=>Fe(i,"ArrowLeft"),run:i=>t(i,"left")},{match:i=>Fe(i,"ArrowRight"),run:i=>t(i,"right")},{match:i=>nt(i,{key:"a",mod:!0}),run:async i=>{i.preventDefault(),await this.sheet.selectAll(),this.render()}},{match:i=>Fe(i,"Tab"),run:i=>{i.preventDefault(),this.sheet.moveInRange(0,i.shiftKey?-1:1),this.render(),this.scrollIntoView()}},{match:i=>Fe(i,"Enter"),run:i=>{i.preventDefault(),this.sheet.hasRange()?(this.sheet.moveInRange(i.shiftKey?-1:1,0),this.render(),this.scrollIntoView()):this.readOnly||this.showCellInput()}},{match:i=>Fe(i,"Delete")||Fe(i,"Backspace"),run:async i=>{this.readOnly||(i.preventDefault(),await this.sheet.removeData()&&this.render())}},{match:i=>!Fl(i)&&this.isValidCellInput(i.key),run:()=>{this.readOnly||this.showCellInput(!0)}},{match:i=>nt(i,{key:"z",mod:!0,shift:!1}),run:async i=>{this.readOnly||(i.preventDefault(),await this.sheet.undo()&&(this.render(),this.scrollIntoView()))}},{match:i=>nt(i,{key:"z",mod:!0,shift:!0})||nt(i,{key:"y",mod:!0}),run:async i=>{this.readOnly||(i.preventDefault(),await this.sheet.redo()&&(this.render(),this.scrollIntoView()))}},{match:i=>Fe(i,"Escape"),run:i=>{i.preventDefault(),this.sheet.getCopyRange()&&(this.sheet.clearCopyBuffer(),this.renderOverlay())}},{match:i=>nt(i,{key:"c",mod:!0}),run:async i=>{i.preventDefault(),await this.copy()}},{match:i=>nt(i,{key:"v",mod:!0}),run:async i=>{this.readOnly||(i.preventDefault(),await this.paste())}},{match:i=>nt(i,{key:"b",mod:!0}),run:async i=>{this.readOnly||(i.preventDefault(),await this.sheet.toggleRangeStyle("b"),this.render())}},{match:i=>nt(i,{key:"i",mod:!0}),run:async i=>{this.readOnly||(i.preventDefault(),await this.sheet.toggleRangeStyle("i"),this.render())}},{match:i=>nt(i,{key:"u",mod:!0}),run:async i=>{this.readOnly||(i.preventDefault(),await this.sheet.toggleRangeStyle("u"),this.render())}},{match:i=>nt(i,{key:"m",mod:!0,shift:!0}),run:async i=>{this.readOnly||(i.preventDefault(),await this.sheet.toggleMergeSelection()&&this.render())}}])}async reloadDimensions(){await this.sheet.loadDimensions(),await this.sheet.loadStyles(),await this.sheet.loadMerges(),await this.sheet.loadFreezePane(),await this.sheet.loadFilterState(),this.hiddenRows.clear(),this.hiddenRowSizeBackup.clear(),this.syncHiddenRowsFromSheet(),this.updateFreezeState()}getGridViewportRect(){const e=this.viewport,t=this.container.getBoundingClientRect();return{left:e.left-t.left,top:e.top-t.top,width:e.width,height:e.height}}getScrollableGridViewportRect(){const e=this.getGridViewportRect(),t=this.freezeState,i=ue+t.frozenWidth,s=oe+t.frozenHeight;return{left:e.left+i,top:e.top+s,width:Math.max(0,e.width-i),height:Math.max(0,e.height-s)}}getCellRect(e){const t=this.freezeState;return t.frozenRows>0||t.frozenCols>0?zn(e,this.scroll,this.rowDim,this.colDim,t):De(e,this.scroll,this.rowDim,this.colDim)}getCellRectInScrollableViewport(e){const t=this.freezeState,i=this.scroll,s=i.left+this.colDim.getOffset(t.frozenCols+1)-t.frozenWidth,n=i.top+this.rowDim.getOffset(t.frozenRows+1)-t.frozenHeight;return De(e,{left:s,top:n},this.rowDim,this.colDim)}getRangeRect(e){return kn(this.getCellRect(e[0]),this.getCellRect(e[1]))}setOnRender(e){this.onRenderCallback=e}render(){this.renderVersion+=1,this.requestRenderFrame()}requestRenderFrame(){this.pendingRenderFrame===null&&(this.pendingRenderFrame=requestAnimationFrame(()=>{this.pendingRenderFrame=null,this.handleRenderFrame()}))}handleRenderFrame(){if(this.renderInFlight){this.renderQueued=!0;return}this.renderInFlight=!0;const e=this.renderVersion;this.performRender(e).finally(()=>{this.renderInFlight=!1,(this.renderQueued||this.renderVersion!==e)&&(this.renderQueued=!1,this.requestRenderFrame())})}async performRender(e){var t;this.sheet&&(this.formulaBar.render(),await this.renderSheet(e),!(!this.sheet||e!==this.renderVersion)&&(this.renderOverlay(),(t=this.onRenderCallback)==null||t.call(this)))}renderOverlay(){this.overlay.render(this.viewport,this.scroll,this.sheet.getActiveCell(),this.sheet.getPresences(),this.sheet.getRange(),this.rowDim,this.colDim,this.resizeHover,this.sheet.getSelectionType(),this.dragMove?{axis:this.dragMove.axis,dropIndex:this.dragMove.dropIndex}:null,this.formulaRanges,this.freezeState,this.freezeDrag,this.sheet.getCopyRange(),this.autofillPreview,this.shouldShowAutofillHandle(),this.sheet.getMerges())}get viewRange(){const e=this.scroll,t=this.viewport,i=this.freezeState,s=this.rowDim.getOffset(i.frozenRows+1),n=this.colDim.getOffset(i.frozenCols+1),r=Math.max(i.frozenRows+1,this.rowDim.findIndex(s+e.top)),o=Math.max(r,this.rowDim.findIndex(s+e.top+t.height)+1),l=Math.max(i.frozenCols+1,this.colDim.findIndex(n+e.left)),c=Math.max(l,this.colDim.findIndex(n+e.left+t.width)+1);return[{r,c:l},{r:o,c}]}scrollIntoView(e=this.sheet.getActiveCell()){const t=this.scroll,i=this.freezeState,s=i.frozenRows>0&&e.r<=i.frozenRows,n=i.frozenCols>0&&e.c<=i.frozenCols,r=De(e,{left:0,top:0},this.rowDim,this.colDim),o=this.sheet.getMerges().get(xe(e));if(o){const d=De({r:e.r+o.rs-1,c:e.c+o.cs-1},{left:0,top:0},this.rowDim,this.colDim);r.width=d.left+d.width-r.left,r.height=d.top+d.height-r.top}const l=this.colDim.getOffset(i.frozenCols+1),c=this.rowDim.getOffset(i.frozenRows+1),a=this.viewport.width-ue-i.frozenWidth,h=this.viewport.height-oe-i.frozenHeight;let f=!1;if(!n){const d=l+t.left,p=d+a,v=r.left-ue,x=v+r.width;v<d?(this.scroll={left:v-l},f=!0):x>p&&(this.scroll={left:x-a-l},f=!0)}if(!s){const d=c+t.top,p=d+h,v=r.top-oe,x=v+r.height;v<d?(this.scroll={top:v-c},f=!0):x>p&&(this.scroll={top:x-h-c},f=!0)}f&&this.render()}async showCellInput(e=!1,t=!1){t||(this.editMode=!e);const i=this.sheet.getActiveCell(),s=this.freezeState,n=s.frozenRows>0||s.frozenCols>0?zn(i,this.scroll,this.rowDim,this.colDim,s):De(i,this.scroll,this.rowDim,this.colDim),r=this.sheet.getMerges().get(xe(i));if(r){const h=s.frozenRows>0||s.frozenCols>0?zn({r:i.r+r.rs-1,c:i.c+r.cs-1},this.scroll,this.rowDim,this.colDim,s):De({r:i.r+r.rs-1,c:i.c+r.cs-1},this.scroll,this.rowDim,this.colDim);n.width=h.left+h.width-n.left,n.height=h.top+h.height-n.top}const o=e?"":await this.sheet.toInputString(i),l=Math.max(n.width,this.viewport.width-n.left),c=Math.max(n.height,this.viewport.height-n.top);this.cellInput.show(n.left,n.top,o,!t,n.width,n.height,l,c);const a=await this.sheet.getStyle(i);this.cellInput.applyStyle(a),o.startsWith("=")&&(this.formulaRanges=wi(o).map(h=>h.range),this.renderOverlay())}isValidCellInput(e){return e.length===1||e==="Process"}async renderSheet(e=this.renderVersion){const t=this.sheet;if(!t)return;this.syncHiddenRowsFromSheet();const i=this.gridSize,s=this.freezeState;this.gridContainer.updateDummySize(i.width+ue,i.height+oe);const n=this.viewport,r=this.scroll,o=this.viewRange,l=[{r:1,c:1},{r:o[1].r,c:o[1].c}],c=await t.fetchGrid(l);t!==this.sheet||e!==this.renderVersion||this.gridCanvas.render(n,r,o,t.getActiveCell(),c,this.rowDim,this.colDim,t.getSelectionType(),t.getRange(),s,this.freezeHandleHover,t.getColStyles(),t.getRowStyles(),t.getSheetStyle(),t.getMerges(),t.getFilterRange(),t.getFilteredColumns(),this.filterButtonHoverCol)}syncHiddenRowsFromSheet(){const e=this.sheet;if(!e)return;const t=e.getHiddenRows();for(const i of this.hiddenRows){if(t.has(i))continue;const s=this.hiddenRowSizeBackup.get(i)??this.rowDim.getDefaultSize();this.rowDim.setSize(i,s),this.hiddenRowSizeBackup.delete(i)}for(const i of t)this.hiddenRows.has(i)||(this.hiddenRowSizeBackup.set(i,this.rowDim.getSize(i)),this.rowDim.setSize(i,0));this.hiddenRows=t}get gridSize(){const e=this.sheet.getDimension();return{width:this.colDim.getOffset(e.columns+1),height:this.rowDim.getOffset(e.rows+1)}}get viewport(){return this.gridContainer.getViewport()}get scroll(){return this.gridContainer.getScrollPosition()}set scroll(e){this.gridContainer.setScrollPosition(e)}}async function Mv(u,e){const t=new Vg(u,e),i=(e==null?void 0:e.store)||new Ag;return await t.initialize(i),t}class Vg{constructor(e,t){k(this,"container");k(this,"worksheet");k(this,"sheet");k(this,"theme");k(this,"_readOnly");k(this,"selectionChangeCallbacks",[]);this.container=e,this.container.style.position="relative",this.container.style.overflow="hidden",this.theme=(t==null?void 0:t.theme)||"light",this._readOnly=(t==null?void 0:t.readOnly)||!1,this.worksheet=new $g(this.container,this.theme,this._readOnly)}get readOnly(){return this._readOnly}async initialize(e){this.sheet=new Sg(e),this.worksheet.setOnRender(()=>this.notifySelectionChange()),await this.worksheet.initialize(this.sheet)}async reloadDimensions(){await this.worksheet.reloadDimensions()}async setFreezePane(e,t){this._readOnly||await this.worksheet.setFreezePane(e,t)}render(){this.worksheet.render()}renderOverlay(){this.worksheet.renderOverlay()}panBy(e,t){this.worksheet.panBy(e,t)}handleMobileDoubleTap(e,t){this.worksheet.handleMobileDoubleTap(e,t)}async applyStyle(e){!this.sheet||this._readOnly||(await this.sheet.setRangeStyle(e),this.worksheet.render(),this.notifySelectionChange())}async applyBorders(e){!this.sheet||this._readOnly||await this.sheet.setRangeBorders(e)&&(this.worksheet.render(),this.notifySelectionChange())}async toggleStyle(e){!this.sheet||this._readOnly||(await this.sheet.toggleRangeStyle(e),this.worksheet.render(),this.notifySelectionChange())}async getActiveStyle(){if(this.sheet)return this.sheet.getStyle(this.sheet.getActiveCell())}onSelectionChange(e){return this.selectionChangeCallbacks.push(e),()=>{this.selectionChangeCallbacks=this.selectionChangeCallbacks.filter(t=>t!==e)}}notifySelectionChange(){for(const e of this.selectionChangeCallbacks)e()}getSelectionType(){var e;return(e=this.sheet)==null?void 0:e.getSelectionType()}getSelectionRangeOrActiveCell(){var e;return(e=this.sheet)==null?void 0:e.getRangeOrActiveCell()}getGridViewportRect(){return this.worksheet.getGridViewportRect()}getScrollableGridViewportRect(){return this.worksheet.getScrollableGridViewportRect()}getCellRect(e){return this.worksheet.getCellRect(e)}getCellRectInScrollableViewport(e){return this.worksheet.getCellRectInScrollableViewport(e)}async increaseDecimals(){if(!this.sheet||this._readOnly)return;const e=await this.sheet.getActiveDecimalPlaces();await this.sheet.setRangeStyle({dp:e+1}),this.worksheet.render(),this.notifySelectionChange()}async decreaseDecimals(){if(!this.sheet||this._readOnly)return;const e=await this.sheet.getActiveDecimalPlaces();await this.sheet.setRangeStyle({dp:Math.max(0,e-1)}),this.worksheet.render(),this.notifySelectionChange()}async toggleMergeCells(){!this.sheet||this._readOnly||await this.sheet.toggleMergeSelection()&&(this.worksheet.render(),this.notifySelectionChange())}isSelectionMerged(){return this.sheet?this.sheet.isSelectionMerged():!1}canMergeSelection(){return this.sheet?this.sheet.canMergeSelection():!1}hasFilter(){var e;return((e=this.sheet)==null?void 0:e.hasFilter())||!1}async createFilterFromSelection(){if(!this.sheet||this._readOnly)return!1;const e=await this.sheet.createFilterFromSelection();return e&&(this.worksheet.render(),this.notifySelectionChange()),e}async clearFilter(){!this.sheet||this._readOnly||(await this.sheet.clearFilter(),this.worksheet.render(),this.notifySelectionChange())}async setColumnFilter(e,t){if(!this.sheet||this._readOnly)return!1;const i=await this.sheet.setColumnFilter(e,t);return i&&(this.worksheet.render(),this.notifySelectionChange()),i}async clearColumnFilter(e){if(!this.sheet||this._readOnly)return!1;const t=await this.sheet.clearColumnFilter(e);return t&&(this.worksheet.render(),this.notifySelectionChange()),t}async undo(){!this.sheet||this._readOnly||await this.sheet.undo()&&(this.worksheet.render(),this.notifySelectionChange())}async redo(){!this.sheet||this._readOnly||await this.sheet.redo()&&(this.worksheet.render(),this.notifySelectionChange())}toggleFunctionBrowser(){this.worksheet.toggleFunctionBrowser()}cleanup(){this.worksheet.cleanup(),this.selectionChangeCallbacks=[]}setGridResolver(e){this.sheet&&this.sheet.setGridResolver(e)}async recalculateCrossSheetFormulas(){this.sheet&&(await this.sheet.recalculateCrossSheetFormulas(),this.worksheet.render())}}const Wg=8,Gg=280,Yg=24;function kv({containerRef:u,sheetRef:e,enabled:t=!0}){const i=fp();hp.useEffect(()=>{const s=u.current;if(!t||!i||!s)return;let n=0,r=0,o=0,l=0,c=!1,a=!1,h=0,f=0,d=0;const p=g=>{if(g.touches.length!==1){a=g.touches.length>1,c=!1;return}const m=g.touches[0];n=m.clientX,r=m.clientY,o=m.clientX,l=m.clientY},v=g=>{var b;if(g.touches.length!==1){a=a||g.touches.length>1;return}const m=g.touches[0],S=m.clientX-o,T=m.clientY-l,A=Math.hypot(m.clientX-n,m.clientY-r);!c&&A>=Wg&&(c=!0),c&&(g.preventDefault(),(b=e.current)==null||b.panBy(-S,-T)),o=m.clientX,l=m.clientY},x=g=>{var T;if(g.touches.length>0)return;if(a){a=!1,c=!1;return}if(c){c=!1;return}const m=Date.now(),S=Math.hypot(o-f,l-d);if(h!==0&&m-h<=Gg&&S<=Yg){(T=e.current)==null||T.handleMobileDoubleTap(o,l),h=0;return}h=m,f=o,d=l},y=()=>{c=!1,a=!1};return s.addEventListener("touchstart",p,{passive:!0}),s.addEventListener("touchmove",v,{passive:!1}),s.addEventListener("touchend",x,{passive:!0}),s.addEventListener("touchcancel",y,{passive:!0}),()=>{s.removeEventListener("touchstart",p),s.removeEventListener("touchmove",v),s.removeEventListener("touchend",x),s.removeEventListener("touchcancel",y)}},[u,t,i,e])}export{Qm as C,Fr as a,Bv as b,Wm as c,tp as d,ep as e,Jm as f,Hm as g,rp as h,bo as i,Mv as j,qn as m,be as p,lt as r,Vm as s,xe as t,kv as u};
