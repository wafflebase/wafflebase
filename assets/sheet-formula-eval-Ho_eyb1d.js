var fe=Object.defineProperty;var me=(u,a,r)=>a in u?fe(u,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[a]=r;var rt=(u,a,r)=>me(u,typeof a!="symbol"?a+"":a,r);import{a as K,F as J,b as G}from"./sheet-formula-parser-CbheDyXI.js";import{t as b,i as F,a as nt,p as ut,b as ct,c as tt,d as It,e as q}from"./sheet-core-FjLOLK3Q.js";class it{constructor(){rt(this,"ref");rt(this,"bool");rt(this,"num");rt(this,"str")}static create(){return new it}setRef(a){return this.ref=a,this}setBool(a){return this.bool=a,this}setNum(a){return this.num=a,this}setStr(a){return this.str=a,this}map(a,r){return a.t==="bool"&&this.bool?this.bool(a):a.t==="num"&&this.num?this.num(a):a.t==="str"&&this.str?this.str(a):a.t==="ref"&&this.ref&&r?this.ref(a,r):a}*iterate(a,r,s){for(const t of a.expr()){const e=r(t);if(e.t==="ref"&&s)for(const n of b([e.v]))yield this.ref({t:"ref",v:n},s);else yield this.map(e)}}}function le(u){return{t:"num",v:u.v?1:0}}function ve(u){const a=Number(u);return{t:"num",v:isNaN(a)?0:a}}function pe(u,a){var t;if(F(u.v))return{t:"err",v:"#VALUE!"};const r=((t=a.get(u.v))==null?void 0:t.v)||"",s=Number(r);return{t:"num",v:isNaN(s)?0:s}}const v=it.create().setRef(pe).setBool(le).setStr(ve);function he(u){return{t:"bool",v:u.v!==0}}function ge(u,a){var t;if(F(u.v))return{t:"err",v:"#VALUE!"};const r=((t=a.get(u.v))==null?void 0:t.v)||"";if(r==="TRUE"||r==="true")return{t:"bool",v:!0};if(r==="FALSE"||r==="false"||r==="")return{t:"bool",v:!1};const s=Number(r);return isNaN(s)?{t:"err",v:"#VALUE!"}:{t:"bool",v:s!==0}}const O=it.create().setRef(ge).setNum(he).setStr(()=>({t:"err",v:"#VALUE!"}));function Ne(u){return{t:"str",v:u.v.toString()}}function Ae(u){return{t:"str",v:u.v?"TRUE":"FALSE"}}function jt(u,a){var s;return F(u.v)?{t:"err",v:"#VALUE!"}:{t:"str",v:((s=a.get(u.v))==null?void 0:s.v)||""}}it.create().setRef(jt).setNum(Ne).setBool(Ae);const wt=new Map([["SUM",de],["ABS",xe],["ROUND",Me],["ROUNDUP",Re],["ROUNDDOWN",be],["INT",Te],["MOD",Ie],["SQRT",Se],["POWER",Le],["PRODUCT",Ue],["MEDIAN",ye],["IF",De],["IFS",Ve],["SWITCH",Oe],["AND",we],["OR",Pe],["NOT",_e],["AVERAGE",ke],["MIN",Be],["MAX",He],["COUNT",Xe],["COUNTA",Ye],["COUNTBLANK",Ge],["COUNTIF",qe],["SUMIF",We],["COUNTIFS",Ke],["SUMIFS",Qe],["MATCH",$e],["INDEX",ze],["VLOOKUP",je],["HLOOKUP",Je],["TRIM",Ze],["LEN",tr],["LEFT",er],["RIGHT",rr],["MID",nr],["CONCATENATE",te],["CONCAT",ar],["FIND",sr],["SEARCH",or],["TEXTJOIN",ur],["LOWER",cr],["UPPER",ir],["PROPER",fr],["SUBSTITUTE",mr],["TODAY",lr],["NOW",vr],["DATE",pr],["TIME",hr],["DAYS",gr],["YEAR",Nr],["MONTH",Ar],["DAY",dr],["HOUR",xr],["MINUTE",Er],["SECOND",Mr],["WEEKDAY",Rr],["RAND",Fe],["RANDBETWEEN",Ce],["ISBLANK",br],["ISNUMBER",Tr],["ISTEXT",Ir],["ISERROR",Sr],["ISERR",Lr],["ISNA",Fr],["ISLOGICAL",Cr],["ISNONTEXT",Ur],["IFERROR",yr],["IFNA",Dr],["PI",Vr],["SIGN",Or],["EVEN",wr],["ODD",Pr],["EXP",_r],["LN",kr],["LOG",Br],["SIN",Hr],["COS",Xr],["TAN",Yr],["ASIN",Gr],["ACOS",qr],["ATAN",Wr],["ATAN2",Kr],["DEGREES",Qr],["RADIANS",$r],["CEILING",zr],["FLOOR",jr],["TRUNC",Jr],["MROUND",Zr],["EXACT",tn],["REPLACE",en],["REPT",rn],["T",nn],["VALUE",an],["TEXT",sn],["CHAR",on],["CODE",un],["AVERAGEIF",cn],["AVERAGEIFS",fn],["LARGE",mn],["SMALL",ln],["N",vn],["SUMPRODUCT",pn],["GCD",hn],["LCM",gn],["COMBIN",Nn],["FACT",An],["QUOTIENT",dn],["XOR",xn],["CHOOSE",En],["TYPE",Mn],["EDATE",Rn],["EOMONTH",bn],["NETWORKDAYS",Tn],["DATEVALUE",In],["TIMEVALUE",Sn],["DATEDIF",Ln],["ROW",Fn],["COLUMN",Cn],["ROWS",Un],["COLUMNS",yn],["ADDRESS",Dn],["HYPERLINK",Vn],["MINIFS",On],["MAXIFS",wn],["RANK",Pt],["PERCENTILE",_t],["CLEAN",Pn],["NUMBERVALUE",_n],["STDEV",kt],["STDEVP",Bt],["STDEV.S",kt],["STDEV.P",Bt],["VAR",Ht],["VARP",Xt],["VAR.S",Ht],["VAR.P",Xt],["MODE",Yt],["MODE.SNGL",Yt],["SUMSQ",kn],["NA",Bn],["QUARTILE",Gt],["QUARTILE.INC",Gt],["COUNTUNIQUE",Hn],["FIXED",Xn],["DOLLAR",Yn],["WEEKNUM",Gn],["ISOWEEKNUM",qn],["WORKDAY",Wn],["YEARFRAC",Kn],["LOOKUP",Qn],["INDIRECT",$n],["ERROR.TYPE",zn],["ISDATE",jn],["SPLIT",Jn],["JOIN",Zn],["REGEXMATCH",ta],["FORECAST",qt],["FORECAST.LINEAR",qt],["SLOPE",ea],["INTERCEPT",ra],["CORREL",na],["XLOOKUP",aa],["OFFSET",sa],["ISEVEN",oa],["ISODD",ua],["FACTDOUBLE",ca],["BASE",ia],["DECIMAL",fa],["SQRTPI",ma],["SINH",la],["COSH",va],["TANH",pa],["ASINH",ha],["ACOSH",ga],["ATANH",Na],["COT",Aa],["CSC",da],["SEC",xa],["REGEXEXTRACT",Ea],["REGEXREPLACE",Ma],["UNICODE",Ra],["UNICHAR",ba],["GEOMEAN",Ta],["HARMEAN",Ia],["AVEDEV",Sa],["DEVSQ",La],["TRIMMEAN",Fa],["PERMUT",Ca],["PMT",Ua],["FV",ya],["PV",Da],["NPV",Va],["NPER",Oa],["IPMT",wa],["PPMT",Pa],["SLN",_a],["EFFECT",ka],["RATE",Ba],["IRR",Ha],["DB",Xa],["DDB",Ya],["NOMINAL",Ga],["CUMIPMT",qa],["CUMPRINC",Wa],["AVERAGEA",Ka],["MINA",Qa],["MAXA",$a],["FISHER",za],["FISHERINV",ja],["GAMMA",Ja],["GAMMALN",Za],["NORMDIST",Wt],["NORM.DIST",Wt],["NORMINV",Kt],["NORM.INV",Kt],["LOGNORMAL.DIST",ts],["LOGNORMAL.INV",es],["STANDARDIZE",rs],["WEIBULL.DIST",ns],["POISSON.DIST",as],["BINOM.DIST",ss],["EXPON.DIST",os],["CONFIDENCE.NORM",us],["CONFIDENCE.T",ps],["CHISQ.DIST",cs],["CHISQ.INV",is],["T.DIST",fs],["T.INV",ms],["HYPGEOM.DIST",ls],["NEGBINOM.DIST",vs],["ARABIC",hs],["ROMAN",gs],["MULTINOMIAL",Ns],["SERIESSUM",As],["DELTA",ds],["GESTEP",xs],["ERF",Es],["ERFC",Ms],["XNPV",Rs],["XIRR",bs],["SYD",Ts],["MIRR",Is],["TBILLEQ",Ss],["TBILLPRICE",Ls],["TBILLYIELD",Fs],["DOLLARDE",Cs],["DOLLARFR",Us],["ENCODEURL",ys],["ISURL",Ds],["ISFORMULA",Vs],["FORMULATEXT",Os],["CEILING.MATH",ws],["FLOOR.MATH",Ps],["CEILING.PRECISE",_s],["FLOOR.PRECISE",ks],["COVAR",Qt],["COVARIANCE.P",Qt],["COVARIANCE.S",Bs],["RSQ",Hs],["STEYX",Xs],["SUMX2MY2",Ys],["SUMX2PY2",Gs],["SUMXMY2",qs],["PERCENTILE.INC",_t],["PERCENTILE.EXC",Ws],["QUARTILE.EXC",Ks],["RANK.AVG",Qs],["RANK.EQ",Pt],["PERCENTRANK",$t],["PERCENTRANK.INC",$t],["PERCENTRANK.EXC",$s],["BETA.DIST",zs],["BETA.INV",js],["F.DIST",Js],["F.INV",Zs],["GAMMA.DIST",to],["GAMMA.INV",eo],["CHISQ.DIST.RT",ro],["CHISQ.INV.RT",no],["T.DIST.RT",ao],["T.DIST.2T",so],["T.INV.2T",oo],["F.DIST.RT",uo],["F.INV.RT",co],["BINOM.INV",io],["TEXTBEFORE",fo],["TEXTAFTER",mo],["VALUETOTEXT",lo],["SEQUENCE",vo],["RANDARRAY",po],["SORT",ho],["UNIQUE",go],["FLATTEN",No],["TRANSPOSE",Ao],["NORM.S.DIST",xo],["NORM.S.INV",Eo],["SUBTOTAL",Mo],["VARA",Ro],["VARPA",bo],["SKEW",To],["KURT",Io],["ISREF",So],["SHEET",Lo],["SHEETS",Fo],["MDETERM",Co],["PROB",Uo],["CONVERT",yo],["BITAND",Do],["BITOR",Vo],["BITXOR",Oo],["BITLSHIFT",wo],["BITRSHIFT",Po],["HEX2DEC",_o],["DEC2HEX",ko],["BIN2DEC",Bo],["DEC2BIN",Ho],["OCT2DEC",Xo],["DEC2OCT",Yo],["COMPLEX",Go],["IMREAL",qo],["IMAGINARY",Wo],["IMABS",Ko],["IMSUM",Qo],["IMSUB",$o],["IMPRODUCT",zo],["IMDIV",jo],["IMCONJUGATE",Jo],["IMARGUMENT",Zo],["IMPOWER",tu],["IMSQRT",eu],["IMEXP",ru],["IMLN",nu],["IMLOG2",au],["IMLOG10",su],["IMSIN",ou],["IMCOS",uu],["IMTAN",cu],["IMSINH",iu],["IMCOSH",fu],["IMSEC",mu],["IMCSC",lu],["IMCOT",vu],["HEX2BIN",pu],["HEX2OCT",hu],["BIN2HEX",gu],["BIN2OCT",Nu],["OCT2HEX",Au],["OCT2BIN",du],["BESSELJ",Eu],["BESSELY",Mu],["BESSELI",bu],["BESSELK",Tu],["ACCRINT",Iu],["ACCRINTM",Su],["COUPDAYBS",Lu],["COUPDAYS",Fu],["COUPDAYSNC",Cu],["COUPNCD",Uu],["COUPNUM",yu],["COUPPCD",Du],["DISC",Vu],["PRICEDISC",Ou],["YIELDDISC",wu],["DURATION",Pu],["MDURATION",_u],["RECEIVED",ku],["INTRATE",Bu],["PRICE",Hu],["YIELD",Xu],["PRICEMAT",Yu],["YIELDMAT",Gu],["AMORLINC",qu],["ISPMT",Wu],["FVSCHEDULE",Ku],["PDURATION",Qu],["RRI",$u],["DSUM",zu],["DCOUNT",ju],["DCOUNTA",Ju],["DAVERAGE",Zu],["DMAX",tc],["DMIN",ec],["DPRODUCT",rc],["DGET",nc],["DSTDEV",ac],["DSTDEVP",sc],["DVAR",oc],["DVARP",uc],["GROWTH",cc],["TREND",ic],["LINEST",fc],["LOGEST",mc],["FREQUENCY",lc],["MODE.MULT",vc],["AGGREGATE",pc],["COMBINA",hc],["PERMUTATIONA",gc],["T.TEST",Nc],["Z.TEST",Ac],["AREAS",dc],["CELL",xc],["MMULT",Ec],["MINVERSE",Mc],["XMATCH",Rc],["TOCOL",se],["TOROW",bc],["TEXTSPLIT",Tc],["CHOOSEROWS",Ic],["CHOOSECOLS",Sc],["TAKE",Lc],["DROP",Fc],["HSTACK",oe],["VSTACK",Cc],["SORTBY",Uc],["WRAPCOLS",ue],["WRAPROWS",yc],["GAUSS",Dc],["PHI",Vc],["STDEVA",Oc],["STDEVPA",wc],["SKEW.P",Pc],["CHISQ.TEST",_c],["F.TEST",Hc],["ISO.CEILING",Xc],["FILTER",Yc],["SECH",Gc],["CSCH",qc],["COTH",Wc],["ACOT",Kc],["ACOTH",Qc],["DAYS360",$c],["WORKDAY.INTL",zc],["NETWORKDAYS.INTL",jc],["EXPAND",Jc],["MUNIT",Zc],["BINOM.DIST.RANGE",ti]]);function de(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0;for(const e of v.iterate(s,a,r)){if(e.t==="err")return e;t+=e.v}return{t:"num",v:t}}function xe(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.abs(e.v)}}function Ee(u){return u>=0?Math.floor(u+.5):Math.ceil(u-.5)}function St(u,a,r){if(!u)return{t:"num",v:0};const s=v.map(a(u),r);return s.t==="err"?s:{t:"num",v:Math.trunc(s.v)}}function w(u){return typeof u=="object"&&u!==null&&u.t==="err"}function I(u,a,r){const s=a(u);return s.t==="err"?s:s.t!=="ref"||!r?{t:"err",v:"#VALUE!"}:{t:"refs",v:Array.from(b([s.v]))}}function P(u,a,r){const s=a(u);if(s.t==="err")return s;if(s.t!=="ref"||!r)return{t:"err",v:"#VALUE!"};if(!F(s.v))return{t:"matrix",v:{refs:[s.v],rowCount:1,colCount:1}};try{let t=s.v,e="";if(nt(s.v)){const{sheetName:i,localRef:f}=ut(s.v);t=f,e=`${i}!`}const[n,o]=tt(t),c=[];for(let i=n.r;i<=o.r;i++)for(let f=n.c;f<=o.c;f++)c.push(`${e}${q({r:i,c:f})}`);return{t:"matrix",v:{refs:c,rowCount:o.r-n.r+1,colCount:o.c-n.c+1}}}catch{return{t:"err",v:"#VALUE!"}}}function Jt(u){const a=u===""?void 0:Number(u),r=a===void 0||isNaN(a)?void 0:a,s=u.toUpperCase(),t=s==="TRUE"?!0:s==="FALSE"?!1:void 0;return{normalized:u.toLowerCase(),numericValue:r,boolValue:t}}function Lt(u,a){const r=d(u,a);return r.t==="err"?r:Jt(r.v)}function Z(u,a){var s;const r=((s=a==null?void 0:a.get(u))==null?void 0:s.v)||"";return Jt(r)}function Ft(u,a){return u.numericValue!==void 0&&a.numericValue!==void 0?u.numericValue===a.numericValue:u.boolValue!==void 0&&a.boolValue!==void 0?u.boolValue===a.boolValue:u.normalized===a.normalized}function ht(u,a){return u.numericValue!==void 0&&a.numericValue!==void 0?u.numericValue-a.numericValue:u.boolValue!==void 0&&a.boolValue!==void 0?Number(u.boolValue)-Number(a.boolValue):u.normalized.localeCompare(a.normalized)}function Zt(u){const a=Number(u);return isNaN(a)?0:a}function Q(u,a){if(u.t==="err")return u;if(u.t==="num")return{op:"=",value:u.v.toString(),numericValue:u.v};if(u.t==="bool")return{op:"=",value:u.v?"TRUE":"FALSE",boolValue:u.v};const r=d(u,a);if(r.t==="err")return r;const s=/^(<=|>=|<>|=|<|>)(.*)$/.exec(r.v),t=(s==null?void 0:s[1])||"=",e=s?s[2]:r.v;let n,o;if(e!==""){const i=Number(e);isNaN(i)?e.toUpperCase()==="TRUE"?o=!0:e.toUpperCase()==="FALSE"&&(o=!1):n=i}let c;return(t==="="||t==="<>")&&/(^|[^~])[*?]/.test(e)&&(c=new RegExp(`^${re(e)}$`,"i")),{op:t,value:e,numericValue:n,boolValue:o,wildcardPattern:c}}function $(u,a){const r=u===""?void 0:Number(u),s=r!==void 0&&!isNaN(r),t=u.toUpperCase(),e=t==="TRUE"?!0:t==="FALSE"?!1:void 0,n=u.toLowerCase(),o=a.value.toLowerCase();if(a.op==="<"||a.op==="<="||a.op===">"||a.op===">=")return a.numericValue!==void 0?s?a.op==="<"?r<a.numericValue:a.op==="<="?r<=a.numericValue:a.op===">"?r>a.numericValue:r>=a.numericValue:!1:a.op==="<"?n<o:a.op==="<="?n<=o:a.op===">"?n>o:n>=o;let c=!1;return a.wildcardPattern?c=a.wildcardPattern.test(u):a.numericValue!==void 0&&s?c=r===a.numericValue:a.boolValue!==void 0&&e!==void 0?c=e===a.boolValue:c=n===o,a.op==="="?c:!c}function Me(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=St(t[1],a,r);if(n.t==="err")return n;const o=10**n.v;return{t:"num",v:Ee(e.v*o)/o}}function Re(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=St(t[1],a,r);if(n.t==="err")return n;const o=10**n.v,c=e.v*o;return{t:"num",v:(c>=0?Math.ceil(c):Math.floor(c))/o}}function be(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=St(t[1],a,r);if(n.t==="err")return n;const o=10**n.v,c=e.v*o;return{t:"num",v:(c>=0?Math.floor(c):Math.ceil(c))/o}}function Te(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.floor(e.v)}}function Ie(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:n.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:e.v-n.v*Math.floor(e.v/n.v)}}function Se(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.sqrt(e.v)}}function Le(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.pow(e.v,n.v);return isFinite(o)?{t:"num",v:o}:{t:"err",v:"#VALUE!"}}function Fe(u,a,r){const s=u.args();return s&&s.expr().length>0?{t:"err",v:"#N/A!"}:{t:"num",v:Math.random()}}function Ce(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.ceil(e.v),c=Math.floor(n.v);return o>c?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.floor(Math.random()*(c-o+1))+o}}function Ue(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=1;for(const e of v.iterate(s,a,r)){if(e.t==="err")return e;t*=e.v}return{t:"num",v:t}}function ye(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const n of v.iterate(s,a,r)){if(n.t==="err")return n;t.push(n.v)}if(t.length===0)return{t:"err",v:"#VALUE!"};t.sort((n,o)=>n-o);const e=Math.floor(t.length/2);return t.length%2===1?{t:"num",v:t[e]}:{t:"num",v:(t[e-1]+t[e])/2}}function De(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=O.map(a(t[0]),r);return e.t==="err"?e:e.v?a(t[1]):t.length===3?a(t[2]):{t:"bool",v:!1}}function Ve(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length%2!==0)return{t:"err",v:"#N/A!"};for(let e=0;e<t.length;e+=2){const n=O.map(a(t[e]),r);if(n.t==="err")return n;if(n.v)return a(t[e+1])}return{t:"err",v:"#N/A!"}}function Oe(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=t.length-1,o=n%2===1,c=o?(n-1)/2:n/2;for(let i=0;i<c;i++){const f=d(a(t[1+i*2]),r);if(f.t==="err")return f;if(f.v===e.v)return a(t[2+i*2])}return o?a(t[t.length-1]):{t:"err",v:"#N/A!"}}function we(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};for(const t of O.iterate(s,a,r)){if(t.t==="err")return t;if(!t.v)return{t:"bool",v:!1}}return{t:"bool",v:!0}}function Pe(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};for(const t of O.iterate(s,a,r)){if(t.t==="err")return t;if(t.v)return{t:"bool",v:!0}}return{t:"bool",v:!1}}function _e(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=O.map(a(t[0]),r);return e.t==="err"?e:{t:"bool",v:!e.v}}function ke(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0,e=0;for(const n of v.iterate(s,a,r)){if(n.t==="err")return n;t+=n.v,e++}return e===0?{t:"err",v:"#VALUE!"}:{t:"num",v:t/e}}function Be(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=1/0;for(const e of v.iterate(s,a,r)){if(e.t==="err")return e;e.v<t&&(t=e.v)}return{t:"num",v:t}}function He(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=-1/0;for(const e of v.iterate(s,a,r)){if(e.t==="err")return e;e.v>t&&(t=e.v)}return{t:"num",v:t}}function Xe(u,a,r){var e,n;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0;for(const o of s.expr()){const c=a(o);if(c.t==="num")t++;else if(c.t==="bool")t++;else if(c.t==="ref"&&r)if(F(c.v))for(const i of b([c.v])){const f=((e=r.get(i))==null?void 0:e.v)||"";f!==""&&!isNaN(Number(f))&&t++}else{const i=((n=r.get(c.v))==null?void 0:n.v)||"";i!==""&&!isNaN(Number(i))&&t++}}return{t:"num",v:t}}function Ye(u,a,r){var e,n;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0;for(const o of s.expr()){const c=a(o);if(c.t==="num"||c.t==="bool")t++;else if(c.t==="str")c.v!==""&&t++;else if(c.t==="ref"&&r)if(F(c.v))for(const i of b([c.v]))(((e=r.get(i))==null?void 0:e.v)||"")!==""&&t++;else(((n=r.get(c.v))==null?void 0:n.v)||"")!==""&&t++}return{t:"num",v:t}}function Ge(u,a,r){var e,n;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0;for(const o of s.expr()){const c=a(o);if(c.t==="str"){c.v===""&&t++;continue}if(c.t!=="ref"||!r)continue;if(F(c.v)){for(const f of b([c.v]))(((e=r.get(f))==null?void 0:e.v)||"")===""&&t++;continue}(((n=r.get(c.v))==null?void 0:n.v)||"")===""&&t++}return{t:"num",v:t}}function qe(u,a,r){var c;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=I(t[0],a,r);if(e.t==="err")return e;const n=Q(a(t[1]),r);if(w(n))return n;let o=0;for(const i of e.v){const f=((c=r==null?void 0:r.get(i))==null?void 0:c.v)||"";$(f,n)&&o++}return{t:"num",v:o}}function We(u,a,r){var i,f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=I(t[0],a,r);if(e.t==="err")return e;const n=Q(a(t[1]),r);if(w(n))return n;const o=t.length===3?I(t[2],a,r):e;if(o.t==="err")return o;if(e.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};let c=0;for(let m=0;m<e.v.length;m++){const l=((i=r==null?void 0:r.get(e.v[m]))==null?void 0:i.v)||"";if(!$(l,n))continue;const p=((f=r==null?void 0:r.get(o.v[m]))==null?void 0:f.v)||"";c+=Zt(p)}return{t:"num",v:c}}function Ke(u,a,r){var i;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length%2!==0)return{t:"err",v:"#N/A!"};const e=[],n=[];for(let f=0;f<t.length;f+=2){const m=I(t[f],a,r);if(m.t==="err")return m;e.push(m.v);const l=Q(a(t[f+1]),r);if(w(l))return l;n.push(l)}const o=e[0].length;if(e.some(f=>f.length!==o))return{t:"err",v:"#VALUE!"};let c=0;for(let f=0;f<o;f++){let m=!0;for(let l=0;l<e.length;l++){const p=((i=r==null?void 0:r.get(e[l][f]))==null?void 0:i.v)||"";if(!$(p,n[l])){m=!1;break}}m&&c++}return{t:"num",v:c}}function Qe(u,a,r){var i,f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||(t.length-1)%2!==0)return{t:"err",v:"#N/A!"};const e=I(t[0],a,r);if(e.t==="err")return e;const n=[],o=[];for(let m=1;m<t.length;m+=2){const l=I(t[m],a,r);if(l.t==="err")return l;n.push(l.v);const p=Q(a(t[m+1]),r);if(w(p))return p;o.push(p)}if(n.some(m=>m.length!==e.v.length))return{t:"err",v:"#VALUE!"};let c=0;for(let m=0;m<e.v.length;m++){let l=!0;for(let p=0;p<n.length;p++){const h=((i=r==null?void 0:r.get(n[p][m]))==null?void 0:i.v)||"";if(!$(h,o[p])){l=!1;break}}l&&(c+=Zt(((f=r==null?void 0:r.get(e.v[m]))==null?void 0:f.v)||""))}return{t:"num",v:c}}function $e(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=Lt(a(t[0]),r);if(w(e))return e;const n=P(t[1],a,r);if(n.t==="err")return n;if(n.v.rowCount>1&&n.v.colCount>1)return{t:"err",v:"#N/A!"};let o=1;if(t.length===3){const i=v.map(a(t[2]),r);if(i.t==="err")return i;o=Math.trunc(i.v)}if(o!==-1&&o!==0&&o!==1)return{t:"err",v:"#N/A!"};if(o===0){for(let i=0;i<n.v.refs.length;i++){const f=Z(n.v.refs[i],r);if(Ft(f,e))return{t:"num",v:i+1}}return{t:"err",v:"#N/A!"}}let c=-1;if(o===1){let i=-1/0;for(let f=0;f<n.v.refs.length;f++){const m=Z(n.v.refs[f],r),l=ht(m,e);l<=0&&l>i&&(i=l,c=f)}}else{let i=1/0;for(let f=0;f<n.v.refs.length;f++){const m=Z(n.v.refs[f],r),l=ht(m,e);l>=0&&l<i&&(i=l,c=f)}}return c<0?{t:"err",v:"#N/A!"}:{t:"num",v:c+1}}function ze(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if(e.t==="err")return e;let n=1,o=1;if(t.length>=2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);t.length===2&&e.v.rowCount===1&&e.v.colCount>1?o=i:n=i}if(t.length===3){const c=v.map(a(t[2]),r);if(c.t==="err")return c;o=Math.trunc(c.v)}return n<=0||o<=0?{t:"err",v:"#VALUE!"}:n>e.v.rowCount||o>e.v.colCount?{t:"err",v:"#REF!"}:{t:"ref",v:e.v.refs[(n-1)*e.v.colCount+(o-1)]}}function je(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=Lt(a(t[0]),r);if(w(e))return e;const n=P(t[1],a,r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<=0)return{t:"err",v:"#VALUE!"};if(c>n.v.colCount)return{t:"err",v:"#REF!"};let i=!0;if(t.length===4){const l=O.map(a(t[3]),r);if(l.t==="err")return l;i=l.v}if(!i){for(let l=0;l<n.v.rowCount;l++){const p=n.v.refs[l*n.v.colCount],h=Z(p,r);if(Ft(h,e))return{t:"ref",v:n.v.refs[l*n.v.colCount+(c-1)]}}return{t:"err",v:"#N/A!"}}let f=-1,m=-1/0;for(let l=0;l<n.v.rowCount;l++){const p=n.v.refs[l*n.v.colCount],h=Z(p,r),g=ht(h,e);g<=0&&g>m&&(m=g,f=l)}return f<0?{t:"err",v:"#N/A!"}:{t:"ref",v:n.v.refs[f*n.v.colCount+(c-1)]}}function Je(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=Lt(a(t[0]),r);if(w(e))return e;const n=P(t[1],a,r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<=0)return{t:"err",v:"#VALUE!"};if(c>n.v.rowCount)return{t:"err",v:"#REF!"};let i=!0;if(t.length===4){const l=O.map(a(t[3]),r);if(l.t==="err")return l;i=l.v}if(!i){for(let l=0;l<n.v.colCount;l++){const p=n.v.refs[l],h=Z(p,r);if(Ft(h,e))return{t:"ref",v:n.v.refs[(c-1)*n.v.colCount+l]}}return{t:"err",v:"#N/A!"}}let f=-1,m=-1/0;for(let l=0;l<n.v.colCount;l++){const p=n.v.refs[l],h=Z(p,r),g=ht(h,e);g<=0&&g>m&&(m=g,f=l)}return f<0?{t:"err",v:"#N/A!"}:{t:"ref",v:n.v.refs[(c-1)*n.v.colCount+f]}}function d(u,a){return u.t==="err"||u.t==="str"?u:u.t==="num"?{t:"str",v:u.v.toString()}:u.t==="bool"?{t:"str",v:u.v?"TRUE":"FALSE"}:u.t==="ref"&&a?jt(u,a):{t:"err",v:"#VALUE!"}}function Ze(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);return e.t==="err"?e:{t:"str",v:e.v.trim()}}function tr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);return e.t==="err"?e:{t:"num",v:e.v.length}}function er(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;let n=1;if(t.length===2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;n=o.v}return{t:"str",v:e.v.slice(0,n)}}function rr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;let n=1;if(t.length===2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;n=o.v}return{t:"str",v:e.v.slice(-n)}}function nr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=n.v-1;return{t:"str",v:e.v.slice(c,c+o.v)}}function te(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2)return{t:"err",v:"#N/A!"};let e="";for(const n of t){const o=d(a(n),r);if(o.t==="err")return o;e+=o.v}return{t:"str",v:e}}function ar(u,a,r){return te(u,a,r)}function ee(u,a,r,s){if(!u)return{t:"num",v:1};const t=v.map(r(u),s);if(t.t==="err")return t;const e=Math.trunc(t.v);return e<1||e>a.length+1?{t:"err",v:"#VALUE!"}:{t:"num",v:e}}function sr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;const o=ee(t[2],n.v,a,r);if(o.t==="err")return o;if(e.v==="")return{t:"num",v:o.v};const c=n.v.indexOf(e.v,o.v-1);return c<0?{t:"err",v:"#VALUE!"}:{t:"num",v:c+1}}function re(u){let a="";for(let r=0;r<u.length;r++){const s=u[r];if(s==="~"&&r+1<u.length){a+=u[r+1].replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r++;continue}if(s==="*"){a+=".*";continue}if(s==="?"){a+=".";continue}a+=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}return a}function or(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;const o=ee(t[2],n.v,a,r);if(o.t==="err")return o;if(e.v==="")return{t:"num",v:o.v};const c=re(e.v),i=new RegExp(c,"i"),f=n.v.slice(o.v-1),m=i.exec(f);return!m||m.index===void 0?{t:"err",v:"#VALUE!"}:{t:"num",v:o.v+m.index}}function ur(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=O.map(a(t[1]),r);if(n.t==="err")return n;const o=[];for(const c of t.slice(2)){const i=a(c);if(i.t==="ref"&&r&&F(i.v)){for(const m of b([i.v])){const l=d({t:"ref",v:m},r);if(l.t==="err")return l;n.v&&l.v===""||o.push(l.v)}continue}const f=d(i,r);if(f.t==="err")return f;n.v&&f.v===""||o.push(f.v)}return{t:"str",v:o.join(e.v)}}function cr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);return e.t==="err"?e:{t:"str",v:e.v.toLowerCase()}}function ir(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);return e.t==="err"?e:{t:"str",v:e.v.toUpperCase()}}function fr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);return e.t==="err"?e:{t:"str",v:e.v.toLowerCase().replace(/\b([a-z])([a-z]*)/g,(o,c,i)=>c.toUpperCase()+i)}}function mr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;const o=d(a(t[2]),r);if(o.t==="err")return o;if(n.v==="")return{t:"str",v:e.v};if(t.length===3)return{t:"str",v:e.v.split(n.v).join(o.v)};const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<=0)return{t:"err",v:"#VALUE!"};let f=0,m=0;for(;;){const l=e.v.indexOf(n.v,f);if(l<0)return{t:"str",v:e.v};if(m++,m===i)return{t:"str",v:e.v.slice(0,l)+o.v+e.v.slice(l+n.v.length)};f=l+n.v.length}}function H(u){const a=u.getFullYear(),r=String(u.getMonth()+1).padStart(2,"0"),s=String(u.getDate()).padStart(2,"0");return`${a}-${r}-${s}`}function ne(u){const a=String(u.getHours()).padStart(2,"0"),r=String(u.getMinutes()).padStart(2,"0"),s=String(u.getSeconds()).padStart(2,"0");return`${a}:${r}:${s}`}function lr(u,a,r){const s=u.args();return s&&s.expr().length>0?{t:"err",v:"#N/A!"}:{t:"str",v:H(new Date)}}function vr(u,a,r){const s=u.args();if(s&&s.expr().length>0)return{t:"err",v:"#N/A!"};const t=new Date;return{t:"str",v:`${H(t)} ${ne(t)}`}}function M(u,a){const r=d(u,a);if(r.t==="err")return r;const s=new Date(r.v);return isNaN(s.getTime())?{t:"err",v:"#VALUE!"}:s}function gt(u,a){const r=d(u,a);if(r.t==="err")return r;const s=/^(\d{1,2}):(\d{1,2})(?::(\d{1,2}))?$/.exec(r.v.trim());if(s){const e=Number(s[1]),n=Number(s[2]),o=Number(s[3]||"0");return e<0||e>23||n<0||n>59||o<0||o>59?{t:"err",v:"#VALUE!"}:new Date(1970,0,1,e,n,o)}const t=new Date(r.v);return isNaN(t.getTime())?{t:"err",v:"#VALUE!"}:t}function pr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(e.v),i=Math.trunc(n.v),f=Math.trunc(o.v);return!isFinite(c)||!isFinite(i)||!isFinite(f)?{t:"err",v:"#VALUE!"}:{t:"str",v:H(new Date(c,i-1,f))}}function hr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(e.v),i=Math.trunc(n.v),f=Math.trunc(o.v);return!isFinite(c)||!isFinite(i)||!isFinite(f)?{t:"err",v:"#VALUE!"}:{t:"str",v:ne(new Date(1970,0,1,c,i,f))}}function gr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=24*60*60*1e3,c=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),i=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate());return{t:"num",v:(c-i)/o}}function Nr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);return e instanceof Date?{t:"num",v:e.getFullYear()}:e}function Ar(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);return e instanceof Date?{t:"num",v:e.getMonth()+1}:e}function dr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);return e instanceof Date?{t:"num",v:e.getDate()}:e}function xr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=gt(a(t[0]),r);return e instanceof Date?{t:"num",v:e.getHours()}:e}function Er(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=gt(a(t[0]),r);return e instanceof Date?{t:"num",v:e.getMinutes()}:e}function Mr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=gt(a(t[0]),r);return e instanceof Date?{t:"num",v:e.getSeconds()}:e}function Rr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;let n=1;if(t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;n=Math.trunc(c.v)}const o=e.getDay();return n===1?{t:"num",v:o+1}:n===2?{t:"num",v:o===0?7:o}:n===3?{t:"num",v:o===0?6:o-1}:{t:"err",v:"#VALUE!"}}function br(u,a,r){var o;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);return e.t==="err"?e:e.t!=="ref"||!r?{t:"bool",v:!1}:F(e.v)?{t:"err",v:"#VALUE!"}:{t:"bool",v:(((o=r.get(e.v))==null?void 0:o.v)||"")===""}}function Tr(u,a,r){var i;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;if(e.t==="num")return{t:"bool",v:!0};if(e.t!=="ref"||!r)return{t:"bool",v:!1};if(F(e.v))return{t:"err",v:"#VALUE!"};const n=((i=r.get(e.v))==null?void 0:i.v)||"",o=n.toUpperCase();return{t:"bool",v:n!==""&&!(o==="TRUE"||o==="FALSE")&&!isNaN(Number(n))}}function Ir(u,a,r){var f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;if(e.t==="str")return{t:"bool",v:!0};if(e.t!=="ref"||!r)return{t:"bool",v:!1};if(F(e.v))return{t:"err",v:"#VALUE!"};const n=((f=r.get(e.v))==null?void 0:f.v)||"";if(n==="")return{t:"bool",v:!1};const o=n.toUpperCase(),c=o==="TRUE"||o==="FALSE",i=!isNaN(Number(n));return{t:"bool",v:!c&&!i}}function Sr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();return t.length!==1?{t:"err",v:"#N/A!"}:{t:"bool",v:a(t[0]).t==="err"}}function Lr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);return{t:"bool",v:e.t==="err"&&e.v!=="#N/A!"}}function Fr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);return{t:"bool",v:e.t==="err"&&e.v==="#N/A!"}}function Cr(u,a,r){var c;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;if(e.t==="bool")return{t:"bool",v:!0};if(e.t!=="ref"||!r)return{t:"bool",v:!1};if(F(e.v))return{t:"err",v:"#VALUE!"};const o=(((c=r.get(e.v))==null?void 0:c.v)||"").toUpperCase();return{t:"bool",v:o==="TRUE"||o==="FALSE"}}function Ur(u,a,r){var f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return{t:"bool",v:!0};if(e.t==="str")return{t:"bool",v:!1};if(e.t==="num"||e.t==="bool")return{t:"bool",v:!0};if(e.t!=="ref"||!r)return{t:"bool",v:!1};if(F(e.v))return{t:"err",v:"#VALUE!"};const n=((f=r.get(e.v))==null?void 0:f.v)||"";if(n==="")return{t:"bool",v:!0};const o=n.toUpperCase(),c=o==="TRUE"||o==="FALSE",i=!isNaN(Number(n));return{t:"bool",v:c||i}}function yr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=a(t[0]);return e.t==="err"?a(t[1]):e}function Dr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=a(t[0]);return e.t==="err"&&e.v==="#N/A!"?a(t[1]):e}function Vr(u,a,r){const s=u.args();return s&&s.expr().length>0?{t:"err",v:"#N/A!"}:{t:"num",v:Math.PI}}function Or(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.sign(e.v)}}function wr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=e.v;if(n===0)return{t:"num",v:0};const o=n>0?Math.ceil(n):Math.floor(n);return{t:"num",v:o%2===0?o:n>0?o+1:o-1}}function Pr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=e.v;if(n===0)return{t:"num",v:1};const o=n>0?Math.ceil(n):Math.floor(n);return{t:"num",v:Math.abs(o)%2===1?o:n>0?o+1:o-1}}function _r(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.exp(e.v)}}function kr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.log(e.v)}}function Br(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;if(e.v<=0)return{t:"err",v:"#VALUE!"};let n=10;if(t.length===2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;if(o.v<=0||o.v===1)return{t:"err",v:"#VALUE!"};n=o.v}return{t:"num",v:Math.log(e.v)/Math.log(n)}}function Hr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.sin(e.v)}}function Xr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.cos(e.v)}}function Yr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.tan(e.v)}}function Gr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<-1||e.v>1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.asin(e.v)}}function qr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<-1||e.v>1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.acos(e.v)}}function Wr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.atan(e.v)}}function Kr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:e.v===0&&n.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.atan2(n.v,e.v)}}function Qr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:e.v*180/Math.PI}}function $r(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:e.v*Math.PI/180}}function zr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=1;if(t.length===2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;n=o.v}return n===0?{t:"num",v:0}:e.v>0&&n<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.ceil(e.v/n)*n}}function jr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=1;if(t.length===2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;n=o.v}return n===0?{t:"num",v:0}:e.v>0&&n<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.floor(e.v/n)*n}}function Jr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=0;if(t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;n=Math.trunc(c.v)}const o=Math.pow(10,n);return{t:"num",v:Math.trunc(e.v*o)/o}}function Zr(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:n.v===0?{t:"num",v:0}:e.v>0&&n.v<0||e.v<0&&n.v>0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.round(e.v/n.v)*n.v}}function tn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);return n.t==="err"?n:{t:"bool",v:e.v===n.v}}function en(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=d(a(t[3]),r);if(c.t==="err")return c;const i=Math.trunc(n.v)-1,f=Math.trunc(o.v);return i<0||f<0?{t:"err",v:"#VALUE!"}:{t:"str",v:e.v.slice(0,i)+c.v+e.v.slice(i+f)}}function rn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);return o<0?{t:"err",v:"#VALUE!"}:{t:"str",v:e.v.repeat(o)}}function nn(u,a,r){var n;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err"||e.t==="str")return e;if(e.t==="ref"&&r){const o=((n=r.get(e.v))==null?void 0:n.v)||"";if(o==="")return{t:"str",v:""};const c=o.toUpperCase(),i=c==="TRUE"||c==="FALSE",f=!isNaN(Number(o));return i||f?{t:"str",v:""}:{t:"str",v:o}}return{t:"str",v:""}}function an(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=e.v.trim(),o=Number(n);return n===""||isNaN(o)?{t:"err",v:"#VALUE!"}:{t:"num",v:o}}function sn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;const o=n.v,c=e.v;if(o.endsWith("%")){const f=(o.slice(0,-1).split(".")[1]||"").length;return{t:"str",v:(c*100).toFixed(f)+"%"}}if(o.includes(",")){const i=(o.split(".")[1]||"").replace(/[^0#]/g,"").length,f=c.toFixed(i).split(".");return f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),{t:"str",v:f.join(".")}}if(o.includes(".")){const i=(o.split(".")[1]||"").length;return{t:"str",v:c.toFixed(i)}}return{t:"str",v:c.toFixed(0)}}function on(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.trunc(e.v);return n<1||n>65535?{t:"err",v:"#VALUE!"}:{t:"str",v:String.fromCharCode(n)}}function un(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);return e.t==="err"?e:e.v.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:e.v.charCodeAt(0)}}function cn(u,a,r){var f,m;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=I(t[0],a,r);if(e.t==="err")return e;const n=Q(a(t[1]),r);if(w(n))return n;const o=t.length===3?I(t[2],a,r):e;if(o.t==="err")return o;if(e.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};let c=0,i=0;for(let l=0;l<e.v.length;l++){const p=((f=r==null?void 0:r.get(e.v[l]))==null?void 0:f.v)||"";if(!$(p,n))continue;const h=((m=r==null?void 0:r.get(o.v[l]))==null?void 0:m.v)||"",g=Number(h);h!==""&&!isNaN(g)&&(c+=g,i++)}return i===0?{t:"err",v:"#VALUE!"}:{t:"num",v:c/i}}function fn(u,a,r){var f,m;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||(t.length-1)%2!==0)return{t:"err",v:"#N/A!"};const e=I(t[0],a,r);if(e.t==="err")return e;const n=[],o=[];for(let l=1;l<t.length;l+=2){const p=I(t[l],a,r);if(p.t==="err")return p;n.push(p.v);const h=Q(a(t[l+1]),r);if(w(h))return h;o.push(h)}if(n.some(l=>l.length!==e.v.length))return{t:"err",v:"#VALUE!"};let c=0,i=0;for(let l=0;l<e.v.length;l++){let p=!0;for(let h=0;h<n.length;h++){const g=((f=r==null?void 0:r.get(n[h][l]))==null?void 0:f.v)||"";if(!$(g,o[h])){p=!1;break}}if(p){const h=((m=r==null?void 0:r.get(e.v[l]))==null?void 0:m.v)||"",g=Number(h);h!==""&&!isNaN(g)&&(c+=g,i++)}}return i===0?{t:"err",v:"#VALUE!"}:{t:"num",v:c/i}}function mn(u,a,r){var i;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=[],n=a(t[0]);if(n.t==="err")return n;if(n.t==="num")e.push(n.v);else if(n.t==="ref"&&r)for(const f of b([n.v])){const m=((i=r.get(f))==null?void 0:i.v)||"";m!==""&&!isNaN(Number(m))&&e.push(Number(m))}const o=v.map(a(t[1]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);return c<1||c>e.length?{t:"err",v:"#VALUE!"}:(e.sort((f,m)=>m-f),{t:"num",v:e[c-1]})}function ln(u,a,r){var i;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=[],n=a(t[0]);if(n.t==="err")return n;if(n.t==="num")e.push(n.v);else if(n.t==="ref"&&r)for(const f of b([n.v])){const m=((i=r.get(f))==null?void 0:i.v)||"";m!==""&&!isNaN(Number(m))&&e.push(Number(m))}const o=v.map(a(t[1]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);return c<1||c>e.length?{t:"err",v:"#VALUE!"}:(e.sort((f,m)=>f-m),{t:"num",v:e[c-1]})}function vn(u,a,r){var n;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err"||e.t==="num")return e;if(e.t==="bool")return{t:"num",v:e.v?1:0};if(e.t==="ref"&&r){const o=((n=r.get(e.v))==null?void 0:n.v)||"";if(o==="")return{t:"num",v:0};const c=o.toUpperCase();if(c==="TRUE")return{t:"num",v:1};if(c==="FALSE")return{t:"num",v:0};const i=Number(o);return{t:"num",v:isNaN(i)?0:i}}return{t:"num",v:0}}function pn(u,a,r){var c;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1)return{t:"err",v:"#N/A!"};const e=[];for(const i of t){const f=I(i,a,r);if(f.t==="err")return f;const m=[];for(const l of f.v){const p=((c=r==null?void 0:r.get(l))==null?void 0:c.v)||"";m.push(p!==""&&!isNaN(Number(p))?Number(p):0)}e.push(m)}const n=e[0].length;if(e.some(i=>i.length!==n))return{t:"err",v:"#VALUE!"};let o=0;for(let i=0;i<n;i++){let f=1;for(const m of e)f*=m[i];o+=f}return{t:"num",v:o}}function ae(u,a){for(u=Math.abs(u),a=Math.abs(a);a;)[u,a]=[a,u%a];return u}function hn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0;for(const e of v.iterate(s,a,r)){if(e.t==="err")return e;const n=Math.trunc(e.v);if(n<0)return{t:"err",v:"#VALUE!"};t=ae(t,n)}return{t:"num",v:t}}function gn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=1,e=!1;for(const n of v.iterate(s,a,r)){if(n.t==="err")return n;const o=Math.trunc(n.v);if(o<0)return{t:"err",v:"#VALUE!"};if(o===0)return{t:"num",v:0};t=t/ae(t,o)*o,e=!0}return e?{t:"num",v:t}:{t:"err",v:"#VALUE!"}}function Nn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(e.v),c=Math.trunc(n.v);if(o<0||c<0||c>o)return{t:"err",v:"#VALUE!"};let i=1;for(let f=0;f<c;f++)i=i*(o-f)/(f+1);return{t:"num",v:Math.round(i)}}function An(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.trunc(e.v);if(n<0)return{t:"err",v:"#VALUE!"};let o=1;for(let c=2;c<=n;c++)o*=c;return{t:"num",v:o}}function dn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:n.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(e.v/n.v)}}function xn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0;for(const e of O.iterate(s,a,r)){if(e.t==="err")return e;e.v&&t++}return{t:"bool",v:t%2===1}}function En(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.trunc(e.v);return n<1||n>=t.length?{t:"err",v:"#VALUE!"}:a(t[n])}function Mn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};switch(a(t[0]).t){case"num":return{t:"num",v:1};case"str":return{t:"num",v:2};case"bool":return{t:"num",v:4};case"err":return{t:"num",v:16};case"ref":return{t:"num",v:1};default:return{t:"num",v:1}}}function Rn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v),c=new Date(e.getFullYear(),e.getMonth()+o,e.getDate());return{t:"str",v:H(c)}}function bn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v),c=new Date(e.getFullYear(),e.getMonth()+o+1,0);return{t:"str",v:H(c)}}function Tn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=e<=n?1:-1,c=o===1?e:n,i=o===1?n:e;let f=0;const m=new Date(c);for(;m<=i;){const l=m.getDay();l!==0&&l!==6&&f++,m.setDate(m.getDate()+1)}return{t:"num",v:f*o}}function In(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);return e instanceof Date?{t:"str",v:H(e)}:e}function Sn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=gt(a(t[0]),r);if(!(e instanceof Date))return e;const n=e.getHours(),o=e.getMinutes(),c=e.getSeconds();return{t:"num",v:(n*3600+o*60+c)/86400}}function Ln(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;if(e>n)return{t:"err",v:"#VALUE!"};const o=d(a(t[2]),r);if(o.t==="err")return o;const c=o.v.toUpperCase();if(c==="D"){const f=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate());return{t:"num",v:(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate())-f)/864e5}}if(c==="M"){let i=(n.getFullYear()-e.getFullYear())*12+(n.getMonth()-e.getMonth());return n.getDate()<e.getDate()&&i--,{t:"num",v:i}}if(c==="Y"){let i=n.getFullYear()-e.getFullYear();return(n.getMonth()<e.getMonth()||n.getMonth()===e.getMonth()&&n.getDate()<e.getDate())&&i--,{t:"num",v:i}}if(c==="MD"){let i=n.getDate()-e.getDate();if(i<0){const f=new Date(n.getFullYear(),n.getMonth(),0);i+=f.getDate()}return{t:"num",v:i}}if(c==="YM"){let i=n.getMonth()-e.getMonth();return i<0&&(i+=12),n.getDate()<e.getDate()&&(i--,i<0&&(i+=12)),{t:"num",v:i}}if(c==="YD"){const i=new Date(n.getFullYear(),e.getMonth(),e.getDate());i>n&&i.setFullYear(i.getFullYear()-1);const f=24*60*60*1e3,m=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate());return{t:"num",v:(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate())-m)/f}}return{t:"err",v:"#VALUE!"}}function Fn(u,a,r){const s=u.args();if(!s||s.expr().length===0)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;if(e.t!=="ref")return{t:"err",v:"#VALUE!"};const n=F(e.v)?e.v.split(":")[0]:e.v;let o=n;nt(n)&&(o=ut(n).localRef);try{return{t:"num",v:ct(o).r}}catch{return{t:"err",v:"#REF!"}}}function Cn(u,a,r){const s=u.args();if(!s||s.expr().length===0)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;if(e.t!=="ref")return{t:"err",v:"#VALUE!"};const n=F(e.v)?e.v.split(":")[0]:e.v;let o=n;nt(n)&&(o=ut(n).localRef);try{return{t:"num",v:ct(o).c}}catch{return{t:"err",v:"#REF!"}}}function Un(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;if(e.t!=="ref")return{t:"err",v:"#VALUE!"};if(!F(e.v))return{t:"num",v:1};let n=e.v;nt(e.v)&&(n=ut(e.v).localRef);try{const[o,c]=tt(n);return{t:"num",v:Math.abs(c.r-o.r)+1}}catch{return{t:"err",v:"#REF!"}}}function yn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;if(e.t!=="ref")return{t:"err",v:"#VALUE!"};if(!F(e.v))return{t:"num",v:1};let n=e.v;nt(e.v)&&(n=ut(e.v).localRef);try{const[o,c]=tt(n);return{t:"num",v:Math.abs(c.c-o.c)+1}}catch{return{t:"err",v:"#REF!"}}}function Dn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(e.v),c=Math.trunc(n.v);if(o<1||c<1)return{t:"err",v:"#VALUE!"};let i=1;if(t.length>=3){const m=v.map(a(t[2]),r);if(m.t==="err")return m;i=Math.trunc(m.v)}const f=It(c);switch(i){case 1:return{t:"str",v:`$${f}$${o}`};case 2:return{t:"str",v:`${f}$${o}`};case 3:return{t:"str",v:`$${f}${o}`};case 4:return{t:"str",v:`${f}${o}`};default:return{t:"err",v:"#VALUE!"}}}function Vn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;if(t.length===2){const n=d(a(t[1]),r);return n.t==="err"?n:{t:"str",v:n.v}}return{t:"str",v:e.v}}function On(u,a,r){var i,f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||(t.length-1)%2!==0)return{t:"err",v:"#N/A!"};const e=I(t[0],a,r);if(e.t==="err")return e;const n=[],o=[];for(let m=1;m<t.length;m+=2){const l=I(t[m],a,r);if(l.t==="err")return l;n.push(l.v);const p=Q(a(t[m+1]),r);if(w(p))return p;o.push(p)}if(n.some(m=>m.length!==e.v.length))return{t:"err",v:"#VALUE!"};let c=1/0;for(let m=0;m<e.v.length;m++){let l=!0;for(let p=0;p<n.length;p++){const h=((i=r==null?void 0:r.get(n[p][m]))==null?void 0:i.v)||"";if(!$(h,o[p])){l=!1;break}}if(l){const p=((f=r==null?void 0:r.get(e.v[m]))==null?void 0:f.v)||"",h=Number(p);p!==""&&!isNaN(h)&&h<c&&(c=h)}}return c===1/0?{t:"num",v:0}:{t:"num",v:c}}function wn(u,a,r){var i,f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||(t.length-1)%2!==0)return{t:"err",v:"#N/A!"};const e=I(t[0],a,r);if(e.t==="err")return e;const n=[],o=[];for(let m=1;m<t.length;m+=2){const l=I(t[m],a,r);if(l.t==="err")return l;n.push(l.v);const p=Q(a(t[m+1]),r);if(w(p))return p;o.push(p)}if(n.some(m=>m.length!==e.v.length))return{t:"err",v:"#VALUE!"};let c=-1/0;for(let m=0;m<e.v.length;m++){let l=!0;for(let p=0;p<n.length;p++){const h=((i=r==null?void 0:r.get(n[p][m]))==null?void 0:i.v)||"";if(!$(h,o[p])){l=!1;break}}if(l){const p=((f=r==null?void 0:r.get(e.v[m]))==null?void 0:f.v)||"",h=Number(p);p!==""&&!isNaN(h)&&h>c&&(c=h)}}return c===-1/0?{t:"num",v:0}:{t:"num",v:c}}function Pt(u,a,r){var f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=a(t[1]);if(n.t==="err")return n;const o=[];if(n.t==="num")o.push(n.v);else if(n.t==="ref"&&r)for(const m of b([n.v])){const l=((f=r.get(m))==null?void 0:f.v)||"";l!==""&&!isNaN(Number(l))&&o.push(Number(l))}let c=0;if(t.length===3){const m=v.map(a(t[2]),r);if(m.t==="err")return m;c=Math.trunc(m.v)}const i=e.v;return o.includes(i)?c===0?{t:"num",v:o.filter(l=>l>i).length+1}:{t:"num",v:o.filter(l=>l<i).length+1}:{t:"err",v:"#N/A!"}}function _t(u,a,r){var h;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=[],n=a(t[0]);if(n.t==="err")return n;if(n.t==="num")e.push(n.v);else if(n.t==="ref"&&r)for(const g of b([n.v])){const N=((h=r.get(g))==null?void 0:h.v)||"";N!==""&&!isNaN(Number(N))&&e.push(Number(N))}const o=v.map(a(t[1]),r);if(o.t==="err")return o;const c=o.v;if(c<0||c>1||e.length===0)return{t:"err",v:"#VALUE!"};e.sort((g,N)=>g-N);const i=e.length,f=c*(i-1),m=Math.floor(f),l=Math.ceil(f),p=f-m;return m===l?{t:"num",v:e[m]}:{t:"num",v:e[m]+p*(e[l]-e[m])}}function Pn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);return e.t==="err"?e:{t:"str",v:e.v.replace(/[\x00-\x1F]/g,"")}}function _n(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;let n=".";if(t.length>=2){const f=d(a(t[1]),r);if(f.t==="err")return f;n=f.v||"."}let o=",";if(t.length===3){const f=d(a(t[2]),r);if(f.t==="err")return f;o=f.v||","}let c=e.v.trim();if(o&&(c=c.split(o).join("")),n!=="."&&(c=c.replace(n,".")),c.endsWith("%")){const f=Number(c.slice(0,-1));return isNaN(f)?{t:"err",v:"#VALUE!"}:{t:"num",v:f/100}}const i=Number(c);return c===""||isNaN(i)?{t:"err",v:"#VALUE!"}:{t:"num",v:i}}function kt(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(s,a,r)){if(o.t==="err")return o;t.push(o.v)}if(t.length<2)return{t:"err",v:"#VALUE!"};const e=t.reduce((o,c)=>o+c,0)/t.length,n=t.reduce((o,c)=>o+(c-e)**2,0);return{t:"num",v:Math.sqrt(n/(t.length-1))}}function Bt(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(s,a,r)){if(o.t==="err")return o;t.push(o.v)}if(t.length===0)return{t:"err",v:"#VALUE!"};const e=t.reduce((o,c)=>o+c,0)/t.length,n=t.reduce((o,c)=>o+(c-e)**2,0);return{t:"num",v:Math.sqrt(n/t.length)}}function Ht(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(s,a,r)){if(o.t==="err")return o;t.push(o.v)}if(t.length<2)return{t:"err",v:"#VALUE!"};const e=t.reduce((o,c)=>o+c,0)/t.length;return{t:"num",v:t.reduce((o,c)=>o+(c-e)**2,0)/(t.length-1)}}function Xt(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(s,a,r)){if(o.t==="err")return o;t.push(o.v)}if(t.length===0)return{t:"err",v:"#VALUE!"};const e=t.reduce((o,c)=>o+c,0)/t.length;return{t:"num",v:t.reduce((o,c)=>o+(c-e)**2,0)/t.length}}function Yt(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const c of v.iterate(s,a,r)){if(c.t==="err")return c;t.push(c.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const e=new Map;for(const c of t)e.set(c,(e.get(c)||0)+1);let n=0,o=t[0];for(const[c,i]of e)i>n&&(n=i,o=c);return n<=1?{t:"err",v:"#N/A!"}:{t:"num",v:o}}function kn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0;for(const e of v.iterate(s,a,r)){if(e.t==="err")return e;t+=e.v**2}return{t:"num",v:t}}function Bn(u,a,r){const s=u.args();return s&&s.expr().length>0?{t:"err",v:"#N/A!"}:{t:"err",v:"#N/A!"}}function Gt(u,a,r){var g;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=[],n=a(t[0]);if(n.t==="err")return n;if(n.t==="num")e.push(n.v);else if(n.t==="ref"&&r)for(const N of b([n.v])){const A=((g=r.get(N))==null?void 0:g.v)||"";A!==""&&!isNaN(Number(A))&&e.push(Number(A))}const o=v.map(a(t[1]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<0||c>4||e.length===0)return{t:"err",v:"#VALUE!"};const i=c/4;e.sort((N,A)=>N-A);const f=e.length,m=i*(f-1),l=Math.floor(m),p=Math.ceil(m),h=m-l;return l===p?{t:"num",v:e[l]}:{t:"num",v:e[l]+h*(e[p]-e[l])}}function Hn(u,a,r){var n;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=new Set,e=s.expr();for(const o of e){const c=a(o);if(c.t==="err")return c;if(c.t==="ref"&&r)for(const i of b([c.v])){const f=(n=r.get(i))==null?void 0:n.v;f!==void 0&&f!==""&&t.add(f)}else c.t==="num"?t.add(String(c.v)):c.t==="str"&&c.v!==""?t.add(c.v):c.t==="bool"&&t.add(String(c.v))}return{t:"num",v:t.size}}function Xn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=2;if(t.length>=2){const i=v.map(a(t[1]),r);if(i.t==="err")return i;n=Math.trunc(i.v)}let o=!1;if(t.length===3){const i=O.map(a(t[2]),r);if(i.t==="err")return i;o=i.v}let c;if(n<0){const i=10**-n;c=String(Math.round(e.v/i)*i)}else c=e.v.toFixed(n);if(!o){const i=c.split(".");i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),c=i.join(".")}return{t:"str",v:c}}function Yn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=2;if(t.length===2){const l=v.map(a(t[1]),r);if(l.t==="err")return l;n=Math.trunc(l.v)}let o;if(n<0){const l=10**-n;o=Math.round(e.v/l)*l}else o=e.v;const c=o<0,f=Math.abs(o).toFixed(Math.max(0,n)).split(".");f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");const m=f.join(".");return{t:"str",v:c?`($${m})`:`$${m}`}}function Gn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;let n=1;if(t.length===2){const h=v.map(a(t[1]),r);if(h.t==="err")return h;n=Math.trunc(h.v)}const o=new Date(e.getFullYear(),0,1),c=n===2?1:0,f=(o.getDay()-c+7)%7,m=new Date(o.getTime()-f*864e5),l=e.getTime()-m.getTime();return{t:"num",v:Math.floor(l/(7*864e5))+1}}function qn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),o=n.getUTCDay()||7;n.setUTCDate(n.getUTCDate()+4-o);const c=new Date(Date.UTC(n.getUTCFullYear(),0,1));return{t:"num",v:Math.ceil(((n.getTime()-c.getTime())/864e5+1)/7)}}function Wn(u,a,r){var m;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=new Set;if(t.length===3){const l=a(t[2]);if(l.t==="err")return l;if(l.t==="ref"&&r)for(const p of b([l.v])){const h=((m=r.get(p))==null?void 0:m.v)||"";h&&o.add(h)}else l.t==="str"&&o.add(l.v)}let c=Math.trunc(n.v);const i=c>0?1:-1;c=Math.abs(c);const f=new Date(e);for(;c>0;){f.setDate(f.getDate()+i);const l=f.getDay();l!==0&&l!==6&&!o.has(H(f))&&c--}return{t:"str",v:H(f)}}function Kn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;let o=0;if(t.length===3){const m=v.map(a(t[2]),r);if(m.t==="err")return m;o=Math.trunc(m.v)}if(o<0||o>4)return{t:"err",v:"#VALUE!"};const c=e<n?e:n,i=e<n?n:e,f=Math.round((i.getTime()-c.getTime())/864e5);switch(o){case 0:case 4:return{t:"num",v:f/360};case 1:{const m=c.getFullYear(),l=i.getFullYear();if(m===l){const N=(new Date(m+1,0,1).getTime()-new Date(m,0,1).getTime())/864e5;return{t:"num",v:f/N}}const p=l-m+1,g=(new Date(l+1,0,1).getTime()-new Date(m,0,1).getTime())/864e5/p;return{t:"num",v:f/g}}case 2:return{t:"num",v:f/360};case 3:return{t:"num",v:f/365};default:return{t:"err",v:"#VALUE!"}}}function Qn(u,a,r){var p,h;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;const n=I(t[1],a,r);if(w(n))return n;let o=n.v;if(t.length===3){const g=I(t[2],a,r);if(w(g))return g;o=g.v}const c=e.t==="num"||e.t==="str"?e.v:"",i=e.t==="num";let f=-1;for(let g=0;g<n.v.length;g++){const N=((p=r==null?void 0:r.get(n.v[g]))==null?void 0:p.v)||"";if(i){const A=Number(N);N!==""&&!isNaN(A)&&A<=c&&(f=g)}else N.toLowerCase()<=String(c).toLowerCase()&&(f=g)}if(f===-1||f>=o.length)return{t:"err",v:"#N/A!"};const m=((h=r==null?void 0:r.get(o[f]))==null?void 0:h.v)||"",l=Number(m);return m!==""&&!isNaN(l)?{t:"num",v:l}:{t:"str",v:m}}function $n(u,a,r){var i;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;if(!r)return{t:"err",v:"#REF!"};const n=e.v.trim(),o=(i=r.get(n))==null?void 0:i.v;if(o===void 0)return{t:"str",v:""};const c=Number(o);return o!==""&&!isNaN(c)?{t:"num",v:c}:{t:"str",v:o}}function zn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t!=="err")return{t:"err",v:"#N/A!"};const o={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A!":7,"#ERROR!":8}[e.v];return o!==void 0?{t:"num",v:o}:{t:"err",v:"#N/A!"}}function jn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return{t:"bool",v:!1};if(e.t!=="str"||e.v==="")return{t:"bool",v:!1};if(!/[\-\/]/.test(e.v))return{t:"bool",v:!1};const n=new Date(e.v);return{t:"bool",v:!isNaN(n.getTime())}}function Jn(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>4)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;let o=!0;if(t.length>=3){const f=O.map(a(t[2]),r);if(f.t==="err")return f;o=f.v}let c=!0;if(t.length===4){const f=O.map(a(t[3]),r);if(f.t==="err")return f;c=f.v}let i;if(o&&n.v.length>1){const f=new RegExp("["+n.v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"]");i=e.v.split(f)}else i=e.v.split(n.v);return c&&(i=i.filter(f=>f!=="")),{t:"str",v:i.length>0?i[0]:""}}function Zn(u,a,r){var o;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=[];for(let c=1;c<t.length;c++){const i=a(t[c]);if(i.t==="err")return i;if(i.t==="ref"&&r)for(const f of b([i.v])){const m=((o=r.get(f))==null?void 0:o.v)||"";n.push(m)}else i.t==="num"?n.push(String(i.v)):i.t==="str"?n.push(i.v):i.t==="bool"&&n.push(i.v?"TRUE":"FALSE")}return{t:"str",v:n.join(e.v)}}function ta(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;try{return{t:"bool",v:new RegExp(n.v).test(e.v)}}catch{return{t:"err",v:"#VALUE!"}}}function y(u,a,r,s){var c,i;const t=I(u,r,s);if(w(t))return t;const e=I(a,r,s);if(w(e))return e;if(t.v.length!==e.v.length)return{t:"err",v:"#N/A!"};const n=[],o=[];for(let f=0;f<e.v.length;f++){const m=((c=s==null?void 0:s.get(e.v[f]))==null?void 0:c.v)||"",l=((i=s==null?void 0:s.get(t.v[f]))==null?void 0:i.v)||"";m!==""&&l!==""&&!isNaN(Number(m))&&!isNaN(Number(l))&&(n.push(Number(m)),o.push(Number(l)))}return n.length<2?{t:"err",v:"#N/A!"}:{xs:n,ys:o}}function z(u,a){const r=u.length,s=u.reduce((i,f)=>i+f,0),t=a.reduce((i,f)=>i+f,0),e=u.reduce((i,f,m)=>i+f*a[m],0),n=u.reduce((i,f)=>i+f*f,0),o=(r*e-s*t)/(r*n-s*s),c=(t-o*s)/r;return{slope:o,intercept:c}}function qt(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=y(t[1],t[2],a,r);if("t"in n)return n;const{slope:o,intercept:c}=z(n.xs,n.ys);return{t:"num",v:c+o*e.v}}function ea(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const{slope:n}=z(e.xs,e.ys);return{t:"num",v:n}}function ra(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const{intercept:n}=z(e.xs,e.ys);return{t:"num",v:n}}function na(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const n=e.xs.length,o=e.xs.reduce((p,h)=>p+h,0)/n,c=e.ys.reduce((p,h)=>p+h,0)/n;let i=0,f=0,m=0;for(let p=0;p<n;p++){const h=e.xs[p]-o,g=e.ys[p]-c;i+=h*g,f+=h*h,m+=g*g}const l=Math.sqrt(f*m);return l===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:i/l}}function aa(u,a,r){var g,N,A,x;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>6)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;const n=I(t[1],a,r);if(w(n))return n;const o=I(t[2],a,r);if(w(o))return o;let c=null;t.length>=4&&(c=a(t[3]));let i=0;if(t.length>=5){const E=v.map(a(t[4]),r);if(E.t==="err")return E;i=Math.trunc(E.v)}const f=e.t==="num"||e.t==="str"||e.t==="bool"?e.v:"",m=e.t==="num";let l=-1;if(i===0)for(let E=0;E<n.v.length;E++){const R=((g=r==null?void 0:r.get(n.v[E]))==null?void 0:g.v)||"";if(m){if(R!==""&&Number(R)===f){l=E;break}}else if(String(R).toLowerCase()===String(f).toLowerCase()){l=E;break}}else if(i===-1){let E=-1/0;for(let R=0;R<n.v.length;R++){const S=((N=r==null?void 0:r.get(n.v[R]))==null?void 0:N.v)||"";if(m){const T=Number(S);S!==""&&!isNaN(T)&&T<=f&&T>E&&(E=T,l=R)}}}else if(i===1){let E=1/0;for(let R=0;R<n.v.length;R++){const S=((A=r==null?void 0:r.get(n.v[R]))==null?void 0:A.v)||"";if(m){const T=Number(S);S!==""&&!isNaN(T)&&T>=f&&T<E&&(E=T,l=R)}}}if(l===-1)return c||{t:"err",v:"#N/A!"};if(l>=o.v.length)return{t:"err",v:"#N/A!"};const p=((x=r==null?void 0:r.get(o.v[l]))==null?void 0:x.v)||"",h=Number(p);return p!==""&&!isNaN(h)?{t:"num",v:h}:{t:"str",v:p}}function sa(u,a,r){var A;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;if(e.t!=="ref"||!r)return{t:"err",v:"#VALUE!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(n.v),i=Math.trunc(o.v),f=F(e.v)?e.v.split(":")[0]:e.v,m=ct(f),l=m.r+c,p=m.c+i;if(l<1||p<1)return{t:"err",v:"#REF!"};const h=`${It(p)}${l}`,g=((A=r.get(h))==null?void 0:A.v)||"",N=Number(g);return g!==""&&!isNaN(N)?{t:"num",v:N}:{t:"str",v:g}}function oa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"bool",v:Math.trunc(e.v)%2===0}}function ua(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"bool",v:Math.trunc(e.v)%2!==0}}function ca(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.trunc(e.v);if(n<-1)return{t:"err",v:"#VALUE!"};if(n<=0)return{t:"num",v:1};let o=1;for(let c=n;c>0;c-=2)o*=c;return{t:"num",v:o}}function ia(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);if(o<2||o>36)return{t:"err",v:"#VALUE!"};let c=Math.trunc(e.v).toString(o).toUpperCase();if(t.length===3){const i=v.map(a(t[2]),r);if(i.t==="err")return i;c=c.padStart(Math.trunc(i.v),"0")}return{t:"str",v:c}}function fa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);if(o<2||o>36)return{t:"err",v:"#VALUE!"};const c=parseInt(e.v,o);return isNaN(c)?{t:"err",v:"#VALUE!"}:{t:"num",v:c}}function ma(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.sqrt(e.v*Math.PI)}}function la(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.sinh(e.v)}}function va(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.cosh(e.v)}}function pa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.tanh(e.v)}}function ha(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.asinh(e.v)}}function ga(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.acosh(e.v)}}function Na(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<=-1||e.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.atanh(e.v)}}function Aa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.tan(e.v);return n===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:1/n}}function da(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.sin(e.v);return n===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:1/n}}function xa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.cos(e.v);return n===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:1/n}}function Ea(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;try{const o=new RegExp(n.v).exec(e.v);return o?{t:"str",v:o[1]!==void 0?o[1]:o[0]}:{t:"err",v:"#N/A!"}}catch{return{t:"err",v:"#VALUE!"}}}function Ma(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;const o=d(a(t[2]),r);if(o.t==="err")return o;try{return{t:"str",v:e.v.replace(new RegExp(n.v,"g"),o.v)}}catch{return{t:"err",v:"#VALUE!"}}}function Ra(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);return e.t==="err"?e:e.v.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:e.v.codePointAt(0)}}function ba(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.trunc(e.v);if(n<1)return{t:"err",v:"#VALUE!"};try{return{t:"str",v:String.fromCodePoint(n)}}catch{return{t:"err",v:"#VALUE!"}}}function Ta(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const n of v.iterate(s,a,r)){if(n.t==="err")return n;if(n.v<=0)return{t:"err",v:"#VALUE!"};t.push(n.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const e=t.reduce((n,o)=>n+Math.log(o),0);return{t:"num",v:Math.exp(e/t.length)}}function Ia(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const n of v.iterate(s,a,r)){if(n.t==="err")return n;if(n.v<=0)return{t:"err",v:"#VALUE!"};t.push(n.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const e=t.reduce((n,o)=>n+1/o,0);return{t:"num",v:t.length/e}}function Sa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(s,a,r)){if(o.t==="err")return o;t.push(o.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const e=t.reduce((o,c)=>o+c,0)/t.length;return{t:"num",v:t.reduce((o,c)=>o+Math.abs(c-e),0)/t.length}}function La(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=[];for(const n of v.iterate(s,a,r)){if(n.t==="err")return n;t.push(n.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const e=t.reduce((n,o)=>n+o,0)/t.length;return{t:"num",v:t.reduce((n,o)=>n+(o-e)**2,0)}}function Fa(u,a,r){var m;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;const n=[];if(e.t==="num")n.push(e.v);else if(e.t==="ref"&&r)for(const l of b([e.v])){const p=((m=r.get(l))==null?void 0:m.v)||"";p!==""&&!isNaN(Number(p))&&n.push(Number(p))}const o=v.map(a(t[1]),r);if(o.t==="err")return o;const c=o.v;if(c<0||c>=1)return{t:"err",v:"#VALUE!"};if(n.length===0)return{t:"err",v:"#N/A!"};n.sort((l,p)=>l-p);const i=Math.floor(n.length*c/2),f=n.slice(i,n.length-i);return f.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:f.reduce((l,p)=>l+p,0)/f.length}}function Ca(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(e.v),c=Math.trunc(n.v);if(o<0||c<0||c>o)return{t:"err",v:"#VALUE!"};let i=1;for(let f=o;f>o-c;f--)i*=f;return{t:"num",v:i}}function ft(u,a,r,s,t){if(u===0)return-(r+s)/a;const e=Math.pow(1+u,a);return-(u*(r*e+s)/((1+u*t)*(e-1)))}function Ua(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;let c=0;if(t.length>=4){const f=v.map(a(t[3]),r);if(f.t==="err")return f;c=f.v}let i=0;if(t.length===5){const f=v.map(a(t[4]),r);if(f.t==="err")return f;i=Math.trunc(f.v)}return{t:"num",v:ft(e.v,n.v,o.v,c,i)}}function ya(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;let c=0;if(t.length>=4){const m=v.map(a(t[3]),r);if(m.t==="err")return m;c=m.v}let i=0;if(t.length===5){const m=v.map(a(t[4]),r);if(m.t==="err")return m;i=Math.trunc(m.v)}if(e.v===0)return{t:"num",v:-(c+o.v*n.v)};const f=Math.pow(1+e.v,n.v);return{t:"num",v:-(c*f+o.v*(1+e.v*i)*(f-1)/e.v)}}function Da(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;let c=0;if(t.length>=4){const m=v.map(a(t[3]),r);if(m.t==="err")return m;c=m.v}let i=0;if(t.length===5){const m=v.map(a(t[4]),r);if(m.t==="err")return m;i=Math.trunc(m.v)}if(e.v===0)return{t:"num",v:-(c+o.v*n.v)};const f=Math.pow(1+e.v,n.v);return{t:"num",v:-(c+o.v*(1+e.v*i)*(f-1)/e.v)/f}}function Va(u,a,r){var c;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=0,o=1;for(let i=1;i<t.length;i++){const f=a(t[i]);if(f.t==="err")return f;if(f.t==="ref"&&r)for(const m of b([f.v])){const l=((c=r.get(m))==null?void 0:c.v)||"";l!==""&&!isNaN(Number(l))&&(n+=Number(l)/Math.pow(1+e.v,o),o++)}else f.t==="num"&&(n+=f.v/Math.pow(1+e.v,o),o++)}return{t:"num",v:n}}function Oa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;let c=0;if(t.length>=4){const m=v.map(a(t[3]),r);if(m.t==="err")return m;c=m.v}let i=0;if(t.length===5){const m=v.map(a(t[4]),r);if(m.t==="err")return m;i=Math.trunc(m.v)}if(e.v===0)return n.v===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:-(o.v+c)/n.v};const f=n.v*(1+e.v*i)/e.v;return{t:"num",v:Math.log((f-c)/(o.v+f))/Math.log(1+e.v)}}function wa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>6)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;let i=0;if(t.length>=5){const h=v.map(a(t[4]),r);if(h.t==="err")return h;i=h.v}let f=0;if(t.length===6){const h=v.map(a(t[5]),r);if(h.t==="err")return h;f=Math.trunc(h.v)}const m=ft(e.v,o.v,c.v,i,f);let l=c.v;for(let h=1;h<n.v;h++){f===1&&h===1&&(l+=m);const g=l*e.v;l+=g+(f===0||h>1?m:0)}const p=l*e.v;return f===1&&n.v===1?{t:"num",v:0}:{t:"num",v:p}}function Pa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>6)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;let i=0;if(t.length>=5){const h=v.map(a(t[4]),r);if(h.t==="err")return h;i=h.v}let f=0;if(t.length===6){const h=v.map(a(t[5]),r);if(h.t==="err")return h;f=Math.trunc(h.v)}const m=ft(e.v,o.v,c.v,i,f);let l=c.v;for(let h=1;h<n.v;h++){f===1&&h===1&&(l+=m);const g=l*e.v;l+=g+(f===0||h>1?m:0)}const p=f===1&&n.v===1?0:l*e.v;return{t:"num",v:m-p}}function _a(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);return o.t==="err"?o:o.v===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:(e.v-n.v)/o.v}}function ka(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);return o<1||e.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.pow(1+e.v/o,o)-1}}function Ba(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>6)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;let c=0;if(t.length>=4){const l=v.map(a(t[3]),r);if(l.t==="err")return l;c=l.v}let i=0;if(t.length>=5){const l=v.map(a(t[4]),r);if(l.t==="err")return l;i=Math.trunc(l.v)}let f=.1;if(t.length===6){const l=v.map(a(t[5]),r);if(l.t==="err")return l;f=l.v}let m=f;for(let l=0;l<100;l++){const p=Math.pow(1+m,e.v),h=o.v*p+n.v*(1+m*i)*(p-1)/m+c,g=e.v*o.v*Math.pow(1+m,e.v-1)+n.v*(1+m*i)*(e.v*Math.pow(1+m,e.v-1)*m-(p-1))/(m*m)+n.v*i*(p-1)/m,N=m-h/g;if(Math.abs(N-m)<1e-10)return{t:"num",v:N};m=N}return{t:"err",v:"#VALUE!"}}function Ha(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=[],n=I(t[0],a,r);if(n.t==="err")return n;for(const i of n.v){const f=r.get(i),m=f?Number(f.v):0;if(isNaN(m))return{t:"err",v:"#VALUE!"};e.push(m)}let o=.1;if(t.length===2){const i=v.map(a(t[1]),r);if(i.t==="err")return i;o=i.v}let c=o;for(let i=0;i<100;i++){let f=0,m=0;for(let p=0;p<e.length;p++){const h=Math.pow(1+c,p);f+=e[p]/h,m-=p*e[p]/Math.pow(1+c,p+1)}if(Math.abs(m)<1e-15)return{t:"err",v:"#VALUE!"};const l=c-f/m;if(Math.abs(l-c)<1e-10)return{t:"num",v:l};c=l}return{t:"err",v:"#VALUE!"}}function Xa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;let i=12;if(t.length===5){const p=v.map(a(t[4]),r);if(p.t==="err")return p;i=Math.trunc(p.v)}if(o.v<=0||c.v<1||e.v<0)return{t:"err",v:"#VALUE!"};const f=Math.round((1-Math.pow(n.v/e.v,1/o.v))*1e3)/1e3;let m=0;const l=Math.trunc(c.v);for(let p=1;p<=l;p++){let h;if(p===1?h=e.v*f*i/12:p===Math.trunc(o.v)+1?h=(e.v-m)*f*(12-i)/12:h=(e.v-m)*f,p===l)return{t:"num",v:h};m+=h}return{t:"err",v:"#VALUE!"}}function Ya(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;let i=2;if(t.length===5){const p=v.map(a(t[4]),r);if(p.t==="err")return p;i=p.v}if(o.v<=0||c.v<1)return{t:"err",v:"#VALUE!"};const f=i/o.v;let m=e.v;const l=Math.trunc(c.v);for(let p=1;p<=l;p++){let h=m*f;if(m-h<n.v&&(h=m-n.v),h<0&&(h=0),p===l)return{t:"num",v:h};m-=h}return{t:"err",v:"#VALUE!"}}function Ga(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);return o<1||e.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:o*(Math.pow(1+e.v,1/o)-1)}}function qa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==6)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=v.map(a(t[4]),r);if(i.t==="err")return i;const f=v.map(a(t[5]),r);if(f.t==="err")return f;const m=Math.trunc(c.v),l=Math.trunc(i.v),p=Math.trunc(f.v);if(e.v<=0||n.v<=0||o.v<=0||m<1||l<m||p!==0&&p!==1)return{t:"err",v:"#VALUE!"};const h=ft(e.v,n.v,o.v,0,p);let g=0,N=o.v;for(let A=1;A<=l;A++){const x=p===1&&A===1?0:N*e.v,E=h-x;A>=m&&(g+=x),N+=E}return{t:"num",v:g}}function Wa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==6)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=v.map(a(t[4]),r);if(i.t==="err")return i;const f=v.map(a(t[5]),r);if(f.t==="err")return f;const m=Math.trunc(c.v),l=Math.trunc(i.v),p=Math.trunc(f.v);if(e.v<=0||n.v<=0||o.v<=0||m<1||l<m||p!==0&&p!==1)return{t:"err",v:"#VALUE!"};const h=ft(e.v,n.v,o.v,0,p);let g=0,N=o.v;for(let A=1;A<=l;A++){const x=p===1&&A===1?0:N*e.v,E=h-x;A>=m&&(g+=E),N+=E}return{t:"num",v:g}}function Ka(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0,e=0;for(const n of s.expr()){const o=a(n);if(o.t==="err")return o;if(o.t==="ref"&&r){const c=Array.from(b([o.v]));for(const i of c){const f=r.get(i);if(!f||f.v===void 0||f.v==="")continue;const m=Number(f.v);t+=isNaN(m)?0:m,e++}}else o.t==="num"?(t+=o.v,e++):o.t==="bool"?(t+=o.v?1:0,e++):o.t==="str"&&(t+=0,e++)}return e===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:t/e}}function Qa(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=1/0,e=!1;for(const n of s.expr()){const o=a(n);if(o.t==="err")return o;if(o.t==="ref"&&r){const c=Array.from(b([o.v]));for(const i of c){const f=r.get(i);if(!f||f.v===void 0||f.v==="")continue;const m=Number(f.v),l=isNaN(m)?0:m;l<t&&(t=l),e=!0}}else if(o.t==="num")o.v<t&&(t=o.v),e=!0;else if(o.t==="bool"){const c=o.v?1:0;c<t&&(t=c),e=!0}else o.t==="str"&&(0<t&&(t=0),e=!0)}return e?{t:"num",v:t}:{t:"num",v:0}}function $a(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=-1/0,e=!1;for(const n of s.expr()){const o=a(n);if(o.t==="err")return o;if(o.t==="ref"&&r){const c=Array.from(b([o.v]));for(const i of c){const f=r.get(i);if(!f||f.v===void 0||f.v==="")continue;const m=Number(f.v),l=isNaN(m)?0:m;l>t&&(t=l),e=!0}}else if(o.t==="num")o.v>t&&(t=o.v),e=!0;else if(o.t==="bool"){const c=o.v?1:0;c>t&&(t=c),e=!0}else o.t==="str"&&(0>t&&(t=0),e=!0)}return e?{t:"num",v:t}:{t:"num",v:0}}function za(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<=-1||e.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:.5*Math.log((1+e.v)/(1-e.v))}}function ja(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.exp(2*e.v);return{t:"num",v:(n-1)/(n+1)}}function L(u){const r=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(u<.5)return Math.PI/(Math.sin(Math.PI*u)*L(1-u));u-=1;let s=r[0];for(let e=1;e<9;e++)s+=r[e]/(u+e);const t=u+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(t,u+.5)*Math.exp(-t)*s}function Ja(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<=0&&Number.isInteger(e.v)?{t:"err",v:"#VALUE!"}:{t:"num",v:L(e.v)}}function Za(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.log(L(e.v))}}function st(u){const a=u>=0?1:-1;u=Math.abs(u);const r=.254829592,s=-.284496736,t=1.421413741,e=-1.453152027,n=1.061405429,c=1/(1+.3275911*u),i=1-((((n*c+e)*c+t)*c+s)*c+r)*c*Math.exp(-u*u);return a*i}function mt(u){return .5*(1+st(u/Math.SQRT2))}function Nt(u){return Math.exp(-.5*u*u)/Math.sqrt(2*Math.PI)}function j(u){if(u<=0||u>=1)return NaN;if(u<.5)return-j(1-u);const a=Math.sqrt(-2*Math.log(1-u));return a-(2.515517+.802853*a+.010328*a*a)/(1+1.432788*a+.189269*a*a+.001308*a*a*a)}function Wt(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;if(o.v<=0)return{t:"err",v:"#VALUE!"};const c=a(t[3]),i=c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0,f=(e.v-n.v)/o.v;return i?{t:"num",v:mt(f)}:{t:"num",v:Nt(f)/o.v}}function Kt(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);return o.t==="err"?o:o.v<=0||e.v<=0||e.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:n.v+o.v*j(e.v)}}function ts(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;if(e.v<=0||o.v<=0)return{t:"err",v:"#VALUE!"};const c=a(t[3]),i=c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0,f=(Math.log(e.v)-n.v)/o.v;return i?{t:"num",v:mt(f)}:{t:"num",v:Nt(f)/(e.v*o.v)}}function es(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);return o.t==="err"?o:o.v<=0||e.v<=0||e.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.exp(n.v+o.v*j(e.v))}}function rs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);return o.t==="err"?o:o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:(e.v-n.v)/o.v}}function ns(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;if(e.v<0||n.v<=0||o.v<=0)return{t:"err",v:"#VALUE!"};const c=a(t[3]);return(c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0)?{t:"num",v:1-Math.exp(-Math.pow(e.v/o.v,n.v))}:{t:"num",v:n.v/Math.pow(o.v,n.v)*Math.pow(e.v,n.v-1)*Math.exp(-Math.pow(e.v/o.v,n.v))}}function as(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(n.v<0)return{t:"err",v:"#VALUE!"};const o=a(t[2]),c=o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0,i=Math.trunc(e.v);if(i<0)return{t:"err",v:"#VALUE!"};if(c){let f=0;for(let m=0;m<=i;m++)f+=Math.pow(n.v,m)*Math.exp(-n.v)/L(m+1);return{t:"num",v:f}}return{t:"num",v:Math.pow(n.v,i)*Math.exp(-n.v)/L(i+1)}}function ss(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(e.v),i=Math.trunc(n.v);if(c<0||i<0||c>i||o.v<0||o.v>1)return{t:"err",v:"#VALUE!"};const f=a(t[3]),m=f.t==="bool"?f.v:f.t==="num"?f.v!==0:!0;function l(p){const h=Math.log(L(i+1))-Math.log(L(p+1))-Math.log(L(i-p+1));return Math.exp(h+p*Math.log(o.v)+(i-p)*Math.log(1-o.v))}if(m){let p=0;for(let h=0;h<=c;h++)p+=l(h);return{t:"num",v:p}}return{t:"num",v:l(c)}}function os(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(e.v<0||n.v<=0)return{t:"err",v:"#VALUE!"};const o=a(t[2]);return(o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0)?{t:"num",v:1-Math.exp(-n.v*e.v)}:{t:"num",v:n.v*Math.exp(-n.v*e.v)}}function us(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);return o.t==="err"?o:e.v<=0||e.v>=1||n.v<=0||o.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:j(1-e.v/2)*n.v/Math.sqrt(Math.trunc(o.v))}}function ot(u){return Math.log(L(u))}function et(u,a){if(a<0||a===0)return 0;if(a<u+1){let n=1/u,o=n;for(let c=1;c<200&&(n*=a/(u+c),o+=n,!(Math.abs(n)<1e-14*Math.abs(o)));c++);return o*Math.exp(-a+u*Math.log(a)-ot(u))}let r=a+1-u,s=1e30,t=1/r,e=t;for(let n=1;n<200;n++){const o=-n*(n-u);r+=2,t=o*t+r,Math.abs(t)<1e-30&&(t=1e-30),s=r+o/s,Math.abs(s)<1e-30&&(s=1e-30),t=1/t;const c=t*s;if(e*=c,Math.abs(c-1)<1e-14)break}return 1-Math.exp(-a+u*Math.log(a)-ot(u))*e}function cs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(e.v<0||n.v<1)return{t:"err",v:"#VALUE!"};const o=a(t[2]),c=o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0,f=Math.trunc(n.v)/2;return c?{t:"num",v:et(f,e.v/2)}:{t:"num",v:Math.pow(e.v,f-1)*Math.exp(-e.v/2)/(Math.pow(2,f)*L(f))}}function is(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(e.v<=0||e.v>=1||n.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(n.v);let c=o*Math.pow(1-2/(9*o)+j(e.v)*Math.sqrt(2/(9*o)),3);c<=0&&(c=.01);for(let i=0;i<100;i++){const f=et(o/2,c/2),m=o/2,l=Math.pow(c,m-1)*Math.exp(-c/2)/(Math.pow(2,m)*L(m));if(Math.abs(l)<1e-15)break;const p=c-(f-e.v)/l;if(Math.abs(p-c)<1e-10){c=p;break}c=Math.max(p,1e-10)}return{t:"num",v:c}}function fs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(n.v<1)return{t:"err",v:"#VALUE!"};const o=a(t[2]),c=o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0,i=Math.trunc(n.v);if(c){const m=e.v*e.v;et(i/2,i/(i+m)*i/2);const l=i/(i+m),p=k(l,i/2,.5);return{t:"num",v:e.v>=0?1-.5*p:.5*p}}return{t:"num",v:L((i+1)/2)/(Math.sqrt(i*Math.PI)*L(i/2))*Math.pow(1+t2/i,-(i+1)/2)}}function k(u,a,r){if(u<=0)return 0;if(u>=1)return 1;if(u>(a+1)/(a+r+2))return 1-k(1-u,r,a);const s=ot(a)+ot(r)-ot(a+r),t=Math.exp(a*Math.log(u)+r*Math.log(1-u)-s)/a,e=200,n=1e-14,o=1e-30;let c=a+r,i=a+1,f=a-1,m=1,l=1-c*u/i;Math.abs(l)<o&&(l=o),l=1/l;let p=l;for(let h=1;h<=e;h++){const g=2*h;let N=h*(r-h)*u/((f+g)*(a+g));l=1+N*l,Math.abs(l)<o&&(l=o),m=1+N/m,Math.abs(m)<o&&(m=o),l=1/l,p*=l*m,N=-(a+h)*(c+h)*u/((a+g)*(i+g)),l=1+N*l,Math.abs(l)<o&&(l=o),m=1+N/m,Math.abs(m)<o&&(m=o),l=1/l;const A=l*m;if(p*=A,Math.abs(A-1)<n)break}return t*p}function Ct(u,a){let r=j(u);for(let s=0;s<100;s++){const t=r*r,e=a/(a+t),n=k(e,a/2,.5),o=r>=0?1-.5*n:.5*n,c=L((a+1)/2)/(Math.sqrt(a*Math.PI)*L(a/2))*Math.pow(1+t/a,-(a+1)/2);if(Math.abs(c)<1e-15)break;const i=r-(o-u)/c;if(Math.abs(i-r)<1e-10)return i;r=i}return r}function ms(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:e.v<=0||e.v>=1||n.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:Ct(e.v,Math.trunc(n.v))}}function ls(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==5)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=a(t[4]),f=i.t==="bool"?i.v:i.t==="num"?i.v!==0:!0,m=Math.trunc(e.v),l=Math.trunc(n.v),p=Math.trunc(o.v),h=Math.trunc(c.v);if(m<0||l<0||p<0||h<0||l>h||p>h||m>Math.min(l,p))return{t:"err",v:"#VALUE!"};function g(A,x){return Math.log(L(A+1))-Math.log(L(x+1))-Math.log(L(A-x+1))}function N(A){return Math.exp(g(p,A)+g(h-p,l-A)-g(h,l))}if(f){let A=0;for(let x=Math.max(0,l+p-h);x<=m;x++)A+=N(x);return{t:"num",v:A}}return{t:"num",v:N(m)}}function vs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=a(t[3]),i=c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0,f=Math.trunc(e.v),m=Math.trunc(n.v);if(f<0||m<1||o.v<=0||o.v>1)return{t:"err",v:"#VALUE!"};function l(p){const h=Math.log(L(p+m))-Math.log(L(m))-Math.log(L(p+1));return Math.exp(h+m*Math.log(o.v)+p*Math.log(1-o.v))}if(i){let p=0;for(let h=0;h<=f;h++)p+=l(h);return{t:"num",v:p}}return{t:"num",v:l(f)}}function ps(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(e.v<=0||e.v>=1||n.v<=0||c<2)return{t:"err",v:"#VALUE!"};const i=1-e.v/2,f=c-1;return{t:"num",v:Ct(i,f)*n.v/Math.sqrt(c)}}function hs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]),n=d(e,r);if(n.t==="err")return n;const o=n.v.toUpperCase(),c={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3};let i=0;for(let f=0;f<o.length;f++){const m=c[o[f]],l=f+1<o.length?c[o[f+1]]:0;if(m===void 0)return{t:"err",v:"#VALUE!"};m<l?i-=m:i+=m}return{t:"num",v:i}}function gs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=Math.trunc(e.v);if(n<0||n>3999)return{t:"err",v:"#VALUE!"};if(n===0)return{t:"str",v:""};const o=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],c=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"];let i="";for(let f=0;f<o.length;f++)for(;n>=o[f];)i+=c[f],n-=o[f];return{t:"str",v:i}}function Ns(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};let t=0,e=1;for(const n of s.expr()){const o=v.map(a(n),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<0)return{t:"err",v:"#VALUE!"};t+=c,e*=L(c+1)}return{t:"num",v:Math.round(L(t+1)/e)}}function As(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=I(t[3],a,r);if(c.t==="err")return c;let i=0;for(let f=0;f<c.v.length;f++){const m=r.get(c.v[f]),l=m?Number(m.v):0;if(isNaN(l))return{t:"err",v:"#VALUE!"};i+=l*Math.pow(e.v,n.v+f*o.v)}return{t:"num",v:i}}function ds(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=0;if(t.length===2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;n=o.v}return{t:"num",v:e.v===n?1:0}}function xs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=0;if(t.length===2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;n=o.v}return{t:"num",v:e.v>=n?1:0}}function Es(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;if(t.length===1)return{t:"num",v:st(e.v)};const n=v.map(a(t[1]),r);return n.t==="err"?n:{t:"num",v:st(n.v)-st(e.v)}}function Ms(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:1-st(e.v)}}function Rs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=I(t[1],a,r);if(n.t==="err")return n;const o=I(t[2],a,r);if(o.t==="err")return o;if(n.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};const c=[],i=[];for(let l=0;l<n.v.length;l++){const p=r.get(n.v[l]),h=p?Number(p.v):0;if(isNaN(h))return{t:"err",v:"#VALUE!"};c.push(h);const g=r.get(o.v[l]),N=(g==null?void 0:g.v)||"",A=new Date(N);if(isNaN(A.getTime()))return{t:"err",v:"#VALUE!"};i.push(A.getTime())}const f=i[0];let m=0;for(let l=0;l<c.length;l++){const p=(i[l]-f)/315576e5;m+=c[l]/Math.pow(1+e.v,p)}return{t:"num",v:m}}function bs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=I(t[0],a,r);if(e.t==="err")return e;const n=I(t[1],a,r);if(n.t==="err")return n;if(e.v.length!==n.v.length)return{t:"err",v:"#VALUE!"};const o=[],c=[];for(let l=0;l<e.v.length;l++){const p=r.get(e.v[l]),h=p?Number(p.v):0;if(isNaN(h))return{t:"err",v:"#VALUE!"};o.push(h);const g=r.get(n.v[l]),N=(g==null?void 0:g.v)||"",A=new Date(N);if(isNaN(A.getTime()))return{t:"err",v:"#VALUE!"};c.push(A.getTime())}let i=.1;if(t.length===3){const l=v.map(a(t[2]),r);if(l.t==="err")return l;i=l.v}const f=c[0];let m=i;for(let l=0;l<100;l++){let p=0,h=0;for(let N=0;N<o.length;N++){const A=(c[N]-f)/315576e5,x=Math.pow(1+m,A);p+=o[N]/x,h-=A*o[N]/Math.pow(1+m,A+1)}if(Math.abs(h)<1e-15)return{t:"err",v:"#VALUE!"};const g=m-p/h;if(Math.abs(g-m)<1e-10)return{t:"num",v:g};m=g}return{t:"err",v:"#VALUE!"}}function Ts(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=Math.trunc(o.v),f=Math.trunc(c.v);if(i<=0||f<1||f>i)return{t:"err",v:"#VALUE!"};const m=i*(i+1)/2;return{t:"num",v:(e.v-n.v)*(i-f+1)/m}}function Is(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=I(t[0],a,r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=[];for(const l of e.v){const p=r.get(l),h=p?Number(p.v):0;if(isNaN(h))return{t:"err",v:"#VALUE!"};c.push(h)}const i=c.length;if(i<2)return{t:"err",v:"#VALUE!"};let f=0,m=0;for(let l=0;l<i;l++)c[l]<0?f+=c[l]/Math.pow(1+n.v,l):m+=c[l]*Math.pow(1+o.v,i-1-l);return f===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:Math.pow(-m/f,1/(i-1))-1}}function Ss(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=a(t[0]),n=a(t[1]),o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=d(e,r);if(c.t==="err")return c;const i=d(n,r);if(i.t==="err")return i;const f=new Date(c.v),m=new Date(i.v);if(isNaN(f.getTime())||isNaN(m.getTime()))return{t:"err",v:"#VALUE!"};const l=(m.getTime()-f.getTime())/(24*3600*1e3);return l<=0||o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:365*o.v/(360-o.v*l)}}function Ls(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=a(t[0]),n=a(t[1]),o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=d(e,r),i=d(n,r);if(c.t==="err"||i.t==="err")return{t:"err",v:"#VALUE!"};const f=new Date(c.v),m=new Date(i.v);if(isNaN(f.getTime())||isNaN(m.getTime()))return{t:"err",v:"#VALUE!"};const l=(m.getTime()-f.getTime())/(24*3600*1e3);return l<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:100*(1-o.v*l/360)}}function Fs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=a(t[0]),n=a(t[1]),o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=d(e,r),i=d(n,r);if(c.t==="err"||i.t==="err")return{t:"err",v:"#VALUE!"};const f=new Date(c.v),m=new Date(i.v);if(isNaN(f.getTime())||isNaN(m.getTime()))return{t:"err",v:"#VALUE!"};const l=(m.getTime()-f.getTime())/(24*3600*1e3);return l<=0||o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:(100-o.v)/o.v*360/l}}function Cs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);if(o<1)return{t:"err",v:"#VALUE!"};const c=Math.trunc(e.v),i=e.v-c,f=Math.pow(10,Math.ceil(Math.log10(o)));return{t:"num",v:c+i*f/o}}function Us(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);if(o<1)return{t:"err",v:"#VALUE!"};const c=Math.trunc(e.v),i=e.v-c,f=Math.pow(10,Math.ceil(Math.log10(o)));return{t:"num",v:c+i*o/f}}function ys(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]),n=d(e,r);return n.t==="err"?n:{t:"str",v:encodeURIComponent(n.v)}}function Ds(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]),n=d(e,r);if(n.t==="err")return n;const o=n.v.trim();return{t:"bool",v:/^https?:\/\//i.test(o)||/^ftp:\/\//i.test(o)}}function Vs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t!=="ref"||!r)return{t:"bool",v:!1};if(F(e.v))return{t:"err",v:"#VALUE!"};const n=r.get(e.v);return{t:"bool",v:!!(n&&n.f)}}function Os(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t!=="ref"||!r)return{t:"err",v:"#N/A!"};if(F(e.v))return{t:"err",v:"#VALUE!"};const n=r.get(e.v);return!n||!n.f?{t:"err",v:"#N/A!"}:{t:"str",v:n.f}}function ws(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=1;if(t.length>=2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;n=c.v}if(n===0)return{t:"num",v:0};let o=0;if(t.length===3){const c=v.map(a(t[2]),r);if(c.t==="err")return c;o=c.v}return n=Math.abs(n),e.v<0&&o!==0?{t:"num",v:-Math.ceil(Math.abs(e.v)/n)*n}:{t:"num",v:Math.ceil(e.v/n)*n}}function Ps(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=1;if(t.length>=2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;n=c.v}if(n===0)return{t:"num",v:0};let o=0;if(t.length===3){const c=v.map(a(t[2]),r);if(c.t==="err")return c;o=c.v}return n=Math.abs(n),e.v<0&&o!==0?{t:"num",v:-Math.floor(Math.abs(e.v)/n)*n}:{t:"num",v:Math.floor(e.v/n)*n}}function _s(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=1;if(t.length===2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;n=Math.abs(o.v)}return n===0?{t:"num",v:0}:{t:"num",v:Math.ceil(e.v/n)*n}}function ks(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=1;if(t.length===2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;n=Math.abs(o.v)}return n===0?{t:"num",v:0}:{t:"num",v:Math.floor(e.v/n)*n}}function Qt(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const{xs:n,ys:o}=e,c=n.length,i=n.reduce((l,p)=>l+p,0)/c,f=o.reduce((l,p)=>l+p,0)/c;return{t:"num",v:n.reduce((l,p,h)=>l+(p-i)*(o[h]-f),0)/c}}function Bs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const{xs:n,ys:o}=e,c=n.length;if(c<2)return{t:"err",v:"#N/A!"};const i=n.reduce((l,p)=>l+p,0)/c,f=o.reduce((l,p)=>l+p,0)/c;return{t:"num",v:n.reduce((l,p,h)=>l+(p-i)*(o[h]-f),0)/(c-1)}}function Hs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const{xs:n,ys:o}=e,c=n.length,i=n.reduce((g,N)=>g+N,0)/c,f=o.reduce((g,N)=>g+N,0)/c,m=n.reduce((g,N,A)=>g+(N-i)*(o[A]-f),0),l=n.reduce((g,N)=>g+(N-i)*(N-i),0),p=o.reduce((g,N)=>g+(N-f)*(N-f),0);if(l===0||p===0)return{t:"err",v:"#DIV/0!"};const h=m/Math.sqrt(l*p);return{t:"num",v:h*h}}function Xs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const{xs:n,ys:o}=e,c=n.length;if(c<3)return{t:"err",v:"#N/A!"};const{slope:i,intercept:f}=z(n,o),m=o.reduce((l,p,h)=>{const g=i*n[h]+f;return l+(p-g)*(p-g)},0);return{t:"num",v:Math.sqrt(m/(c-2))}}function X(u,a,r){var e;const s=a(u);if(s.t==="err")return s;const t=[];if(s.t==="num")t.push(s.v);else if(s.t==="ref"&&r)for(const n of b([s.v])){const o=((e=r.get(n))==null?void 0:e.v)||"";o!==""&&!isNaN(Number(o))&&t.push(Number(o))}return t}function Ys(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const n=e.ys,o=e.xs;let c=0;for(let i=0;i<n.length;i++)c+=n[i]*n[i]-o[i]*o[i];return{t:"num",v:c}}function Gs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const n=e.ys,o=e.xs;let c=0;for(let i=0;i<n.length;i++)c+=n[i]*n[i]+o[i]*o[i];return{t:"num",v:c}}function qs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const n=e.ys,o=e.xs;let c=0;for(let i=0;i<n.length;i++){const f=n[i]-o[i];c+=f*f}return{t:"num",v:c}}function Ws(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=X(t[0],a,r);if(!Array.isArray(e))return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=n.v;if(o<=0||o>=1||e.length===0)return{t:"err",v:"#VALUE!"};e.sort((p,h)=>p-h);const c=e.length,i=o*(c+1)-1;if(i<0||i>c-1)return{t:"err",v:"#VALUE!"};const f=Math.floor(i),m=Math.ceil(i),l=i-f;return f===m||m>=c?{t:"num",v:e[Math.min(f,c-1)]}:{t:"num",v:e[f]+l*(e[m]-e[f])}}function Ks(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=X(t[0],a,r);if(!Array.isArray(e))return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);if(o<1||o>3||e.length===0)return{t:"err",v:"#VALUE!"};e.sort((h,g)=>h-g);const c=e.length,f=o/4*(c+1)-1;if(f<0||f>c-1)return{t:"err",v:"#VALUE!"};const m=Math.floor(f),l=Math.ceil(f),p=f-m;return m===l?{t:"num",v:e[m]}:{t:"num",v:e[m]+p*(e[l]-e[m])}}function Qs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=X(t[1],a,r);if(!Array.isArray(n))return n;let o=0;if(t.length===3){const f=v.map(a(t[2]),r);if(f.t==="err")return f;o=Math.trunc(f.v)}const c=e.v;if(!n.includes(c))return{t:"err",v:"#N/A!"};const i=n.filter(f=>f===c).length;return o===0?{t:"num",v:n.filter(m=>m>c).length+1+(i-1)/2}:{t:"num",v:n.filter(m=>m<c).length+1+(i-1)/2}}function $t(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=X(t[0],a,r);if(!Array.isArray(e))return e;if(e.length===0)return{t:"err",v:"#N/A!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=n.v;let c=3;if(t.length===3){const h=v.map(a(t[2]),r);if(h.t==="err")return h;if(c=Math.trunc(h.v),c<1)return{t:"err",v:"#VALUE!"}}if(e.sort((h,g)=>h-g),o<e[0]||o>e[e.length-1])return{t:"err",v:"#N/A!"};const i=e.length;let f=0;for(const h of e)h<o&&f++;const m=e.indexOf(o);let l;if(m>=0)l=f/(i-1);else{const h=e[f-1],g=e[f];l=(f-1+(o-h)/(g-h))/(i-1)}const p=Math.pow(10,c);return{t:"num",v:Math.trunc(l*p)/p}}function $s(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=X(t[0],a,r);if(!Array.isArray(e))return e;if(e.length===0)return{t:"err",v:"#N/A!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=n.v;let c=3;if(t.length===3){const h=v.map(a(t[2]),r);if(h.t==="err")return h;if(c=Math.trunc(h.v),c<1)return{t:"err",v:"#VALUE!"}}if(e.sort((h,g)=>h-g),o<e[0]||o>e[e.length-1])return{t:"err",v:"#N/A!"};const i=e.length;let f=0;for(const h of e)h<o&&f++;const m=e.indexOf(o);let l;if(m>=0)l=(f+1)/(i+1);else{const h=e[f-1],g=e[f];l=(f+(o-h)/(g-h))/(i+1)}const p=Math.pow(10,c);return{t:"num",v:Math.trunc(l*p)/p}}function zs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>6)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=O.map(a(t[3]),r);if(c.t==="err")return c;let i=0,f=1;if(t.length>=5){const h=v.map(a(t[4]),r);if(h.t==="err")return h;i=h.v}if(t.length===6){const h=v.map(a(t[5]),r);if(h.t==="err")return h;f=h.v}const m=n.v,l=o.v;if(m<=0||l<=0||i>=f)return{t:"err",v:"#VALUE!"};const p=(e.v-i)/(f-i);if(p<0||p>1)return{t:"err",v:"#VALUE!"};if(c.v)return{t:"num",v:k(p,m,l)};{const h=V(m)+V(l)-V(m+l);return{t:"num",v:Math.exp((m-1)*Math.log(p)+(l-1)*Math.log(1-p)-h)/(f-i)}}}function V(u){return Math.log(L(u))}function js(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;let c=0,i=1;if(t.length>=4){const g=v.map(a(t[3]),r);if(g.t==="err")return g;c=g.v}if(t.length===5){const g=v.map(a(t[4]),r);if(g.t==="err")return g;i=g.v}const f=e.v,m=n.v,l=o.v;if(f<0||f>1||m<=0||l<=0||c>=i)return{t:"err",v:"#VALUE!"};let p=.5;const h=V(m)+V(l)-V(m+l);for(let g=0;g<200;g++){const A=k(p,m,l)-f;if(Math.abs(A)<1e-12)break;const x=Math.exp((m-1)*Math.log(Math.max(p,1e-300))+(l-1)*Math.log(Math.max(1-p,1e-300))-h);if(x===0)break;p=Math.max(1e-15,Math.min(1-1e-15,p-A/x))}return{t:"num",v:c+p*(i-c)}}function Js(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=O.map(a(t[3]),r);if(c.t==="err")return c;const i=e.v,f=Math.trunc(n.v),m=Math.trunc(o.v);if(i<0||f<1||m<1)return{t:"err",v:"#VALUE!"};if(c.v){const l=f*i/(f*i+m);return{t:"num",v:k(l,f/2,m/2)}}else{const l=f/2*Math.log(f)+m/2*Math.log(m)+(f/2-1)*Math.log(i),p=(f+m)/2*Math.log(f*i+m)+V(f/2)+V(m/2)-V((f+m)/2);return{t:"num",v:Math.exp(l-p)}}}function Zs(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=e.v,i=Math.trunc(n.v),f=Math.trunc(o.v);if(c<0||c>=1||i<1||f<1)return{t:"err",v:"#VALUE!"};if(c===0)return{t:"num",v:0};let m=1;for(let l=0;l<200;l++){const p=i*m/(i*m+f),g=k(p,i/2,f/2)-c;if(Math.abs(g)<1e-12)break;const N=i/2*Math.log(i)+f/2*Math.log(f)+(i/2-1)*Math.log(Math.max(m,1e-300)),A=(i+f)/2*Math.log(i*m+f)+V(i/2)+V(f/2)-V((i+f)/2),x=Math.exp(N-A);if(x===0)break;m=Math.max(1e-15,m-g/x)}return{t:"num",v:m}}function to(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=O.map(a(t[3]),r);if(c.t==="err")return c;const i=e.v,f=n.v,m=o.v;return i<0||f<=0||m<=0?{t:"err",v:"#VALUE!"}:c.v?{t:"num",v:et(f,i/m)}:{t:"num",v:Math.pow(i,f-1)*Math.exp(-i/m)/(Math.pow(m,f)*L(f))}}function eo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=e.v,i=n.v,f=o.v;if(c<0||c>1||i<=0||f<=0)return{t:"err",v:"#VALUE!"};if(c===0)return{t:"num",v:0};if(c===1)return{t:"err",v:"#VALUE!"};let m=i*f;for(let l=0;l<200;l++){const h=et(i,m/f)-c;if(Math.abs(h)<1e-12)break;const g=Math.pow(m,i-1)*Math.exp(-m/f)/(Math.pow(f,i)*L(i));if(g===0)break;m=Math.max(1e-15,m-h/g)}return{t:"num",v:m}}function ro(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(e.v<0||n.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(n.v);return{t:"num",v:1-et(o/2,e.v/2)}}function no(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(e.v<=0||e.v>=1||n.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(n.v),c=1-e.v;let i=o*Math.pow(1-2/(9*o)+j(c)*Math.sqrt(2/(9*o)),3);i<=0&&(i=.01);for(let f=0;f<100;f++){const m=et(o/2,i/2),l=o/2,p=Math.pow(i,l-1)*Math.exp(-i/2)/(Math.pow(2,l)*L(l));if(Math.abs(p)<1e-15)break;const h=i-(m-c)/p;if(Math.abs(h-i)<1e-10){i=h;break}i=Math.max(h,1e-10)}return{t:"num",v:i}}function ao(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(n.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(n.v),c=e.v*e.v,i=o/(o+c),f=k(i,o/2,.5);return{t:"num",v:1-(e.v>=0?1-.5*f:.5*f)}}function so(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(e.v<0||n.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(n.v),c=e.v*e.v,i=o/(o+c);return{t:"num",v:k(i,o/2,.5)}}function oo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(e.v<=0||e.v>1||n.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(n.v);return{t:"num",v:Ct(1-e.v/2,o)}}function uo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=e.v,i=Math.trunc(n.v),f=Math.trunc(o.v);if(c<0||i<1||f<1)return{t:"err",v:"#VALUE!"};const m=i*c/(i*c+f);return{t:"num",v:1-k(m,i/2,f/2)}}function co(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=e.v,i=Math.trunc(n.v),f=Math.trunc(o.v);if(c<=0||c>=1||i<1||f<1)return{t:"err",v:"#VALUE!"};const m=1-c;let l=1;for(let p=0;p<200;p++){const h=i*l/(i*l+f),N=k(h,i/2,f/2)-m;if(Math.abs(N)<1e-12)break;const A=i/2*Math.log(i)+f/2*Math.log(f)+(i/2-1)*Math.log(Math.max(l,1e-300)),x=(i+f)/2*Math.log(i*l+f)+V(i/2)+V(f/2)-V((i+f)/2),E=Math.exp(A-x);if(E===0)break;l=Math.max(1e-15,l-N/E)}return{t:"num",v:l}}function io(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(e.v),i=n.v,f=o.v;if(c<0||i<0||i>1||f<0||f>1)return{t:"err",v:"#VALUE!"};let m=0;for(let l=0;l<=c;l++){const p=V(c+1)-V(l+1)-V(c-l+1)+l*Math.log(Math.max(i,1e-300))+(c-l)*Math.log(Math.max(1-i,1e-300));if(m+=Math.exp(p),m>=f)return{t:"num",v:l}}return{t:"num",v:c}}function fo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;let o=1;if(t.length===3){const f=v.map(a(t[2]),r);if(f.t==="err")return f;o=Math.trunc(f.v)}const c=e.v,i=n.v;if(i==="")return{t:"err",v:"#VALUE!"};if(o>0){let f=-1;for(let m=0;m<o;m++)if(f=c.indexOf(i,f+1),f===-1)return{t:"err",v:"#N/A!"};return{t:"str",v:c.substring(0,f)}}else if(o<0){let f=c.length;for(let m=0;m<-o;m++)if(f=c.lastIndexOf(i,f-1),f===-1)return{t:"err",v:"#N/A!"};return{t:"str",v:c.substring(0,f)}}return{t:"err",v:"#VALUE!"}}function mo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;let o=1;if(t.length===3){const f=v.map(a(t[2]),r);if(f.t==="err")return f;o=Math.trunc(f.v)}const c=e.v,i=n.v;if(i==="")return{t:"err",v:"#VALUE!"};if(o>0){let f=-1;for(let m=0;m<o;m++)if(f=c.indexOf(i,f+1),f===-1)return{t:"err",v:"#N/A!"};return{t:"str",v:c.substring(f+i.length)}}else if(o<0){let f=c.length;for(let m=0;m<-o;m++)if(f=c.lastIndexOf(i,f-1),f===-1)return{t:"err",v:"#N/A!"};return{t:"str",v:c.substring(f+i.length)}}return{t:"err",v:"#VALUE!"}}function lo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;const n=d(e,r);if(n.t==="err")return n;let o=0;if(t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;o=Math.trunc(c.v)}return o===1&&e.t==="str"?{t:"str",v:'"'+n.v+'"'}:{t:"str",v:n.v}}function vo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;if(e.v<1)return{t:"err",v:"#VALUE!"};let n=1;if(t.length>=3){const o=v.map(a(t[2]),r);if(o.t==="err")return o;n=o.v}return{t:"num",v:n}}function po(u,a,r){const s=u.args(),t=s?s.expr():[];if(t.length>5)return{t:"err",v:"#N/A!"};let e=0,n=1,o=!1;if(t.length>=3){const i=v.map(a(t[2]),r);if(i.t==="err")return i;e=i.v}if(t.length>=4){const i=v.map(a(t[3]),r);if(i.t==="err")return i;n=i.v}if(t.length>=5){const i=O.map(a(t[4]),r);if(i.t==="err")return i;o=i.v}if(e>n)return{t:"err",v:"#VALUE!"};const c=e+Math.random()*(n-e);return{t:"num",v:o?Math.floor(c):c}}function ho(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const e=X(t[0],a,r);if(!Array.isArray(e))return e;if(e.length===0)return{t:"err",v:"#VALUE!"};let n=1;if(t.length>=3){const o=v.map(a(t[2]),r);if(o.t==="err")return o;n=o.v}return e.sort((o,c)=>n>=0?o-c:c-o),{t:"num",v:e[0]}}function Ut(u,a){if(u.t!=="ref")return u;const r=b([u.v]).next().value;if(!r)return{t:"str",v:""};const s=a.get(r),t=(s==null?void 0:s.v)||"";return t===""?{t:"str",v:""}:isNaN(Number(t))?{t:"str",v:t}:{t:"num",v:Number(t)}}function go(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);return e.t==="err"||e.t!=="ref"||!r?e:Ut(e,r)}function No(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);return e.t==="err"||e.t!=="ref"||!r?e:Ut(e,r)}function Ao(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);return e.t==="err"||e.t!=="ref"||!r?e:Ut(e,r)}function xo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=O.map(a(t[1]),r);return n.t==="err"?n:n.v?{t:"num",v:mt(e.v)}:{t:"num",v:Nt(e.v)}}function Eo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<=0||e.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:j(e.v)}}function Mo(u,a,r){var i;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=Math.trunc(e.v),o=[];for(let f=1;f<t.length;f++){const m=a(t[f]);if(m.t==="err")return m;if(m.t==="num")o.push(m.v);else if(m.t==="ref"&&r)for(const l of b([m.v])){const p=((i=r.get(l))==null?void 0:i.v)||"";p!==""&&!isNaN(Number(p))&&o.push(Number(p))}}const c=n>100?n-100:n;if(o.length===0&&c!==2&&c!==3)return{t:"num",v:0};switch(c){case 1:return{t:"num",v:o.reduce((f,m)=>f+m,0)/o.length};case 2:return{t:"num",v:o.length};case 3:return{t:"num",v:o.length};case 4:return{t:"num",v:Math.max(...o)};case 5:return{t:"num",v:Math.min(...o)};case 6:return{t:"num",v:o.reduce((f,m)=>f*m,1)};case 7:{const f=o.length;if(f<2)return{t:"err",v:"#DIV/0!"};const m=o.reduce((p,h)=>p+h,0)/f,l=o.reduce((p,h)=>p+(h-m)*(h-m),0)/(f-1);return{t:"num",v:Math.sqrt(l)}}case 8:{const f=o.length;if(f===0)return{t:"err",v:"#DIV/0!"};const m=o.reduce((p,h)=>p+h,0)/f,l=o.reduce((p,h)=>p+(h-m)*(h-m),0)/f;return{t:"num",v:Math.sqrt(l)}}case 9:return{t:"num",v:o.reduce((f,m)=>f+m,0)};case 10:{const f=o.length;if(f<2)return{t:"err",v:"#DIV/0!"};const m=o.reduce((l,p)=>l+p,0)/f;return{t:"num",v:o.reduce((l,p)=>l+(p-m)*(p-m),0)/(f-1)}}case 11:{const f=o.length;if(f===0)return{t:"err",v:"#DIV/0!"};const m=o.reduce((l,p)=>l+p,0)/f;return{t:"num",v:o.reduce((l,p)=>l+(p-m)*(p-m),0)/f}}default:return{t:"err",v:"#VALUE!"}}}function Ro(u,a,r){var c;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length===0)return{t:"err",v:"#N/A!"};const e=[];for(const i of t){const f=a(i);if(f.t==="err")return f;if(f.t==="num"){e.push(f.v);continue}if(f.t==="bool"){e.push(f.v?1:0);continue}if(f.t==="str"){e.push(0);continue}if(f.t==="ref"&&r)for(const m of b([f.v])){const l=((c=r.get(m))==null?void 0:c.v)||"";if(l!==""){if(l==="true"){e.push(1);continue}if(l==="false"){e.push(0);continue}if(!isNaN(Number(l))){e.push(Number(l));continue}e.push(0)}}}const n=e.length;if(n<2)return{t:"err",v:"#DIV/0!"};const o=e.reduce((i,f)=>i+f,0)/n;return{t:"num",v:e.reduce((i,f)=>i+(f-o)*(f-o),0)/(n-1)}}function bo(u,a,r){var c;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length===0)return{t:"err",v:"#N/A!"};const e=[];for(const i of t){const f=a(i);if(f.t==="err")return f;if(f.t==="num"){e.push(f.v);continue}if(f.t==="bool"){e.push(f.v?1:0);continue}if(f.t==="str"){e.push(0);continue}if(f.t==="ref"&&r)for(const m of b([f.v])){const l=((c=r.get(m))==null?void 0:c.v)||"";if(l!==""){if(l==="true"){e.push(1);continue}if(l==="false"){e.push(0);continue}if(!isNaN(Number(l))){e.push(Number(l));continue}e.push(0)}}}const n=e.length;if(n===0)return{t:"err",v:"#DIV/0!"};const o=e.reduce((i,f)=>i+f,0)/n;return{t:"num",v:e.reduce((i,f)=>i+(f-o)*(f-o),0)/n}}function To(u,a,r){var f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length===0)return{t:"err",v:"#N/A!"};const e=[];for(const m of t){const l=a(m);if(l.t==="err")return l;if(l.t==="num"){e.push(l.v);continue}if(l.t==="ref"&&r)for(const p of b([l.v])){const h=((f=r.get(p))==null?void 0:f.v)||"";h!==""&&!isNaN(Number(h))&&e.push(Number(h))}}const n=e.length;if(n<3)return{t:"err",v:"#DIV/0!"};const o=e.reduce((m,l)=>m+l,0)/n,c=Math.sqrt(e.reduce((m,l)=>m+(l-o)*(l-o),0)/(n-1));if(c===0)return{t:"err",v:"#DIV/0!"};const i=e.reduce((m,l)=>m+Math.pow((l-o)/c,3),0);return{t:"num",v:n/((n-1)*(n-2))*i}}function Io(u,a,r){var m;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length===0)return{t:"err",v:"#N/A!"};const e=[];for(const l of t){const p=a(l);if(p.t==="err")return p;if(p.t==="num"){e.push(p.v);continue}if(p.t==="ref"&&r)for(const h of b([p.v])){const g=((m=r.get(h))==null?void 0:m.v)||"";g!==""&&!isNaN(Number(g))&&e.push(Number(g))}}const n=e.length;if(n<4)return{t:"err",v:"#DIV/0!"};const o=e.reduce((l,p)=>l+p,0)/n,c=Math.sqrt(e.reduce((l,p)=>l+(p-o)*(p-o),0)/(n-1));if(c===0)return{t:"err",v:"#DIV/0!"};const i=e.reduce((l,p)=>l+Math.pow((p-o)/c,4),0);return{t:"num",v:n*(n+1)*i/((n-1)*(n-2)*(n-3))-3*(n-1)*(n-1)/((n-2)*(n-3))}}function So(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();return t.length!==1?{t:"err",v:"#N/A!"}:{t:"bool",v:a(t[0]).t==="ref"}}function Lo(u,a,r){return{t:"num",v:1}}function Fo(u,a,r){return{t:"num",v:1}}function Co(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err"||e.t==="num")return e;if(e.t!=="ref"||!r)return{t:"err",v:"#VALUE!"};const n=e.v;if(!F(n)){const l=r.get(n),p=(l==null?void 0:l.v)||"";return p===""||isNaN(Number(p))?{t:"err",v:"#VALUE!"}:{t:"num",v:Number(p)}}const o=tt(n),c=o[1].r-o[0].r+1,i=o[1].c-o[0].c+1;if(c!==i)return{t:"err",v:"#VALUE!"};const f=[];for(let l=o[0].r;l<=o[1].r;l++){const p=[];for(let h=o[0].c;h<=o[1].c;h++){const g=q({r:l,c:h}),N=r.get(g),A=(N==null?void 0:N.v)||"";if(A===""||isNaN(Number(A)))return{t:"err",v:"#VALUE!"};p.push(Number(A))}f.push(p)}function m(l){const p=l.length;if(p===1)return l[0][0];if(p===2)return l[0][0]*l[1][1]-l[0][1]*l[1][0];let h=0;for(let g=0;g<p;g++){const N=[];for(let A=1;A<p;A++)N.push([...l[A].slice(0,g),...l[A].slice(g+1)]);h+=(g%2===0?1:-1)*l[0][g]*m(N)}return h}return{t:"num",v:m(f)}}function Uo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const n=e.ys,o=e.xs,c=v.map(a(t[2]),r);if(c.t==="err")return c;const i=c.v;let f=i;if(t.length===4){const p=v.map(a(t[3]),r);if(p.t==="err")return p;f=p.v}if(o.reduce((p,h)=>p+h,0)>1.0001||o.some(p=>p<0))return{t:"err",v:"#VALUE!"};let l=0;for(let p=0;p<n.length;p++)n[p]>=i&&n[p]<=f&&(l+=o[p]);return{t:"num",v:l}}function yo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=d(a(t[1]),r);if(n.t==="err")return n;const o=d(a(t[2]),r);if(o.t==="err")return o;const c=n.v,i=o.v,f=e.v,m={m:{category:"length",factor:1},km:{category:"length",factor:1e3},cm:{category:"length",factor:.01},mm:{category:"length",factor:.001},in:{category:"length",factor:.0254},ft:{category:"length",factor:.3048},yd:{category:"length",factor:.9144},mi:{category:"length",factor:1609.344},Nmi:{category:"length",factor:1852},um:{category:"length",factor:1e-6},kg:{category:"mass",factor:1},g:{category:"mass",factor:.001},mg:{category:"mass",factor:1e-6},lbm:{category:"mass",factor:.45359237},ozm:{category:"mass",factor:.028349523125},stone:{category:"mass",factor:6.35029318},ton:{category:"mass",factor:907.18474},C:{category:"temperature",factor:1,offset:0},F:{category:"temperature",factor:5/9,offset:-32},K:{category:"temperature",factor:1,offset:-273.15},sec:{category:"time",factor:1},s:{category:"time",factor:1},min:{category:"time",factor:60},hr:{category:"time",factor:3600},day:{category:"time",factor:86400},yr:{category:"time",factor:31557600},l:{category:"volume",factor:1},lt:{category:"volume",factor:1},ml:{category:"volume",factor:.001},gal:{category:"volume",factor:3.785411784},qt:{category:"volume",factor:.946352946},pt:{category:"volume",factor:.473176473},cup:{category:"volume",factor:.2365882365},tsp:{category:"volume",factor:.00492892159375},tbs:{category:"volume",factor:.01478676478125},"m/s":{category:"speed",factor:1},"m/h":{category:"speed",factor:1/3600},mph:{category:"speed",factor:.44704},kn:{category:"speed",factor:.514444},m2:{category:"area",factor:1},ha:{category:"area",factor:1e4},acre:{category:"area",factor:4046.8564224},J:{category:"energy",factor:1},cal:{category:"energy",factor:4.1868},BTU:{category:"energy",factor:1055.05585262},kWh:{category:"energy",factor:36e5},eV:{category:"energy",factor:1602176634e-28}},l=m[c],p=m[i];if(!l||!p)return{t:"err",v:"#N/A!"};if(l.category!==p.category)return{t:"err",v:"#N/A!"};if(l.category==="temperature"){let h;c==="C"?h=f:c==="F"?h=(f-32)*5/9:h=f-273.15;let g;return i==="C"?g=h:i==="F"?g=h*9/5+32:g=h+273.15,{t:"num",v:g}}return{t:"num",v:f*l.factor/p.factor}}function Do(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:e.v<0||n.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(e.v)&Math.trunc(n.v)}}function Vo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:e.v<0||n.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(e.v)|Math.trunc(n.v)}}function Oo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:e.v<0||n.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(e.v)^Math.trunc(n.v)}}function wo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:e.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(e.v)*Math.pow(2,Math.trunc(n.v))}}function Po(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);return n.t==="err"?n:e.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.floor(Math.trunc(e.v)/Math.pow(2,Math.trunc(n.v)))}}function _o(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=e.v.trim();if(!/^[0-9A-Fa-f]+$/.test(n))return{t:"err",v:"#VALUE!"};const o=parseInt(n,16);return n.length===10&&n[0].match(/[89A-Fa-f]/)?{t:"num",v:o-Math.pow(2,40)}:{t:"num",v:o}}function ko(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=Math.trunc(e.v);if(n<-549755813888||n>549755813887)return{t:"err",v:"#VALUE!"};let o;if(n<0?o=(n+Math.pow(2,40)).toString(16).toUpperCase():o=n.toString(16).toUpperCase(),t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function Bo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=e.v.trim();if(!/^[01]+$/.test(n)||n.length>10)return{t:"err",v:"#VALUE!"};const o=parseInt(n,2);return n.length===10&&n[0]==="1"?{t:"num",v:o-1024}:{t:"num",v:o}}function Ho(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=Math.trunc(e.v);if(n<-512||n>511)return{t:"err",v:"#VALUE!"};let o;if(n<0?o=(n+1024).toString(2):o=n.toString(2),t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function Xo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=e.v.trim();if(!/^[0-7]+$/.test(n))return{t:"err",v:"#VALUE!"};const o=parseInt(n,8);return n.length===10&&n[0]>="4"?{t:"num",v:o-Math.pow(2,30)}:{t:"num",v:o}}function Yo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=Math.trunc(e.v);if(n<-536870912||n>536870911)return{t:"err",v:"#VALUE!"};let o;if(n<0?o=(n+Math.pow(2,30)).toString(8):o=n.toString(8),t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function Y(u){if(u=u.trim().replace(/\s/g,""),u==="i")return{re:0,im:1};if(u==="-i")return{re:0,im:-1};if(u.endsWith("i")){const r=u.slice(0,-1),s=Number(r);if(!isNaN(s))return{re:0,im:s};const t=r.lastIndexOf("+"),e=r.lastIndexOf("-"),n=Math.max(t,e);if(n<=0)return null;const o=Number(r.slice(0,n));if(isNaN(o))return null;const c=r.slice(n),i=c==="+"?1:c==="-"?-1:Number(c);return isNaN(i)?null:{re:o,im:i}}const a=Number(u);return isNaN(a)?null:{re:a,im:0}}function Go(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;let o="i";if(t.length===3){const i=d(a(t[2]),r);if(i.t==="err")return i;if(o=i.v,o!=="i"&&o!=="j")return{t:"err",v:"#VALUE!"}}if(n.v===0)return{t:"str",v:String(e.v)};if(e.v===0)return n.v===1?{t:"str",v:o}:n.v===-1?{t:"str",v:"-"+o}:{t:"str",v:n.v+o};const c=n.v>0?"+":"";return n.v===1?{t:"str",v:e.v+"+"+o}:n.v===-1?{t:"str",v:e.v+"-"+o}:{t:"str",v:e.v+c+n.v+o}}function qo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=Y(e.v);return n?{t:"num",v:n.re}:{t:"err",v:"#VALUE!"}}function Wo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=Y(e.v);return n?{t:"num",v:n.im}:{t:"err",v:"#VALUE!"}}function Ko(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=Y(e.v);return n?{t:"num",v:Math.sqrt(n.re*n.re+n.im*n.im)}:{t:"err",v:"#VALUE!"}}function D(u,a){if(a===0)return String(u);if(u===0)return a===1?"i":a===-1?"-i":a+"i";const r=a>0?"+":"";return a===1?u+"+i":a===-1?u+"-i":u+r+a+"i"}function _(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=Y(e.v);return n||{t:"err",v:"#VALUE!"}}function Qo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1)return{t:"err",v:"#N/A!"};let e=0,n=0;for(const o of t){const c=d(a(o),r);if(c.t==="err")return c;const i=Y(c.v);if(!i)return{t:"err",v:"#VALUE!"};e+=i.re,n+=i.im}return{t:"str",v:D(e,n)}}function $o(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=Y(e.v);if(!n)return{t:"err",v:"#VALUE!"};const o=d(a(t[1]),r);if(o.t==="err")return o;const c=Y(o.v);return c?{t:"str",v:D(n.re-c.re,n.im-c.im)}:{t:"err",v:"#VALUE!"}}function zo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1)return{t:"err",v:"#N/A!"};let e=1,n=0;for(const o of t){const c=d(a(o),r);if(c.t==="err")return c;const i=Y(c.v);if(!i)return{t:"err",v:"#VALUE!"};const f=e*i.re-n*i.im,m=e*i.im+n*i.re;e=f,n=m}return{t:"str",v:D(e,n)}}function jo(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=Y(e.v);if(!n)return{t:"err",v:"#VALUE!"};const o=d(a(t[1]),r);if(o.t==="err")return o;const c=Y(o.v);if(!c)return{t:"err",v:"#VALUE!"};const i=c.re*c.re+c.im*c.im;if(i===0)return{t:"err",v:"#VALUE!"};const f=(n.re*c.re+n.im*c.im)/i,m=(n.im*c.re-n.re*c.im)/i;return{t:"str",v:D(f,m)}}function Jo(u,a,r){const s=_(u,a,r);return"t"in s?s:{t:"str",v:D(s.re,-s.im)}}function Zo(u,a,r){const s=_(u,a,r);return"t"in s?s:s.re===0&&s.im===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.atan2(s.im,s.re)}}function tu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=Y(e.v);if(!n)return{t:"err",v:"#VALUE!"};const o=v.map(a(t[1]),r);if(o.t==="err")return o;const c=Math.sqrt(n.re*n.re+n.im*n.im),i=Math.atan2(n.im,n.re),f=Math.pow(c,o.v),m=f*Math.cos(o.v*i),l=f*Math.sin(o.v*i);return{t:"str",v:D(Math.abs(m)<1e-14?0:m,Math.abs(l)<1e-14?0:l)}}function eu(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.sqrt(s.re*s.re+s.im*s.im),e=Math.atan2(s.im,s.re),n=Math.sqrt(t),o=n*Math.cos(e/2),c=n*Math.sin(e/2);return{t:"str",v:D(Math.abs(o)<1e-14?0:o,Math.abs(c)<1e-14?0:c)}}function ru(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.exp(s.re),e=t*Math.cos(s.im),n=t*Math.sin(s.im);return{t:"str",v:D(Math.abs(e)<1e-14?0:e,Math.abs(n)<1e-14?0:n)}}function nu(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.sqrt(s.re*s.re+s.im*s.im);if(t===0)return{t:"err",v:"#VALUE!"};const e=Math.atan2(s.im,s.re);return{t:"str",v:D(Math.log(t),e)}}function au(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.sqrt(s.re*s.re+s.im*s.im);if(t===0)return{t:"err",v:"#VALUE!"};const e=Math.atan2(s.im,s.re),n=Math.log(2);return{t:"str",v:D(Math.log(t)/n,e/n)}}function su(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.sqrt(s.re*s.re+s.im*s.im);if(t===0)return{t:"err",v:"#VALUE!"};const e=Math.atan2(s.im,s.re),n=Math.log(10);return{t:"str",v:D(Math.log(t)/n,e/n)}}function ou(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.sin(s.re)*Math.cosh(s.im),e=Math.cos(s.re)*Math.sinh(s.im);return{t:"str",v:D(Math.abs(t)<1e-14?0:t,Math.abs(e)<1e-14?0:e)}}function uu(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.cos(s.re)*Math.cosh(s.im),e=-(Math.sin(s.re)*Math.sinh(s.im));return{t:"str",v:D(Math.abs(t)<1e-14?0:t,Math.abs(e)<1e-14?0:e)}}function At(u,a,r,s){const t=r*r+s*s;return{re:(u*r+a*s)/t,im:(a*r-u*s)/t}}function cu(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.sin(s.re)*Math.cosh(s.im),e=Math.cos(s.re)*Math.sinh(s.im),n=Math.cos(s.re)*Math.cosh(s.im),o=-(Math.sin(s.re)*Math.sinh(s.im)),c=At(t,e,n,o);return{t:"str",v:D(Math.abs(c.re)<1e-14?0:c.re,Math.abs(c.im)<1e-14?0:c.im)}}function iu(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.sinh(s.re)*Math.cos(s.im),e=Math.cosh(s.re)*Math.sin(s.im);return{t:"str",v:D(Math.abs(t)<1e-14?0:t,Math.abs(e)<1e-14?0:e)}}function fu(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.cosh(s.re)*Math.cos(s.im),e=Math.sinh(s.re)*Math.sin(s.im);return{t:"str",v:D(Math.abs(t)<1e-14?0:t,Math.abs(e)<1e-14?0:e)}}function mu(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.cos(s.re)*Math.cosh(s.im),e=-(Math.sin(s.re)*Math.sinh(s.im)),n=At(1,0,t,e);return{t:"str",v:D(Math.abs(n.re)<1e-14?0:n.re,Math.abs(n.im)<1e-14?0:n.im)}}function lu(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.sin(s.re)*Math.cosh(s.im),e=Math.cos(s.re)*Math.sinh(s.im),n=At(1,0,t,e);return{t:"str",v:D(Math.abs(n.re)<1e-14?0:n.re,Math.abs(n.im)<1e-14?0:n.im)}}function vu(u,a,r){const s=_(u,a,r);if("t"in s)return s;const t=Math.sin(s.re)*Math.cosh(s.im),e=Math.cos(s.re)*Math.sinh(s.im),n=Math.cos(s.re)*Math.cosh(s.im),o=-(Math.sin(s.re)*Math.sinh(s.im)),c=At(n,o,t,e);return{t:"str",v:D(Math.abs(c.re)<1e-14?0:c.re,Math.abs(c.im)<1e-14?0:c.im)}}function pu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=parseInt(e.v,16);if(isNaN(n))return{t:"err",v:"#VALUE!"};let o=n.toString(2);if(t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function hu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=parseInt(e.v,16);if(isNaN(n))return{t:"err",v:"#VALUE!"};let o=n.toString(8);if(t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function gu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=parseInt(e.v,2);if(isNaN(n))return{t:"err",v:"#VALUE!"};let o=n.toString(16).toUpperCase();if(t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function Nu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=parseInt(e.v,2);if(isNaN(n))return{t:"err",v:"#VALUE!"};let o=n.toString(8);if(t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function Au(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=parseInt(e.v,8);if(isNaN(n))return{t:"err",v:"#VALUE!"};let o=n.toString(16).toUpperCase();if(t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function du(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=parseInt(e.v,8);if(isNaN(n))return{t:"err",v:"#VALUE!"};let o=n.toString(2);if(t.length===2){const c=v.map(a(t[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function Mt(u,a){let r=0;for(let s=0;s<=100;s++){const t=s%2===0?1:-1;let e=1;for(let c=2;c<=s;c++)e*=c;let n=1;for(let c=2;c<=u+s;c++)n*=c;const o=t/(e*n)*Math.pow(a/2,2*s+u);if(r+=o,Math.abs(o)<1e-15*Math.abs(r)&&s>5)break}return r}function xu(u,a){if(a<=0)return NaN;const r=.5772156649015329;function s(o){let c=0;for(let i=1;i<=100;i++){const f=i%2===0?1:-1;let m=1;for(let h=2;h<=i;h++)m*=h;let l=0;for(let h=1;h<=i;h++)l+=1/h;const p=f*l/(m*m)*Math.pow(o/2,2*i);if(c+=p,Math.abs(p)<1e-15*Math.abs(c)&&i>5)break}return 2/Math.PI*((Math.log(o/2)+r)*Mt(0,o)-c)}function t(o){let c=0;for(let i=0;i<=100;i++){const f=i%2===0?1:-1;let m=1;for(let N=2;N<=i;N++)m*=N;let l=1;for(let N=2;N<=i+1;N++)l*=N;let p=0;for(let N=1;N<=i;N++)p+=1/N;let h=0;for(let N=1;N<=i+1;N++)h+=1/N;const g=f*(p+h)/(m*l)*Math.pow(o/2,2*i+1);if(c+=g,Math.abs(g)<1e-15*Math.abs(c)&&i>5)break}return 2/Math.PI*((Math.log(o/2)+r)*Mt(1,o)-1/o)-1/Math.PI*c}if(u===0)return s(a);if(u===1)return t(a);let e=s(a),n=t(a);for(let o=1;o<u;o++){const c=2*o/a*n-e;e=n,n=c}return n}function Eu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);return o<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Mt(o,e.v)}}function Mu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);return o<0?{t:"err",v:"#VALUE!"}:e.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:xu(o,e.v)}}function Rt(u,a){let r=0;for(let s=0;s<=100;s++){let t=1;for(let o=2;o<=s;o++)t*=o;let e=1;for(let o=2;o<=u+s;o++)e*=o;const n=1/(t*e)*Math.pow(a/2,2*s+u);if(r+=n,Math.abs(n)<1e-15*Math.abs(r)&&s>5)break}return r}function Ru(u,a){if(a<=0)return NaN;const r=.5772156649015329;function s(o){let c=0;for(let i=1;i<=100;i++){let f=1;for(let p=2;p<=i;p++)f*=p;let m=0;for(let p=1;p<=i;p++)m+=1/p;const l=m/(f*f)*Math.pow(o/2,2*i);if(c+=l,Math.abs(l)<1e-15*Math.abs(c)&&i>5)break}return-(Math.log(o/2)+r)*Rt(0,o)+c}function t(o){let c=0;for(let i=0;i<=100;i++){let f=1;for(let g=2;g<=i;g++)f*=g;let m=1;for(let g=2;g<=i+1;g++)m*=g;let l=0;for(let g=1;g<=i;g++)l+=1/g;let p=0;for(let g=1;g<=i+1;g++)p+=1/g;const h=(l+p)/(2*f*m)*Math.pow(o/2,2*i+1);if(c+=h,Math.abs(h)<1e-15*Math.abs(c)&&i>5)break}return 1/o+(Math.log(o/2)+r)*Rt(1,o)-c}if(u===0)return s(a);if(u===1)return t(a);let e=s(a),n=t(a);for(let o=1;o<u;o++){const c=2*o/a*n+e;e=n,n=c}return n}function bu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);return o<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Rt(o,e.v)}}function Tu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);return o<0?{t:"err",v:"#VALUE!"}:e.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Ru(o,e.v)}}function U(u,a,r){const s=new Date(u),t=new Date(a),e=s.getFullYear(),n=s.getMonth()+1,o=s.getDate(),c=t.getFullYear(),i=t.getMonth()+1,f=t.getDate(),m=(t.getTime()-s.getTime())/864e5;switch(r){case 0:{let l=o,p=f;return l===31&&(l=30),p===31&&l>=30&&(p=30),((c-e)*360+(i-n)*30+(p-l))/360}case 1:{const l=(new Date(e+1,0,1).getTime()-new Date(e,0,1).getTime())/864e5;return m/l}case 2:return m/360;case 3:return m/365;case 4:{const l=Math.min(o,30),p=Math.min(f,30);return((c-e)*360+(i-n)*30+(p-l))/360}default:return m/360}}function at(u,a,r){const s=12/r,t=new Date(a);for(;t>u;)t.setMonth(t.getMonth()-s);return t.setMonth(t.getMonth()+s),t}function lt(u,a,r){const s=at(u,a,r),t=12/r,e=new Date(s);return e.setMonth(e.getMonth()-t),e}function Iu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<6||t.length>7)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[2]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[3]),r);if(o.t==="err")return o;const c=v.map(a(t[4]),r);if(c.t==="err")return c;const i=v.map(a(t[5]),r);if(i.t==="err")return i;const f=t.length>=7?v.map(a(t[6]),r):{t:"num",v:0};if(f.t==="err")return f;const m=U(e,n,Math.trunc(f.v));return{t:"num",v:c.v*o.v*m}}function Su(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=t.length>=5?v.map(a(t[4]),r):{t:"num",v:0};if(i.t==="err")return i;const f=U(e,n,Math.trunc(i.v));return{t:"num",v:c.v*o.v*f}}function Lu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=lt(e,n,Math.trunc(o.v));return{t:"num",v:Math.round((e.getTime()-c.getTime())/864e5)}}function Fu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(o.v),i=lt(e,n,c),f=at(e,n,c);return{t:"num",v:Math.round((f.getTime()-i.getTime())/864e5)}}function Cu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=at(e,n,Math.trunc(o.v));return{t:"num",v:Math.round((c.getTime()-e.getTime())/864e5)}}function Uu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=at(e,n,Math.trunc(o.v));return{t:"str",v:H(c)}}function yu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const i=12/Math.trunc(o.v);let f=0;const m=new Date(n);for(;m>e;)m.setMonth(m.getMonth()-i),f++;return{t:"num",v:f}}function Du(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=lt(e,n,Math.trunc(o.v));return{t:"str",v:H(c)}}function Vu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=t.length>=5?v.map(a(t[4]),r):{t:"num",v:0};if(i.t==="err")return i;const f=U(e,n,Math.trunc(i.v));return f===0?{t:"err",v:"#VALUE!"}:{t:"num",v:(c.v-o.v)/c.v/f}}function Ou(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=t.length>=5?v.map(a(t[4]),r):{t:"num",v:0};if(i.t==="err")return i;const f=U(e,n,Math.trunc(i.v));return{t:"num",v:c.v*(1-o.v*f)}}function wu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=t.length>=5?v.map(a(t[4]),r):{t:"num",v:0};if(i.t==="err")return i;const f=U(e,n,Math.trunc(i.v));return f===0||o.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:(c.v-o.v)/o.v/f}}function Pu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<5||t.length>6)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=v.map(a(t[4]),r);if(i.t==="err")return i;const f=t.length>=6?v.map(a(t[5]),r):{t:"num",v:0};if(f.t==="err")return f;const m=Math.trunc(i.v),l=Math.ceil(U(e,n,Math.trunc(f.v))*m);if(l<=0)return{t:"err",v:"#VALUE!"};const p=o.v/m,h=c.v/m;let g=0,N=0;for(let x=1;x<=l;x++){const E=p/Math.pow(1+h,x);g+=x/m*E,N+=E}const A=1/Math.pow(1+h,l);return g+=l/m*A,N+=A,{t:"num",v:g/N}}function _u(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<5||t.length>6)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=v.map(a(t[4]),r);if(i.t==="err")return i;const f=t.length>=6?v.map(a(t[5]),r):{t:"num",v:0};if(f.t==="err")return f;const m=Math.trunc(i.v),l=Math.ceil(U(e,n,Math.trunc(f.v))*m);if(l<=0)return{t:"err",v:"#VALUE!"};const p=o.v/m,h=c.v/m;let g=0,N=0;for(let E=1;E<=l;E++){const R=p/Math.pow(1+h,E);g+=E/m*R,N+=R}const A=1/Math.pow(1+h,l);return g+=l/m*A,N+=A,{t:"num",v:g/N/(1+c.v/m)}}function ku(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=t.length>=5?v.map(a(t[4]),r):{t:"num",v:0};if(i.t==="err")return i;const f=U(e,n,Math.trunc(i.v)),m=1-c.v*f;return m===0?{t:"err",v:"#VALUE!"}:{t:"num",v:o.v/m}}function Bu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=t.length>=5?v.map(a(t[4]),r):{t:"num",v:0};if(i.t==="err")return i;const f=U(e,n,Math.trunc(i.v));return f===0||o.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:(c.v-o.v)/o.v/f}}function Hu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<6||t.length>7)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=v.map(a(t[4]),r);if(i.t==="err")return i;const f=v.map(a(t[5]),r);if(f.t==="err")return f;const m=t.length>=7?v.map(a(t[6]),r):{t:"num",v:0};if(m.t==="err")return m;const l=Math.trunc(f.v),p=Math.trunc(m.v),h=Math.ceil(U(e,n,p)*l);if(h<=0)return{t:"err",v:"#VALUE!"};const g=100*o.v/l,N=c.v/l,A=lt(e,n,l),x=at(e,n,l),E=Math.round((x.getTime()-A.getTime())/864e5),R=Math.round((x.getTime()-e.getTime())/864e5),S=E-R,T=E>0?R/E:0;let C=0;for(let W=1;W<=h;W++)C+=g/Math.pow(1+N,W-1+T);return C+=i.v/Math.pow(1+N,h-1+T),C-=g*(S/E),{t:"num",v:C}}function Xu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<6||t.length>7)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=v.map(a(t[4]),r);if(i.t==="err")return i;const f=v.map(a(t[5]),r);if(f.t==="err")return f;const m=t.length>=7?v.map(a(t[6]),r):{t:"num",v:0};if(m.t==="err")return m;const l=Math.trunc(f.v),p=Math.trunc(m.v),h=Math.ceil(U(e,n,p)*l);if(h<=0)return{t:"err",v:"#VALUE!"};const g=100*o.v/l,N=lt(e,n,l),A=at(e,n,l),x=Math.round((A.getTime()-N.getTime())/864e5),E=Math.round((A.getTime()-e.getTime())/864e5),R=x-E,S=x>0?E/x:0;let T=o.v;for(let C=0;C<200;C++){const W=T/l;let vt=0,pt=0;for(let xt=1;xt<=h;xt++){const Et=xt-1+S;vt+=g/Math.pow(1+W,Et),pt-=g*Et/(l*Math.pow(1+W,Et+1))}const dt=h-1+S;vt+=i.v/Math.pow(1+W,dt),pt-=i.v*dt/(l*Math.pow(1+W,dt+1)),vt-=g*(R/x);const Ot=vt-c.v;if(Math.abs(Ot)<1e-10||Math.abs(pt)<1e-20)break;T-=Ot/pt}return{t:"num",v:T}}function Yu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<5||t.length>6)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=M(a(t[2]),r);if(!(o instanceof Date))return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=v.map(a(t[4]),r);if(i.t==="err")return i;const f=t.length>=6?v.map(a(t[5]),r):{t:"num",v:0};if(f.t==="err")return f;const m=Math.trunc(f.v),l=U(o,n,m),p=U(o,e,m),g=1+U(e,n,m)*i.v;return g===0?{t:"err",v:"#VALUE!"}:{t:"num",v:100*(1+l*c.v)/g-100*p*c.v}}function Gu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<5||t.length>6)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!(e instanceof Date))return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=M(a(t[2]),r);if(!(o instanceof Date))return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=v.map(a(t[4]),r);if(i.t==="err")return i;const f=t.length>=6?v.map(a(t[5]),r):{t:"num",v:0};if(f.t==="err")return f;const m=Math.trunc(f.v),l=U(o,n,m),p=U(o,e,m),h=U(e,n,m);if(h===0)return{t:"err",v:"#VALUE!"};const g=i.v/100+p*c.v;return g===0?{t:"err",v:"#VALUE!"}:{t:"num",v:((1+l*c.v)/g-1)/h}}function qu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<6||t.length>7)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=M(a(t[1]),r);if(!(n instanceof Date))return n;const o=M(a(t[2]),r);if(!(o instanceof Date))return o;const c=v.map(a(t[3]),r);if(c.t==="err")return c;const i=v.map(a(t[4]),r);if(i.t==="err")return i;const f=v.map(a(t[5]),r);if(f.t==="err")return f;const m=t.length>=7?v.map(a(t[6]),r):{t:"num",v:0};if(m.t==="err")return m;const l=Math.trunc(i.v),p=e.v*f.v;if(l===0){const N=U(n,o,Math.trunc(m.v));return{t:"num",v:p*N}}let h=e.v-p*U(n,o,Math.trunc(m.v));for(let N=1;N<l;N++)if(h-=p,h-c.v<=0)return{t:"num",v:0};const g=Math.min(p,h-c.v);return{t:"num",v:Math.max(0,g)}}function Wu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=v.map(a(t[3]),r);return c.t==="err"?c:{t:"num",v:c.v*e.v*(n.v/o.v-1)}}function Ku(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=a(t[1]);if(n.t==="err")return n;let o=e.v;if(n.t==="ref"&&r){const c=n.v;for(const i of b(Array.isArray(c)?c:[c])){const f=r.get(i);if(f&&f.v!=null){const m=Number(f.v);isNaN(m)||(o*=1+m)}}}else{const c=v.map(n,r);if(c.t==="err")return c;o*=1+c.v}return{t:"num",v:o}}function Qu(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);return o.t==="err"?o:e.v<=0||n.v<=0||o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:(Math.log(o.v)-Math.log(n.v))/Math.log(1+e.v)}}function $u(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);return o.t==="err"?o:e.v===0||n.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.pow(o.v/n.v,1/e.v)-1}}function B(u,a,r){var N;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t!=="ref"||!r)return{t:"err",v:"#VALUE!"};if(!F(e.v))return{t:"err",v:"#VALUE!"};const n=tt(e.v),o=a(t[1]);let c;if(o.t==="num")c=n[0].c+o.v-1;else{const A=d(o,r);if(A.t==="err")return A;const x=A.v.toLowerCase();c=-1;for(let E=n[0].c;E<=n[1].c;E++){const R=q({r:n[0].r,c:E}),S=r.get(R);if(S&&S.v&&S.v.toLowerCase()===x){c=E;break}}if(c===-1)return{t:"err",v:"#VALUE!"}}const i=a(t[2]);if(i.t!=="ref")return{t:"err",v:"#VALUE!"};if(!F(i.v))return{t:"err",v:"#VALUE!"};const f=tt(i.v),m=[];for(let A=f[0].c;A<=f[1].c;A++){const x=q({r:f[0].r,c:A}),E=r.get(x);m.push(((N=E==null?void 0:E.v)==null?void 0:N.toLowerCase())??"")}const l=[];for(const A of m){let x=-1;for(let E=n[0].c;E<=n[1].c;E++){const R=q({r:n[0].r,c:E}),S=r.get(R);if(S&&S.v&&S.v.toLowerCase()===A){x=E;break}}l.push(x)}const p=[];for(let A=f[0].r+1;A<=f[1].r;A++){const x=[];for(let E=0;E<m.length;E++){if(l[E]===-1)continue;const R=q({r:A,c:f[0].c+E}),S=r.get(R);S&&S.v!=null&&S.v!==""&&x.push({col:l[E],value:S.v})}x.length>0&&p.push(x)}const h=[],g=[];for(let A=n[0].r+1;A<=n[1].r;A++)if(p.length===0||p.some(E=>E.every(R=>{const S=q({r:A,c:R.col}),T=r.get(S),C=(T==null?void 0:T.v)??"";return R.value.startsWith(">=")?Number(C)>=Number(R.value.slice(2)):R.value.startsWith("<=")?Number(C)<=Number(R.value.slice(2)):R.value.startsWith("<>")?C!==R.value.slice(2):R.value.startsWith(">")?Number(C)>Number(R.value.slice(1)):R.value.startsWith("<")?Number(C)<Number(R.value.slice(1)):R.value.startsWith("=")?C===R.value.slice(1):C.toLowerCase()===R.value.toLowerCase()}))){const E=q({r:A,c}),R=r.get(E),S=(R==null?void 0:R.v)??"";g.push(S);const T=Number(S);!isNaN(T)&&S!==""&&h.push(T)}return{values:h,strValues:g}}function zu(u,a,r){const s=B(u,a,r);return"t"in s?s:{t:"num",v:s.values.reduce((t,e)=>t+e,0)}}function ju(u,a,r){const s=B(u,a,r);return"t"in s?s:{t:"num",v:s.values.length}}function Ju(u,a,r){const s=B(u,a,r);return"t"in s?s:{t:"num",v:s.strValues.filter(t=>t!=="").length}}function Zu(u,a,r){const s=B(u,a,r);return"t"in s?s:s.values.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:s.values.reduce((t,e)=>t+e,0)/s.values.length}}function tc(u,a,r){const s=B(u,a,r);return"t"in s?s:s.values.length===0?{t:"num",v:0}:{t:"num",v:Math.max(...s.values)}}function ec(u,a,r){const s=B(u,a,r);return"t"in s?s:s.values.length===0?{t:"num",v:0}:{t:"num",v:Math.min(...s.values)}}function rc(u,a,r){const s=B(u,a,r);return"t"in s?s:s.values.length===0?{t:"num",v:0}:{t:"num",v:s.values.reduce((t,e)=>t*e,1)}}function nc(u,a,r){const s=B(u,a,r);if("t"in s)return s;if(s.strValues.length!==1)return{t:"err",v:"#VALUE!"};const t=Number(s.strValues[0]);return!isNaN(t)&&s.strValues[0]!==""?{t:"num",v:t}:{t:"str",v:s.strValues[0]}}function ac(u,a,r){const s=B(u,a,r);if("t"in s)return s;const t=s.values;if(t.length<2)return{t:"err",v:"#VALUE!"};const e=t.reduce((o,c)=>o+c,0)/t.length,n=t.reduce((o,c)=>o+(c-e)**2,0)/(t.length-1);return{t:"num",v:Math.sqrt(n)}}function sc(u,a,r){const s=B(u,a,r);if("t"in s)return s;const t=s.values;if(t.length===0)return{t:"err",v:"#VALUE!"};const e=t.reduce((o,c)=>o+c,0)/t.length,n=t.reduce((o,c)=>o+(c-e)**2,0)/t.length;return{t:"num",v:Math.sqrt(n)}}function oc(u,a,r){const s=B(u,a,r);if("t"in s)return s;const t=s.values;if(t.length<2)return{t:"err",v:"#VALUE!"};const e=t.reduce((n,o)=>n+o,0)/t.length;return{t:"num",v:t.reduce((n,o)=>n+(o-e)**2,0)/(t.length-1)}}function uc(u,a,r){const s=B(u,a,r);if("t"in s)return s;const t=s.values;if(t.length===0)return{t:"err",v:"#VALUE!"};const e=t.reduce((n,o)=>n+o,0)/t.length;return{t:"num",v:t.reduce((n,o)=>n+(o-e)**2,0)/t.length}}function cc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const e=y(t[0],t.length>=2?t[1]:void 0,a,r);if("t"in e)return e;const n=e.ys,o=e.xs.length>0?e.xs:n.map((m,l)=>l+1);if(n.length!==o.length||n.length===0)return{t:"err",v:"#VALUE!"};const c=n.map(m=>Math.log(m)),i=z(o,c);let f;if(t.length>=3){const m=v.map(a(t[2]),r);if(m.t==="err")return m;f=m.v}else f=o[o.length-1];return{t:"num",v:Math.exp(i.intercept)*Math.exp(i.slope*f)}}function ic(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const e=y(t[0],t.length>=2?t[1]:void 0,a,r);if("t"in e)return e;const n=e.ys,o=e.xs.length>0?e.xs:n.map((f,m)=>m+1);if(n.length!==o.length||n.length===0)return{t:"err",v:"#VALUE!"};const c=z(o,n);let i;if(t.length>=3){const f=v.map(a(t[2]),r);if(f.t==="err")return f;i=f.v}else i=o[o.length-1];return{t:"num",v:c.slope*i+c.intercept}}function fc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=y(t[0],t.length>=2?t[1]:void 0,a,r);if("t"in e)return e;const n=e.ys,o=e.xs.length>0?e.xs:n.map((i,f)=>f+1);return n.length!==o.length||n.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:z(o,n).slope}}function mc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=y(t[0],t.length>=2?t[1]:void 0,a,r);if("t"in e)return e;const n=e.ys,o=e.xs.length>0?e.xs:n.map((f,m)=>m+1);if(n.length!==o.length||n.length===0)return{t:"err",v:"#VALUE!"};const c=n.map(f=>Math.log(f)),i=z(o,c);return{t:"num",v:Math.exp(i.slope)}}function lc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=X(t[0],a,r);if(!Array.isArray(e))return e;const n=X(t[1],a,r);if(!Array.isArray(n))return n;const o=e,c=[...n].sort((f,m)=>f-m),i=new Array(c.length+1).fill(0);for(const f of o){let m=!1;for(let l=0;l<c.length;l++)if(f<=c[l]){i[l]++,m=!0;break}m||i[c.length]++}return{t:"num",v:i[0]}}function vc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1)return{t:"err",v:"#N/A!"};const e=[];for(const i of t){const f=X(i,a,r);if(!Array.isArray(f))return f;e.push(...f)}if(e.length===0)return{t:"err",v:"#VALUE!"};const n=new Map;for(const i of e)n.set(i,(n.get(i)??0)+1);let o=0;for(const i of n.values())i>o&&(o=i);return o<=1?{t:"err",v:"#N/A!"}:{t:"num",v:Array.from(n.entries()).filter(([,i])=>i===o).map(([i])=>i).sort((i,f)=>i-f)[0]}}function pc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=[];for(let c=2;c<t.length;c++){const i=a(t[c]);if(i.t!=="err")if(i.t==="ref"&&r)for(const f of b(Array.isArray(i.v)?[i.v]:[i.v])){const m=r.get(f);if(m&&m.v!=null){const l=Number(m.v);isNaN(l)||n.push(l)}}else{const f=v.map(i,r);f.t!=="err"&&n.push(f.v)}}switch(Math.trunc(e.v)){case 1:return{t:"num",v:n.reduce((c,i)=>c+i,0)/(n.length||1)};case 2:return{t:"num",v:n.length};case 3:return{t:"num",v:n.length};case 4:return{t:"num",v:n.length>0?Math.max(...n):0};case 5:return{t:"num",v:n.length>0?Math.min(...n):0};case 6:return{t:"num",v:n.reduce((c,i)=>c*i,1)};case 7:{if(n.length<2)return{t:"err",v:"#VALUE!"};const c=n.reduce((f,m)=>f+m,0)/n.length,i=n.reduce((f,m)=>f+(m-c)**2,0)/(n.length-1);return{t:"num",v:Math.sqrt(i)}}case 8:{if(n.length===0)return{t:"err",v:"#VALUE!"};const c=n.reduce((f,m)=>f+m,0)/n.length,i=n.reduce((f,m)=>f+(m-c)**2,0)/n.length;return{t:"num",v:Math.sqrt(i)}}case 9:return{t:"num",v:n.reduce((c,i)=>c+i,0)};case 10:{if(n.length<2)return{t:"err",v:"#VALUE!"};const c=n.reduce((i,f)=>i+f,0)/n.length;return{t:"num",v:n.reduce((i,f)=>i+(f-c)**2,0)/(n.length-1)}}case 11:{if(n.length===0)return{t:"err",v:"#VALUE!"};const c=n.reduce((i,f)=>i+f,0)/n.length;return{t:"num",v:n.reduce((i,f)=>i+(f-c)**2,0)/n.length}}case 12:{const c=[...n].sort((f,m)=>f-m),i=Math.floor(c.length/2);return{t:"num",v:c.length%2===0?(c[i-1]+c[i])/2:c[i]}}default:return{t:"err",v:"#VALUE!"}}}function hc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(e.v),c=Math.trunc(n.v);if(o<0||c<0)return{t:"err",v:"#VALUE!"};if(c===0)return{t:"num",v:1};let i=1;for(let f=0;f<c;f++)i=i*(o+c-1-f)/(f+1);return{t:"num",v:Math.round(i)}}function gc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(e.v),c=Math.trunc(n.v);return o<0||c<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.pow(o,c)}}function Nc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const n=e.ys,o=e.xs,c=v.map(a(t[2]),r);if(c.t==="err")return c;const i=v.map(a(t[3]),r);if(i.t==="err")return i;if(n.length<2||o.length<2)return{t:"err",v:"#VALUE!"};const f=n.reduce((T,C)=>T+C,0)/n.length,m=o.reduce((T,C)=>T+C,0)/o.length,l=n.reduce((T,C)=>T+(C-f)**2,0)/(n.length-1),p=o.reduce((T,C)=>T+(C-m)**2,0)/(o.length-1),h=n.length,g=o.length,N=((h-1)*l+(g-1)*p)/(h+g-2),A=Math.abs(f-m)/Math.sqrt(N*(1/h+1/g)),x=h+g-2,E=x/(x+A*A),R=.5*k(E,x/2,.5);return{t:"num",v:Math.trunc(c.v)===1?R:2*R}}function Ac(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=X(t[0],a,r);if(!Array.isArray(e))return e;if(e.length===0)return{t:"err",v:"#VALUE!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=e.reduce((f,m)=>f+m,0)/e.length;let c;if(t.length>=3){const f=v.map(a(t[2]),r);if(f.t==="err")return f;c=f.v}else{const f=e.reduce((m,l)=>m+(l-o)**2,0)/(e.length-1);c=Math.sqrt(f)}const i=(o-n.v)/(c/Math.sqrt(e.length));return{t:"num",v:1-mt(i)}}function dc(u,a){const r=u.args();return r?r.expr().length!==1?{t:"err",v:"#N/A!"}:{t:"num",v:1}:{t:"err",v:"#N/A!"}}function xc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=d(a(t[0]),r);if(e.t==="err")return e;const n=e.v.toLowerCase();if(t.length<2)return n==="row"?{t:"num",v:1}:n==="col"?{t:"num",v:1}:{t:"str",v:""};const o=a(t[1]);if(o.t!=="ref")return{t:"err",v:"#VALUE!"};const i=(typeof o.v=="string"?o.v:"").match(/^([A-Z]+)(\d+)/i);if(!i)return{t:"err",v:"#VALUE!"};const f=ct(i[0]);switch(n){case"row":return{t:"num",v:f.r};case"col":return{t:"num",v:f.c};case"address":return{t:"str",v:"$"+It(f.c)+"$"+f.r};case"contents":{if(!r)return{t:"str",v:""};const m=r.get(q(f));return(m==null?void 0:m.v)!=null?{t:"str",v:m.v}:{t:"str",v:""}}default:return{t:"str",v:""}}}function Ec(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;const n=P(t[1],a,r);if("t"in n&&n.t==="err")return n;if(e.t!=="matrix"||n.t!=="matrix")return{t:"err",v:"#VALUE!"};const o=e.v,c=n.v;if(o.colCount!==c.rowCount)return{t:"err",v:"#VALUE!"};const i=(p,h,g,N)=>{var x;const A=(x=r==null?void 0:r.get(p[h*N+g]))==null?void 0:x.v;return A!=null&&A!==""?Number(A):0},f=o.rowCount,m=c.colCount,l=[];for(let p=0;p<f;p++)for(let h=0;h<m;h++){let g=0;for(let N=0;N<o.colCount;N++)g+=i(o.refs,p,N,o.colCount)*i(c.refs,N,h,c.colCount);l.push(g)}return{t:"num",v:l[0]}}function Mc(u,a,r){var c;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=e.v.rowCount;if(n!==e.v.colCount)return{t:"err",v:"#VALUE!"};const o=[];for(let i=0;i<n;i++){const f=[];for(let m=0;m<n;m++){const l=(c=r==null?void 0:r.get(e.v.refs[i*n+m]))==null?void 0:c.v;f.push(l!=null&&l!==""?Number(l):0)}for(let m=0;m<n;m++)f.push(i===m?1:0);o.push(f)}for(let i=0;i<n;i++){let f=i,m=Math.abs(o[i][i]);for(let p=i+1;p<n;p++)Math.abs(o[p][i])>m&&(m=Math.abs(o[p][i]),f=p);if(m<1e-12)return{t:"err",v:"#VALUE!"};f!==i&&([o[i],o[f]]=[o[f],o[i]]);const l=o[i][i];for(let p=0;p<2*n;p++)o[i][p]/=l;for(let p=0;p<n;p++){if(p===i)continue;const h=o[p][i];for(let g=0;g<2*n;g++)o[p][g]-=h*o[i][g]}}return{t:"num",v:o[0][n]}}function Rc(u,a,r){var m,l,p,h;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>4)return{t:"err",v:"#N/A!"};const e=a(t[0]);if(e.t==="err")return e;const n=I(t[1],a,r);if("t"in n&&n.t==="err")return n;if(!("v"in n)||!Array.isArray(n.v))return{t:"err",v:"#VALUE!"};const o=n.v;let c=0;if(t.length>=3){const g=v.map(a(t[2]),r);if(g.t==="err")return g;c=Math.trunc(g.v)}const i=e.t==="num"||e.t==="str"||e.t==="bool"?e.v:"",f=e.t==="num";if(c===0){for(let g=0;g<o.length;g++){const N=((m=r==null?void 0:r.get(o[g]))==null?void 0:m.v)||"";if(f){if(N!==""&&Number(N)===i)return{t:"num",v:g+1}}else if(String(N).toLowerCase()===String(i).toLowerCase())return{t:"num",v:g+1}}return{t:"err",v:"#N/A!"}}else if(c===-1){let g=-1,N=-1/0;const A=Number(i);for(let x=0;x<o.length;x++){const E=((l=r==null?void 0:r.get(o[x]))==null?void 0:l.v)||"",R=Number(E);!isNaN(R)&&R<=A&&R>N&&(N=R,g=x)}return g>=0?{t:"num",v:g+1}:{t:"err",v:"#N/A!"}}else if(c===1){let g=-1,N=1/0;const A=Number(i);for(let x=0;x<o.length;x++){const E=((p=r==null?void 0:r.get(o[x]))==null?void 0:p.v)||"",R=Number(E);!isNaN(R)&&R>=A&&R<N&&(N=R,g=x)}return g>=0?{t:"num",v:g+1}:{t:"err",v:"#N/A!"}}else if(c===2){const g=String(i).replace(/\*/g,".*").replace(/\?/g,"."),N=new RegExp("^"+g+"$","i");for(let A=0;A<o.length;A++){const x=((h=r==null?void 0:r.get(o[A]))==null?void 0:h.v)||"";if(N.test(x))return{t:"num",v:A+1}}return{t:"err",v:"#N/A!"}}return{t:"err",v:"#N/A!"}}function se(u,a,r){var l,p;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};let n=0;if(t.length>=2){const h=v.map(a(t[1]),r);if(h.t==="err")return h;n=Math.trunc(h.v)}let o=!1;if(t.length>=3){const h=a(t[2]);o=h.t==="bool"?h.v===!0:h.t==="num"?h.v!==0:!1}const c=[],{refs:i,rowCount:f,colCount:m}=e.v;if(o)for(let h=0;h<m;h++)for(let g=0;g<f;g++){const N=((l=r==null?void 0:r.get(i[g*m+h]))==null?void 0:l.v)??"";n===1&&N===""||c.push(N)}else for(const h of i){const g=((p=r==null?void 0:r.get(h))==null?void 0:p.v)??"";n===1&&g===""||c.push(g)}return c.length>0?{t:"str",v:c[0]}:{t:"err",v:"#N/A!"}}function bc(u,a,r){return se(u,a,r)}function Tc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>6)return{t:"err",v:"#N/A!"};const e=a(t[0]),n=e.t==="str"?e.v:e.t==="num"?String(e.v):"";if(e.t==="err")return e;const o=a(t[1]);if(o.t==="err")return o;const c=o.t==="str"?o.v:String(o.v);if(c==="")return{t:"err",v:"#VALUE!"};let i=!1;if(t.length>=4){const m=a(t[3]);i=m.t==="bool"?m.v===!0:m.t==="num"?m.v!==0:!1}let f=n.split(c);return i&&(f=f.filter(m=>m!=="")),f.length>0?{t:"str",v:f[0]}:{t:"err",v:"#N/A!"}}function Ic(u,a,r){var f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;let o=Math.trunc(n.v);if(o<0&&(o=e.v.rowCount+o+1),o<1||o>e.v.rowCount)return{t:"err",v:"#VALUE!"};const c=(o-1)*e.v.colCount,i=((f=r==null?void 0:r.get(e.v.refs[c]))==null?void 0:f.v)??"";return i!==""&&!isNaN(Number(i))?{t:"num",v:Number(i)}:{t:"str",v:i}}function Sc(u,a,r){var f;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;let o=Math.trunc(n.v);if(o<0&&(o=e.v.colCount+o+1),o<1||o>e.v.colCount)return{t:"err",v:"#VALUE!"};const c=o-1,i=((f=r==null?void 0:r.get(e.v.refs[c]))==null?void 0:f.v)??"";return i!==""&&!isNaN(Number(i))?{t:"num",v:Number(i)}:{t:"str",v:i}}function Lc(u,a,r){var l;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);if(o===0)return{t:"err",v:"#VALUE!"};const c=o>0?0:e.v.rowCount+o;if(c<0||c>=e.v.rowCount)return{t:"err",v:"#VALUE!"};let i=0;if(t.length>=3){const p=v.map(a(t[2]),r);if(p.t==="err")return p;const h=Math.trunc(p.v);if(h===0)return{t:"err",v:"#VALUE!"};if(i=h>0?0:e.v.colCount+h,i<0||i>=e.v.colCount)return{t:"err",v:"#VALUE!"}}const f=c*e.v.colCount+i,m=((l=r==null?void 0:r.get(e.v.refs[f]))==null?void 0:l.v)??"";return m!==""&&!isNaN(Number(m))?{t:"num",v:Number(m)}:{t:"str",v:m}}function Fc(u,a,r){var l;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v),c=o>=0?o:0;if(c>=e.v.rowCount)return{t:"err",v:"#VALUE!"};let i=0;if(t.length>=3){const p=v.map(a(t[2]),r);if(p.t==="err")return p;const h=Math.trunc(p.v);if(i=h>=0?h:0,i>=e.v.colCount)return{t:"err",v:"#VALUE!"}}const f=c*e.v.colCount+i,m=((l=r==null?void 0:r.get(e.v.refs[f]))==null?void 0:l.v)??"";return m!==""&&!isNaN(Number(m))?{t:"num",v:Number(m)}:{t:"str",v:m}}function oe(u,a,r){var o;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=((o=r==null?void 0:r.get(e.v.refs[0]))==null?void 0:o.v)??"";return n!==""&&!isNaN(Number(n))?{t:"num",v:Number(n)}:{t:"str",v:n}}function Cc(u,a,r){return oe(u,a,r)}function Uc(u,a,r){var l,p;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=I(t[1],a,r);if("t"in n&&n.t==="err")return n;const o=n.v;let c=1;if(t.length>=3){const h=v.map(a(t[2]),r);if(h.t==="err")return h;c=h.v===-1?-1:1}const i=[];for(let h=0;h<e.v.rowCount;h++){const g=h<o.length?h:o.length-1,N=((l=r==null?void 0:r.get(o[g]))==null?void 0:l.v)??"";i.push({idx:h,key:N})}i.sort((h,g)=>{const N=Number(h.key),A=Number(g.key);return!isNaN(N)&&!isNaN(A)?(N-A)*c:h.key.localeCompare(g.key)*c});const f=i[0].idx,m=((p=r==null?void 0:r.get(e.v.refs[f*e.v.colCount]))==null?void 0:p.v)??"";return m!==""&&!isNaN(Number(m))?{t:"num",v:Number(m)}:{t:"str",v:m}}function ue(u,a,r){var c;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;if(n.v<1)return{t:"err",v:"#VALUE!"};const o=((c=r==null?void 0:r.get(e.v.refs[0]))==null?void 0:c.v)??"";return o!==""&&!isNaN(Number(o))?{t:"num",v:Number(o)}:{t:"str",v:o}}function yc(u,a,r){return ue(u,a,r)}function Dc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:mt(e.v)-.5}}function Vc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Nt(e.v)}}function Oc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr(),e=[];for(const c of t){const i=a(c);if(i.t==="err")return i;if(i.t==="num")e.push(i.v);else if(i.t==="bool")e.push(i.v?1:0);else if(i.t==="ref"&&r)for(const f of b([i.v])){const m=r.get(f);if((m==null?void 0:m.v)!=null&&m.v!==""){const l=Number(m.v);e.push(isNaN(l)?0:l)}}else i.t==="str"&&e.push(0)}if(e.length<2)return{t:"err",v:"#VALUE!"};const n=e.reduce((c,i)=>c+i,0)/e.length,o=e.reduce((c,i)=>c+(i-n)**2,0)/(e.length-1);return{t:"num",v:Math.sqrt(o)}}function wc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr(),e=[];for(const c of t){const i=a(c);if(i.t==="err")return i;if(i.t==="num")e.push(i.v);else if(i.t==="bool")e.push(i.v?1:0);else if(i.t==="ref"&&r)for(const f of b([i.v])){const m=r.get(f);if((m==null?void 0:m.v)!=null&&m.v!==""){const l=Number(m.v);e.push(isNaN(l)?0:l)}}else i.t==="str"&&e.push(0)}if(e.length<1)return{t:"err",v:"#VALUE!"};const n=e.reduce((c,i)=>c+i,0)/e.length,o=e.reduce((c,i)=>c+(i-n)**2,0)/e.length;return{t:"num",v:Math.sqrt(o)}}function Pc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr(),e=[];for(const f of t){const m=X(f,a,r);if(!Array.isArray(m))return m;e.push(...m)}if(e.length<3)return{t:"err",v:"#VALUE!"};const n=e.length,o=e.reduce((f,m)=>f+m,0)/n,c=Math.sqrt(e.reduce((f,m)=>f+(m-o)**2,0)/n);return c===0?{t:"err",v:"#VALUE!"}:{t:"num",v:e.reduce((f,m)=>f+((m-o)/c)**3,0)/n}}function _c(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const n=e.ys,o=e.xs;if(n.length<1)return{t:"err",v:"#VALUE!"};let c=0;for(let m=0;m<n.length;m++){if(o[m]===0)return{t:"err",v:"#VALUE!"};c+=(n[m]-o[m])**2/o[m]}const i=n.length-1;return i<1?{t:"err",v:"#VALUE!"}:{t:"num",v:1-kc(i/2,c/2)}}function kc(u,a){if(a<0||a===0)return 0;if(a<u+1){let r=1/u,s=1/u;for(let t=1;t<200&&(s*=a/(u+t),r+=s,!(Math.abs(s)<1e-14*Math.abs(r)));t++);return r*Math.exp(-a+u*Math.log(a)-yt(u))}return 1-Bc(u,a)}function Bc(u,a){let r=1e-30,s=1/(a+1-u),t=s;for(let e=1;e<200;e++){const n=e*(u-e),o=a+2*e+1-u;s=o+n*s,Math.abs(s)<1e-30&&(s=1e-30),r=o+n/r,Math.abs(r)<1e-30&&(r=1e-30),s=1/s;const c=s*r;if(t*=c,Math.abs(c-1)<1e-14)break}return t*Math.exp(-a+u*Math.log(a)-yt(u))}function yt(u){const r=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(u<.5)return Math.log(Math.PI/Math.sin(Math.PI*u))-yt(1-u);u-=1;let s=r[0];for(let e=1;e<9;e++)s+=r[e]/(u+e);const t=u+7+.5;return .5*Math.log(2*Math.PI)+(u+.5)*Math.log(t)-t+Math.log(s)}function Hc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const e=y(t[0],t[1],a,r);if("t"in e)return e;const n=e.ys,o=e.xs;if(n.length<2||o.length<2)return{t:"err",v:"#VALUE!"};const c=n.reduce((x,E)=>x+E,0)/n.length,i=o.reduce((x,E)=>x+E,0)/o.length,f=n.reduce((x,E)=>x+(E-c)**2,0)/(n.length-1),m=o.reduce((x,E)=>x+(E-i)**2,0)/(o.length-1);if(m===0)return{t:"err",v:"#VALUE!"};const l=f/m,p=n.length-1,h=o.length-1,g=h/(h+p*l),N=k(g,h/2,p/2);return{t:"num",v:2*Math.min(N,1-N)}}function Xc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;let n=1;if(t.length>=2){const o=v.map(a(t[1]),r);if(o.t==="err")return o;n=Math.abs(o.v)}return n===0?{t:"num",v:0}:{t:"num",v:Math.ceil(e.v/n)*n}}function Yc(u,a,r){var c,i;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=I(t[1],a,r);if("t"in n&&n.t==="err")return n;const o=n.v;for(let f=0;f<e.v.rowCount;f++){const m=f<o.length?f:o.length-1,l=((c=r==null?void 0:r.get(o[m]))==null?void 0:c.v)??"";if(l==="TRUE"||l==="1"||l!==""&&l!=="0"&&l!=="FALSE"){const h=((i=r==null?void 0:r.get(e.v.refs[f*e.v.colCount]))==null?void 0:i.v)??"";return h!==""&&!isNaN(Number(h))?{t:"num",v:Number(h)}:{t:"str",v:h}}}return t.length>=3?a(t[2]):{t:"err",v:"#N/A!"}}function Gc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:1/Math.cosh(e.v)}}function qc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:1/Math.sinh(e.v)}}function Wc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.cosh(e.v)/Math.sinh(e.v)}}function Kc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:{t:"num",v:Math.atan(1/e.v)}}function Qc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:Math.abs(e.v)<=1?{t:"err",v:"#VALUE!"}:{t:"num",v:.5*Math.log((e.v+1)/(e.v-1))}}function $c(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!e)return{t:"err",v:"#VALUE!"};const n=M(a(t[1]),r);if(!n)return{t:"err",v:"#VALUE!"};let o=!1;if(t.length>=3){const h=a(t[2]);o=h.t==="bool"?h.v===!0:h.t==="num"?h.v!==0:!1}let c=e.getDate(),i=e.getMonth()+1,f=e.getFullYear(),m=n.getDate(),l=n.getMonth()+1,p=n.getFullYear();return o?(c>30&&(c=30),m>30&&(m=30)):(c===31&&(c=30),m===31&&c>=30&&(m=30)),{t:"num",v:(p-f)*360+(l-i)*30+(m-c)}}function zc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>4)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!e)return{t:"err",v:"#VALUE!"};const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=Math.trunc(n.v);let c=new Set([0,6]);if(t.length>=3){const p=v.map(a(t[2]),r);if(p.t!=="err"){const h=Math.trunc(p.v);c=ce(h)}}const i=new Set;if(t.length>=4){const p=a(t[3]);if(p.t==="ref"&&r)for(const h of b([p.v])){const g=r.get(h);if(g!=null&&g.v){const N=new Date(g.v);isNaN(N.getTime())||i.add(N.toISOString().slice(0,10))}}}const f=new Date(e),m=o>=0?1:-1;let l=Math.abs(o);for(;l>0;)f.setDate(f.getDate()+m),!c.has(f.getDay())&&!i.has(f.toISOString().slice(0,10))&&l--;return{t:"str",v:H(f)}}function ce(u){switch(u){case 1:return new Set([0,6]);case 2:return new Set([0,1]);case 3:return new Set([1,2]);case 4:return new Set([2,3]);case 5:return new Set([3,4]);case 6:return new Set([4,5]);case 7:return new Set([5,6]);case 11:return new Set([0]);case 12:return new Set([1]);case 13:return new Set([2]);case 14:return new Set([3]);case 15:return new Set([4]);case 16:return new Set([5]);case 17:return new Set([6]);default:return new Set([0,6])}}function jc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>4)return{t:"err",v:"#N/A!"};const e=M(a(t[0]),r);if(!e)return{t:"err",v:"#VALUE!"};const n=M(a(t[1]),r);if(!n)return{t:"err",v:"#VALUE!"};let o=new Set([0,6]);if(t.length>=3){const l=v.map(a(t[2]),r);l.t!=="err"&&(o=ce(Math.trunc(l.v)))}const c=new Set;if(t.length>=4){const l=a(t[3]);if(l.t==="ref"&&r)for(const p of b([l.v])){const h=r.get(p);if(h!=null&&h.v){const g=new Date(h.v);isNaN(g.getTime())||c.add(g.toISOString().slice(0,10))}}}const i=n>=e?1:-1,f=new Date(e);let m=0;for(;i>0&&f<=n||i<0&&f>=n;)!o.has(f.getDay())&&!c.has(f.toISOString().slice(0,10))&&m++,f.setDate(f.getDate()+i);return{t:"num",v:m*i}}function Jc(u,a,r){var o;const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<2||t.length>4)return{t:"err",v:"#N/A!"};const e=P(t[0],a,r);if("t"in e&&e.t==="err")return e;if(e.t!=="matrix")return{t:"err",v:"#VALUE!"};const n=((o=r==null?void 0:r.get(e.v.refs[0]))==null?void 0:o.v)??"";return n!==""&&!isNaN(Number(n))?{t:"num",v:Number(n)}:{t:"str",v:n}}function Zc(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);return e.t==="err"?e:e.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:1}}function ti(u,a,r){const s=u.args();if(!s)return{t:"err",v:"#N/A!"};const t=s.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const e=v.map(a(t[0]),r);if(e.t==="err")return e;const n=v.map(a(t[1]),r);if(n.t==="err")return n;const o=v.map(a(t[2]),r);if(o.t==="err")return o;const c=Math.trunc(e.v),i=n.v,f=Math.trunc(o.v);let m=f;if(t.length>=4){const p=v.map(a(t[3]),r);if(p.t==="err")return p;m=Math.trunc(p.v)}if(c<0||i<0||i>1||f<0||m<f||m>c)return{t:"err",v:"#VALUE!"};let l=0;for(let p=f;p<=m;p++)l+=ei(c,p,i);return{t:"num",v:l}}function ei(u,a,r){let s=0;for(let t=0;t<a;t++)s+=Math.log(u-t)-Math.log(t+1);return Math.exp(s+a*Math.log(r)+(u-a)*Math.log(1-r))}function zt(u){return{syntaxError:(a,r,s,t,e)=>{u.push({message:e,line:s,charPositionInLine:t})}}}function bt(u){const a=K.CharStreams.fromString(u.slice(1)),r=new J(a),s=new K.CommonTokenStream(r),t=new G(s),e=[];r.removeErrorListeners(),t.removeErrorListeners(),r.addErrorListener(zt(e)),t.addErrorListener(zt(e));try{return{tree:t.expr(),syntaxErrors:e,parser:t}}catch{return}}function Tt(u){return u.syntaxErrors.length>0||u.parser.numberOfSyntaxErrors>0}function ri(u){return u.length>0&&u.every(a=>a.message.includes("missing ')' at '<EOF>'"))}function ni(u){const a=K.CharStreams.fromString(u.slice(1)),r=new J(a),s=new K.CommonTokenStream(r);r.removeErrorListeners(),s.fill();let t=0;for(const e of s.getTokens()){if(e.type===J.T__0){t+=1;continue}e.type===J.T__1&&t>0&&(t-=1)}return t}function mi(u){if(!u.startsWith("="))return u;const a=bt(u);if(!a||!Tt(a)||!ri(a.syntaxErrors))return u;const r=ni(u);if(r<=0)return u;const s=u+")".repeat(r),t=bt(s);return!t||Tt(t)?u:s}function li(u){const a=K.CharStreams.fromString(u.slice(1)),r=new J(a),s=new K.CommonTokenStream(r);r.removeErrorListeners(),s.fill();const t=new Set;for(const e of s.getTokens())e.type===G.REFERENCE&&t.add(e.text.toUpperCase());return t}function Dt(u){const a=K.CharStreams.fromString(u.slice(1)),r=new J(a),s=new K.CommonTokenStream(r);r.removeErrorListeners(),s.fill();const t=[];for(const o of s.getTokens())o.type!=J.EOF&&t.push({type:r.vocabulary.getSymbolicName(o.type)||"STRING",start:o.startIndex,stop:o.stopIndex,text:o.text});const e=[];let n;for(const o of t)!n&&o.start>0?e.push({type:"STRING",start:0,stop:o.start-1,text:u.slice(1,o.start+1)}):n&&n.stop+1!==o.start&&e.push({type:"STRING",start:n.stop+1,stop:o.start-1,text:u.slice(n.stop+2,o.start+1)}),e.push(o),n=o;return n&&n.stop+2<u.length&&e.push({type:"STRING",start:n.stop+1,stop:u.length-1,text:u.slice(n.stop+2)}),e}function vi(u){const a=Dt(u),r=[];for(const s of a)if(s.type==="REFERENCE")try{const t=s.text.toUpperCase();if(nt(t))continue;if(t.includes(":"))r.push({text:t,range:tt(t)});else{const e=ct(t);r.push({text:t,range:[e,e]})}}catch{}return r}function pi(u,a){if(!u.startsWith("=")||a<=0)return!1;if(a===1)return!0;const r=Dt(u);for(const o of r){const c=o.start+1,i=o.stop+2;if(o.type==="REFERENCE"&&a>=c&&a<=i)return!0}const t=u.slice(0,a).trimEnd();if(t.length===0)return!1;const e=t[t.length-1];return new Set(["=","(",",","+","-","*","/","<",">",":"]).has(e)}function hi(u,a){if(!u.startsWith("="))return;const r=Dt(u);for(const s of r){if(s.type!=="REFERENCE")continue;const t=s.start+1,e=s.stop+2;if(a>=t&&a<=e)return{start:t,end:e,text:s.text}}}function gi(u,a){var r;try{const s=bt(u);if(!s||Tt(s))return"#ERROR!";const e=new ai(a).visit(s.tree);return e.t==="ref"&&a?F(e.v)?"#VALUE!":((r=a.get(e.v))==null?void 0:r.v)||"":e.v.toString()}catch{return"#ERROR!"}}class ai{constructor(a){rt(this,"grid");this.visit=this.visit.bind(this),this.grid=a}visitChildren(){throw new Error("Method not implemented.")}visitTerminal(){throw new Error("Method not implemented.")}visitErrorNode(){throw new Error("Method not implemented.")}visitFormula(){throw new Error("Method not implemented.")}visitExpr(){throw new Error("Method not implemented.")}visitArgs(){throw new Error("Method not implemented.")}visit(a){return a.accept(this)}visitFunction(a){const r=a.FUNCNAME().text.toUpperCase();if(wt.has(r))return wt.get(r)(a,this.visit,this.grid);throw new Error("Function not implemented.")}visitReference(a){return this.grid?{t:"ref",v:a.text.toUpperCase()}:{t:"err",v:"#REF!"}}visitParentheses(a){return this.visit(a.expr())}visitNumber(a){return{t:"num",v:Number(a.text)}}visitBoolean(a){return{t:"bool",v:a.text==="TRUE"||a.text==="true"}}visitAddSub(a){const r=v.map(this.visit(a.expr(0)),this.grid);if(r.t==="err")return r;const s=v.map(this.visit(a.expr(1)),this.grid);return s.t==="err"?s:a._op.type===G.ADD?{t:"num",v:r.v+s.v}:{t:"num",v:r.v-s.v}}visitMulDiv(a){const r=v.map(this.visit(a.expr(0)),this.grid);if(r.t==="err")return r;const s=v.map(this.visit(a.expr(1)),this.grid);return s.t==="err"?s:a._op.type===G.MUL?{t:"num",v:r.v*s.v}:{t:"num",v:r.v/s.v}}visitComparison(a){const r=v.map(this.visit(a.expr(0)),this.grid);if(r.t==="err")return r;const s=v.map(this.visit(a.expr(1)),this.grid);if(s.t==="err")return s;switch(a._op.type){case G.EQ:return{t:"bool",v:r.v===s.v};case G.NEQ:return{t:"bool",v:r.v!==s.v};case G.LT:return{t:"bool",v:r.v<s.v};case G.GT:return{t:"bool",v:r.v>s.v};case G.LTE:return{t:"bool",v:r.v<=s.v};case G.GTE:return{t:"bool",v:r.v>=s.v};default:return{t:"err",v:"#ERROR!"}}}visitStr(a){return{t:"str",v:a.text.slice(1,-1)}}}const ie=["Date","Engineering","Filter","Financial","Info","Logical","Lookup","Math","Operator","Statistical","Text","Database","Parser","Array","Web"],si=[{name:"SUM",description:"Returns the sum of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"ABS",description:"Returns the absolute value of a number",args:[{name:"number"}]},{name:"ROUND",description:"Rounds a number to a certain number of decimal places",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDUP",description:"Rounds a number away from zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDDOWN",description:"Rounds a number toward zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"INT",description:"Rounds a number down to the nearest integer",args:[{name:"value"}]},{name:"MOD",description:"Returns the remainder after division",args:[{name:"dividend"},{name:"divisor"}]},{name:"SQRT",description:"Returns the positive square root of a number",args:[{name:"value"}]},{name:"POWER",description:"Returns a number raised to a power",args:[{name:"base"},{name:"exponent"}]},{name:"PRODUCT",description:"Multiplies a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MEDIAN",description:"Returns the middle number in a series",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"RAND",description:"Returns a random number between 0 and 1",args:[]},{name:"RANDBETWEEN",description:"Returns a random integer between two values",args:[{name:"low"},{name:"high"}]},{name:"IF",description:"Returns one value if true and another if false",args:[{name:"condition"},{name:"value_if_true"},{name:"value_if_false",optional:!0}]},{name:"IFS",description:"Returns the first value whose condition is true",args:[{name:"condition1"},{name:"value1"},{name:"condition2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0}]},{name:"SWITCH",description:"Matches an expression against case/value pairs",args:[{name:"expression"},{name:"case1"},{name:"value1"},{name:"case2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0},{name:"default",optional:!0}]},{name:"AND",description:"Returns TRUE if all arguments are true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"OR",description:"Returns TRUE if any argument is true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"NOT",description:"Returns the opposite of a logical value",args:[{name:"logical"}]},{name:"AVERAGE",description:"Returns the average of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MIN",description:"Returns the smallest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MAX",description:"Returns the largest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"COUNT",description:"Counts the number of numeric values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTA",description:"Counts the number of non-empty values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTBLANK",description:"Counts empty cells",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTIF",description:"Counts values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"}]},{name:"SUMIF",description:"Sums values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"},{name:"sum_range",optional:!0}]},{name:"COUNTIFS",description:"Counts values that meet multiple criteria",args:[{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"SUMIFS",description:"Sums values that meet multiple criteria",args:[{name:"sum_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"MATCH",description:"Returns the position of an item in a one-dimensional range",args:[{name:"search_key"},{name:"range"},{name:"search_type",optional:!0}]},{name:"INDEX",description:"Returns the value at a given row and column of a range",args:[{name:"reference"},{name:"row",optional:!0},{name:"column",optional:!0}]},{name:"VLOOKUP",description:"Looks up a value in the first column of a range",args:[{name:"search_key"},{name:"range"},{name:"index"},{name:"is_sorted",optional:!0}]},{name:"HLOOKUP",description:"Looks up a value in the first row of a range",args:[{name:"search_key"},{name:"range"},{name:"index"},{name:"is_sorted",optional:!0}]},{name:"TRIM",description:"Removes leading and trailing whitespace from text",args:[{name:"text"}]},{name:"LEN",description:"Returns the number of characters in a text string",args:[{name:"text"}]},{name:"LEFT",description:"Returns the leftmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"RIGHT",description:"Returns the rightmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"MID",description:"Returns characters from the middle of a text string",args:[{name:"text"},{name:"start_num"},{name:"num_chars"}]},{name:"CONCATENATE",description:"Joins two or more text strings into one",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"CONCAT",description:"Joins text values into one string",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"FIND",description:"Finds one text value inside another (case-sensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"SEARCH",description:"Finds one text value inside another (case-insensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"TEXTJOIN",description:"Joins text values with a delimiter",args:[{name:"delimiter"},{name:"ignore_empty"},{name:"text1"},{name:"text2",optional:!0,repeating:!0}]},{name:"LOWER",description:"Converts text to lowercase",args:[{name:"text"}]},{name:"UPPER",description:"Converts text to uppercase",args:[{name:"text"}]},{name:"PROPER",description:"Capitalizes each word in text",args:[{name:"text"}]},{name:"SUBSTITUTE",description:"Replaces existing text with new text in a string",args:[{name:"text"},{name:"search_for"},{name:"replace_with"},{name:"occurrence",optional:!0}]},{name:"TODAY",description:"Returns the current date",args:[]},{name:"NOW",description:"Returns the current date and time",args:[]},{name:"DATE",description:"Returns a date from year, month, and day values",args:[{name:"year"},{name:"month"},{name:"day"}]},{name:"TIME",description:"Returns a time from hour, minute, and second values",args:[{name:"hour"},{name:"minute"},{name:"second"}]},{name:"DAYS",description:"Returns the number of days between two dates",args:[{name:"end_date"},{name:"start_date"}]},{name:"YEAR",description:"Returns the year from a date",args:[{name:"date"}]},{name:"MONTH",description:"Returns the month from a date (1-12)",args:[{name:"date"}]},{name:"DAY",description:"Returns the day of the month from a date (1-31)",args:[{name:"date"}]},{name:"HOUR",description:"Returns the hour from a date/time (0-23)",args:[{name:"time"}]},{name:"MINUTE",description:"Returns the minute from a date/time (0-59)",args:[{name:"time"}]},{name:"SECOND",description:"Returns the second from a date/time (0-59)",args:[{name:"time"}]},{name:"WEEKDAY",description:"Returns day of the week as a number",args:[{name:"date"},{name:"type",optional:!0}]},{name:"ISBLANK",description:"Checks whether a value is blank",args:[{name:"value"}]},{name:"ISNUMBER",description:"Checks whether a value is a number",args:[{name:"value"}]},{name:"ISTEXT",description:"Checks whether a value is text",args:[{name:"value"}]},{name:"ISERROR",description:"Checks whether a value is any error",args:[{name:"value"}]},{name:"ISERR",description:"Checks whether a value is an error except #N/A!",args:[{name:"value"}]},{name:"ISNA",description:"Checks whether a value is the #N/A! error",args:[{name:"value"}]},{name:"ISLOGICAL",description:"Checks whether a value is boolean",args:[{name:"value"}]},{name:"ISNONTEXT",description:"Checks whether a value is not text",args:[{name:"value"}]},{name:"IFERROR",description:"Returns a value if no error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_error"}]},{name:"IFNA",description:"Returns a value if no #N/A! error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_na"}]},{name:"PI",description:"Returns the value of Pi",args:[]},{name:"SIGN",description:"Returns the sign of a number (-1, 0, or 1)",args:[{name:"number"}]},{name:"EVEN",description:"Rounds a number up to the nearest even integer",args:[{name:"number"}]},{name:"ODD",description:"Rounds a number up to the nearest odd integer",args:[{name:"number"}]},{name:"EXP",description:"Returns Euler's number raised to a power",args:[{name:"exponent"}]},{name:"LN",description:"Returns the natural logarithm of a number",args:[{name:"number"}]},{name:"LOG",description:"Returns the logarithm of a number given a base",args:[{name:"number"},{name:"base",optional:!0}]},{name:"SIN",description:"Returns the sine of an angle in radians",args:[{name:"angle"}]},{name:"COS",description:"Returns the cosine of an angle in radians",args:[{name:"angle"}]},{name:"TAN",description:"Returns the tangent of an angle in radians",args:[{name:"angle"}]},{name:"ASIN",description:"Returns the inverse sine of a value in radians",args:[{name:"value"}]},{name:"ACOS",description:"Returns the inverse cosine of a value in radians",args:[{name:"value"}]},{name:"ATAN",description:"Returns the inverse tangent of a value in radians",args:[{name:"value"}]},{name:"ATAN2",description:"Returns the angle between the x-axis and a point",args:[{name:"x"},{name:"y"}]},{name:"DEGREES",description:"Converts an angle from radians to degrees",args:[{name:"angle"}]},{name:"RADIANS",description:"Converts an angle from degrees to radians",args:[{name:"angle"}]},{name:"CEILING",description:"Rounds a number up to the nearest multiple of significance",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"FLOOR",description:"Rounds a number down to the nearest multiple of significance",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"TRUNC",description:"Truncates a number to a given number of decimal places",args:[{name:"number"},{name:"places",optional:!0}]},{name:"MROUND",description:"Rounds a number to the nearest specified multiple",args:[{name:"number"},{name:"multiple"}]},{name:"EXACT",description:"Tests whether two strings are identical (case-sensitive)",args:[{name:"text1"},{name:"text2"}]},{name:"REPLACE",description:"Replaces part of a text string with a different text string",args:[{name:"old_text"},{name:"start_num"},{name:"num_chars"},{name:"new_text"}]},{name:"REPT",description:"Repeats text a given number of times",args:[{name:"text"},{name:"number_times"}]},{name:"T",description:"Returns the text referred to by value",args:[{name:"value"}]},{name:"VALUE",description:"Converts a text string that represents a number to a number",args:[{name:"text"}]},{name:"TEXT",description:"Formats a number and converts it to text",args:[{name:"number"},{name:"format"}]},{name:"CHAR",description:"Returns the character specified by the code number",args:[{name:"number"}]},{name:"CODE",description:"Returns a numeric code for the first character in a text string",args:[{name:"text"}]},{name:"AVERAGEIF",description:"Returns the average of a range that meets a criterion",args:[{name:"criteria_range"},{name:"criterion"},{name:"average_range",optional:!0}]},{name:"AVERAGEIFS",description:"Returns the average of a range that meets multiple criteria",args:[{name:"average_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"LARGE",description:"Returns the nth largest value in a data set",args:[{name:"data"},{name:"n"}]},{name:"SMALL",description:"Returns the nth smallest value in a data set",args:[{name:"data"},{name:"n"}]},{name:"N",description:"Converts a value to a number",args:[{name:"value"}]},{name:"SUMPRODUCT",description:"Multiplies corresponding components and returns the sum",args:[{name:"array1"},{name:"array2",optional:!0,repeating:!0}]},{name:"GCD",description:"Returns the greatest common divisor",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"LCM",description:"Returns the least common multiple",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"COMBIN",description:"Returns the number of combinations for a given number of items",args:[{name:"n"},{name:"k"}]},{name:"FACT",description:"Returns the factorial of a number",args:[{name:"number"}]},{name:"QUOTIENT",description:"Returns the integer portion of a division",args:[{name:"numerator"},{name:"denominator"}]},{name:"XOR",description:"Returns TRUE if an odd number of arguments are TRUE",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"CHOOSE",description:"Returns a value from a list based on index",args:[{name:"index"},{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"TYPE",description:"Returns a number indicating the data type of a value",args:[{name:"value"}]},{name:"EDATE",description:"Returns a date a specified number of months before or after another date",args:[{name:"start_date"},{name:"months"}]},{name:"EOMONTH",description:"Returns the last day of the month a specified number of months away",args:[{name:"start_date"},{name:"months"}]},{name:"NETWORKDAYS",description:"Returns the number of net working days between two dates",args:[{name:"start_date"},{name:"end_date"},{name:"holidays",optional:!0}]},{name:"DATEVALUE",description:"Converts a date string to a date value",args:[{name:"date_string"}]},{name:"TIMEVALUE",description:"Returns the fraction of the day a time represents",args:[{name:"time_string"}]},{name:"DATEDIF",description:"Calculates the number of days, months, or years between two dates",args:[{name:"start_date"},{name:"end_date"},{name:"unit"}]},{name:"ROW",description:"Returns the row number of a reference",args:[{name:"reference",optional:!0}]},{name:"COLUMN",description:"Returns the column number of a reference",args:[{name:"reference",optional:!0}]},{name:"ROWS",description:"Returns the number of rows in a range",args:[{name:"range"}]},{name:"COLUMNS",description:"Returns the number of columns in a range",args:[{name:"range"}]},{name:"ADDRESS",description:"Returns a cell reference as text given row and column numbers",args:[{name:"row"},{name:"column"},{name:"abs_num",optional:!0},{name:"a1",optional:!0}]},{name:"HYPERLINK",description:"Creates a hyperlink in a cell",args:[{name:"url"},{name:"link_label",optional:!0}]},{name:"MINIFS",description:"Returns the minimum value in a range that meets multiple criteria",args:[{name:"min_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"MAXIFS",description:"Returns the maximum value in a range that meets multiple criteria",args:[{name:"max_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"RANK",description:"Returns the rank of a value within a data set",args:[{name:"value"},{name:"data"},{name:"order",optional:!0}]},{name:"PERCENTILE",description:"Returns the k-th percentile of a data set",args:[{name:"data"},{name:"k"}]},{name:"CLEAN",description:"Removes all non-printable characters from text",args:[{name:"text"}]},{name:"NUMBERVALUE",description:"Converts text to a number in a locale-independent way",args:[{name:"text"},{name:"decimal_separator",optional:!0},{name:"group_separator",optional:!0}]},{name:"STDEV",description:"Returns the sample standard deviation",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"STDEVP",description:"Returns the population standard deviation",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"VAR",description:"Returns the sample variance",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"VARP",description:"Returns the population variance",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MODE",description:"Returns the most frequently occurring value",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"SUMSQ",description:"Returns the sum of the squares of the arguments",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"NA",description:"Returns the #N/A! error value",args:[]},{name:"QUARTILE",description:"Returns the quartile of a data set",args:[{name:"data"},{name:"quart"}]},{name:"COUNTUNIQUE",description:"Counts the number of unique values in a list",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"FIXED",description:"Formats a number with a fixed number of decimal places",args:[{name:"number"},{name:"decimals",optional:!0},{name:"no_commas",optional:!0}]},{name:"DOLLAR",description:"Formats a number as currency with a dollar sign",args:[{name:"number"},{name:"decimals",optional:!0}]},{name:"WEEKNUM",description:"Returns the week number of the year",args:[{name:"date"},{name:"type",optional:!0}]},{name:"ISOWEEKNUM",description:"Returns the ISO week number of the year",args:[{name:"date"}]},{name:"WORKDAY",description:"Returns a date that is a specified number of working days away",args:[{name:"start_date"},{name:"days"},{name:"holidays",optional:!0}]},{name:"YEARFRAC",description:"Returns the fraction of the year between two dates",args:[{name:"start_date"},{name:"end_date"},{name:"basis",optional:!0}]},{name:"LOOKUP",description:"Searches a sorted range for a key",args:[{name:"search_key"},{name:"search_range"},{name:"result_range",optional:!0}]},{name:"INDIRECT",description:"Returns the reference specified by a text string",args:[{name:"cell_reference"},{name:"is_A1_notation",optional:!0}]},{name:"ERROR.TYPE",description:"Returns a number corresponding to the error type",args:[{name:"value"}]},{name:"ISDATE",description:"Checks whether a value is a date",args:[{name:"value"}]},{name:"SPLIT",description:"Splits text around a delimiter",args:[{name:"text"},{name:"delimiter"},{name:"split_by_each",optional:!0},{name:"remove_empty",optional:!0}]},{name:"JOIN",description:"Joins values with a delimiter",args:[{name:"delimiter"},{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"REGEXMATCH",description:"Returns whether text matches a regular expression",args:[{name:"text"},{name:"regular_expression"}]},{name:"FORECAST",description:"Predicts a y-value for a given x using linear regression",args:[{name:"x"},{name:"known_ys"},{name:"known_xs"}]},{name:"SLOPE",description:"Returns the slope of the linear regression line",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"INTERCEPT",description:"Returns the y-intercept of the linear regression line",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"CORREL",description:"Returns the Pearson correlation coefficient",args:[{name:"data_y"},{name:"data_x"}]},{name:"XLOOKUP",description:"Searches a range for a match and returns a corresponding item",args:[{name:"search_key"},{name:"lookup_range"},{name:"return_range"},{name:"if_not_found",optional:!0},{name:"match_mode",optional:!0},{name:"search_mode",optional:!0}]},{name:"OFFSET",description:"Returns a reference offset from a starting reference",args:[{name:"reference"},{name:"rows"},{name:"cols"},{name:"height",optional:!0},{name:"width",optional:!0}]},{name:"ISEVEN",description:"Checks whether a number is even",args:[{name:"number"}]},{name:"ISODD",description:"Checks whether a number is odd",args:[{name:"number"}]},{name:"FACTDOUBLE",description:"Returns the double factorial of a number",args:[{name:"number"}]},{name:"BASE",description:"Converts a number to text in another base",args:[{name:"number"},{name:"base"},{name:"min_length",optional:!0}]},{name:"DECIMAL",description:"Converts text from another base to a decimal number",args:[{name:"text"},{name:"base"}]},{name:"SQRTPI",description:"Returns the square root of number * PI",args:[{name:"number"}]},{name:"SINH",description:"Returns the hyperbolic sine of a number",args:[{name:"number"}]},{name:"COSH",description:"Returns the hyperbolic cosine of a number",args:[{name:"number"}]},{name:"TANH",description:"Returns the hyperbolic tangent of a number",args:[{name:"number"}]},{name:"ASINH",description:"Returns the inverse hyperbolic sine of a number",args:[{name:"number"}]},{name:"ACOSH",description:"Returns the inverse hyperbolic cosine of a number",args:[{name:"number"}]},{name:"ATANH",description:"Returns the inverse hyperbolic tangent of a number",args:[{name:"number"}]},{name:"COT",description:"Returns the cotangent of an angle in radians",args:[{name:"angle"}]},{name:"CSC",description:"Returns the cosecant of an angle in radians",args:[{name:"angle"}]},{name:"SEC",description:"Returns the secant of an angle in radians",args:[{name:"angle"}]},{name:"REGEXEXTRACT",description:"Extracts matching substrings using a regular expression",args:[{name:"text"},{name:"regular_expression"}]},{name:"REGEXREPLACE",description:"Replaces text matching a regular expression",args:[{name:"text"},{name:"regular_expression"},{name:"replacement"}]},{name:"UNICODE",description:"Returns the Unicode code point of the first character",args:[{name:"text"}]},{name:"UNICHAR",description:"Returns the Unicode character for a code point",args:[{name:"number"}]},{name:"GEOMEAN",description:"Returns the geometric mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"HARMEAN",description:"Returns the harmonic mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"AVEDEV",description:"Returns the average absolute deviation from the mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"DEVSQ",description:"Returns the sum of squared deviations from the mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"TRIMMEAN",description:"Returns the mean of the interior portion of a data set",args:[{name:"data"},{name:"percent"}]},{name:"PERMUT",description:"Returns the number of permutations for a given number of objects",args:[{name:"n"},{name:"k"}]},{name:"PMT",description:"Returns the periodic payment for an annuity",args:[{name:"rate"},{name:"nper"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"FV",description:"Returns the future value of an investment",args:[{name:"rate"},{name:"nper"},{name:"pmt"},{name:"pv",optional:!0},{name:"type",optional:!0}]},{name:"PV",description:"Returns the present value of an investment",args:[{name:"rate"},{name:"nper"},{name:"pmt"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"NPV",description:"Returns the net present value of an investment",args:[{name:"rate"},{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"NPER",description:"Returns the number of periods for an investment",args:[{name:"rate"},{name:"pmt"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"IPMT",description:"Returns the interest portion of a payment",args:[{name:"rate"},{name:"period"},{name:"nper"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"PPMT",description:"Returns the principal portion of a payment",args:[{name:"rate"},{name:"period"},{name:"nper"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"SLN",description:"Returns the straight-line depreciation of an asset",args:[{name:"cost"},{name:"salvage"},{name:"life"}]},{name:"EFFECT",description:"Returns the effective annual interest rate",args:[{name:"nominal_rate"},{name:"periods_per_year"}]},{name:"RATE",description:"Returns the interest rate per period of an annuity",args:[{name:"nper"},{name:"pmt"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0},{name:"guess",optional:!0}]},{name:"IRR",description:"Returns the internal rate of return for a series of cash flows",args:[{name:"values"},{name:"guess",optional:!0}]},{name:"DB",description:"Returns the depreciation using the fixed-declining balance method",args:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"month",optional:!0}]},{name:"DDB",description:"Returns the depreciation using the double-declining balance method",args:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"factor",optional:!0}]},{name:"NOMINAL",description:"Returns the nominal annual interest rate",args:[{name:"effective_rate"},{name:"periods_per_year"}]},{name:"CUMIPMT",description:"Returns the cumulative interest paid between two periods",args:[{name:"rate"},{name:"nper"},{name:"pv"},{name:"start_period"},{name:"end_period"},{name:"type"}]},{name:"CUMPRINC",description:"Returns the cumulative principal paid between two periods",args:[{name:"rate"},{name:"nper"},{name:"pv"},{name:"start_period"},{name:"end_period"},{name:"type"}]},{name:"AVERAGEA",description:"Returns the average, including text as 0 and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"MINA",description:"Returns the minimum value, including text as 0 and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"MAXA",description:"Returns the maximum value, including text as 0 and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"FISHER",description:"Returns the Fisher transformation",args:[{name:"x"}]},{name:"FISHERINV",description:"Returns the inverse Fisher transformation",args:[{name:"y"}]},{name:"GAMMA",description:"Returns the gamma function value",args:[{name:"number"}]},{name:"GAMMALN",description:"Returns the natural log of the gamma function",args:[{name:"number"}]},{name:"NORMDIST",description:"Returns the normal distribution",args:[{name:"x"},{name:"mean"},{name:"stdev"},{name:"cumulative"}]},{name:"NORMINV",description:"Returns the inverse of the normal distribution",args:[{name:"probability"},{name:"mean"},{name:"stdev"}]},{name:"LOGNORMAL.DIST",description:"Returns the lognormal distribution",args:[{name:"x"},{name:"mean"},{name:"stdev"},{name:"cumulative"}]},{name:"LOGNORMAL.INV",description:"Returns the inverse of the lognormal distribution",args:[{name:"probability"},{name:"mean"},{name:"stdev"}]},{name:"STANDARDIZE",description:"Returns a normalized value (z-score)",args:[{name:"x"},{name:"mean"},{name:"stdev"}]},{name:"WEIBULL.DIST",description:"Returns the Weibull distribution",args:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"}]},{name:"POISSON.DIST",description:"Returns the Poisson distribution",args:[{name:"x"},{name:"mean"},{name:"cumulative"}]},{name:"BINOM.DIST",description:"Returns the binomial distribution probability",args:[{name:"successes"},{name:"trials"},{name:"probability"},{name:"cumulative"}]},{name:"EXPON.DIST",description:"Returns the exponential distribution",args:[{name:"x"},{name:"lambda"},{name:"cumulative"}]},{name:"CONFIDENCE.NORM",description:"Returns the confidence interval using normal distribution",args:[{name:"alpha"},{name:"stdev"},{name:"size"}]},{name:"CONFIDENCE.T",description:"Returns the confidence interval using t-distribution",args:[{name:"alpha"},{name:"stdev"},{name:"size"}]},{name:"CHISQ.DIST",description:"Returns the chi-squared distribution",args:[{name:"x"},{name:"degrees_freedom"},{name:"cumulative"}]},{name:"CHISQ.INV",description:"Returns the inverse of the chi-squared distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"T.DIST",description:"Returns the Student t-distribution",args:[{name:"x"},{name:"degrees_freedom"},{name:"cumulative"}]},{name:"T.INV",description:"Returns the inverse of the Student t-distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"HYPGEOM.DIST",description:"Returns the hypergeometric distribution",args:[{name:"sample_s"},{name:"number_sample"},{name:"population_s"},{name:"number_pop"},{name:"cumulative"}]},{name:"NEGBINOM.DIST",description:"Returns the negative binomial distribution",args:[{name:"failures"},{name:"successes"},{name:"probability"},{name:"cumulative"}]},{name:"ARABIC",description:"Converts a Roman numeral to a number",args:[{name:"roman_numeral"}]},{name:"ROMAN",description:"Converts a number to Roman numeral text",args:[{name:"number"},{name:"form",optional:!0}]},{name:"MULTINOMIAL",description:"Returns the multinomial coefficient",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"SERIESSUM",description:"Returns the sum of a power series",args:[{name:"x"},{name:"n"},{name:"m"},{name:"coefficients"}]},{name:"DELTA",description:"Tests whether two values are equal",args:[{name:"number1"},{name:"number2",optional:!0}]},{name:"GESTEP",description:"Tests whether a number is greater than or equal to a step value",args:[{name:"number"},{name:"step",optional:!0}]},{name:"ERF",description:"Returns the error function",args:[{name:"lower_limit"},{name:"upper_limit",optional:!0}]},{name:"ERFC",description:"Returns the complementary error function",args:[{name:"x"}]},{name:"XNPV",description:"Returns net present value for irregular cash flows",args:[{name:"rate"},{name:"values"},{name:"dates"}]},{name:"XIRR",description:"Returns internal rate of return for irregular cash flows",args:[{name:"values"},{name:"dates"},{name:"guess",optional:!0}]},{name:"SYD",description:"Returns the sum-of-years-digits depreciation",args:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"}]},{name:"MIRR",description:"Returns the modified internal rate of return",args:[{name:"values"},{name:"finance_rate"},{name:"reinvest_rate"}]},{name:"TBILLEQ",description:"Returns the bond-equivalent yield for a T-bill",args:[{name:"settlement"},{name:"maturity"},{name:"discount"}]},{name:"TBILLPRICE",description:"Returns the price per $100 for a T-bill",args:[{name:"settlement"},{name:"maturity"},{name:"discount"}]},{name:"TBILLYIELD",description:"Returns the yield for a T-bill",args:[{name:"settlement"},{name:"maturity"},{name:"price"}]},{name:"DOLLARDE",description:"Converts a fractional dollar price to a decimal price",args:[{name:"fractional_dollar"},{name:"fraction"}]},{name:"DOLLARFR",description:"Converts a decimal dollar price to a fractional price",args:[{name:"decimal_dollar"},{name:"fraction"}]},{name:"ENCODEURL",description:"Encodes a string for use in a URL",args:[{name:"text"}]},{name:"ISURL",description:"Returns TRUE if a value is a valid URL",args:[{name:"value"}]},{name:"ISFORMULA",description:"Returns TRUE if a cell contains a formula",args:[{name:"cell"}]},{name:"FORMULATEXT",description:"Returns the formula of a cell as a string",args:[{name:"cell"}]},{name:"CEILING.MATH",description:"Rounds a number up to the nearest integer or multiple of significance",args:[{name:"number"},{name:"significance",optional:!0},{name:"mode",optional:!0}]},{name:"FLOOR.MATH",description:"Rounds a number down to the nearest integer or multiple of significance",args:[{name:"number"},{name:"significance",optional:!0},{name:"mode",optional:!0}]},{name:"CEILING.PRECISE",description:"Rounds a number up to the nearest multiple of significance, ignoring sign",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"FLOOR.PRECISE",description:"Rounds a number down to the nearest multiple of significance, ignoring sign",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"COVAR",description:"Returns the population covariance of two datasets",args:[{name:"data_y"},{name:"data_x"}]},{name:"COVARIANCE.S",description:"Returns the sample covariance of two datasets",args:[{name:"data_y"},{name:"data_x"}]},{name:"RSQ",description:"Returns the R-squared value of a linear regression",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"STEYX",description:"Returns the standard error of the predicted y-value in a regression",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"SUMX2MY2",description:"Returns the sum of differences of squares of corresponding values",args:[{name:"array_x"},{name:"array_y"}]},{name:"SUMX2PY2",description:"Returns the sum of sums of squares of corresponding values",args:[{name:"array_x"},{name:"array_y"}]},{name:"SUMXMY2",description:"Returns the sum of squares of differences of corresponding values",args:[{name:"array_x"},{name:"array_y"}]},{name:"PERCENTILE.EXC",description:"Returns the k-th percentile of values using exclusive interpolation",args:[{name:"data"},{name:"k"}]},{name:"QUARTILE.EXC",description:"Returns the exclusive quartile of a dataset",args:[{name:"data"},{name:"quart"}]},{name:"RANK.AVG",description:"Returns the rank of a value with average ranking for ties",args:[{name:"value"},{name:"data"},{name:"is_ascending",optional:!0}]},{name:"PERCENTRANK",description:"Returns the percentage rank of a value in a dataset (inclusive)",args:[{name:"data"},{name:"x"},{name:"significance",optional:!0}]},{name:"PERCENTRANK.EXC",description:"Returns the percentage rank of a value in a dataset (exclusive)",args:[{name:"data"},{name:"x"},{name:"significance",optional:!0}]},{name:"BETA.DIST",description:"Returns the beta distribution probability",args:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"},{name:"A",optional:!0},{name:"B",optional:!0}]},{name:"BETA.INV",description:"Returns the inverse of the beta cumulative distribution",args:[{name:"probability"},{name:"alpha"},{name:"beta"},{name:"A",optional:!0},{name:"B",optional:!0}]},{name:"F.DIST",description:"Returns the F probability distribution",args:[{name:"x"},{name:"deg_freedom1"},{name:"deg_freedom2"},{name:"cumulative"}]},{name:"F.INV",description:"Returns the inverse of the F probability distribution",args:[{name:"probability"},{name:"deg_freedom1"},{name:"deg_freedom2"}]},{name:"GAMMA.DIST",description:"Returns the gamma distribution probability",args:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"}]},{name:"GAMMA.INV",description:"Returns the inverse of the gamma cumulative distribution",args:[{name:"probability"},{name:"alpha"},{name:"beta"}]},{name:"CHISQ.DIST.RT",description:"Returns the right-tailed chi-squared distribution probability",args:[{name:"x"},{name:"degrees_freedom"}]},{name:"CHISQ.INV.RT",description:"Returns the inverse right-tailed chi-squared distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"T.DIST.RT",description:"Returns the right-tailed Student t-distribution",args:[{name:"x"},{name:"degrees_freedom"}]},{name:"T.DIST.2T",description:"Returns the two-tailed Student t-distribution",args:[{name:"x"},{name:"degrees_freedom"}]},{name:"T.INV.2T",description:"Returns the inverse two-tailed Student t-distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"F.DIST.RT",description:"Returns the right-tailed F probability distribution",args:[{name:"x"},{name:"deg_freedom1"},{name:"deg_freedom2"}]},{name:"F.INV.RT",description:"Returns the inverse right-tailed F probability distribution",args:[{name:"probability"},{name:"deg_freedom1"},{name:"deg_freedom2"}]},{name:"BINOM.INV",description:"Returns the smallest value for which the cumulative binomial distribution is >= alpha",args:[{name:"trials"},{name:"probability_s"},{name:"alpha"}]},{name:"TEXTBEFORE",description:"Returns text before a specified delimiter",args:[{name:"text"},{name:"delimiter"},{name:"instance_num",optional:!0}]},{name:"TEXTAFTER",description:"Returns text after a specified delimiter",args:[{name:"text"},{name:"delimiter"},{name:"instance_num",optional:!0}]},{name:"VALUETOTEXT",description:"Converts a value to text",args:[{name:"value"},{name:"format",optional:!0}]},{name:"SEQUENCE",description:"Generates a sequence of numbers",args:[{name:"rows"},{name:"columns",optional:!0},{name:"start",optional:!0},{name:"step",optional:!0}]},{name:"RANDARRAY",description:"Generates an array of random numbers",args:[{name:"rows",optional:!0},{name:"columns",optional:!0},{name:"min",optional:!0},{name:"max",optional:!0},{name:"whole_number",optional:!0}]},{name:"SORT",description:"Sorts a range of data",args:[{name:"range"},{name:"sort_index",optional:!0},{name:"sort_order",optional:!0}]},{name:"UNIQUE",description:"Returns unique values from a range",args:[{name:"range"}]},{name:"FLATTEN",description:"Flattens a range into a single column",args:[{name:"range"}]},{name:"TRANSPOSE",description:"Transposes the rows and columns of a range",args:[{name:"range"}]},{name:"NORM.S.DIST",description:"Returns the standard normal distribution probability",args:[{name:"z"},{name:"cumulative"}]},{name:"NORM.S.INV",description:"Returns the inverse of the standard normal distribution",args:[{name:"probability"}]},{name:"SUBTOTAL",description:"Returns a subtotal using a specified aggregate function",args:[{name:"function_num"},{name:"ref1"},{name:"ref2",optional:!0,repeating:!0}]},{name:"VARA",description:"Returns the sample variance including text and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"VARPA",description:"Returns the population variance including text and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"SKEW",description:"Returns the skewness of a dataset",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"KURT",description:"Returns the excess kurtosis of a dataset",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"ISREF",description:"Returns TRUE if the value is a reference",args:[{name:"value"}]},{name:"SHEET",description:"Returns the sheet number of a reference",args:[{name:"value",optional:!0}]},{name:"SHEETS",description:"Returns the number of sheets in a reference",args:[{name:"reference",optional:!0}]},{name:"MDETERM",description:"Returns the determinant of a square matrix",args:[{name:"square_matrix"}]},{name:"PROB",description:"Returns the probability of values in a range between two limits",args:[{name:"x_range"},{name:"prob_range"},{name:"lower_limit"},{name:"upper_limit",optional:!0}]},{name:"CONVERT",description:"Converts a number from one measurement unit to another",args:[{name:"number"},{name:"from_unit"},{name:"to_unit"}]},{name:"BITAND",description:"Returns the bitwise AND of two numbers",args:[{name:"number1"},{name:"number2"}]},{name:"BITOR",description:"Returns the bitwise OR of two numbers",args:[{name:"number1"},{name:"number2"}]},{name:"BITXOR",description:"Returns the bitwise XOR of two numbers",args:[{name:"number1"},{name:"number2"}]},{name:"BITLSHIFT",description:"Shifts a number left by a specified number of bits",args:[{name:"number"},{name:"shift_amount"}]},{name:"BITRSHIFT",description:"Shifts a number right by a specified number of bits",args:[{name:"number"},{name:"shift_amount"}]},{name:"HEX2DEC",description:"Converts a hexadecimal number to decimal",args:[{name:"hex_string"}]},{name:"DEC2HEX",description:"Converts a decimal number to hexadecimal",args:[{name:"number"},{name:"places",optional:!0}]},{name:"BIN2DEC",description:"Converts a binary number to decimal",args:[{name:"bin_string"}]},{name:"DEC2BIN",description:"Converts a decimal number to binary",args:[{name:"number"},{name:"places",optional:!0}]},{name:"OCT2DEC",description:"Converts an octal number to decimal",args:[{name:"oct_string"}]},{name:"DEC2OCT",description:"Converts a decimal number to octal",args:[{name:"number"},{name:"places",optional:!0}]},{name:"COMPLEX",description:"Creates a complex number from real and imaginary parts",args:[{name:"real"},{name:"imaginary"},{name:"suffix",optional:!0}]},{name:"IMREAL",description:"Returns the real part of a complex number",args:[{name:"complex_number"}]},{name:"IMAGINARY",description:"Returns the imaginary part of a complex number",args:[{name:"complex_number"}]},{name:"IMABS",description:"Returns the absolute value (modulus) of a complex number",args:[{name:"complex_number"}]},{name:"IMSUM",description:"Returns the sum of complex numbers",args:[{name:"complex1"},{name:"complex2",optional:!0,repeating:!0}]},{name:"IMSUB",description:"Returns the difference of two complex numbers",args:[{name:"complex1"},{name:"complex2"}]},{name:"IMPRODUCT",description:"Returns the product of complex numbers",args:[{name:"complex1"},{name:"complex2",optional:!0,repeating:!0}]},{name:"IMDIV",description:"Returns the quotient of two complex numbers",args:[{name:"complex1"},{name:"complex2"}]},{name:"IMCONJUGATE",description:"Returns the complex conjugate of a complex number",args:[{name:"complex_number"}]},{name:"IMARGUMENT",description:"Returns the argument (angle) of a complex number in radians",args:[{name:"complex_number"}]},{name:"IMPOWER",description:"Returns a complex number raised to a power",args:[{name:"complex_number"},{name:"power"}]},{name:"IMSQRT",description:"Returns the square root of a complex number",args:[{name:"complex_number"}]},{name:"IMEXP",description:"Returns e raised to a complex power",args:[{name:"complex_number"}]},{name:"IMLN",description:"Returns the natural logarithm of a complex number",args:[{name:"complex_number"}]},{name:"IMLOG2",description:"Returns the base-2 logarithm of a complex number",args:[{name:"complex_number"}]},{name:"IMLOG10",description:"Returns the base-10 logarithm of a complex number",args:[{name:"complex_number"}]},{name:"IMSIN",description:"Returns the sine of a complex number",args:[{name:"complex_number"}]},{name:"IMCOS",description:"Returns the cosine of a complex number",args:[{name:"complex_number"}]},{name:"IMTAN",description:"Returns the tangent of a complex number",args:[{name:"complex_number"}]},{name:"IMSINH",description:"Returns the hyperbolic sine of a complex number",args:[{name:"complex_number"}]},{name:"IMCOSH",description:"Returns the hyperbolic cosine of a complex number",args:[{name:"complex_number"}]},{name:"IMSEC",description:"Returns the secant of a complex number",args:[{name:"complex_number"}]},{name:"IMCSC",description:"Returns the cosecant of a complex number",args:[{name:"complex_number"}]},{name:"IMCOT",description:"Returns the cotangent of a complex number",args:[{name:"complex_number"}]},{name:"HEX2BIN",description:"Converts a hexadecimal number to binary",args:[{name:"hex_string"},{name:"places",optional:!0}]},{name:"HEX2OCT",description:"Converts a hexadecimal number to octal",args:[{name:"hex_string"},{name:"places",optional:!0}]},{name:"BIN2HEX",description:"Converts a binary number to hexadecimal",args:[{name:"bin_string"},{name:"places",optional:!0}]},{name:"BIN2OCT",description:"Converts a binary number to octal",args:[{name:"bin_string"},{name:"places",optional:!0}]},{name:"OCT2HEX",description:"Converts an octal number to hexadecimal",args:[{name:"oct_string"},{name:"places",optional:!0}]},{name:"OCT2BIN",description:"Converts an octal number to binary",args:[{name:"oct_string"},{name:"places",optional:!0}]},{name:"BESSELJ",description:"Returns the Bessel function of the first kind Jn(x)",args:[{name:"x"},{name:"n"}]},{name:"BESSELY",description:"Returns the Bessel function of the second kind Yn(x)",args:[{name:"x"},{name:"n"}]},{name:"BESSELI",description:"Returns the modified Bessel function of the first kind In(x)",args:[{name:"x"},{name:"n"}]},{name:"BESSELK",description:"Returns the modified Bessel function of the second kind Kn(x)",args:[{name:"x"},{name:"n"}]},{name:"ACCRINT",description:"Returns the accrued interest for a security that pays periodic interest",args:[{name:"issue"},{name:"first_interest"},{name:"settlement"},{name:"rate"},{name:"par"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"ACCRINTM",description:"Returns the accrued interest for a security that pays at maturity",args:[{name:"issue"},{name:"settlement"},{name:"rate"},{name:"par"},{name:"basis",optional:!0}]},{name:"COUPDAYBS",description:"Returns the number of days from the coupon period start to settlement",args:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"COUPDAYS",description:"Returns the number of days in the coupon period containing settlement",args:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"COUPDAYSNC",description:"Returns the number of days from settlement to the next coupon date",args:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"COUPNCD",description:"Returns the next coupon date after settlement",args:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"COUPNUM",description:"Returns the number of coupons between settlement and maturity",args:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"COUPPCD",description:"Returns the previous coupon date before settlement",args:[{name:"settlement"},{name:"maturity"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"DISC",description:"Returns the discount rate for a security",args:[{name:"settlement"},{name:"maturity"},{name:"price"},{name:"redemption"},{name:"basis",optional:!0}]},{name:"PRICEDISC",description:"Returns the price of a discounted security",args:[{name:"settlement"},{name:"maturity"},{name:"discount"},{name:"redemption"},{name:"basis",optional:!0}]},{name:"YIELDDISC",description:"Returns the annual yield for a discounted security",args:[{name:"settlement"},{name:"maturity"},{name:"price"},{name:"redemption"},{name:"basis",optional:!0}]},{name:"DURATION",description:"Returns the Macaulay duration of a security",args:[{name:"settlement"},{name:"maturity"},{name:"coupon"},{name:"yield"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"MDURATION",description:"Returns the modified Macaulay duration of a security",args:[{name:"settlement"},{name:"maturity"},{name:"coupon"},{name:"yield"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"RECEIVED",description:"Returns the amount received at maturity for a fully invested security",args:[{name:"settlement"},{name:"maturity"},{name:"investment"},{name:"discount"},{name:"basis",optional:!0}]},{name:"INTRATE",description:"Returns the interest rate for a fully invested security",args:[{name:"settlement"},{name:"maturity"},{name:"investment"},{name:"redemption"},{name:"basis",optional:!0}]},{name:"PRICE",description:"Returns the price per $100 face value of a coupon-paying security",args:[{name:"settlement"},{name:"maturity"},{name:"rate"},{name:"yield"},{name:"redemption"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"YIELD",description:"Returns the yield on a coupon-paying security",args:[{name:"settlement"},{name:"maturity"},{name:"rate"},{name:"price"},{name:"redemption"},{name:"frequency"},{name:"basis",optional:!0}]},{name:"PRICEMAT",description:"Returns the price of a security that pays at maturity",args:[{name:"settlement"},{name:"maturity"},{name:"issue"},{name:"rate"},{name:"yield"},{name:"basis",optional:!0}]},{name:"YIELDMAT",description:"Returns the yield of a security that pays at maturity",args:[{name:"settlement"},{name:"maturity"},{name:"issue"},{name:"rate"},{name:"price"},{name:"basis",optional:!0}]},{name:"AMORLINC",description:"Returns the depreciation for each accounting period (French linear)",args:[{name:"cost"},{name:"purchase_date"},{name:"first_period"},{name:"salvage"},{name:"period"},{name:"rate"},{name:"basis",optional:!0}]},{name:"ISPMT",description:"Returns the interest paid during a specific period of a loan",args:[{name:"rate"},{name:"period"},{name:"nper"},{name:"pv"}]},{name:"FVSCHEDULE",description:"Returns the future value of a principal after applying a schedule of rates",args:[{name:"principal"},{name:"schedule"}]},{name:"PDURATION",description:"Returns the number of periods for an investment to reach a specified value",args:[{name:"rate"},{name:"pv"},{name:"fv"}]},{name:"RRI",description:"Returns the equivalent interest rate for the growth of an investment",args:[{name:"nper"},{name:"pv"},{name:"fv"}]},{name:"DSUM",description:"Sums values in a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DCOUNT",description:"Counts numeric values in a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DCOUNTA",description:"Counts non-empty values in a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DAVERAGE",description:"Averages values in a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DMAX",description:"Returns the maximum value in a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DMIN",description:"Returns the minimum value in a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DPRODUCT",description:"Returns the product of values in a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DGET",description:"Returns a single value from a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DSTDEV",description:"Returns the sample standard deviation of a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DSTDEVP",description:"Returns the population standard deviation of a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DVAR",description:"Returns the sample variance of a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"DVARP",description:"Returns the population variance of a database field matching criteria",args:[{name:"database"},{name:"field"},{name:"criteria"}]},{name:"GROWTH",description:"Calculates predicted exponential growth using existing data",args:[{name:"known_y"},{name:"known_x",optional:!0},{name:"new_x",optional:!0}]},{name:"TREND",description:"Calculates predicted linear trend values using least squares regression",args:[{name:"known_y"},{name:"known_x",optional:!0},{name:"new_x",optional:!0}]},{name:"LINEST",description:"Returns the slope of the linear regression line",args:[{name:"known_y"},{name:"known_x",optional:!0}]},{name:"LOGEST",description:"Returns the growth rate of an exponential regression",args:[{name:"known_y"},{name:"known_x",optional:!0}]},{name:"FREQUENCY",description:"Calculates how often values occur within a range of bins",args:[{name:"data_array"},{name:"bins_array"}]},{name:"MODE.MULT",description:"Returns the most frequently occurring values in a dataset",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"AGGREGATE",description:"Returns an aggregate calculation, ignoring errors and hidden rows",args:[{name:"function_num"},{name:"options"},{name:"ref1"},{name:"ref2",optional:!0,repeating:!0}]},{name:"COMBINA",description:"Returns the number of combinations with repetition",args:[{name:"n"},{name:"k"}]},{name:"PERMUTATIONA",description:"Returns the number of permutations with repetition",args:[{name:"n"},{name:"k"}]},{name:"T.TEST",description:"Returns the probability associated with a Student t-test",args:[{name:"range1"},{name:"range2"},{name:"tails"},{name:"type"}]},{name:"Z.TEST",description:"Returns the one-tailed p-value of a z-test",args:[{name:"range"},{name:"value"},{name:"sigma",optional:!0}]},{name:"AREAS",description:"Returns the number of areas in a reference",args:[{name:"reference"}]},{name:"CELL",description:"Returns information about a cell",args:[{name:"info_type"},{name:"reference",optional:!0}]},{name:"MMULT",description:"Returns the matrix product of two arrays",args:[{name:"array1"},{name:"array2"}]},{name:"MINVERSE",description:"Returns the inverse matrix of a square array",args:[{name:"array"}]},{name:"XMATCH",description:"Returns the relative position of a value in an array",args:[{name:"lookup_value"},{name:"lookup_array"},{name:"match_mode",optional:!0},{name:"search_mode",optional:!0}]},{name:"TOCOL",description:"Transforms an array into a single column",args:[{name:"array"},{name:"ignore",optional:!0},{name:"scan_by_column",optional:!0}]},{name:"TOROW",description:"Transforms an array into a single row",args:[{name:"array"},{name:"ignore",optional:!0},{name:"scan_by_column",optional:!0}]},{name:"TEXTSPLIT",description:"Splits text by delimiter into parts",args:[{name:"text"},{name:"col_delimiter"},{name:"row_delimiter",optional:!0},{name:"ignore_empty",optional:!0}]},{name:"CHOOSEROWS",description:"Returns specified rows from an array",args:[{name:"array"},{name:"row_num1"},{name:"row_num2",optional:!0}]},{name:"CHOOSECOLS",description:"Returns specified columns from an array",args:[{name:"array"},{name:"col_num1"},{name:"col_num2",optional:!0}]},{name:"TAKE",description:"Returns rows or columns from the start or end of an array",args:[{name:"array"},{name:"rows"},{name:"columns",optional:!0}]},{name:"DROP",description:"Removes rows or columns from the start or end of an array",args:[{name:"array"},{name:"rows"},{name:"columns",optional:!0}]},{name:"HSTACK",description:"Appends arrays horizontally",args:[{name:"range1"},{name:"range2",optional:!0}]},{name:"VSTACK",description:"Appends arrays vertically",args:[{name:"range1"},{name:"range2",optional:!0}]},{name:"SORTBY",description:"Sorts a range by another range",args:[{name:"array"},{name:"by_array"},{name:"sort_order",optional:!0}]},{name:"WRAPCOLS",description:"Wraps a row or column of values into columns",args:[{name:"vector"},{name:"wrap_count"},{name:"pad_with",optional:!0}]},{name:"WRAPROWS",description:"Wraps a row or column of values into rows",args:[{name:"vector"},{name:"wrap_count"},{name:"pad_with",optional:!0}]},{name:"GAUSS",description:"Returns the probability between 0 and z standard deviations",args:[{name:"z"}]},{name:"PHI",description:"Returns the value of the standard normal density function",args:[{name:"x"}]},{name:"STDEVA",description:"Standard deviation of a sample, including text and logical values",args:[{name:"value1"},{name:"value2",optional:!0}]},{name:"STDEVPA",description:"Standard deviation of a population, including text and logical values",args:[{name:"value1"},{name:"value2",optional:!0}]},{name:"SKEW.P",description:"Returns the population skewness of a distribution",args:[{name:"number1"},{name:"number2",optional:!0}]},{name:"CHISQ.TEST",description:"Returns the chi-squared test for independence",args:[{name:"actual_range"},{name:"expected_range"}]},{name:"F.TEST",description:"Returns the result of an F-test",args:[{name:"array1"},{name:"array2"}]},{name:"ISO.CEILING",description:"Rounds a number up to the nearest integer or multiple of significance",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"FILTER",description:"Filters an array based on a boolean array",args:[{name:"array"},{name:"include"},{name:"if_empty",optional:!0}]},{name:"SECH",description:"Returns the hyperbolic secant of a number",args:[{name:"number"}]},{name:"CSCH",description:"Returns the hyperbolic cosecant of a number",args:[{name:"number"}]},{name:"COTH",description:"Returns the hyperbolic cotangent of a number",args:[{name:"number"}]},{name:"ACOT",description:"Returns the arccotangent of a number",args:[{name:"number"}]},{name:"ACOTH",description:"Returns the inverse hyperbolic cotangent of a number",args:[{name:"number"}]},{name:"DAYS360",description:"Returns the number of days between two dates using 360-day year",args:[{name:"start_date"},{name:"end_date"},{name:"method",optional:!0}]},{name:"WORKDAY.INTL",description:"Returns a date that is a specified number of workdays with custom weekends",args:[{name:"start_date"},{name:"days"},{name:"weekend",optional:!0},{name:"holidays",optional:!0}]},{name:"NETWORKDAYS.INTL",description:"Returns the number of working days between two dates with custom weekends",args:[{name:"start_date"},{name:"end_date"},{name:"weekend",optional:!0},{name:"holidays",optional:!0}]},{name:"EXPAND",description:"Expands an array to specified dimensions",args:[{name:"array"},{name:"rows"},{name:"columns",optional:!0},{name:"pad_with",optional:!0}]},{name:"MUNIT",description:"Returns the identity matrix of the specified dimension",args:[{name:"dimension"}]},{name:"BINOM.DIST.RANGE",description:"Returns the probability of a trial result using a binomial distribution",args:[{name:"trials"},{name:"probability_s"},{name:"number_s"},{name:"number_s2",optional:!0}]}],oi={Date:new Set(["TODAY","NOW","DATE","TIME","DAYS","YEAR","MONTH","DAY","HOUR","MINUTE","SECOND","WEEKDAY","EDATE","EOMONTH","NETWORKDAYS","DATEVALUE","TIMEVALUE","DATEDIF","WEEKNUM","ISOWEEKNUM","WORKDAY","YEARFRAC","DAYS360","WORKDAY.INTL","NETWORKDAYS.INTL"]),Engineering:new Set(["DELTA","GESTEP","ERF","ERFC","CONVERT","BITAND","BITOR","BITXOR","BITLSHIFT","BITRSHIFT","HEX2DEC","DEC2HEX","BIN2DEC","DEC2BIN","OCT2DEC","DEC2OCT","COMPLEX","IMREAL","IMAGINARY","IMABS","IMSUM","IMSUB","IMPRODUCT","IMDIV","IMCONJUGATE","IMARGUMENT","IMPOWER","IMSQRT","IMEXP","IMLN","IMLOG2","IMLOG10","IMSIN","IMCOS","IMTAN","IMSINH","IMCOSH","IMSEC","IMCSC","IMCOT","HEX2BIN","HEX2OCT","BIN2HEX","BIN2OCT","OCT2HEX","OCT2BIN","BESSELJ","BESSELY","BESSELI","BESSELK"]),Financial:new Set(["PMT","FV","PV","NPV","NPER","IPMT","PPMT","SLN","EFFECT","RATE","IRR","DB","DDB","NOMINAL","CUMIPMT","CUMPRINC","XNPV","XIRR","SYD","MIRR","TBILLEQ","TBILLPRICE","TBILLYIELD","DOLLARDE","DOLLARFR","ACCRINT","ACCRINTM","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPNCD","COUPNUM","COUPPCD","DISC","PRICEDISC","YIELDDISC","DURATION","MDURATION","RECEIVED","INTRATE","PRICE","YIELD","PRICEMAT","YIELDMAT","AMORLINC","ISPMT","FVSCHEDULE","PDURATION","RRI"]),Info:new Set(["ISBLANK","ISNUMBER","ISTEXT","ISERROR","ISERR","ISNA","ISLOGICAL","ISNONTEXT","ISURL","ISFORMULA","FORMULATEXT","ISREF","SHEET","SHEETS","N","TYPE","NA","ERROR.TYPE","ISDATE","AREAS","CELL"]),Logical:new Set(["IF","IFS","SWITCH","AND","OR","NOT","IFERROR","IFNA","XOR","CHOOSE"]),Lookup:new Set(["MATCH","INDEX","VLOOKUP","HLOOKUP","ROW","COLUMN","ROWS","COLUMNS","ADDRESS","HYPERLINK","LOOKUP","INDIRECT","XLOOKUP","OFFSET","SORT","UNIQUE","FLATTEN","TRANSPOSE","XMATCH","TOCOL","TOROW","CHOOSEROWS","CHOOSECOLS","TAKE","DROP","HSTACK","VSTACK","SORTBY","WRAPCOLS","WRAPROWS","FILTER","EXPAND"]),Math:new Set(["SUM","ABS","ROUND","ROUNDUP","ROUNDDOWN","INT","MOD","SQRT","POWER","PRODUCT","RAND","RANDBETWEEN","COUNTBLANK","COUNTIF","SUMIF","COUNTIFS","SUMIFS","PI","SIGN","EVEN","ODD","EXP","LN","LOG","SIN","COS","TAN","ASIN","ACOS","ATAN","ATAN2","DEGREES","RADIANS","CEILING","FLOOR","TRUNC","MROUND","SUMPRODUCT","GCD","LCM","COMBIN","FACT","QUOTIENT","SUMSQ","ISEVEN","ISODD","FACTDOUBLE","BASE","DECIMAL","SQRTPI","SINH","COSH","TANH","ASINH","ACOSH","ATANH","COT","CSC","SEC","ARABIC","ROMAN","MULTINOMIAL","SERIESSUM","CEILING.MATH","FLOOR.MATH","CEILING.PRECISE","FLOOR.PRECISE","SUMX2MY2","SUMX2PY2","SUMXMY2","SEQUENCE","RANDARRAY","SUBTOTAL","MDETERM","COMBINA","MMULT","MINVERSE","ISO.CEILING","SECH","CSCH","COTH","ACOT","ACOTH","MUNIT"]),Statistical:new Set(["AVERAGE","MIN","MAX","COUNT","COUNTA","MEDIAN","AVERAGEIF","AVERAGEIFS","LARGE","SMALL","MINIFS","MAXIFS","RANK","PERCENTILE","STDEV","STDEVP","VAR","VARP","MODE","QUARTILE","COUNTUNIQUE","FORECAST","SLOPE","INTERCEPT","CORREL","GEOMEAN","HARMEAN","AVEDEV","DEVSQ","TRIMMEAN","PERMUT","AVERAGEA","MINA","MAXA","FISHER","FISHERINV","GAMMA","GAMMALN","NORMDIST","NORMINV","LOGNORMAL.DIST","LOGNORMAL.INV","STANDARDIZE","WEIBULL.DIST","POISSON.DIST","BINOM.DIST","EXPON.DIST","CONFIDENCE.NORM","CONFIDENCE.T","CHISQ.DIST","CHISQ.INV","T.DIST","T.INV","HYPGEOM.DIST","NEGBINOM.DIST","COVAR","COVARIANCE.S","RSQ","STEYX","PERCENTILE.EXC","QUARTILE.EXC","RANK.AVG","PERCENTRANK","PERCENTRANK.EXC","BETA.DIST","BETA.INV","F.DIST","F.INV","GAMMA.DIST","GAMMA.INV","CHISQ.DIST.RT","CHISQ.INV.RT","T.DIST.RT","T.DIST.2T","T.INV.2T","F.DIST.RT","F.INV.RT","BINOM.INV","NORM.S.DIST","NORM.S.INV","VARA","VARPA","SKEW","KURT","PROB","GROWTH","TREND","LINEST","LOGEST","FREQUENCY","MODE.MULT","AGGREGATE","T.TEST","Z.TEST","PERMUTATIONA","GAUSS","PHI","STDEVA","STDEVPA","SKEW.P","CHISQ.TEST","F.TEST","BINOM.DIST.RANGE"]),Text:new Set(["TRIM","LEN","LEFT","RIGHT","MID","CONCATENATE","CONCAT","FIND","SEARCH","TEXTJOIN","LOWER","UPPER","PROPER","SUBSTITUTE","EXACT","REPLACE","REPT","T","VALUE","TEXT","CHAR","CODE","CLEAN","NUMBERVALUE","FIXED","DOLLAR","SPLIT","JOIN","REGEXMATCH","REGEXEXTRACT","REGEXREPLACE","UNICODE","UNICHAR","ENCODEURL","TEXTBEFORE","TEXTAFTER","VALUETOTEXT","TEXTSPLIT"]),Database:new Set(["DSUM","DCOUNT","DCOUNTA","DAVERAGE","DMAX","DMIN","DPRODUCT","DGET","DSTDEV","DSTDEVP","DVAR","DVARP"])};function ui(u){var a;for(const r of ie)if((a=oi[r])!=null&&a.has(u))return r;throw new Error(`Missing Sheets category for function: ${u}`)}const Vt=si.map(u=>({...u,category:ui(u.name)}));function Ni(u=Vt){const a=new Set(u.map(r=>r.category));return ie.filter(r=>a.has(r))}function Ai(u){const a=u.toUpperCase();return Vt.filter(r=>r.name.startsWith(a))}function di(u){const a=u.toUpperCase();return Vt.find(r=>r.name===a)}function xi(u){const a=u.args.map(r=>{let s=r.optional?`[${r.name}]`:r.name;return r.repeating&&(s+=", ..."),s});return`${u.name}(${a.join(", ")})`}export{Vt as F,ie as S,li as a,gi as b,xi as c,vi as d,Dt as e,di as f,hi as g,pi as i,Ni as l,mi as n,Ai as s};
