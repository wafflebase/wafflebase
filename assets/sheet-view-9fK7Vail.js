const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chart-object-layer-BCFIoWWy.js","assets/vendor-react-Bg6UneQK.js","assets/sheet-formula-parser-O5gici2d.js","assets/sheet-formula-eval-WY_DIXm_.js","assets/sheet-core-C_GwcwCL.js","assets/utils-DjqsqOe8.js","assets/dropdown-menu-CQO2mrpo.js","assets/vendor-ui-DUghwSYy.js","assets/IconDotsVertical-CWmuc0X_.js","assets/IconTrash-plSpx8Za.js","assets/index-wHVQyKbO.js","assets/vendor-app-HGRjaN7r.js","assets/vendor-yorkie-DqSL832E.js","assets/index-DF2mX3DY.css","assets/index-3UDGtr2f.js","assets/use-mobile-sheet-gestures-D5cbSotk.js","assets/chart-editor-panel-HVOw_ZTp.js","assets/button-DWQ-sR7I.js","assets/input-BEpJFSyN.js","assets/label-CmhopHze.js","assets/select-CwTFhjuc.js","assets/IconX-ZR7dAakE.js","assets/conditional-format-panel-D05p0EQz.js","assets/IconPlus-C0ELPC2K.js"])))=>i.map(i=>d[i]);
var Dt=Object.defineProperty;var Bt=(l,t,s)=>t in l?Dt(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s;var re=(l,t,s)=>Bt(l,typeof t!="symbol"?t+"":t,s);import{u as Pt,L as Tt,_ as Xe}from"./index-wHVQyKbO.js";import{j as e,r as c}from"./vendor-react-Bg6UneQK.js";import"./sheet-formula-parser-O5gici2d.js";import{a as Ae}from"./sheet-formula-eval-WY_DIXm_.js";import{g as lt,C as Et,b as L,e as I,h as _t,t as De,a as Be,n as ot,j as he,k as Lt,l as Ce,s as it,m as Vt,o as Kt,q as Ut,r as $t,u as at,v as Ht,w as Wt,x as qt,y as Gt,z as ct,f as Xt}from"./sheet-core-C_GwcwCL.js";import{K as Yt,t as Pe}from"./vendor-ui-DUghwSYy.js";import{c as Zt}from"./index-3UDGtr2f.js";import{c as Jt}from"./utils-DjqsqOe8.js";import{c as j,u as Qt,a as R,b as F,d as A,S as de,e as es}from"./IconDotsVertical-CWmuc0X_.js";import{D as le,a as oe,b as ie,d as ue,e as U,c as v,f as ve}from"./dropdown-menu-CQO2mrpo.js";import{y as ts}from"./vendor-yorkie-DqSL832E.js";import{u as ss}from"./use-mobile-sheet-gestures-D5cbSotk.js";/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var _e=j("outline","abc","IconAbc",[["path",{d:"M3 16v-6a2 2 0 1 1 4 0v6",key:"svg-0"}],["path",{d:"M3 13h4",key:"svg-1"}],["path",{d:"M10 8v6a2 2 0 1 0 4 0v-1a2 2 0 1 0 -4 0v1",key:"svg-2"}],["path",{d:"M20.732 12a2 2 0 0 0 -3.732 1v1a2 2 0 0 0 3.726 1.01",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Le=j("outline","align-box-bottom-center","IconAlignBoxBottomCenter",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 15v2",key:"svg-1"}],["path",{d:"M12 11v6",key:"svg-2"}],["path",{d:"M15 13v4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ve=j("outline","align-box-center-middle","IconAlignBoxCenterMiddle",[["path",{d:"M3 19v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M11 15h2",key:"svg-1"}],["path",{d:"M9 12h6",key:"svg-2"}],["path",{d:"M10 9h4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ke=j("outline","align-box-top-center","IconAlignBoxTopCenter",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 9v-2",key:"svg-1"}],["path",{d:"M12 13v-6",key:"svg-2"}],["path",{d:"M15 11v-4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ue=j("outline","align-center","IconAlignCenter",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M8 12l8 0",key:"svg-1"}],["path",{d:"M6 18l12 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var $e=j("outline","align-left","IconAlignLeft",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M4 12l10 0",key:"svg-1"}],["path",{d:"M4 18l14 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var He=j("outline","align-right","IconAlignRight",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M10 12l10 0",key:"svg-1"}],["path",{d:"M6 18l14 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ns=j("outline","arrow-back-up","IconArrowBackUp",[["path",{d:"M9 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M5 10h11a4 4 0 1 1 0 8h-1",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var rs=j("outline","arrow-forward-up","IconArrowForwardUp",[["path",{d:"M15 14l4 -4l-4 -4",key:"svg-0"}],["path",{d:"M19 10h-11a4 4 0 1 0 0 8h1",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ls=j("outline","bold","IconBold",[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Te=j("outline","border-all","IconBorderAll",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M4 12l16 0",key:"svg-1"}],["path",{d:"M12 4l0 16",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ht=j("outline","border-bottom","IconBorderBottom",[["path",{d:"M20 20l-16 0",key:"svg-0"}],["path",{d:"M4 4l0 .01",key:"svg-1"}],["path",{d:"M8 4l0 .01",key:"svg-2"}],["path",{d:"M12 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M20 4l0 .01",key:"svg-5"}],["path",{d:"M4 8l0 .01",key:"svg-6"}],["path",{d:"M12 8l0 .01",key:"svg-7"}],["path",{d:"M20 8l0 .01",key:"svg-8"}],["path",{d:"M4 12l0 .01",key:"svg-9"}],["path",{d:"M8 12l0 .01",key:"svg-10"}],["path",{d:"M12 12l0 .01",key:"svg-11"}],["path",{d:"M16 12l0 .01",key:"svg-12"}],["path",{d:"M20 12l0 .01",key:"svg-13"}],["path",{d:"M4 16l0 .01",key:"svg-14"}],["path",{d:"M12 16l0 .01",key:"svg-15"}],["path",{d:"M20 16l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var dt=j("outline","border-inner","IconBorderInner",[["path",{d:"M4 12l16 0",key:"svg-0"}],["path",{d:"M12 4l0 16",key:"svg-1"}],["path",{d:"M4 4l0 .01",key:"svg-2"}],["path",{d:"M8 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M20 4l0 .01",key:"svg-5"}],["path",{d:"M4 8l0 .01",key:"svg-6"}],["path",{d:"M20 8l0 .01",key:"svg-7"}],["path",{d:"M4 16l0 .01",key:"svg-8"}],["path",{d:"M20 16l0 .01",key:"svg-9"}],["path",{d:"M4 20l0 .01",key:"svg-10"}],["path",{d:"M8 20l0 .01",key:"svg-11"}],["path",{d:"M16 20l0 .01",key:"svg-12"}],["path",{d:"M20 20l0 .01",key:"svg-13"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ut=j("outline","border-left","IconBorderLeft",[["path",{d:"M4 20l0 -16",key:"svg-0"}],["path",{d:"M8 4l0 .01",key:"svg-1"}],["path",{d:"M12 4l0 .01",key:"svg-2"}],["path",{d:"M16 4l0 .01",key:"svg-3"}],["path",{d:"M20 4l0 .01",key:"svg-4"}],["path",{d:"M12 8l0 .01",key:"svg-5"}],["path",{d:"M20 8l0 .01",key:"svg-6"}],["path",{d:"M8 12l0 .01",key:"svg-7"}],["path",{d:"M12 12l0 .01",key:"svg-8"}],["path",{d:"M16 12l0 .01",key:"svg-9"}],["path",{d:"M20 12l0 .01",key:"svg-10"}],["path",{d:"M12 16l0 .01",key:"svg-11"}],["path",{d:"M20 16l0 .01",key:"svg-12"}],["path",{d:"M8 20l0 .01",key:"svg-13"}],["path",{d:"M12 20l0 .01",key:"svg-14"}],["path",{d:"M16 20l0 .01",key:"svg-15"}],["path",{d:"M20 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ft=j("outline","border-none","IconBorderNone",[["path",{d:"M4 4l0 .01",key:"svg-0"}],["path",{d:"M8 4l0 .01",key:"svg-1"}],["path",{d:"M12 4l0 .01",key:"svg-2"}],["path",{d:"M16 4l0 .01",key:"svg-3"}],["path",{d:"M20 4l0 .01",key:"svg-4"}],["path",{d:"M4 8l0 .01",key:"svg-5"}],["path",{d:"M12 8l0 .01",key:"svg-6"}],["path",{d:"M20 8l0 .01",key:"svg-7"}],["path",{d:"M4 12l0 .01",key:"svg-8"}],["path",{d:"M8 12l0 .01",key:"svg-9"}],["path",{d:"M12 12l0 .01",key:"svg-10"}],["path",{d:"M16 12l0 .01",key:"svg-11"}],["path",{d:"M20 12l0 .01",key:"svg-12"}],["path",{d:"M4 16l0 .01",key:"svg-13"}],["path",{d:"M12 16l0 .01",key:"svg-14"}],["path",{d:"M20 16l0 .01",key:"svg-15"}],["path",{d:"M4 20l0 .01",key:"svg-16"}],["path",{d:"M8 20l0 .01",key:"svg-17"}],["path",{d:"M12 20l0 .01",key:"svg-18"}],["path",{d:"M16 20l0 .01",key:"svg-19"}],["path",{d:"M20 20l0 .01",key:"svg-20"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var mt=j("outline","border-outer","IconBorderOuter",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M12 8l0 .01",key:"svg-1"}],["path",{d:"M8 12l0 .01",key:"svg-2"}],["path",{d:"M12 12l0 .01",key:"svg-3"}],["path",{d:"M16 12l0 .01",key:"svg-4"}],["path",{d:"M12 16l0 .01",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var gt=j("outline","border-right","IconBorderRight",[["path",{d:"M20 4l0 16",key:"svg-0"}],["path",{d:"M4 4l0 .01",key:"svg-1"}],["path",{d:"M8 4l0 .01",key:"svg-2"}],["path",{d:"M12 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M4 8l0 .01",key:"svg-5"}],["path",{d:"M12 8l0 .01",key:"svg-6"}],["path",{d:"M4 12l0 .01",key:"svg-7"}],["path",{d:"M8 12l0 .01",key:"svg-8"}],["path",{d:"M12 12l0 .01",key:"svg-9"}],["path",{d:"M16 12l0 .01",key:"svg-10"}],["path",{d:"M4 16l0 .01",key:"svg-11"}],["path",{d:"M12 16l0 .01",key:"svg-12"}],["path",{d:"M4 20l0 .01",key:"svg-13"}],["path",{d:"M8 20l0 .01",key:"svg-14"}],["path",{d:"M12 20l0 .01",key:"svg-15"}],["path",{d:"M16 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var vt=j("outline","border-top","IconBorderTop",[["path",{d:"M4 4l16 0",key:"svg-0"}],["path",{d:"M4 8l0 .01",key:"svg-1"}],["path",{d:"M12 8l0 .01",key:"svg-2"}],["path",{d:"M20 8l0 .01",key:"svg-3"}],["path",{d:"M4 12l0 .01",key:"svg-4"}],["path",{d:"M8 12l0 .01",key:"svg-5"}],["path",{d:"M12 12l0 .01",key:"svg-6"}],["path",{d:"M16 12l0 .01",key:"svg-7"}],["path",{d:"M20 12l0 .01",key:"svg-8"}],["path",{d:"M4 16l0 .01",key:"svg-9"}],["path",{d:"M12 16l0 .01",key:"svg-10"}],["path",{d:"M20 16l0 .01",key:"svg-11"}],["path",{d:"M4 20l0 .01",key:"svg-12"}],["path",{d:"M8 20l0 .01",key:"svg-13"}],["path",{d:"M12 20l0 .01",key:"svg-14"}],["path",{d:"M16 20l0 .01",key:"svg-15"}],["path",{d:"M20 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var pt=j("outline","brush","IconBrush",[["path",{d:"M3 21v-4a4 4 0 1 1 4 4h-4",key:"svg-0"}],["path",{d:"M21 3a16 16 0 0 0 -12.8 10.2",key:"svg-1"}],["path",{d:"M21 3a16 16 0 0 1 -10.2 12.8",key:"svg-2"}],["path",{d:"M10.6 9a9 9 0 0 1 4.4 4.4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var We=j("outline","calendar","IconCalendar",[["path",{d:"M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z",key:"svg-0"}],["path",{d:"M16 3v4",key:"svg-1"}],["path",{d:"M8 3v4",key:"svg-2"}],["path",{d:"M4 11h16",key:"svg-3"}],["path",{d:"M11 15h1",key:"svg-4"}],["path",{d:"M12 15v3",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var yt=j("outline","chart-bar","IconChartBar",[["path",{d:"M3 13a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M15 9a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M9 5a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M4 20h14",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Me=j("outline","chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var pe=j("outline","currency-dollar","IconCurrencyDollar",[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Se=j("outline","decimal","IconDecimal",[["path",{d:"M17 8a2 2 0 0 1 2 2v4a2 2 0 1 1 -4 0v-4a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M10 8a2 2 0 0 1 2 2v4a2 2 0 1 1 -4 0v-4a2 2 0 0 1 2 -2z",key:"svg-1"}],["path",{d:"M5 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var xt=j("outline","droplet-off","IconDropletOff",[["path",{d:"M18.963 14.938a6.54 6.54 0 0 0 -.899 -4.06l-4.89 -7.26c-.42 -.626 -1.287 -.804 -1.936 -.398a1.376 1.376 0 0 0 -.41 .397l-1.282 1.9m-1.625 2.415l-1.986 2.946c-1.695 2.837 -1.035 6.44 1.567 8.545c2.602 2.105 6.395 2.105 8.996 0a6.83 6.83 0 0 0 1.376 -1.499",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var bt=j("outline","filter","IconFilter",[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var qe=j("outline","hash","IconHash",[["path",{d:"M5 9l14 0",key:"svg-0"}],["path",{d:"M5 15l14 0",key:"svg-1"}],["path",{d:"M11 4l-4 16",key:"svg-2"}],["path",{d:"M17 4l-4 16",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var os=j("outline","italic","IconItalic",[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var jt=j("outline","math-function","IconMathFunction",[["path",{d:"M3 19a2 2 0 0 0 2 2c2 0 2 -4 3 -9s1 -9 3 -9a2 2 0 0 1 2 2",key:"svg-0"}],["path",{d:"M5 12h6",key:"svg-1"}],["path",{d:"M15 12l6 6",key:"svg-2"}],["path",{d:"M15 18l6 -6",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var kt=j("outline","paint","IconPaint",[["path",{d:"M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2",key:"svg-1"}],["path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var we=j("outline","percentage","IconPercentage",[["path",{d:"M17 17m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M7 7m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M6 18l12 -12",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ct=j("outline","strikethrough","IconStrikethrough",[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var is=j("outline","table-alias","IconTableAlias",[["path",{d:"M3 12v-7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-7",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v10",key:"svg-2"}],["path",{d:"M2 17a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-4z",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var as=j("outline","typography","IconTypography",[["path",{d:"M4 20l3 0",key:"svg-0"}],["path",{d:"M14 20l7 0",key:"svg-1"}],["path",{d:"M6.9 15l6.9 0",key:"svg-2"}],["path",{d:"M10.2 6.3l5.8 13.7",key:"svg-3"}],["path",{d:"M5 20l6 -16l2 0l7 16",key:"svg-4"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var cs=j("filled","droplet-half-2-filled","IconDropletHalf2Filled",[["path",{d:"M13.905 2.923l.098 .135l4.92 7.306a7.566 7.566 0 0 1 1.043 3.167l.024 .326c.007 .047 .01 .094 .01 .143l-.002 .06c.056 2.3 -.944 4.582 -2.87 6.14c-2.969 2.402 -7.286 2.402 -10.255 0c-1.904 -1.54 -2.904 -3.787 -2.865 -6.071a1.052 1.052 0 0 1 .013 -.333a7.66 7.66 0 0 1 .913 -3.176l.172 -.302l4.893 -7.26c.185 -.275 .426 -.509 .709 -.686c1.055 -.66 2.446 -.413 3.197 .55zm-2.06 1.107l-.077 .038l-.041 .03l-.037 .036l-.033 .042l-4.863 7.214a5.607 5.607 0 0 0 -.651 1.61h11.723a5.444 5.444 0 0 0 -.49 -1.313l-.141 -.251l-4.891 -7.261a.428 .428 0 0 0 -.5 -.145z",key:"svg-0"}]]);const hs=Zt("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}});function Ee({className:l,variant:t,size:s,...n}){return e.jsx(Yt,{"data-slot":"toggle",className:Jt(hs({variant:t,size:s}),l),...n})}const ds=["#000000","#434343","#666666","#999999","#cccccc","#d50000","#e67c73","#f4511e","#ef6c00","#f09300","#0b8043","#33b679","#039be5","#3f51b5","#7986cb","#8e24aa","#d81b60","#ad1457","#6a1b9a","#4a148c"],us=["#ffffff","#f3f3f3","#e8e8e8","#d9d9d9","#cccccc","#fce4ec","#fff3e0","#fff9c4","#e8f5e9","#e0f7fa","#e3f2fd","#ede7f6","#f8bbd0","#f3e5f5","#e8eaf6","#ffcdd2","#ffe0b2","#fff59d","#c8e6c9","#b2dfdb"],fs={left:$e,center:Ue,right:He},ms={top:Ke,middle:Ve,bottom:Le},gs={plain:_e,number:qe,currency:pe,percent:we,date:We},wt=typeof navigator<"u"&&/Mac|iPhone|iPad|iPod/.test(navigator.userAgent),fe=wt?"⌘":"Ctrl";function vs({spreadsheet:l,onInsertChart:t,onOpenConditionalFormat:s,onTogglePaintFormat:n,paintFormatActive:r=!1}){const o=Qt(),[i,h]=c.useState(void 0),[u,p]=c.useState(!1),[g,k]=c.useState(!1),[b,M]=c.useState(!1),C=c.useMemo(()=>lt("en-US"),[]),m=c.useMemo(()=>lt(),[]),a=c.useCallback(async()=>{if(!l)return;const z=await l.getActiveStyle();h(z),p(l.isSelectionMerged()),k(l.canMergeSelection()),M(l.hasFilter())},[l]);c.useEffect(()=>{if(l)return a(),l.onSelectionChange(a)},[l,a]);const d=c.useCallback(z=>{l==null||l.toggleStyle(z)},[l]),x=c.useCallback(z=>{l==null||l.applyStyle({al:z})},[l]),S=c.useCallback(z=>{l==null||l.applyStyle({va:z})},[l]),_=c.useCallback(z=>{l==null||l.applyStyle({tc:z})},[l]),q=c.useCallback(()=>{l==null||l.applyStyle({tc:""})},[l]),P=c.useCallback(z=>{l==null||l.applyStyle({bg:z})},[l]),ye=c.useCallback(()=>{l==null||l.applyStyle({bg:""})},[l]),$=c.useCallback(()=>{l==null||l.undo()},[l]),Q=c.useCallback(()=>{l==null||l.redo()},[l]),H=c.useCallback(()=>{l==null||l.toggleFunctionBrowser()},[l]),ee=c.useCallback(()=>{t==null||t()},[t]),ae=c.useCallback(()=>{s==null||s()},[s]),V=c.useCallback(()=>{n==null||n()},[n]),B=c.useCallback(z=>{l==null||l.applyStyle({nf:z})},[l]),N=c.useCallback(()=>{l==null||l.increaseDecimals()},[l]),xe=c.useCallback(()=>{l==null||l.decreaseDecimals()},[l]),be=c.useCallback(()=>{l==null||l.toggleMergeCells()},[l]),T=c.useCallback(async()=>{l&&(l.hasFilter()?await l.clearFilter():await l.createFilterFromSelection(),await a())},[a,l]),D=c.useCallback(z=>{l==null||l.applyBorders(z)},[l]),ze=(i==null?void 0:i.al)||"left",G=fs[ze],Ne=(i==null?void 0:i.va)||"top",Oe=ms[Ne],je=(i==null?void 0:i.nf)||"plain",Re=gs[je];return e.jsxs("div",{className:"flex items-center gap-0.5 overflow-x-auto border-b bg-background px-2 py-1 whitespace-nowrap",children:[e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:$,children:e.jsx(ns,{size:16})})}),e.jsxs(A,{children:["Undo (",fe,"+Z)"]})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:Q,children:e.jsx(rs,{size:16})})}),e.jsxs(A,{children:["Redo (",fe,"+",wt?"⇧Z":"Y",")"]})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:`inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted ${r?"bg-muted":""}`,onClick:V,children:e.jsx(kt,{size:16})})}),e.jsx(A,{children:r?"Cancel paint format":"Paint format"})]}),e.jsx(de,{orientation:"vertical",className:"mx-1 h-6"}),!o&&e.jsxs(e.Fragment,{children:[e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:()=>B("currency"),children:e.jsx(pe,{size:16})})}),e.jsxs(A,{children:["Format as currency (",m.currency,")"]})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:()=>B("percent"),children:e.jsx(we,{size:16})})}),e.jsx(A,{children:"Format as percent"})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:xe,children:[e.jsx(Se,{size:16}),e.jsx("span",{className:"absolute mt-3.5 ml-3 text-[8px] font-bold leading-none",children:"-"})]})}),e.jsx(A,{children:"Decrease decimal places"})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:N,children:[e.jsx(Se,{size:16}),e.jsx("span",{className:"absolute mt-3.5 ml-3 text-[8px] font-bold leading-none",children:"+"})]})}),e.jsx(A,{children:"Increase decimal places"})]}),e.jsxs(le,{children:[e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx(oe,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(Re,{size:16}),e.jsx(Me,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(A,{children:"More format"})]}),e.jsxs(ie,{children:[e.jsx(ue,{className:"text-xs font-normal text-muted-foreground",children:"Common formats (US examples)"}),e.jsx(U,{}),e.jsxs(v,{onClick:()=>B("plain"),children:[e.jsx(_e,{size:16,className:"mr-2"}),"Plain text"]}),e.jsxs(v,{onClick:()=>B("number"),children:[e.jsx(qe,{size:16,className:"mr-2"}),"Number",e.jsx(ve,{children:C.number})]}),e.jsxs(v,{onClick:()=>B("currency"),children:[e.jsx(pe,{size:16,className:"mr-2"}),"Currency",e.jsx(ve,{children:C.currencyValue})]}),e.jsxs(v,{onClick:()=>B("percent"),children:[e.jsx(we,{size:16,className:"mr-2"}),"Percent",e.jsx(ve,{children:C.percent})]}),e.jsx(U,{}),e.jsxs(ue,{className:"text-xs font-normal text-muted-foreground",children:["US date preview: ",C.date]}),e.jsx(U,{}),e.jsxs(ue,{className:"text-xs font-normal text-muted-foreground",children:["Your locale (",m.locale,")"]}),e.jsxs(v,{onClick:()=>B("currency"),children:[e.jsx(pe,{size:16,className:"mr-2"}),"Locale currency",e.jsx(ve,{children:m.currencyValue})]}),e.jsxs(v,{onClick:()=>B("date"),children:[e.jsx(We,{size:16,className:"mr-2"}),"Locale date",e.jsx(ve,{children:m.date})]})]})]}),e.jsx(de,{orientation:"vertical",className:"mx-1 h-6"})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx(Ee,{size:"sm",pressed:(i==null?void 0:i.b)||!1,onPressedChange:()=>d("b"),className:"h-7 w-7 cursor-pointer",children:e.jsx(ls,{size:16})})}),e.jsxs(A,{children:["Bold (",fe,"+B)"]})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx(Ee,{size:"sm",pressed:(i==null?void 0:i.i)||!1,onPressedChange:()=>d("i"),className:"h-7 w-7 cursor-pointer",children:e.jsx(os,{size:16})})}),e.jsxs(A,{children:["Italic (",fe,"+I)"]})]}),!o&&e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx(Ee,{size:"sm",pressed:(i==null?void 0:i.st)||!1,onPressedChange:()=>d("st"),className:"h-7 w-7 cursor-pointer",children:e.jsx(Ct,{size:16})})}),e.jsxs(A,{children:["Strikethrough (",fe,"+Shift+S)"]})]}),e.jsxs(le,{children:[e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx(oe,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:[e.jsx(as,{size:16}),e.jsx("span",{className:"absolute mt-5 h-0.5 w-3.5 rounded",style:{backgroundColor:(i==null?void 0:i.tc)||"#000000"}})]})})}),e.jsx(A,{children:"Text color"})]}),e.jsxs(ie,{className:"w-auto p-2",children:[e.jsxs("button",{className:"mb-2 flex w-full items-center gap-2 rounded px-2 py-1 text-xs hover:bg-muted",onClick:q,children:[e.jsx(xt,{size:14}),"Reset"]}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:ds.map(z=>e.jsx("button",{className:"h-5 w-5 rounded border border-border hover:scale-125 transition-transform",style:{backgroundColor:z},onClick:()=>_(z)},z))})]})]}),e.jsx(de,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(le,{children:[e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx(oe,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:[e.jsx(cs,{size:16}),e.jsx("span",{className:"absolute mt-5 h-0.5 w-3.5 rounded",style:{backgroundColor:(i==null?void 0:i.bg)||"transparent",border:i!=null&&i.bg?"none":"1px solid #ccc"}})]})})}),e.jsx(A,{children:"Fill color"})]}),e.jsxs(ie,{className:"w-auto p-2",children:[e.jsxs("button",{className:"mb-2 flex w-full items-center gap-2 rounded px-2 py-1 text-xs hover:bg-muted",onClick:ye,children:[e.jsx(xt,{size:14}),"Reset"]}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:us.map(z=>e.jsx("button",{className:"h-5 w-5 rounded border border-border hover:scale-125 transition-transform",style:{backgroundColor:z},onClick:()=>P(z)},z))})]})]}),!o&&e.jsxs(le,{children:[e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx(oe,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(Te,{size:14}),e.jsx(Me,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(A,{children:"Cell borders"})]}),e.jsxs(ie,{children:[e.jsxs(v,{onClick:()=>D("all"),children:[e.jsx(Te,{size:14,className:"mr-2"}),"All borders"]}),e.jsxs(v,{onClick:()=>D("outer"),children:[e.jsx(mt,{size:14,className:"mr-2"}),"Outer border"]}),e.jsxs(v,{onClick:()=>D("inner"),children:[e.jsx(dt,{size:14,className:"mr-2"}),"Inner borders"]}),e.jsx(U,{}),e.jsxs(v,{onClick:()=>D("top"),children:[e.jsx(vt,{size:14,className:"mr-2"}),"Top border"]}),e.jsxs(v,{onClick:()=>D("bottom"),children:[e.jsx(ht,{size:14,className:"mr-2"}),"Bottom border"]}),e.jsxs(v,{onClick:()=>D("left"),children:[e.jsx(ut,{size:14,className:"mr-2"}),"Left border"]}),e.jsxs(v,{onClick:()=>D("right"),children:[e.jsx(gt,{size:14,className:"mr-2"}),"Right border"]}),e.jsx(U,{}),e.jsxs(v,{onClick:()=>D("clear"),children:[e.jsx(ft,{size:14,className:"mr-2"}),"Clear borders"]})]})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:`inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted disabled:cursor-not-allowed disabled:opacity-50 ${u?"bg-muted":""}`,onClick:be,disabled:!u&&!g,children:e.jsx(is,{size:16})})}),e.jsx(A,{children:u?"Unmerge cells":`Merge cells (${fe}+Shift+M)`})]}),!o&&e.jsxs(e.Fragment,{children:[e.jsx(de,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(le,{children:[e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx(oe,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(G,{size:16}),e.jsx(Me,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(A,{children:"Horizontal align"})]}),e.jsxs(ie,{children:[e.jsxs(v,{onClick:()=>x("left"),children:[e.jsx($e,{size:16,className:"mr-2"}),"Left"]}),e.jsxs(v,{onClick:()=>x("center"),children:[e.jsx(Ue,{size:16,className:"mr-2"}),"Center"]}),e.jsxs(v,{onClick:()=>x("right"),children:[e.jsx(He,{size:16,className:"mr-2"}),"Right"]})]})]}),e.jsxs(le,{children:[e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx(oe,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(Oe,{size:16}),e.jsx(Me,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(A,{children:"Vertical align"})]}),e.jsxs(ie,{children:[e.jsxs(v,{onClick:()=>S("top"),children:[e.jsx(Ke,{size:16,className:"mr-2"}),"Top"]}),e.jsxs(v,{onClick:()=>S("middle"),children:[e.jsx(Ve,{size:16,className:"mr-2"}),"Middle"]}),e.jsxs(v,{onClick:()=>S("bottom"),children:[e.jsx(Le,{size:16,className:"mr-2"}),"Bottom"]})]})]}),e.jsx(de,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-[11px] font-semibold hover:bg-muted",onClick:H,children:e.jsx(jt,{size:16,className:"mr-2"})})}),e.jsx(A,{children:"Functions"})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:`inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted ${b?"bg-muted":""}`,onClick:()=>{T()},children:e.jsx(bt,{size:16})})}),e.jsx(A,{children:b?"Clear filter":"Create filter from selection"})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-[11px] font-semibold hover:bg-muted",onClick:ee,children:e.jsx(yt,{size:16})})}),e.jsx(A,{children:"Insert chart"})]}),e.jsxs(R,{children:[e.jsx(F,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center rounded-md px-2 text-[10px] font-semibold tracking-wide hover:bg-muted",onClick:ae,children:e.jsx(pt,{size:16})})}),e.jsx(A,{children:"Conditional formatting"})]})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx(de,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(le,{children:[e.jsx(oe,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:e.jsx(es,{size:16})})}),e.jsxs(ie,{align:"end",children:[e.jsx(ue,{children:"Format"}),e.jsxs(v,{onClick:()=>B("currency"),children:[e.jsx(pe,{size:16,className:"mr-2"}),"Currency"]}),e.jsxs(v,{onClick:()=>B("percent"),children:[e.jsx(we,{size:16,className:"mr-2"}),"Percent"]}),e.jsxs(v,{onClick:xe,children:[e.jsx(Se,{size:16,className:"mr-2"}),"Decrease decimals"]}),e.jsxs(v,{onClick:N,children:[e.jsx(Se,{size:16,className:"mr-2"}),"Increase decimals"]}),e.jsx(U,{}),e.jsxs(v,{onClick:()=>B("plain"),children:[e.jsx(_e,{size:16,className:"mr-2"}),"Plain text"]}),e.jsxs(v,{onClick:()=>B("number"),children:[e.jsx(qe,{size:16,className:"mr-2"}),"Number (",C.number,")"]}),e.jsxs(v,{onClick:()=>B("date"),children:[e.jsx(We,{size:16,className:"mr-2"}),"Date (",m.date,")"]}),e.jsx(U,{}),e.jsxs(v,{onClick:()=>{T()},children:[e.jsx(bt,{size:16,className:"mr-2"}),b?"Clear filter":"Create filter"]}),e.jsx(U,{}),e.jsx(ue,{children:"Align"}),e.jsxs(v,{onClick:()=>x("left"),children:[e.jsx($e,{size:16,className:"mr-2"}),"Left"]}),e.jsxs(v,{onClick:()=>x("center"),children:[e.jsx(Ue,{size:16,className:"mr-2"}),"Center"]}),e.jsxs(v,{onClick:()=>x("right"),children:[e.jsx(He,{size:16,className:"mr-2"}),"Right"]}),e.jsxs(v,{onClick:()=>S("top"),children:[e.jsx(Ke,{size:16,className:"mr-2"}),"Top"]}),e.jsxs(v,{onClick:()=>S("middle"),children:[e.jsx(Ve,{size:16,className:"mr-2"}),"Middle"]}),e.jsxs(v,{onClick:()=>S("bottom"),children:[e.jsx(Le,{size:16,className:"mr-2"}),"Bottom"]}),e.jsx(U,{}),e.jsx(ue,{children:"Borders"}),e.jsxs(v,{onClick:()=>D("all"),children:[e.jsx(Te,{size:14,className:"mr-2"}),"All borders"]}),e.jsxs(v,{onClick:()=>D("outer"),children:[e.jsx(mt,{size:14,className:"mr-2"}),"Outer border"]}),e.jsxs(v,{onClick:()=>D("inner"),children:[e.jsx(dt,{size:14,className:"mr-2"}),"Inner borders"]}),e.jsxs(v,{onClick:()=>D("top"),children:[e.jsx(vt,{size:14,className:"mr-2"}),"Top border"]}),e.jsxs(v,{onClick:()=>D("bottom"),children:[e.jsx(ht,{size:14,className:"mr-2"}),"Bottom border"]}),e.jsxs(v,{onClick:()=>D("left"),children:[e.jsx(ut,{size:14,className:"mr-2"}),"Left border"]}),e.jsxs(v,{onClick:()=>D("right"),children:[e.jsx(gt,{size:14,className:"mr-2"}),"Right border"]}),e.jsxs(v,{onClick:()=>D("clear"),children:[e.jsx(ft,{size:14,className:"mr-2"}),"Clear borders"]}),e.jsx(U,{}),e.jsxs(v,{onClick:()=>d("st"),children:[e.jsx(Ct,{size:16,className:"mr-2"}),"Strikethrough"]}),e.jsxs(v,{onClick:H,children:[e.jsx(jt,{size:16,className:"mr-2"}),"Functions"]}),e.jsxs(v,{onClick:ee,children:[e.jsx(yt,{size:16,className:"mr-2"}),"Insert chart"]}),e.jsxs(v,{onClick:V,children:[e.jsx(kt,{size:16,className:"mr-2"}),r?"Cancel paint format":"Paint format"]}),e.jsxs(v,{onClick:ae,children:[e.jsx(pt,{size:16,className:"mr-2"}),"Conditional formatting"]})]})]})]})]})}class ps{constructor(t,s){re(this,"doc");re(this,"tabId");re(this,"cellIndex",new Et);re(this,"dirty",!0);re(this,"batchOverlay",null);re(this,"batchOps",null);this.doc=t,this.tabId=s,this.doc.update((n,r)=>{r.set({activeTabId:this.tabId})}),t.subscribe(n=>{n.type==="remote-change"&&(this.dirty=!0)})}getSheet(){return this.doc.getRoot().sheets[this.tabId]}isDuplicateOwnKeysError(t){return t instanceof TypeError&&t.message.includes("ownKeys")&&t.message.includes("duplicate")}snapshotObject(t){const s=t.toJSON;return typeof s=="function"?JSON.parse(s.call(t)):{...t}}stableObjectKeys(t){try{return Object.keys(t)}catch(s){if(this.isDuplicateOwnKeysError(s))return console.warn(s),Object.keys(this.snapshotObject(t));throw s}}stableObjectEntries(t){try{return Object.entries(t)}catch(s){if(this.isDuplicateOwnKeysError(s))return console.warn(s),Object.entries(this.snapshotObject(t));throw s}}stableSheetKeys(t){return this.stableObjectKeys(t)}stableSheetEntries(t){return this.stableObjectEntries(t)}toPlainString(t){if(typeof t=="string")return t;if(t==null)return"";if(typeof t=="number"||typeof t=="boolean")return String(t);if(typeof t=="object"){const s=t;if(s.value!==void 0&&s.value!==t)return this.toPlainString(s.value);if(typeof s.toJSON=="function")try{const n=s.toJSON.call(t);if(n!==t)return this.toPlainString(n)}catch{}}return String(t)}normalizeFilterCondition(t){const s={op:t.op};return t.value!==void 0&&(s.value=this.toPlainString(t.value)),t.values!==void 0&&(s.values=t.values.map(n=>this.toPlainString(n))),s}toWorksheetFilterState(t){return{startRow:t.range[0].r,endRow:t.range[1].r,startCol:t.range[0].c,endCol:t.range[1].c,columns:Object.fromEntries(Object.entries(t.columns).map(([s,n])=>[s,this.normalizeFilterCondition(n)])),hiddenRows:[...t.hiddenRows]}}fromWorksheetFilterState(t){if(t)return{range:[{r:t.startRow,c:t.startCol},{r:t.endRow,c:t.endCol}],columns:Object.fromEntries(Object.entries(t.columns||{}).map(([s,n])=>[s,this.normalizeFilterCondition(n)])),hiddenRows:[...t.hiddenRows||[]]}}ensureIndex(){if(!this.dirty)return;const t=this.getSheet().sheet,s=[];for(const n of this.stableSheetKeys(t)){const r=L(n);s.push([r.r,r.c])}this.cellIndex.rebuild(s),this.dirty=!1}normalizeCell(t){const s={};return t.v!==void 0&&t.v!==""&&(s.v=t.v),t.f!==void 0&&t.f!==""&&(s.f=t.f),t.s&&Object.keys(t.s).length>0&&(s.s=t.s),s.v===void 0&&s.f===void 0&&s.s===void 0?null:s}async set(t,s){const n=I(t),r=this.normalizeCell(s);if(this.batchOverlay){r?(this.batchOverlay.set(n,r),this.dirty||this.cellIndex.add(t.r,t.c)):(this.batchOverlay.set(n,null),this.dirty||this.cellIndex.remove(t.r,t.c));return}if(!r){await this.delete(t);return}const o=this.tabId;this.doc.update(i=>{i.sheets[o].sheet[n]=r}),this.dirty||this.cellIndex.add(t.r,t.c)}async get(t){const s=I(t);if(this.batchOverlay&&this.batchOverlay.has(s)){const n=this.batchOverlay.get(s);return n===null?void 0:n}return this.getSheet().sheet[s]}async has(t){const s=I(t);return this.batchOverlay&&this.batchOverlay.has(s)?this.batchOverlay.get(s)!==null:this.getSheet().sheet[s]!==void 0}async delete(t){const s=I(t);if(this.batchOverlay){let o=!1;return this.batchOverlay.has(s)?o=this.batchOverlay.get(s)!==null:o=this.getSheet().sheet[s]!==void 0,o?(this.batchOverlay.set(s,null),this.dirty||this.cellIndex.remove(t.r,t.c),!0):!1}let n=!1;const r=this.tabId;return this.doc.update(o=>{o.sheets[r].sheet[s]!==void 0&&(delete o.sheets[r].sheet[s],n=!0)}),n&&!this.dirty&&this.cellIndex.remove(t.r,t.c),n}async deleteRange(t){this.ensureIndex();const s=Array.from(this.cellIndex.cellsInRange(t)),n=new Set;if(this.batchOverlay){for(const[o,i]of s){const h=I({r:o,c:i});this.batchOverlay.has(h)&&this.batchOverlay.get(h)===null||(this.batchOverlay.set(h,null),n.add(h))}for(const[o,i]of s)this.cellIndex.remove(o,i);return n}const r=this.tabId;this.doc.update(o=>{for(const[i,h]of s){const u=I({r:i,c:h});delete o.sheets[r].sheet[u],n.add(u)}});for(const[o,i]of s)this.cellIndex.remove(o,i);return n}async setGrid(t){if(this.batchOverlay){for(const[n,r]of t){const o=L(n),i=this.normalizeCell(r);i?(this.batchOverlay.set(n,i),this.dirty||this.cellIndex.add(o.r,o.c)):(this.batchOverlay.set(n,null),this.dirty||this.cellIndex.remove(o.r,o.c))}return}const s=this.tabId;if(this.doc.update(n=>{for(const[r,o]of t){const i=this.normalizeCell(o);i?n.sheets[s].sheet[r]=i:n.sheets[s].sheet[r]!==void 0&&delete n.sheets[s].sheet[r]}}),!this.dirty)for(const[n,r]of t){const o=L(n);this.normalizeCell(r)?this.cellIndex.add(o.r,o.c):this.cellIndex.remove(o.r,o.c)}}async getGrid(t){this.ensureIndex();const s=this.getSheet().sheet,n=new Map;for(const[r,o]of this.cellIndex.cellsInRange(t)){const i=I({r,c:o});if(this.batchOverlay&&this.batchOverlay.has(i)){const u=this.batchOverlay.get(i);u!==null&&n.set(i,u);continue}const h=s[i];h!==void 0&&n.set(i,h)}return n}async findEdge(t,s,n){return this.ensureIndex(),_t(this.cellIndex,t,s,n,(r,o)=>{const i=I({r,c:o}),h=this.getSheet().sheet[i];return h!==void 0&&(!!h.v||!!h.f)})}async shiftCells(t,s,n){const r=this.tabId,o=i=>{const h=i.sheets[r],u=[];for(const[m,a]of this.stableSheetEntries(h.sheet))u.push([m,{v:a.v,f:a.f,s:a.s}]);const p=new Map;for(const[m,a]of u){const d=it(m,t,s,n);if(d===null)continue;let x;a.f?x={...a,f:Vt(a.f,t,s,n)}:x={...a};const S=this.normalizeCell(x);S&&p.set(d,S)}for(const[m]of u)!p.has(m)&&h.sheet[m]!==void 0&&delete h.sheet[m];for(const[m,a]of p)h.sheet[m]=a;const g=t==="row"?h.rowHeights:h.colWidths,k=[];for(const[m,a]of Object.entries(g))k.push([m,a]);for(const[m]of k)delete g[m];for(const[m,a]of k){const d=Number(m);if(n>0)d>=s?g[String(d+n)]=a:g[m]=a;else{const x=Math.abs(n);d>=s&&d<s+x||(d>=s+x?g[String(d+n)]=a:g[m]=a)}}const b=t==="row"?h.rowStyles:h.colStyles;if(b){const m=[];for(const[a,d]of Object.entries(b))m.push([a,d]);for(const[a]of m)delete b[a];for(const[a,d]of m){const x=Number(a);if(n>0)x>=s?b[String(x+n)]=d:b[a]=d;else{const S=Math.abs(n);x>=s&&x<s+S||(x>=s+S?b[String(x+n)]=d:b[a]=d)}}}h.rangeStyles&&(h.rangeStyles=Kt(h.rangeStyles,t,s,n)),h.conditionalFormats&&(h.conditionalFormats=Ut(h.conditionalFormats,t,s,n));const M=new Map(Object.entries(h.merges||{})),C=$t(M,t,s,n);h.merges={};for(const[m,a]of C)h.merges[m]=a;if(h.charts)for(const m of Object.values(h.charts)){const a=it(m.anchor,t,s,n);if(a){m.anchor=a;continue}const d=L(m.anchor);t==="row"?d.r=Math.max(1,s):d.c=Math.max(1,s),m.anchor=I(d)}};if(this.batchOps){this.batchOps.push(o),this.dirty=!0;return}this.doc.update(i=>{o(i)}),this.dirty=!0}async moveCells(t,s,n,r){const o=this.tabId,i=h=>{const u=h.sheets[o],p=[];for(const[a,d]of this.stableSheetEntries(u.sheet))p.push([a,{v:d.v,f:d.f,s:d.s}]);const g=new Map;for(const[a,d]of p){const x=L(a),S=at(x,t,s,n,r),_=I(S);let q;d.f?q={...d,f:Ht(d.f,t,s,n,r)}:q={...d};const P=this.normalizeCell(q);P&&g.set(_,P)}for(const[a]of p)!g.has(a)&&u.sheet[a]!==void 0&&delete u.sheet[a];for(const[a,d]of g)u.sheet[a]=d;const k=t==="row"?u.rowHeights:u.colWidths,b=[];for(const[a,d]of Object.entries(k))b.push([a,d]);for(const[a]of b)delete k[a];for(const[a,d]of b){const x=Number(a),S=ct(x,s,n,r);k[String(S)]=d}const M=t==="row"?u.rowStyles:u.colStyles;if(M){const a=[];for(const[d,x]of Object.entries(M))a.push([d,x]);for(const[d]of a)delete M[d];for(const[d,x]of a){const S=Number(d),_=ct(S,s,n,r);M[String(_)]=x}}u.rangeStyles&&(u.rangeStyles=Wt(u.rangeStyles,t,s,n,r)),u.conditionalFormats&&(u.conditionalFormats=qt(u.conditionalFormats,t,s,n,r));const C=new Map(Object.entries(u.merges||{})),m=Gt(C,t,s,n,r);u.merges={};for(const[a,d]of m)u.merges[a]=d;if(u.charts)for(const a of Object.values(u.charts)){const d=at(L(a.anchor),t,s,n,r);a.anchor=I(d)}};if(this.batchOps){this.batchOps.push(i),this.dirty=!0;return}this.doc.update(h=>{i(h)}),this.dirty=!0}async getFormulaGrid(){const t=new Map,s=this.getSheet().sheet;for(const[n,r]of this.stableSheetEntries(s))r.f&&t.set(n,r);return t}async buildDependantsMap(t){const s=new Map,n=this.getSheet().sheet;if(this.batchOverlay){for(const[r,o]of this.stableSheetEntries(n))if(!this.batchOverlay.has(r)&&o.f)for(const i of De(Ae(o.f)))Be(i)||(s.has(i)||s.set(i,new Set),s.get(i).add(r));for(const[r,o]of this.batchOverlay)if(!(o===null||!o.f))for(const i of De(Ae(o.f)))Be(i)||(s.has(i)||s.set(i,new Set),s.get(i).add(r));return s}for(const[r,o]of this.stableSheetEntries(n))if(o.f)for(const i of De(Ae(o.f)))Be(i)||(s.has(i)||s.set(i,new Set),s.get(i).add(r));return s}async setDimensionSize(t,s,n){if(this.batchOps){const o=this.tabId;this.batchOps.push(i=>{const h=t==="row"?i.sheets[o].rowHeights:i.sheets[o].colWidths;h[String(s)]=n});return}const r=this.tabId;this.doc.update(o=>{const i=t==="row"?o.sheets[r].rowHeights:o.sheets[r].colWidths;i[String(s)]=n})}async getDimensionSizes(t){const s=this.getSheet(),n=t==="row"?s.rowHeights:s.colWidths,r=new Map;if(n)for(const[o,i]of Object.entries(n))r.set(Number(o),i);return r}updateActiveCell(t){this.doc.update((s,n)=>{n.set({activeCell:I(t),activeTabId:this.tabId})})}getPresences(){return this.doc.getOthersPresences().filter(t=>{var s;return((s=t.presence)==null?void 0:s.activeTabId)===this.tabId})}async setColumnStyle(t,s){if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{o.sheets[r].colStyles||(o.sheets[r].colStyles={}),o.sheets[r].colStyles[String(t)]=s});return}const n=this.tabId;this.doc.update(r=>{r.sheets[n].colStyles||(r.sheets[n].colStyles={}),r.sheets[n].colStyles[String(t)]=s})}async getColumnStyles(){const t=this.getSheet(),s=new Map;if(t.colStyles)for(const[n,r]of Object.entries(t.colStyles))s.set(Number(n),r);return s}async setRowStyle(t,s){if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{o.sheets[r].rowStyles||(o.sheets[r].rowStyles={}),o.sheets[r].rowStyles[String(t)]=s});return}const n=this.tabId;this.doc.update(r=>{r.sheets[n].rowStyles||(r.sheets[n].rowStyles={}),r.sheets[n].rowStyles[String(t)]=s})}async getRowStyles(){const t=this.getSheet(),s=new Map;if(t.rowStyles)for(const[n,r]of Object.entries(t.rowStyles))s.set(Number(n),r);return s}async setSheetStyle(t){if(this.batchOps){const n=this.tabId;this.batchOps.push(r=>{r.sheets[n].sheetStyle=t});return}const s=this.tabId;this.doc.update(n=>{n.sheets[s].sheetStyle=t})}async getSheetStyle(){const t=this.getSheet();return t.sheetStyle?{...t.sheetStyle}:void 0}async addRangeStyle(t){const s=ot(t);if(!s)return;if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{o.sheets[r].rangeStyles||(o.sheets[r].rangeStyles=[]),o.sheets[r].rangeStyles.push(he(s))});return}const n=this.tabId;this.doc.update(r=>{r.sheets[n].rangeStyles||(r.sheets[n].rangeStyles=[]),r.sheets[n].rangeStyles.push(he(s))})}async setRangeStyles(t){const s=t.map(r=>ot(r)).filter(r=>!!r).map(r=>he(r));if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{if(s.length===0){delete o.sheets[r].rangeStyles;return}o.sheets[r].rangeStyles=s.map(i=>he(i))});return}const n=this.tabId;this.doc.update(r=>{if(s.length===0){delete r.sheets[n].rangeStyles;return}r.sheets[n].rangeStyles=s.map(o=>he(o))})}async getRangeStyles(){const t=this.getSheet();return!t.rangeStyles||t.rangeStyles.length===0?[]:t.rangeStyles.map(s=>he(s))}async setConditionalFormats(t){const s=t.map(r=>Lt(r)).filter(r=>!!r).map(r=>Ce(r));if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{if(s.length===0){delete o.sheets[r].conditionalFormats;return}o.sheets[r].conditionalFormats=s.map(i=>Ce(i))});return}const n=this.tabId;this.doc.update(r=>{if(s.length===0){delete r.sheets[n].conditionalFormats;return}r.sheets[n].conditionalFormats=s.map(o=>Ce(o))})}async getConditionalFormats(){const t=this.getSheet();return!t.conditionalFormats||t.conditionalFormats.length===0?[]:t.conditionalFormats.map(s=>Ce(s))}async setMerge(t,s){if(this.batchOps){const o=this.tabId,i=I(t);this.batchOps.push(h=>{h.sheets[o].merges||(h.sheets[o].merges={}),h.sheets[o].merges[i]={...s}});return}const n=this.tabId,r=I(t);this.doc.update(o=>{o.sheets[n].merges||(o.sheets[n].merges={}),o.sheets[n].merges[r]={...s}})}async deleteMerge(t){var o;const s=I(t);if(this.batchOps){const i=this.tabId;return!((o=this.getSheet().merges)!=null&&o[s])?!1:(this.batchOps.push(p=>{var g;(g=p.sheets[i].merges)!=null&&g[s]&&delete p.sheets[i].merges[s]}),!0)}let n=!1;const r=this.tabId;return this.doc.update(i=>{var h;(h=i.sheets[r].merges)!=null&&h[s]&&(delete i.sheets[r].merges[s],n=!0)}),n}async getMerges(){const t=this.getSheet(),s=new Map;if(!t.merges)return s;for(const[n,r]of Object.entries(t.merges))s.set(n,{...r});return s}async setFilterState(t){if(this.batchOps){const n=this.tabId;this.batchOps.push(r=>{const o=r.sheets[n];if(!t){delete o.filter;return}o.filter=this.toWorksheetFilterState(t)});return}const s=this.tabId;this.doc.update(n=>{const r=n.sheets[s];if(!t){delete r.filter;return}r.filter=this.toWorksheetFilterState(t)})}async getFilterState(){return this.fromWorksheetFilterState(this.getSheet().filter)}async setHiddenState(t){if(this.batchOps){const n=this.tabId;this.batchOps.push(r=>{const o=r.sheets[n];if(!t){delete o.hiddenRows,delete o.hiddenColumns;return}o.hiddenRows=[...t.rows],o.hiddenColumns=[...t.columns]});return}const s=this.tabId;this.doc.update(n=>{const r=n.sheets[s];if(!t){delete r.hiddenRows,delete r.hiddenColumns;return}r.hiddenRows=[...t.rows],r.hiddenColumns=[...t.columns]})}async getHiddenState(){const t=this.getSheet(),s=t.hiddenRows,n=t.hiddenColumns;if(!(!s&&!n))return{rows:s?[...s]:[],columns:n?[...n]:[]}}async setFreezePane(t,s){if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{o.sheets[r].frozenRows=t,o.sheets[r].frozenCols=s});return}const n=this.tabId;this.doc.update(r=>{r.sheets[n].frozenRows=t,r.sheets[n].frozenCols=s})}async getFreezePane(){const t=this.getSheet();return{frozenRows:t.frozenRows??0,frozenCols:t.frozenCols??0}}beginBatch(){this.batchOverlay=new Map,this.batchOps=[]}endBatch(){const t=this.batchOverlay,s=this.batchOps;this.batchOverlay=null,this.batchOps=null;const n=t&&t.size>0,r=s&&s.length>0;if(!n&&!r)return;const o=this.tabId;this.doc.update(i=>{const h=i.sheets[o];if(t)for(const[u,p]of t)if(p===null)h.sheet[u]!==void 0&&delete h.sheet[u];else{const g=this.normalizeCell(p);g?h.sheet[u]=g:h.sheet[u]!==void 0&&delete h.sheet[u]}if(s)for(const u of s)u(i)}),this.dirty=!0}async undo(){if(!this.doc.history.canUndo())return{success:!1};const t=new Set(this.stableSheetKeys(this.getSheet().sheet)),s=new Map(Object.entries(this.getSheet().merges||{}));return this.doc.history.undo(),this.dirty=!0,{success:!0,affectedRange:this.computeAffectedRange(t,s)}}async redo(){if(!this.doc.history.canRedo())return{success:!1};const t=new Set(this.stableSheetKeys(this.getSheet().sheet)),s=new Map(Object.entries(this.getSheet().merges||{}));return this.doc.history.redo(),this.dirty=!0,{success:!0,affectedRange:this.computeAffectedRange(t,s)}}computeAffectedRange(t,s){const n=new Set(this.stableSheetKeys(this.getSheet().sheet)),r=new Map(Object.entries(this.getSheet().merges||{})),o=new Set;for(const g of n)t.has(g)||o.add(g);for(const g of t)n.has(g)||o.add(g);for(const[g,k]of r){const b=s.get(g);(!b||b.rs!==k.rs||b.cs!==k.cs)&&o.add(g)}for(const g of s.keys())r.has(g)||o.add(g);if(o.size===0)return;let i=1/0,h=-1/0,u=1/0,p=-1/0;for(const g of o){const k=L(g);k.r<i&&(i=k.r),k.r>h&&(h=k.r),k.c<u&&(u=k.c),k.c>p&&(p=k.c)}return[{r:i,c:u},{r:h,c:p}]}canUndo(){return this.doc.history.canUndo()}canRedo(){return this.doc.history.canRedo()}}function It(l){if(typeof l!="string")return null;const t=l.toUpperCase().replace(/\$/g,"").split(":").map(s=>s.trim()).filter(Boolean);if(t.length!==2)return null;try{const s=L(t[0]),n=L(t[1]);return[{r:Math.min(s.r,n.r),c:Math.min(s.c,n.c)},{r:Math.max(s.r,n.r),c:Math.max(s.c,n.c)}]}catch{return null}}function _s(l){return`${I(l[0])}:${I(l[1])}`}function ys(l){const[t,s]=l,n=[];for(let r=t.c;r<=s.c;r++)n.push(zt(r));return n.length===0?{xAxisColumn:null,seriesColumns:[]}:{xAxisColumn:n[0],seriesColumns:n.slice(1)}}function xs(l,t){const s=l.sheets[t.sourceTabId];if(!s)return{columns:[],xAxisColumn:null,seriesColumns:[]};const n=It(t.sourceRange);if(!n)return{columns:[],xAxisColumn:null,seriesColumns:[]};const[r,o]=n,i=[];for(let M=r.c;M<=o.c;M++){const C=zt(M);i.push({column:C,index:M,label:Ie(s,r.r,M)||C})}if(i.length===0)return{columns:[],xAxisColumn:null,seriesColumns:[]};const h=i[0].column,u=Ge(t.xAxisColumn),p=i.some(M=>M.column===u)?u:h,g=new Set,k=[],b=t.seriesColumns??[];for(const M of b){const C=Ge(M);C&&C!==p&&!g.has(C)&&i.some(m=>m.column===C)&&(g.add(C),k.push(C))}if(t.seriesColumns===void 0)for(const M of i)M.column!==p&&k.push(M.column);return{columns:i,xAxisColumn:p,seriesColumns:k}}function Ls(l,t){const s=l.sheets[t.sourceTabId];if(!s)return{xKey:"category",rows:[],series:[],config:{}};const n=It(t.sourceRange);if(!n)return{xKey:"category",rows:[],series:[],config:{}};const[r,o]=n,i=o.c-r.c+1,h=o.r-r.r+1;if(i<2||h<2)return{xKey:"category",rows:[],series:[],config:{}};const u=xs(l,t);if(!u.xAxisColumn||u.seriesColumns.length===0)return{xKey:"category",rows:[],series:[],config:{}};const p=Mt(u.xAxisColumn);if(!p)return{xKey:"category",rows:[],series:[],config:{}};const g=[],k={},b=[];for(const[m,a]of u.seriesColumns.entries()){const d=Mt(a);if(!d)continue;const x=Ie(s,r.r,d)||a,S=`series_${a}`,_={key:S,label:x};g.push(_),b.push({..._,index:d}),k[S]={label:x,color:js(m)}}if(b.length===0)return{xKey:"category",rows:[],series:[],config:{}};const M="category",C=[];for(let m=r.r+1;m<=o.r;m++){const a={};a[M]=Ie(s,m,p)||`Row ${m-r.r}`;let d=!1;for(const x of b){const S=bs(Ie(s,m,x.index));S!==null&&(a[x.key]=S,d=!0)}d&&C.push(a)}return{xKey:M,rows:C,series:g,config:k}}function Ie(l,t,s){var r;const n=(r=l.sheet[I({r:t,c:s})])==null?void 0:r.v;return typeof n=="string"?n:n==null?"":String(n)}function bs(l){if(typeof l!="string")return null;const t=l.trim().replace(/,/g,"");if(!t)return null;const s=Number(t);return Number.isFinite(s)?s:null}function zt(l){return I({r:1,c:l}).replace(/[0-9]+$/,"")}function Mt(l){const t=Ge(l);if(!t)return null;try{return L(`${t}1`).c}catch{return null}}function Ge(l){if(typeof l!="string")return null;const t=l.trim().toUpperCase();return/^[A-Z]+$/.test(t)?t:null}function js(l){const t=["var(--color-primary)","color-mix(in oklch, var(--color-primary) 78%, var(--color-background))","color-mix(in oklch, var(--color-primary) 68%, var(--color-foreground))","color-mix(in oklch, var(--color-primary) 56%, var(--color-background))","color-mix(in oklch, var(--color-primary) 46%, var(--color-foreground))"];return t[l%t.length]}function ks(l){if(!l)return!0;const t=p=>p===void 0||p===!1,s=l.al===void 0||l.al==="left",n=l.va===void 0||l.va==="top",r=l.nf===void 0||l.nf==="plain",o=l.dp===void 0||l.dp===2,i=l.tc===void 0||l.tc==="",h=l.bg===void 0||l.bg==="",u=l.cu===void 0||l.cu==="";return t(l.b)&&t(l.i)&&t(l.u)&&t(l.st)&&t(l.bt)&&t(l.br)&&t(l.bb)&&t(l.bl)&&i&&h&&s&&n&&r&&o&&u}const Cs=c.lazy(()=>Xe(()=>import("./chart-object-layer-BCFIoWWy.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])).then(l=>({default:l.ChartObjectLayer}))),Ms=c.lazy(()=>Xe(()=>import("./chart-editor-panel-HVOw_ZTp.js"),__vite__mapDeps([16,1,7,17,14,5,18,19,8,20,21,10,11,12,13,2,3,4,6,15])).then(l=>({default:l.ChartEditorPanel}))),Ss=c.lazy(()=>Xe(()=>import("./conditional-format-panel-D05p0EQz.js"),__vite__mapDeps([22,1,2,3,4,7,17,14,5,18,19,8,6,20,21,23,10,11,12,13,15])).then(l=>({default:l.ConditionalFormatPanel})));function St({tabId:l,readOnly:t=!1,peerJumpTarget:s=null}){var Ze,Je,Qe;const{resolvedTheme:n}=Pt(),r=c.useRef(null),[o,i]=c.useState(!1),[h,u]=c.useState(0),[p,g]=c.useState(null),[k,b]=c.useState(!1),[M,C]=c.useState(!1),[m,a]=c.useState(!1),[d,x]=c.useState(null),[S,_]=c.useState(!1),q=c.useRef(0),P=c.useRef(void 0),ye=c.useRef(!1),$=c.useRef(!1),Q=c.useRef(!1),H=c.useRef(!1),ee=c.useRef(!1),ae=c.useRef(!1),V=c.useRef(!1),B=c.useRef(void 0),{doc:N,loading:xe,error:be}=ts.useDocument();ss({containerRef:r,sheetRef:P});const T=N==null?void 0:N.getRoot(),D=!!T&&Object.keys(((Ze=T.sheets[l])==null?void 0:Ze.charts)||{}).length>0,ze=T&&p?(Qe=(Je=T.sheets[l])==null?void 0:Je.charts)==null?void 0:Qe[p]:void 0;c.useEffect(()=>{ye.current=D},[D]);const G=c.useCallback(()=>{$.current=!1,Q.current=!1,H.current=!1,ee.current=!1,ae.current=!1,V.current=!1,B.current=void 0,a(!1),x(null),_(!1)},[]);c.useEffect(()=>{$.current=m},[m]),c.useEffect(()=>{V.current=S},[S]),c.useEffect(()=>{if(!m)return;const y=()=>{Q.current&&(Q.current=!1,H.current=!0,V.current=!1,_(!1))};return window.addEventListener("pointerup",y),window.addEventListener("pointercancel",y),()=>{window.removeEventListener("pointerup",y),window.removeEventListener("pointercancel",y)}},[m]);const Ne=c.useCallback(async()=>{const y=P.current;if(t||!y)return;if($.current){G();return}const f=await y.getActiveStyle(),O=ks(f),w=y.getActiveCell();w&&(B.current=O?void 0:{...f},Q.current=!1,H.current=!1,ee.current=!1,ae.current=O,V.current=!1,$.current=!0,a(!0),x({...w}),_(!1),g(null),b(!1),C(!1))},[G,t]),Oe=c.useCallback(()=>{if(t)return;const y=P.current;if(!N||!y)return;if(y.getSelectionType()!=="cell"){Pe.error("Select a cell range to insert a chart.");return}const f=y.getSelectionRangeOrActiveCell();if(!f){Pe.error("Select a cell range to insert a chart.");return}const O=f[1].r-f[0].r+1,w=f[1].c-f[0].c+1;if(O<2||w<2){Pe.error("Select at least 2 rows and 2 columns.");return}const K=`chart-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,X=`${I(f[0])}:${I(f[1])}`,te=I(f[0]),Y=ys([f[0],f[1]]);N.update(se=>{const E=se.sheets[l];E.charts||(E.charts={}),E.charts[K]={id:K,type:"bar",title:"Chart",sourceTabId:l,sourceRange:X,xAxisColumn:Y.xAxisColumn||void 0,seriesColumns:Y.seriesColumns,anchor:te,offsetX:8,offsetY:8,width:420,height:260}}),g(K),b(!0),C(!1)},[N,t,l]),je=c.useCallback((y,f)=>{t||!N||N.update(O=>{var K,X;const w=(X=(K=O.sheets[l])==null?void 0:K.charts)==null?void 0:X[y];w&&(f.anchor!==void 0&&(w.anchor=f.anchor),f.offsetX!==void 0&&(w.offsetX=f.offsetX),f.offsetY!==void 0&&(w.offsetY=f.offsetY),f.width!==void 0&&(w.width=f.width),f.height!==void 0&&(w.height=f.height),f.title!==void 0&&(w.title=f.title),f.sourceRange!==void 0&&(w.sourceRange=f.sourceRange),f.type!==void 0&&(w.type=f.type),f.sourceTabId!==void 0&&(w.sourceTabId=f.sourceTabId),f.xAxisColumn!==void 0&&(w.xAxisColumn=f.xAxisColumn),f.seriesColumns!==void 0&&(w.seriesColumns=[...f.seriesColumns]))})},[N,t,l]),Re=c.useCallback(y=>{t||!N||(N.update(f=>{var w;const O=f.sheets[l];(w=O==null?void 0:O.charts)!=null&&w[y]&&delete O.charts[y]}),p===y&&(g(null),b(!1)))},[N,t,p,l]),z=c.useCallback(y=>{g(y),b(!0),C(!1)},[]),Nt=c.useCallback(()=>{C(!0),b(!1)},[]),Ye=c.useCallback(()=>{const y=P.current;if(!y||y.getSelectionType()!=="cell")return null;const f=y.getSelectionRangeOrActiveCell();return f?`${I(f[0])}:${I(f[1])}`:null},[]),Ot=c.useCallback(y=>{$.current&&y.pointerType==="mouse"&&d&&(V.current=!0,_(!0)),$.current&&(y.pointerType!=="mouse"&&(V.current=!1,_(!1)),Q.current=!0,H.current=!1),p!==null&&g(null),k&&b(!1),M&&C(!1)},[k,M,d,p]);c.useEffect(()=>{g(null),b(!1),C(!1),G()},[G,l]),c.useEffect(()=>{i(!0)},[]),c.useEffect(()=>{const y=r.current;if(!o||!y||!N)return;let f;const O=[];let w=!1,K=!1,X=!1,te=null,Y=null,se=null;return Xt(y,{theme:n,store:new ps(N,l),readOnly:t}).then(E=>{if(w){E.cleanup();return}f=E,P.current=E,u(Z=>Z+1),O.push(E.onSelectionChange(()=>{if((ye.current||V.current)&&te===null&&(te=requestAnimationFrame(()=>{te=null,u(me=>me+1)})),!$.current||!H.current||ee.current||(H.current=!1,E.getSelectionType()!=="cell"))return;ee.current=!0;const Z=B.current;(ae.current?E.applyDefaultStyle():Z?E.applyStyle(Z):E.applyDefaultStyle()).finally(()=>{G()})}));const Fe=()=>{if(!(w||!f)){if(K){X=!0;return}K=!0,f.reloadDimensions().then(()=>{if(!(w||!f))return f.recalculateCrossSheetFormulas()}).finally(()=>{K=!1,X&&(X=!1,queueMicrotask(Fe))})}},Ft=()=>{w||se!==null||(se=requestAnimationFrame(()=>{se=null,Fe()}))},At=()=>{Y===null&&(Y=requestAnimationFrame(()=>{Y=null,!w&&f&&f.renderOverlay()}))};E.setGridResolver((Z,et)=>{const me=N.getRoot(),tt=me.tabOrder.find(J=>{const W=me.tabs[J];return(W==null?void 0:W.type)==="sheet"&&W.name.toUpperCase()===Z});if(!tt)return;const ke=me.sheets[tt];if(!ke)return;const st=new Map;if(ke.merges)for(const[J,W]of Object.entries(ke.merges)){const ne=L(J);for(let ge=ne.r;ge<ne.r+W.rs;ge++)for(let ce=ne.c;ce<ne.c+W.cs;ce++){const rt=I({r:ge,c:ce});rt!==J&&st.set(rt,J)}}const nt=new Map;for(const J of et){const W=L(J),ne=I(W),ge=st.get(ne)||ne,ce=ke.sheet[ge];ce&&nt.set(J,ce)}return nt}),Fe(),O.push(N.subscribe(Z=>{Z.type==="remote-change"&&Ft()})),O.push(N.subscribe("presence",At))}),()=>{w=!0,f&&f.cleanup(),P.current=void 0,te!==null&&cancelAnimationFrame(te),Y!==null&&cancelAnimationFrame(Y),se!==null&&cancelAnimationFrame(se);for(const E of O)E()}},[G,o,r,N,l,t,n]),c.useEffect(()=>{var y,f;p&&((f=(y=T==null?void 0:T.sheets[l])==null?void 0:y.charts)!=null&&f[p]||(g(null),b(!1)))},[T,p,l]),c.useEffect(()=>{if(!s||s.targetTabId&&s.targetTabId!==l||s.requestId===q.current)return;const y=P.current;if(y){q.current=s.requestId,g(null),b(!1),C(!1);try{y.focusCell(L(s.activeCell))}catch{}}},[s,h,l]);const Rt=(()=>{if(!S||!d)return null;const y=P.current;if(!y)return null;try{const f=y.getGridViewportRect(),O=y.getCellRect(d);return e.jsx("div",{className:"absolute pointer-events-none rounded-[2px]",style:{left:f.left+O.left,top:f.top+O.top,width:O.width,height:O.height,boxShadow:"inset 0 0 0 2px var(--color-primary)",zIndex:12}})}catch{return null}})();return xe?e.jsx(Tt,{}):be?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx("div",{className:"text-red-500",children:be.message})}):e.jsxs("div",{className:"flex h-full w-full flex-col",children:[!t&&e.jsx(vs,{spreadsheet:P.current,onInsertChart:Oe,onOpenConditionalFormat:Nt,onTogglePaintFormat:()=>{Ne()},paintFormatActive:m}),e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx("div",{ref:r,className:"h-full w-full",style:{touchAction:"manipulation"},onPointerDown:Ot}),Rt,T&&D&&e.jsx(c.Suspense,{fallback:null,children:e.jsx(Cs,{spreadsheet:P.current,root:T,tabId:l,readOnly:t,selectedChartId:p,onSelectChart:g,onRequestEditChart:z,onDeleteChart:Re,onUpdateChart:je,renderVersion:h})}),T&&!t&&k&&e.jsx(c.Suspense,{fallback:null,children:e.jsx(Ms,{root:T,chart:ze,open:k,onClose:()=>b(!1),onUpdateChart:je,getSelectionRange:Ye})}),!t&&M&&e.jsx(c.Suspense,{fallback:null,children:e.jsx(Ss,{spreadsheet:P.current,open:M,onClose:()=>C(!1),getSelectionRange:Ye})})]})]})}const Vs=Object.freeze(Object.defineProperty({__proto__:null,SheetView:St,default:St},Symbol.toStringTag,{value:"Module"}));export{us as B,yt as I,St as S,Ee as T,pt as a,Ls as b,ls as c,os as d,as as e,_s as f,ys as g,xt as h,ds as i,cs as j,It as p,xs as r,Vs as s};
