import{u as V,a as k,r as l,j as e,b as E}from"./index-4Y3j31u3.js";import{c as H,r as K,d as q,f as I}from"./documents-PjJr9OPW.js";import{u as m,a as L,P as A,T as Q,b as z,c as x,d as B,f,e as O,g as N,h as $,i as G,j as J,k as U,l as W,E as X,m as Y,n as Z}from"./table-R-ZHFzrF.js";import{B as i}from"./button-CnDIJ-qV.js";import{D as _,a as ee,b as te,c as se,d as ae,e as ne}from"./dialog-l_9WFAeE.js";import{D as ie,a as le,b as oe,c as y}from"./dropdown-menu-6skjDed5.js";import{I as C}from"./input-Df5d67su.js";import{L as re}from"./label-BD9gwAqG.js";import"./index-Bq8K5X-a.js";import"./index-CUA-LGrS.js";import"./index-B0uC051L.js";import"./index-4LeIrXKH.js";function ce({data:u}){var j,p;const o=V(),r=k(),g=[{accessorKey:"id",header:"ID",enableHiding:!0},{accessorKey:"title",header:"Title",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("title")})},{accessorKey:"createdAt",header:()=>e.jsx("div",{className:"text-right",children:"Created At"}),cell:({row:t})=>{const s=t.getValue("createdAt"),d=W(new Date(s),{includeSeconds:!0,addSuffix:!0});return e.jsx("div",{className:"text-right font-medium",children:d})}},{id:"actions",enableHiding:!1,cell:({row:t})=>e.jsxs(ie,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(i,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(X,{})]})}),e.jsxs(oe,{align:"end",children:[e.jsxs(y,{onClick:s=>{s.stopPropagation(),c({id:String(t.getValue("id")),title:t.getValue("title")})},children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Rename"]}),e.jsxs(y,{className:"text-red-500 focus:text-red-500",onClick:s=>{s.stopPropagation(),D.mutate(String(t.getValue("id")))},children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}],[a,c]=l.useState(null),w=m({mutationFn:async t=>await H(t),onSuccess:t=>r(`/${t.id}`)}),D=m({mutationFn:async t=>await q(t),onSuccess:()=>o.invalidateQueries({queryKey:["documents"]})}),h=m({mutationFn:async({id:t,title:s})=>await K(t,s),onSuccess:()=>{o.invalidateQueries({queryKey:["documents"]}),c(null)}}),[b,v]=l.useState([]),[S,R]=l.useState([]),[M,F]=l.useState({id:!1}),[P,T]=l.useState({}),n=L({data:u,columns:g,onSortingChange:v,onColumnFiltersChange:R,getCoreRowModel:U(),getPaginationRowModel:J(),getSortedRowModel:G(),getFilteredRowModel:$(),onColumnVisibilityChange:F,onRowSelectionChange:T,state:{sorting:b,columnFilters:S,columnVisibility:M,rowSelection:P}});return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsx(C,{placeholder:"Filter by title...",value:((j=n.getColumn("title"))==null?void 0:j.getFilterValue())??"",onChange:t=>{var s;return(s=n.getColumn("title"))==null?void 0:s.setFilterValue(t.target.value)},className:"max-w-sm"}),e.jsxs(i,{onClick:()=>{w.mutate({title:"New Document"})},className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"New Document"]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Q,{children:[e.jsx(z,{children:n.getHeaderGroups().map(t=>e.jsx(x,{children:t.headers.map(s=>e.jsx(B,{children:s.isPlaceholder?null:f(s.column.columnDef.header,s.getContext())},s.id))},t.id))}),e.jsx(O,{children:(p=n.getRowModel().rows)!=null&&p.length?n.getRowModel().rows.map(t=>e.jsx(x,{"data-state":t.getIsSelected()&&"selected",className:"cursor-pointer hover:bg-muted",onClick:s=>{s.target.closest("input, button")||r(`/${t.getValue("id")}`)},children:t.getVisibleCells().map(s=>e.jsx(N,{children:f(s.column.columnDef.cell,s.getContext())},s.id))},t.id)):e.jsx(x,{children:e.jsx(N,{colSpan:g.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>n.previousPage(),disabled:!n.getCanPreviousPage(),children:"Previous"}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>n.nextPage(),disabled:!n.getCanNextPage(),children:"Next"})]})]}),e.jsx(_,{open:a!==null,onOpenChange:t=>{t||c(null)},children:e.jsx(ee,{className:"sm:max-w-md",children:e.jsxs("form",{onSubmit:t=>{if(t.preventDefault(),!a)return;const d=new FormData(t.target).get("title");d.trim()&&h.mutate({id:a.id,title:d.trim()})},children:[e.jsxs(te,{children:[e.jsx(se,{children:"Rename Document"}),e.jsx(ae,{children:"Enter a new name for this document."})]}),e.jsx("div",{className:"grid gap-4 py-2",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(re,{htmlFor:"rename-title",children:"Title"}),e.jsx(C,{id:"rename-title",name:"title",defaultValue:(a==null?void 0:a.title)??"",autoFocus:!0},a==null?void 0:a.id)]})}),e.jsxs(ne,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>c(null),children:"Cancel"}),e.jsx(i,{type:"submit",disabled:h.isPending,children:"Rename"})]})]})})})]})}function we(){const{data:u=[],isLoading:o,isError:r}=E({queryKey:["documents"],queryFn:I});return o?e.jsx("div",{className:"flex flex-col items-center justify-center h-64",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"Loading documents..."})}):r?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("p",{className:"text-red-500 text-lg",children:"Failed to load documents."}),e.jsx("p",{className:"text-gray-400",children:"Please try again later."})]}):e.jsx("div",{className:"p-4",children:e.jsx(ce,{data:u})})}export{we as default};
