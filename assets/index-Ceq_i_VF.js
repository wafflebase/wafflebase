const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/page-B9Na0n51.js","assets/vendor-react-Bg6UneQK.js","assets/utils-DjqsqOe8.js","assets/button-DWQ-sR7I.js","assets/vendor-ui-DUghwSYy.js","assets/index-3UDGtr2f.js","assets/page-C_ck5kMi.js","assets/vendor-app-HGRjaN7r.js","assets/documents-BnR2eNts.js","assets/http-error-XKKRT0jQ.js","assets/dialog-CFv6VfMI.js","assets/dropdown-menu-CQO2mrpo.js","assets/input-BEpJFSyN.js","assets/label-CmhopHze.js","assets/table-BcaU83pl.js","assets/formatDistanceToNow-DXTjigy3.js","assets/vendor-yorkie-DqSL832E.js","assets/document-detail-D8_nasbN.js","assets/site-header-DcyJBj9u.js","assets/IconDotsVertical-CWmuc0X_.js","assets/select-CwTFhjuc.js","assets/worksheet-Cu6-p2bc.js","assets/IconTrash-plSpx8Za.js","assets/IconPlus-C0ELPC2K.js","assets/page-CCXzJgSe.js","assets/datasources-CEUf2AIL.js","assets/badge-D_FUDBc2.js","assets/datasource-dialog-Cr7OHPzg.js","assets/switch-C-9wTfxy.js","assets/shared-document-CZHBtxia.js","assets/sheet-view-YMmNkrDt.js","assets/sheet-formula-parser-CbheDyXI.js","assets/sheet-formula-eval-M_YF2Bcn.js","assets/sheet-core-wpLUU54d.js","assets/use-mobile-sheet-gestures-D5cbSotk.js","assets/page-L_GCp_ro.js","assets/page-D9qf-S4k.js","assets/page-DGRYQviH.js","assets/Layout-_XnG1CXs.js"])))=>i.map(i=>d[i]);
import{j as e,O as w,N as j,r as i,B as k,h as O,i as f,k as A}from"./vendor-react-Bg6UneQK.js";import{u as v,Q as b,a as D}from"./vendor-app-HGRjaN7r.js";import{L as I,t as C,T as q}from"./vendor-ui-DUghwSYy.js";import{y as z}from"./vendor-yorkie-DqSL832E.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))u(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&u(d)}).observe(document,{childList:!0,subtree:!0});function c(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function u(t){if(t.ep)return;t.ep=!0;const n=c(t);fetch(t.href,n)}})();const V="modulepreload",F=function(r){return"/"+r},E={},p=function(s,c,u){let t=Promise.resolve();if(c&&c.length>0){let d=function(o){return Promise.all(o.map(l=>Promise.resolve(l).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),y=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));t=d(c.map(o=>{if(o=F(o),o in E)return;E[o]=!0;const l=o.endsWith(".css"),m=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${m}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":V,l||(h.as="script"),h.crossOrigin="",h.href=o,y&&h.setAttribute("nonce",y),document.head.appendChild(h),l)return new Promise((S,R)=>{h.addEventListener("load",S),h.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${o}`)))})}))}function n(d){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=d,window.dispatchEvent(a),!a.defaultPrevented)throw d}return t.then(d=>{for(const a of d||[])a.status==="rejected"&&n(a.reason);return s().catch(n)})},x=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px]","aria-live":"polite",children:[e.jsx(I,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"mt-4 text-sm text-muted-foreground",children:"Loading..."})]});function N(r){let s=null;return async()=>(s||(s=(async()=>{try{return await r()}finally{s=null}})()),s)}class $ extends Error{constructor(){super("Session expired"),this.name="AuthExpiredError"}}function le(r){return r instanceof Error&&r.name==="AuthExpiredError"}let g=!1;function _(){g||(g=!0,window.location.href="/login")}const L=N(async()=>{try{return(await fetch("https://wafflebase-api.yorkie.dev/auth/refresh",{method:"POST",credentials:"include"})).ok}catch{return!1}});async function M(r={}){const{redirect:s=!0,showSuccessToast:c=!0,suppressFailure:u=!1}=r;let t=null;try{t=await fetch("https://wafflebase-api.yorkie.dev/auth/logout",{method:"POST",credentials:"include"})}catch(n){if(!u)throw n}if(t&&!t.ok&&!u)throw new Error("Failed to log out");c&&(t!=null&&t.ok)&&C.success("Logged out successfully"),s&&_()}async function Q(){const r=await T("https://wafflebase-api.yorkie.dev/auth/me",{method:"GET",credentials:"include"});if(!r.ok)throw new Error("Failed to fetch user");return r.json()}async function B(){const r=()=>fetch("https://wafflebase-api.yorkie.dev/auth/me",{method:"GET",credentials:"include"});let s=await r();if(s.status===401&&(!await L()||(s=await r(),s.status===401)))return null;if(!s.ok)throw new Error("Failed to fetch user");return s.json()}async function T(r,s,c=!1){const u=await fetch(r,{...s,credentials:"include"});if(u.status===401&&!c&&await L())return T(r,s,!0);if(u.status===401)throw await M({redirect:!1,showSuccessToast:!1,suppressFailure:!0}),_(),new $;return u}const G=()=>{const{data:r,isLoading:s}=v({queryKey:["me"],queryFn:Q,retry:!1});return s?e.jsx(x,{}):r?e.jsx(z.YorkieProvider,{rpcAddr:"https://api.yorkie.dev",apiKey:"fbuqYRxotajGGzb3kUD6aX",metadata:{userID:r.username||"anonymous-user"},children:e.jsx(w,{})}):e.jsx(j,{to:"/login"})},K=()=>{const{data:r,isLoading:s}=v({queryKey:["me","optional"],queryFn:B,retry:!1});return s?e.jsx(x,{}):r?e.jsx(j,{to:"/"}):e.jsx(w,{})},U={theme:"system",resolvedTheme:"light",setTheme:()=>null},P=i.createContext(U);function H({children:r,defaultTheme:s="system",storageKey:c="vite-ui-theme",...u}){const[t,n]=i.useState(()=>localStorage.getItem(c)||s),[d,a]=i.useState(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");i.useEffect(()=>{const o=window.document.documentElement;o.classList.remove("light","dark");let l;if(t==="system"){const m=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";l=m,o.classList.add(m)}else l=t,o.classList.add(t);a(l)},[t]),i.useEffect(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)"),l=()=>{if(t==="system"){const m=window.document.documentElement,h=o.matches?"dark":"light";m.classList.remove("light","dark"),m.classList.add(h),a(h)}};return o.addEventListener("change",l),()=>o.removeEventListener("change",l)},[t]);const y={theme:t,resolvedTheme:d,setTheme:o=>{localStorage.setItem(c,o),n(o)}};return e.jsx(P.Provider,{...u,value:y,children:r})}const ue=()=>{const r=i.useContext(P);if(r===void 0)throw new Error("useTheme must be used within a ThemeProvider");return r},W=i.lazy(()=>p(()=>import("./page-B9Na0n51.js"),__vite__mapDeps([0,1,2,3,4,5]))),Y=i.lazy(()=>p(()=>import("./page-C_ck5kMi.js"),__vite__mapDeps([6,1,7,8,4,9,3,5,2,10,11,12,13,14,15,16]))),J=i.lazy(()=>p(()=>import("./document-detail-D8_nasbN.js"),__vite__mapDeps([17,1,16,7,8,4,9,18,19,2,11,5,3,10,13,20,21,22,23]))),X=i.lazy(()=>p(()=>import("./page-CCXzJgSe.js"),__vite__mapDeps([24,1,7,25,9,3,4,5,2,11,12,14,26,27,10,13,28,15,16]))),Z=i.lazy(()=>p(()=>import("./shared-document-CZHBtxia.js"),__vite__mapDeps([29,1,7,16,21,19,4,2,9,30,31,32,33,5,11,34]))),ee=i.lazy(()=>p(()=>import("./page-L_GCp_ro.js"),__vite__mapDeps([35,1,28,4,2,7,16]))),te=i.lazy(()=>p(()=>import("./page-D9qf-S4k.js"),__vite__mapDeps([36,1,26,4,5,2,3,12,13,14,31,32,33]))),re=i.lazy(()=>p(()=>import("./page-DGRYQviH.js"),__vite__mapDeps([37,1,31,32,33]))),se=i.lazy(()=>p(()=>import("./Layout-_XnG1CXs.js"),__vite__mapDeps([38,1,18,19,4,2,11,7,5,3,16])));function oe(){const[r]=i.useState(()=>new b);return e.jsxs(H,{defaultTheme:"system",storageKey:"vite-ui-theme",children:[e.jsx(D,{client:r,children:e.jsx(k,{basename:"/",children:e.jsx(i.Suspense,{fallback:e.jsx(x,{}),children:e.jsxs(O,{children:[e.jsx(f,{element:e.jsx(K,{}),children:e.jsx(f,{path:"/login",element:e.jsx(W,{})})}),e.jsx(f,{path:"/harness/visual",element:e.jsx(te,{})}),e.jsx(f,{path:"/harness/interaction",element:e.jsx(re,{})}),e.jsx(f,{path:"/shared/:token",element:e.jsx(Z,{})}),e.jsxs(f,{element:e.jsx(G,{}),children:[e.jsxs(f,{element:e.jsx(se,{}),children:[e.jsx(f,{path:"/",element:e.jsx(Y,{})}),e.jsx(f,{path:"/datasources",element:e.jsx(X,{})}),e.jsx(f,{path:"/settings",element:e.jsx(ee,{})})]}),e.jsx(f,{path:"/:id",element:e.jsx(J,{})})]})]})})})}),e.jsx(q,{})]})}A.createRoot(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(oe,{})}));export{x as L,P as T,p as _,T as a,B as b,Q as f,le as i,M as l,ue as u};
