var Lp=Object.defineProperty;var Bp=(l,e,t)=>e in l?Lp(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var k=(l,e,t)=>Bp(l,typeof e!="symbol"?e+"":e,t);import{z as id,r as Mp}from"./index-1gnYbMGL.js";import{u as kp}from"./IconDotsVertical-KDTGp0Fg.js";var Br={},jo={},Sl;function zp(){if(Sl)return jo;Sl=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(jo,"__esModule",{value:!0}),jo}var qo={},Al;function jp(){if(Al)return qo;Al=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(qo,"__esModule",{value:!0}),qo}var Mr={},Ho={exports:{}},Uo={},$o={},Vo={},Wo,Cl;function Ha(){return Cl||(Cl=1,Wo=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var o=42;e[t]=o;for(var i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var n=Object.getOwnPropertySymbols(e);if(n.length!==1||n[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,t);if(s.value!==o||s.enumerable!==!0)return!1}return!0}),Wo}var Go,El;function Ao(){if(El)return Go;El=1;var l=Ha();return Go=function(){return l()&&!!Symbol.toStringTag},Go}var Yo,_l;function Ua(){return _l||(_l=1,Yo=Object),Yo}var Xo,Tl;function qp(){return Tl||(Tl=1,Xo=Error),Xo}var Ko,bl;function Hp(){return bl||(bl=1,Ko=EvalError),Ko}var Qo,Rl;function Up(){return Rl||(Rl=1,Qo=RangeError),Qo}var Jo,wl;function $p(){return wl||(wl=1,Jo=ReferenceError),Jo}var Zo,Nl;function od(){return Nl||(Nl=1,Zo=SyntaxError),Zo}var es,Ol;function Gi(){return Ol||(Ol=1,es=TypeError),es}var ts,Fl;function Vp(){return Fl||(Fl=1,ts=URIError),ts}var rs,Pl;function Wp(){return Pl||(Pl=1,rs=Math.abs),rs}var ns,Il;function Gp(){return Il||(Il=1,ns=Math.floor),ns}var is,Dl;function Yp(){return Dl||(Dl=1,is=Math.max),is}var os,Ll;function Xp(){return Ll||(Ll=1,os=Math.min),os}var ss,Bl;function Kp(){return Bl||(Bl=1,ss=Math.pow),ss}var as,Ml;function Qp(){return Ml||(Ml=1,as=Math.round),as}var ls,kl;function Jp(){return kl||(kl=1,ls=Number.isNaN||function(e){return e!==e}),ls}var us,zl;function Zp(){if(zl)return us;zl=1;var l=Jp();return us=function(t){return l(t)||t===0?t:t<0?-1:1},us}var cs,jl;function e0(){return jl||(jl=1,cs=Object.getOwnPropertyDescriptor),cs}var hs,ql;function ii(){if(ql)return hs;ql=1;var l=e0();if(l)try{l([],"length")}catch{l=null}return hs=l,hs}var fs,Hl;function Co(){if(Hl)return fs;Hl=1;var l=Object.defineProperty||!1;if(l)try{l({},"a",{value:1})}catch{l=!1}return fs=l,fs}var ds,Ul;function t0(){if(Ul)return ds;Ul=1;var l=typeof Symbol<"u"&&Symbol,e=Ha();return ds=function(){return typeof l!="function"||typeof Symbol!="function"||typeof l("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},ds}var ps,$l;function sd(){return $l||($l=1,ps=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),ps}var xs,Vl;function ad(){if(Vl)return xs;Vl=1;var l=Ua();return xs=l.getPrototypeOf||null,xs}var ms,Wl;function r0(){if(Wl)return ms;Wl=1;var l="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,r="[object Function]",o=function(a,c){for(var u=[],h=0;h<a.length;h+=1)u[h]=a[h];for(var f=0;f<c.length;f+=1)u[f+a.length]=c[f];return u},i=function(a,c){for(var u=[],h=c,f=0;h<a.length;h+=1,f+=1)u[f]=a[h];return u},n=function(s,a){for(var c="",u=0;u<s.length;u+=1)c+=s[u],u+1<s.length&&(c+=a);return c};return ms=function(a){var c=this;if(typeof c!="function"||e.apply(c)!==r)throw new TypeError(l+c);for(var u=i(arguments,1),h,f=function(){if(this instanceof h){var v=c.apply(this,o(u,arguments));return Object(v)===v?v:this}return c.apply(a,o(u,arguments))},d=t(0,c.length-u.length),p=[],y=0;y<d;y++)p[y]="$"+y;if(h=Function("binder","return function ("+n(p,",")+"){ return binder.apply(this,arguments); }")(f),c.prototype){var x=function(){};x.prototype=c.prototype,h.prototype=new x,x.prototype=null}return h},ms}var gs,Gl;function Yi(){if(Gl)return gs;Gl=1;var l=r0();return gs=Function.prototype.bind||l,gs}var ys,Yl;function $a(){return Yl||(Yl=1,ys=Function.prototype.call),ys}var vs,Xl;function Va(){return Xl||(Xl=1,vs=Function.prototype.apply),vs}var Ss,Kl;function n0(){return Kl||(Kl=1,Ss=typeof Reflect<"u"&&Reflect&&Reflect.apply),Ss}var As,Ql;function ld(){if(Ql)return As;Ql=1;var l=Yi(),e=Va(),t=$a(),r=n0();return As=r||l.call(t,e),As}var Cs,Jl;function Wa(){if(Jl)return Cs;Jl=1;var l=Yi(),e=Gi(),t=$a(),r=ld();return Cs=function(i){if(i.length<1||typeof i[0]!="function")throw new e("a function is required");return r(l,t,i)},Cs}var Es,Zl;function i0(){if(Zl)return Es;Zl=1;var l=Wa(),e=ii(),t;try{t=[].__proto__===Array.prototype}catch(n){if(!n||typeof n!="object"||!("code"in n)||n.code!=="ERR_PROTO_ACCESS")throw n}var r=!!t&&e&&e(Object.prototype,"__proto__"),o=Object,i=o.getPrototypeOf;return Es=r&&typeof r.get=="function"?l([r.get]):typeof i=="function"?function(s){return i(s==null?s:o(s))}:!1,Es}var _s,eu;function Ga(){if(eu)return _s;eu=1;var l=sd(),e=ad(),t=i0();return _s=l?function(o){return l(o)}:e?function(o){if(!o||typeof o!="object"&&typeof o!="function")throw new TypeError("getProto: not an object");return e(o)}:t?function(o){return t(o)}:null,_s}var Ts,tu;function ud(){if(tu)return Ts;tu=1;var l=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Yi();return Ts=t.call(l,e),Ts}var bs,ru;function Ya(){if(ru)return bs;ru=1;var l,e=Ua(),t=qp(),r=Hp(),o=Up(),i=$p(),n=od(),s=Gi(),a=Vp(),c=Wp(),u=Gp(),h=Yp(),f=Xp(),d=Kp(),p=Qp(),y=Zp(),x=Function,v=function(I){try{return x('"use strict"; return ('+I+").constructor;")()}catch{}},m=ii(),g=Co(),S=function(){throw new s},C=m?function(){try{return arguments.callee,S}catch{try{return m(arguments,"callee").get}catch{return S}}}():S,A=t0()(),b=Ga(),R=ad(),w=sd(),P=Va(),M=$a(),D={},U=typeof Uint8Array>"u"||!b?l:b(Uint8Array),J={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?l:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?l:ArrayBuffer,"%ArrayIteratorPrototype%":A&&b?b([][Symbol.iterator]()):l,"%AsyncFromSyncIteratorPrototype%":l,"%AsyncFunction%":D,"%AsyncGenerator%":D,"%AsyncGeneratorFunction%":D,"%AsyncIteratorPrototype%":D,"%Atomics%":typeof Atomics>"u"?l:Atomics,"%BigInt%":typeof BigInt>"u"?l:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?l:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?l:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?l:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":r,"%Float16Array%":typeof Float16Array>"u"?l:Float16Array,"%Float32Array%":typeof Float32Array>"u"?l:Float32Array,"%Float64Array%":typeof Float64Array>"u"?l:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?l:FinalizationRegistry,"%Function%":x,"%GeneratorFunction%":D,"%Int8Array%":typeof Int8Array>"u"?l:Int8Array,"%Int16Array%":typeof Int16Array>"u"?l:Int16Array,"%Int32Array%":typeof Int32Array>"u"?l:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":A&&b?b(b([][Symbol.iterator]())):l,"%JSON%":typeof JSON=="object"?JSON:l,"%Map%":typeof Map>"u"?l:Map,"%MapIteratorPrototype%":typeof Map>"u"||!A||!b?l:b(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":m,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?l:Promise,"%Proxy%":typeof Proxy>"u"?l:Proxy,"%RangeError%":o,"%ReferenceError%":i,"%Reflect%":typeof Reflect>"u"?l:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?l:Set,"%SetIteratorPrototype%":typeof Set>"u"||!A||!b?l:b(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?l:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":A&&b?b(""[Symbol.iterator]()):l,"%Symbol%":A?Symbol:l,"%SyntaxError%":n,"%ThrowTypeError%":C,"%TypedArray%":U,"%TypeError%":s,"%Uint8Array%":typeof Uint8Array>"u"?l:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?l:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?l:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?l:Uint32Array,"%URIError%":a,"%WeakMap%":typeof WeakMap>"u"?l:WeakMap,"%WeakRef%":typeof WeakRef>"u"?l:WeakRef,"%WeakSet%":typeof WeakSet>"u"?l:WeakSet,"%Function.prototype.call%":M,"%Function.prototype.apply%":P,"%Object.defineProperty%":g,"%Object.getPrototypeOf%":R,"%Math.abs%":c,"%Math.floor%":u,"%Math.max%":h,"%Math.min%":f,"%Math.pow%":d,"%Math.round%":p,"%Math.sign%":y,"%Reflect.getPrototypeOf%":w};if(b)try{null.error}catch(I){var te=b(b(I));J["%Error.prototype%"]=te}var le=function I(j){var $;if(j==="%AsyncFunction%")$=v("async function () {}");else if(j==="%GeneratorFunction%")$=v("function* () {}");else if(j==="%AsyncGeneratorFunction%")$=v("async function* () {}");else if(j==="%AsyncGenerator%"){var W=I("%AsyncGeneratorFunction%");W&&($=W.prototype)}else if(j==="%AsyncIteratorPrototype%"){var L=I("%AsyncGenerator%");L&&b&&($=b(L.prototype))}return J[j]=$,$},ge={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ce=Yi(),ee=ud(),G=ce.call(M,Array.prototype.concat),Q=ce.call(P,Array.prototype.splice),ie=ce.call(M,String.prototype.replace),_=ce.call(M,String.prototype.slice),E=ce.call(M,RegExp.prototype.exec),T=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,N=/\\(\\)?/g,F=function(j){var $=_(j,0,1),W=_(j,-1);if($==="%"&&W!=="%")throw new n("invalid intrinsic syntax, expected closing `%`");if(W==="%"&&$!=="%")throw new n("invalid intrinsic syntax, expected opening `%`");var L=[];return ie(j,T,function(B,H,Y,re){L[L.length]=Y?ie(re,N,"$1"):H||B}),L},O=function(j,$){var W=j,L;if(ee(ge,W)&&(L=ge[W],W="%"+L[0]+"%"),ee(J,W)){var B=J[W];if(B===D&&(B=le(W)),typeof B>"u"&&!$)throw new s("intrinsic "+j+" exists, but is not available. Please file an issue!");return{alias:L,name:W,value:B}}throw new n("intrinsic "+j+" does not exist!")};return bs=function(j,$){if(typeof j!="string"||j.length===0)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof $!="boolean")throw new s('"allowMissing" argument must be a boolean');if(E(/^%?[^%]*%?$/,j)===null)throw new n("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var W=F(j),L=W.length>0?W[0]:"",B=O("%"+L+"%",$),H=B.name,Y=B.value,re=!1,ne=B.alias;ne&&(L=ne[0],Q(W,G([0,1],ne)));for(var q=1,X=!0;q<W.length;q+=1){var he=W[q],be=_(he,0,1),Re=_(he,-1);if((be==='"'||be==="'"||be==="`"||Re==='"'||Re==="'"||Re==="`")&&be!==Re)throw new n("property names with quotes must have matching quotes");if((he==="constructor"||!X)&&(re=!0),L+="."+he,H="%"+L+"%",ee(J,H))Y=J[H];else if(Y!=null){if(!(he in Y)){if(!$)throw new s("base intrinsic for "+j+" exists, but the property is not available.");return}if(m&&q+1>=W.length){var z=m(Y,he);X=!!z,X&&"get"in z&&!("originalValue"in z.get)?Y=z.get:Y=Y[he]}else X=ee(Y,he),Y=Y[he];X&&!re&&(J[H]=Y)}}return Y},bs}var Rs,nu;function oi(){if(nu)return Rs;nu=1;var l=Ya(),e=Wa(),t=e([l("%String.prototype.indexOf%")]);return Rs=function(o,i){var n=l(o,!!i);return typeof n=="function"&&t(o,".prototype.")>-1?e([n]):n},Rs}var ws,iu;function o0(){if(iu)return ws;iu=1;var l=Ao()(),e=oi(),t=e("Object.prototype.toString"),r=function(s){return l&&s&&typeof s=="object"&&Symbol.toStringTag in s?!1:t(s)==="[object Arguments]"},o=function(s){return r(s)?!0:s!==null&&typeof s=="object"&&"length"in s&&typeof s.length=="number"&&s.length>=0&&t(s)!=="[object Array]"&&"callee"in s&&t(s.callee)==="[object Function]"},i=function(){return r(arguments)}();return r.isLegacyArguments=o,ws=i?r:o,ws}var Ns,ou;function s0(){if(ou)return Ns;ou=1;var l=oi(),e=Ao()(),t=ud(),r=ii(),o;if(e){var i=l("RegExp.prototype.exec"),n={},s=function(){throw n},a={toString:s,valueOf:s};typeof Symbol.toPrimitive=="symbol"&&(a[Symbol.toPrimitive]=s),o=function(f){if(!f||typeof f!="object")return!1;var d=r(f,"lastIndex"),p=d&&t(d,"value");if(!p)return!1;try{i(f,a)}catch(y){return y===n}}}else{var c=l("Object.prototype.toString"),u="[object RegExp]";o=function(f){return!f||typeof f!="object"&&typeof f!="function"?!1:c(f)===u}}return Ns=o,Ns}var Os,su;function a0(){if(su)return Os;su=1;var l=oi(),e=s0(),t=l("RegExp.prototype.exec"),r=Gi();return Os=function(i){if(!e(i))throw new r("`regex` must be a RegExp");return function(s){return t(i,s)!==null}},Os}var Fs,au;function l0(){if(au)return Fs;au=1;var l=oi(),e=a0(),t=e(/^\s*(?:function)?\*/),r=Ao()(),o=Ga(),i=l("Object.prototype.toString"),n=l("Function.prototype.toString"),s=function(){if(!r)return!1;try{return Function("return function*() {}")()}catch{}},a;return Fs=function(u){if(typeof u!="function")return!1;if(t(n(u)))return!0;if(!r){var h=i(u);return h==="[object GeneratorFunction]"}if(!o)return!1;if(typeof a>"u"){var f=s();a=f?o(f):!1}return o(u)===a},Fs}var Ps,lu;function u0(){if(lu)return Ps;lu=1;var l=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,r;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw r}}),r={},e(function(){throw 42},null,t)}catch(m){m!==r&&(e=null)}else e=null;var o=/^\s*class\b/,i=function(g){try{var S=l.call(g);return o.test(S)}catch{return!1}},n=function(g){try{return i(g)?!1:(l.call(g),!0)}catch{return!1}},s=Object.prototype.toString,a="[object Object]",c="[object Function]",u="[object GeneratorFunction]",h="[object HTMLAllCollection]",f="[object HTML document.all class]",d="[object HTMLCollection]",p=typeof Symbol=="function"&&!!Symbol.toStringTag,y=!(0 in[,]),x=function(){return!1};if(typeof document=="object"){var v=document.all;s.call(v)===s.call(document.all)&&(x=function(g){if((y||!g)&&(typeof g>"u"||typeof g=="object"))try{var S=s.call(g);return(S===h||S===f||S===d||S===a)&&g("")==null}catch{}return!1})}return Ps=e?function(g){if(x(g))return!0;if(!g||typeof g!="function"&&typeof g!="object")return!1;try{e(g,null,t)}catch(S){if(S!==r)return!1}return!i(g)&&n(g)}:function(g){if(x(g))return!0;if(!g||typeof g!="function"&&typeof g!="object")return!1;if(p)return n(g);if(i(g))return!1;var S=s.call(g);return S!==c&&S!==u&&!/^\[object HTML/.test(S)?!1:n(g)},Ps}var Is,uu;function c0(){if(uu)return Is;uu=1;var l=u0(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,r=function(a,c,u){for(var h=0,f=a.length;h<f;h++)t.call(a,h)&&(u==null?c(a[h],h,a):c.call(u,a[h],h,a))},o=function(a,c,u){for(var h=0,f=a.length;h<f;h++)u==null?c(a.charAt(h),h,a):c.call(u,a.charAt(h),h,a)},i=function(a,c,u){for(var h in a)t.call(a,h)&&(u==null?c(a[h],h,a):c.call(u,a[h],h,a))};function n(s){return e.call(s)==="[object Array]"}return Is=function(a,c,u){if(!l(c))throw new TypeError("iterator must be a function");var h;arguments.length>=3&&(h=u),n(a)?r(a,c,h):typeof a=="string"?o(a,c,h):i(a,c,h)},Is}var Ds,cu;function h0(){return cu||(cu=1,Ds=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),Ds}var Ls,hu;function f0(){if(hu)return Ls;hu=1;var l=h0(),e=typeof globalThis>"u"?id:globalThis;return Ls=function(){for(var r=[],o=0;o<l.length;o++)typeof e[l[o]]=="function"&&(r[r.length]=l[o]);return r},Ls}var Bs={exports:{}},Ms,fu;function cd(){if(fu)return Ms;fu=1;var l=Co(),e=od(),t=Gi(),r=ii();return Ms=function(i,n,s){if(!i||typeof i!="object"&&typeof i!="function")throw new t("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,h=arguments.length>6?arguments[6]:!1,f=!!r&&r(i,n);if(l)l(i,n,{configurable:u===null&&f?f.configurable:!u,enumerable:a===null&&f?f.enumerable:!a,value:s,writable:c===null&&f?f.writable:!c});else if(h||!a&&!c&&!u)i[n]=s;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Ms}var ks,du;function hd(){if(du)return ks;du=1;var l=Co(),e=function(){return!!l};return e.hasArrayLengthDefineBug=function(){if(!l)return null;try{return l([],"length",{value:1}).length!==1}catch{return!0}},ks=e,ks}var zs,pu;function d0(){if(pu)return zs;pu=1;var l=Ya(),e=cd(),t=hd()(),r=ii(),o=Gi(),i=l("%Math.floor%");return zs=function(s,a){if(typeof s!="function")throw new o("`fn` is not a function");if(typeof a!="number"||a<0||a>4294967295||i(a)!==a)throw new o("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],u=!0,h=!0;if("length"in s&&r){var f=r(s,"length");f&&!f.configurable&&(u=!1),f&&!f.writable&&(h=!1)}return(u||h||!c)&&(t?e(s,"length",a,!0,!0):e(s,"length",a)),s},zs}var js,xu;function p0(){if(xu)return js;xu=1;var l=Yi(),e=Va(),t=ld();return js=function(){return t(l,e,arguments)},js}var mu;function Eo(){return mu||(mu=1,function(l){var e=d0(),t=Co(),r=Wa(),o=p0();l.exports=function(n){var s=r(arguments),a=n.length-(arguments.length-1);return e(s,1+(a>0?a:0),!0)},t?t(l.exports,"apply",{value:o}):l.exports.apply=o}(Bs)),Bs.exports}var qs,gu;function fd(){if(gu)return qs;gu=1;var l=c0(),e=f0(),t=Eo(),r=oi(),o=ii(),i=Ga(),n=r("Object.prototype.toString"),s=Ao()(),a=typeof globalThis>"u"?id:globalThis,c=e(),u=r("String.prototype.slice"),h=r("Array.prototype.indexOf",!0)||function(x,v){for(var m=0;m<x.length;m+=1)if(x[m]===v)return m;return-1},f={__proto__:null};s&&o&&i?l(c,function(y){var x=new a[y];if(Symbol.toStringTag in x&&i){var v=i(x),m=o(v,Symbol.toStringTag);if(!m&&v){var g=i(v);m=o(g,Symbol.toStringTag)}f["$"+y]=t(m.get)}}):l(c,function(y){var x=new a[y],v=x.slice||x.set;v&&(f["$"+y]=t(v))});var d=function(x){var v=!1;return l(f,function(m,g){if(!v)try{"$"+m(x)===g&&(v=u(g,1))}catch{}}),v},p=function(x){var v=!1;return l(f,function(m,g){if(!v)try{m(x),v=u(g,1)}catch{}}),v};return qs=function(x){if(!x||typeof x!="object")return!1;if(!s){var v=u(n(x),8,-1);return h(c,v)>-1?v:v!=="Object"?!1:p(x)}return o?d(x):null},qs}var Hs,yu;function x0(){if(yu)return Hs;yu=1;var l=fd();return Hs=function(t){return!!l(t)},Hs}var vu;function m0(){return vu||(vu=1,function(l){var e=o0(),t=l0(),r=fd(),o=x0();function i(q){return q.call.bind(q)}var n=typeof BigInt<"u",s=typeof Symbol<"u",a=i(Object.prototype.toString),c=i(Number.prototype.valueOf),u=i(String.prototype.valueOf),h=i(Boolean.prototype.valueOf);if(n)var f=i(BigInt.prototype.valueOf);if(s)var d=i(Symbol.prototype.valueOf);function p(q,X){if(typeof q!="object")return!1;try{return X(q),!0}catch{return!1}}l.isArgumentsObject=e,l.isGeneratorFunction=t,l.isTypedArray=o;function y(q){return typeof Promise<"u"&&q instanceof Promise||q!==null&&typeof q=="object"&&typeof q.then=="function"&&typeof q.catch=="function"}l.isPromise=y;function x(q){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(q):o(q)||_(q)}l.isArrayBufferView=x;function v(q){return r(q)==="Uint8Array"}l.isUint8Array=v;function m(q){return r(q)==="Uint8ClampedArray"}l.isUint8ClampedArray=m;function g(q){return r(q)==="Uint16Array"}l.isUint16Array=g;function S(q){return r(q)==="Uint32Array"}l.isUint32Array=S;function C(q){return r(q)==="Int8Array"}l.isInt8Array=C;function A(q){return r(q)==="Int16Array"}l.isInt16Array=A;function b(q){return r(q)==="Int32Array"}l.isInt32Array=b;function R(q){return r(q)==="Float32Array"}l.isFloat32Array=R;function w(q){return r(q)==="Float64Array"}l.isFloat64Array=w;function P(q){return r(q)==="BigInt64Array"}l.isBigInt64Array=P;function M(q){return r(q)==="BigUint64Array"}l.isBigUint64Array=M;function D(q){return a(q)==="[object Map]"}D.working=typeof Map<"u"&&D(new Map);function U(q){return typeof Map>"u"?!1:D.working?D(q):q instanceof Map}l.isMap=U;function J(q){return a(q)==="[object Set]"}J.working=typeof Set<"u"&&J(new Set);function te(q){return typeof Set>"u"?!1:J.working?J(q):q instanceof Set}l.isSet=te;function le(q){return a(q)==="[object WeakMap]"}le.working=typeof WeakMap<"u"&&le(new WeakMap);function ge(q){return typeof WeakMap>"u"?!1:le.working?le(q):q instanceof WeakMap}l.isWeakMap=ge;function ce(q){return a(q)==="[object WeakSet]"}ce.working=typeof WeakSet<"u"&&ce(new WeakSet);function ee(q){return ce(q)}l.isWeakSet=ee;function G(q){return a(q)==="[object ArrayBuffer]"}G.working=typeof ArrayBuffer<"u"&&G(new ArrayBuffer);function Q(q){return typeof ArrayBuffer>"u"?!1:G.working?G(q):q instanceof ArrayBuffer}l.isArrayBuffer=Q;function ie(q){return a(q)==="[object DataView]"}ie.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&ie(new DataView(new ArrayBuffer(1),0,1));function _(q){return typeof DataView>"u"?!1:ie.working?ie(q):q instanceof DataView}l.isDataView=_;var E=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function T(q){return a(q)==="[object SharedArrayBuffer]"}function N(q){return typeof E>"u"?!1:(typeof T.working>"u"&&(T.working=T(new E)),T.working?T(q):q instanceof E)}l.isSharedArrayBuffer=N;function F(q){return a(q)==="[object AsyncFunction]"}l.isAsyncFunction=F;function O(q){return a(q)==="[object Map Iterator]"}l.isMapIterator=O;function I(q){return a(q)==="[object Set Iterator]"}l.isSetIterator=I;function j(q){return a(q)==="[object Generator]"}l.isGeneratorObject=j;function $(q){return a(q)==="[object WebAssembly.Module]"}l.isWebAssemblyCompiledModule=$;function W(q){return p(q,c)}l.isNumberObject=W;function L(q){return p(q,u)}l.isStringObject=L;function B(q){return p(q,h)}l.isBooleanObject=B;function H(q){return n&&p(q,f)}l.isBigIntObject=H;function Y(q){return s&&p(q,d)}l.isSymbolObject=Y;function re(q){return W(q)||L(q)||B(q)||H(q)||Y(q)}l.isBoxedPrimitive=re;function ne(q){return typeof Uint8Array<"u"&&(Q(q)||N(q))}l.isAnyArrayBuffer=ne,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(q){Object.defineProperty(l,q,{enumerable:!1,value:function(){throw new Error(q+" is not supported in userland")}})})}(Vo)),Vo}var Us,Su;function g0(){return Su||(Su=1,Us=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),Us}var io={exports:{}},Au;function y0(){return Au||(Au=1,typeof Object.create=="function"?io.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:io.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}),io.exports}var Cu;function Jn(){return Cu||(Cu=1,function(l){var e={},t=Object.getOwnPropertyDescriptors||function(E){for(var T=Object.keys(E),N={},F=0;F<T.length;F++)N[T[F]]=Object.getOwnPropertyDescriptor(E,T[F]);return N},r=/%[sdj%]/g;l.format=function(_){if(!A(_)){for(var E=[],T=0;T<arguments.length;T++)E.push(s(arguments[T]));return E.join(" ")}for(var T=1,N=arguments,F=N.length,O=String(_).replace(r,function(j){if(j==="%%")return"%";if(T>=F)return j;switch(j){case"%s":return String(N[T++]);case"%d":return Number(N[T++]);case"%j":try{return JSON.stringify(N[T++])}catch{return"[Circular]"}default:return j}}),I=N[T];T<F;I=N[++T])g(I)||!P(I)?O+=" "+I:O+=" "+s(I);return O},l.deprecate=function(_,E){if(typeof process<"u"&&process.noDeprecation===!0)return _;if(typeof process>"u")return function(){return l.deprecate(_,E).apply(this,arguments)};var T=!1;function N(){if(!T){if(process.throwDeprecation)throw new Error(E);process.traceDeprecation?console.trace(E):console.error(E),T=!0}return _.apply(this,arguments)}return N};var o={},i=/^$/;if(e.NODE_DEBUG){var n=e.NODE_DEBUG;n=n.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),i=new RegExp("^"+n+"$","i")}l.debuglog=function(_){if(_=_.toUpperCase(),!o[_])if(i.test(_)){var E=process.pid;o[_]=function(){var T=l.format.apply(l,arguments);console.error("%s %d: %s",_,E,T)}}else o[_]=function(){};return o[_]};function s(_,E){var T={seen:[],stylize:c};return arguments.length>=3&&(T.depth=arguments[2]),arguments.length>=4&&(T.colors=arguments[3]),m(E)?T.showHidden=E:E&&l._extend(T,E),R(T.showHidden)&&(T.showHidden=!1),R(T.depth)&&(T.depth=2),R(T.colors)&&(T.colors=!1),R(T.customInspect)&&(T.customInspect=!0),T.colors&&(T.stylize=a),h(T,_,T.depth)}l.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function a(_,E){var T=s.styles[E];return T?"\x1B["+s.colors[T][0]+"m"+_+"\x1B["+s.colors[T][1]+"m":_}function c(_,E){return _}function u(_){var E={};return _.forEach(function(T,N){E[T]=!0}),E}function h(_,E,T){if(_.customInspect&&E&&U(E.inspect)&&E.inspect!==l.inspect&&!(E.constructor&&E.constructor.prototype===E)){var N=E.inspect(T,_);return A(N)||(N=h(_,N,T)),N}var F=f(_,E);if(F)return F;var O=Object.keys(E),I=u(O);if(_.showHidden&&(O=Object.getOwnPropertyNames(E)),D(E)&&(O.indexOf("message")>=0||O.indexOf("description")>=0))return d(E);if(O.length===0){if(U(E)){var j=E.name?": "+E.name:"";return _.stylize("[Function"+j+"]","special")}if(w(E))return _.stylize(RegExp.prototype.toString.call(E),"regexp");if(M(E))return _.stylize(Date.prototype.toString.call(E),"date");if(D(E))return d(E)}var $="",W=!1,L=["{","}"];if(v(E)&&(W=!0,L=["[","]"]),U(E)){var B=E.name?": "+E.name:"";$=" [Function"+B+"]"}if(w(E)&&($=" "+RegExp.prototype.toString.call(E)),M(E)&&($=" "+Date.prototype.toUTCString.call(E)),D(E)&&($=" "+d(E)),O.length===0&&(!W||E.length==0))return L[0]+$+L[1];if(T<0)return w(E)?_.stylize(RegExp.prototype.toString.call(E),"regexp"):_.stylize("[Object]","special");_.seen.push(E);var H;return W?H=p(_,E,T,I,O):H=O.map(function(Y){return y(_,E,T,I,Y,W)}),_.seen.pop(),x(H,$,L)}function f(_,E){if(R(E))return _.stylize("undefined","undefined");if(A(E)){var T="'"+JSON.stringify(E).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return _.stylize(T,"string")}if(C(E))return _.stylize(""+E,"number");if(m(E))return _.stylize(""+E,"boolean");if(g(E))return _.stylize("null","null")}function d(_){return"["+Error.prototype.toString.call(_)+"]"}function p(_,E,T,N,F){for(var O=[],I=0,j=E.length;I<j;++I)ee(E,String(I))?O.push(y(_,E,T,N,String(I),!0)):O.push("");return F.forEach(function($){$.match(/^\d+$/)||O.push(y(_,E,T,N,$,!0))}),O}function y(_,E,T,N,F,O){var I,j,$;if($=Object.getOwnPropertyDescriptor(E,F)||{value:E[F]},$.get?$.set?j=_.stylize("[Getter/Setter]","special"):j=_.stylize("[Getter]","special"):$.set&&(j=_.stylize("[Setter]","special")),ee(N,F)||(I="["+F+"]"),j||(_.seen.indexOf($.value)<0?(g(T)?j=h(_,$.value,null):j=h(_,$.value,T-1),j.indexOf(`
`)>-1&&(O?j=j.split(`
`).map(function(W){return"  "+W}).join(`
`).slice(2):j=`
`+j.split(`
`).map(function(W){return"   "+W}).join(`
`))):j=_.stylize("[Circular]","special")),R(I)){if(O&&F.match(/^\d+$/))return j;I=JSON.stringify(""+F),I.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(I=I.slice(1,-1),I=_.stylize(I,"name")):(I=I.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),I=_.stylize(I,"string"))}return I+": "+j}function x(_,E,T){var N=_.reduce(function(F,O){return O.indexOf(`
`)>=0,F+O.replace(/\u001b\[\d\d?m/g,"").length+1},0);return N>60?T[0]+(E===""?"":E+`
 `)+" "+_.join(`,
  `)+" "+T[1]:T[0]+E+" "+_.join(", ")+" "+T[1]}l.types=m0();function v(_){return Array.isArray(_)}l.isArray=v;function m(_){return typeof _=="boolean"}l.isBoolean=m;function g(_){return _===null}l.isNull=g;function S(_){return _==null}l.isNullOrUndefined=S;function C(_){return typeof _=="number"}l.isNumber=C;function A(_){return typeof _=="string"}l.isString=A;function b(_){return typeof _=="symbol"}l.isSymbol=b;function R(_){return _===void 0}l.isUndefined=R;function w(_){return P(_)&&te(_)==="[object RegExp]"}l.isRegExp=w,l.types.isRegExp=w;function P(_){return typeof _=="object"&&_!==null}l.isObject=P;function M(_){return P(_)&&te(_)==="[object Date]"}l.isDate=M,l.types.isDate=M;function D(_){return P(_)&&(te(_)==="[object Error]"||_ instanceof Error)}l.isError=D,l.types.isNativeError=D;function U(_){return typeof _=="function"}l.isFunction=U;function J(_){return _===null||typeof _=="boolean"||typeof _=="number"||typeof _=="string"||typeof _=="symbol"||typeof _>"u"}l.isPrimitive=J,l.isBuffer=g0();function te(_){return Object.prototype.toString.call(_)}function le(_){return _<10?"0"+_.toString(10):_.toString(10)}var ge=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ce(){var _=new Date,E=[le(_.getHours()),le(_.getMinutes()),le(_.getSeconds())].join(":");return[_.getDate(),ge[_.getMonth()],E].join(" ")}l.log=function(){console.log("%s - %s",ce(),l.format.apply(l,arguments))},l.inherits=y0(),l._extend=function(_,E){if(!E||!P(E))return _;for(var T=Object.keys(E),N=T.length;N--;)_[T[N]]=E[T[N]];return _};function ee(_,E){return Object.prototype.hasOwnProperty.call(_,E)}var G=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;l.promisify=function(E){if(typeof E!="function")throw new TypeError('The "original" argument must be of type Function');if(G&&E[G]){var T=E[G];if(typeof T!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(T,G,{value:T,enumerable:!1,writable:!1,configurable:!0}),T}function T(){for(var N,F,O=new Promise(function($,W){N=$,F=W}),I=[],j=0;j<arguments.length;j++)I.push(arguments[j]);I.push(function($,W){$?F($):N(W)});try{E.apply(this,I)}catch($){F($)}return O}return Object.setPrototypeOf(T,Object.getPrototypeOf(E)),G&&Object.defineProperty(T,G,{value:T,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(T,t(E))},l.promisify.custom=G;function Q(_,E){if(!_){var T=new Error("Promise was rejected with a falsy value");T.reason=_,_=T}return E(_)}function ie(_){if(typeof _!="function")throw new TypeError('The "original" argument must be of type Function');function E(){for(var T=[],N=0;N<arguments.length;N++)T.push(arguments[N]);var F=T.pop();if(typeof F!="function")throw new TypeError("The last argument must be of type Function");var O=this,I=function(){return F.apply(O,arguments)};_.apply(this,T).then(function(j){process.nextTick(I.bind(null,null,j))},function(j){process.nextTick(Q.bind(null,j,I))})}return Object.setPrototypeOf(E,Object.getPrototypeOf(_)),Object.defineProperties(E,t(_)),E}l.callbackify=ie}($o)),$o}var Eu;function dd(){if(Eu)return Uo;Eu=1;function l(m){"@babel/helpers - typeof";return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(m)}function e(m,g,S){return Object.defineProperty(m,"prototype",{writable:!1}),m}function t(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function r(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),Object.defineProperty(m,"prototype",{writable:!1}),g&&o(m,g)}function o(m,g){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(C,A){return C.__proto__=A,C},o(m,g)}function i(m){var g=a();return function(){var C=c(m),A;if(g){var b=c(this).constructor;A=Reflect.construct(C,arguments,b)}else A=C.apply(this,arguments);return n(this,A)}}function n(m,g){if(g&&(l(g)==="object"||typeof g=="function"))return g;if(g!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s(m)}function s(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}function a(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function c(m){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(S){return S.__proto__||Object.getPrototypeOf(S)},c(m)}var u={},h,f;function d(m,g,S){S||(S=Error);function C(b,R,w){return typeof g=="string"?g:g(b,R,w)}var A=function(b){r(w,b);var R=i(w);function w(P,M,D){var U;return t(this,w),U=R.call(this,C(P,M,D)),U.code=m,U}return e(w)}(S);u[m]=A}function p(m,g){if(Array.isArray(m)){var S=m.length;return m=m.map(function(C){return String(C)}),S>2?"one of ".concat(g," ").concat(m.slice(0,S-1).join(", "),", or ")+m[S-1]:S===2?"one of ".concat(g," ").concat(m[0]," or ").concat(m[1]):"of ".concat(g," ").concat(m[0])}else return"of ".concat(g," ").concat(String(m))}function y(m,g,S){return m.substr(0,g.length)===g}function x(m,g,S){return(S===void 0||S>m.length)&&(S=m.length),m.substring(S-g.length,S)===g}function v(m,g,S){return typeof S!="number"&&(S=0),S+g.length>m.length?!1:m.indexOf(g,S)!==-1}return d("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),d("ERR_INVALID_ARG_TYPE",function(m,g,S){h===void 0&&(h=Ve()),h(typeof m=="string","'name' must be a string");var C;typeof g=="string"&&y(g,"not ")?(C="must not be",g=g.replace(/^not /,"")):C="must be";var A;if(x(m," argument"))A="The ".concat(m," ").concat(C," ").concat(p(g,"type"));else{var b=v(m,".")?"property":"argument";A='The "'.concat(m,'" ').concat(b," ").concat(C," ").concat(p(g,"type"))}return A+=". Received type ".concat(l(S)),A},TypeError),d("ERR_INVALID_ARG_VALUE",function(m,g){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";f===void 0&&(f=Jn());var C=f.inspect(g);return C.length>128&&(C="".concat(C.slice(0,128),"...")),"The argument '".concat(m,"' ").concat(S,". Received ").concat(C)},TypeError),d("ERR_INVALID_RETURN_VALUE",function(m,g,S){var C;return S&&S.constructor&&S.constructor.name?C="instance of ".concat(S.constructor.name):C="type ".concat(l(S)),"Expected ".concat(m,' to be returned from the "').concat(g,'"')+" function but got ".concat(C,".")},TypeError),d("ERR_MISSING_ARGS",function(){for(var m=arguments.length,g=new Array(m),S=0;S<m;S++)g[S]=arguments[S];h===void 0&&(h=Ve()),h(g.length>0,"At least one arg needs to be specified");var C="The ",A=g.length;switch(g=g.map(function(b){return'"'.concat(b,'"')}),A){case 1:C+="".concat(g[0]," argument");break;case 2:C+="".concat(g[0]," and ").concat(g[1]," arguments");break;default:C+=g.slice(0,A-1).join(", "),C+=", and ".concat(g[A-1]," arguments");break}return"".concat(C," must be specified")},TypeError),Uo.codes=u,Uo}var $s,_u;function v0(){if(_u)return $s;_u=1;function l(ee,G){var Q=Object.keys(ee);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(ee);G&&(ie=ie.filter(function(_){return Object.getOwnPropertyDescriptor(ee,_).enumerable})),Q.push.apply(Q,ie)}return Q}function e(ee){for(var G=1;G<arguments.length;G++){var Q=arguments[G]!=null?arguments[G]:{};G%2?l(Object(Q),!0).forEach(function(ie){t(ee,ie,Q[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(Q)):l(Object(Q)).forEach(function(ie){Object.defineProperty(ee,ie,Object.getOwnPropertyDescriptor(Q,ie))})}return ee}function t(ee,G,Q){return G=n(G),G in ee?Object.defineProperty(ee,G,{value:Q,enumerable:!0,configurable:!0,writable:!0}):ee[G]=Q,ee}function r(ee,G){if(!(ee instanceof G))throw new TypeError("Cannot call a class as a function")}function o(ee,G){for(var Q=0;Q<G.length;Q++){var ie=G[Q];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(ee,n(ie.key),ie)}}function i(ee,G,Q){return G&&o(ee.prototype,G),Object.defineProperty(ee,"prototype",{writable:!1}),ee}function n(ee){var G=s(ee,"string");return m(G)==="symbol"?G:String(G)}function s(ee,G){if(m(ee)!=="object"||ee===null)return ee;var Q=ee[Symbol.toPrimitive];if(Q!==void 0){var ie=Q.call(ee,G);if(m(ie)!=="object")return ie;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ee)}function a(ee,G){if(typeof G!="function"&&G!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(G&&G.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),Object.defineProperty(ee,"prototype",{writable:!1}),G&&x(ee,G)}function c(ee){var G=p();return function(){var ie=v(ee),_;if(G){var E=v(this).constructor;_=Reflect.construct(ie,arguments,E)}else _=ie.apply(this,arguments);return u(this,_)}}function u(ee,G){if(G&&(m(G)==="object"||typeof G=="function"))return G;if(G!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(ee)}function h(ee){if(ee===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee}function f(ee){var G=typeof Map=="function"?new Map:void 0;return f=function(ie){if(ie===null||!y(ie))return ie;if(typeof ie!="function")throw new TypeError("Super expression must either be null or a function");if(typeof G<"u"){if(G.has(ie))return G.get(ie);G.set(ie,_)}function _(){return d(ie,arguments,v(this).constructor)}return _.prototype=Object.create(ie.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),x(_,ie)},f(ee)}function d(ee,G,Q){return p()?d=Reflect.construct.bind():d=function(_,E,T){var N=[null];N.push.apply(N,E);var F=Function.bind.apply(_,N),O=new F;return T&&x(O,T.prototype),O},d.apply(null,arguments)}function p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y(ee){return Function.toString.call(ee).indexOf("[native code]")!==-1}function x(ee,G){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ie,_){return ie.__proto__=_,ie},x(ee,G)}function v(ee){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Q){return Q.__proto__||Object.getPrototypeOf(Q)},v(ee)}function m(ee){"@babel/helpers - typeof";return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},m(ee)}var g=Jn(),S=g.inspect,C=dd(),A=C.codes.ERR_INVALID_ARG_TYPE;function b(ee,G,Q){return(Q===void 0||Q>ee.length)&&(Q=ee.length),ee.substring(Q-G.length,Q)===G}function R(ee,G){if(G=Math.floor(G),ee.length==0||G==0)return"";var Q=ee.length*G;for(G=Math.floor(Math.log(G)/Math.log(2));G;)ee+=ee,G--;return ee+=ee.substring(0,Q-ee.length),ee}var w="",P="",M="",D="",U={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},J=10;function te(ee){var G=Object.keys(ee),Q=Object.create(Object.getPrototypeOf(ee));return G.forEach(function(ie){Q[ie]=ee[ie]}),Object.defineProperty(Q,"message",{value:ee.message}),Q}function le(ee){return S(ee,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function ge(ee,G,Q){var ie="",_="",E=0,T="",N=!1,F=le(ee),O=F.split(`
`),I=le(G).split(`
`),j=0,$="";if(Q==="strictEqual"&&m(ee)==="object"&&m(G)==="object"&&ee!==null&&G!==null&&(Q="strictEqualObject"),O.length===1&&I.length===1&&O[0]!==I[0]){var W=O[0].length+I[0].length;if(W<=J){if((m(ee)!=="object"||ee===null)&&(m(G)!=="object"||G===null)&&(ee!==0||G!==0))return"".concat(U[Q],`

`)+"".concat(O[0]," !== ").concat(I[0],`
`)}else if(Q!=="strictEqualObject"){var L=process.stderr&&process.stderr.isTTY?process.stderr.columns:80;if(W<L){for(;O[0][j]===I[0][j];)j++;j>2&&($=`
  `.concat(R(" ",j),"^"),j=0)}}}for(var B=O[O.length-1],H=I[I.length-1];B===H&&(j++<2?T=`
  `.concat(B).concat(T):ie=B,O.pop(),I.pop(),!(O.length===0||I.length===0));)B=O[O.length-1],H=I[I.length-1];var Y=Math.max(O.length,I.length);if(Y===0){var re=F.split(`
`);if(re.length>30)for(re[26]="".concat(w,"...").concat(D);re.length>27;)re.pop();return"".concat(U.notIdentical,`

`).concat(re.join(`
`),`
`)}j>3&&(T=`
`.concat(w,"...").concat(D).concat(T),N=!0),ie!==""&&(T=`
  `.concat(ie).concat(T),ie="");var ne=0,q=U[Q]+`
`.concat(P,"+ actual").concat(D," ").concat(M,"- expected").concat(D),X=" ".concat(w,"...").concat(D," Lines skipped");for(j=0;j<Y;j++){var he=j-E;if(O.length<j+1)he>1&&j>2&&(he>4?(_+=`
`.concat(w,"...").concat(D),N=!0):he>3&&(_+=`
  `.concat(I[j-2]),ne++),_+=`
  `.concat(I[j-1]),ne++),E=j,ie+=`
`.concat(M,"-").concat(D," ").concat(I[j]),ne++;else if(I.length<j+1)he>1&&j>2&&(he>4?(_+=`
`.concat(w,"...").concat(D),N=!0):he>3&&(_+=`
  `.concat(O[j-2]),ne++),_+=`
  `.concat(O[j-1]),ne++),E=j,_+=`
`.concat(P,"+").concat(D," ").concat(O[j]),ne++;else{var be=I[j],Re=O[j],z=Re!==be&&(!b(Re,",")||Re.slice(0,-1)!==be);z&&b(be,",")&&be.slice(0,-1)===Re&&(z=!1,Re+=","),z?(he>1&&j>2&&(he>4?(_+=`
`.concat(w,"...").concat(D),N=!0):he>3&&(_+=`
  `.concat(O[j-2]),ne++),_+=`
  `.concat(O[j-1]),ne++),E=j,_+=`
`.concat(P,"+").concat(D," ").concat(Re),ie+=`
`.concat(M,"-").concat(D," ").concat(be),ne+=2):(_+=ie,ie="",(he===1||j===0)&&(_+=`
  `.concat(Re),ne++))}if(ne>20&&j<Y-2)return"".concat(q).concat(X,`
`).concat(_,`
`).concat(w,"...").concat(D).concat(ie,`
`)+"".concat(w,"...").concat(D)}return"".concat(q).concat(N?X:"",`
`).concat(_).concat(ie).concat(T).concat($)}var ce=function(ee,G){a(ie,ee);var Q=c(ie);function ie(_){var E;if(r(this,ie),m(_)!=="object"||_===null)throw new A("options","Object",_);var T=_.message,N=_.operator,F=_.stackStartFn,O=_.actual,I=_.expected,j=Error.stackTraceLimit;if(Error.stackTraceLimit=0,T!=null)E=Q.call(this,String(T));else if(process.stderr&&process.stderr.isTTY&&(process.stderr&&process.stderr.getColorDepth&&process.stderr.getColorDepth()!==1?(w="\x1B[34m",P="\x1B[32m",D="\x1B[39m",M="\x1B[31m"):(w="",P="",D="",M="")),m(O)==="object"&&O!==null&&m(I)==="object"&&I!==null&&"stack"in O&&O instanceof Error&&"stack"in I&&I instanceof Error&&(O=te(O),I=te(I)),N==="deepStrictEqual"||N==="strictEqual")E=Q.call(this,ge(O,I,N));else if(N==="notDeepStrictEqual"||N==="notStrictEqual"){var $=U[N],W=le(O).split(`
`);if(N==="notStrictEqual"&&m(O)==="object"&&O!==null&&($=U.notStrictEqualObject),W.length>30)for(W[26]="".concat(w,"...").concat(D);W.length>27;)W.pop();W.length===1?E=Q.call(this,"".concat($," ").concat(W[0])):E=Q.call(this,"".concat($,`

`).concat(W.join(`
`),`
`))}else{var L=le(O),B="",H=U[N];N==="notDeepEqual"||N==="notEqual"?(L="".concat(U[N],`

`).concat(L),L.length>1024&&(L="".concat(L.slice(0,1021),"..."))):(B="".concat(le(I)),L.length>512&&(L="".concat(L.slice(0,509),"...")),B.length>512&&(B="".concat(B.slice(0,509),"...")),N==="deepEqual"||N==="equal"?L="".concat(H,`

`).concat(L,`

should equal

`):B=" ".concat(N," ").concat(B)),E=Q.call(this,"".concat(L).concat(B))}return Error.stackTraceLimit=j,E.generatedMessage=!T,Object.defineProperty(h(E),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),E.code="ERR_ASSERTION",E.actual=O,E.expected=I,E.operator=N,Error.captureStackTrace&&Error.captureStackTrace(h(E),F),E.stack,E.name="AssertionError",u(E)}return i(ie,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:G,value:function(E,T){return S(this,e(e({},T),{},{customInspect:!1,depth:0}))}}]),ie}(f(Error),S.custom);return $s=ce,$s}var Vs,Tu;function pd(){if(Tu)return Vs;Tu=1;var l=Object.prototype.toString;return Vs=function(t){var r=l.call(t),o=r==="[object Arguments]";return o||(o=r!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&l.call(t.callee)==="[object Function]"),o},Vs}var Ws,bu;function S0(){if(bu)return Ws;bu=1;var l;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,r=pd(),o=Object.prototype.propertyIsEnumerable,i=!o.call({toString:null},"toString"),n=o.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=function(f){var d=f.constructor;return d&&d.prototype===f},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},u=function(){if(typeof window>"u")return!1;for(var f in window)try{if(!c["$"+f]&&e.call(window,f)&&window[f]!==null&&typeof window[f]=="object")try{a(window[f])}catch{return!0}}catch{return!0}return!1}(),h=function(f){if(typeof window>"u"||!u)return a(f);try{return a(f)}catch{return!1}};l=function(d){var p=d!==null&&typeof d=="object",y=t.call(d)==="[object Function]",x=r(d),v=p&&t.call(d)==="[object String]",m=[];if(!p&&!y&&!x)throw new TypeError("Object.keys called on a non-object");var g=n&&y;if(v&&d.length>0&&!e.call(d,0))for(var S=0;S<d.length;++S)m.push(String(S));if(x&&d.length>0)for(var C=0;C<d.length;++C)m.push(String(C));else for(var A in d)!(g&&A==="prototype")&&e.call(d,A)&&m.push(String(A));if(i)for(var b=h(d),R=0;R<s.length;++R)!(b&&s[R]==="constructor")&&e.call(d,s[R])&&m.push(s[R]);return m}}return Ws=l,Ws}var Gs,Ru;function xd(){if(Ru)return Gs;Ru=1;var l=Array.prototype.slice,e=pd(),t=Object.keys,r=t?function(n){return t(n)}:S0(),o=Object.keys;return r.shim=function(){if(Object.keys){var n=function(){var s=Object.keys(arguments);return s&&s.length===arguments.length}(1,2);n||(Object.keys=function(a){return e(a)?o(l.call(a)):o(a)})}else Object.keys=r;return Object.keys||r},Gs=r,Gs}var Ys,wu;function A0(){if(wu)return Ys;wu=1;var l=xd(),e=Ha()(),t=oi(),r=Ua(),o=t("Array.prototype.push"),i=t("Object.prototype.propertyIsEnumerable"),n=e?r.getOwnPropertySymbols:null;return Ys=function(a,c){if(a==null)throw new TypeError("target must be an object");var u=r(a);if(arguments.length===1)return u;for(var h=1;h<arguments.length;++h){var f=r(arguments[h]),d=l(f),p=e&&(r.getOwnPropertySymbols||n);if(p)for(var y=p(f),x=0;x<y.length;++x){var v=y[x];i(f,v)&&o(d,v)}for(var m=0;m<d.length;++m){var g=d[m];if(i(f,g)){var S=f[g];u[g]=S}}}return u},Ys}var Xs,Nu;function C0(){if(Nu)return Xs;Nu=1;var l=A0(),e=function(){if(!Object.assign)return!1;for(var r="abcdefghijklmnopqrst",o=r.split(""),i={},n=0;n<o.length;++n)i[o[n]]=o[n];var s=Object.assign({},i),a="";for(var c in s)a+=c;return r!==a},t=function(){if(!Object.assign||!Object.preventExtensions)return!1;var r=Object.preventExtensions({1:2});try{Object.assign(r,"xy")}catch{return r[1]==="y"}return!1};return Xs=function(){return!Object.assign||e()||t()?l:Object.assign},Xs}var Ks,Ou;function md(){if(Ou)return Ks;Ou=1;var l=function(e){return e!==e};return Ks=function(t,r){return t===0&&r===0?1/t===1/r:!!(t===r||l(t)&&l(r))},Ks}var Qs,Fu;function Xa(){if(Fu)return Qs;Fu=1;var l=md();return Qs=function(){return typeof Object.is=="function"?Object.is:l},Qs}var Js,Pu;function E0(){if(Pu)return Js;Pu=1;var l=Ya(),e=Eo(),t=e(l("String.prototype.indexOf"));return Js=function(o,i){var n=l(o,!!i);return typeof n=="function"&&t(o,".prototype.")>-1?e(n):n},Js}var Zs,Iu;function _o(){if(Iu)return Zs;Iu=1;var l=xd(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",t=Object.prototype.toString,r=Array.prototype.concat,o=cd(),i=function(c){return typeof c=="function"&&t.call(c)==="[object Function]"},n=hd()(),s=function(c,u,h,f){if(u in c){if(f===!0){if(c[u]===h)return}else if(!i(f)||!f())return}n?o(c,u,h,!0):o(c,u,h)},a=function(c,u){var h=arguments.length>2?arguments[2]:{},f=l(u);e&&(f=r.call(f,Object.getOwnPropertySymbols(u)));for(var d=0;d<f.length;d+=1)s(c,f[d],u[f[d]],h[f[d]])};return a.supportsDescriptors=!!n,Zs=a,Zs}var ea,Du;function _0(){if(Du)return ea;Du=1;var l=Xa(),e=_o();return ea=function(){var r=l();return e(Object,{is:r},{is:function(){return Object.is!==r}}),r},ea}var ta,Lu;function T0(){if(Lu)return ta;Lu=1;var l=_o(),e=Eo(),t=md(),r=Xa(),o=_0(),i=e(r(),Object);return l(i,{getPolyfill:r,implementation:t,shim:o}),ta=i,ta}var ra,Bu;function gd(){return Bu||(Bu=1,ra=function(e){return e!==e}),ra}var na,Mu;function yd(){if(Mu)return na;Mu=1;var l=gd();return na=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:l},na}var ia,ku;function b0(){if(ku)return ia;ku=1;var l=_o(),e=yd();return ia=function(){var r=e();return l(Number,{isNaN:r},{isNaN:function(){return Number.isNaN!==r}}),r},ia}var oa,zu;function R0(){if(zu)return oa;zu=1;var l=Eo(),e=_o(),t=gd(),r=yd(),o=b0(),i=l(r(),Number);return e(i,{getPolyfill:r,implementation:t,shim:o}),oa=i,oa}var sa,ju;function w0(){if(ju)return sa;ju=1;function l(z,V){return i(z)||o(z,V)||t(z,V)||e()}function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t(z,V){if(z){if(typeof z=="string")return r(z,V);var ae=Object.prototype.toString.call(z).slice(8,-1);if(ae==="Object"&&z.constructor&&(ae=z.constructor.name),ae==="Map"||ae==="Set")return Array.from(z);if(ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ae))return r(z,V)}}function r(z,V){(V==null||V>z.length)&&(V=z.length);for(var ae=0,pe=new Array(V);ae<V;ae++)pe[ae]=z[ae];return pe}function o(z,V){var ae=z==null?null:typeof Symbol<"u"&&z[Symbol.iterator]||z["@@iterator"];if(ae!=null){var pe,xe,_e,Se,we=[],Ne=!0,ze=!1;try{if(_e=(ae=ae.call(z)).next,V!==0)for(;!(Ne=(pe=_e.call(ae)).done)&&(we.push(pe.value),we.length!==V);Ne=!0);}catch(K){ze=!0,xe=K}finally{try{if(!Ne&&ae.return!=null&&(Se=ae.return(),Object(Se)!==Se))return}finally{if(ze)throw xe}}return we}}function i(z){if(Array.isArray(z))return z}function n(z){"@babel/helpers - typeof";return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},n(z)}var s=/a/g.flags!==void 0,a=function(V){var ae=[];return V.forEach(function(pe){return ae.push(pe)}),ae},c=function(V){var ae=[];return V.forEach(function(pe,xe){return ae.push([xe,pe])}),ae},u=Object.is?Object.is:T0(),h=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},f=Number.isNaN?Number.isNaN:R0();function d(z){return z.call.bind(z)}var p=d(Object.prototype.hasOwnProperty),y=d(Object.prototype.propertyIsEnumerable),x=d(Object.prototype.toString),v=Jn().types,m=v.isAnyArrayBuffer,g=v.isArrayBufferView,S=v.isDate,C=v.isMap,A=v.isRegExp,b=v.isSet,R=v.isNativeError,w=v.isBoxedPrimitive,P=v.isNumberObject,M=v.isStringObject,D=v.isBooleanObject,U=v.isBigIntObject,J=v.isSymbolObject,te=v.isFloat32Array,le=v.isFloat64Array;function ge(z){if(z.length===0||z.length>10)return!0;for(var V=0;V<z.length;V++){var ae=z.charCodeAt(V);if(ae<48||ae>57)return!0}return z.length===10&&z>=Math.pow(2,32)}function ce(z){return Object.keys(z).filter(ge).concat(h(z).filter(Object.prototype.propertyIsEnumerable.bind(z)))}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function ee(z,V){if(z===V)return 0;for(var ae=z.length,pe=V.length,xe=0,_e=Math.min(ae,pe);xe<_e;++xe)if(z[xe]!==V[xe]){ae=z[xe],pe=V[xe];break}return ae<pe?-1:pe<ae?1:0}var G=!0,Q=!1,ie=0,_=1,E=2,T=3;function N(z,V){return s?z.source===V.source&&z.flags===V.flags:RegExp.prototype.toString.call(z)===RegExp.prototype.toString.call(V)}function F(z,V){if(z.byteLength!==V.byteLength)return!1;for(var ae=0;ae<z.byteLength;ae++)if(z[ae]!==V[ae])return!1;return!0}function O(z,V){return z.byteLength!==V.byteLength?!1:ee(new Uint8Array(z.buffer,z.byteOffset,z.byteLength),new Uint8Array(V.buffer,V.byteOffset,V.byteLength))===0}function I(z,V){return z.byteLength===V.byteLength&&ee(new Uint8Array(z),new Uint8Array(V))===0}function j(z,V){return P(z)?P(V)&&u(Number.prototype.valueOf.call(z),Number.prototype.valueOf.call(V)):M(z)?M(V)&&String.prototype.valueOf.call(z)===String.prototype.valueOf.call(V):D(z)?D(V)&&Boolean.prototype.valueOf.call(z)===Boolean.prototype.valueOf.call(V):U(z)?U(V)&&BigInt.prototype.valueOf.call(z)===BigInt.prototype.valueOf.call(V):J(V)&&Symbol.prototype.valueOf.call(z)===Symbol.prototype.valueOf.call(V)}function $(z,V,ae,pe){if(z===V)return z!==0?!0:ae?u(z,V):!0;if(ae){if(n(z)!=="object")return typeof z=="number"&&f(z)&&f(V);if(n(V)!=="object"||z===null||V===null||Object.getPrototypeOf(z)!==Object.getPrototypeOf(V))return!1}else{if(z===null||n(z)!=="object")return V===null||n(V)!=="object"?z==V:!1;if(V===null||n(V)!=="object")return!1}var xe=x(z),_e=x(V);if(xe!==_e)return!1;if(Array.isArray(z)){if(z.length!==V.length)return!1;var Se=ce(z),we=ce(V);return Se.length!==we.length?!1:L(z,V,ae,pe,_,Se)}if(xe==="[object Object]"&&(!C(z)&&C(V)||!b(z)&&b(V)))return!1;if(S(z)){if(!S(V)||Date.prototype.getTime.call(z)!==Date.prototype.getTime.call(V))return!1}else if(A(z)){if(!A(V)||!N(z,V))return!1}else if(R(z)||z instanceof Error){if(z.message!==V.message||z.name!==V.name)return!1}else if(g(z)){if(!ae&&(te(z)||le(z))){if(!F(z,V))return!1}else if(!O(z,V))return!1;var Ne=ce(z),ze=ce(V);return Ne.length!==ze.length?!1:L(z,V,ae,pe,ie,Ne)}else{if(b(z))return!b(V)||z.size!==V.size?!1:L(z,V,ae,pe,E);if(C(z))return!C(V)||z.size!==V.size?!1:L(z,V,ae,pe,T);if(m(z)){if(!I(z,V))return!1}else if(w(z)&&!j(z,V))return!1}return L(z,V,ae,pe,ie)}function W(z,V){return V.filter(function(ae){return y(z,ae)})}function L(z,V,ae,pe,xe,_e){if(arguments.length===5){_e=Object.keys(z);var Se=Object.keys(V);if(_e.length!==Se.length)return!1}for(var we=0;we<_e.length;we++)if(!p(V,_e[we]))return!1;if(ae&&arguments.length===5){var Ne=h(z);if(Ne.length!==0){var ze=0;for(we=0;we<Ne.length;we++){var K=Ne[we];if(y(z,K)){if(!y(V,K))return!1;_e.push(K),ze++}else if(y(V,K))return!1}var me=h(V);if(Ne.length!==me.length&&W(V,me).length!==ze)return!1}else{var ye=h(V);if(ye.length!==0&&W(V,ye).length!==0)return!1}}if(_e.length===0&&(xe===ie||xe===_&&z.length===0||z.size===0))return!0;if(pe===void 0)pe={val1:new Map,val2:new Map,position:0};else{var Ce=pe.val1.get(z);if(Ce!==void 0){var Pe=pe.val2.get(V);if(Pe!==void 0)return Ce===Pe}pe.position++}pe.val1.set(z,pe.position),pe.val2.set(V,pe.position);var We=he(z,V,ae,_e,pe,xe);return pe.val1.delete(z),pe.val2.delete(V),We}function B(z,V,ae,pe){for(var xe=a(z),_e=0;_e<xe.length;_e++){var Se=xe[_e];if($(V,Se,ae,pe))return z.delete(Se),!0}return!1}function H(z){switch(n(z)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":z=+z;case"number":if(f(z))return!1}return!0}function Y(z,V,ae){var pe=H(ae);return pe??(V.has(pe)&&!z.has(pe))}function re(z,V,ae,pe,xe){var _e=H(ae);if(_e!=null)return _e;var Se=V.get(_e);return Se===void 0&&!V.has(_e)||!$(pe,Se,!1,xe)?!1:!z.has(_e)&&$(pe,Se,!1,xe)}function ne(z,V,ae,pe){for(var xe=null,_e=a(z),Se=0;Se<_e.length;Se++){var we=_e[Se];if(n(we)==="object"&&we!==null)xe===null&&(xe=new Set),xe.add(we);else if(!V.has(we)){if(ae||!Y(z,V,we))return!1;xe===null&&(xe=new Set),xe.add(we)}}if(xe!==null){for(var Ne=a(V),ze=0;ze<Ne.length;ze++){var K=Ne[ze];if(n(K)==="object"&&K!==null){if(!B(xe,K,ae,pe))return!1}else if(!ae&&!z.has(K)&&!B(xe,K,ae,pe))return!1}return xe.size===0}return!0}function q(z,V,ae,pe,xe,_e){for(var Se=a(z),we=0;we<Se.length;we++){var Ne=Se[we];if($(ae,Ne,xe,_e)&&$(pe,V.get(Ne),xe,_e))return z.delete(Ne),!0}return!1}function X(z,V,ae,pe){for(var xe=null,_e=c(z),Se=0;Se<_e.length;Se++){var we=l(_e[Se],2),Ne=we[0],ze=we[1];if(n(Ne)==="object"&&Ne!==null)xe===null&&(xe=new Set),xe.add(Ne);else{var K=V.get(Ne);if(K===void 0&&!V.has(Ne)||!$(ze,K,ae,pe)){if(ae||!re(z,V,Ne,ze,pe))return!1;xe===null&&(xe=new Set),xe.add(Ne)}}}if(xe!==null){for(var me=c(V),ye=0;ye<me.length;ye++){var Ce=l(me[ye],2),Pe=Ce[0],We=Ce[1];if(n(Pe)==="object"&&Pe!==null){if(!q(xe,z,Pe,We,ae,pe))return!1}else if(!ae&&(!z.has(Pe)||!$(z.get(Pe),We,!1,pe))&&!q(xe,z,Pe,We,!1,pe))return!1}return xe.size===0}return!0}function he(z,V,ae,pe,xe,_e){var Se=0;if(_e===E){if(!ne(z,V,ae,xe))return!1}else if(_e===T){if(!X(z,V,ae,xe))return!1}else if(_e===_)for(;Se<z.length;Se++)if(p(z,Se)){if(!p(V,Se)||!$(z[Se],V[Se],ae,xe))return!1}else{if(p(V,Se))return!1;for(var we=Object.keys(z);Se<we.length;Se++){var Ne=we[Se];if(!p(V,Ne)||!$(z[Ne],V[Ne],ae,xe))return!1}return we.length===Object.keys(V).length}for(Se=0;Se<pe.length;Se++){var ze=pe[Se];if(!$(z[ze],V[ze],ae,xe))return!1}return!0}function be(z,V){return $(z,V,Q)}function Re(z,V){return $(z,V,G)}return sa={isDeepEqual:be,isDeepStrictEqual:Re},sa}var qu;function Ve(){if(qu)return Ho.exports;qu=1;function l(E){"@babel/helpers - typeof";return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},l(E)}function e(E,T,N){return Object.defineProperty(E,"prototype",{writable:!1}),E}function t(E,T){if(!(E instanceof T))throw new TypeError("Cannot call a class as a function")}var r=dd(),o=r.codes,i=o.ERR_AMBIGUOUS_ARGUMENT,n=o.ERR_INVALID_ARG_TYPE,s=o.ERR_INVALID_ARG_VALUE,a=o.ERR_INVALID_RETURN_VALUE,c=o.ERR_MISSING_ARGS,u=v0(),h=Jn(),f=h.inspect,d=Jn().types,p=d.isPromise,y=d.isRegExp,x=C0()(),v=Xa()(),m=E0()("RegExp.prototype.test"),g,S;function C(){var E=w0();g=E.isDeepEqual,S=E.isDeepStrictEqual}var A=!1,b=Ho.exports=D,R={};function w(E){throw E.message instanceof Error?E.message:new u(E)}function P(E,T,N,F,O){var I=arguments.length,j;if(I===0)j="Failed";else if(I===1)N=E,E=void 0;else{if(A===!1){A=!0;var $=process.emitWarning?process.emitWarning:console.warn.bind(console);$("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}I===2&&(F="!=")}if(N instanceof Error)throw N;var W={actual:E,expected:T,operator:F===void 0?"fail":F,stackStartFn:O||P};N!==void 0&&(W.message=N);var L=new u(W);throw j&&(L.message=j,L.generatedMessage=!0),L}b.fail=P,b.AssertionError=u;function M(E,T,N,F){if(!N){var O=!1;if(T===0)O=!0,F="No value argument passed to `assert.ok()`";else if(F instanceof Error)throw F;var I=new u({actual:N,expected:!0,message:F,operator:"==",stackStartFn:E});throw I.generatedMessage=O,I}}function D(){for(var E=arguments.length,T=new Array(E),N=0;N<E;N++)T[N]=arguments[N];M.apply(void 0,[D,T.length].concat(T))}b.ok=D,b.equal=function E(T,N,F){if(arguments.length<2)throw new c("actual","expected");T!=N&&w({actual:T,expected:N,message:F,operator:"==",stackStartFn:E})},b.notEqual=function E(T,N,F){if(arguments.length<2)throw new c("actual","expected");T==N&&w({actual:T,expected:N,message:F,operator:"!=",stackStartFn:E})},b.deepEqual=function E(T,N,F){if(arguments.length<2)throw new c("actual","expected");g===void 0&&C(),g(T,N)||w({actual:T,expected:N,message:F,operator:"deepEqual",stackStartFn:E})},b.notDeepEqual=function E(T,N,F){if(arguments.length<2)throw new c("actual","expected");g===void 0&&C(),g(T,N)&&w({actual:T,expected:N,message:F,operator:"notDeepEqual",stackStartFn:E})},b.deepStrictEqual=function E(T,N,F){if(arguments.length<2)throw new c("actual","expected");g===void 0&&C(),S(T,N)||w({actual:T,expected:N,message:F,operator:"deepStrictEqual",stackStartFn:E})},b.notDeepStrictEqual=U;function U(E,T,N){if(arguments.length<2)throw new c("actual","expected");g===void 0&&C(),S(E,T)&&w({actual:E,expected:T,message:N,operator:"notDeepStrictEqual",stackStartFn:U})}b.strictEqual=function E(T,N,F){if(arguments.length<2)throw new c("actual","expected");v(T,N)||w({actual:T,expected:N,message:F,operator:"strictEqual",stackStartFn:E})},b.notStrictEqual=function E(T,N,F){if(arguments.length<2)throw new c("actual","expected");v(T,N)&&w({actual:T,expected:N,message:F,operator:"notStrictEqual",stackStartFn:E})};var J=e(function E(T,N,F){var O=this;t(this,E),N.forEach(function(I){I in T&&(F!==void 0&&typeof F[I]=="string"&&y(T[I])&&m(T[I],F[I])?O[I]=F[I]:O[I]=T[I])})});function te(E,T,N,F,O,I){if(!(N in E)||!S(E[N],T[N])){if(!F){var j=new J(E,O),$=new J(T,O,E),W=new u({actual:j,expected:$,operator:"deepStrictEqual",stackStartFn:I});throw W.actual=E,W.expected=T,W.operator=I.name,W}w({actual:E,expected:T,message:F,operator:I.name,stackStartFn:I})}}function le(E,T,N,F){if(typeof T!="function"){if(y(T))return m(T,E);if(arguments.length===2)throw new n("expected",["Function","RegExp"],T);if(l(E)!=="object"||E===null){var O=new u({actual:E,expected:T,message:N,operator:"deepStrictEqual",stackStartFn:F});throw O.operator=F.name,O}var I=Object.keys(T);if(T instanceof Error)I.push("name","message");else if(I.length===0)throw new s("error",T,"may not be an empty object");return g===void 0&&C(),I.forEach(function(j){typeof E[j]=="string"&&y(T[j])&&m(T[j],E[j])||te(E,T,j,N,I,F)}),!0}return T.prototype!==void 0&&E instanceof T?!0:Error.isPrototypeOf(T)?!1:T.call({},E)===!0}function ge(E){if(typeof E!="function")throw new n("fn","Function",E);try{E()}catch(T){return T}return R}function ce(E){return p(E)||E!==null&&l(E)==="object"&&typeof E.then=="function"&&typeof E.catch=="function"}function ee(E){return Promise.resolve().then(function(){var T;if(typeof E=="function"){if(T=E(),!ce(T))throw new a("instance of Promise","promiseFn",T)}else if(ce(E))T=E;else throw new n("promiseFn",["Function","Promise"],E);return Promise.resolve().then(function(){return T}).then(function(){return R}).catch(function(N){return N})})}function G(E,T,N,F){if(typeof N=="string"){if(arguments.length===4)throw new n("error",["Object","Error","Function","RegExp"],N);if(l(T)==="object"&&T!==null){if(T.message===N)throw new i("error/message",'The error message "'.concat(T.message,'" is identical to the message.'))}else if(T===N)throw new i("error/message",'The error "'.concat(T,'" is identical to the message.'));F=N,N=void 0}else if(N!=null&&l(N)!=="object"&&typeof N!="function")throw new n("error",["Object","Error","Function","RegExp"],N);if(T===R){var O="";N&&N.name&&(O+=" (".concat(N.name,")")),O+=F?": ".concat(F):".";var I=E.name==="rejects"?"rejection":"exception";w({actual:void 0,expected:N,operator:E.name,message:"Missing expected ".concat(I).concat(O),stackStartFn:E})}if(N&&!le(T,N,F,E))throw T}function Q(E,T,N,F){if(T!==R){if(typeof N=="string"&&(F=N,N=void 0),!N||le(T,N)){var O=F?": ".concat(F):".",I=E.name==="doesNotReject"?"rejection":"exception";w({actual:T,expected:N,operator:E.name,message:"Got unwanted ".concat(I).concat(O,`
`)+'Actual message: "'.concat(T&&T.message,'"'),stackStartFn:E})}throw T}}b.throws=function E(T){for(var N=arguments.length,F=new Array(N>1?N-1:0),O=1;O<N;O++)F[O-1]=arguments[O];G.apply(void 0,[E,ge(T)].concat(F))},b.rejects=function E(T){for(var N=arguments.length,F=new Array(N>1?N-1:0),O=1;O<N;O++)F[O-1]=arguments[O];return ee(T).then(function(I){return G.apply(void 0,[E,I].concat(F))})},b.doesNotThrow=function E(T){for(var N=arguments.length,F=new Array(N>1?N-1:0),O=1;O<N;O++)F[O-1]=arguments[O];Q.apply(void 0,[E,ge(T)].concat(F))},b.doesNotReject=function E(T){for(var N=arguments.length,F=new Array(N>1?N-1:0),O=1;O<N;O++)F[O-1]=arguments[O];return ee(T).then(function(I){return Q.apply(void 0,[E,I].concat(F))})},b.ifError=function E(T){if(T!=null){var N="ifError got unwanted exception: ";l(T)==="object"&&typeof T.message=="string"?T.message.length===0&&T.constructor?N+=T.constructor.name:N+=T.message:N+=f(T);var F=new u({actual:T,expected:null,operator:"ifError",message:N,stackStartFn:E}),O=T.stack;if(typeof O=="string"){var I=O.split(`
`);I.shift();for(var j=F.stack.split(`
`),$=0;$<I.length;$++){var W=j.indexOf(I[$]);if(W!==-1){j=j.slice(0,W);break}}F.stack="".concat(j.join(`
`),`
`).concat(I.join(`
`))}throw F}};function ie(E,T,N,F,O){if(!y(T))throw new n("regexp","RegExp",T);var I=O==="match";if(typeof E!="string"||m(T,E)!==I){if(N instanceof Error)throw N;var j=!N;N=N||(typeof E!="string"?'The "string" argument must be of type string. Received type '+"".concat(l(E)," (").concat(f(E),")"):(I?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(f(T),`. Input:

`).concat(f(E),`
`));var $=new u({actual:E,expected:T,message:N,operator:O,stackStartFn:F});throw $.generatedMessage=j,$}}b.match=function E(T,N,F){ie(T,N,F,E,"match")},b.doesNotMatch=function E(T,N,F){ie(T,N,F,E,"doesNotMatch")};function _(){for(var E=arguments.length,T=new Array(E),N=0;N<E;N++)T[N]=arguments[N];M.apply(void 0,[_,T.length].concat(T))}return b.strict=x(_,b,{equal:b.strictEqual,deepEqual:b.deepStrictEqual,notEqual:b.notStrictEqual,notDeepEqual:b.notDeepStrictEqual}),b.strict.strict=b.strict,Ho.exports}var it={},Hu;function Z(){if(Hu)return it;Hu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(it,"__esModule",{value:!0}),it.SuppressWarnings=it.Override=it.Nullable=it.NotNull=void 0;function l(o,i,n){}it.NotNull=l;function e(o,i,n){}it.Nullable=e;function t(o,i,n){}it.Override=t;function r(o){return(i,n,s)=>{}}return it.SuppressWarnings=r,it}var aa={},Uu;function wr(){return Uu||(Uu=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.IntStream=void 0,function(e){e.EOF=-1,e.UNKNOWN_SOURCE_NAME="<unknown>"}(l.IntStream||(l.IntStream={}))}(aa)),aa}var $u;function N0(){if($u)return Mr;$u=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Mr&&Mr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.ANTLRInputStream=void 0;const e=Ve(),t=Z(),r=wr();let o=class{constructor(n){this.p=0,this.data=n,this.n=n.length}reset(){this.p=0}consume(){if(this.p>=this.n)throw e(this.LA(1)===r.IntStream.EOF),new Error("cannot consume EOF");this.p<this.n&&this.p++}LA(n){return n===0?0:n<0&&(n++,this.p+n-1<0)||this.p+n-1>=this.n?r.IntStream.EOF:this.data.charCodeAt(this.p+n-1)}LT(n){return this.LA(n)}get index(){return this.p}get size(){return this.n}mark(){return-1}release(n){}seek(n){if(n<=this.p){this.p=n;return}for(n=Math.min(n,this.n);this.p<n;)this.consume()}getText(n){let s=n.a,a=n.b;a>=this.n&&(a=this.n-1);let c=a-s+1;return s>=this.n?"":this.data.substr(s,c)}get sourceName(){return this.name?this.name:r.IntStream.UNKNOWN_SOURCE_NAME}toString(){return this.data}};return l([t.Override],o.prototype,"consume",null),l([t.Override],o.prototype,"LA",null),l([t.Override],o.prototype,"index",null),l([t.Override],o.prototype,"size",null),l([t.Override],o.prototype,"mark",null),l([t.Override],o.prototype,"release",null),l([t.Override],o.prototype,"seek",null),l([t.Override],o.prototype,"getText",null),l([t.Override],o.prototype,"sourceName",null),l([t.Override],o.prototype,"toString",null),Mr.ANTLRInputStream=o,Mr}var kr={},dt={},hi={},Vu;function yr(){return Vu||(Vu=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=hi&&hi.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c};Object.defineProperty(l,"__esModule",{value:!0}),l.ATNState=void 0;const t=Z();let r=class Ra{constructor(){this.stateNumber=Ra.INVALID_STATE_NUMBER,this.ruleIndex=0,this.epsilonOnlyTransitions=!1,this.transitions=[],this.optimizedTransitions=this.transitions}getStateNumber(){return this.stateNumber}get nonStopStateNumber(){return this.getStateNumber()}hashCode(){return this.stateNumber}equals(i){return i instanceof Ra?this.stateNumber===i.stateNumber:!1}get isNonGreedyExitState(){return!1}toString(){return String(this.stateNumber)}getTransitions(){return this.transitions.slice(0)}get numberOfTransitions(){return this.transitions.length}addTransition(i,n){if(this.transitions.length===0)this.epsilonOnlyTransitions=i.isEpsilon;else if(this.epsilonOnlyTransitions!==i.isEpsilon)throw this.epsilonOnlyTransitions=!1,new Error("ATN state "+this.stateNumber+" has both epsilon and non-epsilon transitions.");this.transitions.splice(n!==void 0?n:this.transitions.length,0,i)}transition(i){return this.transitions[i]}setTransition(i,n){this.transitions[i]=n}removeTransition(i){return this.transitions.splice(i,1)[0]}get onlyHasEpsilonTransitions(){return this.epsilonOnlyTransitions}setRuleIndex(i){this.ruleIndex=i}get isOptimized(){return this.optimizedTransitions!==this.transitions}get numberOfOptimizedTransitions(){return this.optimizedTransitions.length}getOptimizedTransition(i){return this.optimizedTransitions[i]}addOptimizedTransition(i){this.isOptimized||(this.optimizedTransitions=new Array),this.optimizedTransitions.push(i)}setOptimizedTransition(i,n){if(!this.isOptimized)throw new Error("This ATNState is not optimized.");this.optimizedTransitions[i]=n}removeOptimizedTransition(i){if(!this.isOptimized)throw new Error("This ATNState is not optimized.");this.optimizedTransitions.splice(i,1)}};e([t.Override],r.prototype,"hashCode",null),e([t.Override],r.prototype,"equals",null),e([t.Override],r.prototype,"toString",null),l.ATNState=r,function(o){o.INVALID_STATE_NUMBER=-1}(r=l.ATNState||(l.ATNState={}))}(hi)),hi}var la={},Wu;function Ue(){return Wu||(Wu=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.ATNStateType=void 0,function(e){e[e.INVALID_TYPE=0]="INVALID_TYPE",e[e.BASIC=1]="BASIC",e[e.RULE_START=2]="RULE_START",e[e.BLOCK_START=3]="BLOCK_START",e[e.PLUS_BLOCK_START=4]="PLUS_BLOCK_START",e[e.STAR_BLOCK_START=5]="STAR_BLOCK_START",e[e.TOKEN_START=6]="TOKEN_START",e[e.RULE_STOP=7]="RULE_STOP",e[e.BLOCK_END=8]="BLOCK_END",e[e.STAR_LOOP_BACK=9]="STAR_LOOP_BACK",e[e.STAR_LOOP_ENTRY=10]="STAR_LOOP_ENTRY",e[e.PLUS_LOOP_BACK=11]="PLUS_LOOP_BACK",e[e.LOOP_END=12]="LOOP_END"}(l.ATNStateType||(l.ATNStateType={}))}(la)),la}var pt={},fi={},Gu;function Nr(){if(Gu)return fi;Gu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(fi,"__esModule",{value:!0}),fi.RecognitionException=void 0;let l=class extends Error{constructor(t,r,o,i){super(i),this._offendingState=-1,this._recognizer=t,this.input=r,this.ctx=o,t&&(this._offendingState=t.state)}get offendingState(){return this._offendingState}setOffendingState(t){this._offendingState=t}get expectedTokens(){if(this._recognizer)return this._recognizer.atn.getExpectedTokens(this._offendingState,this.ctx)}get context(){return this.ctx}get inputStream(){return this.input}getOffendingToken(t){if(!(t&&t!==this._recognizer))return this.offendingToken}setOffendingToken(t,r){t===this._recognizer&&(this.offendingToken=r)}get recognizer(){return this._recognizer}};return fi.RecognitionException=l,fi}var xt={},di={},mt={},Yu;function Or(){if(Yu)return mt;Yu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=mt&&mt.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c},e=mt&&mt.__param||function(o,i){return function(n,s){i(n,s,o)}};Object.defineProperty(mt,"__esModule",{value:!0}),mt.Transition=void 0;const t=Z();let r=class{constructor(i){if(i==null)throw new Error("target cannot be null.");this.target=i}get isEpsilon(){return!1}get label(){}};return r.serializationNames=["INVALID","EPSILON","RANGE","RULE","PREDICATE","ATOM","ACTION","SET","NOT_SET","WILDCARD","PRECEDENCE"],l([t.NotNull],r.prototype,"target",void 0),r=l([e(0,t.NotNull)],r),mt.Transition=r,mt}var Xu;function Ka(){if(Xu)return di;Xu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(di,"__esModule",{value:!0}),di.AbstractPredicateTransition=void 0;const l=Or();let e=class extends l.Transition{constructor(r){super(r)}};return di.AbstractPredicateTransition=e,di}var zr={},gt={},jr={},ua={},Ku;function je(){return Ku||(Ku=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.MurmurHash=void 0,function(e){function r(a=0){return a}e.initialize=r;function o(a,c){c==null?c=0:typeof c=="string"?c=s(c):typeof c=="object"&&(c=c.hashCode());let x=c;return x=Math.imul(x,3432918353),x=x<<15|x>>>17,x=Math.imul(x,461845907),a=a^x,a=a<<13|a>>>19,a=Math.imul(a,5)+3864292196,a&4294967295}e.update=o;function i(a,c){return a=a^c*4,a=a^a>>>16,a=Math.imul(a,2246822507),a=a^a>>>13,a=Math.imul(a,3266489909),a=a^a>>>16,a}e.finish=i;function n(a,c=0){let u=r(c),h=0;for(let f of a)u=o(u,f),h++;return u=i(u,h),u}e.hashCode=n;function s(a){let c=a.length;if(c===0)return 0;let u=0;for(let h=0;h<c;h++){let f=a.charCodeAt(h);u=(u<<5>>>0)-u+f,u|=0}return u}}(l.MurmurHash||(l.MurmurHash={}))}(ua)),ua}var qr={},Qu;function ht(){if(Qu)return qr;Qu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=qr&&qr.__decorate||function(r,o,i,n){var s=arguments.length,a=s<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,i):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,o,i,n);else for(var u=r.length-1;u>=0;u--)(c=r[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(qr,"__esModule",{value:!0}),qr.ObjectEqualityComparator=void 0;const e=Z();let t=class{hashCode(o){return o==null?0:o.hashCode()}equals(o,i){return o==null?i==null:o.equals(i)}};return t.INSTANCE=new t,l([e.Override],t.prototype,"hashCode",null),l([e.Override],t.prototype,"equals",null),qr.ObjectEqualityComparator=t,qr}var Ju;function O0(){if(Ju)return jr;Ju=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=jr&&jr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(jr,"__esModule",{value:!0}),jr.DefaultEqualityComparator=void 0;const e=Z(),t=je(),r=ht();let o=class{hashCode(n){return n==null?0:typeof n=="string"||typeof n=="number"?t.MurmurHash.hashCode([n]):r.ObjectEqualityComparator.INSTANCE.hashCode(n)}equals(n,s){return n==null?s==null:typeof n=="string"||typeof n=="number"?n===s:r.ObjectEqualityComparator.INSTANCE.equals(n,s)}};return o.INSTANCE=new o,l([e.Override],o.prototype,"hashCode",null),l([e.Override],o.prototype,"equals",null),jr.DefaultEqualityComparator=o,jr}var Zu;function Fr(){if(Zu)return gt;Zu=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=gt&&gt.__decorate||function(c,u,h,f){var d=arguments.length,p=d<3?u:f===null?f=Object.getOwnPropertyDescriptor(u,h):f,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,u,h,f);else for(var x=c.length-1;x>=0;x--)(y=c[x])&&(p=(d<3?y(p):d>3?y(u,h,p):y(u,h))||p);return d>3&&p&&Object.defineProperty(u,h,p),p},e=gt&&gt.__param||function(c,u){return function(h,f){u(h,f,c)}};Object.defineProperty(gt,"__esModule",{value:!0}),gt.Array2DHashSet=void 0;const t=Ve(),r=O0(),o=Z(),i=je(),n=16,s=.75;let a=class fo{constructor(u,h=n){if(this.n=0,this.threshold=Math.floor(n*s),u instanceof fo){this.comparator=u.comparator,this.buckets=u.buckets.slice(0);for(let f=0;f<this.buckets.length;f++){let d=this.buckets[f];d&&(this.buckets[f]=d.slice(0))}this.n=u.n,this.threshold=u.threshold}else this.comparator=u||r.DefaultEqualityComparator.INSTANCE,this.buckets=this.createBuckets(h)}getOrAdd(u){return this.n>this.threshold&&this.expand(),this.getOrAddImpl(u)}getOrAddImpl(u){let h=this.getBucket(u),f=this.buckets[h];if(!f)return f=[u],this.buckets[h]=f,this.n++,u;for(let d of f)if(this.comparator.equals(d,u))return d;return f.push(u),this.n++,u}get(u){if(u==null)return u;let h=this.getBucket(u),f=this.buckets[h];if(f){for(let d of f)if(this.comparator.equals(d,u))return d}}getBucket(u){return this.comparator.hashCode(u)&this.buckets.length-1}hashCode(){let u=i.MurmurHash.initialize();for(let h of this.buckets)if(h!=null)for(let f of h){if(f==null)break;u=i.MurmurHash.update(u,this.comparator.hashCode(f))}return u=i.MurmurHash.finish(u,this.size),u}equals(u){return u===this?!0:!(u instanceof fo)||u.size!==this.size?!1:this.containsAll(u)}expand(){let u=this.buckets,h=this.buckets.length*2,f=this.createBuckets(h);this.buckets=f,this.threshold=Math.floor(h*s);let d=this.size;for(let p of u)if(p)for(let y of p){let x=this.getBucket(y),v=this.buckets[x];v||(v=[],this.buckets[x]=v),v.push(y)}t(this.n===d)}add(u){return this.getOrAdd(u)===u}get size(){return this.n}get isEmpty(){return this.n===0}contains(u){return this.containsFast(this.asElementType(u))}containsFast(u){return u==null?!1:this.get(u)!=null}*[Symbol.iterator](){yield*this.toArray()}toArray(){const u=new Array(this.size);let h=0;for(let f of this.buckets)if(f!=null)for(let d of f){if(d==null)break;u[h++]=d}return u}containsAll(u){if(u instanceof fo){let h=u;for(let f of h.buckets)if(f!=null)for(let d of f){if(d==null)break;if(!this.containsFast(this.asElementType(d)))return!1}}else for(let h of u)if(!this.containsFast(this.asElementType(h)))return!1;return!0}addAll(u){let h=!1;for(let f of u)this.getOrAdd(f)!==f&&(h=!0);return h}clear(){this.buckets=this.createBuckets(n),this.n=0,this.threshold=Math.floor(n*s)}toString(){if(this.size===0)return"{}";let u="{",h=!0;for(let f of this.buckets)if(f!=null)for(let d of f){if(d==null)break;h?h=!1:u+=", ",u+=d.toString()}return u+="}",u}toTableString(){let u="";for(let h of this.buckets){if(h==null){u+=`null
`;continue}u+="[";let f=!0;for(let d of h)f?f=!1:u+=" ",d==null?u+="_":u+=d.toString();u+=`]
`}return u}asElementType(u){return u}createBuckets(u){return new Array(u)}};return l([o.NotNull],a.prototype,"comparator",void 0),l([o.Override],a.prototype,"hashCode",null),l([o.Override],a.prototype,"equals",null),l([o.Override],a.prototype,"add",null),l([o.Override],a.prototype,"size",null),l([o.Override],a.prototype,"isEmpty",null),l([o.Override],a.prototype,"contains",null),l([e(0,o.Nullable)],a.prototype,"containsFast",null),l([o.Override],a.prototype,Symbol.iterator,null),l([o.Override],a.prototype,"toArray",null),l([o.Override],a.prototype,"containsAll",null),l([o.Override],a.prototype,"addAll",null),l([o.Override],a.prototype,"clear",null),l([o.Override],a.prototype,"toString",null),l([o.SuppressWarnings("unchecked")],a.prototype,"asElementType",null),l([o.SuppressWarnings("unchecked")],a.prototype,"createBuckets",null),gt.Array2DHashSet=a,gt}var Hr={},ec;function To(){if(ec)return Hr;ec=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Hr&&Hr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.ArrayEqualityComparator=void 0;const e=Z(),t=je(),r=ht();let o=class{hashCode(n){return n==null?0:t.MurmurHash.hashCode(n,0)}equals(n,s){if(n==null)return s==null;if(s==null||n.length!==s.length)return!1;for(let a=0;a<n.length;a++)if(!r.ObjectEqualityComparator.INSTANCE.equals(n[a],s[a]))return!1;return!0}};return o.INSTANCE=new o,l([e.Override],o.prototype,"hashCode",null),l([e.Override],o.prototype,"equals",null),Hr.ArrayEqualityComparator=o,Hr}var Xe={},tc;function vr(){if(tc)return Xe;tc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.toCharArray=Xe.toMap=Xe.equals=Xe.join=Xe.escapeWhitespace=void 0;function l(i,n){return n?i.replace(/ /,""):i.replace(/\t/,"\\t").replace(/\n/,"\\n").replace(/\r/,"\\r")}Xe.escapeWhitespace=l;function e(i,n){let s="",a=!0;for(let c of i)a?a=!1:s+=n,s+=c;return s}Xe.join=e;function t(i,n){return i===n?!0:i===void 0||n===void 0?!1:i.equals(n)}Xe.equals=t;function r(i){let n=new Map;for(let s=0;s<i.length;s++)n.set(i[s],s);return n}Xe.toMap=r;function o(i){if(typeof i=="string"){let n=new Uint16Array(i.length);for(let s=0;s<i.length;s++)n[s]=i.charCodeAt(s);return n}else return i.toCharArray()}return Xe.toCharArray=o,Xe}var rc;function si(){return rc||(rc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=zr&&zr.__decorate||function(f,d,p,y){var x=arguments.length,v=x<3?d:y===null?y=Object.getOwnPropertyDescriptor(d,p):y,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,d,p,y);else for(var g=f.length-1;g>=0;g--)(m=f[g])&&(v=(x<3?m(v):x>3?m(d,p,v):m(d,p))||v);return x>3&&v&&Object.defineProperty(d,p,v),v},t=zr&&zr.__param||function(f,d){return function(p,y){d(p,y,f)}};Object.defineProperty(l,"__esModule",{value:!0}),l.SemanticContext=void 0;const r=Fr(),o=To(),i=je(),n=Z(),s=ht(),a=vr();function c(f){let d;for(let p of f){if(d===void 0){d=p;continue}d.compareTo(p)<0&&(d=p)}return d}function u(f){let d;for(let p of f){if(d===void 0){d=p;continue}d.compareTo(p)>0&&(d=p)}return d}let h=class et{static get NONE(){return et._NONE===void 0&&(et._NONE=new et.Predicate),et._NONE}evalPrecedence(d,p){return this}static and(d,p){if(!d||d===et.NONE)return p;if(p===et.NONE)return d;let y=new et.AND(d,p);return y.opnds.length===1?y.opnds[0]:y}static or(d,p){if(!d)return p;if(d===et.NONE||p===et.NONE)return et.NONE;let y=new et.OR(d,p);return y.opnds.length===1?y.opnds[0]:y}};l.SemanticContext=h,function(f){function y(C){let A=[];for(let b=0;b<C.length;b++){let R=C[b];R instanceof f.PrecedencePredicate&&(A.push(R),C.splice(b,1),b--)}return A}class x extends f{constructor(A=-1,b=-1,R=!1){super(),this.ruleIndex=A,this.predIndex=b,this.isCtxDependent=R}eval(A,b){let R=this.isCtxDependent?b:void 0;return A.sempred(R,this.ruleIndex,this.predIndex)}hashCode(){let A=i.MurmurHash.initialize();return A=i.MurmurHash.update(A,this.ruleIndex),A=i.MurmurHash.update(A,this.predIndex),A=i.MurmurHash.update(A,this.isCtxDependent?1:0),A=i.MurmurHash.finish(A,3),A}equals(A){return A instanceof x?this===A?!0:this.ruleIndex===A.ruleIndex&&this.predIndex===A.predIndex&&this.isCtxDependent===A.isCtxDependent:!1}toString(){return"{"+this.ruleIndex+":"+this.predIndex+"}?"}}e([n.Override],x.prototype,"eval",null),e([n.Override],x.prototype,"hashCode",null),e([n.Override],x.prototype,"equals",null),e([n.Override],x.prototype,"toString",null),f.Predicate=x;class v extends f{constructor(A){super(),this.precedence=A}eval(A,b){return A.precpred(b,this.precedence)}evalPrecedence(A,b){if(A.precpred(b,this.precedence))return f.NONE}compareTo(A){return this.precedence-A.precedence}hashCode(){let A=1;return A=31*A+this.precedence,A}equals(A){return A instanceof v?this===A?!0:this.precedence===A.precedence:!1}toString(){return"{"+this.precedence+">=prec}?"}}e([n.Override],v.prototype,"eval",null),e([n.Override],v.prototype,"evalPrecedence",null),e([n.Override],v.prototype,"compareTo",null),e([n.Override],v.prototype,"hashCode",null),e([n.Override],v.prototype,"equals",null),e([n.Override],v.prototype,"toString",null),f.PrecedencePredicate=v;class m extends f{}f.Operator=m;let g=class po extends m{constructor(A,b){super();let R=new r.Array2DHashSet(s.ObjectEqualityComparator.INSTANCE);A instanceof po?R.addAll(A.opnds):R.add(A),b instanceof po?R.addAll(b.opnds):R.add(b),this.opnds=R.toArray();let w=y(this.opnds),P=u(w);P&&this.opnds.push(P)}get operands(){return this.opnds}equals(A){return this===A?!0:A instanceof po?o.ArrayEqualityComparator.INSTANCE.equals(this.opnds,A.opnds):!1}hashCode(){return i.MurmurHash.hashCode(this.opnds,40363613)}eval(A,b){for(let R of this.opnds)if(!R.eval(A,b))return!1;return!0}evalPrecedence(A,b){let R=!1,w=[];for(let M of this.opnds){let D=M.evalPrecedence(A,b);if(R=R||D!==M,D==null)return;D!==f.NONE&&w.push(D)}if(!R)return this;if(w.length===0)return f.NONE;let P=w[0];for(let M=1;M<w.length;M++)P=f.and(P,w[M]);return P}toString(){return a.join(this.opnds,"&&")}};e([n.Override],g.prototype,"operands",null),e([n.Override],g.prototype,"equals",null),e([n.Override],g.prototype,"hashCode",null),e([n.Override],g.prototype,"eval",null),e([n.Override],g.prototype,"evalPrecedence",null),e([n.Override],g.prototype,"toString",null),g=e([t(0,n.NotNull),t(1,n.NotNull)],g),f.AND=g;let S=class xo extends m{constructor(A,b){super();let R=new r.Array2DHashSet(s.ObjectEqualityComparator.INSTANCE);A instanceof xo?R.addAll(A.opnds):R.add(A),b instanceof xo?R.addAll(b.opnds):R.add(b),this.opnds=R.toArray();let w=y(this.opnds),P=c(w);P&&this.opnds.push(P)}get operands(){return this.opnds}equals(A){return this===A?!0:A instanceof xo?o.ArrayEqualityComparator.INSTANCE.equals(this.opnds,A.opnds):!1}hashCode(){return i.MurmurHash.hashCode(this.opnds,486279973)}eval(A,b){for(let R of this.opnds)if(R.eval(A,b))return!0;return!1}evalPrecedence(A,b){let R=!1,w=[];for(let M of this.opnds){let D=M.evalPrecedence(A,b);if(R=R||D!==M,D===f.NONE)return f.NONE;D&&w.push(D)}if(!R)return this;if(w.length===0)return;let P=w[0];for(let M=1;M<w.length;M++)P=f.or(P,w[M]);return P}toString(){return a.join(this.opnds,"||")}};e([n.Override],S.prototype,"operands",null),e([n.Override],S.prototype,"equals",null),e([n.Override],S.prototype,"hashCode",null),e([n.Override],S.prototype,"eval",null),e([n.Override],S.prototype,"evalPrecedence",null),e([n.Override],S.prototype,"toString",null),S=e([t(0,n.NotNull),t(1,n.NotNull)],S),f.OR=S}(h=l.SemanticContext||(l.SemanticContext={}))}(zr)),zr}var nc;function vd(){if(nc)return xt;nc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=xt&&xt.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=xt&&xt.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(xt,"__esModule",{value:!0}),xt.PredicateTransition=void 0;const t=Ka(),r=Z(),o=si();let i=class extends t.AbstractPredicateTransition{constructor(s,a,c,u){super(s),this.ruleIndex=a,this.predIndex=c,this.isCtxDependent=u}get serializationType(){return 4}get isEpsilon(){return!0}matches(s,a,c){return!1}get predicate(){return new o.SemanticContext.Predicate(this.ruleIndex,this.predIndex,this.isCtxDependent)}toString(){return"pred_"+this.ruleIndex+":"+this.predIndex}};return l([r.Override],i.prototype,"serializationType",null),l([r.Override],i.prototype,"isEpsilon",null),l([r.Override],i.prototype,"matches",null),l([r.Override,r.NotNull],i.prototype,"toString",null),i=l([e(0,r.NotNull)],i),xt.PredicateTransition=i,xt}var ic;function bo(){if(ic)return pt;ic=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=pt&&pt.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=pt&&pt.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(pt,"__esModule",{value:!0}),pt.FailedPredicateException=void 0;const t=Nr(),r=Z(),o=vd();let i=class Sd extends t.RecognitionException{constructor(s,a,c){super(s,s.inputStream,s.context,Sd.formatMessage(a,c));let h=s.interpreter.atn.states[s.state].transition(0);h instanceof o.PredicateTransition?(this._ruleIndex=h.ruleIndex,this._predicateIndex=h.predIndex):(this._ruleIndex=0,this._predicateIndex=0),this._predicate=a,super.setOffendingToken(s,s.currentToken)}get ruleIndex(){return this._ruleIndex}get predicateIndex(){return this._predicateIndex}get predicate(){return this._predicate}static formatMessage(s,a){return a||`failed predicate: {${s}}?`}};return l([r.NotNull],i,"formatMessage",null),i=l([e(0,r.NotNull)],i),pt.FailedPredicateException=i,pt}var yt={},oc;function Ro(){if(oc)return yt;oc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=yt&&yt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=yt&&yt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(yt,"__esModule",{value:!0}),yt.InputMismatchException=void 0;const t=Nr(),r=Z();let o=class extends t.RecognitionException{constructor(n,s,a){a===void 0&&(a=n.context),super(n,n.inputStream,a),s!==void 0&&this.setOffendingState(s),this.setOffendingToken(n,n.currentToken)}};return o=l([e(0,r.NotNull)],o),yt.InputMismatchException=o,yt}var vt={},Ur={},ca={},sc;function Qa(){return sc||(sc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.Arrays=void 0,function(e){function t(i,n,s,a){return r(i,s!==void 0?s:0,a!==void 0?a:i.length,n)}e.binarySearch=t;function r(i,n,s,a){let c=n,u=s-1;for(;c<=u;){let h=c+u>>>1,f=i[h];if(f<a)c=h+1;else if(f>a)u=h-1;else return h}return-(c+1)}function o(i){let n="[",s=!0;for(let a of i)s?s=!1:n+=", ",a===null?n+="null":a===void 0?n+="undefined":n+=a;return n+="]",n}e.toString=o}(l.Arrays||(l.Arrays={}))}(ca)),ca}var ac;function Ja(){if(ac)return Ur;ac=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ur&&Ur.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f};Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.IntegerList=void 0;const e=Qa(),t=Z(),r=new Int32Array(0),o=4,i=(1<<31>>>0)-1-8;let n=class mo{constructor(a){if(!a)this._data=r,this._size=0;else if(a instanceof mo)this._data=a._data.slice(0),this._size=a._size;else if(typeof a=="number")a===0?(this._data=r,this._size=0):(this._data=new Int32Array(a),this._size=0);else{this._data=r,this._size=0;for(let c of a)this.add(c)}}add(a){this._data.length===this._size&&this.ensureCapacity(this._size+1),this._data[this._size]=a,this._size++}addAll(a){if(Array.isArray(a))this.ensureCapacity(this._size+a.length),this._data.subarray(this._size,this._size+a.length).set(a),this._size+=a.length;else if(a instanceof mo)this.ensureCapacity(this._size+a._size),this._data.subarray(this._size,this._size+a.size).set(a._data),this._size+=a._size;else{this.ensureCapacity(this._size+a.size);let c=0;for(let u of a)this._data[this._size+c]=u,c++;this._size+=a.size}}get(a){if(a<0||a>=this._size)throw RangeError();return this._data[a]}contains(a){for(let c=0;c<this._size;c++)if(this._data[c]===a)return!0;return!1}set(a,c){if(a<0||a>=this._size)throw RangeError();let u=this._data[a];return this._data[a]=c,u}removeAt(a){let c=this.get(a);return this._data.copyWithin(a,a+1,this._size),this._data[this._size-1]=0,this._size--,c}removeRange(a,c){if(a<0||c<0||a>this._size||c>this._size||a>c)throw RangeError();this._data.copyWithin(c,a,this._size),this._data.fill(0,this._size-(c-a),this._size),this._size-=c-a}get isEmpty(){return this._size===0}get size(){return this._size}trimToSize(){this._data.length!==this._size&&(this._data=this._data.slice(0,this._size))}clear(){this._data.fill(0,0,this._size),this._size=0}toArray(){return this._size===0?[]:Array.from(this._data.subarray(0,this._size))}sort(){this._data.subarray(0,this._size).sort()}equals(a){if(a===this)return!0;if(!(a instanceof mo)||this._size!==a._size)return!1;for(let c=0;c<this._size;c++)if(this._data[c]!==a._data[c])return!1;return!0}hashCode(){let a=1;for(let c=0;c<this._size;c++)a=31*a+this._data[c];return a}toString(){return this._data.toString()}binarySearch(a,c,u){if(c===void 0&&(c=0),u===void 0&&(u=this._size),c<0||u<0||c>this._size||u>this._size)throw new RangeError;if(c>u)throw new RangeError;return e.Arrays.binarySearch(this._data,a,c,u)}ensureCapacity(a){if(a<0||a>i)throw new RangeError;let c;for(this._data.length===0?c=o:c=this._data.length;c<a;)c=c*2,(c<0||c>i)&&(c=i);let u=new Int32Array(c);u.set(this._data),this._data=u}toCharArray(){let a=new Uint16Array(this._size),c=0,u=!1;for(let h=0;h<this._size;h++){let f=this._data[h];if(f>=0&&f<65536){a[c]=f,c++;continue}if(!u){let p=new Uint16Array(this.charArraySize());p.set(a,0),a=p,u=!0}let d=String.fromCodePoint(f);a[c]=d.charCodeAt(0),a[c+1]=d.charCodeAt(1),c+=2}return a}charArraySize(){let a=0;for(let c=0;c<this._size;c++)a+=this._data[c]>=65536?2:1;return a}};return l([t.NotNull],n.prototype,"_data",void 0),l([t.Override],n.prototype,"equals",null),l([t.Override],n.prototype,"hashCode",null),l([t.Override],n.prototype,"toString",null),Ur.IntegerList=n,Ur}var $r={},lc;function Ye(){if(lc)return $r;lc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=$r&&$r.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c};Object.defineProperty($r,"__esModule",{value:!0}),$r.Interval=void 0;const e=Z(),t=1e3;let r=class tt{constructor(i,n){this.a=i,this.b=n}static get INVALID(){return tt._INVALID}static of(i,n){return i!==n||i<0||i>t?new tt(i,n):(tt.cache[i]==null&&(tt.cache[i]=new tt(i,i)),tt.cache[i])}get length(){return this.b<this.a?0:this.b-this.a+1}equals(i){return i===this?!0:i instanceof tt?this.a===i.a&&this.b===i.b:!1}hashCode(){let i=23;return i=i*31+this.a,i=i*31+this.b,i}startsBeforeDisjoint(i){return this.a<i.a&&this.b<i.a}startsBeforeNonDisjoint(i){return this.a<=i.a&&this.b>=i.a}startsAfter(i){return this.a>i.a}startsAfterDisjoint(i){return this.a>i.b}startsAfterNonDisjoint(i){return this.a>i.a&&this.a<=i.b}disjoint(i){return this.startsBeforeDisjoint(i)||this.startsAfterDisjoint(i)}adjacent(i){return this.a===i.b+1||this.b===i.a-1}properlyContains(i){return i.a>=this.a&&i.b<=this.b}union(i){return tt.of(Math.min(this.a,i.a),Math.max(this.b,i.b))}intersection(i){return tt.of(Math.max(this.a,i.a),Math.min(this.b,i.b))}differenceNotProperlyContained(i){let n;return i.startsBeforeNonDisjoint(this)?n=tt.of(Math.max(this.a,i.b+1),this.b):i.startsAfterNonDisjoint(this)&&(n=tt.of(this.a,i.a-1)),n}toString(){return this.a+".."+this.b}};return r._INVALID=new r(-1,-2),r.cache=new Array(t+1),l([e.Override],r.prototype,"equals",null),l([e.Override],r.prototype,"hashCode",null),l([e.Override],r.prototype,"toString",null),$r.Interval=r,$r}var Vr={},pi={},St={},ha={},uc;function Be(){return uc||(uc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.Token=void 0;const e=wr();(function(t){t.INVALID_TYPE=0,t.EPSILON=-2,t.MIN_USER_TOKEN_TYPE=1,t.EOF=e.IntStream.EOF,t.DEFAULT_CHANNEL=0,t.HIDDEN_CHANNEL=1,t.MIN_USER_CHANNEL_VALUE=2})(l.Token||(l.Token={}))}(ha)),ha}var cc;function Xi(){if(cc)return St;cc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=St&&St.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=St&&St.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(St,"__esModule",{value:!0}),St.CommonToken=void 0;const t=Ye(),r=Z(),o=Be();let i=class Bi{constructor(s,a,c=Bi.EMPTY_SOURCE,u=o.Token.DEFAULT_CHANNEL,h=0,f=0){this._line=0,this._charPositionInLine=-1,this._channel=o.Token.DEFAULT_CHANNEL,this.index=-1,this._text=a,this._type=s,this.source=c,this._channel=u,this.start=h,this.stop=f,c.source!=null&&(this._line=c.source.line,this._charPositionInLine=c.source.charPositionInLine)}static fromToken(s){let a=new Bi(s.type,void 0,Bi.EMPTY_SOURCE,s.channel,s.startIndex,s.stopIndex);return a._line=s.line,a.index=s.tokenIndex,a._charPositionInLine=s.charPositionInLine,s instanceof Bi?(a._text=s._text,a.source=s.source):(a._text=s.text,a.source={source:s.tokenSource,stream:s.inputStream}),a}get type(){return this._type}set type(s){this._type=s}get line(){return this._line}set line(s){this._line=s}get text(){if(this._text!=null)return this._text;let s=this.inputStream;if(s==null)return;let a=s.size;return this.start<a&&this.stop<a?s.getText(t.Interval.of(this.start,this.stop)):"<EOF>"}set text(s){this._text=s}get charPositionInLine(){return this._charPositionInLine}set charPositionInLine(s){this._charPositionInLine=s}get channel(){return this._channel}set channel(s){this._channel=s}get startIndex(){return this.start}set startIndex(s){this.start=s}get stopIndex(){return this.stop}set stopIndex(s){this.stop=s}get tokenIndex(){return this.index}set tokenIndex(s){this.index=s}get tokenSource(){return this.source.source}get inputStream(){return this.source.stream}toString(s){let a="";this._channel>0&&(a=",channel="+this._channel);let c=this.text;c!=null?(c=c.replace(/\n/g,"\\n"),c=c.replace(/\r/g,"\\r"),c=c.replace(/\t/g,"\\t")):c="<no text>";let u=String(this._type);return s&&(u=s.vocabulary.getDisplayName(this._type)),"[@"+this.tokenIndex+","+this.start+":"+this.stop+"='"+c+"',<"+u+">"+a+","+this._line+":"+this.charPositionInLine+"]"}};return i.EMPTY_SOURCE={source:void 0,stream:void 0},l([r.NotNull],i.prototype,"source",void 0),l([r.Override],i.prototype,"type",null),l([r.Override],i.prototype,"line",null),l([r.Override],i.prototype,"text",null),l([r.Override],i.prototype,"charPositionInLine",null),l([r.Override],i.prototype,"channel",null),l([r.Override],i.prototype,"startIndex",null),l([r.Override],i.prototype,"stopIndex",null),l([r.Override],i.prototype,"tokenIndex",null),l([r.Override],i.prototype,"tokenSource",null),l([r.Override],i.prototype,"inputStream",null),l([r.Override],i.prototype,"toString",null),l([e(0,r.NotNull)],i,"fromToken",null),i=l([e(2,r.NotNull)],i),St.CommonToken=i,St}var hc;function Za(){return hc||(hc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=pi&&pi.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(l,"__esModule",{value:!0}),l.CommonTokenFactory=void 0;const t=Xi(),r=Ye(),o=Z();let i=class{constructor(s=!1){this.copyText=s}create(s,a,c,u,h,f,d,p){let y=new t.CommonToken(a,c,s,u,h,f);return y.line=d,y.charPositionInLine=p,c==null&&this.copyText&&s.stream!=null&&(y.text=s.stream.getText(r.Interval.of(h,f))),y}createSimple(s,a){return new t.CommonToken(s,a)}};e([o.Override],i.prototype,"create",null),e([o.Override],i.prototype,"createSimple",null),l.CommonTokenFactory=i,function(n){n.DEFAULT=new n}(i=l.CommonTokenFactory||(l.CommonTokenFactory={}))}(pi)),pi}var xi={},fc;function Ad(){if(fc)return xi;fc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(xi,"__esModule",{value:!0}),xi.IntegerStack=void 0;const l=Ja();let e=class extends l.IntegerList{constructor(r){super(r)}push(r){this.add(r)}pop(){return this.removeAt(this.size-1)}peek(){return this.get(this.size-1)}};return xi.IntegerStack=e,xi}var Wr={},mi={},dc;function Cd(){if(dc)return mi;dc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(mi,"__esModule",{value:!0}),mi.AcceptStateInfo=void 0;let l=class{constructor(t,r){this._prediction=t,this._lexerActionExecutor=r}get prediction(){return this._prediction}get lexerActionExecutor(){return this._lexerActionExecutor}};return mi.AcceptStateInfo=l,mi}var Gr={},gi={},pc;function ai(){if(pc)return gi;pc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(gi,"__esModule",{value:!0}),gi.Array2DHashMap=void 0;const l=Fr();class e{constructor(o){this.keyComparator=o}hashCode(o){return this.keyComparator.hashCode(o.key)}equals(o,i){return this.keyComparator.equals(o.key,i.key)}}let t=class wa{constructor(o){o instanceof wa?this.backingStore=new l.Array2DHashSet(o.backingStore):this.backingStore=new l.Array2DHashSet(new e(o))}clear(){this.backingStore.clear()}containsKey(o){return this.backingStore.contains({key:o})}get(o){let i=this.backingStore.get({key:o});if(i)return i.value}get isEmpty(){return this.backingStore.isEmpty}put(o,i){let n=this.backingStore.get({key:o,value:i}),s;return n?(s=n.value,n.value=i):this.backingStore.add({key:o,value:i}),s}putIfAbsent(o,i){let n=this.backingStore.get({key:o,value:i}),s;return n?s=n.value:this.backingStore.add({key:o,value:i}),s}get size(){return this.backingStore.size}hashCode(){return this.backingStore.hashCode()}equals(o){return o instanceof wa?this.backingStore.equals(o.backingStore):!1}};return gi.Array2DHashMap=t,gi}var At={},Yr={},Ct={},yi={},xc;function $n(){if(xc)return yi;xc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(yi,"__esModule",{value:!0}),yi.DecisionState=void 0;const l=yr();let e=class extends l.ATNState{constructor(){super(...arguments),this.decision=-1,this.nonGreedy=!1,this.sll=!1}};return yi.DecisionState=e,yi}var Xr={},vi={},mc;function el(){return mc||(mc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=vi&&vi.__decorate||function(a,c,u,h){var f=arguments.length,d=f<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,u):h,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(a,c,u,h);else for(var y=a.length-1;y>=0;y--)(p=a[y])&&(d=(f<3?p(d):f>3?p(c,u,d):p(c,u))||d);return f>3&&d&&Object.defineProperty(c,u,d),d};Object.defineProperty(l,"__esModule",{value:!0}),l.PredictionContextCache=void 0;const t=ai(),r=Z(),o=ht(),i=lt(),n=Ve();let s=class Na{constructor(c=!0){this.contexts=new t.Array2DHashMap(o.ObjectEqualityComparator.INSTANCE),this.childContexts=new t.Array2DHashMap(o.ObjectEqualityComparator.INSTANCE),this.joinContexts=new t.Array2DHashMap(o.ObjectEqualityComparator.INSTANCE),this.enableCache=c}getAsCached(c){if(!this.enableCache)return c;let u=this.contexts.get(c);return u||(u=c,this.contexts.put(c,c)),u}getChild(c,u){if(!this.enableCache)return c.getChild(u);let h=new Na.PredictionContextAndInt(c,u),f=this.childContexts.get(h);return f||(f=c.getChild(u),f=this.getAsCached(f),this.childContexts.put(h,f)),f}join(c,u){if(!this.enableCache)return i.PredictionContext.join(c,u,this);let h=new Na.IdentityCommutativePredictionContextOperands(c,u),f=this.joinContexts.get(h);return f||(f=i.PredictionContext.join(c,u,this),f=this.getAsCached(f),this.joinContexts.put(h,f),f)}};l.PredictionContextCache=s,s.UNCACHED=new s(!1),function(a){class c{constructor(f,d){this.obj=f,this.value=d}equals(f){if(f instanceof c){if(f===this)return!0}else return!1;let d=f;return this.value===d.value&&(this.obj===d.obj||this.obj!=null&&this.obj.equals(d.obj))}hashCode(){let f=5;return f=7*f+(this.obj!=null?this.obj.hashCode():0),f=7*f+this.value,f}}e([r.Override],c.prototype,"equals",null),e([r.Override],c.prototype,"hashCode",null),a.PredictionContextAndInt=c;class u{constructor(f,d){n(f!=null),n(d!=null),this._x=f,this._y=d}get x(){return this._x}get y(){return this._y}equals(f){if(f instanceof u){if(this===f)return!0}else return!1;let d=f;return this._x===d._x&&this._y===d._y||this._x===d._y&&this._y===d._x}hashCode(){return this._x.hashCode()^this._y.hashCode()}}e([r.Override],u.prototype,"equals",null),e([r.Override],u.prototype,"hashCode",null),a.IdentityCommutativePredictionContextOperands=u}(s=l.PredictionContextCache||(l.PredictionContextCache={}))}(vi)),vi}var gc;function lt(){return gc||(gc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Xr&&Xr.__decorate||function(y,x,v,m){var g=arguments.length,S=g<3?x:m===null?m=Object.getOwnPropertyDescriptor(x,v):m,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(y,x,v,m);else for(var A=y.length-1;A>=0;A--)(C=y[A])&&(S=(g<3?C(S):g>3?C(x,v,S):C(x,v))||S);return g>3&&S&&Object.defineProperty(x,v,S),S},t=Xr&&Xr.__param||function(y,x){return function(v,m){x(v,m,y)}};Object.defineProperty(l,"__esModule",{value:!0}),l.SingletonPredictionContext=l.PredictionContext=void 0;const r=ai(),o=Fr(),i=Qa(),n=je(),s=Z(),a=el(),c=Ve(),u=1;let h=class $e{constructor(x){this.cachedHashCode=x}static calculateEmptyHashCode(){let x=n.MurmurHash.initialize(u);return x=n.MurmurHash.finish(x,0),x}static calculateSingleHashCode(x,v){let m=n.MurmurHash.initialize(u);return m=n.MurmurHash.update(m,x),m=n.MurmurHash.update(m,v),m=n.MurmurHash.finish(m,2),m}static calculateHashCode(x,v){let m=n.MurmurHash.initialize(u);for(let g of x)m=n.MurmurHash.update(m,g);for(let g of v)m=n.MurmurHash.update(m,g);return m=n.MurmurHash.finish(m,2*x.length),m}static fromRuleContext(x,v,m=!0){if(v.isEmpty)return m?$e.EMPTY_FULL:$e.EMPTY_LOCAL;let g;v._parent?g=$e.fromRuleContext(x,v._parent,m):g=m?$e.EMPTY_FULL:$e.EMPTY_LOCAL;let C=x.states[v.invokingState].transition(0);return g.getChild(C.followState.stateNumber)}static addEmptyContext(x){return x.addEmptyContext()}static removeEmptyContext(x){return x.removeEmptyContext()}static join(x,v,m=a.PredictionContextCache.UNCACHED){if(x===v)return x;if(x.isEmpty)return $e.isEmptyLocal(x)?x:$e.addEmptyContext(v);if(v.isEmpty)return $e.isEmptyLocal(v)?v:$e.addEmptyContext(x);let g=x.size,S=v.size;if(g===1&&S===1&&x.getReturnState(0)===v.getReturnState(0)){let D=m.join(x.getParent(0),v.getParent(0));return D===x.getParent(0)?x:D===v.getParent(0)?v:D.getChild(x.getReturnState(0))}let C=0,A=new Array(g+S),b=new Array(A.length),R=0,w=0,P=!0,M=!0;for(;R<g&&w<S;)x.getReturnState(R)===v.getReturnState(w)?(A[C]=m.join(x.getParent(R),v.getParent(w)),b[C]=x.getReturnState(R),P=P&&A[C]===x.getParent(R),M=M&&A[C]===v.getParent(w),R++,w++):x.getReturnState(R)<v.getReturnState(w)?(A[C]=x.getParent(R),b[C]=x.getReturnState(R),M=!1,R++):(c(v.getReturnState(w)<x.getReturnState(R)),A[C]=v.getParent(w),b[C]=v.getReturnState(w),P=!1,w++),C++;for(;R<g;)A[C]=x.getParent(R),b[C]=x.getReturnState(R),R++,M=!1,C++;for(;w<S;)A[C]=v.getParent(w),b[C]=v.getReturnState(w),w++,P=!1,C++;return P?x:M?v:(C<A.length&&(A=A.slice(0,C),b=b.slice(0,C)),A.length===0?$e.EMPTY_FULL:A.length===1?new p(A[0],b[0]):new d(A,b))}static isEmptyLocal(x){return x===$e.EMPTY_LOCAL}static getCachedContext(x,v,m){if(x.isEmpty)return x;let g=m.get(x);if(g)return g;if(g=v.get(x),g)return m.put(x,g),g;let S=!1,C=new Array(x.size);for(let b=0;b<C.length;b++){let R=$e.getCachedContext(x.getParent(b),v,m);if(S||R!==x.getParent(b)){if(!S){C=new Array(x.size);for(let w=0;w<x.size;w++)C[w]=x.getParent(w);S=!0}C[b]=R}}if(!S)return g=v.putIfAbsent(x,x),m.put(x,g??x),x;let A;if(C.length===1)A=new p(C[0],x.getReturnState(0));else{let b=new Array(x.size);for(let R=0;R<x.size;R++)b[R]=x.getReturnState(R);A=new d(C,b,x.hashCode())}return g=v.putIfAbsent(A,A),m.put(A,g||A),m.put(x,g||A),A}appendSingleContext(x,v){return this.appendContext($e.EMPTY_FULL.getChild(x),v)}getChild(x){return new p(this,x)}hashCode(){return this.cachedHashCode}toStrings(x,v,m=$e.EMPTY_FULL){let g=[];e:for(let S=0;;S++){let C=0,A=!0,b=this,R=v,w="";for(w+="[";!b.isEmpty&&b!==m;){let P=0;if(b.size>0){let M=1;for(;1<<M>>>0<b.size;)M++;let D=(1<<M>>>0)-1;if(P=S>>C&D,A=A&&P>=b.size-1,P>=b.size)continue e;C+=M}if(x){w.length>1&&(w+=" ");let D=x.atn.states[R],U=x.ruleNames[D.ruleIndex];w+=U}else b.getReturnState(P)!==$e.EMPTY_FULL_STATE_KEY&&(b.isEmpty||(w.length>1&&(w+=" "),w+=b.getReturnState(P)));R=b.getReturnState(P),b=b.getParent(P)}if(w+="]",g.push(w),A)break}return g}};e([s.Override],h.prototype,"hashCode",null),e([t(0,s.NotNull),t(1,s.NotNull),t(2,s.NotNull)],h,"join",null),e([t(0,s.NotNull),t(1,s.NotNull),t(2,s.NotNull)],h,"getCachedContext",null),l.PredictionContext=h;class f extends h{constructor(x){super(h.calculateEmptyHashCode()),this.fullContext=x}get isFullContext(){return this.fullContext}addEmptyContext(){return this}removeEmptyContext(){throw new Error("Cannot remove the empty context from itself.")}getParent(x){throw new Error("index out of bounds")}getReturnState(x){throw new Error("index out of bounds")}findReturnState(x){return-1}get size(){return 0}appendSingleContext(x,v){return v.getChild(this,x)}appendContext(x,v){return x}get isEmpty(){return!0}get hasEmpty(){return!0}equals(x){return this===x}toStrings(x,v,m){return["[]"]}}e([s.Override],f.prototype,"addEmptyContext",null),e([s.Override],f.prototype,"removeEmptyContext",null),e([s.Override],f.prototype,"getParent",null),e([s.Override],f.prototype,"getReturnState",null),e([s.Override],f.prototype,"findReturnState",null),e([s.Override],f.prototype,"size",null),e([s.Override],f.prototype,"appendSingleContext",null),e([s.Override],f.prototype,"appendContext",null),e([s.Override],f.prototype,"isEmpty",null),e([s.Override],f.prototype,"hasEmpty",null),e([s.Override],f.prototype,"equals",null),e([s.Override],f.prototype,"toStrings",null);let d=class jn extends h{constructor(x,v,m){super(m||h.calculateHashCode(x,v)),c(x.length===v.length),c(v.length>1||v[0]!==h.EMPTY_FULL_STATE_KEY,"Should be using PredictionContext.EMPTY instead."),this.parents=x,this.returnStates=v}getParent(x){return this.parents[x]}getReturnState(x){return this.returnStates[x]}findReturnState(x){return i.Arrays.binarySearch(this.returnStates,x)}get size(){return this.returnStates.length}get isEmpty(){return!1}get hasEmpty(){return this.returnStates[this.returnStates.length-1]===h.EMPTY_FULL_STATE_KEY}addEmptyContext(){if(this.hasEmpty)return this;let x=this.parents.slice(0),v=this.returnStates.slice(0);return x.push(h.EMPTY_FULL),v.push(h.EMPTY_FULL_STATE_KEY),new jn(x,v)}removeEmptyContext(){if(!this.hasEmpty)return this;if(this.returnStates.length===2)return new p(this.parents[0],this.returnStates[0]);{let x=this.parents.slice(0,this.parents.length-1),v=this.returnStates.slice(0,this.returnStates.length-1);return new jn(x,v)}}appendContext(x,v){return jn.appendContextImpl(this,x,new h.IdentityHashMap)}static appendContextImpl(x,v,m){if(v.isEmpty){if(h.isEmptyLocal(v)){if(x.hasEmpty)return h.EMPTY_LOCAL;throw new Error("what to do here?")}return x}if(v.size!==1)throw new Error("Appending a tree suffix is not yet supported.");let g=m.get(x);if(!g){if(x.isEmpty)g=v;else{let S=x.size;x.hasEmpty&&S--;let C=new Array(S),A=new Array(S);for(let b=0;b<S;b++)A[b]=x.getReturnState(b);for(let b=0;b<S;b++)C[b]=jn.appendContextImpl(x.getParent(b),v,m);C.length===1?g=new p(C[0],A[0]):(c(C.length>1),g=new jn(C,A)),x.hasEmpty&&(g=h.join(g,v))}m.put(x,g)}return g}equals(x){if(this===x)return!0;if(!(x instanceof jn)||this.hashCode()!==x.hashCode())return!1;let v=x;return this.equalsImpl(v,new o.Array2DHashSet)}equalsImpl(x,v){let m=[],g=[];for(m.push(this),g.push(x);;){let S=m.pop(),C=g.pop();if(!S||!C)break;let A=new a.PredictionContextCache.IdentityCommutativePredictionContextOperands(S,C);if(!v.add(A))continue;let b=A.x.size;if(b===0){if(!A.x.equals(A.y))return!1;continue}let R=A.y.size;if(b!==R)return!1;for(let w=0;w<b;w++){if(A.x.getReturnState(w)!==A.y.getReturnState(w))return!1;let P=A.x.getParent(w),M=A.y.getParent(w);if(P.hashCode()!==M.hashCode())return!1;P!==M&&(m.push(P),g.push(M))}}return!0}};e([s.NotNull],d.prototype,"parents",void 0),e([s.NotNull],d.prototype,"returnStates",void 0),e([s.Override],d.prototype,"getParent",null),e([s.Override],d.prototype,"getReturnState",null),e([s.Override],d.prototype,"findReturnState",null),e([s.Override],d.prototype,"size",null),e([s.Override],d.prototype,"isEmpty",null),e([s.Override],d.prototype,"hasEmpty",null),e([s.Override],d.prototype,"addEmptyContext",null),e([s.Override],d.prototype,"removeEmptyContext",null),e([s.Override],d.prototype,"appendContext",null),e([s.Override],d.prototype,"equals",null),d=e([t(0,s.NotNull)],d);let p=class Ed extends h{constructor(x,v){super(h.calculateSingleHashCode(x,v)),this.parent=x,this.returnState=v}getParent(x){return this.parent}getReturnState(x){return this.returnState}findReturnState(x){return this.returnState===x?0:-1}get size(){return 1}get isEmpty(){return!1}get hasEmpty(){return!1}appendContext(x,v){return v.getChild(this.parent.appendContext(x,v),this.returnState)}addEmptyContext(){let x=[this.parent,h.EMPTY_FULL],v=[this.returnState,h.EMPTY_FULL_STATE_KEY];return new d(x,v)}removeEmptyContext(){return this}equals(x){if(x===this)return!0;if(!(x instanceof Ed))return!1;let v=x;return this.hashCode()!==v.hashCode()?!1:this.returnState===v.returnState&&this.parent.equals(v.parent)}};e([s.NotNull],p.prototype,"parent",void 0),e([s.Override],p.prototype,"getParent",null),e([s.Override],p.prototype,"getReturnState",null),e([s.Override],p.prototype,"findReturnState",null),e([s.Override],p.prototype,"size",null),e([s.Override],p.prototype,"isEmpty",null),e([s.Override],p.prototype,"hasEmpty",null),e([s.Override],p.prototype,"appendContext",null),e([s.Override],p.prototype,"addEmptyContext",null),e([s.Override],p.prototype,"removeEmptyContext",null),e([s.Override],p.prototype,"equals",null),p=e([t(0,s.NotNull)],p),l.SingletonPredictionContext=p,function(y){y.EMPTY_LOCAL=new f(!1),y.EMPTY_FULL=new f(!0),y.EMPTY_LOCAL_STATE_KEY=-2147483648,y.EMPTY_FULL_STATE_KEY=(1<<31>>>0)-1;class x extends r.Array2DHashMap{constructor(){super(v.INSTANCE)}}y.IdentityHashMap=x;class v{IdentityEqualityComparator(){}hashCode(g){return g.hashCode()}equals(g,S){return g===S}}v.INSTANCE=new v,e([s.Override],v.prototype,"hashCode",null),e([s.Override],v.prototype,"equals",null),y.IdentityEqualityComparator=v}(h=l.PredictionContext||(l.PredictionContext={}))}(Xr)),Xr}var yc;function wo(){if(yc)return Ct;yc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ct&&Ct.__decorate||function(y,x,v,m){var g=arguments.length,S=g<3?x:m===null?m=Object.getOwnPropertyDescriptor(x,v):m,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(y,x,v,m);else for(var A=y.length-1;A>=0;A--)(C=y[A])&&(S=(g<3?C(S):g>3?C(x,v,S):C(x,v))||S);return g>3&&S&&Object.defineProperty(x,v,S),S},e=Ct&&Ct.__param||function(y,x){return function(v,m){x(v,m,y)}};Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.ATNConfig=void 0;const t=ai(),r=$n(),o=je(),i=Z(),n=ht(),s=lt(),a=si(),c=Ve(),u=2147483648;let h=class Mi{constructor(x,v,m){typeof v=="number"?(c((v&16777215)===v),this._state=x,this.altAndOuterContextDepth=v,this._context=m):(this._state=x,this.altAndOuterContextDepth=v.altAndOuterContextDepth,this._context=m)}static create(x,v,m,g=a.SemanticContext.NONE,S){return g!==a.SemanticContext.NONE?S!=null?new p(S,g,x,v,m,!1):new f(g,x,v,m):S!=null?new d(S,x,v,m,!1):new Mi(x,v,m)}get state(){return this._state}get alt(){return this.altAndOuterContextDepth&16777215}get context(){return this._context}set context(x){this._context=x}get reachesIntoOuterContext(){return this.outerContextDepth!==0}get outerContextDepth(){return this.altAndOuterContextDepth>>>24&127}set outerContextDepth(x){c(x>=0),x=Math.min(x,127),this.altAndOuterContextDepth=x<<24|(this.altAndOuterContextDepth&-2130706433)>>>0}get lexerActionExecutor(){}get semanticContext(){return a.SemanticContext.NONE}get hasPassedThroughNonGreedyDecision(){return!1}clone(){return this.transform(this.state,!1)}transform(x,v,m){return m==null?this.transformImpl(x,this._context,this.semanticContext,v,this.lexerActionExecutor):m instanceof s.PredictionContext?this.transformImpl(x,m,this.semanticContext,v,this.lexerActionExecutor):m instanceof a.SemanticContext?this.transformImpl(x,this._context,m,v,this.lexerActionExecutor):this.transformImpl(x,this._context,this.semanticContext,v,m)}transformImpl(x,v,m,g,S){let C=g&&Mi.checkNonGreedyDecision(this,x);return m!==a.SemanticContext.NONE?S!=null||C?new p(S,m,x,this,v,C):new f(m,x,this,v):S!=null||C?new d(S,x,this,v,C):new Mi(x,this,v)}static checkNonGreedyDecision(x,v){return x.hasPassedThroughNonGreedyDecision||v instanceof r.DecisionState&&v.nonGreedy}appendContext(x,v){if(typeof x=="number"){let m=this.context.appendSingleContext(x,v);return this.transform(this.state,!1,m)}else{let m=this.context.appendContext(x,v);return this.transform(this.state,!1,m)}}contains(x){if(this.state.stateNumber!==x.state.stateNumber||this.alt!==x.alt||!this.semanticContext.equals(x.semanticContext))return!1;let v=[],m=[];for(v.push(this.context),m.push(x.context);;){let g=v.pop(),S=m.pop();if(!g||!S)break;if(g===S)return!0;if(g.size<S.size)return!1;if(S.isEmpty)return g.hasEmpty;for(let C=0;C<S.size;C++){let A=g.findReturnState(S.getReturnState(C));if(A<0)return!1;v.push(g.getParent(A)),m.push(S.getParent(C))}}return!1}get isPrecedenceFilterSuppressed(){return(this.altAndOuterContextDepth&u)!==0}set isPrecedenceFilterSuppressed(x){x?this.altAndOuterContextDepth|=u:this.altAndOuterContextDepth&=2147483647}equals(x){return this===x?!0:x instanceof Mi?this.state.stateNumber===x.state.stateNumber&&this.alt===x.alt&&this.reachesIntoOuterContext===x.reachesIntoOuterContext&&this.context.equals(x.context)&&this.semanticContext.equals(x.semanticContext)&&this.isPrecedenceFilterSuppressed===x.isPrecedenceFilterSuppressed&&this.hasPassedThroughNonGreedyDecision===x.hasPassedThroughNonGreedyDecision&&n.ObjectEqualityComparator.INSTANCE.equals(this.lexerActionExecutor,x.lexerActionExecutor):!1}hashCode(){let x=o.MurmurHash.initialize(7);return x=o.MurmurHash.update(x,this.state.stateNumber),x=o.MurmurHash.update(x,this.alt),x=o.MurmurHash.update(x,this.reachesIntoOuterContext?1:0),x=o.MurmurHash.update(x,this.context),x=o.MurmurHash.update(x,this.semanticContext),x=o.MurmurHash.update(x,this.hasPassedThroughNonGreedyDecision?1:0),x=o.MurmurHash.update(x,this.lexerActionExecutor),x=o.MurmurHash.finish(x,7),x}toDotString(){let x="";x+=`digraph G {
`,x+=`rankdir=LR;
`;let v=new t.Array2DHashMap(s.PredictionContext.IdentityEqualityComparator.INSTANCE),m=[];function g(S){let C=v.size,A=v.putIfAbsent(S,C);return A??(m.push(S),C)}for(m.push(this.context),v.put(this.context,0);;){let S=m.pop();if(!S)break;for(let C=0;C<S.size;C++)x+="  s"+g(S),x+="->",x+="s"+g(S.getParent(C)),x+='[label="'+S.getReturnState(C)+`"];
`}return x+=`}
`,x.toString()}toString(x,v,m){m==null&&(m=v!=null),v==null&&(v=!0);let g="",S;m?S=this.context.toStrings(x,this.state.stateNumber):S=["?"];let C=!0;for(let A of S)C?C=!1:g+=", ",g+="(",g+=this.state,v&&(g+=",",g+=this.alt),this.context&&(g+=",",g+=A),this.semanticContext!==a.SemanticContext.NONE&&(g+=",",g+=this.semanticContext),this.reachesIntoOuterContext&&(g+=",up="+this.outerContextDepth),g+=")";return g.toString()}};l([i.NotNull],h.prototype,"_state",void 0),l([i.NotNull],h.prototype,"_context",void 0),l([i.NotNull],h.prototype,"state",null),l([i.NotNull,e(0,i.NotNull)],h.prototype,"context",null),l([i.NotNull],h.prototype,"semanticContext",null),l([i.Override],h.prototype,"clone",null),l([e(0,i.NotNull),e(2,i.NotNull)],h.prototype,"transformImpl",null),l([i.Override],h.prototype,"equals",null),l([i.Override],h.prototype,"hashCode",null),l([e(0,i.NotNull),e(3,i.NotNull)],h,"create",null),h=l([e(0,i.NotNull),e(2,i.NotNull)],h),Ct.ATNConfig=h;let f=class extends h{constructor(x,v,m,g){typeof m=="number"?super(v,m,g):super(v,m,g),this._semanticContext=x}get semanticContext(){return this._semanticContext}};l([i.NotNull],f.prototype,"_semanticContext",void 0),l([i.Override],f.prototype,"semanticContext",null),f=l([e(1,i.NotNull),e(2,i.NotNull)],f);let d=class extends h{constructor(x,v,m,g,S){if(typeof m=="number")super(v,m,g);else if(super(v,m,g),m.semanticContext!==a.SemanticContext.NONE)throw new Error("Not supported");this._lexerActionExecutor=x,this.passedThroughNonGreedyDecision=S}get lexerActionExecutor(){return this._lexerActionExecutor}get hasPassedThroughNonGreedyDecision(){return this.passedThroughNonGreedyDecision}};l([i.Override],d.prototype,"lexerActionExecutor",null),l([i.Override],d.prototype,"hasPassedThroughNonGreedyDecision",null),d=l([e(1,i.NotNull),e(2,i.NotNull)],d);let p=class extends f{constructor(x,v,m,g,S,C){typeof g=="number"?super(v,m,g,S):super(v,m,g,S),this._lexerActionExecutor=x,this.passedThroughNonGreedyDecision=C}get lexerActionExecutor(){return this._lexerActionExecutor}get hasPassedThroughNonGreedyDecision(){return this.passedThroughNonGreedyDecision}};return l([i.Override],p.prototype,"lexerActionExecutor",null),l([i.Override],p.prototype,"hasPassedThroughNonGreedyDecision",null),p=l([e(1,i.NotNull),e(2,i.NotNull)],p),Ct}var Si={},vc;function Pr(){if(vc)return Si;vc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Si,"__esModule",{value:!0}),Si.BitSet=void 0;const l=Jn(),e=je(),t=new Uint16Array(0);function r(h){return h>>>4}function o(h){return h*16}function i(h){let f=1;for(let d=0;d<16;d++){if((h&f)!==0)return d;f=f<<1>>>0}throw new RangeError("No specified bit found")}function n(h){let f=32768;for(let d=15;d>=0;d--){if((h&f)!==0)return d;f=f>>>1}throw new RangeError("No specified bit found")}function s(h,f){return h&=15,f&=15,h===f?1<<h>>>0:65535>>>15-f^65535>>>16-h}const a=new Uint8Array(65536);for(let h=0;h<16;h++){const f=1<<h>>>0;let d=0;for(;d<a.length;){d+=f;for(let p=0;p<f;p++)a[d]++,d++}}let c=class ki{constructor(f){if(!f)this.data=t;else if(typeof f=="number"){if(f<0)throw new RangeError("nbits cannot be negative");this.data=new Uint16Array(r(f-1)+1)}else if(f instanceof ki)this.data=f.data.slice(0);else{let d=-1;for(let p of f)d<p&&(d=p);this.data=new Uint16Array(r(d-1)+1);for(let p of f)this.set(p)}}and(f){const d=this.data,p=f.data,y=Math.min(d.length,p.length);let x=-1;for(let v=0;v<y;v++)(d[v]&=p[v])!==0&&(x=v);x===-1&&(this.data=t),x<d.length-1&&(this.data=d.slice(0,x+1))}andNot(f){const d=this.data,p=f.data,y=Math.min(d.length,p.length);let x=-1;for(let v=0;v<y;v++)(d[v]&=p[v]^65535)!==0&&(x=v);x===-1&&(this.data=t),x<d.length-1&&(this.data=d.slice(0,x+1))}cardinality(){if(this.isEmpty)return 0;const f=this.data,d=f.length;let p=0;for(let y=0;y<d;y++)p+=a[f[y]];return p}clear(f,d){f==null?this.data.fill(0):d==null?this.set(f,!1):this.set(f,d,!1)}flip(f,d){if(d==null&&(d=f),f<0||d<f)throw new RangeError;let p=r(f);const y=r(d);if(p===y)this.data[p]^=s(f,d);else{for(this.data[p++]^=s(f,15);p<y;)this.data[p++]^=65535;this.data[p++]^=s(0,d)}}get(f,d){if(d===void 0)return!!(this.data[r(f)]&s(f,f));{let p=new ki(d+1);for(let y=f;y<=d;y++)p.set(y,this.get(y));return p}}intersects(f){let d=Math.min(this.length(),f.length());if(d===0)return!1;let p=r(d-1);for(let y=0;y<=p;y++)if((this.data[y]&f.data[y])!==0)return!0;return!1}get isEmpty(){return this.length()===0}length(){return this.data.length?this.previousSetBit(o(this.data.length)-1)+1:0}nextClearBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let y=r(f);if(y>p)return-1;let x=65535^s(f,15);if((d[y]|x)===65535){for(y++,x=0;y<p&&d[y]===65535;y++);if(y===p)return-1}return o(y)+i((d[y]|x)^65535)}nextSetBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let y=r(f);if(y>p)return-1;let x=s(f,15);if((d[y]&x)===0){for(y++,x=65535;y<p&&d[y]===0;y++);if(y>=p)return-1}return o(y)+i(d[y]&x)}or(f){const d=this.data,p=f.data,y=Math.min(d.length,p.length),x=Math.max(d.length,p.length),v=d.length===x?d:new Uint16Array(x);let m=-1;for(let S=0;S<y;S++)(v[S]=d[S]|p[S])!==0&&(m=S);const g=d.length>p.length?d:p;for(let S=y;S<x;S++)(v[S]=g[S])!==0&&(m=S);m===-1?this.data=t:v.length===m+1?this.data=v:this.data=v.slice(0,m)}previousClearBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let y=r(f);y>=p&&(y=p-1);let x=65535^s(0,f);if((d[y]|x)===65535){for(x=0,y--;y>=0&&d[y]===65535;y--);if(y<0)return-1}return o(y)+n((d[y]|x)^65535)}previousSetBit(f){if(f<0)throw new RangeError("fromIndex cannot be negative");const d=this.data,p=d.length;let y=r(f);y>=p&&(y=p-1);let x=s(0,f);if((d[y]&x)===0){for(y--,x=65535;y>=0&&d[y]===0;y--);if(y<0)return-1}return o(y)+n(d[y]&x)}set(f,d,p){if(d===void 0?(d=f,p=!0):typeof d=="boolean"&&(p=d,d=f),p===void 0&&(p=!0),f<0||f>d)throw new RangeError;let y=r(f),x=r(d);if(p&&x>=this.data.length){let v=new Uint16Array(x+1);this.data.forEach((m,g)=>v[g]=m),this.data=v}else if(!p){if(y>=this.data.length)return;x>=this.data.length&&(x=this.data.length-1,d=this.data.length*16-1)}if(y===x)this._setBits(y,p,s(f,d));else{for(this._setBits(y++,p,s(f,15));y<x;)this.data[y++]=p?65535:0;this._setBits(y,p,s(0,d))}}_setBits(f,d,p){d?this.data[f]|=p:this.data[f]&=65535^p}get size(){return this.data.byteLength*8}hashCode(){return e.MurmurHash.hashCode(this.data,22)}equals(f){if(f===this)return!0;if(!(f instanceof ki))return!1;const d=this.length();if(d!==f.length())return!1;if(d===0)return!0;let p=r(d-1);for(let y=0;y<=p;y++)if(this.data[y]!==f.data[y])return!1;return!0}toString(){let f="{",d=!0;for(let p=this.nextSetBit(0);p>=0;p=this.nextSetBit(p+1))d?d=!1:f+=", ",f+=p;return f+="}",f}xor(f){const d=this.data,p=f.data,y=Math.min(d.length,p.length),x=Math.max(d.length,p.length),v=d.length===x?d:new Uint16Array(x);let m=-1;for(let S=0;S<y;S++)(v[S]=d[S]^p[S])!==0&&(m=S);const g=d.length>p.length?d:p;for(let S=y;S<x;S++)(v[S]=g[S])!==0&&(m=S);m===-1?this.data=t:v.length===m+1?this.data=v:this.data=v.slice(0,m+1)}clone(){return new ki(this)}[Symbol.iterator](){return new u(this.data)}[l.inspect.custom](){return"BitSet "+this.toString()}};Si.BitSet=c;class u{constructor(f){this.data=f,this.index=0,this.mask=65535}next(){for(;this.index<this.data.length;){const f=this.data[this.index]&this.mask;if(f!==0){const d=o(this.index)+i(f);return this.mask=s(d+1,15),{done:!1,value:d}}this.index++,this.mask=65535}return{done:!0,value:-1}}[Symbol.iterator](){return this}}return Si}var Sc;function Ki(){if(Sc)return Yr;Sc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Yr&&Yr.__decorate||function(v,m,g,S){var C=arguments.length,A=C<3?m:S===null?S=Object.getOwnPropertyDescriptor(m,g):S,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(v,m,g,S);else for(var R=v.length-1;R>=0;R--)(b=v[R])&&(A=(C<3?b(A):C>3?b(m,g,A):b(m,g))||A);return C>3&&A&&Object.defineProperty(m,g,A),A};Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.ATNConfigSet=void 0;const e=ai(),t=Fr(),r=To(),o=ft(),i=wo(),n=Pr(),s=Z(),a=ht(),c=lt(),u=el(),h=si(),f=Ve(),d=vr();class p{hashCode(m){return m.state^m.alt}equals(m,g){return m.state===g.state&&m.alt===g.alt}}p.INSTANCE=new p;function y(v){return v?new e.Array2DHashMap(v):new e.Array2DHashMap(p.INSTANCE)}let x=class Oa{constructor(m,g){this._uniqueAlt=0,this._hasSemanticContext=!1,this._dipsIntoOuterContext=!1,this.outermostConfigSet=!1,this.cachedHashCode=-1,m?(g?(this.mergedConfigs=void 0,this.unmerged=void 0):m.isReadOnly?(this.mergedConfigs=y(),this.unmerged=[]):(this.mergedConfigs=y(m.mergedConfigs),this.unmerged=m.unmerged.slice(0)),this.configs=m.configs.slice(0),this._dipsIntoOuterContext=m._dipsIntoOuterContext,this._hasSemanticContext=m._hasSemanticContext,this.outermostConfigSet=m.outermostConfigSet,(g||!m.isReadOnly)&&(this._uniqueAlt=m._uniqueAlt,this._conflictInfo=m._conflictInfo)):(this.mergedConfigs=y(),this.unmerged=[],this.configs=[],this._uniqueAlt=o.ATN.INVALID_ALT_NUMBER)}getRepresentedAlternatives(){if(this._conflictInfo!=null)return this._conflictInfo.conflictedAlts.clone();let m=new n.BitSet;for(let g of this)m.set(g.alt);return m}get isReadOnly(){return this.mergedConfigs==null}get isOutermostConfigSet(){return this.outermostConfigSet}set isOutermostConfigSet(m){if(this.outermostConfigSet&&!m)throw new Error("IllegalStateException");f(!m||!this._dipsIntoOuterContext),this.outermostConfigSet=m}getStates(){let m=new t.Array2DHashSet(a.ObjectEqualityComparator.INSTANCE);for(let g of this.configs)m.add(g.state);return m}optimizeConfigs(m){if(this.configs.length!==0)for(let g of this.configs)g.context=m.atn.getCachedContext(g.context)}clone(m){let g=new Oa(this,m);return!m&&this.isReadOnly&&g.addAll(this.configs),g}get size(){return this.configs.length}get isEmpty(){return this.configs.length===0}contains(m){if(!(m instanceof i.ATNConfig))return!1;if(this.mergedConfigs&&this.unmerged){let g=m,S=this.getKey(g),C=this.mergedConfigs.get(S);if(C!=null&&this.canMerge(g,S,C))return C.contains(g);for(let A of this.unmerged)if(A.contains(m))return!0}else for(let g of this.configs)if(g.contains(m))return!0;return!1}*[Symbol.iterator](){yield*this.configs}toArray(){return this.configs}add(m,g){if(this.ensureWritable(),!this.mergedConfigs||!this.unmerged)throw new Error("Covered by ensureWritable but duplicated here for strict null check limitation");f(!this.outermostConfigSet||!m.reachesIntoOuterContext),g==null&&(g=u.PredictionContextCache.UNCACHED);let S,C=this.getKey(m),A=this.mergedConfigs.get(C);if(S=A==null,A!=null&&this.canMerge(m,C,A)){A.outerContextDepth=Math.max(A.outerContextDepth,m.outerContextDepth),m.isPrecedenceFilterSuppressed&&(A.isPrecedenceFilterSuppressed=!0);let b=c.PredictionContext.join(A.context,m.context,g);return this.updatePropertiesForMergedConfig(m),A.context===b?!1:(A.context=b,!0)}for(let b=0;b<this.unmerged.length;b++){let R=this.unmerged[b];if(this.canMerge(m,C,R)){R.outerContextDepth=Math.max(R.outerContextDepth,m.outerContextDepth),m.isPrecedenceFilterSuppressed&&(R.isPrecedenceFilterSuppressed=!0);let w=c.PredictionContext.join(R.context,m.context,g);return this.updatePropertiesForMergedConfig(m),R.context===w?!1:(R.context=w,S&&(this.mergedConfigs.put(C,R),this.unmerged.splice(b,1)),!0)}}return this.configs.push(m),S?this.mergedConfigs.put(C,m):this.unmerged.push(m),this.updatePropertiesForAddedConfig(m),!0}updatePropertiesForMergedConfig(m){this._dipsIntoOuterContext=this._dipsIntoOuterContext||m.reachesIntoOuterContext,f(!this.outermostConfigSet||!this._dipsIntoOuterContext)}updatePropertiesForAddedConfig(m){this.configs.length===1?this._uniqueAlt=m.alt:this._uniqueAlt!==m.alt&&(this._uniqueAlt=o.ATN.INVALID_ALT_NUMBER),this._hasSemanticContext=this._hasSemanticContext||!h.SemanticContext.NONE.equals(m.semanticContext),this._dipsIntoOuterContext=this._dipsIntoOuterContext||m.reachesIntoOuterContext,f(!this.outermostConfigSet||!this._dipsIntoOuterContext)}canMerge(m,g,S){return m.state.stateNumber!==S.state.stateNumber||g.alt!==S.alt?!1:m.semanticContext.equals(S.semanticContext)}getKey(m){return{state:m.state.stateNumber,alt:m.alt}}containsAll(m){for(let g of m)if(!(g instanceof i.ATNConfig)||!this.contains(g))return!1;return!0}addAll(m,g){this.ensureWritable();let S=!1;for(let C of m)this.add(C,g)&&(S=!0);return S}clear(){if(this.ensureWritable(),!this.mergedConfigs||!this.unmerged)throw new Error("Covered by ensureWritable but duplicated here for strict null check limitation");this.mergedConfigs.clear(),this.unmerged.length=0,this.configs.length=0,this._dipsIntoOuterContext=!1,this._hasSemanticContext=!1,this._uniqueAlt=o.ATN.INVALID_ALT_NUMBER,this._conflictInfo=void 0}equals(m){return this===m?!0:m instanceof Oa?this.outermostConfigSet===m.outermostConfigSet&&d.equals(this._conflictInfo,m._conflictInfo)&&r.ArrayEqualityComparator.INSTANCE.equals(this.configs,m.configs):!1}hashCode(){if(this.isReadOnly&&this.cachedHashCode!==-1)return this.cachedHashCode;let m=1;return m=5*m^(this.outermostConfigSet?1:0),m=5*m^r.ArrayEqualityComparator.INSTANCE.hashCode(this.configs),this.isReadOnly&&(this.cachedHashCode=m),m}toString(m){m==null&&(m=!1);let g="",S=this.configs.slice(0);S.sort((C,A)=>C.alt!==A.alt?C.alt-A.alt:C.state.stateNumber!==A.state.stateNumber?C.state.stateNumber-A.state.stateNumber:C.semanticContext.toString().localeCompare(A.semanticContext.toString())),g+="[";for(let C=0;C<S.length;C++)C>0&&(g+=", "),g+=S[C].toString(void 0,!0,m);return g+="]",this._hasSemanticContext&&(g+=",hasSemanticContext="+this._hasSemanticContext),this._uniqueAlt!==o.ATN.INVALID_ALT_NUMBER&&(g+=",uniqueAlt="+this._uniqueAlt),this._conflictInfo!=null&&(g+=",conflictingAlts="+this._conflictInfo.conflictedAlts,this._conflictInfo.isExact||(g+="*")),this._dipsIntoOuterContext&&(g+=",dipsIntoOuterContext"),g.toString()}get uniqueAlt(){return this._uniqueAlt}get hasSemanticContext(){return this._hasSemanticContext}set hasSemanticContext(m){this.ensureWritable(),this._hasSemanticContext=m}get conflictInfo(){return this._conflictInfo}set conflictInfo(m){this.ensureWritable(),this._conflictInfo=m}get conflictingAlts(){if(this._conflictInfo!=null)return this._conflictInfo.conflictedAlts}get isExactConflict(){return this._conflictInfo==null?!1:this._conflictInfo.isExact}get dipsIntoOuterContext(){return this._dipsIntoOuterContext}get(m){return this.configs[m]}ensureWritable(){if(this.isReadOnly)throw new Error("This ATNConfigSet is read only.")}};return l([s.NotNull],x.prototype,"getRepresentedAlternatives",null),l([s.Override],x.prototype,"size",null),l([s.Override],x.prototype,"isEmpty",null),l([s.Override],x.prototype,"contains",null),l([s.Override],x.prototype,Symbol.iterator,null),l([s.Override],x.prototype,"toArray",null),l([s.Override],x.prototype,"containsAll",null),l([s.Override],x.prototype,"clear",null),l([s.Override],x.prototype,"equals",null),l([s.Override],x.prototype,"hashCode",null),Yr.ATNConfigSet=x,Yr}var Kr={},Qr={},Jr={},Ac;function No(){return Ac||(Ac=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Jr&&Jr.__decorate||function(u,h,f,d){var p=arguments.length,y=p<3?h:d===null?d=Object.getOwnPropertyDescriptor(h,f):d,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(u,h,f,d);else for(var v=u.length-1;v>=0;v--)(x=u[v])&&(y=(p<3?x(y):p>3?x(h,f,y):x(h,f))||y);return p>3&&y&&Object.defineProperty(h,f,y),y},t=Jr&&Jr.__param||function(u,h){return function(f,d){h(f,d,u)}};Object.defineProperty(l,"__esModule",{value:!0}),l.DFAState=void 0;const r=ft(),o=Pr(),i=je(),n=Z(),s=lt(),a=Ve();let c=class _d{constructor(h){this.stateNumber=-1,this.configs=h,this.edges=new Map,this.contextEdges=new Map}get isContextSensitive(){return!!this.contextSymbols}isContextSymbol(h){return this.isContextSensitive?this.contextSymbols.get(h):!1}setContextSymbol(h){a(this.isContextSensitive),this.contextSymbols.set(h)}setContextSensitive(h){a(!this.configs.isOutermostConfigSet),!this.isContextSensitive&&(this.contextSymbols||(this.contextSymbols=new o.BitSet))}get acceptStateInfo(){return this._acceptStateInfo}set acceptStateInfo(h){this._acceptStateInfo=h}get isAcceptState(){return!!this._acceptStateInfo}get prediction(){return this._acceptStateInfo?this._acceptStateInfo.prediction:r.ATN.INVALID_ALT_NUMBER}get lexerActionExecutor(){if(this._acceptStateInfo)return this._acceptStateInfo.lexerActionExecutor}getTarget(h){return this.edges.get(h)}setTarget(h,f){this.edges.set(h,f)}getEdgeMap(){return this.edges}getContextTarget(h){return h===s.PredictionContext.EMPTY_FULL_STATE_KEY&&(h=-1),this.contextEdges.get(h)}setContextTarget(h,f){if(!this.isContextSensitive)throw new Error("The state is not context sensitive.");h===s.PredictionContext.EMPTY_FULL_STATE_KEY&&(h=-1),this.contextEdges.set(h,f)}getContextEdgeMap(){let h=new Map(this.contextEdges),f=h.get(-1);if(f!==void 0)if(h.size===1){let d=new Map;return d.set(s.PredictionContext.EMPTY_FULL_STATE_KEY,f),d}else h.delete(-1),h.set(s.PredictionContext.EMPTY_FULL_STATE_KEY,f);return h}hashCode(){let h=i.MurmurHash.initialize(7);return h=i.MurmurHash.update(h,this.configs.hashCode()),h=i.MurmurHash.finish(h,1),h}equals(h){if(this===h)return!0;if(!(h instanceof _d))return!1;let f=h;return this.configs.equals(f.configs)}toString(){let h="";return h+=this.stateNumber+":"+this.configs,this.isAcceptState&&(h+="=>",this.predicates?h+=this.predicates:h+=this.prediction),h.toString()}};e([n.NotNull],c.prototype,"configs",void 0),e([n.NotNull],c.prototype,"edges",void 0),e([n.NotNull],c.prototype,"contextEdges",void 0),e([n.Override],c.prototype,"hashCode",null),e([n.Override],c.prototype,"equals",null),e([n.Override],c.prototype,"toString",null),l.DFAState=c,function(u){let h=class{constructor(d,p){this.alt=p,this.pred=d}toString(){return"("+this.pred+", "+this.alt+")"}};e([n.NotNull],h.prototype,"pred",void 0),e([n.Override],h.prototype,"toString",null),h=e([t(0,n.NotNull)],h),u.PredPrediction=h}(c=l.DFAState||(l.DFAState={}))}(Jr)),Jr}var Cc;function Oo(){return Cc||(Cc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Qr&&Qr.__decorate||function(a,c,u,h){var f=arguments.length,d=f<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,u):h,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(a,c,u,h);else for(var y=a.length-1;y>=0;y--)(p=a[y])&&(d=(f<3?p(d):f>3?p(c,u,d):p(c,u))||d);return f>3&&d&&Object.defineProperty(c,u,d),d},t=Qr&&Qr.__param||function(a,c){return function(u,h){c(u,h,a)}};Object.defineProperty(l,"__esModule",{value:!0}),l.ATNSimulator=void 0;const r=Ki(),o=No(),i=Z(),n=lt();let s=class zi{constructor(c){this.atn=c}static get ERROR(){return zi._ERROR||(zi._ERROR=new o.DFAState(new r.ATNConfigSet),zi._ERROR.stateNumber=n.PredictionContext.EMPTY_FULL_STATE_KEY),zi._ERROR}clearDFA(){this.atn.clearDFA()}};e([i.NotNull],s.prototype,"atn",void 0),e([i.NotNull],s,"ERROR",null),s=e([t(0,i.NotNull)],s),l.ATNSimulator=s,s=l.ATNSimulator||(l.ATNSimulator={}),l.ATNSimulator=s}(Qr)),Qr}var Et={},Ai={},Ec;function Td(){if(Ec)return Ai;Ec=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.ConsoleErrorListener=void 0;let l=class{syntaxError(t,r,o,i,n,s){console.error(`line ${o}:${i} ${n}`)}};return Ai.ConsoleErrorListener=l,l.INSTANCE=new l,Ai}var _t={},_c;function tl(){if(_c)return _t;_c=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=_t&&_t.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c},e=_t&&_t.__param||function(o,i){return function(n,s){i(n,s,o)}};Object.defineProperty(_t,"__esModule",{value:!0}),_t.ProxyErrorListener=void 0;const t=Z();let r=class{constructor(i){if(this.delegates=i,!i)throw new Error("Invalid delegates")}getDelegates(){return this.delegates}syntaxError(i,n,s,a,c,u){this.delegates.forEach(h=>{h.syntaxError&&h.syntaxError(i,n,s,a,c,u)})}};return l([t.Override,e(0,t.NotNull),e(4,t.NotNull)],r.prototype,"syntaxError",null),_t.ProxyErrorListener=r,_t}var Tc;function Qi(){if(Tc)return Et;Tc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Et&&Et.__decorate||function(a,c,u,h){var f=arguments.length,d=f<3?c:h===null?h=Object.getOwnPropertyDescriptor(c,u):h,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(a,c,u,h);else for(var y=a.length-1;y>=0;y--)(p=a[y])&&(d=(f<3?p(d):f>3?p(c,u,d):p(c,u))||d);return f>3&&d&&Object.defineProperty(c,u,d),d},e=Et&&Et.__param||function(a,c){return function(u,h){c(u,h,a)}};Object.defineProperty(Et,"__esModule",{value:!0}),Et.Recognizer=void 0;const t=Td(),r=tl(),o=Z(),i=Be(),n=vr();let s=class ji{constructor(){this._listeners=[t.ConsoleErrorListener.INSTANCE],this._stateNumber=-1}getTokenTypeMap(){let c=this.vocabulary,u=ji.tokenTypeMapCache.get(c);if(u==null){let h=new Map;for(let f=0;f<=this.atn.maxTokenType;f++){let d=c.getLiteralName(f);d!=null&&h.set(d,f);let p=c.getSymbolicName(f);p!=null&&h.set(p,f)}h.set("EOF",i.Token.EOF),u=h,ji.tokenTypeMapCache.set(c,u)}return u}getRuleIndexMap(){let c=this.ruleNames;if(c==null)throw new Error("The current recognizer does not provide a list of rule names.");let u=ji.ruleIndexMapCache.get(c);return u==null&&(u=n.toMap(c),ji.ruleIndexMapCache.set(c,u)),u}getTokenType(c){let u=this.getTokenTypeMap().get(c);return u??i.Token.INVALID_TYPE}get serializedATN(){throw new Error("there is no serialized ATN")}get atn(){return this._interp.atn}get interpreter(){return this._interp}set interpreter(c){this._interp=c}get parseInfo(){return Promise.resolve(void 0)}getErrorHeader(c){let u=c.getOffendingToken();if(!u)return"";let h=u.line,f=u.charPositionInLine;return"line "+h+":"+f}addErrorListener(c){if(!c)throw new TypeError("listener must not be null");this._listeners.push(c)}removeErrorListener(c){let u=this._listeners.indexOf(c);u!==-1&&this._listeners.splice(u,1)}removeErrorListeners(){this._listeners.length=0}getErrorListeners(){return this._listeners.slice(0)}getErrorListenerDispatch(){return new r.ProxyErrorListener(this.getErrorListeners())}sempred(c,u,h){return!0}precpred(c,u){return!0}action(c,u,h){}get state(){return this._stateNumber}set state(c){this._stateNumber=c}};return s.EOF=-1,s.tokenTypeMapCache=new WeakMap,s.ruleIndexMapCache=new WeakMap,l([o.SuppressWarnings("serial"),o.NotNull],s.prototype,"_listeners",void 0),l([o.NotNull],s.prototype,"getTokenTypeMap",null),l([o.NotNull],s.prototype,"getRuleIndexMap",null),l([o.NotNull],s.prototype,"serializedATN",null),l([o.NotNull],s.prototype,"atn",null),l([o.NotNull,e(0,o.NotNull)],s.prototype,"interpreter",null),l([o.NotNull,e(0,o.NotNull)],s.prototype,"getErrorHeader",null),l([e(0,o.NotNull)],s.prototype,"addErrorListener",null),l([e(0,o.NotNull)],s.prototype,"removeErrorListener",null),l([o.NotNull],s.prototype,"getErrorListeners",null),Et.Recognizer=s,Et}var Zr={},bc;function Vn(){if(bc)return Zr;bc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Zr&&Zr.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c};Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.VocabularyImpl=void 0;const e=Z(),t=Be();let r=class{constructor(i,n,s){this.literalNames=i,this.symbolicNames=n,this.displayNames=s,this._maxTokenType=Math.max(this.displayNames.length,Math.max(this.literalNames.length,this.symbolicNames.length))-1}get maxTokenType(){return this._maxTokenType}getLiteralName(i){if(i>=0&&i<this.literalNames.length)return this.literalNames[i]}getSymbolicName(i){if(i>=0&&i<this.symbolicNames.length)return this.symbolicNames[i];if(i===t.Token.EOF)return"EOF"}getDisplayName(i){if(i>=0&&i<this.displayNames.length){let a=this.displayNames[i];if(a)return a}let n=this.getLiteralName(i);if(n)return n;let s=this.getSymbolicName(i);return s||String(i)}};return r.EMPTY_VOCABULARY=new r([],[],[]),l([e.NotNull],r.prototype,"literalNames",void 0),l([e.NotNull],r.prototype,"symbolicNames",void 0),l([e.NotNull],r.prototype,"displayNames",void 0),l([e.Override],r.prototype,"maxTokenType",null),l([e.Override],r.prototype,"getLiteralName",null),l([e.Override],r.prototype,"getSymbolicName",null),l([e.Override,e.NotNull],r.prototype,"getDisplayName",null),l([e.NotNull],r,"EMPTY_VOCABULARY",void 0),Zr.VocabularyImpl=r,Zr}var Rc;function bd(){if(Rc)return Kr;Rc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Kr&&Kr.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f};Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.DFASerializer=void 0;const e=Oo(),t=Z(),r=lt(),o=Qi(),i=Vn();let n=class{constructor(a,c,u,h){c instanceof o.Recognizer?(u=c.ruleNames,h=c.atn,c=c.vocabulary):c||(c=i.VocabularyImpl.EMPTY_VOCABULARY),this.dfa=a,this.vocabulary=c,this.ruleNames=u,this.atn=h}toString(){if(!this.dfa.s0)return"";let a="";if(this.dfa.states){let u=new Array(...this.dfa.states.toArray());u.sort((h,f)=>h.stateNumber-f.stateNumber);for(let h of u){let f=h.getEdgeMap(),d=[...f.keys()].sort((x,v)=>x-v),p=h.getContextEdgeMap(),y=[...p.keys()].sort((x,v)=>x-v);for(let x of d){let v=f.get(x);if((v==null||v===e.ATNSimulator.ERROR)&&!h.isContextSymbol(x))continue;let m=!1;a+=this.getStateString(h)+"-"+this.getEdgeLabel(x)+"->",h.isContextSymbol(x)&&(a+="!",m=!0);let g=v;g&&g.stateNumber!==e.ATNSimulator.ERROR.stateNumber?a+=this.getStateString(g)+`
`:m&&(a+=`ctx
`)}if(h.isContextSensitive)for(let x of y)a+=this.getStateString(h)+"-"+this.getContextLabel(x)+"->"+this.getStateString(p.get(x))+`
`}}let c=a;return c.length===0?"":c}getContextLabel(a){if(a===r.PredictionContext.EMPTY_FULL_STATE_KEY)return"ctx:EMPTY_FULL";if(a===r.PredictionContext.EMPTY_LOCAL_STATE_KEY)return"ctx:EMPTY_LOCAL";if(this.atn&&a>0&&a<=this.atn.states.length){let u=this.atn.states[a].ruleIndex;if(this.ruleNames&&u>=0&&u<this.ruleNames.length)return"ctx:"+String(a)+"("+this.ruleNames[u]+")"}return"ctx:"+String(a)}getEdgeLabel(a){return this.vocabulary.getDisplayName(a)}getStateString(a){if(a===e.ATNSimulator.ERROR)return"ERROR";let c=a.stateNumber,u="s"+c;if(a.isAcceptState&&(a.predicates?u=":s"+c+"=>"+a.predicates:u=":s"+c+"=>"+a.prediction),a.isContextSensitive){u+="*";for(let h of a.configs)if(h.reachesIntoOuterContext){u+="*";break}}return u}};return l([t.NotNull],n.prototype,"dfa",void 0),l([t.NotNull],n.prototype,"vocabulary",void 0),l([t.Override],n.prototype,"toString",null),Kr.DFASerializer=n,Kr}var Tt={},wc;function F0(){if(wc)return Tt;wc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Tt&&Tt.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Tt&&Tt.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.LexerDFASerializer=void 0;const t=bd(),r=Z(),o=Vn();let i=class extends t.DFASerializer{constructor(s){super(s,o.VocabularyImpl.EMPTY_VOCABULARY)}getEdgeLabel(s){return"'"+String.fromCodePoint(s)+"'"}};return l([r.Override,r.NotNull],i.prototype,"getEdgeLabel",null),i=l([e(0,r.NotNull)],i),Tt.LexerDFASerializer=i,Tt}var en={},Nc;function rl(){if(Nc)return en;Nc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=en&&en.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(en,"__esModule",{value:!0}),en.StarLoopEntryState=void 0;const e=Ue(),t=Pr(),r=$n(),o=Z();let i=class extends r.DecisionState{constructor(){super(...arguments),this.precedenceRuleDecision=!1,this.precedenceLoopbackStates=new t.BitSet}get stateType(){return e.ATNStateType.STAR_LOOP_ENTRY}};return l([o.Override],i.prototype,"stateType",null),en.StarLoopEntryState=i,en}var Oc;function Rd(){if(Oc)return At;Oc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=At&&At.__decorate||function(f,d,p,y){var x=arguments.length,v=x<3?d:y===null?y=Object.getOwnPropertyDescriptor(d,p):y,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,d,p,y);else for(var g=f.length-1;g>=0;g--)(m=f[g])&&(v=(x<3?m(v):x>3?m(d,p,v):m(d,p))||v);return x>3&&v&&Object.defineProperty(d,p,v),v},e=At&&At.__param||function(f,d){return function(p,y){d(p,y,f)}};Object.defineProperty(At,"__esModule",{value:!0}),At.DFA=void 0;const t=Fr(),r=Ki(),o=bd(),i=No(),n=F0(),s=Z(),a=ht(),c=rl(),u=Vn();let h=class{constructor(d,p=0){if(this.states=new t.Array2DHashSet(a.ObjectEqualityComparator.INSTANCE),this.nextStateNumber=0,!d.atn)throw new Error("The ATNState must be associated with an ATN");this.atnStartState=d,this.atn=d.atn,this.decision=p;let y=!1;d instanceof c.StarLoopEntryState&&d.precedenceRuleDecision&&(y=!0,this.s0=new i.DFAState(new r.ATNConfigSet),this.s0full=new i.DFAState(new r.ATNConfigSet)),this.precedenceDfa=y}get isPrecedenceDfa(){return this.precedenceDfa}getPrecedenceStartState(d,p){if(!this.isPrecedenceDfa)throw new Error("Only precedence DFAs may contain a precedence start state.");return p?this.s0full.getTarget(d):this.s0.getTarget(d)}setPrecedenceStartState(d,p,y){if(!this.isPrecedenceDfa)throw new Error("Only precedence DFAs may contain a precedence start state.");d<0||(p?this.s0full.setTarget(d,y):this.s0.setTarget(d,y))}get isEmpty(){return this.isPrecedenceDfa?this.s0.getEdgeMap().size===0&&this.s0full.getEdgeMap().size===0:this.s0==null&&this.s0full==null}get isContextSensitive(){return this.isPrecedenceDfa?this.s0full.getEdgeMap().size>0:this.s0full!=null}addState(d){return d.stateNumber=this.nextStateNumber++,this.states.getOrAdd(d)}toString(d,p){if(d||(d=u.VocabularyImpl.EMPTY_VOCABULARY),!this.s0)return"";let y;return p?y=new o.DFASerializer(this,d,p,this.atnStartState.atn):y=new o.DFASerializer(this,d),y.toString()}toLexerString(){return this.s0?new n.LexerDFASerializer(this).toString():""}};return l([s.NotNull],h.prototype,"states",void 0),l([s.NotNull],h.prototype,"atnStartState",void 0),l([s.NotNull],h.prototype,"atn",void 0),h=l([e(0,s.NotNull)],h),At.DFA=h,At}var tn={},rn={},Fc;function wd(){if(Fc)return rn;Fc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=rn&&rn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(rn,"__esModule",{value:!0}),rn.BasicState=void 0;const e=yr(),t=Ue(),r=Z();let o=class extends e.ATNState{get stateType(){return t.ATNStateType.BASIC}};return l([r.Override],o.prototype,"stateType",null),rn.BasicState=o,rn}var Pc;function Nd(){if(Pc)return tn;Pc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=tn&&tn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(tn,"__esModule",{value:!0}),tn.InvalidState=void 0;const e=Ue(),t=wd(),r=Z();let o=class extends t.BasicState{get stateType(){return e.ATNStateType.INVALID_TYPE}};return l([r.Override],o.prototype,"stateType",null),tn.InvalidState=o,tn}var bt={},Rt={},wt={},Ic;function nl(){if(Ic)return wt;Ic=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=wt&&wt.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f},e=wt&&wt.__param||function(s,a){return function(c,u){a(c,u,s)}};Object.defineProperty(wt,"__esModule",{value:!0}),wt.SetTransition=void 0;const t=Wn(),r=Z(),o=Be(),i=Or();let n=class extends i.Transition{constructor(a,c){super(a),c==null&&(c=t.IntervalSet.of(o.Token.INVALID_TYPE)),this.set=c}get serializationType(){return 7}get label(){return this.set}matches(a,c,u){return this.set.contains(a)}toString(){return this.set.toString()}};return l([r.NotNull],n.prototype,"set",void 0),l([r.Override],n.prototype,"serializationType",null),l([r.Override,r.NotNull],n.prototype,"label",null),l([r.Override],n.prototype,"matches",null),l([r.Override,r.NotNull],n.prototype,"toString",null),n=l([e(0,r.NotNull),e(1,r.Nullable)],n),wt.SetTransition=n,wt}var Dc;function il(){if(Dc)return Rt;Dc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Rt&&Rt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=Rt&&Rt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.NotSetTransition=void 0;const t=Z(),r=nl();let o=class extends r.SetTransition{constructor(n,s){super(n,s)}get serializationType(){return 8}matches(n,s,a){return n>=s&&n<=a&&!super.matches(n,s,a)}toString(){return"~"+super.toString()}};return l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"matches",null),l([t.Override],o.prototype,"toString",null),o=l([e(0,t.NotNull),e(1,t.Nullable)],o),Rt.NotSetTransition=o,Rt}var nn={},Lc;function Ji(){if(Lc)return nn;Lc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=nn&&nn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(nn,"__esModule",{value:!0}),nn.RuleStopState=void 0;const e=yr(),t=Ue(),r=Z();let o=class extends e.ATNState{get nonStopStateNumber(){return-1}get stateType(){return t.ATNStateType.RULE_STOP}};return l([r.Override],o.prototype,"nonStopStateNumber",null),l([r.Override],o.prototype,"stateType",null),nn.RuleStopState=o,nn}var Nt={},Bc;function ol(){if(Bc)return Nt;Bc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Nt&&Nt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=Nt&&Nt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.RuleTransition=void 0;const t=Z(),r=Or();let o=class extends r.Transition{constructor(n,s,a,c){super(n),this.tailCall=!1,this.optimizedTailCall=!1,this.ruleIndex=s,this.precedence=a,this.followState=c}get serializationType(){return 3}get isEpsilon(){return!0}matches(n,s,a){return!1}};return l([t.NotNull],o.prototype,"followState",void 0),l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"isEpsilon",null),l([t.Override],o.prototype,"matches",null),o=l([e(0,t.NotNull),e(3,t.NotNull)],o),Nt.RuleTransition=o,Nt}var Ot={},Mc;function Od(){if(Mc)return Ot;Mc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ot&&Ot.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=Ot&&Ot.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.WildcardTransition=void 0;const t=Z(),r=Or();let o=class extends r.Transition{constructor(n){super(n)}get serializationType(){return 9}matches(n,s,a){return n>=s&&n<=a}toString(){return"."}};return l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"matches",null),l([t.Override,t.NotNull],o.prototype,"toString",null),o=l([e(0,t.NotNull)],o),Ot.WildcardTransition=o,Ot}var kc;function P0(){if(kc)return bt;kc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=bt&&bt.__decorate||function(x,v,m,g){var S=arguments.length,C=S<3?v:g===null?g=Object.getOwnPropertyDescriptor(v,m):g,A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(x,v,m,g);else for(var b=x.length-1;b>=0;b--)(A=x[b])&&(C=(S<3?A(C):S>3?A(v,m,C):A(v,m))||C);return S>3&&C&&Object.defineProperty(v,m,C),C},e=bt&&bt.__param||function(x,v){return function(m,g){v(m,g,x)}};Object.defineProperty(bt,"__esModule",{value:!0}),bt.LL1Analyzer=void 0;const t=Ka(),r=Fr(),o=wo(),i=Pr(),n=Wn(),s=Z(),a=il(),c=ht(),u=lt(),h=Ji(),f=ol(),d=Be(),p=Od();let y=class Fa{constructor(v){this.atn=v}getDecisionLookahead(v){if(v==null)return;let m=new Array(v.numberOfTransitions);for(let g=0;g<v.numberOfTransitions;g++){let S=new n.IntervalSet;m[g]=S;let C=new r.Array2DHashSet(c.ObjectEqualityComparator.INSTANCE);this._LOOK(v.transition(g).target,void 0,u.PredictionContext.EMPTY_LOCAL,S,C,new i.BitSet,!1,!1),(S.size===0||S.contains(Fa.HIT_PRED))&&(S=void 0,m[g]=S)}return m}LOOK(v,m,g){if(g===void 0){if(v.atn==null)throw new Error("Illegal state");g=v.atn.ruleToStopState[v.ruleIndex]}else g===null&&(g=void 0);let S=new n.IntervalSet;return this._LOOK(v,g,m,S,new r.Array2DHashSet,new i.BitSet,!0,!0),S}_LOOK(v,m,g,S,C,A,b,R){let w=o.ATNConfig.create(v,0,g);if(!C.add(w))return;if(v===m){if(u.PredictionContext.isEmptyLocal(g)){S.add(d.Token.EPSILON);return}else if(g.isEmpty){R&&S.add(d.Token.EOF);return}}if(v instanceof h.RuleStopState){if(g.isEmpty&&!u.PredictionContext.isEmptyLocal(g)){R&&S.add(d.Token.EOF);return}let M=A.get(v.ruleIndex);try{A.clear(v.ruleIndex);for(let D=0;D<g.size;D++){if(g.getReturnState(D)===u.PredictionContext.EMPTY_FULL_STATE_KEY)continue;let U=this.atn.states[g.getReturnState(D)];this._LOOK(U,m,g.getParent(D),S,C,A,b,R)}}finally{M&&A.set(v.ruleIndex)}}let P=v.numberOfTransitions;for(let M=0;M<P;M++){let D=v.transition(M);if(D instanceof f.RuleTransition){if(A.get(D.ruleIndex))continue;let U=g.getChild(D.followState.stateNumber);try{A.set(D.ruleIndex),this._LOOK(D.target,m,U,S,C,A,b,R)}finally{A.clear(D.ruleIndex)}}else if(D instanceof t.AbstractPredicateTransition)b?this._LOOK(D.target,m,g,S,C,A,b,R):S.add(Fa.HIT_PRED);else if(D.isEpsilon)this._LOOK(D.target,m,g,S,C,A,b,R);else if(D instanceof p.WildcardTransition)S.addAll(n.IntervalSet.of(d.Token.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType));else{let U=D.label;U!=null&&(D instanceof a.NotSetTransition&&(U=U.complement(n.IntervalSet.of(d.Token.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType))),S.addAll(U))}}}};return y.HIT_PRED=d.Token.INVALID_TYPE,l([s.NotNull],y.prototype,"atn",void 0),l([s.NotNull,e(0,s.NotNull),e(1,s.NotNull)],y.prototype,"LOOK",null),l([e(0,s.NotNull),e(2,s.NotNull),e(3,s.NotNull),e(4,s.NotNull),e(5,s.NotNull)],y.prototype,"_LOOK",null),y=l([e(0,s.NotNull)],y),bt.LL1Analyzer=y,bt}var zc;function ft(){return zc||(zc=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Gr&&Gr.__decorate||function(p,y,x,v){var m=arguments.length,g=m<3?y:v===null?v=Object.getOwnPropertyDescriptor(y,x):v,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(p,y,x,v);else for(var C=p.length-1;C>=0;C--)(S=p[C])&&(g=(m<3?S(g):m>3?S(y,x,g):S(y,x))||g);return m>3&&g&&Object.defineProperty(y,x,g),g},t=Gr&&Gr.__param||function(p,y){return function(x,v){y(x,v,p)}};Object.defineProperty(l,"__esModule",{value:!0}),l.ATN=void 0;const r=ai(),o=Rd(),i=Wn(),n=Nd(),s=P0(),a=Z(),c=ht(),u=lt(),h=Be(),f=Ve();let d=class{constructor(y,x){this.states=[],this.decisionToState=[],this.modeNameToStartState=new Map,this.modeToStartState=[],this.contextCache=new r.Array2DHashMap(c.ObjectEqualityComparator.INSTANCE),this.decisionToDFA=[],this.modeToDFA=[],this.LL1Table=new Map,this.grammarType=y,this.maxTokenType=x}clearDFA(){this.decisionToDFA=new Array(this.decisionToState.length);for(let y=0;y<this.decisionToDFA.length;y++)this.decisionToDFA[y]=new o.DFA(this.decisionToState[y],y);this.modeToDFA=new Array(this.modeToStartState.length);for(let y=0;y<this.modeToDFA.length;y++)this.modeToDFA[y]=new o.DFA(this.modeToStartState[y]);this.contextCache.clear(),this.LL1Table.clear()}get contextCacheSize(){return this.contextCache.size}getCachedContext(y){return u.PredictionContext.getCachedContext(y,this.contextCache,new u.PredictionContext.IdentityHashMap)}getDecisionToDFA(){return f(this.decisionToDFA!=null&&this.decisionToDFA.length===this.decisionToState.length),this.decisionToDFA}nextTokens(y,x){return x?new s.LL1Analyzer(this).LOOK(y,x):(y.nextTokenWithinRule||(y.nextTokenWithinRule=this.nextTokens(y,u.PredictionContext.EMPTY_LOCAL),y.nextTokenWithinRule.setReadonly(!0)),y.nextTokenWithinRule)}addState(y){y.atn=this,y.stateNumber=this.states.length,this.states.push(y)}removeState(y){let x=new n.InvalidState;x.atn=this,x.stateNumber=y.stateNumber,this.states[y.stateNumber]=x}defineMode(y,x){this.modeNameToStartState.set(y,x),this.modeToStartState.push(x),this.modeToDFA.push(new o.DFA(x)),this.defineDecisionState(x)}defineDecisionState(y){return this.decisionToState.push(y),y.decision=this.decisionToState.length-1,this.decisionToDFA.push(new o.DFA(y,y.decision)),y.decision}getDecisionState(y){if(this.decisionToState.length>0)return this.decisionToState[y]}get numberOfDecisions(){return this.decisionToState.length}getExpectedTokens(y,x){if(y<0||y>=this.states.length)throw new RangeError("Invalid state number.");let v=x,m=this.states[y],g=this.nextTokens(m);if(!g.contains(h.Token.EPSILON))return g;let S=new i.IntervalSet;for(S.addAll(g),S.remove(h.Token.EPSILON);v!=null&&v.invokingState>=0&&g.contains(h.Token.EPSILON);){let A=this.states[v.invokingState].transition(0);g=this.nextTokens(A.followState),S.addAll(g),S.remove(h.Token.EPSILON),v=v._parent}return g.contains(h.Token.EPSILON)&&S.add(h.Token.EOF),S}};e([a.NotNull],d.prototype,"states",void 0),e([a.NotNull],d.prototype,"decisionToState",void 0),e([a.NotNull],d.prototype,"modeNameToStartState",void 0),e([a.NotNull],d.prototype,"modeToStartState",void 0),e([a.NotNull],d.prototype,"decisionToDFA",void 0),e([a.NotNull],d.prototype,"modeToDFA",void 0),e([a.NotNull],d.prototype,"nextTokens",null),e([t(0,a.NotNull)],d.prototype,"removeState",null),e([t(0,a.NotNull),t(1,a.NotNull)],d.prototype,"defineMode",null),e([t(0,a.NotNull)],d.prototype,"defineDecisionState",null),e([a.NotNull],d.prototype,"getExpectedTokens",null),d=e([t(0,a.NotNull)],d),l.ATN=d,function(p){p.INVALID_ALT_NUMBER=0}(d=l.ATN||(l.ATN={})),l.ATN=d}(Gr)),Gr}var Ft={},Pt={},jc;function I0(){if(jc)return Pt;jc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Pt&&Pt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=Pt&&Pt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.LexerIndexedCustomAction=void 0;const t=je(),r=Z();let o=class Fd{constructor(n,s){this._offset=n,this._action=s}get offset(){return this._offset}get action(){return this._action}get actionType(){return this._action.actionType}get isPositionDependent(){return!0}execute(n){this._action.execute(n)}hashCode(){let n=t.MurmurHash.initialize();return n=t.MurmurHash.update(n,this._offset),n=t.MurmurHash.update(n,this._action),t.MurmurHash.finish(n,2)}equals(n){return n===this?!0:n instanceof Fd?this._offset===n._offset&&this._action.equals(n._action):!1}};return l([r.NotNull],o.prototype,"action",null),l([r.Override],o.prototype,"actionType",null),l([r.Override],o.prototype,"isPositionDependent",null),l([r.Override],o.prototype,"execute",null),l([r.Override],o.prototype,"hashCode",null),l([r.Override],o.prototype,"equals",null),o=l([e(1,r.NotNull)],o),Pt.LexerIndexedCustomAction=o,Pt}var qc;function D0(){if(qc)return Ft;qc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ft&&Ft.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f},e=Ft&&Ft.__param||function(s,a){return function(c,u){a(c,u,s)}};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.LexerActionExecutor=void 0;const t=To(),r=I0(),o=je(),i=Z();let n=class qi{constructor(a){this._lexerActions=a;let c=o.MurmurHash.initialize();for(let u of a)c=o.MurmurHash.update(c,u);this.cachedHashCode=o.MurmurHash.finish(c,a.length)}static append(a,c){if(!a)return new qi([c]);let u=a._lexerActions.slice(0);return u.push(c),new qi(u)}fixOffsetBeforeMatch(a){let c;for(let u=0;u<this._lexerActions.length;u++)this._lexerActions[u].isPositionDependent&&!(this._lexerActions[u]instanceof r.LexerIndexedCustomAction)&&(c||(c=this._lexerActions.slice(0)),c[u]=new r.LexerIndexedCustomAction(a,this._lexerActions[u]));return c?new qi(c):this}get lexerActions(){return this._lexerActions}execute(a,c,u){let h=!1,f=c.index;try{for(let d of this._lexerActions){if(d instanceof r.LexerIndexedCustomAction){let p=d.offset;c.seek(u+p),d=d.action,h=u+p!==f}else d.isPositionDependent&&(c.seek(f),h=!1);d.execute(a)}}finally{h&&c.seek(f)}}hashCode(){return this.cachedHashCode}equals(a){return a===this?!0:a instanceof qi?this.cachedHashCode===a.cachedHashCode&&t.ArrayEqualityComparator.INSTANCE.equals(this._lexerActions,a._lexerActions):!1}};return l([i.NotNull],n.prototype,"_lexerActions",void 0),l([i.NotNull],n.prototype,"lexerActions",null),l([e(0,i.NotNull)],n.prototype,"execute",null),l([i.Override],n.prototype,"hashCode",null),l([i.Override],n.prototype,"equals",null),l([i.NotNull,e(1,i.NotNull)],n,"append",null),n=l([e(0,i.NotNull)],n),Ft.LexerActionExecutor=n,Ft}var It={},Hc;function Fo(){if(Hc)return It;Hc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=It&&It.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f},e=It&&It.__param||function(s,a){return function(c,u){a(c,u,s)}};Object.defineProperty(It,"__esModule",{value:!0}),It.LexerNoViableAltException=void 0;const t=Nr(),r=Z(),o=Ye(),i=vr();let n=class extends t.RecognitionException{constructor(a,c,u,h){super(a,c),this._startIndex=u,this._deadEndConfigs=h}get startIndex(){return this._startIndex}get deadEndConfigs(){return this._deadEndConfigs}get inputStream(){return super.inputStream}toString(){let a="";return this._startIndex>=0&&this._startIndex<this.inputStream.size&&(a=this.inputStream.getText(o.Interval.of(this._startIndex,this._startIndex)),a=i.escapeWhitespace(a,!1)),`LexerNoViableAltException('${a}')`}};return l([r.Override],n.prototype,"inputStream",null),l([r.Override],n.prototype,"toString",null),n=l([e(1,r.NotNull)],n),It.LexerNoViableAltException=n,It}var on={},Uc;function L0(){if(Uc)return on;Uc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=on&&on.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c};Object.defineProperty(on,"__esModule",{value:!0}),on.OrderedATNConfigSet=void 0;const e=Ki(),t=Z();let r=class Pd extends e.ATNConfigSet{constructor(i,n){i!=null&&n!=null?super(i,n):super()}clone(i){let n=new Pd(this,i);return!i&&this.isReadOnly&&n.addAll(this),n}getKey(i){return{state:0,alt:i.hashCode()}}canMerge(i,n,s){return i.equals(s)}};return l([t.Override],r.prototype,"clone",null),l([t.Override],r.prototype,"getKey",null),l([t.Override],r.prototype,"canMerge",null),on.OrderedATNConfigSet=r,on}var $c;function Po(){return $c||($c=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Wr&&Wr.__decorate||function(C,A,b,R){var w=arguments.length,P=w<3?A:R===null?R=Object.getOwnPropertyDescriptor(A,b):R,M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(C,A,b,R);else for(var D=C.length-1;D>=0;D--)(M=C[D])&&(P=(w<3?M(P):w>3?M(A,b,P):M(A,b))||P);return w>3&&P&&Object.defineProperty(A,b,P),P},t=Wr&&Wr.__param||function(C,A){return function(b,R){A(b,R,C)}};Object.defineProperty(l,"__esModule",{value:!0}),l.LexerATNSimulator=void 0;const r=Cd(),o=ft(),i=wo(),n=Ki(),s=Oo(),a=No(),c=Ye(),u=wr(),h=Ir(),f=D0(),d=Fo(),p=Z(),y=L0(),x=lt(),v=Ji(),m=Be(),g=Ve();let S=class Ke extends s.ATNSimulator{constructor(A,b){super(A),this.optimize_tail_calls=!0,this.startIndex=-1,this._line=1,this._charPositionInLine=0,this.mode=h.Lexer.DEFAULT_MODE,this.prevAccept=new Ke.SimState,this.recog=b}copyState(A){this._charPositionInLine=A.charPositionInLine,this._line=A._line,this.mode=A.mode,this.startIndex=A.startIndex}match(A,b){this.mode=b;let R=A.mark();try{this.startIndex=A.index,this.prevAccept.reset();let w=this.atn.modeToDFA[b].s0;return w==null?this.matchATN(A):this.execATN(A,w)}finally{A.release(R)}}reset(){this.prevAccept.reset(),this.startIndex=-1,this._line=1,this._charPositionInLine=0,this.mode=h.Lexer.DEFAULT_MODE}matchATN(A){let b=this.atn.modeToStartState[this.mode];Ke.debug&&console.log(`matchATN mode ${this.mode} start: ${b}`);let R=this.mode,w=this.computeStartState(A,b),P=w.hasSemanticContext;P&&(w.hasSemanticContext=!1);let M=this.addDFAState(w);if(!P){let U=this.atn.modeToDFA[this.mode];U.s0?M=U.s0:U.s0=M}let D=this.execATN(A,M);return Ke.debug&&console.log(`DFA after matchATN: ${this.atn.modeToDFA[R].toLexerString()}`),D}execATN(A,b){Ke.debug&&console.log(`start state closure=${b.configs}`),b.isAcceptState&&this.captureSimState(this.prevAccept,A,b);let R=A.LA(1),w=b;for(;;){Ke.debug&&console.log(`execATN loop starting closure: ${w.configs}`);let P=this.getExistingTargetState(w,R);if(P==null&&(P=this.computeTargetState(A,w,R)),P===s.ATNSimulator.ERROR||(R!==u.IntStream.EOF&&this.consume(A),P.isAcceptState&&(this.captureSimState(this.prevAccept,A,P),R===u.IntStream.EOF)))break;R=A.LA(1),w=P}return this.failOrAccept(this.prevAccept,A,w.configs,R)}getExistingTargetState(A,b){let R=A.getTarget(b);return Ke.debug&&R!=null&&console.log("reuse state "+A.stateNumber+" edge to "+R.stateNumber),R}computeTargetState(A,b,R){let w=new y.OrderedATNConfigSet;return this.getReachableConfigSet(A,b.configs,w,R),w.isEmpty?(w.hasSemanticContext||this.addDFAEdge(b,R,s.ATNSimulator.ERROR),s.ATNSimulator.ERROR):this.addDFAEdge(b,R,w)}failOrAccept(A,b,R,w){if(A.dfaState!=null){let P=A.dfaState.lexerActionExecutor;return this.accept(b,P,this.startIndex,A.index,A.line,A.charPos),A.dfaState.prediction}else{if(w===u.IntStream.EOF&&b.index===this.startIndex)return m.Token.EOF;throw new d.LexerNoViableAltException(this.recog,b,this.startIndex,R)}}getReachableConfigSet(A,b,R,w){let P=o.ATN.INVALID_ALT_NUMBER;for(let M of b){let D=M.alt===P;if(D&&M.hasPassedThroughNonGreedyDecision)continue;Ke.debug&&console.log(`testing ${this.getTokenName(w)} at ${M.toString(this.recog,!0)}`);let U=M.state.numberOfOptimizedTransitions;for(let J=0;J<U;J++){let te=M.state.getOptimizedTransition(J),le=this.getReachableTarget(te,w);if(le!=null){let ge=M.lexerActionExecutor,ce;ge!=null?(ge=ge.fixOffsetBeforeMatch(A.index-this.startIndex),ce=M.transform(le,!0,ge)):(g(M.lexerActionExecutor==null),ce=M.transform(le,!0));let ee=w===u.IntStream.EOF;if(this.closure(A,ce,R,D,!0,ee)){P=M.alt;break}}}}}accept(A,b,R,w,P,M){Ke.debug&&console.log(`ACTION ${b}`),A.seek(w),this._line=P,this._charPositionInLine=M,b!=null&&this.recog!=null&&b.execute(this.recog,A,R)}getReachableTarget(A,b){if(A.matches(b,h.Lexer.MIN_CHAR_VALUE,h.Lexer.MAX_CHAR_VALUE))return A.target}computeStartState(A,b){let R=x.PredictionContext.EMPTY_FULL,w=new y.OrderedATNConfigSet;for(let P=0;P<b.numberOfTransitions;P++){let M=b.transition(P).target,D=i.ATNConfig.create(M,P+1,R);this.closure(A,D,w,!1,!1,!1)}return w}closure(A,b,R,w,P,M){if(Ke.debug&&console.log("closure("+b.toString(this.recog,!0)+")"),b.state instanceof v.RuleStopState){Ke.debug&&(this.recog!=null?console.log(`closure at ${this.recog.ruleNames[b.state.ruleIndex]} rule stop ${b}`):console.log(`closure at rule stop ${b}`));let U=b.context;if(U.isEmpty)return R.add(b),!0;U.hasEmpty&&(R.add(b.transform(b.state,!0,x.PredictionContext.EMPTY_FULL)),w=!0);for(let J=0;J<U.size;J++){let te=U.getReturnState(J);if(te===x.PredictionContext.EMPTY_FULL_STATE_KEY)continue;let le=U.getParent(J),ge=this.atn.states[te],ce=b.transform(ge,!1,le);w=this.closure(A,ce,R,w,P,M)}return w}b.state.onlyHasEpsilonTransitions||(!w||!b.hasPassedThroughNonGreedyDecision)&&R.add(b);let D=b.state;for(let U=0;U<D.numberOfOptimizedTransitions;U++){let J=D.getOptimizedTransition(U),te=this.getEpsilonTarget(A,b,J,R,P,M);te!=null&&(w=this.closure(A,te,R,w,P,M))}return w}getEpsilonTarget(A,b,R,w,P,M){let D;switch(R.serializationType){case 3:let U=R;if(this.optimize_tail_calls&&U.optimizedTailCall&&!b.context.hasEmpty)D=b.transform(R.target,!0);else{let te=b.context.getChild(U.followState.stateNumber);D=b.transform(R.target,!0,te)}break;case 10:throw new Error("Precedence predicates are not supported in lexers.");case 4:let J=R;Ke.debug&&console.log("EVAL rule "+J.ruleIndex+":"+J.predIndex),w.hasSemanticContext=!0,this.evaluatePredicate(A,J.ruleIndex,J.predIndex,P)?D=b.transform(R.target,!0):D=void 0;break;case 6:if(b.context.hasEmpty){let te=f.LexerActionExecutor.append(b.lexerActionExecutor,this.atn.lexerActions[R.actionIndex]);D=b.transform(R.target,!0,te);break}else{D=b.transform(R.target,!0);break}case 1:D=b.transform(R.target,!0);break;case 5:case 2:case 7:if(M&&R.matches(u.IntStream.EOF,h.Lexer.MIN_CHAR_VALUE,h.Lexer.MAX_CHAR_VALUE)){D=b.transform(R.target,!1);break}D=void 0;break;default:D=void 0;break}return D}evaluatePredicate(A,b,R,w){if(this.recog==null)return!0;if(!w)return this.recog.sempred(void 0,b,R);let P=this._charPositionInLine,M=this._line,D=A.index,U=A.mark();try{return this.consume(A),this.recog.sempred(void 0,b,R)}finally{this._charPositionInLine=P,this._line=M,A.seek(D),A.release(U)}}captureSimState(A,b,R){A.index=b.index,A.line=this._line,A.charPos=this._charPositionInLine,A.dfaState=R}addDFAEdge(A,b,R){if(R instanceof n.ATNConfigSet){let w=R.hasSemanticContext;w&&(R.hasSemanticContext=!1);let P=this.addDFAState(R);return w||this.addDFAEdge(A,b,P),P}else Ke.debug&&console.log("EDGE "+A+" -> "+R+" upon "+String.fromCharCode(b)),A!=null&&A.setTarget(b,R)}addDFAState(A){g(!A.hasSemanticContext);let b=new a.DFAState(A),R=this.atn.modeToDFA[this.mode].states.get(b);if(R!=null)return R;A.optimizeConfigs(this);let w=new a.DFAState(A.clone(!0)),P;for(let M of A)if(M.state instanceof v.RuleStopState){P=M;break}if(P!=null){let M=this.atn.ruleToTokenType[P.state.ruleIndex],D=P.lexerActionExecutor;w.acceptStateInfo=new r.AcceptStateInfo(M,D)}return this.atn.modeToDFA[this.mode].addState(w)}getDFA(A){return this.atn.modeToDFA[A]}getText(A){return A.getText(c.Interval.of(this.startIndex,A.index-1))}get line(){return this._line}set line(A){this._line=A}get charPositionInLine(){return this._charPositionInLine}set charPositionInLine(A){this._charPositionInLine=A}consume(A){A.LA(1)===10?(this._line++,this._charPositionInLine=0):this._charPositionInLine++,A.consume()}getTokenName(A){return A===-1?"EOF":"'"+String.fromCharCode(A)+"'"}};e([p.NotNull],S.prototype,"prevAccept",void 0),e([t(0,p.NotNull)],S.prototype,"copyState",null),e([t(0,p.NotNull)],S.prototype,"match",null),e([p.Override],S.prototype,"reset",null),e([t(0,p.NotNull)],S.prototype,"matchATN",null),e([t(0,p.NotNull),t(1,p.NotNull)],S.prototype,"execATN",null),e([t(0,p.NotNull)],S.prototype,"getExistingTargetState",null),e([p.NotNull,t(0,p.NotNull),t(1,p.NotNull)],S.prototype,"computeTargetState",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull)],S.prototype,"getReachableConfigSet",null),e([t(0,p.NotNull)],S.prototype,"accept",null),e([p.NotNull,t(0,p.NotNull),t(1,p.NotNull)],S.prototype,"computeStartState",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull)],S.prototype,"closure",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull),t(3,p.NotNull)],S.prototype,"getEpsilonTarget",null),e([t(0,p.NotNull)],S.prototype,"evaluatePredicate",null),e([t(0,p.NotNull),t(1,p.NotNull),t(2,p.NotNull)],S.prototype,"captureSimState",null),e([p.NotNull,t(0,p.NotNull)],S.prototype,"addDFAState",null),e([p.NotNull],S.prototype,"getDFA",null),e([p.NotNull,t(0,p.NotNull)],S.prototype,"getText",null),e([t(0,p.NotNull)],S.prototype,"consume",null),e([p.NotNull],S.prototype,"getTokenName",null),S=e([t(0,p.NotNull)],S),l.LexerATNSimulator=S,function(C){C.debug=!1,C.dfa_debug=!1;class A{constructor(){this.index=-1,this.line=0,this.charPos=-1}reset(){this.index=-1,this.line=0,this.charPos=-1,this.dfaState=void 0}}C.SimState=A}(S=l.LexerATNSimulator||(l.LexerATNSimulator={})),l.LexerATNSimulator=S}(Wr)),Wr}var Vc;function Ir(){if(Vc)return Vr;Vc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Vr&&Vr.__decorate||function(h,f,d,p){var y=arguments.length,x=y<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,d):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(h,f,d,p);else for(var m=h.length-1;m>=0;m--)(v=h[m])&&(x=(y<3?v(x):y>3?v(f,d,x):v(f,d))||x);return y>3&&x&&Object.defineProperty(f,d,x),x};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.Lexer=void 0;const e=Za(),t=Ad(),r=Ye(),o=wr(),i=Po(),n=Fo(),s=Z(),a=Qi(),c=Be();let u=class Ar extends a.Recognizer{constructor(f){super(),this._factory=e.CommonTokenFactory.DEFAULT,this._tokenStartCharIndex=-1,this._tokenStartLine=0,this._tokenStartCharPositionInLine=0,this._hitEOF=!1,this._channel=0,this._type=0,this._modeStack=new t.IntegerStack,this._mode=Ar.DEFAULT_MODE,this._input=f,this._tokenFactorySourcePair={source:this,stream:f}}static get DEFAULT_TOKEN_CHANNEL(){return c.Token.DEFAULT_CHANNEL}static get HIDDEN(){return c.Token.HIDDEN_CHANNEL}reset(f){(f===void 0||f)&&this._input.seek(0),this._token=void 0,this._type=c.Token.INVALID_TYPE,this._channel=c.Token.DEFAULT_CHANNEL,this._tokenStartCharIndex=-1,this._tokenStartCharPositionInLine=-1,this._tokenStartLine=-1,this._text=void 0,this._hitEOF=!1,this._mode=Ar.DEFAULT_MODE,this._modeStack.clear(),this.interpreter.reset()}nextToken(){if(this._input==null)throw new Error("nextToken requires a non-null input stream.");let f=this._input.mark();try{e:for(;;){if(this._hitEOF)return this.emitEOF();this._token=void 0,this._channel=c.Token.DEFAULT_CHANNEL,this._tokenStartCharIndex=this._input.index,this._tokenStartCharPositionInLine=this.interpreter.charPositionInLine,this._tokenStartLine=this.interpreter.line,this._text=void 0;do{this._type=c.Token.INVALID_TYPE;let d;try{d=this.interpreter.match(this._input,this._mode)}catch(p){if(p instanceof n.LexerNoViableAltException)this.notifyListeners(p),this.recover(p),d=Ar.SKIP;else throw p}if(this._input.LA(1)===o.IntStream.EOF&&(this._hitEOF=!0),this._type===c.Token.INVALID_TYPE&&(this._type=d),this._type===Ar.SKIP)continue e}while(this._type===Ar.MORE);return this._token==null?this.emit():this._token}}finally{this._input.release(f)}}skip(){this._type=Ar.SKIP}more(){this._type=Ar.MORE}mode(f){this._mode=f}pushMode(f){i.LexerATNSimulator.debug&&console.log("pushMode "+f),this._modeStack.push(this._mode),this.mode(f)}popMode(){if(this._modeStack.isEmpty)throw new Error("EmptyStackException");return i.LexerATNSimulator.debug&&console.log("popMode back to "+this._modeStack.peek()),this.mode(this._modeStack.pop()),this._mode}get tokenFactory(){return this._factory}set tokenFactory(f){this._factory=f}get inputStream(){return this._input}set inputStream(f){this.reset(!1),this._input=f,this._tokenFactorySourcePair={source:this,stream:this._input}}get sourceName(){return this._input.sourceName}emit(f){return f||(f=this._factory.create(this._tokenFactorySourcePair,this._type,this._text,this._channel,this._tokenStartCharIndex,this.charIndex-1,this._tokenStartLine,this._tokenStartCharPositionInLine)),this._token=f,f}emitEOF(){let f=this.charPositionInLine,d=this.line,p=this._factory.create(this._tokenFactorySourcePair,c.Token.EOF,void 0,c.Token.DEFAULT_CHANNEL,this._input.index,this._input.index-1,d,f);return this.emit(p),p}get line(){return this.interpreter.line}set line(f){this.interpreter.line=f}get charPositionInLine(){return this.interpreter.charPositionInLine}set charPositionInLine(f){this.interpreter.charPositionInLine=f}get charIndex(){return this._input.index}get text(){return this._text!=null?this._text:this.interpreter.getText(this._input)}set text(f){this._text=f}get token(){return this._token}set token(f){this._token=f}set type(f){this._type=f}get type(){return this._type}set channel(f){this._channel=f}get channel(){return this._channel}getAllTokens(){let f=[],d=this.nextToken();for(;d.type!==c.Token.EOF;)f.push(d),d=this.nextToken();return f}notifyListeners(f){let d=this._input.getText(r.Interval.of(this._tokenStartCharIndex,this._input.index)),p="token recognition error at: '"+this.getErrorDisplay(d)+"'",y=this.getErrorListenerDispatch();y.syntaxError&&y.syntaxError(this,void 0,this._tokenStartLine,this._tokenStartCharPositionInLine,p,f)}getErrorDisplay(f){if(typeof f=="number"){switch(f){case c.Token.EOF:return"<EOF>";case 10:return"\\n";case 9:return"\\t";case 13:return"\\r"}return String.fromCharCode(f)}return f.replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")}getCharErrorDisplay(f){return"'"+this.getErrorDisplay(f)+"'"}recover(f){f instanceof n.LexerNoViableAltException?this._input.LA(1)!==o.IntStream.EOF&&this.interpreter.consume(this._input):this._input.consume()}};return u.DEFAULT_MODE=0,u.MORE=-2,u.SKIP=-3,u.MIN_CHAR_VALUE=0,u.MAX_CHAR_VALUE=1114111,l([s.Override],u.prototype,"nextToken",null),l([s.Override],u.prototype,"tokenFactory",null),l([s.Override],u.prototype,"inputStream",null),l([s.Override],u.prototype,"sourceName",null),l([s.Override],u.prototype,"line",null),l([s.Override],u.prototype,"charPositionInLine",null),Vr.Lexer=u,Vr}var Wc;function Wn(){if(Wc)return vt;Wc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=vt&&vt.__decorate||function(u,h,f,d){var p=arguments.length,y=p<3?h:d===null?d=Object.getOwnPropertyDescriptor(h,f):d,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(u,h,f,d);else for(var v=u.length-1;v>=0;v--)(x=u[v])&&(y=(p<3?x(y):p>3?x(h,f,y):x(h,f))||y);return p>3&&y&&Object.defineProperty(h,f,y),y},e=vt&&vt.__param||function(u,h){return function(f,d){h(f,d,u)}};Object.defineProperty(vt,"__esModule",{value:!0}),vt.IntervalSet=void 0;const t=To(),r=Ja(),o=Ye(),i=Ir(),n=je(),s=Z(),a=Be();let c=class Oe{constructor(h){this.readonly=!1,h!=null?this._intervals=h.slice(0):this._intervals=[]}static get COMPLETE_CHAR_SET(){return Oe._COMPLETE_CHAR_SET===void 0&&(Oe._COMPLETE_CHAR_SET=Oe.of(i.Lexer.MIN_CHAR_VALUE,i.Lexer.MAX_CHAR_VALUE),Oe._COMPLETE_CHAR_SET.setReadonly(!0)),Oe._COMPLETE_CHAR_SET}static get EMPTY_SET(){return Oe._EMPTY_SET==null&&(Oe._EMPTY_SET=new Oe,Oe._EMPTY_SET.setReadonly(!0)),Oe._EMPTY_SET}static of(h,f=h){let d=new Oe;return d.add(h,f),d}clear(){if(this.readonly)throw new Error("can't alter readonly IntervalSet");this._intervals.length=0}add(h,f=h){this.addRange(o.Interval.of(h,f))}addRange(h){if(this.readonly)throw new Error("can't alter readonly IntervalSet");if(!(h.b<h.a)){for(let f=0;f<this._intervals.length;f++){let d=this._intervals[f];if(h.equals(d))return;if(h.adjacent(d)||!h.disjoint(d)){let p=h.union(d);for(this._intervals[f]=p;f<this._intervals.length-1;){f++;let y=this._intervals[f];if(!p.adjacent(y)&&p.disjoint(y))break;this._intervals.splice(f,1),f--,this._intervals[f]=p.union(y)}return}if(h.startsBeforeDisjoint(d)){this._intervals.splice(f,0,h);return}}this._intervals.push(h)}}static or(h){let f=new Oe;for(let d of h)f.addAll(d);return f}addAll(h){if(h==null)return this;if(h instanceof Oe){let f=h,d=f._intervals.length;for(let p=0;p<d;p++){let y=f._intervals[p];this.add(y.a,y.b)}}else for(let f of h.toArray())this.add(f);return this}complementRange(h,f){return this.complement(Oe.of(h,f))}complement(h){if(h.isNil)return Oe.EMPTY_SET;let f;return h instanceof Oe?f=h:(f=new Oe,f.addAll(h)),f.subtract(this)}subtract(h){if(h==null||h.isNil)return new Oe(this._intervals);if(h instanceof Oe)return Oe.subtract(this,h);let f=new Oe;return f.addAll(h),Oe.subtract(this,f)}static subtract(h,f){if(h.isNil)return new Oe;let d=new Oe(h._intervals);if(f.isNil)return d;let p=0,y=0;for(;p<d._intervals.length&&y<f._intervals.length;){let x=d._intervals[p],v=f._intervals[y];if(v.b<x.a){y++;continue}if(v.a>x.b){p++;continue}let m,g;if(v.a>x.a&&(m=new o.Interval(x.a,v.a-1)),v.b<x.b&&(g=new o.Interval(v.b+1,x.b)),m)if(g){d._intervals[p]=m,d._intervals.splice(p+1,0,g),p++,y++;continue}else{d._intervals[p]=m,p++;continue}else if(g){d._intervals[p]=g,y++;continue}else{d._intervals.splice(p,1);continue}}return d}or(h){let f=new Oe;return f.addAll(this),f.addAll(h),f}and(h){if(h.isNil)return new Oe;let f=this._intervals,d=h._intervals,p,y=f.length,x=d.length,v=0,m=0;for(;v<y&&m<x;){let g=f[v],S=d[m];g.startsBeforeDisjoint(S)?v++:S.startsBeforeDisjoint(g)?m++:g.properlyContains(S)?(p||(p=new Oe),p.addRange(g.intersection(S)),m++):S.properlyContains(g)?(p||(p=new Oe),p.addRange(g.intersection(S)),v++):g.disjoint(S)||(p||(p=new Oe),p.addRange(g.intersection(S)),g.startsAfterNonDisjoint(S)?m++:S.startsAfterNonDisjoint(g)&&v++)}return p||new Oe}contains(h){let f=this._intervals.length,d=0,p=f-1;for(;d<=p;){let y=d+p>>1,x=this._intervals[y],v=x.a;if(x.b<h)d=y+1;else if(v>h)p=y-1;else return!0}return!1}get isNil(){return this._intervals==null||this._intervals.length===0}get maxElement(){if(this.isNil)throw new RangeError("set is empty");return this._intervals[this._intervals.length-1].b}get minElement(){if(this.isNil)throw new RangeError("set is empty");return this._intervals[0].a}get intervals(){return this._intervals}hashCode(){let h=n.MurmurHash.initialize();for(let f of this._intervals)h=n.MurmurHash.update(h,f.a),h=n.MurmurHash.update(h,f.b);return h=n.MurmurHash.finish(h,this._intervals.length*2),h}equals(h){return h==null||!(h instanceof Oe)?!1:t.ArrayEqualityComparator.INSTANCE.equals(this._intervals,h._intervals)}toString(h=!1){let f="";if(this._intervals==null||this._intervals.length===0)return"{}";this.size>1&&(f+="{");let d=!0;for(let p of this._intervals){d?d=!1:f+=", ";let y=p.a,x=p.b;y===x?y===a.Token.EOF?f+="<EOF>":h?f+="'"+String.fromCodePoint(y)+"'":f+=y:h?f+="'"+String.fromCodePoint(y)+"'..'"+String.fromCodePoint(x)+"'":f+=y+".."+x}return this.size>1&&(f+="}"),f}toStringVocabulary(h){if(this._intervals==null||this._intervals.length===0)return"{}";let f="";this.size>1&&(f+="{");let d=!0;for(let p of this._intervals){d?d=!1:f+=", ";let y=p.a,x=p.b;if(y===x)f+=this.elementName(h,y);else for(let v=y;v<=x;v++)v>y&&(f+=", "),f+=this.elementName(h,v)}return this.size>1&&(f+="}"),f}elementName(h,f){return f===a.Token.EOF?"<EOF>":f===a.Token.EPSILON?"<EPSILON>":h.getDisplayName(f)}get size(){let h=0,f=this._intervals.length;if(f===1){let d=this._intervals[0];return d.b-d.a+1}for(let d=0;d<f;d++){let p=this._intervals[d];h+=p.b-p.a+1}return h}toIntegerList(){let h=new r.IntegerList(this.size),f=this._intervals.length;for(let d=0;d<f;d++){let p=this._intervals[d],y=p.a,x=p.b;for(let v=y;v<=x;v++)h.add(v)}return h}toSet(){let h=new Set;for(let f of this._intervals){let d=f.a,p=f.b;for(let y=d;y<=p;y++)h.add(y)}return h}toArray(){let h=new Array,f=this._intervals.length;for(let d=0;d<f;d++){let p=this._intervals[d],y=p.a,x=p.b;for(let v=y;v<=x;v++)h.push(v)}return h}remove(h){if(this.readonly)throw new Error("can't alter readonly IntervalSet");let f=this._intervals.length;for(let d=0;d<f;d++){let p=this._intervals[d],y=p.a,x=p.b;if(h<y)break;if(h===y&&h===x){this._intervals.splice(d,1);break}if(h===y){this._intervals[d]=o.Interval.of(p.a+1,p.b);break}if(h===x){this._intervals[d]=o.Interval.of(p.a,p.b-1);break}if(h>y&&h<x){let v=p.b;this._intervals[d]=o.Interval.of(p.a,h-1),this.add(h+1,v)}}}get isReadonly(){return this.readonly}setReadonly(h){if(this.readonly&&!h)throw new Error("can't alter readonly IntervalSet");this.readonly=h}};return l([s.Override],c.prototype,"addAll",null),l([s.Override],c.prototype,"complement",null),l([s.Override],c.prototype,"subtract",null),l([s.Override],c.prototype,"or",null),l([s.Override],c.prototype,"and",null),l([s.Override],c.prototype,"contains",null),l([s.Override],c.prototype,"isNil",null),l([s.Override],c.prototype,"hashCode",null),l([s.Override],c.prototype,"equals",null),l([e(0,s.NotNull)],c.prototype,"toStringVocabulary",null),l([s.NotNull,e(0,s.NotNull)],c.prototype,"elementName",null),l([s.Override],c.prototype,"size",null),l([s.Override],c.prototype,"remove",null),l([s.NotNull],c,"of",null),l([s.NotNull],c,"subtract",null),vt.IntervalSet=c,vt}var sn={},ot={},an={},Gc;function Id(){if(Gc)return an;Gc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=an&&an.__decorate||function(r,o,i,n){var s=arguments.length,a=s<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,i):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,o,i,n);else for(var u=r.length-1;u>=0;u--)(c=r[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(an,"__esModule",{value:!0}),an.ATNDeserializationOptions=void 0;const e=Z();let t=class Kn{constructor(o){this.readOnly=!1,o?(this.verifyATN=o.verifyATN,this.generateRuleBypassTransitions=o.generateRuleBypassTransitions,this.optimize=o.optimize):(this.verifyATN=!0,this.generateRuleBypassTransitions=!1,this.optimize=!0)}static get defaultOptions(){return Kn._defaultOptions==null&&(Kn._defaultOptions=new Kn,Kn._defaultOptions.makeReadOnly()),Kn._defaultOptions}get isReadOnly(){return this.readOnly}makeReadOnly(){this.readOnly=!0}get isVerifyATN(){return this.verifyATN}set isVerifyATN(o){this.throwIfReadOnly(),this.verifyATN=o}get isGenerateRuleBypassTransitions(){return this.generateRuleBypassTransitions}set isGenerateRuleBypassTransitions(o){this.throwIfReadOnly(),this.generateRuleBypassTransitions=o}get isOptimize(){return this.optimize}set isOptimize(o){this.throwIfReadOnly(),this.optimize=o}throwIfReadOnly(){if(this.isReadOnly)throw new Error("The object is read only.")}};return l([e.NotNull],t,"defaultOptions",null),an.ATNDeserializationOptions=t,an}var Dt={},Lt={},Yc;function Dd(){if(Yc)return Lt;Yc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Lt&&Lt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=Lt&&Lt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.ActionTransition=void 0;const t=Z(),r=Or();let o=class extends r.Transition{constructor(n,s,a=-1,c=!1){super(n),this.ruleIndex=s,this.actionIndex=a,this.isCtxDependent=c}get serializationType(){return 6}get isEpsilon(){return!0}matches(n,s,a){return!1}toString(){return"action_"+this.ruleIndex+":"+this.actionIndex}};return l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"isEpsilon",null),l([t.Override],o.prototype,"matches",null),l([t.Override],o.prototype,"toString",null),o=l([e(0,t.NotNull)],o),Lt.ActionTransition=o,Lt}var Bt={},Xc;function Ld(){if(Xc)return Bt;Xc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Bt&&Bt.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Bt&&Bt.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.AtomTransition=void 0;const t=Wn(),r=Z(),o=Or();let i=class extends o.Transition{constructor(s,a){super(s),this._label=a}get serializationType(){return 5}get label(){return t.IntervalSet.of(this._label)}matches(s,a,c){return this._label===s}toString(){return String(this.label)}};return l([r.Override],i.prototype,"serializationType",null),l([r.Override,r.NotNull],i.prototype,"label",null),l([r.Override],i.prototype,"matches",null),l([r.Override,r.NotNull],i.prototype,"toString",null),i=l([e(0,r.NotNull)],i),Bt.AtomTransition=i,Bt}var ln={},Ci={},Kc;function Io(){if(Kc)return Ci;Kc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.BlockStartState=void 0;const l=$n();let e=class extends l.DecisionState{};return Ci.BlockStartState=e,Ci}var Qc;function B0(){if(Qc)return ln;Qc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ln&&ln.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(ln,"__esModule",{value:!0}),ln.BasicBlockStartState=void 0;const e=Ue(),t=Io(),r=Z();let o=class extends t.BlockStartState{get stateType(){return e.ATNStateType.BLOCK_START}};return l([r.Override],o.prototype,"stateType",null),ln.BasicBlockStartState=o,ln}var un={},Jc;function M0(){if(Jc)return un;Jc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=un&&un.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(un,"__esModule",{value:!0}),un.BlockEndState=void 0;const e=yr(),t=Ue(),r=Z();let o=class extends e.ATNState{get stateType(){return t.ATNStateType.BLOCK_END}};return l([r.Override],o.prototype,"stateType",null),un.BlockEndState=o,un}var Mt={},Zc;function k0(){if(Zc)return Mt;Zc=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Mt&&Mt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=Mt&&Mt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.EpsilonTransition=void 0;const t=Z(),r=Or();let o=class extends r.Transition{constructor(n,s=-1){super(n),this._outermostPrecedenceReturn=s}get outermostPrecedenceReturn(){return this._outermostPrecedenceReturn}get serializationType(){return 1}get isEpsilon(){return!0}matches(n,s,a){return!1}toString(){return"epsilon"}};return l([t.Override],o.prototype,"serializationType",null),l([t.Override],o.prototype,"isEpsilon",null),l([t.Override],o.prototype,"matches",null),l([t.Override,t.NotNull],o.prototype,"toString",null),o=l([e(0,t.NotNull)],o),Mt.EpsilonTransition=o,Mt}var kt={},eh;function z0(){if(eh)return kt;eh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=kt&&kt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=kt&&kt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(kt,"__esModule",{value:!0}),kt.LexerChannelAction=void 0;const t=je(),r=Z();let o=class Bd{constructor(n){this._channel=n}get channel(){return this._channel}get actionType(){return 0}get isPositionDependent(){return!1}execute(n){n.channel=this._channel}hashCode(){let n=t.MurmurHash.initialize();return n=t.MurmurHash.update(n,this.actionType),n=t.MurmurHash.update(n,this._channel),t.MurmurHash.finish(n,2)}equals(n){return n===this?!0:n instanceof Bd?this._channel===n._channel:!1}toString(){return`channel(${this._channel})`}};return l([r.Override],o.prototype,"actionType",null),l([r.Override],o.prototype,"isPositionDependent",null),l([r.Override,e(0,r.NotNull)],o.prototype,"execute",null),l([r.Override],o.prototype,"hashCode",null),l([r.Override],o.prototype,"equals",null),l([r.Override],o.prototype,"toString",null),kt.LexerChannelAction=o,kt}var zt={},th;function j0(){if(th)return zt;th=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=zt&&zt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=zt&&zt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(zt,"__esModule",{value:!0}),zt.LexerCustomAction=void 0;const t=je(),r=Z();let o=class Md{constructor(n,s){this._ruleIndex=n,this._actionIndex=s}get ruleIndex(){return this._ruleIndex}get actionIndex(){return this._actionIndex}get actionType(){return 1}get isPositionDependent(){return!0}execute(n){n.action(void 0,this._ruleIndex,this._actionIndex)}hashCode(){let n=t.MurmurHash.initialize();return n=t.MurmurHash.update(n,this.actionType),n=t.MurmurHash.update(n,this._ruleIndex),n=t.MurmurHash.update(n,this._actionIndex),t.MurmurHash.finish(n,3)}equals(n){return n===this?!0:n instanceof Md?this._ruleIndex===n._ruleIndex&&this._actionIndex===n._actionIndex:!1}};return l([r.Override],o.prototype,"actionType",null),l([r.Override],o.prototype,"isPositionDependent",null),l([r.Override,e(0,r.NotNull)],o.prototype,"execute",null),l([r.Override],o.prototype,"hashCode",null),l([r.Override],o.prototype,"equals",null),zt.LexerCustomAction=o,zt}var jt={},rh;function q0(){if(rh)return jt;rh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=jt&&jt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=jt&&jt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(jt,"__esModule",{value:!0}),jt.LexerModeAction=void 0;const t=je(),r=Z();let o=class kd{constructor(n){this._mode=n}get mode(){return this._mode}get actionType(){return 2}get isPositionDependent(){return!1}execute(n){n.mode(this._mode)}hashCode(){let n=t.MurmurHash.initialize();return n=t.MurmurHash.update(n,this.actionType),n=t.MurmurHash.update(n,this._mode),t.MurmurHash.finish(n,2)}equals(n){return n===this?!0:n instanceof kd?this._mode===n._mode:!1}toString(){return`mode(${this._mode})`}};return l([r.Override],o.prototype,"actionType",null),l([r.Override],o.prototype,"isPositionDependent",null),l([r.Override,e(0,r.NotNull)],o.prototype,"execute",null),l([r.Override],o.prototype,"hashCode",null),l([r.Override],o.prototype,"equals",null),l([r.Override],o.prototype,"toString",null),jt.LexerModeAction=o,jt}var cn={},nh;function H0(){return nh||(nh=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=cn&&cn.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},t=cn&&cn.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(l,"__esModule",{value:!0}),l.LexerMoreAction=void 0;const r=je(),o=Z();let i=class{constructor(){}get actionType(){return 3}get isPositionDependent(){return!1}execute(s){s.more()}hashCode(){let s=r.MurmurHash.initialize();return s=r.MurmurHash.update(s,this.actionType),r.MurmurHash.finish(s,1)}equals(s){return s===this}toString(){return"more"}};e([o.Override],i.prototype,"actionType",null),e([o.Override],i.prototype,"isPositionDependent",null),e([o.Override,t(0,o.NotNull)],i.prototype,"execute",null),e([o.Override],i.prototype,"hashCode",null),e([o.Override],i.prototype,"equals",null),e([o.Override],i.prototype,"toString",null),l.LexerMoreAction=i,function(n){n.INSTANCE=new n}(i=l.LexerMoreAction||(l.LexerMoreAction={}))}(cn)),cn}var hn={},ih;function U0(){return ih||(ih=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=hn&&hn.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},t=hn&&hn.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(l,"__esModule",{value:!0}),l.LexerPopModeAction=void 0;const r=je(),o=Z();let i=class{constructor(){}get actionType(){return 4}get isPositionDependent(){return!1}execute(s){s.popMode()}hashCode(){let s=r.MurmurHash.initialize();return s=r.MurmurHash.update(s,this.actionType),r.MurmurHash.finish(s,1)}equals(s){return s===this}toString(){return"popMode"}};e([o.Override],i.prototype,"actionType",null),e([o.Override],i.prototype,"isPositionDependent",null),e([o.Override,t(0,o.NotNull)],i.prototype,"execute",null),e([o.Override],i.prototype,"hashCode",null),e([o.Override],i.prototype,"equals",null),e([o.Override],i.prototype,"toString",null),l.LexerPopModeAction=i,function(n){n.INSTANCE=new n}(i=l.LexerPopModeAction||(l.LexerPopModeAction={}))}(hn)),hn}var qt={},oh;function $0(){if(oh)return qt;oh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=qt&&qt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=qt&&qt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(qt,"__esModule",{value:!0}),qt.LexerPushModeAction=void 0;const t=je(),r=Z();let o=class zd{constructor(n){this._mode=n}get mode(){return this._mode}get actionType(){return 5}get isPositionDependent(){return!1}execute(n){n.pushMode(this._mode)}hashCode(){let n=t.MurmurHash.initialize();return n=t.MurmurHash.update(n,this.actionType),n=t.MurmurHash.update(n,this._mode),t.MurmurHash.finish(n,2)}equals(n){return n===this?!0:n instanceof zd?this._mode===n._mode:!1}toString(){return`pushMode(${this._mode})`}};return l([r.Override],o.prototype,"actionType",null),l([r.Override],o.prototype,"isPositionDependent",null),l([r.Override,e(0,r.NotNull)],o.prototype,"execute",null),l([r.Override],o.prototype,"hashCode",null),l([r.Override],o.prototype,"equals",null),l([r.Override],o.prototype,"toString",null),qt.LexerPushModeAction=o,qt}var fn={},sh;function V0(){return sh||(sh=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=fn&&fn.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},t=fn&&fn.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(l,"__esModule",{value:!0}),l.LexerSkipAction=void 0;const r=je(),o=Z();let i=class{constructor(){}get actionType(){return 6}get isPositionDependent(){return!1}execute(s){s.skip()}hashCode(){let s=r.MurmurHash.initialize();return s=r.MurmurHash.update(s,this.actionType),r.MurmurHash.finish(s,1)}equals(s){return s===this}toString(){return"skip"}};e([o.Override],i.prototype,"actionType",null),e([o.Override],i.prototype,"isPositionDependent",null),e([o.Override,t(0,o.NotNull)],i.prototype,"execute",null),e([o.Override],i.prototype,"hashCode",null),e([o.Override],i.prototype,"equals",null),e([o.Override],i.prototype,"toString",null),l.LexerSkipAction=i,function(n){n.INSTANCE=new n}(i=l.LexerSkipAction||(l.LexerSkipAction={}))}(fn)),fn}var Ht={},ah;function W0(){if(ah)return Ht;ah=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ht&&Ht.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=Ht&&Ht.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.LexerTypeAction=void 0;const t=je(),r=Z();let o=class jd{constructor(n){this._type=n}get type(){return this._type}get actionType(){return 7}get isPositionDependent(){return!1}execute(n){n.type=this._type}hashCode(){let n=t.MurmurHash.initialize();return n=t.MurmurHash.update(n,this.actionType),n=t.MurmurHash.update(n,this._type),t.MurmurHash.finish(n,2)}equals(n){return n===this?!0:n instanceof jd?this._type===n._type:!1}toString(){return`type(${this._type})`}};return l([r.Override],o.prototype,"actionType",null),l([r.Override],o.prototype,"isPositionDependent",null),l([r.Override,e(0,r.NotNull)],o.prototype,"execute",null),l([r.Override],o.prototype,"hashCode",null),l([r.Override],o.prototype,"equals",null),l([r.Override],o.prototype,"toString",null),Ht.LexerTypeAction=o,Ht}var dn={},lh;function qd(){if(lh)return dn;lh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=dn&&dn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(dn,"__esModule",{value:!0}),dn.LoopEndState=void 0;const e=yr(),t=Ue(),r=Z();let o=class extends e.ATNState{get stateType(){return t.ATNStateType.LOOP_END}};return l([r.Override],o.prototype,"stateType",null),dn.LoopEndState=o,dn}var Ut={},pn={},uh;function G0(){if(uh)return pn;uh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=pn&&pn.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c};Object.defineProperty(pn,"__esModule",{value:!0}),pn.ConflictInfo=void 0;const e=Z(),t=vr();let r=class Hd{constructor(i,n){this._conflictedAlts=i,this.exact=n}get conflictedAlts(){return this._conflictedAlts}get isExact(){return this.exact}equals(i){return i===this?!0:i instanceof Hd?this.isExact===i.isExact&&t.equals(this.conflictedAlts,i.conflictedAlts):!1}hashCode(){return this.conflictedAlts.hashCode()}};return l([e.Override],r.prototype,"equals",null),l([e.Override],r.prototype,"hashCode",null),pn.ConflictInfo=r,pn}var xn={},mn={},gn={},ch;function li(){if(ch)return gn;ch=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=gn&&gn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(gn,"__esModule",{value:!0}),gn.TerminalNode=void 0;const e=Ye(),t=Z(),r=Be();let o=class{constructor(n){this._symbol=n}getChild(n){throw new RangeError("Terminal Node has no children.")}get symbol(){return this._symbol}get parent(){return this._parent}setParent(n){this._parent=n}get payload(){return this._symbol}get sourceInterval(){let n=this._symbol.tokenIndex;return new e.Interval(n,n)}get childCount(){return 0}accept(n){return n.visitTerminal(this)}get text(){return this._symbol.text||""}toStringTree(n){return this.toString()}toString(){return this._symbol.type===r.Token.EOF?"<EOF>":this._symbol.text||""}};return l([t.Override],o.prototype,"getChild",null),l([t.Override],o.prototype,"parent",null),l([t.Override],o.prototype,"setParent",null),l([t.Override],o.prototype,"payload",null),l([t.Override],o.prototype,"sourceInterval",null),l([t.Override],o.prototype,"childCount",null),l([t.Override],o.prototype,"accept",null),l([t.Override],o.prototype,"text",null),l([t.Override],o.prototype,"toStringTree",null),l([t.Override],o.prototype,"toString",null),gn.TerminalNode=o,gn}var hh;function sl(){if(hh)return mn;hh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=mn&&mn.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c};Object.defineProperty(mn,"__esModule",{value:!0}),mn.ErrorNode=void 0;const e=Z(),t=li();let r=class extends t.TerminalNode{constructor(i){super(i)}accept(i){return i.visitErrorNode(this)}};return l([e.Override],r.prototype,"accept",null),mn.ErrorNode=r,mn}var yn={},Ei={},fh;function al(){if(fh)return Ei;fh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.RuleNode=void 0;let l=class{};return Ei.RuleNode=l,Ei}var $t={},dh;function Gn(){if(dh)return $t;dh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=$t&&$t.__decorate||function(d,p,y,x){var v=arguments.length,m=v<3?p:x===null?x=Object.getOwnPropertyDescriptor(p,y):x,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(d,p,y,x);else for(var S=d.length-1;S>=0;S--)(g=d[S])&&(m=(v<3?g(m):v>3?g(p,y,m):g(p,y))||m);return v>3&&m&&Object.defineProperty(p,y,m),m},e=$t&&$t.__param||function(d,p){return function(y,x){p(y,x,d)}};Object.defineProperty($t,"__esModule",{value:!0}),$t.Trees=void 0;const t=ft(),r=Xi(),o=sl(),i=Z(),n=to(),s=ut(),a=al(),c=li(),u=Be(),h=vr();let f=class Cr{static toStringTree(p,y){let x;y instanceof n.Parser?x=y.ruleNames:x=y;let v=h.escapeWhitespace(this.getNodeText(p,x),!1);if(p.childCount===0)return v;let m="";m+="(",v=h.escapeWhitespace(this.getNodeText(p,x),!1),m+=v,m+=" ";for(let g=0;g<p.childCount;g++)g>0&&(m+=" "),m+=this.toStringTree(p.getChild(g),x);return m+=")",m}static getNodeText(p,y){let x;if(y instanceof n.Parser)x=y.ruleNames;else if(y)x=y;else{let v=p.payload;return typeof v.text=="string"?v.text:p.payload.toString()}if(p instanceof a.RuleNode){let v=p.ruleContext,m=v.ruleIndex,g=x[m],S=v.altNumber;return S!==t.ATN.INVALID_ALT_NUMBER?g+":"+S:g}else{if(p instanceof o.ErrorNode)return p.toString();if(p instanceof c.TerminalNode)return p.symbol.text||""}throw new TypeError("Unexpected node type")}static getChildren(p){let y=[];for(let x=0;x<p.childCount;x++)y.push(p.getChild(x));return y}static getAncestors(p){let y=[],x=p.parent;for(;x;)y.unshift(x),x=x.parent;return y}static isAncestorOf(p,y){if(!p||!y||!p.parent)return!1;let x=y.parent;for(;x;){if(p===x)return!0;x=x.parent}return!1}static findAllTokenNodes(p,y){return Cr.findAllNodes(p,y,!0)}static findAllRuleNodes(p,y){return Cr.findAllNodes(p,y,!1)}static findAllNodes(p,y,x){let v=[];return Cr._findAllNodes(p,y,x,v),v}static _findAllNodes(p,y,x,v){x&&p instanceof c.TerminalNode?p.symbol.type===y&&v.push(p):!x&&p instanceof s.ParserRuleContext&&p.ruleIndex===y&&v.push(p);for(let m=0;m<p.childCount;m++)Cr._findAllNodes(p.getChild(m),y,x,v)}static getDescendants(p){let y=[];function x(v){y.push(v);const m=v.childCount;for(let g=0;g<m;g++)x(v.getChild(g))}return x(p),y}static getRootOfSubtreeEnclosingRegion(p,y,x){let v=p.childCount;for(let m=0;m<v;m++){let g=p.getChild(m),S=Cr.getRootOfSubtreeEnclosingRegion(g,y,x);if(S)return S}if(p instanceof s.ParserRuleContext){let m=p.stop;if(y>=p.start.tokenIndex&&(m==null||x<=m.tokenIndex))return p}}static stripChildrenOutOfRange(p,y,x,v){if(!p)return;let m=p.childCount;for(let g=0;g<m;g++){let S=p.getChild(g),C=S.sourceInterval;if(S instanceof s.ParserRuleContext&&(C.b<x||C.a>v)&&Cr.isAncestorOf(S,y)){let A=new r.CommonToken(u.Token.INVALID_TYPE,"...");p.children[g]=new c.TerminalNode(A)}}}static findNodeSuchThat(p,y){if(y(p))return p;let x=p.childCount;for(let v=0;v<x;v++){let m=Cr.findNodeSuchThat(p.getChild(v),y);if(m!==void 0)return m}}};return l([e(0,i.NotNull)],f,"toStringTree",null),l([i.NotNull,e(0,i.NotNull)],f,"getAncestors",null),l([e(0,i.NotNull)],f,"getRootOfSubtreeEnclosingRegion",null),$t.Trees=f,$t}var ph;function $d(){if(ph)return yn;ph=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=yn&&yn.__decorate||function(c,u,h,f){var d=arguments.length,p=d<3?u:f===null?f=Object.getOwnPropertyDescriptor(u,h):f,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,u,h,f);else for(var x=c.length-1;x>=0;x--)(y=c[x])&&(p=(d<3?y(p):d>3?y(u,h,p):y(u,h))||p);return d>3&&p&&Object.defineProperty(u,h,p),p};Object.defineProperty(yn,"__esModule",{value:!0}),yn.RuleContext=void 0;const e=ft(),t=Qi(),r=al(),o=Ye(),i=Z(),n=Gn(),s=ut();let a=class Ud extends r.RuleNode{constructor(u,h){super(),this._parent=u,this.invokingState=h??-1}static getChildContext(u,h){return new Ud(u,h)}depth(){let u=0,h=this;for(;h;)h=h._parent,u++;return u}get isEmpty(){return this.invokingState===-1}get sourceInterval(){return o.Interval.INVALID}get ruleContext(){return this}get parent(){return this._parent}setParent(u){this._parent=u}get payload(){return this}get text(){if(this.childCount===0)return"";let u="";for(let h=0;h<this.childCount;h++)u+=this.getChild(h).text;return u.toString()}get ruleIndex(){return-1}get altNumber(){return e.ATN.INVALID_ALT_NUMBER}set altNumber(u){}getChild(u){throw new RangeError("i must be greater than or equal to 0 and less than childCount")}get childCount(){return 0}accept(u){return u.visitChildren(this)}toStringTree(u){return n.Trees.toStringTree(this,u)}toString(u,h){const f=u instanceof t.Recognizer?u.ruleNames:u;h=h||s.ParserRuleContext.emptyContext();let d="",p=this;for(d+="[";p&&p!==h;){if(!f)p.isEmpty||(d+=p.invokingState);else{let y=p.ruleIndex,x=y>=0&&y<f.length?f[y]:y.toString();d+=x}p._parent&&(f||!p._parent.isEmpty)&&(d+=" "),p=p._parent}return d+="]",d.toString()}};return l([i.Override],a.prototype,"sourceInterval",null),l([i.Override],a.prototype,"ruleContext",null),l([i.Override],a.prototype,"parent",null),l([i.Override],a.prototype,"setParent",null),l([i.Override],a.prototype,"payload",null),l([i.Override],a.prototype,"text",null),l([i.Override],a.prototype,"getChild",null),l([i.Override],a.prototype,"childCount",null),l([i.Override],a.prototype,"accept",null),l([i.Override],a.prototype,"toStringTree",null),yn.RuleContext=a,yn}var xh;function ut(){if(xh)return xn;xh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=xn&&xn.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f};Object.defineProperty(xn,"__esModule",{value:!0}),xn.ParserRuleContext=void 0;const e=sl(),t=Ye(),r=Z(),o=$d(),i=li();let n=class Pa extends o.RuleContext{constructor(a,c){c==null?super():super(a,c)}static emptyContext(){return Pa.EMPTY}copyFrom(a){if(this._parent=a._parent,this.invokingState=a.invokingState,this._start=a._start,this._stop=a._stop,a.children){this.children=[];for(let c of a.children)c instanceof e.ErrorNode&&this.addChild(c)}}enterRule(a){}exitRule(a){}addAnyChild(a){return this.children?this.children.push(a):this.children=[a],a}addChild(a){if(a instanceof i.TerminalNode){a.setParent(this),this.addAnyChild(a);return}else if(a instanceof o.RuleContext){this.addAnyChild(a);return}else return a=new i.TerminalNode(a),this.addAnyChild(a),a.setParent(this),a}addErrorNode(a){if(a instanceof e.ErrorNode){const c=a;return c.setParent(this),this.addAnyChild(c)}else{const c=a;let u=new e.ErrorNode(c);return this.addAnyChild(u),u.setParent(this),u}}removeLastChild(){this.children&&this.children.pop()}get parent(){let a=super.parent;if(a===void 0||a instanceof Pa)return a;throw new TypeError("Invalid parent type for ParserRuleContext")}getChild(a,c){if(!this.children||a<0||a>=this.children.length)throw new RangeError("index parameter must be between >= 0 and <= number of children.");if(c==null)return this.children[a];let u=this.tryGetChild(a,c);if(u===void 0)throw new Error("The specified node does not exist");return u}tryGetChild(a,c){if(!this.children||a<0||a>=this.children.length)return;let u=-1;for(let h of this.children)if(h instanceof c&&(u++,u===a))return h}getToken(a,c){let u=this.tryGetToken(a,c);if(u===void 0)throw new Error("The specified token does not exist");return u}tryGetToken(a,c){if(!this.children||c<0||c>=this.children.length)return;let u=-1;for(let h of this.children)if(h instanceof i.TerminalNode&&h.symbol.type===a&&(u++,u===c))return h}getTokens(a){let c=[];if(!this.children)return c;for(let u of this.children)u instanceof i.TerminalNode&&u.symbol.type===a&&c.push(u);return c}get ruleContext(){return this}getRuleContext(a,c){return this.getChild(a,c)}tryGetRuleContext(a,c){return this.tryGetChild(a,c)}getRuleContexts(a){let c=[];if(!this.children)return c;for(let u of this.children)u instanceof a&&c.push(u);return c}get childCount(){return this.children?this.children.length:0}get sourceInterval(){return this._start?!this._stop||this._stop.tokenIndex<this._start.tokenIndex?t.Interval.of(this._start.tokenIndex,this._start.tokenIndex-1):t.Interval.of(this._start.tokenIndex,this._stop.tokenIndex):t.Interval.INVALID}get start(){return this._start}get stop(){return this._stop}toInfoString(a){return"ParserRuleContext"+a.getRuleInvocationStack(this).reverse()+"{start="+this._start+", stop="+this._stop+"}"}};return n.EMPTY=new n,l([r.Override],n.prototype,"parent",null),l([r.Override],n.prototype,"childCount",null),l([r.Override],n.prototype,"sourceInterval",null),xn.ParserRuleContext=n,xn}var _i={},mh;function Y0(){return mh||(mh=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=_i&&_i.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(l,"__esModule",{value:!0}),l.PredictionMode=void 0;const t=ai(),r=je(),o=Z(),i=Ji();(function(n){n[n.SLL=0]="SLL",n[n.LL=1]="LL",n[n.LL_EXACT_AMBIG_DETECTION=2]="LL_EXACT_AMBIG_DETECTION"})(l.PredictionMode||(l.PredictionMode={})),function(n){class s extends t.Array2DHashMap{constructor(){super(a.INSTANCE)}}class a{AltAndContextConfigEqualityComparator(){}hashCode(f){let d=r.MurmurHash.initialize(7);return d=r.MurmurHash.update(d,f.state.stateNumber),d=r.MurmurHash.update(d,f.context),d=r.MurmurHash.finish(d,2),d}equals(f,d){return f===d?!0:f==null||d==null?!1:f.state.stateNumber===d.state.stateNumber&&f.context.equals(d.context)}}a.INSTANCE=new a,e([o.Override],a.prototype,"hashCode",null),e([o.Override],a.prototype,"equals",null);function c(h){for(let f of h)if(f.state instanceof i.RuleStopState)return!0;return!1}n.hasConfigInRuleStopState=c;function u(h){for(let f of h)if(!(f.state instanceof i.RuleStopState))return!1;return!0}n.allConfigsInRuleStopStates=u}(l.PredictionMode||(l.PredictionMode={}))}(_i)),_i}var Vt={},gh;function Vd(){if(gh)return Vt;gh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Vt&&Vt.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=Vt&&Vt.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.SimulatorState=void 0;const t=Z(),r=ut();let o=class{constructor(n,s,a,c){this.outerContext=n??r.ParserRuleContext.emptyContext(),this.s0=s,this.useContext=a,this.remainingOuterContext=c}};return o=l([e(1,t.NotNull)],o),Vt.SimulatorState=o,Vt}var yh;function Zi(){if(yh)return Ut;yh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ut&&Ut.__decorate||function(ie,_,E,T){var N=arguments.length,F=N<3?_:T===null?T=Object.getOwnPropertyDescriptor(_,E):T,O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(ie,_,E,T);else for(var I=ie.length-1;I>=0;I--)(O=ie[I])&&(F=(N<3?O(F):N>3?O(_,E,F):O(_,E))||F);return N>3&&F&&Object.defineProperty(_,E,F),F},e=Ut&&Ut.__param||function(ie,_){return function(E,T){_(E,T,ie)}};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.ParserATNSimulator=void 0;const t=Cd(),r=Dd(),o=Fr(),i=Qa(),n=ft(),s=wo(),a=Ki(),c=Oo(),u=Ue(),h=Ld(),f=Pr(),d=G0(),p=$n(),y=No(),x=Ja(),v=Ye(),m=wr(),g=Z(),S=il(),C=Do(),A=ht(),b=ut(),R=lt(),w=el(),P=Y0(),M=Ji(),D=ol(),U=si(),J=nl(),te=Vd(),le=Be(),ge=Vn(),ce=Ve(),ee=65535,G=-2147483648;let Q=class Ee extends c.ATNSimulator{constructor(_,E){super(_),this.predictionMode=P.PredictionMode.LL,this.force_global_context=!1,this.always_try_local_context=!0,this.enable_global_context_dfa=!1,this.optimize_unique_closure=!0,this.optimize_ll1=!0,this.optimize_tail_calls=!0,this.tail_call_preserves_sll=!0,this.treat_sllk1_conflict_as_ambiguity=!1,this.reportAmbiguities=!1,this.userWantsCtxSensitive=!0,this._parser=E}getPredictionMode(){return this.predictionMode}setPredictionMode(_){this.predictionMode=_}reset(){}adaptivePredict(_,E,T,N){N===void 0&&(N=!1);let F=this.atn.decisionToDFA[E];if(ce(F!=null),this.optimize_ll1&&!F.isPrecedenceDfa&&!F.isEmpty){let $=_.LA(1);if($>=0&&$<=65535){let W=(E<<16>>>0)+$,L=this.atn.LL1Table.get(W);if(L!=null)return L}}this.dfa=F,this.force_global_context?N=!0:this.always_try_local_context||(N=N||F.isContextSensitive),this.userWantsCtxSensitive=N||this.predictionMode!==P.PredictionMode.SLL&&T!=null&&!this.atn.decisionToState[E].sll,T==null&&(T=b.ParserRuleContext.emptyContext());let O;F.isEmpty||(O=this.getStartState(F,_,T,N)),O==null&&(T==null&&(T=b.ParserRuleContext.emptyContext()),Ee.debug&&console.log("ATN decision "+F.decision+" exec LA(1)=="+this.getLookaheadName(_)+", outerContext="+T.toString(this._parser)),O=this.computeStartState(F,T,N));let I=_.mark(),j=_.index;try{let $=this.execDFA(F,_,j,O);return Ee.debug&&console.log("DFA after predictATN: "+F.toString(this._parser.vocabulary,this._parser.ruleNames)),$}finally{this.dfa=void 0,_.seek(j),_.release(I)}}getStartState(_,E,T,N){if(!N)if(_.isPrecedenceDfa){let I=_.getPrecedenceStartState(this._parser.precedence,!1);return I==null?void 0:new te.SimulatorState(T,I,!1,T)}else return _.s0==null?void 0:new te.SimulatorState(T,_.s0,!1,T);if(!this.enable_global_context_dfa)return;let F=T;ce(T!=null);let O;for(_.isPrecedenceDfa?O=_.getPrecedenceStartState(this._parser.precedence,!0):O=_.s0full;F!=null&&O!=null&&O.isContextSensitive;)F=this.skipTailCalls(F),O=O.getContextTarget(this.getReturnState(F)),F.isEmpty?ce(O==null||!O.isContextSensitive):F=F.parent;if(O!=null)return new te.SimulatorState(T,O,N,F)}execDFA(_,E,T,N){let F=N.outerContext;Ee.dfa_debug&&console.log("DFA decision "+_.decision+" exec LA(1)=="+this.getLookaheadName(E)+", outerContext="+F.toString(this._parser)),Ee.dfa_debug&&console.log(_.toString(this._parser.vocabulary,this._parser.ruleNames));let O=N.s0,I=E.LA(1),j=N.remainingOuterContext;for(;;){if(Ee.dfa_debug&&console.log("DFA state "+O.stateNumber+" LA(1)=="+this.getLookaheadName(E)),N.useContext)for(;O.isContextSymbol(I);){let L;if(j!=null&&(j=this.skipTailCalls(j),L=O.getContextTarget(this.getReturnState(j))),L==null){let B=new te.SimulatorState(N.outerContext,O,N.useContext,j);return this.execATN(_,E,T,B)}ce(j!=null),j=j.parent,O=L}if(this.isAcceptState(O,N.useContext)){O.predicates!=null?Ee.dfa_debug&&console.log("accept "+O):Ee.dfa_debug&&console.log("accept; predict "+O.prediction+" in state "+O.stateNumber);break}ce(!this.isAcceptState(O,N.useContext));let W=this.getExistingTargetState(O,I);if(W==null){Ee.dfa_debug&&I>=0&&console.log("no edge for "+this._parser.vocabulary.getDisplayName(I));let L;if(Ee.dfa_debug){let H=v.Interval.of(T,this._parser.inputStream.index);console.log("ATN exec upon "+this._parser.inputStream.getText(H)+" at DFA state "+O.stateNumber)}let B=new te.SimulatorState(F,O,N.useContext,j);return L=this.execATN(_,E,T,B),Ee.dfa_debug&&console.log("back from DFA update, alt="+L+`, dfa=
`+_.toString(this._parser.vocabulary,this._parser.ruleNames)),Ee.dfa_debug&&console.log("DFA decision "+_.decision+" predicts "+L),L}else if(W===c.ATNSimulator.ERROR){let L=new te.SimulatorState(F,O,N.useContext,j);return this.handleNoViableAlt(E,T,L)}O=W,!this.isAcceptState(O,N.useContext)&&I!==m.IntStream.EOF&&(E.consume(),I=E.LA(1))}if(!N.useContext&&O.configs.conflictInfo!=null&&_.atnStartState instanceof p.DecisionState&&!(!this.userWantsCtxSensitive||!O.configs.dipsIntoOuterContext&&O.configs.isExactConflict||this.treat_sllk1_conflict_as_ambiguity&&E.index===T)){ce(!N.useContext);let W,L=O.predicates;if(L!=null){let B=E.index;if(B!==T&&E.seek(T),W=this.evalSemanticContext(L,F,!0),W.cardinality()===1)return W.nextSetBit(0);B!==T&&E.seek(B)}if(this.reportAmbiguities){let B=new te.SimulatorState(F,O,N.useContext,j);this.reportAttemptingFullContext(_,W,B,T,E.index)}return E.seek(T),this.adaptivePredict(E,_.decision,F,!0)}let $=O.predicates;if($!=null){let W=E.index;T!==W&&E.seek(T);let L=this.evalSemanticContext($,F,this.reportAmbiguities&&this.predictionMode===P.PredictionMode.LL_EXACT_AMBIG_DETECTION);switch(L.cardinality()){case 0:throw this.noViableAlt(E,F,O.configs,T);case 1:return L.nextSetBit(0);default:return T!==W&&E.seek(W),this.reportAmbiguity(_,O,T,W,O.configs.isExactConflict,L,O.configs),L.nextSetBit(0)}}return Ee.dfa_debug&&console.log("DFA decision "+_.decision+" predicts "+O.prediction),O.prediction}isAcceptState(_,E){return _.isAcceptState?_.configs.conflictingAlts==null?!0:E&&this.predictionMode===P.PredictionMode.LL_EXACT_AMBIG_DETECTION?_.configs.isExactConflict:!0:!1}execATN(_,E,T,N){Ee.debug&&console.log("execATN decision "+_.decision+" exec LA(1)=="+this.getLookaheadName(E));let F=N.outerContext,O=N.useContext,I=E.LA(1),j=N,$=new w.PredictionContextCache;for(;;){let W=this.computeReachSet(_,j,I,$);if(W==null)return this.setDFAEdge(j.s0,E.LA(1),c.ATNSimulator.ERROR),this.handleNoViableAlt(E,T,j);let L=W.s0;if(ce(L.isAcceptState||L.prediction===n.ATN.INVALID_ALT_NUMBER),ce(L.isAcceptState||L.configs.conflictInfo==null),this.isAcceptState(L,O)){let B=L.configs.conflictingAlts,H=B==null?L.prediction:n.ATN.INVALID_ALT_NUMBER;if(H!==n.ATN.INVALID_ALT_NUMBER){if(this.optimize_ll1&&E.index===T&&!_.isPrecedenceDfa&&W.outerContext===W.remainingOuterContext&&_.decision>=0&&!L.configs.hasSemanticContext&&I>=0&&I<=ee){let re=(_.decision<<16>>>0)+I;this.atn.LL1Table.set(re,H)}O&&this.always_try_local_context&&this.reportContextSensitivity(_,H,W,T,E.index)}H=L.prediction;let Y=B!=null&&this.userWantsCtxSensitive;if(Y&&(Y=!O&&(L.configs.dipsIntoOuterContext||!L.configs.isExactConflict)&&(!this.treat_sllk1_conflict_as_ambiguity||E.index!==T)),L.configs.hasSemanticContext){let re=L.predicates;if(re!=null){let ne=E.index;switch(ne!==T&&E.seek(T),B=this.evalSemanticContext(re,F,Y||this.reportAmbiguities),B.cardinality()){case 0:throw this.noViableAlt(E,F,L.configs,T);case 1:return B.nextSetBit(0)}ne!==T&&E.seek(ne)}}if(Y){ce(!O),ce(this.isAcceptState(L,!1)),Ee.debug&&console.log("RETRY with outerContext="+F);let re=this.computeStartState(_,F,!0);return this.reportAmbiguities&&this.reportAttemptingFullContext(_,B,W,T,E.index),E.seek(T),this.execATN(_,E,T,re)}else return B!=null&&(this.reportAmbiguities&&B.cardinality()>1&&this.reportAmbiguity(_,L,T,E.index,L.configs.isExactConflict,B,L.configs),H=B.nextSetBit(0)),H}j=W,I!==m.IntStream.EOF&&(E.consume(),I=E.LA(1))}}handleNoViableAlt(_,E,T){if(T.s0!=null){let N=new f.BitSet,F=0;for(let O of T.s0.configs)(O.reachesIntoOuterContext||O.state instanceof M.RuleStopState)&&(N.set(O.alt),F=Math.max(F,O.alt));switch(N.cardinality()){case 0:break;case 1:return N.nextSetBit(0);default:if(!T.s0.configs.hasSemanticContext)return N.nextSetBit(0);let O=new a.ATNConfigSet;for(let j of T.s0.configs)(j.reachesIntoOuterContext||j.state instanceof M.RuleStopState)&&O.add(j);let I=this.getPredsForAmbigAlts(N,O,F);if(I!=null){let j=this.getPredicatePredictions(N,I);if(j!=null){let $=_.index;try{_.seek(E);let W=this.evalSemanticContext(j,T.outerContext,!1);if(!W.isEmpty)return W.nextSetBit(0)}finally{_.seek($)}}}return N.nextSetBit(0)}}throw this.noViableAlt(_,T.outerContext,T.s0.configs,E)}computeReachSet(_,E,T,N){let F=E.useContext,O=E.remainingOuterContext,I=E.s0;if(F)for(;I.isContextSymbol(T);){let W;if(O!=null&&(O=this.skipTailCalls(O),W=I.getContextTarget(this.getReturnState(O))),W==null)break;ce(O!=null),O=O.parent,I=W}if(ce(!this.isAcceptState(I,F)),this.isAcceptState(I,F))return new te.SimulatorState(E.outerContext,I,F,O);let j=I,$=this.getExistingTargetState(j,T);if($==null){let W=this.computeTargetState(_,j,O,T,F,N);$=W[0],O=W[1]}if($!==c.ATNSimulator.ERROR)return ce(!F||!$.configs.dipsIntoOuterContext),new te.SimulatorState(E.outerContext,$,F,O)}getExistingTargetState(_,E){return _.getTarget(E)}computeTargetState(_,E,T,N,F,O){let I=E.configs.toArray(),j,$=new a.ATNConfigSet,W;do{let B=!F||T!=null;B||($.isOutermostConfigSet=!0);let H=new a.ATNConfigSet,Y;for(let q of I){if(Ee.debug&&console.log("testing "+this.getTokenName(N)+" at "+q.toString()),q.state instanceof M.RuleStopState){ce(q.context.isEmpty),(F&&!q.reachesIntoOuterContext||N===m.IntStream.EOF)&&(Y==null&&(Y=[]),Y.push(q));continue}let X=q.state.numberOfOptimizedTransitions;for(let he=0;he<X;he++){let be=q.state.getOptimizedTransition(he),Re=this.getReachableTarget(q,be,N);Re!=null&&H.add(q.transform(Re,!1),O)}}if(this.optimize_unique_closure&&Y==null&&N!==le.Token.EOF&&H.uniqueAlt!==n.ATN.INVALID_ALT_NUMBER){H.isOutermostConfigSet=$.isOutermostConfigSet,$=H;break}let re=!1,ne=N===le.Token.EOF;if(this.closure(H,$,re,B,O,ne),W=$.dipsIntoOuterContext,N===m.IntStream.EOF&&($=this.removeAllConfigsNotInRuleStopState($,O)),Y!=null&&(!F||!P.PredictionMode.hasConfigInRuleStopState($))){ce(Y.length>0);for(let q of Y)$.add(q,O)}if(F&&W){$.clear(),T=T,T=this.skipTailCalls(T);let q=this.getReturnState(T);if(j==null&&(j=new x.IntegerList),T.isEmpty?T=void 0:T=T.parent,j.add(q),q!==R.PredictionContext.EMPTY_FULL_STATE_KEY)for(let X=0;X<I.length;X++)I[X]=I[X].appendContext(q,O)}}while(F&&W);return $.isEmpty?(this.setDFAEdge(E,N,c.ATNSimulator.ERROR),[c.ATNSimulator.ERROR,T]):[this.addDFAEdge(_,E,N,j,$,O),T]}removeAllConfigsNotInRuleStopState(_,E){if(P.PredictionMode.allConfigsInRuleStopStates(_))return _;let T=new a.ATNConfigSet;for(let N of _)N.state instanceof M.RuleStopState&&T.add(N,E);return T}computeStartState(_,E,T){let N=_.isPrecedenceDfa?_.getPrecedenceStartState(this._parser.precedence,T):T?_.s0full:_.s0;if(N!=null){if(!T)return new te.SimulatorState(E,N,T,E);N.setContextSensitive(this.atn)}_.decision;let F=_.atnStartState,O=0,I=E,j=T?R.PredictionContext.EMPTY_FULL:R.PredictionContext.EMPTY_LOCAL,$=new w.PredictionContextCache;if(T){if(!this.enable_global_context_dfa)for(;I!=null;)I.isEmpty?(O=R.PredictionContext.EMPTY_FULL_STATE_KEY,I=void 0):(O=this.getReturnState(I),j=j.appendSingleContext(O,$),I=I.parent);for(;N!=null&&N.isContextSensitive&&I!=null;){let L;if(I=this.skipTailCalls(I),I.isEmpty?(L=N.getContextTarget(R.PredictionContext.EMPTY_FULL_STATE_KEY),O=R.PredictionContext.EMPTY_FULL_STATE_KEY,I=void 0):(O=this.getReturnState(I),L=N.getContextTarget(O),j=j.appendSingleContext(O,$),I=I.parent),L==null)break;N=L}}if(N!=null&&!N.isContextSensitive)return new te.SimulatorState(E,N,T,I);let W=new a.ATNConfigSet;for(;;){let L=new a.ATNConfigSet,B=F.numberOfTransitions;for(let X=0;X<B;X++){let he=F.transition(X).target;L.add(s.ATNConfig.create(he,X+1,j))}let H=I!=null;H||(W.isOutermostConfigSet=!0),this.closure(L,W,!0,H,$,!1);let re=W.dipsIntoOuterContext,ne;if(T&&!this.enable_global_context_dfa){N=this.addDFAState(_,W,$);break}else N==null?_.isPrecedenceDfa?(W=this.applyPrecedenceFilter(W,E,$),ne=this.addDFAState(_,W,$),_.setPrecedenceStartState(this._parser.precedence,T,ne)):(ne=this.addDFAState(_,W,$),T?_.s0full?ne=_.s0full:_.s0full=ne:_.s0?ne=_.s0:_.s0=ne):(_.isPrecedenceDfa&&(W=this.applyPrecedenceFilter(W,E,$)),ne=this.addDFAState(_,W,$),N.setContextTarget(O,ne));if(N=ne,!T||!re)break;ne.setContextSensitive(this.atn),I=I,W.clear(),I=this.skipTailCalls(I);let q=this.getReturnState(I);I.isEmpty?I=void 0:I=I.parent,q!==R.PredictionContext.EMPTY_FULL_STATE_KEY&&(j=j.appendSingleContext(q,$)),O=q}return new te.SimulatorState(E,N,T,I)}applyPrecedenceFilter(_,E,T){let N=new Map,F=new a.ATNConfigSet;for(let O of _){if(O.alt!==1)continue;let I=O.semanticContext.evalPrecedence(this._parser,E);I!=null&&(N.set(O.state.stateNumber,O.context),I!==O.semanticContext?F.add(O.transform(O.state,!1,I),T):F.add(O,T))}for(let O of _)if(O.alt!==1){if(!O.isPrecedenceFilterSuppressed){let I=N.get(O.state.stateNumber);if(I!=null&&I.equals(O.context))continue}F.add(O,T)}return F}getReachableTarget(_,E,T){if(E.matches(T,0,this.atn.maxTokenType))return E.target}predicateDFAState(_,E,T){let N=this.getConflictingAltsFromConfigSet(E);if(!N)throw new Error("This unhandled scenario is intended to be unreachable, but I'm currently not sure of why we know that's the case.");Ee.debug&&console.log("predicateDFAState "+_);let F=this.getPredsForAmbigAlts(N,E,T),O;return F!=null&&(O=this.getPredicatePredictions(N,F),_.predicates=O),O}getPredsForAmbigAlts(_,E,T){let N=new Array(T+1),F=N.length;for(let j of E)_.get(j.alt)&&(N[j.alt]=U.SemanticContext.or(N[j.alt],j.semanticContext));let O=0;for(let j=0;j<F;j++)N[j]==null?N[j]=U.SemanticContext.NONE:N[j]!==U.SemanticContext.NONE&&O++;let I=N;return O===0&&(I=void 0),Ee.debug&&console.log("getPredsForAmbigAlts result "+(I?i.Arrays.toString(I):"undefined")),I}getPredicatePredictions(_,E){let T=[],N=!1;for(let F=1;F<E.length;F++){let O=E[F];ce(O!=null),_!=null&&_.get(F)&&O===U.SemanticContext.NONE?T.push(new y.DFAState.PredPrediction(O,F)):O!==U.SemanticContext.NONE&&(N=!0,T.push(new y.DFAState.PredPrediction(O,F)))}if(N)return T}evalSemanticContext(_,E,T){let N=new f.BitSet;for(let F of _){if(F.pred===U.SemanticContext.NONE){if(N.set(F.alt),!T)break;continue}let O=this.evalSemanticContextImpl(F.pred,E,F.alt);if((Ee.debug||Ee.dfa_debug)&&console.log("eval pred "+F+"="+O),O&&((Ee.debug||Ee.dfa_debug)&&console.log("PREDICT "+F.alt),N.set(F.alt),!T))break}return N}evalSemanticContextImpl(_,E,T){return _.eval(this._parser,E)}closure(_,E,T,N,F,O){F==null&&(F=w.PredictionContextCache.UNCACHED);let I=_,j=new o.Array2DHashSet(A.ObjectEqualityComparator.INSTANCE);for(;I.size>0;){let $=new a.ATNConfigSet;for(let W of I)this.closureImpl(W,E,$,j,T,N,F,0,O);I=$}}closureImpl(_,E,T,N,F,O,I,j,$){if(Ee.debug&&console.log("closure("+_.toString(this._parser,!0)+")"),_.state instanceof M.RuleStopState)if(_.context.isEmpty)if(O)Ee.debug&&console.log("FALLING off rule "+this.getRuleName(_.state.ruleIndex)),_.context===R.PredictionContext.EMPTY_FULL?_=_.transform(_.state,!1,R.PredictionContext.EMPTY_LOCAL):!_.reachesIntoOuterContext&&R.PredictionContext.isEmptyLocal(_.context)&&E.add(_,I);else{E.add(_,I);return}else{let L=_.context.hasEmpty,B=_.context.size-(L?1:0);for(let H=0;H<B;H++){let Y=_.context.getParent(H),re=this.atn.states[_.context.getReturnState(H)],ne=s.ATNConfig.create(re,_.alt,Y,_.semanticContext);ne.outerContextDepth=_.outerContextDepth,ne.isPrecedenceFilterSuppressed=_.isPrecedenceFilterSuppressed,ce(j>G),this.closureImpl(ne,E,T,N,F,O,I,j-1,$)}if(!L||!O)return;_=_.transform(_.state,!1,R.PredictionContext.EMPTY_LOCAL)}let W=_.state;W.onlyHasEpsilonTransitions||(E.add(_,I),Ee.debug&&console.log("added config "+E));for(let L=0;L<W.numberOfOptimizedTransitions;L++){if(L===0&&W.stateType===u.ATNStateType.STAR_LOOP_ENTRY&&W.precedenceRuleDecision&&!_.context.hasEmpty){let re=W,ne=!0;for(let q=0;q<_.context.size;q++)if(!re.precedenceLoopbackStates.get(_.context.getReturnState(q))){ne=!1;break}if(ne)continue}let B=W.getOptimizedTransition(L),H=!(B instanceof r.ActionTransition)&&F,Y=this.getEpsilonTarget(_,B,H,j===0,I,$);if(Y!=null){if(B instanceof D.RuleTransition&&T!=null&&!F){T.add(Y,I);continue}let re=j;if(_.state instanceof M.RuleStopState){if(this.dfa!=null&&this.dfa.isPrecedenceDfa&&B.outermostPrecedenceReturn===this.dfa.atnStartState.ruleIndex&&(Y.isPrecedenceFilterSuppressed=!0),Y.outerContextDepth=Y.outerContextDepth+1,!N.add(Y))continue;ce(re>G),re--,Ee.debug&&console.log("dips into outer ctx: "+Y)}else if(B instanceof D.RuleTransition)this.optimize_tail_calls&&B.optimizedTailCall&&(!this.tail_call_preserves_sll||!R.PredictionContext.isEmptyLocal(_.context))?(ce(Y.context===_.context),re===0&&(re--,!this.tail_call_preserves_sll&&R.PredictionContext.isEmptyLocal(_.context)&&(Y.outerContextDepth=Y.outerContextDepth+1))):re>=0&&re++;else if(!B.isEpsilon&&!N.add(Y))continue;this.closureImpl(Y,E,T,N,H,O,I,re,$)}}}getRuleName(_){return this._parser!=null&&_>=0?this._parser.ruleNames[_]:"<rule "+_+">"}getEpsilonTarget(_,E,T,N,F,O){switch(E.serializationType){case 3:return this.ruleTransition(_,E,F);case 10:return this.precedenceTransition(_,E,T,N);case 4:return this.predTransition(_,E,T,N);case 6:return this.actionTransition(_,E);case 1:return _.transform(E.target,!1);case 5:case 2:case 7:return O&&E.matches(le.Token.EOF,0,1)?_.transform(E.target,!1):void 0;default:return}}actionTransition(_,E){return Ee.debug&&console.log("ACTION edge "+E.ruleIndex+":"+E.actionIndex),_.transform(E.target,!1)}precedenceTransition(_,E,T,N){Ee.debug&&(console.log("PRED (collectPredicates="+T+") "+E.precedence+">=_p, ctx dependent=true"),this._parser!=null&&console.log("context surrounding pred is "+this._parser.getRuleInvocationStack()));let F;if(T&&N){let O=U.SemanticContext.and(_.semanticContext,E.predicate);F=_.transform(E.target,!1,O)}else F=_.transform(E.target,!1);return Ee.debug&&console.log("config from pred transition="+F),F}predTransition(_,E,T,N){Ee.debug&&(console.log("PRED (collectPredicates="+T+") "+E.ruleIndex+":"+E.predIndex+", ctx dependent="+E.isCtxDependent),this._parser!=null&&console.log("context surrounding pred is "+this._parser.getRuleInvocationStack()));let F;if(T&&(!E.isCtxDependent||E.isCtxDependent&&N)){let O=U.SemanticContext.and(_.semanticContext,E.predicate);F=_.transform(E.target,!1,O)}else F=_.transform(E.target,!1);return Ee.debug&&console.log("config from pred transition="+F),F}ruleTransition(_,E,T){Ee.debug&&console.log("CALL rule "+this.getRuleName(E.target.ruleIndex)+", ctx="+_.context);let N=E.followState,F;return this.optimize_tail_calls&&E.optimizedTailCall&&(!this.tail_call_preserves_sll||!R.PredictionContext.isEmptyLocal(_.context))?F=_.context:T!=null?F=T.getChild(_.context,N.stateNumber):F=_.context.getChild(N.stateNumber),_.transform(E.target,!1,F)}isConflicted(_,E){if(_.uniqueAlt!==n.ATN.INVALID_ALT_NUMBER||_.size<=1)return;let T=_.toArray();T.sort(Ee.STATE_ALT_SORT_COMPARATOR);let N=!_.dipsIntoOuterContext,F=new f.BitSet,O=T[0].alt;F.set(O);let I=T[0].state.nonStopStateNumber;for(let B of T){let H=B.state.nonStopStateNumber;if(H!==I){if(B.alt!==O)return;I=H}}let j;if(N){I=T[0].state.nonStopStateNumber,j=new f.BitSet;let B=O;for(let Y of T){if(Y.state.nonStopStateNumber!==I)break;let re=Y.alt;j.set(re),B=re}I=T[0].state.nonStopStateNumber;let H=O;for(let Y of T){let re=Y.state.nonStopStateNumber,ne=Y.alt;if(re!==I){if(H!==B){N=!1;break}I=re,H=O}else if(ne!==H){if(ne!==j.nextSetBit(H+1)){N=!1;break}H=ne}}}I=T[0].state.nonStopStateNumber;let $=0,W=0,L=T[0].context;for(let B=1;B<T.length;B++){let H=T[B];if(H.alt!==O||H.state.nonStopStateNumber!==I)break;W=B,L=E.join(L,T[B].context)}for(let B=W+1;B<T.length;B++){let H=T[B],Y=H.state;if(F.set(H.alt),Y.nonStopStateNumber!==I){I=Y.nonStopStateNumber,$=B,W=B,L=H.context;for(let he=$+1;he<T.length;he++){let be=T[he];if(be.alt!==O||be.state.nonStopStateNumber!==I)break;W=he,L=E.join(L,be.context)}B=W;continue}let re=H.context,ne=H.alt,q=B;for(let he=q+1;he<T.length;he++){let be=T[he];if(be.alt!==ne||be.state.nonStopStateNumber!==I)break;q=he,re=E.join(re,be.context)}B=q;let X=E.join(L,re);if(!L.equals(X))return;N=N&&L.equals(re)}return new d.ConflictInfo(F,N)}getConflictingAltsFromConfigSet(_){let E=_.conflictingAlts;return E==null&&_.uniqueAlt!==n.ATN.INVALID_ALT_NUMBER&&(E=new f.BitSet,E.set(_.uniqueAlt)),E}getTokenName(_){if(_===le.Token.EOF)return"EOF";let T=(this._parser!=null?this._parser.vocabulary:ge.VocabularyImpl.EMPTY_VOCABULARY).getDisplayName(_);return T===String(_)?T:T+"<"+_+">"}getLookaheadName(_){return this.getTokenName(_.LA(1))}dumpDeadEndConfigs(_){console.log("dead end configs: ");let E=_.deadEndConfigs;if(E)for(let T of E){let N="no edges";if(T.state.numberOfOptimizedTransitions>0){let F=T.state.getOptimizedTransition(0);F instanceof h.AtomTransition?N="Atom "+this.getTokenName(F._label):F instanceof J.SetTransition&&(N=(F instanceof S.NotSetTransition?"~":"")+"Set "+F.set.toString())}console.log(T.toString(this._parser,!0)+":"+N)}}noViableAlt(_,E,T,N){return new C.NoViableAltException(this._parser,_,_.get(N),_.LT(1),T,E)}getUniqueAlt(_){let E=n.ATN.INVALID_ALT_NUMBER;for(let T of _)if(E===n.ATN.INVALID_ALT_NUMBER)E=T.alt;else if(T.alt!==E)return n.ATN.INVALID_ALT_NUMBER;return E}configWithAltAtStopState(_,E){for(let T of _)if(T.alt===E&&T.state instanceof M.RuleStopState)return!0;return!1}addDFAEdge(_,E,T,N,F,O){ce(N==null||N.isEmpty||_.isContextSensitive);let I=E,j=this.addDFAState(_,F,O);if(N!=null)for(let $ of N.toArray()){if($===R.PredictionContext.EMPTY_FULL_STATE_KEY&&I.configs.isOutermostConfigSet)continue;I.setContextSensitive(this.atn),I.setContextSymbol(T);let W=I.getContextTarget($);if(W!=null){I=W;continue}W=this.addDFAContextState(_,I.configs,$,O),ce($!==R.PredictionContext.EMPTY_FULL_STATE_KEY||W.configs.isOutermostConfigSet),I.setContextTarget($,W),I=W}return Ee.debug&&console.log("EDGE "+I+" -> "+j+" upon "+this.getTokenName(T)),this.setDFAEdge(I,T,j),Ee.debug&&console.log(`DFA=
`+_.toString(this._parser!=null?this._parser.vocabulary:ge.VocabularyImpl.EMPTY_VOCABULARY,this._parser!=null?this._parser.ruleNames:void 0)),j}setDFAEdge(_,E,T){_!=null&&_.setTarget(E,T)}addDFAContextState(_,E,T,N){if(T!==R.PredictionContext.EMPTY_FULL_STATE_KEY){let F=new a.ATNConfigSet;for(let O of E)F.add(O.appendContext(T,N));return this.addDFAState(_,F,N)}else return ce(!E.isOutermostConfigSet,"Shouldn't be adding a duplicate edge."),E=E.clone(!0),E.isOutermostConfigSet=!0,this.addDFAState(_,E,N)}addDFAState(_,E,T){let N=this.enable_global_context_dfa||!E.isOutermostConfigSet;if(N){E.isReadOnly||E.optimizeConfigs(this);let $=this.createDFAState(_,E),W=_.states.get($);if(W!=null)return W}E.isReadOnly||E.conflictInfo==null&&(E.conflictInfo=this.isConflicted(E,T));let F=this.createDFAState(_,E.clone(!0)),O=this.atn.getDecisionState(_.decision),I=this.getUniqueAlt(E);if(I!==n.ATN.INVALID_ALT_NUMBER)F.acceptStateInfo=new t.AcceptStateInfo(I);else if(E.conflictingAlts!=null){let $=E.conflictingAlts;$&&(F.acceptStateInfo=new t.AcceptStateInfo($.nextSetBit(0)))}if(F.isAcceptState&&E.hasSemanticContext&&this.predicateDFAState(F,E,O.numberOfTransitions),!N)return F;let j=_.addState(F);return Ee.debug&&j===F&&console.log("adding new DFA state: "+F),j}createDFAState(_,E){return new y.DFAState(E)}reportAttemptingFullContext(_,E,T,N,F){if(Ee.debug||Ee.retry_debug){let O=v.Interval.of(N,F);console.log("reportAttemptingFullContext decision="+_.decision+":"+T.s0.configs+", input="+this._parser.inputStream.getText(O))}if(this._parser!=null){let O=this._parser.getErrorListenerDispatch();O.reportAttemptingFullContext&&O.reportAttemptingFullContext(this._parser,_,N,F,E,T)}}reportContextSensitivity(_,E,T,N,F){if(Ee.debug||Ee.retry_debug){let O=v.Interval.of(N,F);console.log("reportContextSensitivity decision="+_.decision+":"+T.s0.configs+", input="+this._parser.inputStream.getText(O))}if(this._parser!=null){let O=this._parser.getErrorListenerDispatch();O.reportContextSensitivity&&O.reportContextSensitivity(this._parser,_,N,F,E,T)}}reportAmbiguity(_,E,T,N,F,O,I){if(Ee.debug||Ee.retry_debug){let j=v.Interval.of(T,N);console.log("reportAmbiguity "+O+":"+I+", input="+this._parser.inputStream.getText(j))}if(this._parser!=null){let j=this._parser.getErrorListenerDispatch();j.reportAmbiguity&&j.reportAmbiguity(this._parser,_,T,N,F,O,I)}}getReturnState(_){return _.isEmpty?R.PredictionContext.EMPTY_FULL_STATE_KEY:this.atn.states[_.invokingState].transition(0).followState.stateNumber}skipTailCalls(_){if(!this.optimize_tail_calls)return _;for(;!_.isEmpty;){let E=this.atn.states[_.invokingState];if(ce(E.numberOfTransitions===1&&E.transition(0).serializationType===3),!E.transition(0).tailCall)break;_=_.parent}return _}get parser(){return this._parser}};return Q.debug=!1,Q.dfa_debug=!1,Q.retry_debug=!1,Q.STATE_ALT_SORT_COMPARATOR=(ie,_)=>{let E=ie.state.nonStopStateNumber-_.state.nonStopStateNumber;return E!==0||(E=ie.alt-_.alt,E!==0)?E:0},l([g.NotNull],Q.prototype,"predictionMode",void 0),l([g.NotNull],Q.prototype,"getPredictionMode",null),l([e(0,g.NotNull)],Q.prototype,"setPredictionMode",null),l([g.Override],Q.prototype,"reset",null),l([e(0,g.NotNull)],Q.prototype,"adaptivePredict",null),l([e(0,g.NotNull),e(1,g.NotNull),e(2,g.NotNull)],Q.prototype,"getStartState",null),l([e(0,g.NotNull),e(1,g.NotNull),e(3,g.NotNull)],Q.prototype,"execDFA",null),l([e(0,g.NotNull),e(1,g.NotNull),e(3,g.NotNull)],Q.prototype,"execATN",null),l([e(0,g.NotNull),e(2,g.NotNull)],Q.prototype,"handleNoViableAlt",null),l([e(0,g.NotNull)],Q.prototype,"getExistingTargetState",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"computeTargetState",null),l([g.NotNull,e(0,g.NotNull)],Q.prototype,"removeAllConfigsNotInRuleStopState",null),l([g.NotNull],Q.prototype,"computeStartState",null),l([g.NotNull,e(0,g.NotNull)],Q.prototype,"applyPrecedenceFilter",null),l([e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"getReachableTarget",null),l([e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"getPredsForAmbigAlts",null),l([e(0,g.NotNull)],Q.prototype,"evalSemanticContext",null),l([e(0,g.NotNull)],Q.prototype,"evalSemanticContextImpl",null),l([e(1,g.NotNull),e(4,g.Nullable)],Q.prototype,"closure",null),l([e(0,g.NotNull),e(1,g.NotNull),e(2,g.Nullable),e(3,g.NotNull),e(6,g.NotNull)],Q.prototype,"closureImpl",null),l([g.NotNull],Q.prototype,"getRuleName",null),l([e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"getEpsilonTarget",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"actionTransition",null),l([g.Nullable,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"precedenceTransition",null),l([g.Nullable,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"predTransition",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull),e(2,g.Nullable)],Q.prototype,"ruleTransition",null),l([e(0,g.NotNull)],Q.prototype,"isConflicted",null),l([g.NotNull],Q.prototype,"getTokenName",null),l([e(0,g.NotNull)],Q.prototype,"dumpDeadEndConfigs",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull),e(2,g.NotNull)],Q.prototype,"noViableAlt",null),l([e(0,g.NotNull)],Q.prototype,"getUniqueAlt",null),l([e(0,g.NotNull)],Q.prototype,"configWithAltAtStopState",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull),e(4,g.NotNull)],Q.prototype,"addDFAEdge",null),l([e(0,g.Nullable),e(2,g.Nullable)],Q.prototype,"setDFAEdge",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"addDFAContextState",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"addDFAState",null),l([g.NotNull,e(0,g.NotNull),e(1,g.NotNull)],Q.prototype,"createDFAState",null),l([e(0,g.NotNull),e(2,g.NotNull)],Q.prototype,"reportAttemptingFullContext",null),l([e(0,g.NotNull),e(2,g.NotNull)],Q.prototype,"reportContextSensitivity",null),l([e(0,g.NotNull),e(5,g.NotNull),e(6,g.NotNull)],Q.prototype,"reportAmbiguity",null),Q=l([e(0,g.NotNull)],Q),Ut.ParserATNSimulator=Q,Ut}var vn={},vh;function X0(){if(vh)return vn;vh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=vn&&vn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(vn,"__esModule",{value:!0}),vn.PlusBlockStartState=void 0;const e=Ue(),t=Io(),r=Z();let o=class extends t.BlockStartState{get stateType(){return e.ATNStateType.PLUS_BLOCK_START}};return l([r.Override],o.prototype,"stateType",null),vn.PlusBlockStartState=o,vn}var Sn={},Sh;function K0(){if(Sh)return Sn;Sh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Sn&&Sn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.PlusLoopbackState=void 0;const e=Ue(),t=$n(),r=Z();let o=class extends t.DecisionState{get stateType(){return e.ATNStateType.PLUS_LOOP_BACK}};return l([r.Override],o.prototype,"stateType",null),Sn.PlusLoopbackState=o,Sn}var Wt={},Ah;function Q0(){if(Ah)return Wt;Ah=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Wt&&Wt.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Wt&&Wt.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PrecedencePredicateTransition=void 0;const t=Ka(),r=Z(),o=si();let i=class extends t.AbstractPredicateTransition{constructor(s,a){super(s),this.precedence=a}get serializationType(){return 10}get isEpsilon(){return!0}matches(s,a,c){return!1}get predicate(){return new o.SemanticContext.PrecedencePredicate(this.precedence)}toString(){return this.precedence+" >= _p"}};return l([r.Override],i.prototype,"serializationType",null),l([r.Override],i.prototype,"isEpsilon",null),l([r.Override],i.prototype,"matches",null),l([r.Override],i.prototype,"toString",null),i=l([e(0,r.NotNull)],i),Wt.PrecedencePredicateTransition=i,Wt}var Gt={},Ch;function J0(){if(Ch)return Gt;Ch=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Gt&&Gt.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Gt&&Gt.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.RangeTransition=void 0;const t=Wn(),r=Z(),o=Or();let i=class extends o.Transition{constructor(s,a,c){super(s),this.from=a,this.to=c}get serializationType(){return 2}get label(){return t.IntervalSet.of(this.from,this.to)}matches(s,a,c){return s>=this.from&&s<=this.to}toString(){return"'"+String.fromCodePoint(this.from)+"'..'"+String.fromCodePoint(this.to)+"'"}};return l([r.Override],i.prototype,"serializationType",null),l([r.Override,r.NotNull],i.prototype,"label",null),l([r.Override],i.prototype,"matches",null),l([r.Override,r.NotNull],i.prototype,"toString",null),i=l([e(0,r.NotNull)],i),Gt.RangeTransition=i,Gt}var An={},Eh;function Z0(){if(Eh)return An;Eh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=An&&An.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(An,"__esModule",{value:!0}),An.RuleStartState=void 0;const e=yr(),t=Ue(),r=Z();let o=class extends e.ATNState{constructor(){super(...arguments),this.isPrecedenceRule=!1,this.leftFactored=!1}get stateType(){return t.ATNStateType.RULE_START}};return l([r.Override],o.prototype,"stateType",null),An.RuleStartState=o,An}var Cn={},_h;function ex(){if(_h)return Cn;_h=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Cn&&Cn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.StarBlockStartState=void 0;const e=Ue(),t=Io(),r=Z();let o=class extends t.BlockStartState{get stateType(){return e.ATNStateType.STAR_BLOCK_START}};return l([r.Override],o.prototype,"stateType",null),Cn.StarBlockStartState=o,Cn}var En={},Th;function tx(){if(Th)return En;Th=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=En&&En.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(En,"__esModule",{value:!0}),En.StarLoopbackState=void 0;const e=yr(),t=Ue(),r=Z();let o=class extends e.ATNState{get loopEntryState(){return this.transition(0).target}get stateType(){return t.ATNStateType.STAR_LOOP_BACK}};return l([r.Override],o.prototype,"stateType",null),En.StarLoopbackState=o,En}var _n={},bh;function rx(){if(bh)return _n;bh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=_n&&_n.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(_n,"__esModule",{value:!0}),_n.TokensStartState=void 0;const e=Ue(),t=$n(),r=Z();let o=class extends t.DecisionState{get stateType(){return e.ATNStateType.TOKEN_START}};return l([r.Override],o.prototype,"stateType",null),_n.TokensStartState=o,_n}var Ti={},Rh;function nx(){if(Rh)return Ti;Rh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.UUID=void 0;const l=je();let e=class Ia{constructor(r,o,i,n){this.data=new Uint32Array(4),this.data[0]=r,this.data[1]=o,this.data[2]=i,this.data[3]=n}static fromString(r){if(!/^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$/.test(r))throw new Error("Incorrectly formatted UUID");let o=r.split("-"),i=parseInt(o[0],16),n=(parseInt(o[1],16)<<16>>>0)+parseInt(o[2],16),s=(parseInt(o[3],16)<<16>>>0)+parseInt(o[4].substr(0,4),16),a=parseInt(o[4].substr(-8),16);return new Ia(i,n,s,a)}hashCode(){return l.MurmurHash.hashCode([this.data[0],this.data[1],this.data[2],this.data[3]])}equals(r){return r===this?!0:r instanceof Ia?this.data[0]===r.data[0]&&this.data[1]===r.data[1]&&this.data[2]===r.data[2]&&this.data[3]===r.data[3]:!1}toString(){return("00000000"+this.data[0].toString(16)).substr(-8)+"-"+("0000"+(this.data[1]>>>16).toString(16)).substr(-4)+"-"+("0000"+this.data[1].toString(16)).substr(-4)+"-"+("0000"+(this.data[2]>>>16).toString(16)).substr(-4)+"-"+("0000"+this.data[2].toString(16)).substr(-4)+("00000000"+this.data[3].toString(16)).substr(-8)}};return Ti.UUID=e,Ti}var wh;function ll(){if(wh)return Dt;wh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Dt&&Dt.__decorate||function(W,L,B,H){var Y=arguments.length,re=Y<3?L:H===null?H=Object.getOwnPropertyDescriptor(L,B):H,ne;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")re=Reflect.decorate(W,L,B,H);else for(var q=W.length-1;q>=0;q--)(ne=W[q])&&(re=(Y<3?ne(re):Y>3?ne(L,B,re):ne(L,B))||re);return Y>3&&re&&Object.defineProperty(L,B,re),re},e=Dt&&Dt.__param||function(W,L){return function(B,H){L(B,H,W)}};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.ATNDeserializer=void 0;const t=Dd(),r=Fr(),o=ft(),i=Id(),n=Ue(),s=Ld(),a=B0(),c=wd(),u=Pr(),h=M0(),f=Io(),d=$n(),p=Rd(),y=k0(),x=Wn(),v=Nd(),m=z0(),g=j0(),S=q0(),C=H0(),A=U0(),b=$0(),R=V0(),w=W0(),P=qd(),M=Z(),D=il(),U=Zi(),J=X0(),te=K0(),le=Q0(),ge=vd(),ce=J0(),ee=Z0(),G=Ji(),Q=ol(),ie=nl(),_=ex(),E=tx(),T=rl(),N=Be(),F=rx(),O=nx(),I=Od();var j;(function(W){W[W.UNICODE_BMP=0]="UNICODE_BMP",W[W.UNICODE_SMP=1]="UNICODE_SMP"})(j||(j={}));let $=class fe{constructor(L){L===void 0&&(L=i.ATNDeserializationOptions.defaultOptions),this.deserializationOptions=L}static get SERIALIZED_VERSION(){return 3}static isFeatureSupported(L,B){let H=fe.SUPPORTED_UUIDS.findIndex(Y=>Y.equals(L));return H<0?!1:fe.SUPPORTED_UUIDS.findIndex(Y=>Y.equals(B))>=H}static getUnicodeDeserializer(L){return L===0?{readUnicode:(B,H)=>fe.toInt(B[H]),size:1}:{readUnicode:(B,H)=>fe.toInt32(B,H),size:2}}deserialize(L){L=L.slice(0);for(let K=1;K<L.length;K++)L[K]=L[K]-2&65535;let B=0,H=fe.toInt(L[B++]);if(H!==fe.SERIALIZED_VERSION){let K=`Could not deserialize ATN with version ${H} (expected ${fe.SERIALIZED_VERSION}).`;throw new Error(K)}let Y=fe.toUUID(L,B);if(B+=8,fe.SUPPORTED_UUIDS.findIndex(K=>K.equals(Y))<0){let K=`Could not deserialize ATN with UUID ${Y} (expected ${fe.SERIALIZED_UUID} or a legacy UUID).`;throw new Error(K)}let re=fe.isFeatureSupported(fe.ADDED_LEXER_ACTIONS,Y),ne=fe.toInt(L[B++]),q=fe.toInt(L[B++]),X=new o.ATN(ne,q),he=[],be=[],Re=fe.toInt(L[B++]);for(let K=0;K<Re;K++){let me=fe.toInt(L[B++]);if(me===n.ATNStateType.INVALID_TYPE){X.addState(new v.InvalidState);continue}let ye=fe.toInt(L[B++]);ye===65535&&(ye=-1);let Ce=this.stateFactory(me,ye);if(me===n.ATNStateType.LOOP_END){let Pe=fe.toInt(L[B++]);he.push([Ce,Pe])}else if(Ce instanceof f.BlockStartState){let Pe=fe.toInt(L[B++]);be.push([Ce,Pe])}X.addState(Ce)}for(let K of he)K[0].loopBackState=X.states[K[1]];for(let K of be)K[0].endState=X.states[K[1]];let z=fe.toInt(L[B++]);for(let K=0;K<z;K++){let me=fe.toInt(L[B++]);X.states[me].nonGreedy=!0}let V=fe.toInt(L[B++]);for(let K=0;K<V;K++){let me=fe.toInt(L[B++]);X.states[me].sll=!0}let ae=fe.toInt(L[B++]);for(let K=0;K<ae;K++){let me=fe.toInt(L[B++]);X.states[me].isPrecedenceRule=!0}let pe=fe.toInt(L[B++]);X.grammarType===0&&(X.ruleToTokenType=new Int32Array(pe)),X.ruleToStartState=new Array(pe);for(let K=0;K<pe;K++){let me=fe.toInt(L[B++]),ye=X.states[me];if(ye.leftFactored=fe.toInt(L[B++])!==0,X.ruleToStartState[K]=ye,X.grammarType===0){let Ce=fe.toInt(L[B++]);Ce===65535&&(Ce=N.Token.EOF),X.ruleToTokenType[K]=Ce,fe.isFeatureSupported(fe.ADDED_LEXER_ACTIONS,Y)||fe.toInt(L[B++])}}X.ruleToStopState=new Array(pe);for(let K of X.states)K instanceof G.RuleStopState&&(X.ruleToStopState[K.ruleIndex]=K,X.ruleToStartState[K.ruleIndex].stopState=K);let xe=fe.toInt(L[B++]);for(let K=0;K<xe;K++){let me=fe.toInt(L[B++]);X.modeToStartState.push(X.states[me])}X.modeToDFA=new Array(xe);for(let K=0;K<xe;K++)X.modeToDFA[K]=new p.DFA(X.modeToStartState[K]);let _e=[];B=this.deserializeSets(L,B,_e,fe.getUnicodeDeserializer(0)),fe.isFeatureSupported(fe.ADDED_UNICODE_SMP,Y)&&(B=this.deserializeSets(L,B,_e,fe.getUnicodeDeserializer(1)));let Se=fe.toInt(L[B++]);for(let K=0;K<Se;K++){let me=fe.toInt(L[B]),ye=fe.toInt(L[B+1]),Ce=fe.toInt(L[B+2]),Pe=fe.toInt(L[B+3]),We=fe.toInt(L[B+4]),He=fe.toInt(L[B+5]),Je=this.edgeFactory(X,Ce,me,ye,Pe,We,He,_e);X.states[me].addTransition(Je),B+=6}let we=new r.Array2DHashSet({hashCode:K=>K.stopState^K.returnState^K.outermostPrecedenceReturn,equals:(K,me)=>K.stopState===me.stopState&&K.returnState===me.returnState&&K.outermostPrecedenceReturn===me.outermostPrecedenceReturn}),Ne=[];for(let K of X.states){let me=K.ruleIndex>=0&&X.ruleToStartState[K.ruleIndex].leftFactored;for(let ye=0;ye<K.numberOfTransitions;ye++){let Ce=K.transition(ye);if(!(Ce instanceof Q.RuleTransition))continue;let Pe=Ce;if(!X.ruleToStartState[Pe.target.ruleIndex].leftFactored&&me)continue;let He=-1;X.ruleToStartState[Pe.target.ruleIndex].isPrecedenceRule&&Pe.precedence===0&&(He=Pe.target.ruleIndex);let Je={stopState:Pe.target.ruleIndex,returnState:Pe.followState.stateNumber,outermostPrecedenceReturn:He};we.add(Je)&&Ne.push(Je)}}for(let K of Ne){let me=new y.EpsilonTransition(X.states[K.returnState],K.outermostPrecedenceReturn);X.ruleToStopState[K.stopState].addTransition(me)}for(let K of X.states){if(K instanceof f.BlockStartState){if(K.endState===void 0)throw new Error("IllegalStateException");if(K.endState.startState!==void 0)throw new Error("IllegalStateException");K.endState.startState=K}if(K instanceof te.PlusLoopbackState){let me=K;for(let ye=0;ye<me.numberOfTransitions;ye++){let Ce=me.transition(ye).target;Ce instanceof J.PlusBlockStartState&&(Ce.loopBackState=me)}}else if(K instanceof E.StarLoopbackState){let me=K;for(let ye=0;ye<me.numberOfTransitions;ye++){let Ce=me.transition(ye).target;Ce instanceof T.StarLoopEntryState&&(Ce.loopBackState=me)}}}let ze=fe.toInt(L[B++]);for(let K=1;K<=ze;K++){let me=fe.toInt(L[B++]),ye=X.states[me];X.decisionToState.push(ye),ye.decision=K-1}if(X.grammarType===0)if(re){X.lexerActions=new Array(fe.toInt(L[B++]));for(let K=0;K<X.lexerActions.length;K++){let me=fe.toInt(L[B++]),ye=fe.toInt(L[B++]);ye===65535&&(ye=-1);let Ce=fe.toInt(L[B++]);Ce===65535&&(Ce=-1);let Pe=this.lexerActionFactory(me,ye,Ce);X.lexerActions[K]=Pe}}else{let K=[];for(let me of X.states)for(let ye=0;ye<me.numberOfTransitions;ye++){let Ce=me.transition(ye);if(!(Ce instanceof t.ActionTransition))continue;let Pe=Ce.ruleIndex,We=Ce.actionIndex,He=new g.LexerCustomAction(Pe,We);me.setTransition(ye,new t.ActionTransition(Ce.target,Pe,K.length,!1)),K.push(He)}X.lexerActions=K}this.markPrecedenceDecisions(X),X.decisionToDFA=new Array(ze);for(let K=0;K<ze;K++)X.decisionToDFA[K]=new p.DFA(X.decisionToState[K],K);if(this.deserializationOptions.isVerifyATN&&this.verifyATN(X),this.deserializationOptions.isGenerateRuleBypassTransitions&&X.grammarType===1){X.ruleToTokenType=new Int32Array(X.ruleToStartState.length);for(let K=0;K<X.ruleToStartState.length;K++)X.ruleToTokenType[K]=X.maxTokenType+K+1;for(let K=0;K<X.ruleToStartState.length;K++){let me=new a.BasicBlockStartState;me.ruleIndex=K,X.addState(me);let ye=new h.BlockEndState;ye.ruleIndex=K,X.addState(ye),me.endState=ye,X.defineDecisionState(me),ye.startState=me;let Ce,Pe;if(X.ruleToStartState[K].isPrecedenceRule){Ce=void 0;for(let He of X.states){if(He.ruleIndex!==K||!(He instanceof T.StarLoopEntryState))continue;let Je=He.transition(He.numberOfTransitions-1).target;if(Je instanceof P.LoopEndState&&Je.epsilonOnlyTransitions&&Je.transition(0).target instanceof G.RuleStopState){Ce=He;break}}if(!Ce)throw new Error("Couldn't identify final state of the precedence rule prefix section.");Pe=Ce.loopBackState.transition(0)}else Ce=X.ruleToStopState[K];for(let He of X.states)for(let Je=0;Je<He.numberOfTransitions;Je++){let no=He.transition(Je);no!==Pe&&no.target===Ce&&(no.target=ye)}for(;X.ruleToStartState[K].numberOfTransitions>0;){let He=X.ruleToStartState[K].removeTransition(X.ruleToStartState[K].numberOfTransitions-1);me.addTransition(He)}X.ruleToStartState[K].addTransition(new y.EpsilonTransition(me)),ye.addTransition(new y.EpsilonTransition(Ce));let We=new c.BasicState;X.addState(We),We.addTransition(new s.AtomTransition(ye,X.ruleToTokenType[K])),me.addTransition(new y.EpsilonTransition(We))}this.deserializationOptions.isVerifyATN&&this.verifyATN(X)}if(this.deserializationOptions.isOptimize){for(;;){let K=0;K+=fe.inlineSetRules(X),K+=fe.combineChainedEpsilons(X);let me=X.grammarType===0;if(K+=fe.optimizeSets(X,me),K===0)break}this.deserializationOptions.isVerifyATN&&this.verifyATN(X)}return fe.identifyTailCalls(X),X}deserializeSets(L,B,H,Y){let re=fe.toInt(L[B++]);for(let ne=0;ne<re;ne++){let q=fe.toInt(L[B]);B++;let X=new x.IntervalSet;H.push(X),fe.toInt(L[B++])!==0&&X.add(-1);for(let be=0;be<q;be++){let Re=Y.readUnicode(L,B);B+=Y.size;let z=Y.readUnicode(L,B);B+=Y.size,X.add(Re,z)}}return B}markPrecedenceDecisions(L){let B=new Map;for(let H of L.states)if(H instanceof T.StarLoopEntryState&&L.ruleToStartState[H.ruleIndex].isPrecedenceRule){let Y=H.transition(H.numberOfTransitions-1).target;Y instanceof P.LoopEndState&&Y.epsilonOnlyTransitions&&Y.transition(0).target instanceof G.RuleStopState&&(B.set(H.ruleIndex,H),H.precedenceRuleDecision=!0,H.precedenceLoopbackStates=new u.BitSet(L.states.length))}for(let H of B)for(let Y of L.ruleToStopState[H[0]].getTransitions())Y.serializationType!==1||Y.outermostPrecedenceReturn!==-1||H[1].precedenceLoopbackStates.set(Y.target.stateNumber)}verifyATN(L){for(let B of L.states)if(this.checkCondition(B!==void 0,"ATN states should not be undefined."),B.stateType!==n.ATNStateType.INVALID_TYPE){if(this.checkCondition(B.onlyHasEpsilonTransitions||B.numberOfTransitions<=1),B instanceof J.PlusBlockStartState&&this.checkCondition(B.loopBackState!==void 0),B instanceof T.StarLoopEntryState){let H=B;if(this.checkCondition(H.loopBackState!==void 0),this.checkCondition(H.numberOfTransitions===2),H.transition(0).target instanceof _.StarBlockStartState)this.checkCondition(H.transition(1).target instanceof P.LoopEndState),this.checkCondition(!H.nonGreedy);else if(H.transition(0).target instanceof P.LoopEndState)this.checkCondition(H.transition(1).target instanceof _.StarBlockStartState),this.checkCondition(H.nonGreedy);else throw new Error("IllegalStateException")}if(B instanceof E.StarLoopbackState&&(this.checkCondition(B.numberOfTransitions===1),this.checkCondition(B.transition(0).target instanceof T.StarLoopEntryState)),B instanceof P.LoopEndState&&this.checkCondition(B.loopBackState!==void 0),B instanceof ee.RuleStartState&&this.checkCondition(B.stopState!==void 0),B instanceof f.BlockStartState&&this.checkCondition(B.endState!==void 0),B instanceof h.BlockEndState&&this.checkCondition(B.startState!==void 0),B instanceof d.DecisionState){let H=B;this.checkCondition(H.numberOfTransitions<=1||H.decision>=0)}else this.checkCondition(B.numberOfTransitions<=1||B instanceof G.RuleStopState)}}checkCondition(L,B){if(!L)throw new Error("IllegalStateException: "+B)}static inlineSetRules(L){let B=0,H=new Array(L.ruleToStartState.length);for(let Y=0;Y<L.ruleToStartState.length;Y++){let ne=L.ruleToStartState[Y];for(;ne.onlyHasEpsilonTransitions&&ne.numberOfOptimizedTransitions===1&&ne.getOptimizedTransition(0).serializationType===1;)ne=ne.getOptimizedTransition(0).target;if(ne.numberOfOptimizedTransitions!==1)continue;let q=ne.getOptimizedTransition(0),X=q.target;if(!(q.isEpsilon||!X.onlyHasEpsilonTransitions||X.numberOfOptimizedTransitions!==1||!(X.getOptimizedTransition(0).target instanceof G.RuleStopState)))switch(q.serializationType){case 5:case 2:case 7:H[Y]=q;break;case 8:case 9:continue;default:continue}}for(let Y of L.states){if(Y.ruleIndex<0)continue;let re;for(let ne=0;ne<Y.numberOfOptimizedTransitions;ne++){let q=Y.getOptimizedTransition(ne);if(!(q instanceof Q.RuleTransition)){re!==void 0&&re.push(q);continue}let X=q,he=H[X.target.ruleIndex];if(he===void 0){re!==void 0&&re.push(q);continue}if(re===void 0){re=[];for(let z=0;z<ne;z++)re.push(Y.getOptimizedTransition(ne))}B++;let be=X.followState,Re=new c.BasicState;switch(Re.setRuleIndex(be.ruleIndex),L.addState(Re),re.push(new y.EpsilonTransition(Re)),he.serializationType){case 5:Re.addTransition(new s.AtomTransition(be,he._label));break;case 2:Re.addTransition(new ce.RangeTransition(be,he.from,he.to));break;case 7:Re.addTransition(new ie.SetTransition(be,he.label));break;default:throw new Error("UnsupportedOperationException")}}if(re!==void 0){if(Y.isOptimized)for(;Y.numberOfOptimizedTransitions>0;)Y.removeOptimizedTransition(Y.numberOfOptimizedTransitions-1);for(let ne of re)Y.addOptimizedTransition(ne)}}return U.ParserATNSimulator.debug&&console.log("ATN runtime optimizer removed "+B+" rule invocations by inlining sets."),B}static combineChainedEpsilons(L){let B=0;for(let H of L.states){if(!H.onlyHasEpsilonTransitions||H instanceof G.RuleStopState)continue;let Y;e:for(let re=0;re<H.numberOfOptimizedTransitions;re++){let ne=H.getOptimizedTransition(re),q=ne.target;if(ne.serializationType!==1||ne.outermostPrecedenceReturn!==-1||q.stateType!==n.ATNStateType.BASIC||!q.onlyHasEpsilonTransitions){Y!==void 0&&Y.push(ne);continue e}for(let X=0;X<q.numberOfOptimizedTransitions;X++)if(q.getOptimizedTransition(X).serializationType!==1||q.getOptimizedTransition(X).outermostPrecedenceReturn!==-1){Y!==void 0&&Y.push(ne);continue e}if(B++,Y===void 0){Y=[];for(let X=0;X<re;X++)Y.push(H.getOptimizedTransition(X))}for(let X=0;X<q.numberOfOptimizedTransitions;X++){let he=q.getOptimizedTransition(X).target;Y.push(new y.EpsilonTransition(he))}}if(Y!==void 0){if(H.isOptimized)for(;H.numberOfOptimizedTransitions>0;)H.removeOptimizedTransition(H.numberOfOptimizedTransitions-1);for(let re of Y)H.addOptimizedTransition(re)}}return U.ParserATNSimulator.debug&&console.log("ATN runtime optimizer removed "+B+" transitions by combining chained epsilon transitions."),B}static optimizeSets(L,B){if(B)return 0;let H=0,Y=L.decisionToState;for(let re of Y){let ne=new x.IntervalSet;for(let z=0;z<re.numberOfOptimizedTransitions;z++){let V=re.getOptimizedTransition(z);if(!(V instanceof y.EpsilonTransition)||V.target.numberOfOptimizedTransitions!==1)continue;let ae=V.target.getOptimizedTransition(0);ae.target instanceof h.BlockEndState&&(ae instanceof D.NotSetTransition||(ae instanceof s.AtomTransition||ae instanceof ce.RangeTransition||ae instanceof ie.SetTransition)&&ne.add(z))}if(ne.size<=1)continue;let q=[];for(let z=0;z<re.numberOfOptimizedTransitions;z++)ne.contains(z)||q.push(re.getOptimizedTransition(z));let X=re.getOptimizedTransition(ne.minElement).target.getOptimizedTransition(0).target,he=new x.IntervalSet;for(let z of ne.intervals)for(let V=z.a;V<=z.b;V++){let ae=re.getOptimizedTransition(V).target.getOptimizedTransition(0);if(ae instanceof D.NotSetTransition)throw new Error("Not yet implemented.");he.addAll(ae.label)}let be;if(he.intervals.length===1)if(he.size===1)be=new s.AtomTransition(X,he.minElement);else{let z=he.intervals[0];be=new ce.RangeTransition(X,z.a,z.b)}else be=new ie.SetTransition(X,he);let Re=new c.BasicState;if(Re.setRuleIndex(re.ruleIndex),L.addState(Re),Re.addTransition(be),q.push(new y.EpsilonTransition(Re)),H+=re.numberOfOptimizedTransitions-q.length,re.isOptimized)for(;re.numberOfOptimizedTransitions>0;)re.removeOptimizedTransition(re.numberOfOptimizedTransitions-1);for(let z of q)re.addOptimizedTransition(z)}return U.ParserATNSimulator.debug&&console.log("ATN runtime optimizer removed "+H+" paths by collapsing sets."),H}static identifyTailCalls(L){for(let B of L.states){for(let H=0;H<B.numberOfTransitions;H++){let Y=B.transition(H);Y instanceof Q.RuleTransition&&(Y.tailCall=this.testTailCall(L,Y,!1),Y.optimizedTailCall=this.testTailCall(L,Y,!0))}if(B.isOptimized)for(let H=0;H<B.numberOfOptimizedTransitions;H++){let Y=B.getOptimizedTransition(H);Y instanceof Q.RuleTransition&&(Y.tailCall=this.testTailCall(L,Y,!1),Y.optimizedTailCall=this.testTailCall(L,Y,!0))}}}static testTailCall(L,B,H){if(!H&&B.tailCall||H&&B.optimizedTailCall)return!0;let Y=new u.BitSet(L.states.length),re=[];for(re.push(B.followState);;){let ne=re.pop();if(!ne)break;if(Y.get(ne.stateNumber)||ne instanceof G.RuleStopState)continue;if(!ne.onlyHasEpsilonTransitions)return!1;let q=H?ne.numberOfOptimizedTransitions:ne.numberOfTransitions;for(let X=0;X<q;X++){let he=H?ne.getOptimizedTransition(X):ne.transition(X);if(he.serializationType!==1)return!1;re.push(he.target)}}return!0}static toInt(L){return L}static toInt32(L,B){return(L[B]|L[B+1]<<16)>>>0}static toUUID(L,B){let H=fe.toInt32(L,B),Y=fe.toInt32(L,B+2),re=fe.toInt32(L,B+4),ne=fe.toInt32(L,B+6);return new O.UUID(ne,re,Y,H)}edgeFactory(L,B,H,Y,re,ne,q,X){let he=L.states[Y];switch(B){case 1:return new y.EpsilonTransition(he);case 2:return q!==0?new ce.RangeTransition(he,N.Token.EOF,ne):new ce.RangeTransition(he,re,ne);case 3:return new Q.RuleTransition(L.states[re],ne,q,he);case 4:return new ge.PredicateTransition(he,re,ne,q!==0);case 10:return new le.PrecedencePredicateTransition(he,re);case 5:return q!==0?new s.AtomTransition(he,N.Token.EOF):new s.AtomTransition(he,re);case 6:return new t.ActionTransition(he,re,ne,q!==0);case 7:return new ie.SetTransition(he,X[re]);case 8:return new D.NotSetTransition(he,X[re]);case 9:return new I.WildcardTransition(he)}throw new Error("The specified transition type is not valid.")}stateFactory(L,B){let H;switch(L){case n.ATNStateType.INVALID_TYPE:return new v.InvalidState;case n.ATNStateType.BASIC:H=new c.BasicState;break;case n.ATNStateType.RULE_START:H=new ee.RuleStartState;break;case n.ATNStateType.BLOCK_START:H=new a.BasicBlockStartState;break;case n.ATNStateType.PLUS_BLOCK_START:H=new J.PlusBlockStartState;break;case n.ATNStateType.STAR_BLOCK_START:H=new _.StarBlockStartState;break;case n.ATNStateType.TOKEN_START:H=new F.TokensStartState;break;case n.ATNStateType.RULE_STOP:H=new G.RuleStopState;break;case n.ATNStateType.BLOCK_END:H=new h.BlockEndState;break;case n.ATNStateType.STAR_LOOP_BACK:H=new E.StarLoopbackState;break;case n.ATNStateType.STAR_LOOP_ENTRY:H=new T.StarLoopEntryState;break;case n.ATNStateType.PLUS_LOOP_BACK:H=new te.PlusLoopbackState;break;case n.ATNStateType.LOOP_END:H=new P.LoopEndState;break;default:let Y=`The specified state type ${L} is not valid.`;throw new Error(Y)}return H.ruleIndex=B,H}lexerActionFactory(L,B,H){switch(L){case 0:return new m.LexerChannelAction(B);case 1:return new g.LexerCustomAction(B,H);case 2:return new S.LexerModeAction(B);case 3:return C.LexerMoreAction.INSTANCE;case 4:return A.LexerPopModeAction.INSTANCE;case 5:return new b.LexerPushModeAction(B);case 6:return R.LexerSkipAction.INSTANCE;case 7:return new w.LexerTypeAction(B);default:let Y=`The specified lexer action type ${L} is not valid.`;throw new Error(Y)}}};return $.BASE_SERIALIZED_UUID=O.UUID.fromString("E4178468-DF95-44D0-AD87-F22A5D5FB6D3"),$.ADDED_LEXER_ACTIONS=O.UUID.fromString("AB35191A-1603-487E-B75A-479B831EAF6D"),$.ADDED_UNICODE_SMP=O.UUID.fromString("C23FEA89-0605-4f51-AFB8-058BCAB8C91B"),$.SUPPORTED_UUIDS=[$.BASE_SERIALIZED_UUID,$.ADDED_LEXER_ACTIONS,$.ADDED_UNICODE_SMP],$.SERIALIZED_UUID=$.ADDED_UNICODE_SMP,l([M.NotNull],$.prototype,"deserializationOptions",void 0),l([e(0,M.NotNull)],$.prototype,"deserialize",null),l([e(0,M.NotNull)],$.prototype,"markPrecedenceDecisions",null),l([M.NotNull,e(0,M.NotNull)],$.prototype,"edgeFactory",null),Dt.ATNDeserializer=$,Dt}var Yt={},Nh;function ix(){if(Nh)return Yt;Nh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Yt&&Yt.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c},e=Yt&&Yt.__param||function(o,i){return function(n,s){i(n,s,o)}};Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.ParseInfo=void 0;const t=Z();let r=class{constructor(i){this.atnSimulator=i}getDecisionInfo(){return this.atnSimulator.getDecisionInfo()}getLLDecisions(){let i=this.atnSimulator.getDecisionInfo(),n=[];for(let s=0;s<i.length;s++)i[s].LL_Fallback>0&&n.push(s);return n}getTotalTimeInPrediction(){let i=this.atnSimulator.getDecisionInfo(),n=0;for(let s of i)n+=s.timeInPrediction;return n}getTotalSLLLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),n=0;for(let s of i)n+=s.SLL_TotalLook;return n}getTotalLLLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),n=0;for(let s of i)n+=s.LL_TotalLook;return n}getTotalSLLATNLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),n=0;for(let s of i)n+=s.SLL_ATNTransitions;return n}getTotalLLATNLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),n=0;for(let s of i)n+=s.LL_ATNTransitions;return n}getTotalATNLookaheadOps(){let i=this.atnSimulator.getDecisionInfo(),n=0;for(let s of i)n+=s.SLL_ATNTransitions,n+=s.LL_ATNTransitions;return n}getDFASize(i){if(i)return this.atnSimulator.atn.decisionToDFA[i].states.size;{let n=0,s=this.atnSimulator.atn.decisionToDFA;for(let a=0;a<s.length;a++)n+=this.getDFASize(a);return n}}};return l([t.NotNull],r.prototype,"getDecisionInfo",null),l([t.NotNull],r.prototype,"getLLDecisions",null),r=l([e(0,t.NotNull)],r),Yt.ParseInfo=r,Yt}var Tn={},Oh;function Wd(){if(Oh)return Tn;Oh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Tn&&Tn.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c};Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.ProxyParserErrorListener=void 0;const e=tl(),t=Z();let r=class extends e.ProxyErrorListener{constructor(i){super(i)}reportAmbiguity(i,n,s,a,c,u,h){this.getDelegates().forEach(f=>{f.reportAmbiguity&&f.reportAmbiguity(i,n,s,a,c,u,h)})}reportAttemptingFullContext(i,n,s,a,c,u){this.getDelegates().forEach(h=>{h.reportAttemptingFullContext&&h.reportAttemptingFullContext(i,n,s,a,c,u)})}reportContextSensitivity(i,n,s,a,c,u){this.getDelegates().forEach(h=>{h.reportContextSensitivity&&h.reportContextSensitivity(i,n,s,a,c,u)})}};return l([t.Override],r.prototype,"reportAmbiguity",null),l([t.Override],r.prototype,"reportAttemptingFullContext",null),l([t.Override],r.prototype,"reportContextSensitivity",null),Tn.ProxyParserErrorListener=r,Tn}var bn={},fa={},da={},Xt={},Fh;function ox(){if(Fh)return Xt;Fh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.isSupplementaryCodePoint=Xt.isLowSurrogate=Xt.isHighSurrogate=void 0;function l(r){return r>=55296&&r<=56319}Xt.isHighSurrogate=l;function e(r){return r>=56320&&r<=57343}Xt.isLowSurrogate=e;function t(r){return r>=65536}return Xt.isSupplementaryCodePoint=t,Xt}var Ph;function Gd(){return Ph||(Ph=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.CodePointBuffer=void 0;const e=Ve(),t=ox();class r{constructor(i,n){this.buffer=i,this._position=0,this._size=n}static withArray(i){return new r(i,i.length)}get position(){return this._position}set position(i){if(i<0||i>this._size)throw new RangeError;this._position=i}get remaining(){return this._size-this.position}get(i){return this.buffer[i]}array(){return this.buffer.slice(0,this._size)}static builder(i){return new r.Builder(i)}}l.CodePointBuffer=r,function(o){let i;(function(s){s[s.BYTE=0]="BYTE",s[s.CHAR=1]="CHAR",s[s.INT=2]="INT"})(i||(i={}));class n{constructor(a){this.type=0,this.buffer=new Uint8Array(a),this.prevHighSurrogate=-1,this.position=0}build(){return new o(this.buffer,this.position)}static roundUpToNextPowerOfTwo(a){let c=32-Math.clz32(a-1);return Math.pow(2,c)}ensureRemaining(a){switch(this.type){case 0:if(this.buffer.length-this.position<a){let c=n.roundUpToNextPowerOfTwo(this.buffer.length+a),u=new Uint8Array(c);u.set(this.buffer.subarray(0,this.position),0),this.buffer=u}break;case 1:if(this.buffer.length-this.position<a){let c=n.roundUpToNextPowerOfTwo(this.buffer.length+a),u=new Uint16Array(c);u.set(this.buffer.subarray(0,this.position),0),this.buffer=u}break;case 2:if(this.buffer.length-this.position<a){let c=n.roundUpToNextPowerOfTwo(this.buffer.length+a),u=new Int32Array(c);u.set(this.buffer.subarray(0,this.position),0),this.buffer=u}break}}append(a){this.ensureRemaining(a.length),this.appendArray(a)}appendArray(a){switch(this.type){case 0:this.appendArrayByte(a);break;case 1:this.appendArrayChar(a);break;case 2:this.appendArrayInt(a);break}}appendArrayByte(a){e(this.prevHighSurrogate===-1);let c=a,u=0,h=a.length,f=this.buffer,d=this.position;for(;u<h;){let p=c[u];if(p<=255)f[d]=p;else if(a=a.subarray(u,h),this.position=d,t.isHighSurrogate(p)){this.byteToIntBuffer(a.length),this.appendArrayInt(a);return}else{this.byteToCharBuffer(a.length),this.appendArrayChar(a);return}u++,d++}this.position=d}appendArrayChar(a){e(this.prevHighSurrogate===-1);let c=a,u=0,h=a.length,f=this.buffer,d=this.position;for(;u<h;){let p=c[u];if(!t.isHighSurrogate(p))f[d]=p;else{a=a.subarray(u,h),this.position=d,this.charToIntBuffer(a.length),this.appendArrayInt(a);return}u++,d++}this.position=d}appendArrayInt(a){let c=a,u=0,h=a.length,f=this.buffer,d=this.position;for(;u<h;){let p=c[u];u++,this.prevHighSurrogate!==-1?t.isLowSurrogate(p)?(f[d]=String.fromCharCode(this.prevHighSurrogate,p).codePointAt(0),d++,this.prevHighSurrogate=-1):(f[d]=this.prevHighSurrogate,d++,t.isHighSurrogate(p)?this.prevHighSurrogate=p:(f[d]=p,d++,this.prevHighSurrogate=-1)):t.isHighSurrogate(p)?this.prevHighSurrogate=p:(f[d]=p,d++)}this.prevHighSurrogate!==-1&&(f[d]=this.prevHighSurrogate,d++),this.position=d}byteToCharBuffer(a){let c=new Uint16Array(Math.max(this.position+a,this.buffer.length>>1));c.set(this.buffer.subarray(0,this.position),0),this.type=1,this.buffer=c}byteToIntBuffer(a){let c=new Int32Array(Math.max(this.position+a,this.buffer.length>>2));c.set(this.buffer.subarray(0,this.position),0),this.type=2,this.buffer=c}charToIntBuffer(a){let c=new Int32Array(Math.max(this.position+a,this.buffer.length>>1));c.set(this.buffer.subarray(0,this.position),0),this.type=2,this.buffer=c}}o.Builder=n}(r=l.CodePointBuffer||(l.CodePointBuffer={}))}(da)),da}var Rn={},Ih;function Xd(){if(Ih)return Rn;Ih=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Rn&&Rn.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.CodePointCharStream=void 0;const e=Ve(),t=wr(),r=Ye(),o=Z();let i=class Yd{constructor(s,a,c,u){e(a===0),this._array=s,this._size=c,this._name=u,this._position=0}get internalStorage(){return this._array}static fromBuffer(s,a){return(a===void 0||a.length===0)&&(a=t.IntStream.UNKNOWN_SOURCE_NAME),new Yd(s.array(),s.position,s.remaining,a)}consume(){if(this._size-this._position===0)throw e(this.LA(1)===t.IntStream.EOF),new RangeError("cannot consume EOF");this._position++}get index(){return this._position}get size(){return this._size}mark(){return-1}release(s){}seek(s){this._position=s}get sourceName(){return this._name}toString(){return this.getText(r.Interval.of(0,this.size-1))}LA(s){let a;switch(Math.sign(s)){case-1:return a=this.index+s,a<0?t.IntStream.EOF:this._array[a];case 0:return 0;case 1:return a=this.index+s-1,a>=this.size?t.IntStream.EOF:this._array[a]}throw new RangeError("Not reached")}getText(s){const a=Math.min(s.a,this.size),c=Math.min(s.b-s.a+1,this.size-a);return this._array instanceof Int32Array?String.fromCodePoint(...Array.from(this._array.subarray(a,a+c))):String.fromCharCode(...Array.from(this._array.subarray(a,a+c)))}};return l([o.Override],i.prototype,"consume",null),l([o.Override],i.prototype,"index",null),l([o.Override],i.prototype,"size",null),l([o.Override],i.prototype,"mark",null),l([o.Override],i.prototype,"release",null),l([o.Override],i.prototype,"seek",null),l([o.Override],i.prototype,"sourceName",null),l([o.Override],i.prototype,"toString",null),l([o.Override],i.prototype,"LA",null),l([o.Override],i.prototype,"getText",null),Rn.CodePointCharStream=i,Rn}var Dh;function ul(){return Dh||(Dh=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.CharStreams=void 0;const e=Gd(),t=Xd(),r=wr();(function(o){function i(n,s){(s===void 0||s.length===0)&&(s=r.IntStream.UNKNOWN_SOURCE_NAME);let a=e.CodePointBuffer.builder(n.length),c=new Uint16Array(n.length);for(let u=0;u<n.length;u++)c[u]=n.charCodeAt(u);return a.append(c),t.CodePointCharStream.fromBuffer(a.build(),s)}o.fromString=i})(l.CharStreams||(l.CharStreams={}))}(fa)),fa}var Kt={},Qt={},Lh;function Kd(){if(Lh)return Qt;Lh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Qt&&Qt.__decorate||function(c,u,h,f){var d=arguments.length,p=d<3?u:f===null?f=Object.getOwnPropertyDescriptor(u,h):f,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,u,h,f);else for(var x=c.length-1;x>=0;x--)(y=c[x])&&(p=(d<3?y(p):d>3?y(u,h,p):y(u,h))||p);return d>3&&p&&Object.defineProperty(u,h,p),p},e=Qt&&Qt.__param||function(c,u){return function(h,f){u(h,f,c)}};Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.BufferedTokenStream=void 0;const t=Ve(),r=Xi(),o=Ye(),i=Ir(),n=Z(),s=Be();let a=class{constructor(u){if(this.tokens=[],this.p=-1,this.fetchedEOF=!1,u==null)throw new Error("tokenSource cannot be null");this._tokenSource=u}get tokenSource(){return this._tokenSource}set tokenSource(u){this._tokenSource=u,this.tokens.length=0,this.p=-1,this.fetchedEOF=!1}get index(){return this.p}mark(){return 0}release(u){}seek(u){this.lazyInit(),this.p=this.adjustSeekIndex(u)}get size(){return this.tokens.length}consume(){let u;if(this.p>=0?this.fetchedEOF?u=this.p<this.tokens.length-1:u=this.p<this.tokens.length:u=!1,!u&&this.LA(1)===s.Token.EOF)throw new Error("cannot consume EOF");this.sync(this.p+1)&&(this.p=this.adjustSeekIndex(this.p+1))}sync(u){t(u>=0);let h=u-this.tokens.length+1;return h>0?this.fetch(h)>=h:!0}fetch(u){if(this.fetchedEOF)return 0;for(let h=0;h<u;h++){let f=this.tokenSource.nextToken();if(this.isWritableToken(f)&&(f.tokenIndex=this.tokens.length),this.tokens.push(f),f.type===s.Token.EOF)return this.fetchedEOF=!0,h+1}return u}get(u){if(u<0||u>=this.tokens.length)throw new RangeError("token index "+u+" out of range 0.."+(this.tokens.length-1));return this.tokens[u]}getRange(u,h){if(u<0||h<0)return[];this.lazyInit();let f=new Array;h>=this.tokens.length&&(h=this.tokens.length-1);for(let d=u;d<=h;d++){let p=this.tokens[d];if(p.type===s.Token.EOF)break;f.push(p)}return f}LA(u){let h=this.LT(u);return h?h.type:s.Token.INVALID_TYPE}tryLB(u){if(!(this.p-u<0))return this.tokens[this.p-u]}LT(u){let h=this.tryLT(u);if(h===void 0)throw new RangeError("requested lookback index out of range");return h}tryLT(u){if(this.lazyInit(),u===0)throw new RangeError("0 is not a valid lookahead index");if(u<0)return this.tryLB(-u);let h=this.p+u-1;return this.sync(h),h>=this.tokens.length?this.tokens[this.tokens.length-1]:this.tokens[h]}adjustSeekIndex(u){return u}lazyInit(){this.p===-1&&this.setup()}setup(){this.sync(0),this.p=this.adjustSeekIndex(0)}getTokens(u,h,f){if(this.lazyInit(),u===void 0)return t(h===void 0&&f===void 0),this.tokens;if(h===void 0&&(h=this.tokens.length-1),u<0||h>=this.tokens.length||h<0||u>=this.tokens.length)throw new RangeError("start "+u+" or stop "+h+" not in 0.."+(this.tokens.length-1));if(u>h)return[];if(f===void 0)return this.tokens.slice(u,h+1);typeof f=="number"&&(f=new Set().add(f));let d=f,p=this.tokens.slice(u,h+1);return p=p.filter(y=>d.has(y.type)),p}nextTokenOnChannel(u,h){if(this.sync(u),u>=this.size)return this.size-1;let f=this.tokens[u];for(;f.channel!==h;){if(f.type===s.Token.EOF)return u;u++,this.sync(u),f=this.tokens[u]}return u}previousTokenOnChannel(u,h){if(this.sync(u),u>=this.size)return this.size-1;for(;u>=0;){let f=this.tokens[u];if(f.type===s.Token.EOF||f.channel===h)return u;u--}return u}getHiddenTokensToRight(u,h=-1){if(this.lazyInit(),u<0||u>=this.tokens.length)throw new RangeError(u+" not in 0.."+(this.tokens.length-1));let f=this.nextTokenOnChannel(u+1,i.Lexer.DEFAULT_TOKEN_CHANNEL),d,p=u+1;return f===-1?d=this.size-1:d=f,this.filterForChannel(p,d,h)}getHiddenTokensToLeft(u,h=-1){if(this.lazyInit(),u<0||u>=this.tokens.length)throw new RangeError(u+" not in 0.."+(this.tokens.length-1));if(u===0)return[];let f=this.previousTokenOnChannel(u-1,i.Lexer.DEFAULT_TOKEN_CHANNEL);if(f===u-1)return[];let d=f+1,p=u-1;return this.filterForChannel(d,p,h)}filterForChannel(u,h,f){let d=new Array;for(let p=u;p<=h;p++){let y=this.tokens[p];f===-1?y.channel!==i.Lexer.DEFAULT_TOKEN_CHANNEL&&d.push(y):y.channel===f&&d.push(y)}return d}get sourceName(){return this.tokenSource.sourceName}getText(u){u===void 0?u=o.Interval.of(0,this.size-1):u instanceof o.Interval||(u=u.sourceInterval);let h=u.a,f=u.b;if(h<0||f<0)return"";this.fill(),f>=this.tokens.length&&(f=this.tokens.length-1);let d="";for(let p=h;p<=f;p++){let y=this.tokens[p];if(y.type===s.Token.EOF)break;d+=y.text}return d.toString()}getTextFromRange(u,h){return this.isToken(u)&&this.isToken(h)?this.getText(o.Interval.of(u.tokenIndex,h.tokenIndex)):""}fill(){this.lazyInit();const u=1e3;for(;;)if(this.fetch(u)<u)return}isWritableToken(u){return u instanceof r.CommonToken}isToken(u){return u instanceof r.CommonToken}};return l([n.NotNull],a.prototype,"_tokenSource",void 0),l([n.Override],a.prototype,"tokenSource",null),l([n.Override],a.prototype,"index",null),l([n.Override],a.prototype,"mark",null),l([n.Override],a.prototype,"release",null),l([n.Override],a.prototype,"seek",null),l([n.Override],a.prototype,"size",null),l([n.Override],a.prototype,"consume",null),l([n.Override],a.prototype,"get",null),l([n.Override],a.prototype,"LA",null),l([n.NotNull,n.Override],a.prototype,"LT",null),l([n.Override],a.prototype,"sourceName",null),l([n.NotNull,n.Override],a.prototype,"getText",null),l([n.NotNull,n.Override],a.prototype,"getTextFromRange",null),a=l([e(0,n.NotNull)],a),Qt.BufferedTokenStream=a,Qt}var Bh;function cl(){if(Bh)return Kt;Bh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Kt&&Kt.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Kt&&Kt.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.CommonTokenStream=void 0;const t=Kd(),r=Z(),o=Be();let i=class extends t.BufferedTokenStream{constructor(s,a=o.Token.DEFAULT_CHANNEL){super(s),this.channel=a}adjustSeekIndex(s){return this.nextTokenOnChannel(s,this.channel)}tryLB(s){if(this.p-s<0)return;let a=this.p,c=1;for(;c<=s&&a>0;)a=this.previousTokenOnChannel(a-1,this.channel),c++;if(!(a<0))return this.tokens[a]}tryLT(s){if(this.lazyInit(),s===0)throw new RangeError("0 is not a valid lookahead index");if(s<0)return this.tryLB(-s);let a=this.p,c=1;for(;c<s;)this.sync(a+1)&&(a=this.nextTokenOnChannel(a+1,this.channel)),c++;return this.tokens[a]}getNumberOfOnChannelTokens(){let s=0;this.fill();for(let a of this.tokens)if(a.channel===this.channel&&s++,a.type===o.Token.EOF)break;return s}};return l([r.Override],i.prototype,"adjustSeekIndex",null),l([r.Override],i.prototype,"tryLB",null),l([r.Override],i.prototype,"tryLT",null),i=l([e(0,r.NotNull)],i),Kt.CommonTokenStream=i,Kt}var Jt={},Mh;function Qd(){if(Mh)return Jt;Mh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Jt&&Jt.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=Jt&&Jt.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.ListTokenSource=void 0;const t=Za(),r=Z(),o=Be();let i=class{constructor(s,a){if(this.i=0,this._factory=t.CommonTokenFactory.DEFAULT,s==null)throw new Error("tokens cannot be null");this.tokens=s,this._sourceName=a}get charPositionInLine(){if(this.i<this.tokens.length)return this.tokens[this.i].charPositionInLine;if(this.eofToken!=null)return this.eofToken.charPositionInLine;if(this.tokens.length>0){let s=this.tokens[this.tokens.length-1],a=s.text;if(a!=null){let c=a.lastIndexOf(`
`);if(c>=0)return a.length-c-1}return s.charPositionInLine+s.stopIndex-s.startIndex+1}return 0}nextToken(){if(this.i>=this.tokens.length){if(this.eofToken==null){let a=-1;if(this.tokens.length>0){let u=this.tokens[this.tokens.length-1].stopIndex;u!==-1&&(a=u+1)}let c=Math.max(-1,a-1);this.eofToken=this._factory.create({source:this,stream:this.inputStream},o.Token.EOF,"EOF",o.Token.DEFAULT_CHANNEL,a,c,this.line,this.charPositionInLine)}return this.eofToken}let s=this.tokens[this.i];return this.i===this.tokens.length-1&&s.type===o.Token.EOF&&(this.eofToken=s),this.i++,s}get line(){if(this.i<this.tokens.length)return this.tokens[this.i].line;if(this.eofToken!=null)return this.eofToken.line;if(this.tokens.length>0){let s=this.tokens[this.tokens.length-1],a=s.line,c=s.text;if(c!=null)for(let u=0;u<c.length;u++)c.charAt(u)===`
`&&a++;return a}return 1}get inputStream(){if(this.i<this.tokens.length)return this.tokens[this.i].inputStream;if(this.eofToken!=null)return this.eofToken.inputStream;if(this.tokens.length>0)return this.tokens[this.tokens.length-1].inputStream}get sourceName(){if(this._sourceName)return this._sourceName;let s=this.inputStream;return s!=null?s.sourceName:"List"}set tokenFactory(s){this._factory=s}get tokenFactory(){return this._factory}};return l([r.Override],i.prototype,"charPositionInLine",null),l([r.Override],i.prototype,"nextToken",null),l([r.Override],i.prototype,"line",null),l([r.Override],i.prototype,"inputStream",null),l([r.Override],i.prototype,"sourceName",null),l([r.Override,r.NotNull,e(0,r.NotNull)],i.prototype,"tokenFactory",null),i=l([e(0,r.NotNull)],i),Jt.ListTokenSource=i,Jt}var bi={},kh;function sx(){if(kh)return bi;kh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(bi,"__esModule",{value:!0}),bi.MultiMap=void 0;let l=class extends Map{constructor(){super()}map(t,r){let o=super.get(t);o||(o=[],super.set(t,o)),o.push(r)}getPairs(){let t=[];return this.forEach((r,o)=>{r.forEach(i=>{t.push([o,i])})}),t}};return bi.MultiMap=l,bi}var Ri={},zh;function Jd(){if(zh)return Ri;zh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.ParseCancellationException=void 0;let l=class extends Error{constructor(t){super(t.message),this.cause=t,this.stack=t.stack}getCause(){return this.cause}};return Ri.ParseCancellationException=l,Ri}var Zt={},wn={},jh;function Zd(){if(jh)return wn;jh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=wn&&wn.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c};Object.defineProperty(wn,"__esModule",{value:!0}),wn.InterpreterRuleContext=void 0;const e=Z(),t=ut();let r=class extends t.ParserRuleContext{constructor(i,n,s){s!==void 0?super(n,s):super(),this._ruleIndex=i}get ruleIndex(){return this._ruleIndex}};return l([e.Override],r.prototype,"ruleIndex",null),wn.InterpreterRuleContext=r,wn}var qh;function ep(){if(qh)return Zt;qh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Zt&&Zt.__decorate||function(v,m,g,S){var C=arguments.length,A=C<3?m:S===null?S=Object.getOwnPropertyDescriptor(m,g):S,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(v,m,g,S);else for(var R=v.length-1;R>=0;R--)(b=v[R])&&(A=(C<3?b(A):C>3?b(m,g,A):b(m,g))||A);return C>3&&A&&Object.defineProperty(m,g,A),A},e=Zt&&Zt.__param||function(v,m){return function(g,S){m(g,S,v)}};Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.ParserInterpreter=void 0;const t=yr(),r=Ue(),o=Pr(),i=bo(),n=Ro(),s=Zd(),a=qd(),c=Z(),u=Z(),h=to(),f=Zi(),d=Nr(),p=rl(),y=Be();let x=class Da extends h.Parser{constructor(m,g,S,C,A){if(super(m instanceof Da?m.inputStream:A),this._parentContextStack=[],this.overrideDecision=-1,this.overrideDecisionInputIndex=-1,this.overrideDecisionAlt=-1,this.overrideDecisionReached=!1,this._overrideDecisionRoot=void 0,m instanceof Da){let b=m;this._grammarFileName=b._grammarFileName,this._atn=b._atn,this.pushRecursionContextStates=b.pushRecursionContextStates,this._ruleNames=b._ruleNames,this._vocabulary=b._vocabulary,this.interpreter=new f.ParserATNSimulator(this._atn,this)}else{g=g,S=S,C=C,this._grammarFileName=m,this._atn=C,this._ruleNames=S.slice(0),this._vocabulary=g,this.pushRecursionContextStates=new o.BitSet(C.states.length);for(let b of C.states)b instanceof p.StarLoopEntryState&&b.precedenceRuleDecision&&this.pushRecursionContextStates.set(b.stateNumber);this.interpreter=new f.ParserATNSimulator(C,this)}}reset(m){m===void 0?super.reset():super.reset(m),this.overrideDecisionReached=!1,this._overrideDecisionRoot=void 0}get atn(){return this._atn}get vocabulary(){return this._vocabulary}get ruleNames(){return this._ruleNames}get grammarFileName(){return this._grammarFileName}parse(m){let g=this._atn.ruleToStartState[m];for(this._rootContext=this.createInterpreterRuleContext(void 0,t.ATNState.INVALID_STATE_NUMBER,m),g.isPrecedenceRule?this.enterRecursionRule(this._rootContext,g.stateNumber,m,0):this.enterRule(this._rootContext,g.stateNumber,m);;){let S=this.atnState;switch(S.stateType){case r.ATNStateType.RULE_STOP:if(this._ctx.isEmpty)if(g.isPrecedenceRule){let C=this._ctx,A=this._parentContextStack.pop();return this.unrollRecursionContexts(A[0]),C}else return this.exitRule(),this._rootContext;this.visitRuleStopState(S);break;default:try{this.visitState(S)}catch(C){if(C instanceof d.RecognitionException)this.state=this._atn.ruleToStopState[S.ruleIndex].stateNumber,this.context.exception=C,this.errorHandler.reportError(this,C),this.recover(C);else throw C}break}}}enterRecursionRule(m,g,S,C){this._parentContextStack.push([this._ctx,m.invokingState]),super.enterRecursionRule(m,g,S,C)}get atnState(){return this._atn.states[this.state]}visitState(m){let g=1;m.numberOfTransitions>1&&(g=this.visitDecisionState(m));let S=m.transition(g-1);switch(S.serializationType){case 1:if(this.pushRecursionContextStates.get(m.stateNumber)&&!(S.target instanceof a.LoopEndState)){let P=this._parentContextStack[this._parentContextStack.length-1],M=this.createInterpreterRuleContext(P[0],P[1],this._ctx.ruleIndex);this.pushNewRecursionContext(M,this._atn.ruleToStartState[m.ruleIndex].stateNumber,this._ctx.ruleIndex)}break;case 5:this.match(S._label);break;case 2:case 7:case 8:S.matches(this._input.LA(1),y.Token.MIN_USER_TOKEN_TYPE,65535)||this.recoverInline(),this.matchWildcard();break;case 9:this.matchWildcard();break;case 3:let C=S.target,A=C.ruleIndex,b=this.createInterpreterRuleContext(this._ctx,m.stateNumber,A);C.isPrecedenceRule?this.enterRecursionRule(b,C.stateNumber,A,S.precedence):this.enterRule(b,S.target.stateNumber,A);break;case 4:let R=S;if(!this.sempred(this._ctx,R.ruleIndex,R.predIndex))throw new i.FailedPredicateException(this);break;case 6:let w=S;this.action(this._ctx,w.ruleIndex,w.actionIndex);break;case 10:if(!this.precpred(this._ctx,S.precedence)){let P=S.precedence;throw new i.FailedPredicateException(this,`precpred(_ctx, ${P})`)}break;default:throw new Error("UnsupportedOperationException: Unrecognized ATN transition type.")}this.state=S.target.stateNumber}visitDecisionState(m){let g;this.errorHandler.sync(this);let S=m.decision;return S===this.overrideDecision&&this._input.index===this.overrideDecisionInputIndex&&!this.overrideDecisionReached?(g=this.overrideDecisionAlt,this.overrideDecisionReached=!0):g=this.interpreter.adaptivePredict(this._input,S,this._ctx),g}createInterpreterRuleContext(m,g,S){return new s.InterpreterRuleContext(S,m,g)}visitRuleStopState(m){if(this._atn.ruleToStartState[m.ruleIndex].isPrecedenceRule){let C=this._parentContextStack.pop();this.unrollRecursionContexts(C[0]),this.state=C[1]}else this.exitRule();let S=this._atn.states[this.state].transition(0);this.state=S.followState.stateNumber}addDecisionOverride(m,g,S){this.overrideDecision=m,this.overrideDecisionInputIndex=g,this.overrideDecisionAlt=S}get overrideDecisionRoot(){return this._overrideDecisionRoot}recover(m){let g=this._input.index;if(this.errorHandler.recover(this,m),this._input.index===g){let S=m.getOffendingToken();if(!S)throw new Error("Expected exception to have an offending token");let C=S.tokenSource,A=C!==void 0?C.inputStream:void 0,b={source:C,stream:A};if(m instanceof n.InputMismatchException){let R=m.expectedTokens;if(R===void 0)throw new Error("Expected the exception to provide expected tokens");let w=y.Token.INVALID_TYPE;R.isNil||(w=R.minElement);let P=this.tokenFactory.create(b,w,S.text,y.Token.DEFAULT_CHANNEL,-1,-1,S.line,S.charPositionInLine);this._ctx.addErrorNode(this.createErrorNode(this._ctx,P))}else{S.tokenSource;let R=this.tokenFactory.create(b,y.Token.INVALID_TYPE,S.text,y.Token.DEFAULT_CHANNEL,-1,-1,S.line,S.charPositionInLine);this._ctx.addErrorNode(this.createErrorNode(this._ctx,R))}}}recoverInline(){return this._errHandler.recoverInline(this)}get rootContext(){return this._rootContext}};return l([c.NotNull],x.prototype,"_vocabulary",void 0),l([u.Override],x.prototype,"reset",null),l([u.Override],x.prototype,"atn",null),l([u.Override],x.prototype,"vocabulary",null),l([u.Override],x.prototype,"ruleNames",null),l([u.Override],x.prototype,"grammarFileName",null),l([u.Override],x.prototype,"enterRecursionRule",null),x=l([e(1,c.NotNull)],x),Zt.ParserInterpreter=x,Zt}var er={},Hh;function ax(){if(Hh)return er;Hh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=er&&er.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c},e=er&&er.__param||function(o,i){return function(n,s){i(n,s,o)}};Object.defineProperty(er,"__esModule",{value:!0}),er.ParseTreeMatch=void 0;const t=Z();let r=class{constructor(i,n,s,a){if(!i)throw new Error("tree cannot be null");if(!n)throw new Error("pattern cannot be null");if(!s)throw new Error("labels cannot be null");this._tree=i,this._pattern=n,this._labels=s,this._mismatchedNode=a}get(i){let n=this._labels.get(i);if(!(!n||n.length===0))return n[n.length-1]}getAll(i){const n=this._labels.get(i);return n||[]}get labels(){return this._labels}get mismatchedNode(){return this._mismatchedNode}get succeeded(){return!this._mismatchedNode}get pattern(){return this._pattern}get tree(){return this._tree}toString(){return`Match ${this.succeeded?"succeeded":"failed"}; found ${this.labels.size} labels`}};return l([t.NotNull,e(0,t.NotNull)],r.prototype,"getAll",null),l([t.NotNull],r.prototype,"labels",null),l([t.NotNull],r.prototype,"pattern",null),l([t.NotNull],r.prototype,"tree",null),l([t.Override],r.prototype,"toString",null),r=l([e(0,t.NotNull),e(1,t.NotNull),e(2,t.NotNull)],r),er.ParseTreeMatch=r,er}var tr={},wi={},Ni={},Uh;function lx(){if(Uh)return Ni;Uh=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.XPathLexer=void 0;const l=ll(),e=Ir(),t=Po(),r=Vn(),o=vr();let i=class Qe extends e.Lexer{constructor(s){super(s),this._interp=new t.LexerATNSimulator(Qe._ATN,this)}get vocabulary(){return Qe.VOCABULARY}get grammarFileName(){return"XPathLexer.g4"}get ruleNames(){return Qe.ruleNames}get serializedATN(){return Qe._serializedATN}get channelNames(){return Qe.channelNames}get modeNames(){return Qe.modeNames}action(s,a,c){switch(a){case 4:this.ID_action(s,c);break}}ID_action(s,a){switch(a){case 0:let c=this.text;c.charAt(0)===c.charAt(0).toUpperCase()?this.type=Qe.TOKEN_REF:this.type=Qe.RULE_REF;break}}static get _ATN(){return Qe.__ATN||(Qe.__ATN=new l.ATNDeserializer().deserialize(o.toCharArray(Qe._serializedATN))),Qe.__ATN}};return Ni.XPathLexer=i,i.TOKEN_REF=1,i.RULE_REF=2,i.ANYWHERE=3,i.ROOT=4,i.WILDCARD=5,i.BANG=6,i.ID=7,i.STRING=8,i.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"],i.modeNames=["DEFAULT_MODE"],i.ruleNames=["ANYWHERE","ROOT","WILDCARD","BANG","ID","NameChar","NameStartChar","STRING"],i._LITERAL_NAMES=[void 0,void 0,void 0,"'//'","'/'","'*'","'!'"],i._SYMBOLIC_NAMES=[void 0,"TOKEN_REF","RULE_REF","ANYWHERE","ROOT","WILDCARD","BANG","ID","STRING"],i.VOCABULARY=new r.VocabularyImpl(i._LITERAL_NAMES,i._SYMBOLIC_NAMES,[]),i._serializedATNSegments=2,i._serializedATNSegment0=`
2\b					\x07	\x07\b	\b			\x07
\f"\v\x07\x07\b\b		\x07	,
	\f		/\v			-
\x07\x07	\b\v	\r

2;C\\aac|\r(*<>?AOR_\uD801\uDA02\uDA38\uDA3D\uDA6E\uDA77\uDA77\uDA86\uDA86\uDA9D\uDAA1\uDAA3\uDAB1"C\\c|\r(*<>?AOR_`,i._serializedATNSegment1=`1\x07	\v\x07	\v\r%')\x071\x071\x071\x07,\b\x1B\x07#\x1B
 \b\r\x07"  !!#" #$\b$\f%&	&'(	()-\x07)*,\v+*,/-.-+.0/-01\x07)1 -`,i._serializedATN=o.join([i._serializedATNSegment0,i._serializedATNSegment1],""),Ni}var Nn={},$h;function ux(){if($h)return Nn;$h=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Nn&&Nn.__decorate||function(r,o,i,n){var s=arguments.length,a=s<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,i):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,o,i,n);else for(var u=r.length-1;u>=0;u--)(c=r[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.XPathLexerErrorListener=void 0;const e=Z();let t=class{syntaxError(o,i,n,s,a,c){}};return l([e.Override],t.prototype,"syntaxError",null),Nn.XPathLexerErrorListener=t,Nn}var On={},Fn={},Vh;function ui(){if(Vh)return Fn;Vh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Fn&&Fn.__decorate||function(r,o,i,n){var s=arguments.length,a=s<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,i):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,o,i,n);else for(var u=r.length-1;u>=0;u--)(c=r[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.XPathElement=void 0;const e=Z();let t=class{constructor(o){this.nodeName=o,this.invert=!1}toString(){let o=this.invert?"!":"";return Object.constructor.name+"["+o+this.nodeName+"]"}};return l([e.Override],t.prototype,"toString",null),Fn.XPathElement=t,Fn}var Wh;function cx(){if(Wh)return On;Wh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=On&&On.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(On,"__esModule",{value:!0}),On.XPathRuleAnywhereElement=void 0;const e=Z(),t=Gn(),r=ui();let o=class extends r.XPathElement{constructor(n,s){super(n),this.ruleIndex=s}evaluate(n){return t.Trees.findAllRuleNodes(n,this.ruleIndex)}};return l([e.Override],o.prototype,"evaluate",null),On.XPathRuleAnywhereElement=o,On}var Pn={},Gh;function hx(){if(Gh)return Pn;Gh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Pn&&Pn.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.XPathRuleElement=void 0;const e=ut(),t=Z(),r=Gn(),o=ui();let i=class extends o.XPathElement{constructor(s,a){super(s),this.ruleIndex=a}evaluate(s){let a=[];for(let c of r.Trees.getChildren(s))c instanceof e.ParserRuleContext&&(c.ruleIndex===this.ruleIndex&&!this.invert||c.ruleIndex!==this.ruleIndex&&this.invert)&&a.push(c);return a}};return l([t.Override],i.prototype,"evaluate",null),Pn.XPathRuleElement=i,Pn}var In={},Yh;function fx(){if(Yh)return In;Yh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=In&&In.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(In,"__esModule",{value:!0}),In.XPathTokenAnywhereElement=void 0;const e=Z(),t=Gn(),r=ui();let o=class extends r.XPathElement{constructor(n,s){super(n),this.tokenType=s}evaluate(n){return t.Trees.findAllTokenNodes(n,this.tokenType)}};return l([e.Override],o.prototype,"evaluate",null),In.XPathTokenAnywhereElement=o,In}var Dn={},Xh;function dx(){if(Xh)return Dn;Xh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Dn&&Dn.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.XPathTokenElement=void 0;const e=Z(),t=li(),r=Gn(),o=ui();let i=class extends o.XPathElement{constructor(s,a){super(s),this.tokenType=a}evaluate(s){let a=[];for(let c of r.Trees.getChildren(s))c instanceof t.TerminalNode&&(c.symbol.type===this.tokenType&&!this.invert||c.symbol.type!==this.tokenType&&this.invert)&&a.push(c);return a}};return l([e.Override],i.prototype,"evaluate",null),Dn.XPathTokenElement=i,Dn}var Ln={},Kh;function px(){if(Kh)return Ln;Kh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Ln&&Ln.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.XPathWildcardAnywhereElement=void 0;const e=Z(),t=Gn(),r=hl(),o=ui();let i=class extends o.XPathElement{constructor(){super(r.XPath.WILDCARD)}evaluate(s){return this.invert?[]:t.Trees.getDescendants(s)}};return l([e.Override],i.prototype,"evaluate",null),Ln.XPathWildcardAnywhereElement=i,Ln}var Bn={},Qh;function xx(){if(Qh)return Bn;Qh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Bn&&Bn.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.XPathWildcardElement=void 0;const e=Z(),t=Gn(),r=hl(),o=ui();let i=class extends o.XPathElement{constructor(){super(r.XPath.WILDCARD)}evaluate(s){let a=[];if(this.invert)return a;for(let c of t.Trees.getChildren(s))a.push(c);return a}};return l([e.Override],i.prototype,"evaluate",null),Bn.XPathWildcardElement=i,Bn}var Jh;function hl(){if(Jh)return wi;Jh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(wi,"__esModule",{value:!0}),wi.XPath=void 0;const l=ul(),e=cl(),t=Fo(),r=ut(),o=Be(),i=lx(),n=ux(),s=cx(),a=hx(),c=fx(),u=dx(),h=px(),f=xx();let d=class tp{constructor(y,x){this.parser=y,this.path=x,this.elements=this.split(x)}split(y){let x=new i.XPathLexer(l.CharStreams.fromString(y));x.recover=A=>{throw A},x.removeErrorListeners(),x.addErrorListener(new n.XPathLexerErrorListener);let v=new e.CommonTokenStream(x);try{v.fill()}catch(A){if(A instanceof t.LexerNoViableAltException){let R="Invalid tokens or characters at index "+x.charPositionInLine+" in path '"+y+"' -- "+A.message;throw new RangeError(R)}throw A}let m=v.getTokens(),g=[],S=m.length,C=0;e:for(;C<S;){let A=m[C],b;switch(A.type){case i.XPathLexer.ROOT:case i.XPathLexer.ANYWHERE:let R=A.type===i.XPathLexer.ANYWHERE;C++,b=m[C];let w=b.type===i.XPathLexer.BANG;w&&(C++,b=m[C]);let P=this.getXPathElement(b,R);P.invert=w,g.push(P),C++;break;case i.XPathLexer.TOKEN_REF:case i.XPathLexer.RULE_REF:case i.XPathLexer.WILDCARD:g.push(this.getXPathElement(A,!1)),C++;break;case o.Token.EOF:break e;default:throw new Error("Unknowth path element "+A)}}return g}getXPathElement(y,x){if(y.type===o.Token.EOF)throw new Error("Missing path element at end of path");let v=y.text;if(v==null)throw new Error("Expected wordToken to have text content.");let m=this.parser.getTokenType(v),g=this.parser.getRuleIndex(v);switch(y.type){case i.XPathLexer.WILDCARD:return x?new h.XPathWildcardAnywhereElement:new f.XPathWildcardElement;case i.XPathLexer.TOKEN_REF:case i.XPathLexer.STRING:if(m===o.Token.INVALID_TYPE)throw new Error(v+" at index "+y.startIndex+" isn't a valid token name");return x?new c.XPathTokenAnywhereElement(v,m):new u.XPathTokenElement(v,m);default:if(g===-1)throw new Error(v+" at index "+y.startIndex+" isn't a valid rule name");return x?new s.XPathRuleAnywhereElement(v,g):new a.XPathRuleElement(v,g)}}static findAll(y,x,v){return new tp(v,x).evaluate(y)}evaluate(y){let x=new r.ParserRuleContext;x.addChild(y);let v=new Set([x]),m=0;for(;m<this.elements.length;){let g=new Set;for(let S of v)S.childCount>0&&this.elements[m].evaluate(S).forEach(g.add,g);m++,v=g}return v}};return wi.XPath=d,d.WILDCARD="*",d.NOT="!",wi}var Zh;function mx(){if(Zh)return tr;Zh=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=tr&&tr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=tr&&tr.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(tr,"__esModule",{value:!0}),tr.ParseTreePattern=void 0;const t=Z(),r=hl();let o=class{constructor(n,s,a,c){this._matcher=n,this._patternRuleIndex=a,this._pattern=s,this._patternTree=c}match(n){return this._matcher.match(n,this)}matches(n){return this._matcher.match(n,this).succeeded}findAll(n,s){let a=r.XPath.findAll(n,s,this._matcher.parser),c=[];for(let u of a){let h=this.match(u);h.succeeded&&c.push(h)}return c}get matcher(){return this._matcher}get pattern(){return this._pattern}get patternRuleIndex(){return this._patternRuleIndex}get patternTree(){return this._patternTree}};return l([t.NotNull],o.prototype,"_pattern",void 0),l([t.NotNull],o.prototype,"_patternTree",void 0),l([t.NotNull],o.prototype,"_matcher",void 0),l([t.NotNull,e(0,t.NotNull)],o.prototype,"match",null),l([e(0,t.NotNull)],o.prototype,"matches",null),l([t.NotNull,e(0,t.NotNull),e(1,t.NotNull)],o.prototype,"findAll",null),l([t.NotNull],o.prototype,"matcher",null),l([t.NotNull],o.prototype,"pattern",null),l([t.NotNull],o.prototype,"patternTree",null),o=l([e(0,t.NotNull),e(1,t.NotNull),e(3,t.NotNull)],o),tr.ParseTreePattern=o,tr}var rr={},ef;function gx(){if(ef)return rr;ef=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=rr&&rr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=rr&&rr.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(rr,"__esModule",{value:!0}),rr.RuleTagToken=void 0;const t=Z(),r=Be();let o=class{constructor(n,s,a){if(n==null||n.length===0)throw new Error("ruleName cannot be null or empty.");this._ruleName=n,this.bypassTokenType=s,this._label=a}get ruleName(){return this._ruleName}get label(){return this._label}get channel(){return r.Token.DEFAULT_CHANNEL}get text(){return this._label!=null?"<"+this._label+":"+this._ruleName+">":"<"+this._ruleName+">"}get type(){return this.bypassTokenType}get line(){return 0}get charPositionInLine(){return-1}get tokenIndex(){return-1}get startIndex(){return-1}get stopIndex(){return-1}get tokenSource(){}get inputStream(){}toString(){return this._ruleName+":"+this.bypassTokenType}};return l([t.NotNull],o.prototype,"ruleName",null),l([t.Override],o.prototype,"channel",null),l([t.Override],o.prototype,"text",null),l([t.Override],o.prototype,"type",null),l([t.Override],o.prototype,"line",null),l([t.Override],o.prototype,"charPositionInLine",null),l([t.Override],o.prototype,"tokenIndex",null),l([t.Override],o.prototype,"startIndex",null),l([t.Override],o.prototype,"stopIndex",null),l([t.Override],o.prototype,"tokenSource",null),l([t.Override],o.prototype,"inputStream",null),l([t.Override],o.prototype,"toString",null),o=l([e(0,t.NotNull)],o),rr.RuleTagToken=o,rr}var Mn={},Oi={},tf;function rp(){if(tf)return Oi;tf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.Chunk=void 0;let l=class{};return Oi.Chunk=l,Oi}var rf;function yx(){if(rf)return Mn;rf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=Mn&&Mn.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c};Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.TagChunk=void 0;const e=rp(),t=Z();let r=class extends e.Chunk{constructor(i,n){if(super(),i==null||i.length===0)throw new Error("tag cannot be null or empty");this._tag=i,this._label=n}get tag(){return this._tag}get label(){return this._label}toString(){return this._label!=null?this._label+":"+this._tag:this._tag}};return l([t.NotNull],r.prototype,"tag",null),l([t.Override],r.prototype,"toString",null),Mn.TagChunk=r,Mn}var nr={},nf;function vx(){if(nf)return nr;nf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=nr&&nr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=nr&&nr.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(nr,"__esModule",{value:!0}),nr.TextChunk=void 0;const t=rp(),r=Z();let o=class extends t.Chunk{constructor(n){if(super(),n==null)throw new Error("text cannot be null");this._text=n}get text(){return this._text}toString(){return"'"+this._text+"'"}};return l([r.NotNull],o.prototype,"_text",void 0),l([r.NotNull],o.prototype,"text",null),l([r.Override],o.prototype,"toString",null),o=l([e(0,r.NotNull)],o),nr.TextChunk=o,nr}var ir={},of;function Sx(){if(of)return ir;of=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ir&&ir.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=ir&&ir.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(ir,"__esModule",{value:!0}),ir.TokenTagToken=void 0;const t=Xi(),r=Z();let o=class extends t.CommonToken{constructor(n,s,a){super(s),this._tokenName=n,this._label=a}get tokenName(){return this._tokenName}get label(){return this._label}get text(){return this._label!=null?"<"+this._label+":"+this._tokenName+">":"<"+this._tokenName+">"}toString(){return this._tokenName+":"+this.type}};return l([r.NotNull],o.prototype,"_tokenName",void 0),l([r.NotNull],o.prototype,"tokenName",null),l([r.Override],o.prototype,"text",null),l([r.Override],o.prototype,"toString",null),o=l([e(0,r.NotNull)],o),ir.TokenTagToken=o,ir}var sf;function Ax(){return sf||(sf=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=bn&&bn.__decorate||function(b,R,w,P){var M=arguments.length,D=M<3?R:P===null?P=Object.getOwnPropertyDescriptor(R,w):P,U;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(b,R,w,P);else for(var J=b.length-1;J>=0;J--)(U=b[J])&&(D=(M<3?U(D):M>3?U(R,w,D):U(R,w))||D);return M>3&&D&&Object.defineProperty(R,w,D),D},t=bn&&bn.__param||function(b,R){return function(w,P){R(w,P,b)}};Object.defineProperty(l,"__esModule",{value:!0}),l.ParseTreePatternMatcher=void 0;const r=np(),o=ul(),i=cl(),n=Qd(),s=sx(),a=Z(),c=Jd(),u=ep(),h=ut(),f=ax(),d=mx(),p=Nr(),y=al(),x=gx(),v=yx(),m=li(),g=vx(),S=Be(),C=Sx();let A=class La{constructor(R,w){this.start="<",this.stop=">",this.escape="\\",this.escapeRE=/\\/g,this._lexer=R,this._parser=w}setDelimiters(R,w,P){if(!R)throw new Error("start cannot be null or empty");if(!w)throw new Error("stop cannot be null or empty");this.start=R,this.stop=w,this.escape=P,this.escapeRE=new RegExp(P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g")}matches(R,w,P=0){if(typeof w=="string"){let M=this.compile(w,P);return this.matches(R,M)}else{let M=new s.MultiMap;return!this.matchImpl(R,w.patternTree,M)}}match(R,w,P=0){if(typeof w=="string"){let M=this.compile(w,P);return this.match(R,M)}else{let M=new s.MultiMap,D=this.matchImpl(R,w.patternTree,M);return new f.ParseTreeMatch(R,w,M,D)}}compile(R,w){let P=this.tokenize(R),M=new n.ListTokenSource(P),D=new i.CommonTokenStream(M);const U=this._parser;let J=new u.ParserInterpreter(U.grammarFileName,U.vocabulary,U.ruleNames,U.getATNWithBypassAlts(),D),te;try{J.errorHandler=new r.BailErrorStrategy,te=J.parse(w)}catch(le){throw le instanceof c.ParseCancellationException?le.getCause():le instanceof p.RecognitionException?le:le instanceof Error?new La.CannotInvokeStartRule(le):le}if(D.LA(1)!==S.Token.EOF)throw new La.StartRuleDoesNotConsumeFullPattern;return new d.ParseTreePattern(this,R,w,te)}get lexer(){return this._lexer}get parser(){return this._parser}matchImpl(R,w,P){if(!R)throw new TypeError("tree cannot be null");if(!w)throw new TypeError("patternTree cannot be null");if(R instanceof m.TerminalNode&&w instanceof m.TerminalNode){let M;if(R.symbol.type===w.symbol.type)if(w.symbol instanceof C.TokenTagToken){let D=w.symbol;P.map(D.tokenName,R);const U=D.label;U&&P.map(U,R)}else R.text===w.text||M||(M=R);else M||(M=R);return M}if(R instanceof h.ParserRuleContext&&w instanceof h.ParserRuleContext){let M,D=this.getRuleTagToken(w);if(D){if(R.ruleContext.ruleIndex===w.ruleContext.ruleIndex){P.map(D.ruleName,R);const J=D.label;J&&P.map(J,R)}else M||(M=R);return M}if(R.childCount!==w.childCount)return M||(M=R),M;let U=R.childCount;for(let J=0;J<U;J++){let te=this.matchImpl(R.getChild(J),w.getChild(J),P);if(te)return te}return M}return R}getRuleTagToken(R){if(R instanceof y.RuleNode&&R.childCount===1&&R.getChild(0)instanceof m.TerminalNode){let w=R.getChild(0);if(w.symbol instanceof x.RuleTagToken)return w.symbol}}tokenize(R){let w=this.split(R),P=[];for(let M of w)if(M instanceof v.TagChunk){let D=M;const U=D.tag.substr(0,1);if(U===U.toUpperCase()){let J=this._parser.getTokenType(D.tag);if(J===S.Token.INVALID_TYPE)throw new Error("Unknown token "+D.tag+" in pattern: "+R);let te=new C.TokenTagToken(D.tag,J,D.label);P.push(te)}else if(U===U.toLowerCase()){let J=this._parser.getRuleIndex(D.tag);if(J===-1)throw new Error("Unknown rule "+D.tag+" in pattern: "+R);let te=this._parser.getATNWithBypassAlts().ruleToTokenType[J];P.push(new x.RuleTagToken(D.tag,te,D.label))}else throw new Error("invalid tag: "+D.tag+" in pattern: "+R)}else{let D=M;this._lexer.inputStream=o.CharStreams.fromString(D.text);let U=this._lexer.nextToken();for(;U.type!==S.Token.EOF;)P.push(U),U=this._lexer.nextToken()}return P}split(R){let w=0,P=R.length,M=[],D=[],U=[];for(;w<P;)w===R.indexOf(this.escape+this.start,w)?w+=this.escape.length+this.start.length:w===R.indexOf(this.escape+this.stop,w)?w+=this.escape.length+this.stop.length:w===R.indexOf(this.start,w)?(D.push(w),w+=this.start.length):w===R.indexOf(this.stop,w)?(U.push(w),w+=this.stop.length):w++;if(D.length>U.length)throw new Error("unterminated tag in pattern: "+R);if(D.length<U.length)throw new Error("missing start tag in pattern: "+R);let J=D.length;for(let te=0;te<J;te++)if(D[te]>=U[te])throw new Error("tag delimiters out of order in pattern: "+R);if(J===0){let te=R.substring(0,P);M.push(new g.TextChunk(te))}if(J>0&&D[0]>0){let te=R.substring(0,D[0]);M.push(new g.TextChunk(te))}for(let te=0;te<J;te++){let le=R.substring(D[te]+this.start.length,U[te]),ge=le,ce,ee=le.indexOf(":");if(ee>=0&&(ce=le.substring(0,ee),ge=le.substring(ee+1,le.length)),M.push(new v.TagChunk(ge,ce)),te+1<J){let G=R.substring(U[te]+this.stop.length,D[te+1]);M.push(new g.TextChunk(G))}}if(J>0){let te=U[J-1]+this.stop.length;if(te<P){let le=R.substring(te,P);M.push(new g.TextChunk(le))}}for(let te=0;te<M.length;te++){let le=M[te];if(le instanceof g.TextChunk){let ge=le.text.replace(this.escapeRE,"");ge.length<le.text.length&&(M[te]=new g.TextChunk(ge))}}return M}};e([a.NotNull,t(1,a.NotNull)],A.prototype,"match",null),e([a.NotNull],A.prototype,"lexer",null),e([a.NotNull],A.prototype,"parser",null),e([t(0,a.NotNull),t(1,a.NotNull),t(2,a.NotNull)],A.prototype,"matchImpl",null),l.ParseTreePatternMatcher=A,function(b){class R extends Error{constructor(M){super(`CannotInvokeStartRule: ${M}`),this.error=M}}b.CannotInvokeStartRule=R;class w extends Error{constructor(){super("StartRuleDoesNotConsumeFullPattern")}}b.StartRuleDoesNotConsumeFullPattern=w}(A=l.ParseTreePatternMatcher||(l.ParseTreePatternMatcher={}))}(bn)),bn}var or={},sr={},ar={},af;function eo(){if(af)return ar;af=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ar&&ar.__decorate||function(o,i,n,s){var a=arguments.length,c=a<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,n):s,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,i,n,s);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(c=(a<3?u(c):a>3?u(i,n,c):u(i,n))||c);return a>3&&c&&Object.defineProperty(i,n,c),c},e=ar&&ar.__param||function(o,i){return function(n,s){i(n,s,o)}};Object.defineProperty(ar,"__esModule",{value:!0}),ar.DecisionEventInfo=void 0;const t=Z();let r=class{constructor(i,n,s,a,c,u){this.decision=i,this.fullCtx=u,this.stopIndex=c,this.input=s,this.startIndex=a,this.state=n}};return l([t.NotNull],r.prototype,"input",void 0),r=l([e(2,t.NotNull)],r),ar.DecisionEventInfo=r,ar}var lf;function Cx(){if(lf)return sr;lf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=sr&&sr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=sr&&sr.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(sr,"__esModule",{value:!0}),sr.AmbiguityInfo=void 0;const t=eo(),r=Z();let o=class extends t.DecisionEventInfo{constructor(n,s,a,c,u,h){super(n,s,c,u,h,s.useContext),this.ambigAlts=a}get ambiguousAlternatives(){return this.ambigAlts}};return l([r.NotNull],o.prototype,"ambigAlts",void 0),l([r.NotNull],o.prototype,"ambiguousAlternatives",null),o=l([e(1,r.NotNull),e(2,r.NotNull),e(3,r.NotNull)],o),sr.AmbiguityInfo=o,sr}var lr={},uf;function Ex(){if(uf)return lr;uf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=lr&&lr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=lr&&lr.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(lr,"__esModule",{value:!0}),lr.ContextSensitivityInfo=void 0;const t=eo(),r=Z();let o=class extends t.DecisionEventInfo{constructor(n,s,a,c,u){super(n,s,a,c,u,!0)}};return o=l([e(1,r.NotNull),e(2,r.NotNull)],o),lr.ContextSensitivityInfo=o,lr}var kn={},cf;function _x(){if(cf)return kn;cf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=kn&&kn.__decorate||function(r,o,i,n){var s=arguments.length,a=s<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,i):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,o,i,n);else for(var u=r.length-1;u>=0;u--)(c=r[u])&&(a=(s<3?c(a):s>3?c(o,i,a):c(o,i))||a);return s>3&&a&&Object.defineProperty(o,i,a),a};Object.defineProperty(kn,"__esModule",{value:!0}),kn.DecisionInfo=void 0;const e=Z();let t=class{constructor(o){this.invocations=0,this.timeInPrediction=0,this.SLL_TotalLook=0,this.SLL_MinLook=0,this.SLL_MaxLook=0,this.LL_TotalLook=0,this.LL_MinLook=0,this.LL_MaxLook=0,this.contextSensitivities=[],this.errors=[],this.ambiguities=[],this.predicateEvals=[],this.SLL_ATNTransitions=0,this.SLL_DFATransitions=0,this.LL_Fallback=0,this.LL_ATNTransitions=0,this.LL_DFATransitions=0,this.decision=o}toString(){return"{decision="+this.decision+", contextSensitivities="+this.contextSensitivities.length+", errors="+this.errors.length+", ambiguities="+this.ambiguities.length+", SLL_lookahead="+this.SLL_TotalLook+", SLL_ATNTransitions="+this.SLL_ATNTransitions+", SLL_DFATransitions="+this.SLL_DFATransitions+", LL_Fallback="+this.LL_Fallback+", LL_lookahead="+this.LL_TotalLook+", LL_ATNTransitions="+this.LL_ATNTransitions+"}"}};return l([e.Override],t.prototype,"toString",null),kn.DecisionInfo=t,kn}var ur={},hf;function Tx(){if(hf)return ur;hf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ur&&ur.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=ur&&ur.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(ur,"__esModule",{value:!0}),ur.ErrorInfo=void 0;const t=eo(),r=Z();let o=class extends t.DecisionEventInfo{constructor(n,s,a,c,u){super(n,s,a,c,u,s.useContext)}};return o=l([e(1,r.NotNull),e(2,r.NotNull)],o),ur.ErrorInfo=o,ur}var cr={},ff;function bx(){if(ff)return cr;ff=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=cr&&cr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=cr&&cr.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(cr,"__esModule",{value:!0}),cr.LookaheadEventInfo=void 0;const t=eo(),r=Z();let o=class extends t.DecisionEventInfo{constructor(n,s,a,c,u,h,f){super(n,s,c,u,h,f),this.predictedAlt=a}};return o=l([e(3,r.NotNull)],o),cr.LookaheadEventInfo=o,cr}var hr={},df;function Rx(){if(df)return hr;df=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=hr&&hr.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u},e=hr&&hr.__param||function(i,n){return function(s,a){n(s,a,i)}};Object.defineProperty(hr,"__esModule",{value:!0}),hr.PredicateEvalInfo=void 0;const t=eo(),r=Z();let o=class extends t.DecisionEventInfo{constructor(n,s,a,c,u,h,f,d){super(s,n,a,c,u,n.useContext),this.semctx=h,this.evalResult=f,this.predictedAlt=d}};return o=l([e(0,r.NotNull),e(2,r.NotNull),e(5,r.NotNull)],o),hr.PredicateEvalInfo=o,hr}var pf;function xf(){if(pf)return or;pf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=or&&or.__decorate||function(y,x,v,m){var g=arguments.length,S=g<3?x:m===null?m=Object.getOwnPropertyDescriptor(x,v):m,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(y,x,v,m);else for(var A=y.length-1;A>=0;A--)(C=y[A])&&(S=(g<3?C(S):g>3?C(x,v,S):C(x,v))||S);return g>3&&S&&Object.defineProperty(x,v,S),S},e=or&&or.__param||function(y,x){return function(v,m){x(v,m,y)}};Object.defineProperty(or,"__esModule",{value:!0}),or.ProfilingATNSimulator=void 0;const t=Cx(),r=ft(),o=Oo(),i=Ex(),n=_x(),s=Tx(),a=Z(),c=bx(),u=Zi(),h=Rx(),f=si(),d=Vd();let p=class extends u.ParserATNSimulator{constructor(x){super(x.interpreter.atn,x),this._startIndex=0,this._sllStopIndex=0,this._llStopIndex=0,this.currentDecision=0,this.conflictingAltResolvedBySLL=0,this.optimize_ll1=!1,this.reportAmbiguities=!0,this.numDecisions=this.atn.decisionToState.length,this.decisions=[];for(let v=0;v<this.numDecisions;v++)this.decisions.push(new n.DecisionInfo(v))}adaptivePredict(x,v,m,g){if(g!==void 0)return super.adaptivePredict(x,v,m,g);try{this._input=x,this._startIndex=x.index,this._sllStopIndex=this._startIndex-1,this._llStopIndex=-1,this.currentDecision=v,this.currentState=void 0,this.conflictingAltResolvedBySLL=r.ATN.INVALID_ALT_NUMBER;let S=process.hrtime(),C=super.adaptivePredict(x,v,m),A=process.hrtime(),b=(A[0]-S[0])*1e9;b===0?b=A[1]-S[1]:b+=1e9-S[1]+A[1],this.decisions[v].timeInPrediction+=b,this.decisions[v].invocations++;let R=this._sllStopIndex-this._startIndex+1;if(this.decisions[v].SLL_TotalLook+=R,this.decisions[v].SLL_MinLook=this.decisions[v].SLL_MinLook===0?R:Math.min(this.decisions[v].SLL_MinLook,R),R>this.decisions[v].SLL_MaxLook&&(this.decisions[v].SLL_MaxLook=R,this.decisions[v].SLL_MaxLookEvent=new c.LookaheadEventInfo(v,void 0,C,x,this._startIndex,this._sllStopIndex,!1)),this._llStopIndex>=0){let w=this._llStopIndex-this._startIndex+1;this.decisions[v].LL_TotalLook+=w,this.decisions[v].LL_MinLook=this.decisions[v].LL_MinLook===0?w:Math.min(this.decisions[v].LL_MinLook,w),w>this.decisions[v].LL_MaxLook&&(this.decisions[v].LL_MaxLook=w,this.decisions[v].LL_MaxLookEvent=new c.LookaheadEventInfo(v,void 0,C,x,this._startIndex,this._llStopIndex,!0))}return C}finally{this._input=void 0,this.currentDecision=-1}}getStartState(x,v,m,g){let S=super.getStartState(x,v,m,g);return this.currentState=S,S}computeStartState(x,v,m){let g=super.computeStartState(x,v,m);return this.currentState=g,g}computeReachSet(x,v,m,g){if(this._input===void 0)throw new Error("Invalid state");let S=super.computeReachSet(x,v,m,g);return S==null&&this.decisions[this.currentDecision].errors.push(new s.ErrorInfo(this.currentDecision,v,this._input,this._startIndex,this._input.index)),this.currentState=S,S}getExistingTargetState(x,v){if(this.currentState===void 0||this._input===void 0)throw new Error("Invalid state");this.currentState.useContext?this._llStopIndex=this._input.index:this._sllStopIndex=this._input.index;let m=super.getExistingTargetState(x,v);if(m!=null&&(this.currentState=new d.SimulatorState(this.currentState.outerContext,m,this.currentState.useContext,this.currentState.remainingOuterContext),this.currentState.useContext?this.decisions[this.currentDecision].LL_DFATransitions++:this.decisions[this.currentDecision].SLL_DFATransitions++,m===o.ATNSimulator.ERROR)){let g=new d.SimulatorState(this.currentState.outerContext,x,this.currentState.useContext,this.currentState.remainingOuterContext);this.decisions[this.currentDecision].errors.push(new s.ErrorInfo(this.currentDecision,g,this._input,this._startIndex,this._input.index))}return m}computeTargetState(x,v,m,g,S,C){let A=super.computeTargetState(x,v,m,g,S,C);return S?this.decisions[this.currentDecision].LL_ATNTransitions++:this.decisions[this.currentDecision].SLL_ATNTransitions++,A}evalSemanticContextImpl(x,v,m){if(this.currentState===void 0||this._input===void 0)throw new Error("Invalid state");let g=super.evalSemanticContextImpl(x,v,m);if(!(x instanceof f.SemanticContext.PrecedencePredicate)){let C=this._llStopIndex>=0?this._llStopIndex:this._sllStopIndex;this.decisions[this.currentDecision].predicateEvals.push(new h.PredicateEvalInfo(this.currentState,this.currentDecision,this._input,this._startIndex,C,x,g,m))}return g}reportContextSensitivity(x,v,m,g,S){if(this._input===void 0)throw new Error("Invalid state");v!==this.conflictingAltResolvedBySLL&&this.decisions[this.currentDecision].contextSensitivities.push(new i.ContextSensitivityInfo(this.currentDecision,m,this._input,g,S)),super.reportContextSensitivity(x,v,m,g,S)}reportAttemptingFullContext(x,v,m,g,S){v!=null?this.conflictingAltResolvedBySLL=v.nextSetBit(0):this.conflictingAltResolvedBySLL=m.s0.configs.getRepresentedAlternatives().nextSetBit(0),this.decisions[this.currentDecision].LL_Fallback++,super.reportAttemptingFullContext(x,v,m,g,S)}reportAmbiguity(x,v,m,g,S,C,A){if(this.currentState===void 0||this._input===void 0)throw new Error("Invalid state");let b;C!=null?b=C.nextSetBit(0):b=A.getRepresentedAlternatives().nextSetBit(0),this.conflictingAltResolvedBySLL!==r.ATN.INVALID_ALT_NUMBER&&b!==this.conflictingAltResolvedBySLL&&this.decisions[this.currentDecision].contextSensitivities.push(new i.ContextSensitivityInfo(this.currentDecision,this.currentState,this._input,m,g)),this.decisions[this.currentDecision].ambiguities.push(new t.AmbiguityInfo(this.currentDecision,this.currentState,C,this._input,m,g)),super.reportAmbiguity(x,v,m,g,S,C,A)}getDecisionInfo(){return this.decisions}getCurrentState(){return this.currentState}};return l([a.Override,e(0,a.NotNull)],p.prototype,"adaptivePredict",null),l([a.Override],p.prototype,"getStartState",null),l([a.Override],p.prototype,"computeStartState",null),l([a.Override],p.prototype,"computeReachSet",null),l([a.Override],p.prototype,"getExistingTargetState",null),l([a.Override],p.prototype,"computeTargetState",null),l([a.Override],p.prototype,"evalSemanticContextImpl",null),l([a.Override],p.prototype,"reportContextSensitivity",null),l([a.Override],p.prototype,"reportAttemptingFullContext",null),l([a.Override,e(0,a.NotNull),e(5,a.NotNull),e(6,a.NotNull)],p.prototype,"reportAmbiguity",null),or.ProfilingATNSimulator=p,or}var mf;function to(){if(mf)return ot;mf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=ot&&ot.__decorate||function(g,S,C,A){var b=arguments.length,R=b<3?S:A===null?A=Object.getOwnPropertyDescriptor(S,C):A,w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(g,S,C,A);else for(var P=g.length-1;P>=0;P--)(w=g[P])&&(R=(b<3?w(R):b>3?w(S,C,R):w(S,C))||R);return b>3&&R&&Object.defineProperty(S,C,R),R},e=ot&&ot.__param||function(g,S){return function(C,A){S(C,A,g)}},t=ot&&ot.__awaiter||function(g,S,C,A){function b(R){return R instanceof C?R:new C(function(w){w(R)})}return new(C||(C=Promise))(function(R,w){function P(U){try{D(A.next(U))}catch(J){w(J)}}function M(U){try{D(A.throw(U))}catch(J){w(J)}}function D(U){U.done?R(U.value):b(U.value).then(P,M)}D((A=A.apply(g,S||[])).next())})};Object.defineProperty(ot,"__esModule",{value:!0}),ot.Parser=void 0;const r=vr(),o=Id(),i=ll(),n=fl(),s=sl(),a=Ad(),c=Ir(),u=Z(),h=ix(),f=Zi(),d=Wd(),p=Qi(),y=li(),x=Be();class v{constructor(S,C){this.ruleNames=S,this.tokenStream=C}enterEveryRule(S){console.log("enter   "+this.ruleNames[S.ruleIndex]+", LT(1)="+this.tokenStream.LT(1).text)}exitEveryRule(S){console.log("exit    "+this.ruleNames[S.ruleIndex]+", LT(1)="+this.tokenStream.LT(1).text)}visitErrorNode(S){}visitTerminal(S){let C=S.parent.ruleContext,A=S.symbol;console.log("consume "+A+" rule "+this.ruleNames[C.ruleIndex])}}l([u.Override],v.prototype,"enterEveryRule",null),l([u.Override],v.prototype,"exitEveryRule",null),l([u.Override],v.prototype,"visitErrorNode",null),l([u.Override],v.prototype,"visitTerminal",null);let m=class go extends p.Recognizer{constructor(S){super(),this._errHandler=new n.DefaultErrorStrategy,this._precedenceStack=new a.IntegerStack,this._buildParseTrees=!0,this._parseListeners=[],this._syntaxErrors=0,this.matchedEOF=!1,this._precedenceStack.push(0),this.inputStream=S}reset(S){(S===void 0||S)&&this.inputStream.seek(0),this._errHandler.reset(this),this._ctx=void 0,this._syntaxErrors=0,this.matchedEOF=!1,this.isTrace=!1,this._precedenceStack.clear(),this._precedenceStack.push(0);let C=this.interpreter;C!=null&&C.reset()}match(S){let C=this.currentToken;return C.type===S?(S===x.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):(C=this._errHandler.recoverInline(this),this._buildParseTrees&&C.tokenIndex===-1&&this._ctx.addErrorNode(this.createErrorNode(this._ctx,C))),C}matchWildcard(){let S=this.currentToken;return S.type>0?(this._errHandler.reportMatch(this),this.consume()):(S=this._errHandler.recoverInline(this),this._buildParseTrees&&S.tokenIndex===-1&&this._ctx.addErrorNode(this.createErrorNode(this._ctx,S))),S}set buildParseTree(S){this._buildParseTrees=S}get buildParseTree(){return this._buildParseTrees}getParseListeners(){return this._parseListeners}addParseListener(S){if(S==null)throw new TypeError("listener cannot be null");this._parseListeners.push(S)}removeParseListener(S){let C=this._parseListeners.findIndex(A=>A===S);C!==-1&&this._parseListeners.splice(C,1)}removeParseListeners(){this._parseListeners.length=0}triggerEnterRuleEvent(){for(let S of this._parseListeners)S.enterEveryRule&&S.enterEveryRule(this._ctx),this._ctx.enterRule(S)}triggerExitRuleEvent(){for(let S=this._parseListeners.length-1;S>=0;S--){let C=this._parseListeners[S];this._ctx.exitRule(C),C.exitEveryRule&&C.exitEveryRule(this._ctx)}}get numberOfSyntaxErrors(){return this._syntaxErrors}get tokenFactory(){return this._input.tokenSource.tokenFactory}getATNWithBypassAlts(){let S=this.serializedATN;if(S==null)throw new Error("The current parser does not support an ATN with bypass alternatives.");let C=go.bypassAltsAtnCache.get(S);if(C==null){let A=new o.ATNDeserializationOptions;A.isGenerateRuleBypassTransitions=!0,C=new i.ATNDeserializer(A).deserialize(r.toCharArray(S)),go.bypassAltsAtnCache.set(S,C)}return C}compileParseTreePattern(S,C,A){return t(this,void 0,void 0,function*(){if(!A){if(this.inputStream){let P=this.inputStream.tokenSource;P instanceof c.Lexer&&(A=P)}if(!A)throw new Error("Parser can't discover a lexer to use")}let b=A,R=yield Promise.resolve().then(()=>Ax());return new R.ParseTreePatternMatcher(b,this).compile(S,C)})}get errorHandler(){return this._errHandler}set errorHandler(S){this._errHandler=S}get inputStream(){return this._input}set inputStream(S){this.reset(!1),this._input=S}get currentToken(){return this._input.LT(1)}notifyErrorListeners(S,C,A){C===void 0?C=this.currentToken:C===null&&(C=void 0),this._syntaxErrors++;let b=-1,R=-1;C!=null&&(b=C.line,R=C.charPositionInLine);let w=this.getErrorListenerDispatch();w.syntaxError&&w.syntaxError(this,C,b,R,S,A)}consume(){let S=this.currentToken;S.type!==go.EOF&&this.inputStream.consume();let C=this._parseListeners.length!==0;if(this._buildParseTrees||C)if(this._errHandler.inErrorRecoveryMode(this)){let A=this._ctx.addErrorNode(this.createErrorNode(this._ctx,S));if(C)for(let b of this._parseListeners)b.visitErrorNode&&b.visitErrorNode(A)}else{let A=this.createTerminalNode(this._ctx,S);if(this._ctx.addChild(A),C)for(let b of this._parseListeners)b.visitTerminal&&b.visitTerminal(A)}return S}createTerminalNode(S,C){return new y.TerminalNode(C)}createErrorNode(S,C){return new s.ErrorNode(C)}addContextToParseTree(){let S=this._ctx._parent;S!=null&&S.addChild(this._ctx)}enterRule(S,C,A){this.state=C,this._ctx=S,this._ctx._start=this._input.LT(1),this._buildParseTrees&&this.addContextToParseTree(),this.triggerEnterRuleEvent()}enterLeftFactoredRule(S,C,A){if(this.state=C,this._buildParseTrees){let b=this._ctx.getChild(this._ctx.childCount-1);this._ctx.removeLastChild(),b._parent=S,S.addChild(b)}this._ctx=S,this._ctx._start=this._input.LT(1),this._buildParseTrees&&this.addContextToParseTree(),this.triggerEnterRuleEvent()}exitRule(){this.matchedEOF?this._ctx._stop=this._input.LT(1):this._ctx._stop=this._input.tryLT(-1),this.triggerExitRuleEvent(),this.state=this._ctx.invokingState,this._ctx=this._ctx._parent}enterOuterAlt(S,C){if(S.altNumber=C,this._buildParseTrees&&this._ctx!==S){let A=this._ctx._parent;A!=null&&(A.removeLastChild(),A.addChild(S))}this._ctx=S}get precedence(){return this._precedenceStack.isEmpty?-1:this._precedenceStack.peek()}enterRecursionRule(S,C,A,b){this.state=C,this._precedenceStack.push(b),this._ctx=S,this._ctx._start=this._input.LT(1),this.triggerEnterRuleEvent()}pushNewRecursionContext(S,C,A){let b=this._ctx;b._parent=S,b.invokingState=C,b._stop=this._input.tryLT(-1),this._ctx=S,this._ctx._start=b._start,this._buildParseTrees&&this._ctx.addChild(b),this.triggerEnterRuleEvent()}unrollRecursionContexts(S){this._precedenceStack.pop(),this._ctx._stop=this._input.tryLT(-1);let C=this._ctx;if(this._parseListeners.length>0)for(;this._ctx!==S;)this.triggerExitRuleEvent(),this._ctx=this._ctx._parent;else this._ctx=S;C._parent=S,this._buildParseTrees&&S!=null&&S.addChild(C)}getInvokingContext(S){let C=this._ctx;for(;C&&C.ruleIndex!==S;)C=C._parent;return C}get context(){return this._ctx}set context(S){this._ctx=S}precpred(S,C){return C>=this._precedenceStack.peek()}getErrorListenerDispatch(){return new d.ProxyParserErrorListener(this.getErrorListeners())}inContext(S){return!1}isExpectedToken(S){let C=this.interpreter.atn,A=this._ctx,b=C.states[this.state],R=C.nextTokens(b);if(R.contains(S))return!0;if(!R.contains(x.Token.EPSILON))return!1;for(;A!=null&&A.invokingState>=0&&R.contains(x.Token.EPSILON);){let P=C.states[A.invokingState].transition(0);if(R=C.nextTokens(P.followState),R.contains(S))return!0;A=A._parent}return!!(R.contains(x.Token.EPSILON)&&S===x.Token.EOF)}get isMatchedEOF(){return this.matchedEOF}getExpectedTokens(){return this.atn.getExpectedTokens(this.state,this.context)}getExpectedTokensWithinCurrentRule(){let S=this.interpreter.atn,C=S.states[this.state];return S.nextTokens(C)}getRuleIndex(S){let C=this.getRuleIndexMap().get(S);return C??-1}get ruleContext(){return this._ctx}getRuleInvocationStack(S=this._ctx){let C=S,A=this.ruleNames,b=[];for(;C!=null;){let R=C.ruleIndex;R<0?b.push("n/a"):b.push(A[R]),C=C._parent}return b}getDFAStrings(){let S=[];for(let C of this._interp.atn.decisionToDFA)S.push(C.toString(this.vocabulary,this.ruleNames));return S}dumpDFA(){let S=!1;for(let C of this._interp.atn.decisionToDFA)C.isEmpty||(S&&console.log(),console.log("Decision "+C.decision+":"),process.stdout.write(C.toString(this.vocabulary,this.ruleNames)),S=!0)}get sourceName(){return this._input.sourceName}get parseInfo(){return Promise.resolve().then(()=>xf()).then(S=>{let C=this.interpreter;if(C instanceof S.ProfilingATNSimulator)return new h.ParseInfo(C)})}setProfile(S){return t(this,void 0,void 0,function*(){let C=yield Promise.resolve().then(()=>xf()),A=this.interpreter;S?A instanceof C.ProfilingATNSimulator||(this.interpreter=new C.ProfilingATNSimulator(this)):A instanceof C.ProfilingATNSimulator&&(this.interpreter=new f.ParserATNSimulator(this.atn,this)),this.interpreter.setPredictionMode(A.getPredictionMode())})}set isTrace(S){S?(this._tracer?this.removeParseListener(this._tracer):this._tracer=new v(this.ruleNames,this._input),this.addParseListener(this._tracer)):this._tracer&&(this.removeParseListener(this._tracer),this._tracer=void 0)}get isTrace(){return this._tracer!=null}};return m.bypassAltsAtnCache=new Map,l([u.NotNull],m.prototype,"_errHandler",void 0),l([u.NotNull],m.prototype,"match",null),l([u.NotNull],m.prototype,"matchWildcard",null),l([u.NotNull],m.prototype,"getParseListeners",null),l([e(0,u.NotNull)],m.prototype,"addParseListener",null),l([u.NotNull],m.prototype,"getATNWithBypassAlts",null),l([u.NotNull,e(0,u.NotNull)],m.prototype,"errorHandler",null),l([u.Override],m.prototype,"inputStream",null),l([u.NotNull],m.prototype,"currentToken",null),l([e(0,u.NotNull)],m.prototype,"enterRule",null),l([u.Override,e(0,u.Nullable)],m.prototype,"precpred",null),l([u.Override],m.prototype,"getErrorListenerDispatch",null),l([u.NotNull],m.prototype,"getExpectedTokens",null),l([u.NotNull],m.prototype,"getExpectedTokensWithinCurrentRule",null),l([u.Override],m.prototype,"parseInfo",null),ot.Parser=m,ot}var gf;function Do(){if(gf)return sn;gf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=sn&&sn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(sn,"__esModule",{value:!0}),sn.NoViableAltException=void 0;const e=to(),t=Nr(),r=Z();let o=class extends t.RecognitionException{constructor(n,s,a,c,u,h){n instanceof e.Parser&&(s===void 0&&(s=n.inputStream),a===void 0&&(a=n.currentToken),c===void 0&&(c=n.currentToken),h===void 0&&(h=n.context)),super(n,s,h),this._deadEndConfigs=u,this._startToken=a,this.setOffendingToken(n,c)}get startToken(){return this._startToken}get deadEndConfigs(){return this._deadEndConfigs}};return l([r.NotNull],o.prototype,"_startToken",void 0),sn.NoViableAltException=o,sn}var yf;function fl(){if(yf)return dt;yf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=dt&&dt.__decorate||function(f,d,p,y){var x=arguments.length,v=x<3?d:y===null?y=Object.getOwnPropertyDescriptor(d,p):y,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,d,p,y);else for(var g=f.length-1;g>=0;g--)(m=f[g])&&(v=(x<3?m(v):x>3?m(d,p,v):m(d,p))||v);return x>3&&v&&Object.defineProperty(d,p,v),v},e=dt&&dt.__param||function(f,d){return function(p,y){d(p,y,f)}};Object.defineProperty(dt,"__esModule",{value:!0}),dt.DefaultErrorStrategy=void 0;const t=yr(),r=Ue(),o=bo(),i=Ro(),n=Wn(),s=Do(),a=lt(),c=Be(),u=Z();let h=class{constructor(){this.errorRecoveryMode=!1,this.lastErrorIndex=-1,this.nextTokensState=t.ATNState.INVALID_STATE_NUMBER}reset(d){this.endErrorCondition(d)}beginErrorCondition(d){this.errorRecoveryMode=!0}inErrorRecoveryMode(d){return this.errorRecoveryMode}endErrorCondition(d){this.errorRecoveryMode=!1,this.lastErrorStates=void 0,this.lastErrorIndex=-1}reportMatch(d){this.endErrorCondition(d)}reportError(d,p){this.inErrorRecoveryMode(d)||(this.beginErrorCondition(d),p instanceof s.NoViableAltException?this.reportNoViableAlternative(d,p):p instanceof i.InputMismatchException?this.reportInputMismatch(d,p):p instanceof o.FailedPredicateException?this.reportFailedPredicate(d,p):(console.error(`unknown recognition error type: ${p}`),this.notifyErrorListeners(d,p.toString(),p)))}notifyErrorListeners(d,p,y){let x=y.getOffendingToken(d);x===void 0&&(x=null),d.notifyErrorListeners(p,x,y)}recover(d,p){this.lastErrorIndex===d.inputStream.index&&this.lastErrorStates&&this.lastErrorStates.contains(d.state)&&d.consume(),this.lastErrorIndex=d.inputStream.index,this.lastErrorStates||(this.lastErrorStates=new n.IntervalSet),this.lastErrorStates.add(d.state);let y=this.getErrorRecoverySet(d);this.consumeUntil(d,y)}sync(d){let p=d.interpreter.atn.states[d.state];if(this.inErrorRecoveryMode(d))return;let x=d.inputStream.LA(1),v=d.atn.nextTokens(p);if(v.contains(x)){this.nextTokensContext=void 0,this.nextTokensState=t.ATNState.INVALID_STATE_NUMBER;return}if(v.contains(c.Token.EPSILON)){this.nextTokensContext===void 0&&(this.nextTokensContext=d.context,this.nextTokensState=d.state);return}switch(p.stateType){case r.ATNStateType.BLOCK_START:case r.ATNStateType.STAR_BLOCK_START:case r.ATNStateType.PLUS_BLOCK_START:case r.ATNStateType.STAR_LOOP_ENTRY:if(this.singleTokenDeletion(d))return;throw new i.InputMismatchException(d);case r.ATNStateType.PLUS_LOOP_BACK:case r.ATNStateType.STAR_LOOP_BACK:this.reportUnwantedToken(d);let g=d.getExpectedTokens().or(this.getErrorRecoverySet(d));this.consumeUntil(d,g);break}}reportNoViableAlternative(d,p){let y=d.inputStream,x;y?p.startToken.type===c.Token.EOF?x="<EOF>":x=y.getTextFromRange(p.startToken,p.getOffendingToken()):x="<unknown input>";let v="no viable alternative at input "+this.escapeWSAndQuote(x);this.notifyErrorListeners(d,v,p)}reportInputMismatch(d,p){let y=p.expectedTokens,x=y?y.toStringVocabulary(d.vocabulary):"",v="mismatched input "+this.getTokenErrorDisplay(p.getOffendingToken(d))+" expecting "+x;this.notifyErrorListeners(d,v,p)}reportFailedPredicate(d,p){let x="rule "+d.ruleNames[d.context.ruleIndex]+" "+p.message;this.notifyErrorListeners(d,x,p)}reportUnwantedToken(d){if(this.inErrorRecoveryMode(d))return;this.beginErrorCondition(d);let p=d.currentToken,y=this.getTokenErrorDisplay(p),x=this.getExpectedTokens(d),v="extraneous input "+y+" expecting "+x.toStringVocabulary(d.vocabulary);d.notifyErrorListeners(v,p,void 0)}reportMissingToken(d){if(this.inErrorRecoveryMode(d))return;this.beginErrorCondition(d);let p=d.currentToken,x="missing "+this.getExpectedTokens(d).toStringVocabulary(d.vocabulary)+" at "+this.getTokenErrorDisplay(p);d.notifyErrorListeners(x,p,void 0)}recoverInline(d){let p=this.singleTokenDeletion(d);if(p)return d.consume(),p;if(this.singleTokenInsertion(d))return this.getMissingSymbol(d);throw this.nextTokensContext===void 0?new i.InputMismatchException(d):new i.InputMismatchException(d,this.nextTokensState,this.nextTokensContext)}singleTokenInsertion(d){let p=d.inputStream.LA(1),x=d.interpreter.atn.states[d.state].transition(0).target,v=d.interpreter.atn;return v.nextTokens(x,a.PredictionContext.fromRuleContext(v,d.context)).contains(p)?(this.reportMissingToken(d),!0):!1}singleTokenDeletion(d){let p=d.inputStream.LA(2);if(this.getExpectedTokens(d).contains(p)){this.reportUnwantedToken(d),d.consume();let x=d.currentToken;return this.reportMatch(d),x}}getMissingSymbol(d){let p=d.currentToken,y=this.getExpectedTokens(d),x=c.Token.INVALID_TYPE;y.isNil||(x=y.minElement);let v;x===c.Token.EOF?v="<missing EOF>":v="<missing "+d.vocabulary.getDisplayName(x)+">";let m=p,g=d.inputStream.tryLT(-1);return m.type===c.Token.EOF&&g!=null&&(m=g),this.constructToken(d.inputStream.tokenSource,x,v,m)}constructToken(d,p,y,x){let v=d.tokenFactory,m=x.tokenSource,g=m?m.inputStream:void 0;return v.create({source:d,stream:g},p,y,c.Token.DEFAULT_CHANNEL,-1,-1,x.line,x.charPositionInLine)}getExpectedTokens(d){return d.getExpectedTokens()}getTokenErrorDisplay(d){if(!d)return"<no token>";let p=this.getSymbolText(d);return p||(this.getSymbolType(d)===c.Token.EOF?p="<EOF>":p=`<${this.getSymbolType(d)}>`),this.escapeWSAndQuote(p)}getSymbolText(d){return d.text}getSymbolType(d){return d.type}escapeWSAndQuote(d){return d=d.replace(`
`,"\\n"),d=d.replace("\r","\\r"),d=d.replace("	","\\t"),"'"+d+"'"}getErrorRecoverySet(d){let p=d.interpreter.atn,y=d.context,x=new n.IntervalSet;for(;y&&y.invokingState>=0;){let m=p.states[y.invokingState].transition(0),g=p.nextTokens(m.followState);x.addAll(g),y=y._parent}return x.remove(c.Token.EPSILON),x}consumeUntil(d,p){let y=d.inputStream.LA(1);for(;y!==c.Token.EOF&&!p.contains(y);)d.consume(),y=d.inputStream.LA(1)}};return l([u.Override],h.prototype,"reset",null),l([e(0,u.NotNull)],h.prototype,"beginErrorCondition",null),l([u.Override],h.prototype,"inErrorRecoveryMode",null),l([e(0,u.NotNull)],h.prototype,"endErrorCondition",null),l([u.Override],h.prototype,"reportMatch",null),l([u.Override],h.prototype,"reportError",null),l([e(0,u.NotNull)],h.prototype,"notifyErrorListeners",null),l([u.Override],h.prototype,"recover",null),l([u.Override],h.prototype,"sync",null),l([e(0,u.NotNull),e(1,u.NotNull)],h.prototype,"reportNoViableAlternative",null),l([e(0,u.NotNull),e(1,u.NotNull)],h.prototype,"reportInputMismatch",null),l([e(0,u.NotNull),e(1,u.NotNull)],h.prototype,"reportFailedPredicate",null),l([e(0,u.NotNull)],h.prototype,"reportUnwantedToken",null),l([e(0,u.NotNull)],h.prototype,"reportMissingToken",null),l([u.Override],h.prototype,"recoverInline",null),l([e(0,u.NotNull)],h.prototype,"singleTokenInsertion",null),l([e(0,u.NotNull)],h.prototype,"singleTokenDeletion",null),l([u.NotNull,e(0,u.NotNull)],h.prototype,"getMissingSymbol",null),l([u.NotNull,e(0,u.NotNull)],h.prototype,"getExpectedTokens",null),l([e(0,u.NotNull)],h.prototype,"getSymbolText",null),l([e(0,u.NotNull)],h.prototype,"getSymbolType",null),l([u.NotNull,e(0,u.NotNull)],h.prototype,"escapeWSAndQuote",null),l([u.NotNull,e(0,u.NotNull)],h.prototype,"getErrorRecoverySet",null),l([e(0,u.NotNull),e(1,u.NotNull)],h.prototype,"consumeUntil",null),dt.DefaultErrorStrategy=h,dt}var vf;function np(){if(vf)return kr;vf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=kr&&kr.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h};Object.defineProperty(kr,"__esModule",{value:!0}),kr.BailErrorStrategy=void 0;const e=fl(),t=Ro(),r=Z(),o=Jd();let i=class extends e.DefaultErrorStrategy{recover(s,a){for(let c=s.context;c;c=c.parent)c.exception=a;throw new o.ParseCancellationException(a)}recoverInline(s){let a=new t.InputMismatchException(s);for(let c=s.context;c;c=c.parent)c.exception=a;throw new o.ParseCancellationException(a)}sync(s){}};return l([r.Override],i.prototype,"recover",null),l([r.Override],i.prototype,"recoverInline",null),l([r.Override],i.prototype,"sync",null),kr.BailErrorStrategy=i,kr}var pa={},Sf;function wx(){if(Sf)return pa;Sf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(pa,"__esModule",{value:!0}),pa}var xa={},Af;function Nx(){return Af||(Af=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(l,"__esModule",{value:!0}),l.Dependents=void 0,function(e){e[e.SELF=0]="SELF",e[e.PARENTS=1]="PARENTS",e[e.CHILDREN=2]="CHILDREN",e[e.ANCESTORS=3]="ANCESTORS",e[e.DESCENDANTS=4]="DESCENDANTS",e[e.SIBLINGS=5]="SIBLINGS",e[e.PRECEEDING_SIBLINGS=6]="PRECEEDING_SIBLINGS",e[e.FOLLOWING_SIBLINGS=7]="FOLLOWING_SIBLINGS",e[e.PRECEEDING=8]="PRECEEDING",e[e.FOLLOWING=9]="FOLLOWING"}(l.Dependents||(l.Dependents={}))}(xa)),xa}var fr={},Cf;function Ox(){if(Cf)return fr;Cf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=fr&&fr.__decorate||function(n,s,a,c){var u=arguments.length,h=u<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,a):c,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(n,s,a,c);else for(var d=n.length-1;d>=0;d--)(f=n[d])&&(h=(u<3?f(h):u>3?f(s,a,h):f(s,a))||h);return u>3&&h&&Object.defineProperty(s,a,h),h},e=fr&&fr.__param||function(n,s){return function(a,c){s(a,c,n)}};Object.defineProperty(fr,"__esModule",{value:!0}),fr.DiagnosticErrorListener=void 0;const t=Pr(),r=Z(),o=Ye();let i=class{constructor(s=!0){this.exactOnly=s,this.exactOnly=s}syntaxError(s,a,c,u,h,f){}reportAmbiguity(s,a,c,u,h,f,d){if(this.exactOnly&&!h)return;let p=this.getDecisionDescription(s,a),y=this.getConflictingAlts(f,d),x=s.inputStream.getText(o.Interval.of(c,u)),v=`reportAmbiguity d=${p}: ambigAlts=${y}, input='${x}'`;s.notifyErrorListeners(v)}reportAttemptingFullContext(s,a,c,u,h,f){let d=this.getDecisionDescription(s,a),p=s.inputStream.getText(o.Interval.of(c,u)),y=`reportAttemptingFullContext d=${d}, input='${p}'`;s.notifyErrorListeners(y)}reportContextSensitivity(s,a,c,u,h,f){let d=this.getDecisionDescription(s,a),p=s.inputStream.getText(o.Interval.of(c,u)),y=`reportContextSensitivity d=${d}, input='${p}'`;s.notifyErrorListeners(y)}getDecisionDescription(s,a){let c=a.decision,u=a.atnStartState.ruleIndex,h=s.ruleNames;if(u<0||u>=h.length)return c.toString();let f=h[u];return f?`${c} (${f})`:c.toString()}getConflictingAlts(s,a){if(s!=null)return s;let c=new t.BitSet;for(let u of a)c.set(u.alt);return c}};return l([r.Override],i.prototype,"syntaxError",null),l([r.Override,e(0,r.NotNull),e(1,r.NotNull),e(6,r.NotNull)],i.prototype,"reportAmbiguity",null),l([r.Override,e(0,r.NotNull),e(1,r.NotNull),e(5,r.NotNull)],i.prototype,"reportAttemptingFullContext",null),l([r.Override,e(0,r.NotNull),e(1,r.NotNull),e(5,r.NotNull)],i.prototype,"reportContextSensitivity",null),l([e(0,r.NotNull),e(1,r.NotNull)],i.prototype,"getDecisionDescription",null),l([r.NotNull,e(1,r.NotNull)],i.prototype,"getConflictingAlts",null),fr.DiagnosticErrorListener=i,fr}var dr={},Ef;function Fx(){if(Ef)return dr;Ef=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=dr&&dr.__decorate||function(s,a,c,u){var h=arguments.length,f=h<3?a:u===null?u=Object.getOwnPropertyDescriptor(a,c):u,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(s,a,c,u);else for(var p=s.length-1;p>=0;p--)(d=s[p])&&(f=(h<3?d(f):h>3?d(a,c,f):d(a,c))||f);return h>3&&f&&Object.defineProperty(a,c,f),f},e=dr&&dr.__param||function(s,a){return function(c,u){a(c,u,s)}};Object.defineProperty(dr,"__esModule",{value:!0}),dr.LexerInterpreter=void 0;const t=Ir(),r=Po(),o=Z(),i=Z();let n=class extends t.Lexer{constructor(a,c,u,h,f,d,p){if(super(p),d.grammarType!==0)throw new Error("IllegalArgumentException: The ATN must be a lexer ATN.");this._grammarFileName=a,this._atn=d,this._ruleNames=u.slice(0),this._channelNames=h.slice(0),this._modeNames=f.slice(0),this._vocabulary=c,this._interp=new r.LexerATNSimulator(d,this)}get atn(){return this._atn}get grammarFileName(){return this._grammarFileName}get ruleNames(){return this._ruleNames}get channelNames(){return this._channelNames}get modeNames(){return this._modeNames}get vocabulary(){return this._vocabulary}};return l([o.NotNull],n.prototype,"_vocabulary",void 0),l([i.Override],n.prototype,"atn",null),l([i.Override],n.prototype,"grammarFileName",null),l([i.Override],n.prototype,"ruleNames",null),l([i.Override],n.prototype,"channelNames",null),l([i.Override],n.prototype,"modeNames",null),l([i.Override],n.prototype,"vocabulary",null),n=l([e(1,o.NotNull)],n),dr.LexerInterpreter=n,dr}var ma={},_f;function Px(){if(_f)return ma;_f=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(ma,"__esModule",{value:!0}),ma}var zn={},Tf;function Ix(){if(Tf)return zn;Tf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=zn&&zn.__decorate||function(i,n,s,a){var c=arguments.length,u=c<3?n:a===null?a=Object.getOwnPropertyDescriptor(n,s):a,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(i,n,s,a);else for(var f=i.length-1;f>=0;f--)(h=i[f])&&(u=(c<3?h(u):c>3?h(n,s,u):h(n,s))||u);return c>3&&u&&Object.defineProperty(n,s,u),u};Object.defineProperty(zn,"__esModule",{value:!0}),zn.RuleContextWithAltNum=void 0;const e=ft(),t=Z(),r=ut();let o=class extends r.ParserRuleContext{constructor(n,s){s!==void 0?super(n,s):super(),this._altNumber=e.ATN.INVALID_ALT_NUMBER}get altNumber(){return this._altNumber}set altNumber(n){this._altNumber=n}};return l([t.Override],o.prototype,"altNumber",null),zn.RuleContextWithAltNum=o,zn}var Fi={},bf;function Dx(){if(bf)return Fi;bf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.RuleDependency=void 0;function l(e){return(t,r,o)=>{}}return Fi.RuleDependency=l,Fi}var Pi={},Rf;function Lx(){if(Rf)return Pi;Rf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.RuleVersion=void 0;function l(e){return(t,r,o)=>{}}return Pi.RuleVersion=l,Pi}var ga={},wf;function Bx(){if(wf)return ga;wf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(ga,"__esModule",{value:!0}),ga}var ya={},Nf;function Mx(){if(Nf)return ya;Nf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(ya,"__esModule",{value:!0}),ya}var va={},Of;function kx(){if(Of)return va;Of=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(va,"__esModule",{value:!0}),va}var pr={},Ff;function zx(){if(Ff)return pr;Ff=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var l=pr&&pr.__decorate||function(c,u,h,f){var d=arguments.length,p=d<3?u:f===null?f=Object.getOwnPropertyDescriptor(u,h):f,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(c,u,h,f);else for(var x=c.length-1;x>=0;x--)(y=c[x])&&(p=(d<3?y(p):d>3?y(u,h,p):y(u,h))||p);return d>3&&p&&Object.defineProperty(u,h,p),p};Object.defineProperty(pr,"__esModule",{value:!0}),pr.RewriteOperation=pr.TokenStreamRewriter=void 0;const e=Ye(),t=Z(),r=Be();let o=class rt{constructor(u){this.tokens=u,this.programs=new Map,this.programs.set(rt.DEFAULT_PROGRAM_NAME,[]),this.lastRewriteTokenIndexes=new Map}getTokenStream(){return this.tokens}rollback(u,h=rt.DEFAULT_PROGRAM_NAME){let f=this.programs.get(h);f!=null&&this.programs.set(h,f.slice(rt.MIN_TOKEN_INDEX,u))}deleteProgram(u=rt.DEFAULT_PROGRAM_NAME){this.rollback(rt.MIN_TOKEN_INDEX,u)}insertAfter(u,h,f=rt.DEFAULT_PROGRAM_NAME){let d;typeof u=="number"?d=u:d=u.tokenIndex;let p=this.getProgram(f),y=new s(this.tokens,d,p.length,h);p.push(y)}insertBefore(u,h,f=rt.DEFAULT_PROGRAM_NAME){let d;typeof u=="number"?d=u:d=u.tokenIndex;let p=this.getProgram(f),y=new n(this.tokens,d,p.length,h);p.push(y)}replaceSingle(u,h){typeof u=="number"?this.replace(u,u,h):this.replace(u,u,h)}replace(u,h,f,d=rt.DEFAULT_PROGRAM_NAME){if(typeof u!="number"&&(u=u.tokenIndex),typeof h!="number"&&(h=h.tokenIndex),u>h||u<0||h<0||h>=this.tokens.size)throw new RangeError(`replace: range invalid: ${u}..${h}(size=${this.tokens.size})`);let p=this.getProgram(d),y=new a(this.tokens,u,h,p.length,f);p.push(y)}delete(u,h,f=rt.DEFAULT_PROGRAM_NAME){h===void 0&&(h=u),typeof u=="number"?this.replace(u,h,"",f):this.replace(u,h,"",f)}getLastRewriteTokenIndex(u=rt.DEFAULT_PROGRAM_NAME){let h=this.lastRewriteTokenIndexes.get(u);return h??-1}setLastRewriteTokenIndex(u,h){this.lastRewriteTokenIndexes.set(u,h)}getProgram(u){let h=this.programs.get(u);return h==null&&(h=this.initializeProgram(u)),h}initializeProgram(u){let h=[];return this.programs.set(u,h),h}getText(u,h=rt.DEFAULT_PROGRAM_NAME){let f;u instanceof e.Interval?f=u:f=e.Interval.of(0,this.tokens.size-1),typeof u=="string"&&(h=u);let d=this.programs.get(h),p=f.a,y=f.b;if(y>this.tokens.size-1&&(y=this.tokens.size-1),p<0&&(p=0),d==null||d.length===0)return this.tokens.getText(f);let x=[],v=this.reduceToSingleOperationPerIndex(d),m=p;for(;m<=y&&m<this.tokens.size;){let g=v.get(m);v.delete(m);let S=this.tokens.get(m);g==null?(S.type!==r.Token.EOF&&x.push(String(S.text)),m++):m=g.execute(x)}if(y===this.tokens.size-1)for(let g of v.values())g.index>=this.tokens.size-1&&x.push(g.text.toString());return x.join("")}reduceToSingleOperationPerIndex(u){for(let f=0;f<u.length;f++){let d=u[f];if(d==null||!(d instanceof a))continue;let p=d,y=this.getKindOfOps(u,n,f);for(let v of y)v.index===p.index?(u[v.instructionIndex]=void 0,p.text=v.text.toString()+(p.text!=null?p.text.toString():"")):v.index>p.index&&v.index<=p.lastIndex&&(u[v.instructionIndex]=void 0);let x=this.getKindOfOps(u,a,f);for(let v of x){if(v.index>=p.index&&v.lastIndex<=p.lastIndex){u[v.instructionIndex]=void 0;continue}let m=v.lastIndex<p.index||v.index>p.lastIndex;if(v.text==null&&p.text==null&&!m)u[v.instructionIndex]=void 0,p.index=Math.min(v.index,p.index),p.lastIndex=Math.max(v.lastIndex,p.lastIndex);else if(!m)throw new Error(`replace op boundaries of ${p} overlap with previous ${v}`)}}for(let f=0;f<u.length;f++){let d=u[f];if(d==null||!(d instanceof n))continue;let p=d,y=this.getKindOfOps(u,n,f);for(let v of y)v.index===p.index&&(v instanceof s?(p.text=this.catOpText(v.text,p.text),u[v.instructionIndex]=void 0):v instanceof n&&(p.text=this.catOpText(p.text,v.text),u[v.instructionIndex]=void 0));let x=this.getKindOfOps(u,a,f);for(let v of x){if(p.index===v.index){v.text=this.catOpText(p.text,v.text),u[f]=void 0;continue}if(p.index>=v.index&&p.index<=v.lastIndex)throw new Error(`insert op ${p} within boundaries of previous ${v}`)}}let h=new Map;for(let f of u)if(f!=null){if(h.get(f.index)!=null)throw new Error("should only be one op per index");h.set(f.index,f)}return h}catOpText(u,h){let f="",d="";return u!=null&&(f=u.toString()),h!=null&&(d=h.toString()),f+d}getKindOfOps(u,h,f){let d=[];for(let p=0;p<f&&p<u.length;p++){let y=u[p];y!=null&&y instanceof h&&d.push(y)}return d}};pr.TokenStreamRewriter=o,o.DEFAULT_PROGRAM_NAME="default",o.PROGRAM_INIT_SIZE=100,o.MIN_TOKEN_INDEX=0;class i{constructor(u,h,f,d){this.tokens=u,this.instructionIndex=f,this.index=h,this.text=d===void 0?"":d}execute(u){return this.index}toString(){let u=this.constructor.name,h=u.indexOf("$");return u=u.substring(h+1,u.length),"<"+u+"@"+this.tokens.get(this.index)+':"'+this.text+'">'}}l([t.Override],i.prototype,"toString",null),pr.RewriteOperation=i;class n extends i{constructor(u,h,f,d){super(u,h,f,d)}execute(u){return u.push(this.text.toString()),this.tokens.get(this.index).type!==r.Token.EOF&&u.push(String(this.tokens.get(this.index).text)),this.index+1}}l([t.Override],n.prototype,"execute",null);class s extends n{constructor(u,h,f,d){super(u,h+1,f,d)}}class a extends i{constructor(u,h,f,d,p){super(u,h,d,p),this.lastIndex=f}execute(u){return this.text!=null&&u.push(this.text.toString()),this.lastIndex+1}toString(){return this.text==null?"<DeleteOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+">":"<ReplaceOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+':"'+this.text+'">'}}return l([t.Override],a.prototype,"execute",null),l([t.Override],a.prototype,"toString",null),pr}var Sa={},Pf;function jx(){if(Pf)return Sa;Pf=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Sa,"__esModule",{value:!0}),Sa}var Aa={},If;function qx(){if(If)return Aa;If=1;/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */return Object.defineProperty(Aa,"__esModule",{value:!0}),Aa}var Df;function Hx(){return Df||(Df=1,function(l){/*!
 * Copyright 2016 The ANTLR Project. All rights reserved.
 * Licensed under the BSD-3-Clause license. See LICENSE file in the project root for license information.
 */var e=Br&&Br.__createBinding||(Object.create?function(r,o,i,n){n===void 0&&(n=i),Object.defineProperty(r,n,{enumerable:!0,get:function(){return o[i]}})}:function(r,o,i,n){n===void 0&&(n=i),r[n]=o[i]}),t=Br&&Br.__exportStar||function(r,o){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&e(o,r,i)};Object.defineProperty(l,"__esModule",{value:!0}),t(zp(),l),t(jp(),l),t(N0(),l),t(np(),l),t(Kd(),l),t(wx(),l),t(ul(),l),t(Gd(),l),t(Xd(),l),t(Xi(),l),t(Za(),l),t(cl(),l),t(Td(),l),t(fl(),l),t(Nx(),l),t(Ox(),l),t(bo(),l),t(Ro(),l),t(Zd(),l),t(wr(),l),t(Ir(),l),t(Fx(),l),t(Fo(),l),t(Qd(),l),t(Do(),l),t(to(),l),t(Px(),l),t(ep(),l),t(ut(),l),t(tl(),l),t(Wd(),l),t(Nr(),l),t(Qi(),l),t($d(),l),t(Ix(),l),t(Dx(),l),t(Lx(),l),t(Be(),l),t(Bx(),l),t(Mx(),l),t(kx(),l),t(zx(),l),t(jx(),l),t(Vn(),l),t(qx(),l)}(Br)),Br}var Zn=Hx(),ip=ll(),Ux=Ir(),$x=Po(),op=Vn(),sp=vr();const Ae=class Ae extends Ux.Lexer{get vocabulary(){return Ae.VOCABULARY}constructor(e){super(e),this._interp=new $x.LexerATNSimulator(Ae._ATN,this)}get grammarFileName(){return"Formula.g4"}get ruleNames(){return Ae.ruleNames}get serializedATN(){return Ae._serializedATN}get channelNames(){return Ae.channelNames}get modeNames(){return Ae.modeNames}static get _ATN(){return Ae.__ATN||(Ae.__ATN=new ip.ATNDeserializer().deserialize(sp.toCharArray(Ae._serializedATN))),Ae.__ATN}};k(Ae,"T__0",1),k(Ae,"T__1",2),k(Ae,"T__2",3),k(Ae,"REFERENCE",4),k(Ae,"REF",5),k(Ae,"REFRANGE",6),k(Ae,"BOOL",7),k(Ae,"STRING",8),k(Ae,"NUM",9),k(Ae,"FUNCNAME",10),k(Ae,"WS",11),k(Ae,"MUL",12),k(Ae,"DIV",13),k(Ae,"ADD",14),k(Ae,"SUB",15),k(Ae,"EQ",16),k(Ae,"NEQ",17),k(Ae,"LTE",18),k(Ae,"GTE",19),k(Ae,"LT",20),k(Ae,"GT",21),k(Ae,"channelNames",["DEFAULT_TOKEN_CHANNEL","HIDDEN"]),k(Ae,"modeNames",["DEFAULT_MODE"]),k(Ae,"ruleNames",["T__0","T__1","T__2","REFERENCE","SHEET_NAME","QUOTED_SHEET_NAME","REF","REFRANGE","BOOL","STRING","NUM","FUNCNAME","WS","MUL","DIV","ADD","SUB","EQ","NEQ","LTE","GTE","LT","GT"]),k(Ae,"_LITERAL_NAMES",[void 0,"'('","')'","','",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"'*'","'/'","'+'","'-'","'='","'<>'","'<='","'>='","'<'","'>'"]),k(Ae,"_SYMBOLIC_NAMES",[void 0,void 0,void 0,void 0,"REFERENCE","REF","REFRANGE","BOOL","STRING","NUM","FUNCNAME","WS","MUL","DIV","ADD","SUB","EQ","NEQ","LTE","GTE","LT","GT"]),k(Ae,"VOCABULARY",new op.VocabularyImpl(Ae._LITERAL_NAMES,Ae._SYMBOLIC_NAMES,[])),k(Ae,"_serializedATN",`\b					\x07	\x07\b	\b			
	
\v	\v\f	\f\r	\r											J
\x07N
\fQ\v\x07\x07\x07U
\x07\r\x07\x07V\x07\x07\b\b\\
\b\b\b\b\`
\b\b\bc
\b\b\bf
\b\b\b\x07\bj
\b\f\b\bm\v\b				




















\v\v\x07\v
\v\f\v\v\v\v\v\v\f\f
\f\r\f\f\f\f\f
\f\r\f\f\f
\f\r\r\x07\r
\r\f\r\r\v\r
\r\x07	\v\r\x07\b	
\v\f\x1B\r!#%')+-/
C\\c|2;C\\c|))3;2;$$\x07002;C\\aac|\v\v""\x07	\x1B!#%')+-/13\x075	I\vK\rR[n\x1B!#%')+-/12\x07*234\x07+456\x07.6\b78\r\x0789\x07#9:	:J;<\r\x07<=\x07#=>\b>J?@\v@A\x07#AB	BJCD\vDE\x07#EF\bFJGJ	HJ\bI7I;I?ICIGIHJ
KO	LN	MLNQOMOPP\fQORT\x07)SU
TSUVVTVWWXXY\x07)YZ\\\x07&[Z[\\\\]]_	^\`	_^_\`\`bac	babccedf\x07&edeffggk	hj	ihjmkikllmkno\bop\x07<pq\bqrs\x07Vst\x07Ttu\x07Wu\x07Gvw\x07Hwx\x07Cxy\x07Nyz\x07Uz\x07G{|\x07v|}\x07t}~\x07w~\x07g\x07h\x07c\x07n\x07u\x07grv{\x07$
\x07\x07$	\x070			\b		\b\x07,\x071 \x07-"\x07/$\x07?&\x07>\x07@(\x07>\x07?*\x07@\x07?,\x07>.\x07@0IOV[_bek\b`),k(Ae,"__ATN");let ei=Ae;var Vx=ft(),Wx=bo(),Gx=Do(),Yx=to(),dl=ut(),Xx=Zi(),Ca=Nr(),Ea=Be();const se=class se extends Yx.Parser{get vocabulary(){return se.VOCABULARY}get grammarFileName(){return"Formula.g4"}get ruleNames(){return se.ruleNames}get serializedATN(){return se._serializedATN}createFailedPredicateException(e,t){return new Wx.FailedPredicateException(this,e,t)}constructor(e){super(e),this._interp=new Xx.ParserATNSimulator(se._ATN,this)}formula(){let e=new Kx(this._ctx,this.state);this.enterRule(e,0,se.RULE_formula);let t;try{this.enterOuterAlt(e,1);{this.state=7,this._errHandler.sync(this),t=this._input.LA(1);do this.state=6,this.expr(0),this.state=9,this._errHandler.sync(this),t=this._input.LA(1);while((t&-32)===0&&(1<<t&(1<<se.T__0|1<<se.REFERENCE|1<<se.BOOL|1<<se.STRING|1<<se.NUM|1<<se.FUNCNAME))!==0)}}catch(r){if(r instanceof Ca.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}expr(e){e===void 0&&(e=0);let t=this._ctx,r=this.state,o=new Me(this._ctx,r),i=o,n=2;this.enterRecursionRule(o,2,se.RULE_expr,e);let s;try{let a;this.enterOuterAlt(o,1);{switch(this.state=26,this._errHandler.sync(this),this._input.LA(1)){case se.FUNCNAME:o=new Qx(o),this._ctx=o,i=o,this.state=12,this.match(se.FUNCNAME),this.state=13,this.match(se.T__0),this.state=15,this._errHandler.sync(this),s=this._input.LA(1),(s&-32)===0&&(1<<s&(1<<se.T__0|1<<se.REFERENCE|1<<se.BOOL|1<<se.STRING|1<<se.NUM|1<<se.FUNCNAME))!==0&&(this.state=14,this.args()),this.state=17,this.match(se.T__1);break;case se.NUM:o=new tm(o),this._ctx=o,i=o,this.state=18,this.match(se.NUM);break;case se.BOOL:o=new rm(o),this._ctx=o,i=o,this.state=19,this.match(se.BOOL);break;case se.STRING:o=new nm(o),this._ctx=o,i=o,this.state=20,this.match(se.STRING);break;case se.REFERENCE:o=new im(o),this._ctx=o,i=o,this.state=21,this.match(se.REFERENCE);break;case se.T__0:o=new om(o),this._ctx=o,i=o,this.state=22,this.match(se.T__0),this.state=23,this.expr(0),this.state=24,this.match(se.T__1);break;default:throw new Gx.NoViableAltException(this)}for(this._ctx._stop=this._input.tryLT(-1),this.state=39,this._errHandler.sync(this),a=this.interpreter.adaptivePredict(this._input,4,this._ctx);a!==2&&a!==Vx.ATN.INVALID_ALT_NUMBER;){if(a===1)switch(this._parseListeners!=null&&this.triggerExitRuleEvent(),i=o,this.state=37,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,3,this._ctx)){case 1:{if(o=new Jx(new Me(t,r)),this.pushNewRecursionContext(o,n,se.RULE_expr),this.state=28,!this.precpred(this._ctx,8))throw this.createFailedPredicateException("this.precpred(this._ctx, 8)");this.state=29,o._op=this._input.LT(1),s=this._input.LA(1),s===se.MUL||s===se.DIV?(this._input.LA(1)===Ea.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):o._op=this._errHandler.recoverInline(this),this.state=30,this.expr(9)}break;case 2:{if(o=new Zx(new Me(t,r)),this.pushNewRecursionContext(o,n,se.RULE_expr),this.state=31,!this.precpred(this._ctx,7))throw this.createFailedPredicateException("this.precpred(this._ctx, 7)");this.state=32,o._op=this._input.LT(1),s=this._input.LA(1),s===se.ADD||s===se.SUB?(this._input.LA(1)===Ea.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):o._op=this._errHandler.recoverInline(this),this.state=33,this.expr(8)}break;case 3:{if(o=new em(new Me(t,r)),this.pushNewRecursionContext(o,n,se.RULE_expr),this.state=34,!this.precpred(this._ctx,6))throw this.createFailedPredicateException("this.precpred(this._ctx, 6)");this.state=35,o._op=this._input.LT(1),s=this._input.LA(1),(s&-32)===0&&(1<<s&(1<<se.EQ|1<<se.NEQ|1<<se.LTE|1<<se.GTE|1<<se.LT|1<<se.GT))!==0?(this._input.LA(1)===Ea.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):o._op=this._errHandler.recoverInline(this),this.state=36,this.expr(7)}break}this.state=41,this._errHandler.sync(this),a=this.interpreter.adaptivePredict(this._input,4,this._ctx)}}}catch(a){if(a instanceof Ca.RecognitionException)o.exception=a,this._errHandler.reportError(this,a),this._errHandler.recover(this,a);else throw a}finally{this.unrollRecursionContexts(t)}return o}args(){let e=new ap(this._ctx,this.state);this.enterRule(e,4,se.RULE_args);let t;try{for(this.enterOuterAlt(e,1),this.state=42,this.expr(0),this.state=47,this._errHandler.sync(this),t=this._input.LA(1);t===se.T__2;)this.state=43,this.match(se.T__2),this.state=44,this.expr(0),this.state=49,this._errHandler.sync(this),t=this._input.LA(1)}catch(r){if(r instanceof Ca.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}sempred(e,t,r){switch(t){case 1:return this.expr_sempred(e,r)}return!0}expr_sempred(e,t){switch(t){case 0:return this.precpred(this._ctx,8);case 1:return this.precpred(this._ctx,7);case 2:return this.precpred(this._ctx,6)}return!0}static get _ATN(){return se.__ATN||(se.__ATN=new ip.ATNDeserializer().deserialize(sp.toCharArray(se._serializedATN))),se.__ATN}};k(se,"T__0",1),k(se,"T__1",2),k(se,"T__2",3),k(se,"REFERENCE",4),k(se,"REF",5),k(se,"REFRANGE",6),k(se,"BOOL",7),k(se,"STRING",8),k(se,"NUM",9),k(se,"FUNCNAME",10),k(se,"WS",11),k(se,"MUL",12),k(se,"DIV",13),k(se,"ADD",14),k(se,"SUB",15),k(se,"EQ",16),k(se,"NEQ",17),k(se,"LTE",18),k(se,"GTE",19),k(se,"LT",20),k(se,"GT",21),k(se,"RULE_formula",0),k(se,"RULE_expr",1),k(se,"RULE_args",2),k(se,"ruleNames",["formula","expr","args"]),k(se,"_LITERAL_NAMES",[void 0,"'('","')'","','",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,"'*'","'/'","'+'","'-'","'='","'<>'","'<='","'>='","'<'","'>'"]),k(se,"_SYMBOLIC_NAMES",[void 0,void 0,void 0,void 0,"REFERENCE","REF","REFRANGE","BOOL","STRING","NUM","FUNCNAME","WS","MUL","DIV","ADD","SUB","EQ","NEQ","LTE","GTE","LT","GT"]),k(se,"VOCABULARY",new op.VocabularyImpl(se._LITERAL_NAMES,se._SYMBOLIC_NAMES,[])),k(se,"_serializedATN",`5			

\r\v

\x07(
\f+\v\x070
\f3\v<	,\b
	\b
\v\v	\v\f\f\r\b\x07\f\x07\x07\x07\v\x07	\x07
\x07\x07\x1B\x07\x1B\r)\f
 	 (\v!"\f	"#	#(
$%\f\b%&	&(	''!'$(+)')**+),1-.\x07.0/-031/122\x0731\b\v')1`),k(se,"__ATN");let Ie=se;class Kx extends dl.ParserRuleContext{expr(e){return e===void 0?this.getRuleContexts(Me):this.getRuleContext(e,Me)}constructor(e,t){super(e,t)}get ruleIndex(){return Ie.RULE_formula}enterRule(e){e.enterFormula&&e.enterFormula(this)}exitRule(e){e.exitFormula&&e.exitFormula(this)}accept(e){return e.visitFormula?e.visitFormula(this):e.visitChildren(this)}}class Me extends dl.ParserRuleContext{constructor(e,t){super(e,t)}get ruleIndex(){return Ie.RULE_expr}copyFrom(e){super.copyFrom(e)}}class Qx extends Me{FUNCNAME(){return this.getToken(Ie.FUNCNAME,0)}args(){return this.tryGetRuleContext(0,ap)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterFunction&&e.enterFunction(this)}exitRule(e){e.exitFunction&&e.exitFunction(this)}accept(e){return e.visitFunction?e.visitFunction(this):e.visitChildren(this)}}class Jx extends Me{constructor(t){super(t.parent,t.invokingState);k(this,"_op");this.copyFrom(t)}expr(t){return t===void 0?this.getRuleContexts(Me):this.getRuleContext(t,Me)}MUL(){return this.tryGetToken(Ie.MUL,0)}DIV(){return this.tryGetToken(Ie.DIV,0)}enterRule(t){t.enterMulDiv&&t.enterMulDiv(this)}exitRule(t){t.exitMulDiv&&t.exitMulDiv(this)}accept(t){return t.visitMulDiv?t.visitMulDiv(this):t.visitChildren(this)}}class Zx extends Me{constructor(t){super(t.parent,t.invokingState);k(this,"_op");this.copyFrom(t)}expr(t){return t===void 0?this.getRuleContexts(Me):this.getRuleContext(t,Me)}ADD(){return this.tryGetToken(Ie.ADD,0)}SUB(){return this.tryGetToken(Ie.SUB,0)}enterRule(t){t.enterAddSub&&t.enterAddSub(this)}exitRule(t){t.exitAddSub&&t.exitAddSub(this)}accept(t){return t.visitAddSub?t.visitAddSub(this):t.visitChildren(this)}}class em extends Me{constructor(t){super(t.parent,t.invokingState);k(this,"_op");this.copyFrom(t)}expr(t){return t===void 0?this.getRuleContexts(Me):this.getRuleContext(t,Me)}EQ(){return this.tryGetToken(Ie.EQ,0)}NEQ(){return this.tryGetToken(Ie.NEQ,0)}LT(){return this.tryGetToken(Ie.LT,0)}GT(){return this.tryGetToken(Ie.GT,0)}LTE(){return this.tryGetToken(Ie.LTE,0)}GTE(){return this.tryGetToken(Ie.GTE,0)}enterRule(t){t.enterComparison&&t.enterComparison(this)}exitRule(t){t.exitComparison&&t.exitComparison(this)}accept(t){return t.visitComparison?t.visitComparison(this):t.visitChildren(this)}}class tm extends Me{NUM(){return this.getToken(Ie.NUM,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterNumber&&e.enterNumber(this)}exitRule(e){e.exitNumber&&e.exitNumber(this)}accept(e){return e.visitNumber?e.visitNumber(this):e.visitChildren(this)}}class rm extends Me{BOOL(){return this.getToken(Ie.BOOL,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterBoolean&&e.enterBoolean(this)}exitRule(e){e.exitBoolean&&e.exitBoolean(this)}accept(e){return e.visitBoolean?e.visitBoolean(this):e.visitChildren(this)}}class nm extends Me{STRING(){return this.getToken(Ie.STRING,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterStr&&e.enterStr(this)}exitRule(e){e.exitStr&&e.exitStr(this)}accept(e){return e.visitStr?e.visitStr(this):e.visitChildren(this)}}class im extends Me{REFERENCE(){return this.getToken(Ie.REFERENCE,0)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterReference&&e.enterReference(this)}exitRule(e){e.exitReference&&e.exitReference(this)}accept(e){return e.visitReference?e.visitReference(this):e.visitChildren(this)}}class om extends Me{expr(){return this.getRuleContext(0,Me)}constructor(e){super(e.parent,e.invokingState),this.copyFrom(e)}enterRule(e){e.enterParentheses&&e.enterParentheses(this)}exitRule(e){e.exitParentheses&&e.exitParentheses(this)}accept(e){return e.visitParentheses?e.visitParentheses(this):e.visitChildren(this)}}class ap extends dl.ParserRuleContext{expr(e){return e===void 0?this.getRuleContexts(Me):this.getRuleContext(e,Me)}constructor(e,t){super(e,t)}get ruleIndex(){return Ie.RULE_args}enterRule(e){e.enterArgs&&e.enterArgs(this)}exitRule(e){e.exitArgs&&e.exitArgs(this)}accept(e){return e.visitArgs?e.visitArgs(this):e.visitChildren(this)}}function*Lf(l){const[e,t]=l;for(let r=e.r;r<=t.r;r++)for(let o=e.c;o<=t.c;o++)yield{r,c:o}}function xr(l,e){const[t,r]=e;return t.r<=l.r&&l.r<=r.r&&t.c<=l.c&&l.c<=r.c}function sm(l,e){const[t,r]=l,[o,i]=e;return o.r<=t.r&&r.r<=i.r&&o.c<=t.c&&r.c<=i.c}function qe(l,e){return[{r:Math.min(l.r,e.r),c:Math.min(l.c,e.c)},{r:Math.max(l.r,e.r),c:Math.max(l.c,e.c)}]}function st(l){return[Bf(l[0]),Bf(l[1])]}function Er(l,e){return Hi(l[0],e[0])&&Hi(l[1],e[1])}function am(l,e){const t=[];return l[0].r>e[0].r&&t.push([{r:l[0].r-1,c:l[0].c},{r:l[0].r-1,c:l[1].c}]),l[1].r<e[1].r&&t.push([{r:l[1].r+1,c:l[0].c},{r:l[1].r+1,c:l[1].c}]),l[0].c>e[0].c&&t.push([{r:l[0].r,c:l[0].c-1},{r:l[1].r,c:l[0].c-1}]),l[1].c<e[1].c&&t.push([{r:l[0].r,c:l[1].c+1},{r:l[1].r,c:l[1].c+1}]),t}function _a(l,e){const[t,r]=l,[o,i]=e;return[{r:Math.min(t.r,o.r),c:Math.min(t.c,o.c)},{r:Math.max(r.r,i.r),c:Math.max(r.c,i.c)}]}function Hi(l,e){return l.r===e.r&&l.c===e.c}function Bf(l){return{r:l.r,c:l.c}}function nt(l){return l.includes(":")}function Lo(l){return l.includes("!")}function lp(l){const e=l.indexOf("!");if(e===-1)throw new Error(`Not a cross-sheet reference: ${l}`);let t=l.substring(0,e);t.startsWith("'")&&t.endsWith("'")&&(t=t.slice(1,-1));const r=l.substring(e+1);return{sheetName:t,localRef:r}}function*Dr(l){for(const e of l){if(Lo(e)){const{sheetName:t,localRef:r}=lp(e);if(r.includes(":")){const o=Ba(r);for(const i of Lf(o))yield`${t}!${de(i)}`}else yield e;continue}if(nt(e)){const t=Ba(e);for(const r of Lf(t))yield de(r);continue}yield e}}function de(l){return ti(l.c)+l.r}function lm(l){const[e,t]=l;return`${de(e)}:${de(t)}`}function ti(l){let e="";for(;l>0;){const t=l%26;t===0?(e="Z"+e,l=Math.floor(l/26)-1):(e=String.fromCharCode(t+64)+e,l=Math.floor(l/26))}return e}function Te(l){const e=l.replace(/\$/g,"");let t=0;for(let i=0;i<e.length;i++){const n=e.charCodeAt(i);if(48<=n&&n<=57){t=i;break}}if(t===0)throw new Error("Invalid Reference");const r=parseInt(e.substring(t)),o=e.substring(0,t).split("").reverse().reduce((i,n,s)=>i+Math.pow(26,s)*(n.charCodeAt(0)-65+1),0);if(isNaN(r)||isNaN(o))throw new Error("Invalid Reference");return{r,c:o}}function Ba(l){const[e,t]=l.split(":");return[Te(e),Te(t)]}class ro{constructor(){k(this,"ref");k(this,"bool");k(this,"num");k(this,"str")}static create(){return new ro}setRef(e){return this.ref=e,this}setBool(e){return this.bool=e,this}setNum(e){return this.num=e,this}setStr(e){return this.str=e,this}map(e,t){return e.t==="bool"&&this.bool?this.bool(e):e.t==="num"&&this.num?this.num(e):e.t==="str"&&this.str?this.str(e):e.t==="ref"&&this.ref&&t?this.ref(e,t):e}*iterate(e,t,r){for(const o of e.expr()){const i=t(o);if(i.t==="ref"&&r)for(const n of Dr([i.v]))yield this.ref({t:"ref",v:n},r);else yield this.map(i)}}}function um(l){return{t:"num",v:l.v?1:0}}function cm(l){const e=Number(l);return{t:"num",v:isNaN(e)?0:e}}function hm(l,e){var o;if(nt(l.v))return{t:"err",v:"#VALUE!"};const t=((o=e.get(l.v))==null?void 0:o.v)||"",r=Number(t);return{t:"num",v:isNaN(r)?0:r}}const De=ro.create().setRef(hm).setBool(um).setStr(cm);function fm(l){return{t:"bool",v:l.v!==0}}function dm(l,e){var o;if(nt(l.v))return{t:"err",v:"#VALUE!"};const t=((o=e.get(l.v))==null?void 0:o.v)||"";if(t==="TRUE"||t==="true")return{t:"bool",v:!0};if(t==="FALSE"||t==="false"||t==="")return{t:"bool",v:!1};const r=Number(t);return isNaN(r)?{t:"err",v:"#VALUE!"}:{t:"bool",v:r!==0}}const ci=ro.create().setRef(dm).setNum(fm).setStr(()=>({t:"err",v:"#VALUE!"}));function pm(l){return{t:"str",v:l.v.toString()}}function xm(l){return{t:"str",v:l.v?"TRUE":"FALSE"}}function up(l,e){var r;return nt(l.v)?{t:"err",v:"#VALUE!"}:{t:"str",v:((r=e.get(l.v))==null?void 0:r.v)||""}}ro.create().setRef(up).setNum(pm).setBool(xm);const Mf=new Map([["SUM",mm],["ABS",gm],["ROUND",vm],["ROUNDUP",Sm],["ROUNDDOWN",Am],["INT",Cm],["MOD",Em],["SQRT",_m],["POWER",Tm],["PRODUCT",bm],["MEDIAN",Rm],["IF",wm],["IFS",Nm],["SWITCH",Om],["AND",Fm],["OR",Pm],["NOT",Im],["AVERAGE",Dm],["MIN",Lm],["MAX",Bm],["COUNT",Mm],["COUNTA",km],["COUNTBLANK",zm],["COUNTIF",jm],["SUMIF",qm],["COUNTIFS",Hm],["SUMIFS",Um],["TRIM",$m],["LEN",Vm],["LEFT",Wm],["RIGHT",Gm],["MID",Ym],["CONCATENATE",hp],["CONCAT",Xm],["FIND",Km],["SEARCH",Qm],["TEXTJOIN",Jm],["LOWER",Zm],["UPPER",eg],["PROPER",tg],["SUBSTITUTE",rg],["TODAY",ng],["NOW",ig],["YEAR",og],["MONTH",sg],["DAY",ag],["ISBLANK",lg],["ISNUMBER",ug],["ISTEXT",cg],["IFERROR",hg]]);function mm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};let o=0;for(const i of De.iterate(r,e,t)){if(i.t==="err")return i;o+=i.v}return{t:"num",v:o}}function gm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=De.map(e(o[0]),t);return i.t==="err"?i:{t:"num",v:Math.abs(i.v)}}function ym(l){return l>=0?Math.floor(l+.5):Math.ceil(l-.5)}function pl(l,e,t){if(!l)return{t:"num",v:0};const r=De.map(e(l),t);return r.t==="err"?r:{t:"num",v:Math.trunc(r.v)}}function Bo(l){return l.t==="err"}function ri(l,e,t){const r=e(l);return r.t==="err"?r:r.t!=="ref"||!t?{t:"err",v:"#VALUE!"}:{t:"refs",v:Array.from(Dr([r.v]))}}function cp(l){const e=Number(l);return isNaN(e)?0:e}function Mo(l,e){if(l.t==="err")return l;if(l.t==="num")return{op:"=",value:l.v.toString(),numericValue:l.v};if(l.t==="bool")return{op:"=",value:l.v?"TRUE":"FALSE",boolValue:l.v};const t=ke(l,e);if(t.t==="err")return t;const r=/^(<=|>=|<>|=|<|>)(.*)$/.exec(t.v),o=(r==null?void 0:r[1])||"=",i=r?r[2]:t.v;let n,s;if(i!==""){const c=Number(i);isNaN(c)?i.toUpperCase()==="TRUE"?s=!0:i.toUpperCase()==="FALSE"&&(s=!1):n=c}let a;return(o==="="||o==="<>")&&/(^|[^~])[*?]/.test(i)&&(a=new RegExp(`^${dp(i)}$`,"i")),{op:o,value:i,numericValue:n,boolValue:s,wildcardPattern:a}}function ko(l,e){const t=l===""?void 0:Number(l),r=t!==void 0&&!isNaN(t),o=l.toUpperCase(),i=o==="TRUE"?!0:o==="FALSE"?!1:void 0,n=l.toLowerCase(),s=e.value.toLowerCase();if(e.op==="<"||e.op==="<="||e.op===">"||e.op===">=")return e.numericValue!==void 0?r?e.op==="<"?t<e.numericValue:e.op==="<="?t<=e.numericValue:e.op===">"?t>e.numericValue:t>=e.numericValue:!1:e.op==="<"?n<s:e.op==="<="?n<=s:e.op===">"?n>s:n>=s;let a=!1;return e.wildcardPattern?a=e.wildcardPattern.test(l):e.numericValue!==void 0&&r?a=t===e.numericValue:e.boolValue!==void 0&&i!==void 0?a=i===e.boolValue:a=n===s,e.op==="="?a:!a}function vm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=De.map(e(o[0]),t);if(i.t==="err")return i;const n=pl(o[1],e,t);if(n.t==="err")return n;const s=10**n.v;return{t:"num",v:ym(i.v*s)/s}}function Sm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=De.map(e(o[0]),t);if(i.t==="err")return i;const n=pl(o[1],e,t);if(n.t==="err")return n;const s=10**n.v,a=i.v*s;return{t:"num",v:(a>=0?Math.ceil(a):Math.floor(a))/s}}function Am(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=De.map(e(o[0]),t);if(i.t==="err")return i;const n=pl(o[1],e,t);if(n.t==="err")return n;const s=10**n.v,a=i.v*s;return{t:"num",v:(a>=0?Math.floor(a):Math.ceil(a))/s}}function Cm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=De.map(e(o[0]),t);return i.t==="err"?i:{t:"num",v:Math.floor(i.v)}}function Em(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=De.map(e(o[0]),t);if(i.t==="err")return i;const n=De.map(e(o[1]),t);return n.t==="err"?n:n.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:i.v-n.v*Math.floor(i.v/n.v)}}function _m(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=De.map(e(o[0]),t);return i.t==="err"?i:i.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.sqrt(i.v)}}function Tm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=De.map(e(o[0]),t);if(i.t==="err")return i;const n=De.map(e(o[1]),t);if(n.t==="err")return n;const s=Math.pow(i.v,n.v);return isFinite(s)?{t:"num",v:s}:{t:"err",v:"#VALUE!"}}function bm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};let o=1;for(const i of De.iterate(r,e,t)){if(i.t==="err")return i;o*=i.v}return{t:"num",v:o}}function Rm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=[];for(const n of De.iterate(r,e,t)){if(n.t==="err")return n;o.push(n.v)}if(o.length===0)return{t:"err",v:"#VALUE!"};o.sort((n,s)=>n-s);const i=Math.floor(o.length/2);return o.length%2===1?{t:"num",v:o[i]}:{t:"num",v:(o[i-1]+o[i])/2}}function wm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<2||o.length>3)return{t:"err",v:"#N/A!"};const i=ci.map(e(o[0]),t);return i.t==="err"?i:i.v?e(o[1]):o.length===3?e(o[2]):{t:"bool",v:!1}}function Nm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<2||o.length%2!==0)return{t:"err",v:"#N/A!"};for(let i=0;i<o.length;i+=2){const n=ci.map(e(o[i]),t);if(n.t==="err")return n;if(n.v)return e(o[i+1])}return{t:"err",v:"#N/A!"}}function Om(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<3)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);if(i.t==="err")return i;const n=o.length-1,s=n%2===1,a=s?(n-1)/2:n/2;for(let c=0;c<a;c++){const u=ke(e(o[1+c*2]),t);if(u.t==="err")return u;if(u.v===i.v)return e(o[2+c*2])}return s?e(o[o.length-1]):{t:"err",v:"#N/A!"}}function Fm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};for(const o of ci.iterate(r,e,t)){if(o.t==="err")return o;if(!o.v)return{t:"bool",v:!1}}return{t:"bool",v:!0}}function Pm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};for(const o of ci.iterate(r,e,t)){if(o.t==="err")return o;if(o.v)return{t:"bool",v:!0}}return{t:"bool",v:!1}}function Im(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=ci.map(e(o[0]),t);return i.t==="err"?i:{t:"bool",v:!i.v}}function Dm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};let o=0,i=0;for(const n of De.iterate(r,e,t)){if(n.t==="err")return n;o+=n.v,i++}return i===0?{t:"err",v:"#VALUE!"}:{t:"num",v:o/i}}function Lm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};let o=1/0;for(const i of De.iterate(r,e,t)){if(i.t==="err")return i;i.v<o&&(o=i.v)}return{t:"num",v:o}}function Bm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};let o=-1/0;for(const i of De.iterate(r,e,t)){if(i.t==="err")return i;i.v>o&&(o=i.v)}return{t:"num",v:o}}function Mm(l,e,t){var i,n;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};let o=0;for(const s of r.expr()){const a=e(s);if(a.t==="num")o++;else if(a.t==="bool")o++;else if(a.t==="ref"&&t)if(nt(a.v))for(const c of Dr([a.v])){const u=((i=t.get(c))==null?void 0:i.v)||"";u!==""&&!isNaN(Number(u))&&o++}else{const c=((n=t.get(a.v))==null?void 0:n.v)||"";c!==""&&!isNaN(Number(c))&&o++}}return{t:"num",v:o}}function km(l,e,t){var i,n;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};let o=0;for(const s of r.expr()){const a=e(s);if(a.t==="num"||a.t==="bool")o++;else if(a.t==="str")a.v!==""&&o++;else if(a.t==="ref"&&t)if(nt(a.v))for(const c of Dr([a.v]))(((i=t.get(c))==null?void 0:i.v)||"")!==""&&o++;else(((n=t.get(a.v))==null?void 0:n.v)||"")!==""&&o++}return{t:"num",v:o}}function zm(l,e,t){var i,n;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};let o=0;for(const s of r.expr()){const a=e(s);if(a.t==="str"){a.v===""&&o++;continue}if(a.t!=="ref"||!t)continue;if(nt(a.v)){for(const u of Dr([a.v]))(((i=t.get(u))==null?void 0:i.v)||"")===""&&o++;continue}(((n=t.get(a.v))==null?void 0:n.v)||"")===""&&o++}return{t:"num",v:o}}function jm(l,e,t){var a;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=ri(o[0],e,t);if(i.t==="err")return i;const n=Mo(e(o[1]),t);if(Bo(n))return n;let s=0;for(const c of i.v){const u=((a=t==null?void 0:t.get(c))==null?void 0:a.v)||"";ko(u,n)&&s++}return{t:"num",v:s}}function qm(l,e,t){var c,u;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<2||o.length>3)return{t:"err",v:"#N/A!"};const i=ri(o[0],e,t);if(i.t==="err")return i;const n=Mo(e(o[1]),t);if(Bo(n))return n;const s=o.length===3?ri(o[2],e,t):i;if(s.t==="err")return s;if(i.v.length!==s.v.length)return{t:"err",v:"#VALUE!"};let a=0;for(let h=0;h<i.v.length;h++){const f=((c=t==null?void 0:t.get(i.v[h]))==null?void 0:c.v)||"";if(!ko(f,n))continue;const d=((u=t==null?void 0:t.get(s.v[h]))==null?void 0:u.v)||"";a+=cp(d)}return{t:"num",v:a}}function Hm(l,e,t){var c;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<2||o.length%2!==0)return{t:"err",v:"#N/A!"};const i=[],n=[];for(let u=0;u<o.length;u+=2){const h=ri(o[u],e,t);if(h.t==="err")return h;i.push(h.v);const f=Mo(e(o[u+1]),t);if(Bo(f))return f;n.push(f)}const s=i[0].length;if(i.some(u=>u.length!==s))return{t:"err",v:"#VALUE!"};let a=0;for(let u=0;u<s;u++){let h=!0;for(let f=0;f<i.length;f++){const d=((c=t==null?void 0:t.get(i[f][u]))==null?void 0:c.v)||"";if(!ko(d,n[f])){h=!1;break}}h&&a++}return{t:"num",v:a}}function Um(l,e,t){var c,u;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<3||(o.length-1)%2!==0)return{t:"err",v:"#N/A!"};const i=ri(o[0],e,t);if(i.t==="err")return i;const n=[],s=[];for(let h=1;h<o.length;h+=2){const f=ri(o[h],e,t);if(f.t==="err")return f;n.push(f.v);const d=Mo(e(o[h+1]),t);if(Bo(d))return d;s.push(d)}if(n.some(h=>h.length!==i.v.length))return{t:"err",v:"#VALUE!"};let a=0;for(let h=0;h<i.v.length;h++){let f=!0;for(let d=0;d<n.length;d++){const p=((c=t==null?void 0:t.get(n[d][h]))==null?void 0:c.v)||"";if(!ko(p,s[d])){f=!1;break}}f&&(a+=cp(((u=t==null?void 0:t.get(i.v[h]))==null?void 0:u.v)||""))}return{t:"num",v:a}}function ke(l,e){return l.t==="err"||l.t==="str"?l:l.t==="num"?{t:"str",v:l.v.toString()}:l.t==="bool"?{t:"str",v:l.v?"TRUE":"FALSE"}:l.t==="ref"&&e?up(l,e):{t:"err",v:"#VALUE!"}}function $m(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);return i.t==="err"?i:{t:"str",v:i.v.trim()}}function Vm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);return i.t==="err"?i:{t:"num",v:i.v.length}}function Wm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);if(i.t==="err")return i;let n=1;if(o.length===2){const s=De.map(e(o[1]),t);if(s.t==="err")return s;n=s.v}return{t:"str",v:i.v.slice(0,n)}}function Gm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<1||o.length>2)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);if(i.t==="err")return i;let n=1;if(o.length===2){const s=De.map(e(o[1]),t);if(s.t==="err")return s;n=s.v}return{t:"str",v:i.v.slice(-n)}}function Ym(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==3)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);if(i.t==="err")return i;const n=De.map(e(o[1]),t);if(n.t==="err")return n;const s=De.map(e(o[2]),t);if(s.t==="err")return s;const a=n.v-1;return{t:"str",v:i.v.slice(a,a+s.v)}}function hp(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<2)return{t:"err",v:"#N/A!"};let i="";for(const n of o){const s=ke(e(n),t);if(s.t==="err")return s;i+=s.v}return{t:"str",v:i}}function Xm(l,e,t){return hp(l,e,t)}function fp(l,e,t,r){if(!l)return{t:"num",v:1};const o=De.map(t(l),r);if(o.t==="err")return o;const i=Math.trunc(o.v);return i<1||i>e.length+1?{t:"err",v:"#VALUE!"}:{t:"num",v:i}}function Km(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<2||o.length>3)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);if(i.t==="err")return i;const n=ke(e(o[1]),t);if(n.t==="err")return n;const s=fp(o[2],n.v,e,t);if(s.t==="err")return s;if(i.v==="")return{t:"num",v:s.v};const a=n.v.indexOf(i.v,s.v-1);return a<0?{t:"err",v:"#VALUE!"}:{t:"num",v:a+1}}function dp(l){let e="";for(let t=0;t<l.length;t++){const r=l[t];if(r==="~"&&t+1<l.length){e+=l[t+1].replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),t++;continue}if(r==="*"){e+=".*";continue}if(r==="?"){e+=".";continue}e+=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}return e}function Qm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<2||o.length>3)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);if(i.t==="err")return i;const n=ke(e(o[1]),t);if(n.t==="err")return n;const s=fp(o[2],n.v,e,t);if(s.t==="err")return s;if(i.v==="")return{t:"num",v:s.v};const a=dp(i.v),c=new RegExp(a,"i"),u=n.v.slice(s.v-1),h=c.exec(u);return!h||h.index===void 0?{t:"err",v:"#VALUE!"}:{t:"num",v:s.v+h.index}}function Jm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<3)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);if(i.t==="err")return i;const n=ci.map(e(o[1]),t);if(n.t==="err")return n;const s=[];for(const a of o.slice(2)){const c=e(a);if(c.t==="ref"&&t&&nt(c.v)){for(const h of Dr([c.v])){const f=ke({t:"ref",v:h},t);if(f.t==="err")return f;n.v&&f.v===""||s.push(f.v)}continue}const u=ke(c,t);if(u.t==="err")return u;n.v&&u.v===""||s.push(u.v)}return{t:"str",v:s.join(i.v)}}function Zm(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);return i.t==="err"?i:{t:"str",v:i.v.toLowerCase()}}function eg(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);return i.t==="err"?i:{t:"str",v:i.v.toUpperCase()}}function tg(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);return i.t==="err"?i:{t:"str",v:i.v.toLowerCase().replace(/\b([a-z])([a-z]*)/g,(s,a,c)=>a.toUpperCase()+c)}}function rg(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length<3||o.length>4)return{t:"err",v:"#N/A!"};const i=ke(e(o[0]),t);if(i.t==="err")return i;const n=ke(e(o[1]),t);if(n.t==="err")return n;const s=ke(e(o[2]),t);if(s.t==="err")return s;if(n.v==="")return{t:"str",v:i.v};if(o.length===3)return{t:"str",v:i.v.split(n.v).join(s.v)};const a=De.map(e(o[3]),t);if(a.t==="err")return a;const c=Math.trunc(a.v);if(c<=0)return{t:"err",v:"#VALUE!"};let u=0,h=0;for(;;){const f=i.v.indexOf(n.v,u);if(f<0)return{t:"str",v:i.v};if(h++,h===c)return{t:"str",v:i.v.slice(0,f)+s.v+i.v.slice(f+n.v.length)};u=f+n.v.length}}function ng(l,e,t){const r=l.args();if(r&&r.expr().length>0)return{t:"err",v:"#N/A!"};const o=new Date,i=o.getFullYear(),n=String(o.getMonth()+1).padStart(2,"0"),s=String(o.getDate()).padStart(2,"0");return{t:"str",v:`${i}-${n}-${s}`}}function ig(l,e,t){const r=l.args();if(r&&r.expr().length>0)return{t:"err",v:"#N/A!"};const o=new Date,i=o.getFullYear(),n=String(o.getMonth()+1).padStart(2,"0"),s=String(o.getDate()).padStart(2,"0"),a=String(o.getHours()).padStart(2,"0"),c=String(o.getMinutes()).padStart(2,"0"),u=String(o.getSeconds()).padStart(2,"0");return{t:"str",v:`${i}-${n}-${s} ${a}:${c}:${u}`}}function xl(l,e){const t=ke(l,e);if(t.t==="err")return t;const r=new Date(t.v);return isNaN(r.getTime())?{t:"err",v:"#VALUE!"}:r}function og(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=xl(e(o[0]),t);return i instanceof Date?{t:"num",v:i.getFullYear()}:i}function sg(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=xl(e(o[0]),t);return i instanceof Date?{t:"num",v:i.getMonth()+1}:i}function ag(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=xl(e(o[0]),t);return i instanceof Date?{t:"num",v:i.getDate()}:i}function lg(l,e,t){var s;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);return i.t==="err"?i:i.t!=="ref"||!t?{t:"bool",v:!1}:nt(i.v)?{t:"err",v:"#VALUE!"}:{t:"bool",v:(((s=t.get(i.v))==null?void 0:s.v)||"")===""}}function ug(l,e,t){var c;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);if(i.t==="err")return i;if(i.t==="num")return{t:"bool",v:!0};if(i.t!=="ref"||!t)return{t:"bool",v:!1};if(nt(i.v))return{t:"err",v:"#VALUE!"};const n=((c=t.get(i.v))==null?void 0:c.v)||"",s=n.toUpperCase();return{t:"bool",v:n!==""&&!(s==="TRUE"||s==="FALSE")&&!isNaN(Number(n))}}function cg(l,e,t){var u;const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==1)return{t:"err",v:"#N/A!"};const i=e(o[0]);if(i.t==="err")return i;if(i.t==="str")return{t:"bool",v:!0};if(i.t!=="ref"||!t)return{t:"bool",v:!1};if(nt(i.v))return{t:"err",v:"#VALUE!"};const n=((u=t.get(i.v))==null?void 0:u.v)||"";if(n==="")return{t:"bool",v:!1};const s=n.toUpperCase(),a=s==="TRUE"||s==="FALSE",c=!isNaN(Number(n));return{t:"bool",v:!a&&!c}}function hg(l,e,t){const r=l.args();if(!r)return{t:"err",v:"#N/A!"};const o=r.expr();if(o.length!==2)return{t:"err",v:"#N/A!"};const i=e(o[0]);return i.t==="err"?e(o[1]):i}function pp(l){const e=Zn.CharStreams.fromString(l.slice(1)),t=new ei(e),r=new Zn.CommonTokenStream(t);t.removeErrorListeners(),r.fill();const o=new Set;for(const i of r.getTokens())i.type===Ie.REFERENCE&&o.add(i.text.toUpperCase());return o}function Lr(l){const e=Zn.CharStreams.fromString(l.slice(1)),t=new ei(e),r=new Zn.CommonTokenStream(t);t.removeErrorListeners(),r.fill();const o=[];for(const s of r.getTokens())s.type!=ei.EOF&&o.push({type:t.vocabulary.getSymbolicName(s.type)||"STRING",start:s.startIndex,stop:s.stopIndex,text:s.text});const i=[];let n;for(const s of o)!n&&s.start>0?i.push({type:"STRING",start:0,stop:s.start-1,text:l.slice(1,s.start+1)}):n&&n.stop+1!==s.start&&i.push({type:"STRING",start:n.stop+1,stop:s.start-1,text:l.slice(n.stop+2,s.start+1)}),i.push(s),n=s;return n&&n.stop+2<l.length&&i.push({type:"STRING",start:n.stop+1,stop:l.length-1,text:l.slice(n.stop+2)}),i}function Ii(l){const e=Lr(l),t=[];for(const r of e)if(r.type==="REFERENCE")try{const o=r.text.toUpperCase();if(Lo(o))continue;if(o.includes(":"))t.push({text:o,range:Ba(o)});else{const i=Te(o);t.push({text:o,range:[i,i]})}}catch{}return t}function fg(l,e){if(!l.startsWith("=")||e<=0)return!1;if(e===1)return!0;const t=Lr(l);for(const s of t){const a=s.start+1,c=s.stop+2;if(s.type==="REFERENCE"&&e>=a&&e<=c)return!0}const o=l.slice(0,e).trimEnd();if(o.length===0)return!1;const i=o[o.length-1];return new Set(["=","(",",","+","-","*","/","<",">",":"]).has(i)}function kf(l,e){if(!l.startsWith("="))return;const t=Lr(l);for(const r of t){if(r.type!=="REFERENCE")continue;const o=r.start+1,i=r.stop+2;if(e>=o&&e<=i)return{start:o,end:i,text:r.text}}}function dg(l,e){var t;try{const r=Zn.CharStreams.fromString(l.slice(1)),o=new ei(r),i=new Zn.CommonTokenStream(o),n=new Ie(i),s=n.expr(),a=new pg(e);o.removeErrorListeners(),n.removeErrorListeners();const c=a.visit(s);return c.t==="ref"&&e?nt(c.v)?"#VALUE!":((t=e.get(c.v))==null?void 0:t.v)||"":c.v.toString()}catch{return"#ERROR!"}}class pg{constructor(e){k(this,"grid");this.visit=this.visit.bind(this),this.grid=e}visitChildren(){throw new Error("Method not implemented.")}visitTerminal(){throw new Error("Method not implemented.")}visitErrorNode(){throw new Error("Method not implemented.")}visitFormula(){throw new Error("Method not implemented.")}visitExpr(){throw new Error("Method not implemented.")}visitArgs(){throw new Error("Method not implemented.")}visit(e){return e.accept(this)}visitFunction(e){const t=e.FUNCNAME().text.toUpperCase();if(Mf.has(t))return Mf.get(t)(e,this.visit,this.grid);throw new Error("Function not implemented.")}visitReference(e){return this.grid?{t:"ref",v:e.text.toUpperCase()}:{t:"err",v:"#REF!"}}visitParentheses(e){return this.visit(e.expr())}visitNumber(e){return{t:"num",v:Number(e.text)}}visitBoolean(e){return{t:"bool",v:e.text==="TRUE"||e.text==="true"}}visitAddSub(e){const t=De.map(this.visit(e.expr(0)),this.grid);if(t.t==="err")return t;const r=De.map(this.visit(e.expr(1)),this.grid);return r.t==="err"?r:e._op.type===Ie.ADD?{t:"num",v:t.v+r.v}:{t:"num",v:t.v-r.v}}visitMulDiv(e){const t=De.map(this.visit(e.expr(0)),this.grid);if(t.t==="err")return t;const r=De.map(this.visit(e.expr(1)),this.grid);return r.t==="err"?r:e._op.type===Ie.MUL?{t:"num",v:t.v*r.v}:{t:"num",v:t.v/r.v}}visitComparison(e){const t=De.map(this.visit(e.expr(0)),this.grid);if(t.t==="err")return t;const r=De.map(this.visit(e.expr(1)),this.grid);if(r.t==="err")return r;switch(e._op.type){case Ie.EQ:return{t:"bool",v:t.v===r.v};case Ie.NEQ:return{t:"bool",v:t.v!==r.v};case Ie.LT:return{t:"bool",v:t.v<r.v};case Ie.GT:return{t:"bool",v:t.v>r.v};case Ie.LTE:return{t:"bool",v:t.v<=r.v};case Ie.GTE:return{t:"bool",v:t.v>=r.v};default:return{t:"err",v:"#ERROR!"}}}visitStr(e){return{t:"str",v:e.text.slice(1,-1)}}}function Ge(l,e,t,r){const o=e+t;return r<=e?l>=e&&l<o?r+(l-e):l>=r&&l<e?l+t:l:l>=e&&l<o?r-t+(l-e):l>=o&&l<r?l-t:l}function Un(l,e,t,r,o){return e==="row"?{r:Ge(l.r,t,r,o),c:l.c}:{r:l.r,c:Ge(l.c,t,r,o)}}function xg(l,e,t,r,o){const i=Lr(l);let n="=";for(const s of i)if(s.type==="REFERENCE"){const a=s.text;if(a.includes("!"))n+=a;else if(a.includes(":")){const[c,u]=a.split(":"),h=Te(c.toUpperCase()),f=Te(u.toUpperCase()),d=Un(h,e,t,r,o),p=Un(f,e,t,r,o);n+=de(d)+":"+de(p)}else{const c=Te(a.toUpperCase()),u=Un(c,e,t,r,o);n+=de(u)}}else n+=s.text;return n}function mg(l,e,t,r,o){const i=new Map;for(const[n,s]of l){const a=Te(n),c=Un(a,e,t,r,o),u=de(c);let h;s.f?h={...s,f:xg(s.f,e,t,r,o)}:h={...s},i.set(u,h)}return i}function br(l,e,t,r){const o=new Map;for(const[i,n]of l)o.set(Ge(i,e,t,r),n);return o}function zf(l,e,t){const r=Lr(l);let o="=";for(const i of r)if(i.type==="REFERENCE"){const n=i.text;if(n.includes("!"))o+=n;else if(n.includes(":")){const[s,a]=n.split(":"),c=Te(s.toUpperCase()),u=Te(a.toUpperCase()),h={r:c.r+e,c:c.c+t},f={r:u.r+e,c:u.c+t};h.r<1||h.c<1||f.r<1||f.c<1?o+="#REF!":o+=de(h)+":"+de(f)}else{const s=Te(n.toUpperCase()),a={r:s.r+e,c:s.c+t};a.r<1||a.c<1?o+="#REF!":o+=de(a)}}else o+=i.text;return o}function yo(l,e,t,r){const o=e==="row"?l.r:l.c;if(r>0)return o>=t?e==="row"?{r:l.r+r,c:l.c}:{r:l.r,c:l.c+r}:l;const i=Math.abs(r);return o>=t&&o<t+i?null:o>=t+i?e==="row"?{r:l.r+r,c:l.c}:{r:l.r,c:l.c+r}:l}function gg(l,e,t,r){const o=Te(l),i=yo(o,e,t,r);return i?de(i):null}function yg(l,e,t,r){const o=Lr(l);let i="=";for(const n of o)if(n.type==="REFERENCE"){const s=n.text;if(s.includes("!"))i+=s;else if(s.includes(":")){const[a,c]=s.split(":"),u=Te(a.toUpperCase()),h=Te(c.toUpperCase()),f=yo(u,e,t,r),d=yo(h,e,t,r);!f||!d?i+="#REF!":i+=de(f)+":"+de(d)}else{const a=Te(s.toUpperCase()),c=yo(a,e,t,r);c?i+=de(c):i+="#REF!"}}else i+=n.text;return i}function Rr(l,e,t){const r=new Map;for(const[o,i]of l)if(t>0)o>=e?r.set(o+t,i):r.set(o,i);else{const n=Math.abs(t);o>=e&&o<e+n||(o>=e+n?r.set(o+t,i):r.set(o,i))}return r}function vg(l,e,t,r){const o=new Map;for(const[i,n]of l){const s=gg(i,e,t,r);if(s===null)continue;let a;n.f?a={...n,f:yg(n.f,e,t,r)}:a={...n},o.set(s,a)}return o}const Sg=new Set(["isEmpty","isNotEmpty","textContains","greaterThan","between","dateBefore","dateAfter"]),Ag=new Set(["textContains","greaterThan","dateBefore","dateAfter"]);function Cg(l){return[{r:l[0].r,c:l[0].c},{r:l[1].r,c:l[1].c}]}function Eg(l){return Sg.has(l)}function ct(l){if(typeof l=="string")return l;if(l==null)return"";if(typeof l=="number"||typeof l=="boolean")return String(l);if(typeof l=="object"){const e=l;if(e.value!==void 0&&e.value!==l)return ct(e.value);if(typeof e.toJSON=="function")try{const t=e.toJSON.call(l);if(t!==l)return ct(t)}catch{}}return String(l)}function _g(l){return qe(l[0],l[1])}function Di(l){if(!l)return;const e=l.trim().replace(/,/g,"");if(!e)return;const t=Number(e);return Number.isFinite(t)?t:void 0}function oo(l){if(!l)return;const e=l.trim();if(!e)return;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const o=Number(t[1]),i=Number(t[2]),n=Number(t[3]),s=new Date(o,i-1,n);return s.getFullYear()!==o||s.getMonth()!==i-1||s.getDate()!==n?void 0:s.getTime()}const r=new Date(e);if(!Number.isNaN(r.getTime()))return new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime()}function so(l,e,t){if(t>0)return l>=e?l+t:l;const r=Math.abs(t);return l>=e&&l<e+r?e:l>=e+r?l+t:l}function xp(l){return qe({r:Math.max(1,l[0].r),c:Math.max(1,l[0].c)},{r:Math.max(1,l[1].r),c:Math.max(1,l[1].c)})}function jf(l){if(typeof l!="string")return;const e=l.trim();return e.length>0?e:void 0}function Tg(l){const e={};l.b!==void 0&&(e.b=l.b),l.i!==void 0&&(e.i=l.i),l.u!==void 0&&(e.u=l.u);const t=jf(l.tc);t!==void 0&&(e.tc=t);const r=jf(l.bg);return r!==void 0&&(e.bg=r),Object.keys(e).length>0?e:void 0}function ni(l){const e={id:l.id,range:Cg(l.range),op:l.op,style:{...l.style}};return l.value!==void 0&&(e.value=l.value),l.value2!==void 0&&(e.value2=l.value2),e}function zo(l){const e=ct(l.id).trim();if(!e)return;const t=ct(l.op).trim();if(!Eg(t))return;const r=Tg(l.style||{});if(!r)return;const o={id:e,range:_g(l.range),op:t,style:r};if(Ag.has(t)){const i=ct(l.value).trim();return i?(o.value=i,o):void 0}if(t==="between"){const i=ct(l.value).trim(),n=ct(l.value2).trim();return!i||!n?void 0:(o.value=i,o.value2=n,o)}return o}function bg(l,e){const r=ct(l).trim();switch(e.op){case"isEmpty":return r.length===0;case"isNotEmpty":return r.length>0;case"textContains":{const o=ct(e.value).trim().toLowerCase();return o?r.toLowerCase().includes(o):!1}case"greaterThan":{const o=Di(r),i=Di(e.value);return o!==void 0&&i!==void 0&&o>i}case"between":{const o=Di(r),i=Di(e.value),n=Di(e.value2);if(o===void 0||i===void 0||n===void 0)return!1;const s=Math.min(i,n),a=Math.max(i,n);return o>=s&&o<=a}case"dateBefore":{const o=oo(r),i=oo(e.value);return o!==void 0&&i!==void 0&&o<i}case"dateAfter":{const o=oo(r),i=oo(e.value);return o!==void 0&&i!==void 0&&o>i}default:return!1}}function Rg(l,e,t,r){if(l.length===0)return;const o={r:e,c:t},i=ct(r==null?void 0:r.v);let n;for(const s of l)xr(o,s.range)&&bg(i,s)&&(n={...n||{},...s.style});return n}function mp(l,e,t,r){const o=[];for(const i of l){const n=zo(i);if(!n)continue;const s=n.range,a=e==="row"?qe({r:so(s[0].r,t,r),c:s[0].c},{r:so(s[1].r,t,r),c:s[1].c}):qe({r:s[0].r,c:so(s[0].c,t,r)},{r:s[1].r,c:so(s[1].c,t,r)});o.push({...ni(n),range:xp(a)})}return o}function gp(l,e,t,r,o){const i=[];for(const n of l){const s=zo(n);if(!s)continue;const a=s.range,c=e==="row"?qe({r:Ge(a[0].r,t,r,o),c:a[0].c},{r:Ge(a[1].r,t,r,o),c:a[1].c}):qe({r:a[0].r,c:Ge(a[0].c,t,r,o)},{r:a[1].r,c:Ge(a[1].c,t,r,o)});i.push({...ni(s),range:xp(c)})}return i}function yp(l){const e={};for(const t of Object.keys(l)){const r=l[t];r!==void 0&&(e[t]=r)}return Object.keys(e).length>0?e:void 0}function vp(l,e){const t=l?{...l}:{};let r=!1;for(const o of Object.keys(e)){const i=e[o];i!==void 0&&(t[o]=i,r=!0)}if(Object.keys(t).length!==0&&!(!l&&!r))return t}function ml(l){const e=Math.min(l[0].r,l[1].r),t=Math.min(l[0].c,l[1].c),r=Math.max(l[0].r,l[1].r),o=Math.max(l[0].c,l[1].c);return[{r:e,c:t},{r,c:o}]}function Ui(l){return{range:ml(l.range),style:{...l.style}}}function gr(l){const e=yp(l.style);if(e)return{range:ml(l.range),style:e}}function $i(l,e){const t=Object.keys(l),r=Object.keys(e);if(t.length!==r.length)return!1;for(const o of t)if(l[o]!==e[o])return!1;return!0}function wg(l,e){return l[0].r<=e[0].r&&l[0].c<=e[0].c&&l[1].r>=e[1].r&&l[1].c>=e[1].c}function gl(l){const e=[];for(let t=l.length-1;t>=0;t--){const r=gr(l[t]);if(!r)continue;let o=!1;for(const i of e)if($i(i.style,r.style)&&wg(i.range,r.range)){o=!0;break}o||e.push(Ui(r))}return e.reverse()}function Sp(l){if(l.length<=1)return l;const e=[...l].sort((r,o)=>r[0]-o[0]),t=[];for(const r of e){const o=t[t.length-1];if(!o){t.push([r[0],r[1]]);continue}if(r[0]<=o[1]+1){o[1]=Math.max(o[1],r[1]);continue}t.push([r[0],r[1]])}return t}function qf(l,e,t,r){if(r===0)return[[l,e]];if(r>0)return e<t?[[l,e]]:l>=t?[[l+r,e+r]]:[[l,e+r]];const o=Math.abs(r),i=t+o-1,n=[];return l<t&&n.push([l,Math.min(e,t-1)]),e>i&&n.push([Math.max(l,i+1)+r,e+r]),Sp(n.filter(([s,a])=>s<=a))}function Hf(l,e,t,r,o){const i=t+r,n=[];o<=t?(n.push({start:Number.NEGATIVE_INFINITY,end:o-1,delta:0}),n.push({start:o,end:t-1,delta:r}),n.push({start:t,end:i-1,delta:o-t}),n.push({start:i,end:Number.POSITIVE_INFINITY,delta:0})):(n.push({start:Number.NEGATIVE_INFINITY,end:t-1,delta:0}),n.push({start:t,end:i-1,delta:o-r-t}),n.push({start:i,end:o-1,delta:-r}),n.push({start:o,end:Number.POSITIVE_INFINITY,delta:0}));const s=[];for(const a of n){const c=Math.max(l,a.start),u=Math.min(e,a.end);c>u||s.push([c+a.delta,u+a.delta])}return Sp(s)}function Ap(l,e,t){const r=[];for(const[o,i]of t){if(e==="row"){r.push({range:[{r:o,c:l.range[0].c},{r:i,c:l.range[1].c}],style:{...l.style}});continue}r.push({range:[{r:l.range[0].r,c:o},{r:l.range[1].r,c:i}],style:{...l.style}})}return r}function Cp(l,e){if(l.length<=1)return l.map(Ui);const t=[];for(const r of l){const o=gr(r);if(!o)continue;const i=t[t.length-1];if(!i||!$i(i.style,o.style)){t.push(o);continue}if(e==="row"){const a=i.range[0].c===o.range[0].c&&i.range[1].c===o.range[1].c,c=o.range[0].r<=i.range[1].r+1;if(!a||!c){t.push(o);continue}i.range[0].r=Math.min(i.range[0].r,o.range[0].r),i.range[1].r=Math.max(i.range[1].r,o.range[1].r);continue}const n=i.range[0].r===o.range[0].r&&i.range[1].r===o.range[1].r,s=o.range[0].c<=i.range[1].c+1;if(!n||!s){t.push(o);continue}i.range[0].c=Math.min(i.range[0].c,o.range[0].c),i.range[1].c=Math.max(i.range[1].c,o.range[1].c)}return t}function Ep(l,e,t,r){const o=[];for(const i of l){const n=gr(i);if(!n)continue;const s=e==="row"?qf(n.range[0].r,n.range[1].r,t,r):qf(n.range[0].c,n.range[1].c,t,r);o.push(...Ap(n,e,s))}return gl(Cp(o,e))}function _p(l,e,t,r,o){const i=[];for(const n of l){const s=gr(n);if(!s)continue;const a=e==="row"?Hf(s.range[0].r,s.range[1].r,t,r,o):Hf(s.range[0].c,s.range[1].c,t,r,o);i.push(...Ap(s,e,a))}return gl(Cp(i,e))}function Ng(l,e){const t=ml(e),r=[];for(const o of l){const i=gr(o);if(!i)continue;const n=Math.max(i.range[0].r,t[0].r),s=Math.min(i.range[1].r,t[1].r),a=Math.max(i.range[0].c,t[0].c),c=Math.min(i.range[1].c,t[1].c);n>s||a>c||r.push({range:[{r:n,c:a},{r:s,c}],style:{...i.style}})}return r}function Og(l,e,t){const r=[];for(const o of l){const i=gr(o);if(!i)continue;const n=i.range[0].r+e,s=i.range[1].r+e,a=i.range[0].c+t,c=i.range[1].c+t;s<1||c<1||r.push({range:[{r:Math.max(1,n),c:Math.max(1,a)},{r:Math.max(1,s),c:Math.max(1,c)}],style:{...i.style}})}return r}function Tp(l,e,t){let r;for(const o of l)e<o.range[0].r||e>o.range[1].r||t<o.range[0].c||t>o.range[1].c||(r=vp(r,o.style));return r}function Li(l,e){return[{r:l.r,c:l.c},{r:l.r+e.rs-1,c:l.c+e.cs-1}]}function Uf(l,e,t,r){if(r>0)return t<=l?[l+r,e+r]:t<=e?[l,e+r]:[l,e];const o=Math.abs(r),i=t,n=t+o-1;if(n<l)return[l+r,e+r];if(i>e)return[l,e];const s=Math.max(l,i),c=Math.min(e,n)-s+1,u=e-l+1-c;return u<=0?null:i<=l?[i,i+u-1]:[l,l+u-1]}function Fg(l,e,t,r,o){const i=Uf(l.r,l.r+e.rs-1,t==="row"?r:Number.NEGATIVE_INFINITY,t==="row"?o:0);if(!i)return null;const n=Uf(l.c,l.c+e.cs-1,t==="column"?r:Number.NEGATIVE_INFINITY,t==="column"?o:0);if(!n)return null;const[s,a]=i,[c,u]=n,h=a-s+1,f=u-c+1;return h<=1&&f<=1?null:{anchor:{r:s,c},span:{rs:h,cs:f}}}function Pg(l,e,t,r,o,i){const n=t==="row"?l.r+e.rs-1:l.c+e.cs-1,s=t==="row"?l.r:l.c,a=Ge(s,r,o,i),c=Ge(n,r,o,i),u=Math.min(a,c),f=Math.max(a,c)-u+1;if(t==="row"){const y=f,x=e.cs;return y<=1&&x<=1?null:{anchor:{r:u,c:l.c},span:{rs:y,cs:x}}}const d=e.rs,p=f;return d<=1&&p<=1?null:{anchor:{r:l.r,c:u},span:{rs:d,cs:p}}}function bp(l,e,t,r){const o=new Map;for(const[i,n]of l){const s=Te(i),a=Fg(s,n,e,t,r);a&&o.set(de(a.anchor),a.span)}return o}function Rp(l,e,t,r,o){const i=new Map;for(const[n,s]of l){const a=Te(n),c=Pg(a,s,e,t,r,o);c&&i.set(de(c.anchor),c.span)}return i}function Ig(l,e,t,r,o){const i=t==="row"?l.r:l.c,n=t==="row"?l.r+e.rs-1:l.c+e.cs-1,s=r+o-1;return n<r||i>s?!1:!(i>=r&&n<=s)}class $f{constructor(e){k(this,"customSizes");k(this,"defaultSize");k(this,"cacheDirty",!0);k(this,"sortedIndices",[]);k(this,"sortedSizes",[]);k(this,"prefixDeltas",[]);k(this,"customStarts",[]);this.defaultSize=e,this.customSizes=new Map}getSize(e){return this.customSizes.get(e)??this.defaultSize}setSize(e,t){t===this.defaultSize?this.customSizes.delete(e):this.customSizes.set(e,t),this.cacheDirty=!0}getDefaultSize(){return this.defaultSize}getOffset(e){let t=(e-1)*this.defaultSize;if(this.customSizes.size===0)return t;this.ensureCache();const r=this.lowerBound(this.sortedIndices,e)-1;return r>=0&&(t+=this.prefixDeltas[r]),t}findIndex(e){if(e<0)return 1;if(this.customSizes.size===0)return Math.floor(e/this.defaultSize)+1;this.ensureCache();const t=this.customStarts[0];if(e<t)return Math.floor(e/this.defaultSize)+1;const r=this.upperBound(this.customStarts,e)-1,o=this.sortedIndices[r],i=this.customStarts[r],n=this.sortedSizes[r];if(e<i+n)return o;const s=e-(i+n);return o+1+Math.floor(s/this.defaultSize)}shift(e,t){const r=new Map;for(const[o,i]of this.customSizes)if(t>0)o>=e?r.set(o+t,i):r.set(o,i);else{const n=Math.abs(t);o>=e&&o<e+n||(o>=e+n?r.set(o+t,i):r.set(o,i))}this.customSizes=r,this.cacheDirty=!0}move(e,t,r){const o=new Map;for(const[i,n]of this.customSizes)o.set(Ge(i,e,t,r),n);this.customSizes=o,this.cacheDirty=!0}clear(){this.customSizes.clear(),this.cacheDirty=!0}hasCustomSizes(){return this.customSizes.size>0}ensureCache(){if(!this.cacheDirty)return;if(this.customSizes.size===0){this.sortedIndices=[],this.sortedSizes=[],this.prefixDeltas=[],this.customStarts=[],this.cacheDirty=!1;return}const e=Array.from(this.customSizes.entries()).sort((r,o)=>r[0]-o[0]);this.sortedIndices=[],this.sortedSizes=[],this.prefixDeltas=[],this.customStarts=[];let t=0;for(const[r,o]of e)this.sortedIndices.push(r),this.sortedSizes.push(o),this.customStarts.push((r-1)*this.defaultSize+t),t+=o-this.defaultSize,this.prefixDeltas.push(t);this.cacheDirty=!1}lowerBound(e,t){let r=0,o=e.length;for(;r<o;){const i=r+Math.floor((o-r)/2);e[i]<t?r=i+1:o=i}return r}upperBound(e,t){let r=0,o=e.length;for(;r<o;){const i=r+Math.floor((o-r)/2);e[i]<=t?r=i+1:o=i}return r}}class Dg{constructor(){k(this,"rowIndex",new Map);k(this,"colIndex",new Map)}add(e,t){let r=this.rowIndex.get(e);r||(r=new Set,this.rowIndex.set(e,r)),r.add(t);let o=this.colIndex.get(t);o||(o=new Set,this.colIndex.set(t,o)),o.add(e)}remove(e,t){const r=this.rowIndex.get(e);r&&(r.delete(t),r.size===0&&this.rowIndex.delete(e));const o=this.colIndex.get(t);o&&(o.delete(e),o.size===0&&this.colIndex.delete(t))}has(e,t){const r=this.rowIndex.get(e);return r!==void 0&&r.has(t)}clear(){this.rowIndex.clear(),this.colIndex.clear()}rebuild(e){this.clear();for(const[t,r]of e)this.add(t,r)}*cellsInRange(e){const[t,r]=e;for(const[o,i]of this.rowIndex)if(!(o<t.r||o>r.r))for(const n of i)n>=t.c&&n<=r.c&&(yield[o,n])}hasAnyInRange(e){return!this.cellsInRange(e).next().done}getOccupiedColsInRow(e){return this.rowIndex.get(e)}getOccupiedRowsInCol(e){return this.colIndex.get(e)}get size(){let e=0;for(const t of this.rowIndex.values())e+=t.size;return e}}function Lg(l,e,t,r,o){const i=t==="left"||t==="right",n=t==="down"||t==="right",s=i?e.c:e.r,a=i?r[0].c:r[0].r,c=i?r[1].c:r[1].r,u=i?l.getOccupiedColsInRow(e.r):l.getOccupiedRowsInCol(e.c);let h;if(u&&o){const v=new Set;for(const m of u){const g=i?e.r:m,S=i?m:e.c;o(g,S)&&v.add(m)}h=v.size>0?v:void 0}else h=u;if(!h||h.size===0)return Vf(e,t,r);const f=Array.from(h).sort((v,m)=>v-m);n||f.reverse();const d=n?f.filter(v=>v>s):f.filter(v=>v<s),p=h.has(s),y=n?s+1:s-1,x=xr(i?{r:e.r,c:y}:{r:y,c:e.c},r)&&h.has(y);if(p&&x){let v=s,m=y;for(;(n?m<=c:m>=a)&&h.has(m);)v=m,m=n?m+1:m-1;return i?{r:e.r,c:v}:{r:v,c:e.c}}if(d.length>0){const v=d[0];return i?{r:e.r,c:v}:{r:v,c:e.c}}return Vf(e,t,r)}function Vf(l,e,t){switch(e){case"up":return{r:t[0].r,c:l.c};case"down":return{r:t[1].r,c:l.c};case"left":return{r:l.r,c:t[0].c};case"right":return{r:l.r,c:t[1].c}}}async function Sr(l,e,t){const[r,o]=Bg(e,t);for(const i of r){const n=Te(i);if(!await l.hasFormula(n))continue;const s=await l.getCell(n);if(o.has(i)){await l.setCell(n,{v:"#REF!",f:s.f,s:s.s});continue}const a=pp(s.f),c=await l.fetchGridByReferences(a),u=await dg(s.f,c);await l.setCell(n,{v:u,f:s.f,s:s.s})}}function Bg(l,e){const t=[],r=new Set,o=new Set,i=new Set,n=s=>{if(i.has(s))for(const a of i)r.add(a);if(i.add(s),!o.has(s)){if(o.add(s),l.has(s))for(const a of l.get(s))n(a);t.push(s)}i.delete(s)};for(const s of e)n(s);return[t.reverse(),r]}function Mg(l){let e=1/0,t=1/0,r=0,o=0;for(const[n]of l.entries()){const{r:s,c:a}=Te(n);e=Math.min(e,s),t=Math.min(t,a),r=Math.max(r,s),o=Math.max(o,a)}const i=Array.from({length:r-e+1},()=>Array(o-t+1).fill(""));for(const[n,s]of l.entries()){const{r:a,c}=Te(n);i[a-e][c-t]=s.v||s.f||""}return i.map(n=>n.join("	")).join(`
`)}function kg(l,e){let t=l.r,r=l.c;const o=new Map,i=e.split(`
`);for(const n of i){const s=n.split("	");for(const a of s)o.set(de({r:t,c:r}),{v:a}),r+=1;t+=1,r=l.c}return o}function Wf(l){const e=l.match(/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/);if(!e)return;const t=parseInt(e[1],10),r=parseInt(e[2],10),o=parseInt(e[3],10);if(!(t===255&&r===255&&o===255))return"#"+t.toString(16).padStart(2,"0")+r.toString(16).padStart(2,"0")+o.toString(16).padStart(2,"0")}function zg(l){return l.includes("google-sheets-html-origin")||l.includes("data-sheets-value")||l.includes("urn:schemas-microsoft-com:office:excel")||l.includes('xmlns:x="urn:schemas-microsoft-com:office:excel"')}function jg(l,e){const o=new DOMParser().parseFromString(l,"text/html").querySelector("table");if(!o)return new Map;const i=new Map,n=o.querySelectorAll("tr");for(let s=0;s<n.length;s++){const a=n[s].querySelectorAll("td, th");for(let c=0;c<a.length;c++){const u=a[c],h=u.textContent||"";if(!h&&!u.style.cssText)continue;const f={v:h},d={};let p=!1;const y=u.style.fontWeight;if((y==="bold"||y==="700")&&(d.b=!0,p=!0),u.style.fontStyle==="italic"&&(d.i=!0,p=!0),u.style.backgroundColor){const x=Wf(u.style.backgroundColor);x&&(d.bg=x,p=!0)}if(u.style.color){const x=Wf(u.style.color);x&&(d.tc=x,p=!0)}if(u.style.textAlign){const x=u.style.textAlign;(x==="left"||x==="center"||x==="right")&&(d.al=x,p=!0)}p&&(f.s=d),i.set(de({r:e.r+s,c:e.c+c}),f)}}return i}const wp="en-US",Gf="USD",qg=new Set(["AT","BE","CY","DE","EE","ES","FI","FR","GR","HR","IE","IT","LT","LU","LV","MT","NL","PT","SI","SK"]),Hg={AE:"AED",AR:"ARS",AU:"AUD",BD:"BDT",BR:"BRL",CA:"CAD",CH:"CHF",CL:"CLP",CN:"CNY",CO:"COP",CZ:"CZK",DK:"DKK",EG:"EGP",GB:"GBP",HK:"HKD",HU:"HUF",ID:"IDR",IL:"ILS",IN:"INR",JP:"JPY",KE:"KES",KR:"KRW",KW:"KWD",MX:"MXN",MY:"MYR",NG:"NGN",NO:"NOK",NZ:"NZD",PE:"PEN",PH:"PHP",PK:"PKR",PL:"PLN",QA:"QAR",RO:"RON",RU:"RUB",SA:"SAR",SE:"SEK",SG:"SGD",TH:"THB",TR:"TRY",TW:"TWD",UA:"UAH",US:"USD",VN:"VND",ZA:"ZAR"},Yf=new Map;function yl(l){return l&&l.trim()?l.trim():typeof navigator<"u"&&navigator.language?navigator.language:Intl.DateTimeFormat().resolvedOptions().locale||wp}function Ug(l){const[e]=l.replace(/_/g,"-").split("-u-"),t=e.split("-").filter(Boolean);for(let r=1;r<t.length;r++){const o=t[r];if(/^[a-z]{2}$/i.test(o))return o.toUpperCase()}try{const r=new Intl.Locale(l).maximize().region;if(r)return r.toUpperCase()}catch{}}function Ta(l,e,t){try{return new Intl.NumberFormat(e,t).format(l)}catch{return new Intl.NumberFormat(wp,t).format(l)}}function $g(l,e){const t=String(l.getFullYear()).padStart(4,"0"),r=String(l.getMonth()+1).padStart(2,"0"),o=String(l.getDate()).padStart(2,"0");return`${t}-${r}-${o}`}function Vg(){return yl()}function Np(l){const e=yl(l),t=Yf.get(e);if(t)return t;const r=Ug(e);let o=Gf;return r&&(o=qg.has(r)?"EUR":Hg[r]??Gf),Yf.set(e,o),o}function vS(l){const e=yl(l),t=Np(e);return{locale:e,currency:t,number:Ta(1234.56,e,{minimumFractionDigits:2,maximumFractionDigits:2}),currencyValue:Ta(1234.56,e,{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}),percent:Ta(.1234,e,{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),date:$g(new Date(2026,1,18))}}function ao(l,e,t){try{return l.toLocaleString(e,t)}catch{return l.toLocaleString("en-US",t)}}function Wg(l){const e=l.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(e){const r=Number(e[1]),o=Number(e[2]),i=Number(e[3]),n=new Date(r,o-1,i);return n.getFullYear()===r&&n.getMonth()===o-1&&n.getDate()===i?n:void 0}const t=new Date(l);if(!isNaN(t.getTime()))return t}function Gg(l,e){const t=Wg(l);if(!t)return l;const r=String(t.getFullYear()).padStart(4,"0"),o=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${o}-${i}`}function Ma(l,e,t,r){if(!e||e==="plain"||l==="")return l;const o=t??2,i=(r==null?void 0:r.locale)??Vg(),n=(r==null?void 0:r.currency)??Np(i);switch(e){case"number":{const s=Number(l);return isNaN(s)?l:ao(s,i,{minimumFractionDigits:o,maximumFractionDigits:o})}case"currency":{const s=Number(l);return isNaN(s)?l:t===void 0?ao(s,i,{style:"currency",currency:n}):ao(s,i,{style:"currency",currency:n,minimumFractionDigits:o,maximumFractionDigits:o})}case"percent":{const s=Number(l);return isNaN(s)?l:ao(s,i,{style:"percent",minimumFractionDigits:o,maximumFractionDigits:o})}case"date":return Gg(l);default:return l}}const Yg={$:"USD","":"KRW"};function Xf(l){return l.length>1&&l.startsWith("0")}function Xg(l){if(!l.includes(","))return/^\d+$/.test(l)?l:void 0;const e=l.split(",");if(/^\d{1,3}$/.test(e[0])){for(let t=1;t<e.length;t++)if(!/^\d{3}$/.test(e[t]))return;return e.join("")}}function vl(l,e){if(l.length===0||/\s/.test(l))return;if(e.allowExponent&&/[eE]/.test(l)){const r=l.match(/^([+-])?(\d+(?:\.\d+)?|\.\d+)[eE]([+-]?\d+)$/);if(!r)return;const o=r[1]??"",i=r[2],n=r[3],s=i.startsWith(".")?"0":i.split(".")[0];if(!e.allowPaddedInteger&&Xf(s))return;const a=+`${o}${i}e${n}`;return Number.isFinite(a)?a:void 0}const t=l.match(/^([+-])?(\d[\d,]*)(?:\.(\d*))?$/);if(t){const r=t[1]??"",o=t[2],i=t[3],n=Xg(o);if(!n||!e.allowPaddedInteger&&Xf(n))return;const s=i!==void 0?`${r}${n}.${i}`:`${r}${n}`,a=Number(s);return Number.isFinite(a)?a:void 0}if(e.allowLeadingDot){const r=l.match(/^([+-])?\.(\d+)$/);if(!r)return;const o=r[1]??"",i=r[2],n=+`${o}0.${i}`;return Number.isFinite(n)?n:void 0}}function Op(l,e,t){const r=new Date(l,e-1,t);if(!(r.getFullYear()!==l||r.getMonth()!==e-1||r.getDate()!==t))return`${String(l).padStart(4,"0")}-${String(e).padStart(2,"0")}-${String(t).padStart(2,"0")}`}function Kg(l){const e=l.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!e)return;const t=Number(e[1]),r=Number(e[2]),o=Number(e[3]);return Op(t,r,o)}function Qg(l,e){const t=l.match(/^(\d{1,2})\/(\d{1,2})$/);if(!t)return;const r=Number(t[1]),o=Number(t[2]);return Op(e,r,o)}function Jg(l){const e=l.match(/^([+-])?\s*([$])\s*([0-9][0-9,]*(?:\.[0-9]+)?|\.\d+)$/);if(!e)return;const t=e[1]??"",r=e[2],o=e[3],i=vl(`${t}${o}`,{allowExponent:!1,allowLeadingDot:!0,allowPaddedInteger:!0});if(i!==void 0)return{code:Yg[r],value:i}}function Zg(l){const e=l.match(/^([+-])?\s*([0-9][0-9,]*(?:\.[0-9]+)?|\.\d+)\s*%$/);if(!e)return;const t=e[1]??"",r=e[2],o=vl(`${t}${r}`,{allowExponent:!1,allowLeadingDot:!0,allowPaddedInteger:!0});if(o!==void 0)return o/100}function Kf(l,e){const t=l.trim();if(t.startsWith("="))return{type:"formula",value:t.slice(1).trimStart()};const r=t.toLowerCase();if(r==="true")return{type:"boolean",value:!0};if(r==="false")return{type:"boolean",value:!1};const o=Jg(t);if(o)return{type:"number",value:o.value,format:`currency:${o.code}`};const i=Zg(t);if(i!==void 0)return{type:"number",value:i,format:"percent"};const n=Kg(t);if(n)return{type:"date",value:n,format:"yyyy-mm-dd"};const s=new Date().getFullYear(),a=Qg(t,s);if(a)return{type:"date",value:a,format:"yyyy-mm-dd"};const c=vl(t,{allowExponent:!0,allowLeadingDot:!0,allowPaddedInteger:!1});return c!==void 0?{type:"number",value:c}:{type:"text",value:t}}const ey={rows:1e6,columns:18278},ty=5e4,ry={b:!1,i:!1,u:!1,st:!1,bt:!1,br:!1,bb:!1,bl:!1,al:"left",va:"top",nf:"plain",dp:2};class ny{constructor(e){k(this,"store");k(this,"dimension");k(this,"activeCell");k(this,"range");k(this,"selectionType","cell");k(this,"rowDimensions");k(this,"colDimensions");k(this,"frozenRows",0);k(this,"frozenCols",0);k(this,"colStyles",new Map);k(this,"rowStyles",new Map);k(this,"sheetStyle");k(this,"rangeStyles",[]);k(this,"conditionalFormats",[]);k(this,"merges",new Map);k(this,"mergeCoverMap",new Map);k(this,"filterRange");k(this,"filterColumns",new Map);k(this,"hiddenRows",new Set);k(this,"copyBuffer");k(this,"gridResolver");this.store=e,this.dimension={...ey},this.activeCell={r:1,c:1}}get dimensionRange(){return[{r:1,c:1},{r:this.dimension.rows,c:this.dimension.columns}]}getDimension(){return this.dimension}setDimensions(e,t){this.rowDimensions=e,this.colDimensions=t}getRowDimensions(){return this.rowDimensions}getColDimensions(){return this.colDimensions}setRowHeight(e,t){var r;(r=this.rowDimensions)==null||r.setSize(e,t),this.store.setDimensionSize("row",e,t)}setColumnWidth(e,t){var r;(r=this.colDimensions)==null||r.setSize(e,t),this.store.setDimensionSize("column",e,t)}async loadDimensions(){if(this.rowDimensions){this.rowDimensions.clear();const e=await this.store.getDimensionSizes("row");for(const[t,r]of e)this.rowDimensions.setSize(t,r)}if(this.colDimensions){this.colDimensions.clear();const e=await this.store.getDimensionSizes("column");for(const[t,r]of e)this.colDimensions.setSize(t,r)}}getFreezePane(){return{frozenRows:this.frozenRows,frozenCols:this.frozenCols}}async setFreezePane(e,t){this.frozenRows=e,this.frozenCols=t,await this.store.setFreezePane(e,t)}async loadFreezePane(){const{frozenRows:e,frozenCols:t}=await this.store.getFreezePane();this.frozenRows=e,this.frozenCols=t}async loadStyles(){this.colStyles=await this.store.getColumnStyles(),this.rowStyles=await this.store.getRowStyles(),this.sheetStyle=await this.store.getSheetStyle(),this.rangeStyles=await this.store.getRangeStyles(),this.conditionalFormats=await this.store.getConditionalFormats()}async loadMerges(){this.merges=await this.store.getMerges(),this.rebuildMergeCoverMap()}async loadFilterState(){const e=await this.store.getFilterState();if(!e){this.filterRange=void 0,this.filterColumns.clear(),this.hiddenRows.clear();return}this.filterRange=qe(e.range[0],e.range[1]),this.filterColumns=new Map;for(const[t,r]of Object.entries(e.columns)){const o=Number(t);Number.isFinite(o)&&this.filterColumns.set(o,{...r})}this.normalizeFilterColumnsToRange(),this.hiddenRows=new Set(e.hiddenRows.filter(t=>t>0)),this.pruneHiddenRowsOutsideFilter(),this.ensureActiveCellVisibleAfterFiltering()}hasFilter(){return!!this.filterRange}getFilterRange(){return this.filterRange?st(this.filterRange):void 0}getHiddenRows(){return new Set(this.hiddenRows)}getFilteredColumns(){return new Set(this.filterColumns.keys())}getColumnFilterCondition(e){const t=this.filterColumns.get(e);if(t)return{...t,values:t.values?[...t.values]:void 0}}isColumnInFilter(e){return this.filterRange?e>=this.filterRange[0].c&&e<=this.filterRange[1].c:!1}getFilterState(){return this.buildFilterStatePayload()}getColStyles(){return this.colStyles}getRowStyles(){return this.rowStyles}getSheetStyle(){return this.sheetStyle}getRangeStyles(){return this.rangeStyles.map(e=>({range:st(e.range),style:{...e.style}}))}getConditionalFormats(){return this.conditionalFormats.map(e=>ni(e))}getMerges(){return this.merges}rebuildMergeCoverMap(){this.mergeCoverMap.clear();for(const[e,t]of this.merges){const r=Te(e);for(let o=r.r;o<r.r+t.rs;o++)for(let i=r.c;i<r.c+t.cs;i++){const n=de({r:o,c:i});n!==e&&this.mergeCoverMap.set(n,e)}}}getAnchorSrefForRef(e){const t=de(e);return this.merges.has(t)?t:this.mergeCoverMap.get(t)||t}normalizeRefToAnchor(e){return Te(this.getAnchorSrefForRef(e))}getMergeForRef(e){const t=this.getAnchorSrefForRef(e),r=this.merges.get(t);if(!r)return;const o=Te(t);return{anchorSref:t,anchor:o,span:r,range:Li(o,r)}}expandRangeToMergedBoundaries(e){let t=st(e),r=!0;for(;r;){r=!1;for(const[o,i]of this.merges){const n=Li(Te(o),i);if(!xr(n[0],t)&&!xr(n[1],t)&&!(n[0].r<=t[1].r&&n[1].r>=t[0].r&&n[0].c<=t[1].c&&n[1].c>=t[0].c))continue;const s=_a(t,n);Er(s,t)||(t=s,r=!0)}}return t}*mergeCoveredSrefs(e,t){for(let r=e.r;r<e.r+t.rs;r++)for(let o=e.c;o<e.c+t.cs;o++)yield de({r,c:o})}expandChangedSrefsWithMergeAliases(e){const t=new Set;for(const r of e){const o=this.getAnchorSrefForRef(Te(r)),i=this.merges.get(o);if(!i){t.add(r);continue}const n=Te(o);for(const s of this.mergeCoveredSrefs(n,i))t.add(s)}return t}getMergesIntersecting(e){const t=[];for(const[r,o]of this.merges){const i=Te(r),n=Li(i,o);n[0].r<=e[1].r&&n[1].r>=e[0].r&&n[0].c<=e[1].c&&n[1].c>=e[0].c&&t.push({anchorSref:r,anchor:i,span:o,range:n})}return t}resolveEffectiveStyle(e,t,r){const o=this.sheetStyle,i=this.colStyles.get(t),n=this.rowStyles.get(e),s=Tp(this.rangeStyles,e,t);if(!(!o&&!i&&!n&&!s&&!r))return{...o,...i,...n,...s,...r}}async getCell(e){return this.store.get(this.normalizeRefToAnchor(e))}async setCell(e,t){await this.store.set(this.normalizeRefToAnchor(e),t)}async setGrid(e){await this.store.setGrid(e)}async hasFormula(e){const t=await this.getCell(e);return!!(t&&t.f)}async toInputString(e){const t=await this.getCell(e);return t?t.f?t.f:t.v||"":""}async toDisplayString(e){const t=this.normalizeRefToAnchor(e),r=await this.store.get(t);if(!r||!r.v)return"";const o=this.resolveEffectiveStyle(t.r,t.c,r.s);return Ma(r.v,o==null?void 0:o.nf,o==null?void 0:o.dp,{currency:o==null?void 0:o.cu})}toStoredValue(e){switch(e.type){case"number":return e.value.toString();case"date":case"text":return e.value;case"boolean":return e.value?"TRUE":"FALSE"}}applyInferredFormat(e,t){var r;if(t.type==="date"){const o={...e||{},nf:"date"};return delete o.cu,o}if(t.type==="number"&&t.format==="percent"){const o={...e||{},nf:"percent"};return delete o.cu,o}return t.type==="number"&&((r=t.format)!=null&&r.startsWith("currency:"))?{...e||{},nf:"currency",cu:t.format.slice(9)}:e?{...e}:void 0}applyInputInferenceToGrid(e){const t=new Map;for(const[r,o]of e){if(o.f){t.set(r,{...o});continue}const i=Kf(o.v??""),n=this.applyInferredFormat(o.s,i),s=i.type==="formula"?{f:`=${i.value}`}:{v:this.toStoredValue(i)};t.set(r,this.compactCell(s,n))}return t}async setData(e,t){const r=this.normalizeRefToAnchor(e);this.store.beginBatch();try{const o=await this.store.get(r),i=Kf(t),n=this.applyInferredFormat(o==null?void 0:o.s,i),s=i.type==="formula"?{f:`=${i.value}`}:{v:this.toStoredValue(i)},a=this.compactCell(s,n);this.isEmptyCell(a)?await this.store.delete(r):await this.store.set(r,a);const c=this.expandChangedSrefsWithMergeAliases([de(r)]),u=await this.store.buildDependantsMap(c);await Sr(this,u,c),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}async removeData(){this.store.beginBatch();try{const e=this.getRangeOrActiveCell(),t=await this.store.getGrid(e),r=new Set;for(const[n,s]of t){const a=Te(n);s.s&&Object.keys(s.s).length>0?await this.store.set(a,{s:s.s}):await this.store.delete(a),r.add(n)}if(r.size===0)return!1;const o=this.expandChangedSrefsWithMergeAliases(r),i=await this.store.buildDependantsMap(o);return await Sr(this,i,o),this.filterRange&&await this.recomputeFilterHiddenRows(),!0}finally{this.store.endBatch()}}async insertRows(e,t=1){await this.shiftCells("row",e,t)}async deleteRows(e,t=1){await this.shiftCells("row",e,-t)}async insertColumns(e,t=1){await this.shiftCells("column",e,t)}async deleteColumns(e,t=1){await this.shiftCells("column",e,-t)}async moveRows(e,t,r){await this.moveCells("row",e,t,r)}async moveColumns(e,t,r){await this.moveCells("column",e,t,r)}async shiftCells(e,t,r){var i,n;await this.store.shiftCells(e,t,r),e==="row"?((i=this.rowDimensions)==null||i.shift(t,r),this.rowStyles=Rr(this.rowStyles,t,r)):((n=this.colDimensions)==null||n.shift(t,r),this.colStyles=Rr(this.colStyles,t,r)),this.rangeStyles=Ep(this.rangeStyles,e,t,r),this.conditionalFormats=mp(this.conditionalFormats,e,t,r),this.merges=bp(this.merges,e,t,r),this.rebuildMergeCoverMap(),this.shiftFilterState(e,t,r);const o=e==="row"?this.activeCell.r:this.activeCell.c;if(r>0&&o>=t)e==="row"?this.activeCell={r:this.activeCell.r+r,c:this.activeCell.c}:this.activeCell={r:this.activeCell.r,c:this.activeCell.c+r};else if(r<0){const s=Math.abs(r);o>=t&&o<t+s?e==="row"?this.activeCell={r:Math.max(1,t),c:this.activeCell.c}:this.activeCell={r:this.activeCell.r,c:Math.max(1,t)}:o>=t+s&&(e==="row"?this.activeCell={r:this.activeCell.r+r,c:this.activeCell.c}:this.activeCell={r:this.activeCell.r,c:this.activeCell.c+r})}this.activeCell=this.normalizeRefToAnchor(this.activeCell),this.store.beginBatch();try{const s=e==="row"?this.frozenRows:this.frozenCols;if(s>0){if(r>0&&t<=s){const a=s+r;e==="row"?this.frozenRows=a:this.frozenCols=a,await this.store.setFreezePane(this.frozenRows,this.frozenCols)}else if(r<0){const a=Math.abs(r);if(t<=s){const c=Math.min(a,s-t+1),u=Math.max(0,s-c);e==="row"?this.frozenRows=u:this.frozenCols=u,await this.store.setFreezePane(this.frozenRows,this.frozenCols)}}}await this.recalculateAllFormulaCells(),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}async moveCells(e,t,r,o,i){var n,s;if(!(o>=t&&o<=t+r)){for(const[a,c]of this.merges){const u=Te(a);if(Ig(u,c,e,t,r))return}if(await this.store.moveCells(e,t,r,o),e==="row"?((n=this.rowDimensions)==null||n.move(t,r,o),this.rowStyles=br(this.rowStyles,t,r,o)):((s=this.colDimensions)==null||s.move(t,r,o),this.colStyles=br(this.colStyles,t,r,o)),this.rangeStyles=_p(this.rangeStyles,e,t,r,o),this.conditionalFormats=gp(this.conditionalFormats,e,t,r,o),this.merges=Rp(this.merges,e,t,r,o),this.rebuildMergeCoverMap(),this.moveFilterState(e,t,r,o),this.activeCell=this.normalizeRefToAnchor(Un(this.activeCell,e,t,r,o)),this.range&&(this.range=this.expandRangeToMergedBoundaries([Un(this.range[0],e,t,r,o),Un(this.range[1],e,t,r,o)])),!(i!=null&&i.skipPostRecalculate)){this.store.beginBatch();try{await this.recalculateAllFormulaCells(),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}}}async recalculateAllFormulaCells(){const e=new Set,t=[{r:1,c:1},{r:1e3,c:100}],r=await this.store.getGrid(t);for(const[o,i]of r)i.f&&e.add(o);if(e.size>0){const o=await this.store.buildDependantsMap(e);await Sr(this,o,e)}}buildFilterStatePayload(){if(!this.filterRange)return;const e={},t=Array.from(this.filterColumns.entries()).sort((r,o)=>r[0]-o[0]);for(const[r,o]of t)this.isColumnInFilter(r)&&(e[String(r)]={...o});return{range:st(this.filterRange),columns:e,hiddenRows:Array.from(this.hiddenRows).sort((r,o)=>r-o)}}normalizeFilterColumnsToRange(){if(!this.filterRange){this.filterColumns.clear();return}for(const e of this.filterColumns.keys())this.isColumnInFilter(e)||this.filterColumns.delete(e)}pruneHiddenRowsOutsideFilter(){if(!this.filterRange){this.hiddenRows.clear();return}const e=this.filterRange[0].r+1,t=this.filterRange[1].r,r=new Set;for(const o of this.hiddenRows)o>=e&&o<=t&&r.add(o);this.hiddenRows=r}normalizeFilterText(e){if(typeof e=="string")return e;if(e==null)return"";if(typeof e=="number"||typeof e=="boolean")return String(e);if(typeof e=="object"){const t=e;if(t.value!==void 0&&t.value!==e)return this.normalizeFilterText(t.value);if(typeof t.toJSON=="function")try{const r=t.toJSON.call(e);if(r!==e)return this.normalizeFilterText(r)}catch{}}return String(e)}normalizeFilterCondition(e){const t=e.op;if(t==="in"){const o=Array.from(new Set((e.values||[]).map(i=>this.normalizeFilterText(i).trim())));return{op:t,values:o}}if(t==="isEmpty"||t==="isNotEmpty")return{op:t};const r=this.normalizeFilterText(e.value).trim();if(r.length!==0)return{op:t,value:r}}matchesFilterCondition(e,t){const r=this.normalizeFilterText(e).trim(),o=r.toLowerCase(),i=this.normalizeFilterText(t.value).trim().toLowerCase();switch(t.op){case"in":return new Set((t.values||[]).map(n=>this.normalizeFilterText(n).trim())).has(r);case"contains":return o.includes(i);case"notContains":return!o.includes(i);case"equals":return o===i;case"notEquals":return o!==i;case"isEmpty":return o.length===0;case"isNotEmpty":return o.length>0;default:return!0}}async rowMatchesFilters(e,t){for(const[r,o]of this.filterColumns){if(r===t)continue;const i=await this.getCell({r:e,c:r}),n=this.normalizeFilterText(i==null?void 0:i.v);if(!this.matchesFilterCondition(n,o))return!1}return!0}async recomputeFilterHiddenRows(){if(!this.filterRange){this.hiddenRows.clear(),await this.store.setFilterState(void 0);return}if(this.filterRange=qe({r:Math.max(1,this.filterRange[0].r),c:Math.max(1,this.filterRange[0].c)},{r:Math.min(this.dimension.rows,this.filterRange[1].r),c:Math.min(this.dimension.columns,this.filterRange[1].c)}),this.filterRange[1].r<=this.filterRange[0].r){this.filterRange=void 0,this.filterColumns.clear(),this.hiddenRows.clear(),await this.store.setFilterState(void 0);return}this.normalizeFilterColumnsToRange();const e=new Set,t=this.filterRange[0].r+1,r=this.filterRange[1].r;if(this.filterColumns.size>0)for(let o=t;o<=r;o++)await this.rowMatchesFilters(o)||e.add(o);this.hiddenRows=e,this.ensureActiveCellVisibleAfterFiltering(),await this.store.setFilterState(this.buildFilterStatePayload())}shiftFilterBoundary(e,t,r){if(r>0)return e>=t?e+r:e;const o=Math.abs(r);return e>=t&&e<t+o?t:e>=t+o?e+r:e}shiftFilterState(e,t,r){if(!this.filterRange)return;if(e==="row"){const s=this.shiftFilterBoundary(this.filterRange[0].r,t,r),a=this.shiftFilterBoundary(this.filterRange[1].r,t,r);this.filterRange=qe({r:Math.max(1,s),c:this.filterRange[0].c},{r:Math.max(1,a),c:this.filterRange[1].c});const c=new Map;for(const h of this.hiddenRows)c.set(h,1);const u=Rr(c,t,r);this.hiddenRows=new Set(u.keys()),this.pruneHiddenRowsOutsideFilter();return}const o=this.shiftFilterBoundary(this.filterRange[0].c,t,r),i=this.shiftFilterBoundary(this.filterRange[1].c,t,r);this.filterRange=qe({r:this.filterRange[0].r,c:Math.max(1,o)},{r:this.filterRange[1].r,c:Math.max(1,i)});const n=new Map;for(const[s,a]of this.filterColumns)n.set(s,a);this.filterColumns=Rr(n,t,r),this.normalizeFilterColumnsToRange()}moveFilterState(e,t,r,o){if(!this.filterRange)return;if(e==="row"){const a=Ge(this.filterRange[0].r,t,r,o),c=Ge(this.filterRange[1].r,t,r,o);this.filterRange=qe({r:a,c:this.filterRange[0].c},{r:c,c:this.filterRange[1].c});const u=new Map;for(const f of this.hiddenRows)u.set(f,1);const h=br(u,t,r,o);this.hiddenRows=new Set(h.keys()),this.pruneHiddenRowsOutsideFilter();return}const i=Ge(this.filterRange[0].c,t,r,o),n=Ge(this.filterRange[1].c,t,r,o);this.filterRange=qe({r:this.filterRange[0].r,c:i},{r:this.filterRange[1].r,c:n});const s=new Map;for(const[a,c]of this.filterColumns)s.set(a,c);this.filterColumns=br(s,t,r,o),this.normalizeFilterColumnsToRange()}ensureActiveCellVisibleAfterFiltering(){if(!this.hiddenRows.has(this.activeCell.r))return;let e;if(this.filterRange&&this.activeCell.r>this.filterRange[0].r&&this.activeCell.r<=this.filterRange[1].r)e=this.filterRange[0].r;else{for(let t=this.activeCell.r+1;t<=this.dimension.rows;t++)if(!this.hiddenRows.has(t)){e=t;break}if(e===void 0){for(let t=this.activeCell.r-1;t>=1;t--)if(!this.hiddenRows.has(t)){e=t;break}}}e!==void 0&&(this.range=void 0,this.setActiveCell({r:e,c:this.activeCell.c}))}findNextVisibleRow(e,t){const r=t==="down"?1:-1;let o=e;for(;o>=1&&o<=this.dimension.rows;){if(!this.hiddenRows.has(o))return o;o+=r}}async fetchGrid(e){return this.store.getGrid(e)}hasCellContent(e){const t=e.v!==void 0&&e.v!==""&&e.v!==null,r=!!e.f;return t||r}isEmptyCell(e){const t=this.hasCellContent(e),r=e.s!==void 0&&Object.keys(e.s).length>0;return!t&&!r}normalizeStylePatch(e){return yp(e)}mergeStylePatch(e,t){return vp(e,t)}rangesIntersect(e,t){return e[0].r<=t[1].r&&e[1].r>=t[0].r&&e[0].c<=t[1].c&&e[1].c>=t[0].c}hasConflictingStyleSourceForKey(e,t,r,o){var n;const i=(n=this.sheetStyle)==null?void 0:n[t];if(i!==void 0&&i!==r)return!0;for(const[s,a]of this.colStyles){if(s<e[0].c||s>e[1].c)continue;const c=a[t];if(c!==void 0&&c!==r)return!0}for(const[s,a]of this.rowStyles){if(s<e[0].r||s>e[1].r)continue;const c=a[t];if(c!==void 0&&c!==r)return!0}for(let s=0;s<this.rangeStyles.length;s++){if(o!==void 0&&s===o)continue;const a=this.rangeStyles[s],c=a.style[t];if(!(c===void 0||c===r)&&this.rangesIntersect(e,a.range))return!0}return!1}pruneRedundantDefaultStyleKeys(e,t,r){const o={};for(const i of Object.keys(t)){const n=t[i];if(n===void 0)continue;const s=ry[i];s!==void 0&&n===s&&!this.hasConflictingStyleSourceForKey(e,i,n,r)||(o[i]=n)}return Object.keys(o).length>0?o:void 0}sameRangeStylePatchList(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Er(e[r].range,t[r].range)||!$i(e[r].style,t[r].style))return!1;return!0}compactShadowedRangeStyles(){const e=gl(this.rangeStyles);return this.sameRangeStylePatchList(e,this.rangeStyles)?!1:(this.rangeStyles=e,!0)}containsRange(e,t){return e[0].r<=t[0].r&&e[0].c<=t[0].c&&e[1].r>=t[1].r&&e[1].c>=t[1].c}mergeableColBand(e,t){return e[0].r!==t[0].r||e[1].r!==t[1].r?!1:t[0].c<=e[1].c+1&&e[0].c<=t[1].c+1}mergeableRowBand(e,t){return e[0].c!==t[0].c||e[1].c!==t[1].c?!1:t[0].r<=e[1].r+1&&e[0].r<=t[1].r+1}tryMergeRangeStylePatches(e,t){if($i(e.style,t.style)){if(Er(e.range,t.range)||this.containsRange(e.range,t.range))return e;if(this.containsRange(t.range,e.range))return t;if(this.mergeableColBand(e.range,t.range))return{range:[{r:e.range[0].r,c:Math.min(e.range[0].c,t.range[0].c)},{r:e.range[1].r,c:Math.max(e.range[1].c,t.range[1].c)}],style:{...e.style}};if(this.mergeableRowBand(e.range,t.range))return{range:[{r:Math.min(e.range[0].r,t.range[0].r),c:e.range[0].c},{r:Math.max(e.range[1].r,t.range[1].r),c:e.range[1].c}],style:{...e.style}}}}async addRangeStylePatch(e,t){const r=this.normalizeStylePatch(t);if(!r)return;const o=gr({range:st(e),style:r});if(!o)return;const i=this.rangeStyles,n=this.pruneRedundantDefaultStyleKeys(o.range,o.style);if(!n)return;o.style=n;const s=i[i.length-1];if(s&&Er(s.range,o.range)){const u=this.mergeStylePatch(s.style,o.style);if(!u)return;const h=this.pruneRedundantDefaultStyleKeys(s.range,u,i.length-1);if(!h){this.rangeStyles=i.slice(0,-1),this.compactShadowedRangeStyles(),await this.store.setRangeStyles(this.rangeStyles);return}if($i(h,s.style))return;s.style={...h},this.compactShadowedRangeStyles(),await this.store.setRangeStyles(this.rangeStyles);return}let a=o,c=i.length;for(let u=i.length-1;u>=0;u--){const h=i[u],f=this.tryMergeRangeStylePatches(h,a);if(!f)break;if(Er(f.range,h.range)){if(u===i.length-1)return;this.rangeStyles=i.slice(0,u+1),this.compactShadowedRangeStyles(),await this.store.setRangeStyles(this.rangeStyles);return}a=f,c=u}if(c===i.length){this.rangeStyles.push(a),await this.store.addRangeStyle(a),this.compactShadowedRangeStyles()&&await this.store.setRangeStyles(this.rangeStyles);return}this.rangeStyles=[...i.slice(0,c),a],this.compactShadowedRangeStyles(),await this.store.setRangeStyles(this.rangeStyles)}async applyStylePatchToExistingCells(e,t){const r=this.normalizeStylePatch(t);if(!r)return;const o=await this.store.getGrid(e),i=new Set;for(const[n]of o){const s=Te(n),a=this.normalizeRefToAnchor(s),c=de(a);if(i.has(c))continue;i.add(c);const u=await this.store.get(a);if(!(u!=null&&u.s))continue;const h={};for(const f of Object.keys(r)){const d=u.s[f],p=r[f];d===void 0||d===p||(h[f]=p)}Object.keys(h).length!==0&&await this.setStyle(a,h)}}compactCell(e,t){const r={};return e.v!==void 0&&(r.v=e.v),e.f!==void 0&&(r.f=e.f),t&&Object.keys(t).length>0&&(r.s=t),r}getCopyRange(){var e;return(e=this.copyBuffer)==null?void 0:e.sourceRange}clearCopyBuffer(){this.copyBuffer=void 0}async copy(){const e=this.getRangeOrActiveCell(),t=await this.fetchGrid(e),r=Ng(this.rangeStyles,e),o=Mg(t);return this.copyBuffer={sourceRange:e,grid:t,rangeStyles:r,text:o},{text:o}}async paste(e){const{text:t,html:r}=e;let o,i=[],n=!1;if(this.copyBuffer&&t===this.copyBuffer.text){o=this.relocateGrid(this.copyBuffer.grid,this.copyBuffer.sourceRange,this.activeCell);const s=this.activeCell.r-this.copyBuffer.sourceRange[0].r,a=this.activeCell.c-this.copyBuffer.sourceRange[0].c;i=Og(this.copyBuffer.rangeStyles,s,a)}else if(r&&zg(r))o=jg(r,this.activeCell),n=!0;else if(t)o=kg(this.activeCell,t),n=!0;else return;n&&(o=this.applyInputInferenceToGrid(o)),this.store.beginBatch();try{await this.setGrid(o);for(const a of i)await this.addRangeStylePatch(a.range,a.style),await this.applyStylePatchToExistingCells(a.range,a.style);const s=new Set;for(const[a]of o)s.add(a);if(s.size>0){const a=this.expandChangedSrefsWithMergeAliases(s),c=await this.store.buildDependantsMap(a);await Sr(this,c,a)}this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}this.selectPastedRange(o)}selectPastedRange(e){if(e.size===0)return;let t=1/0,r=-1/0,o=1/0,i=-1/0;for(const n of e.keys()){const s=Te(n);s.r<t&&(t=s.r),s.r>r&&(r=s.r),s.c<o&&(o=s.c),s.c>i&&(i=s.c)}t===r&&o===i?this.selectStart({r:t,c:o}):(this.selectionType="cell",this.activeCell={r:t,c:o},this.range=[{r:t,c:o},{r,c:i}],this.store.updateActiveCell(this.activeCell))}relocateGrid(e,t,r){const o=r.r-t[0].r,i=r.c-t[0].c,n=new Map;for(const[s,a]of e){const c=Te(s),u={r:c.r+o,c:c.c+i},h=de(u);if(a.f){const f=zf(a.f,o,i);n.set(h,{f,s:a.s})}else n.set(h,{...a})}return n}computeAutofillRange(e,t){if(!xr(t,e))return _a(e,[t,t])}getAutofillPreviewRange(e){if(this.selectionType!=="cell")return;const t=this.getRangeOrActiveCell();return this.computeAutofillRange(t,e)}positiveMod(e,t){return(e%t+t)%t}cloneCellForAutofill(e,t,r){if(e.f){const i=zf(e.f,t,r);return e.s?{f:i,s:{...e.s}}:{f:i}}const o={};return e.v!==void 0&&(o.v=e.v),e.s&&(o.s={...e.s}),o}async autofill(e){if(this.selectionType!=="cell")return!1;const t=st(this.getRangeOrActiveCell()),r=this.computeAutofillRange(t,e);if(!r||this.getMergesIntersecting(r).length>0)return!1;const o=await this.store.getGrid(t),i=t[1].r-t[0].r+1,n=t[1].c-t[0].c+1,s=new Set;this.store.beginBatch();try{for(let a=r[0].r;a<=r[1].r;a++)for(let c=r[0].c;c<=r[1].c;c++){const u={r:a,c};if(xr(u,t))continue;const h={r:t[0].r+this.positiveMod(u.r-t[0].r,i),c:t[0].c+this.positiveMod(u.c-t[0].c,n)},f=o.get(de(h)),d=this.normalizeRefToAnchor(u),p=de(d);if(!f){await this.store.delete(d),s.add(p);continue}const y=u.r-h.r,x=u.c-h.c,v=this.cloneCellForAutofill(f,y,x);this.isEmptyCell(v)?await this.store.delete(d):await this.store.set(d,v),s.add(p)}if(s.size>0){const a=this.expandChangedSrefsWithMergeAliases(s),c=await this.store.buildDependantsMap(a);await Sr(this,c,a)}this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return s.size===0?!1:(this.selectionType="cell",this.range=r,!0)}async hasContents(e){const t=await this.store.getGrid(e);for(const r of t.values())if(this.hasCellContent(r))return!0;return!1}async fetchGridByReferences(e){const t=new Map,r=new Map;for(const o of Dr(e))if(Lo(o)){const{sheetName:i,localRef:n}=lp(o);r.has(i.toUpperCase())||r.set(i.toUpperCase(),new Set),r.get(i.toUpperCase()).add(n)}else{const i=this.normalizeRefToAnchor(Te(o)),n=await this.store.get(i);n&&t.set(o,n)}if(this.gridResolver&&r.size>0)for(const[o,i]of r){const n=this.gridResolver(o,i);if(n)for(const[s,a]of n)t.set(`${o}!${s}`,a)}return t}setGridResolver(e){this.gridResolver=e}async recalculateCrossSheetFormulas(){const e=await this.store.getFormulaGrid(),t=new Set;for(const[r]of e)t.add(r);if(t.size!==0){this.store.beginBatch();try{const r=await this.store.buildDependantsMap(t);await Sr(this,r,t),this.filterRange&&await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}}}getActiveCell(){return this.activeCell}setActiveCell(e){const t=this.normalizeRefToAnchor(e);this.activeCell=t,this.store.updateActiveCell(t)}getRange(){return this.range}getPresences(){return this.store.getPresences()}getRangeOrActiveCell(){if(this.range)return this.expandRangeToMergedBoundaries(this.range);const e=this.getMergeForRef(this.activeCell);return e?e.range:[this.activeCell,this.activeCell]}getSelectionType(){return this.selectionType}selectRow(e){this.selectionType="row",this.activeCell={r:e,c:1},this.range=[{r:e,c:1},{r:e,c:this.dimension.columns}],this.store.updateActiveCell(this.activeCell)}selectColumn(e){this.selectionType="column",this.activeCell={r:1,c:e},this.range=[{r:1,c:e},{r:this.dimension.rows,c:e}],this.store.updateActiveCell(this.activeCell)}selectRowRange(e,t){this.selectionType="row";const r=Math.min(e,t),o=Math.max(e,t);this.range=[{r,c:1},{r:o,c:this.dimension.columns}]}selectColumnRange(e,t){this.selectionType="column";const r=Math.min(e,t),o=Math.max(e,t);this.range=[{r:1,c:r},{r:this.dimension.rows,c:o}]}selectAllCells(){this.selectionType="all",this.activeCell={r:1,c:1},this.range=st(this.dimensionRange),this.store.updateActiveCell(this.activeCell)}getSelectedIndices(){return this.selectionType==="cell"||this.selectionType==="all"||!this.range?null:this.selectionType==="row"?{axis:"row",from:this.range[0].r,to:this.range[1].r}:{axis:"column",from:this.range[0].c,to:this.range[1].c}}async createFilterFromSelection(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell(),t=await this.expandFilterRangeForHeaderOnlySelection(e);return await this.setFilterRange(t)?(this.selectionType="cell",this.range=st(qe(t[0],t[1])),!0):!1}async expandFilterRangeForHeaderOnlySelection(e){const t=qe(e[0],e[1]);if(t[0].r!==t[1].r)return t;const r=t[0].r;if(r>=this.dimension.rows)return t;const o=[{r:r+1,c:t[0].c},{r:this.dimension.rows,c:t[1].c}],i=await this.store.getGrid(o);if(i.size===0)return t;const n=new Set;for(const[a,c]of i)this.hasCellContent(c)&&n.add(Te(a).r);let s=r;for(;n.has(s+1);)s+=1;return qe(t[0],{r:s,c:t[1].c})}async setFilterRange(e){const t=qe(e[0],e[1]);if(t[1].r<=t[0].r)return!1;this.store.beginBatch();try{this.filterRange=t,this.normalizeFilterColumnsToRange(),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async clearFilter(){this.store.beginBatch();try{this.filterRange=void 0,this.filterColumns.clear(),this.hiddenRows.clear(),await this.store.setFilterState(void 0)}finally{this.store.endBatch()}}async setColumnFilter(e,t){if(!this.filterRange||!this.isColumnInFilter(e))return!1;this.store.beginBatch();try{const r=this.normalizeFilterCondition(t);r?this.filterColumns.set(e,r):this.filterColumns.delete(e),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async filterColumnByValue(e,t){return this.setColumnFilter(e,{op:"equals",value:t})}async clearColumnFilter(e){if(!this.filterRange||!this.isColumnInFilter(e)||!this.filterColumns.has(e))return!1;this.store.beginBatch();try{this.filterColumns.delete(e),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async getFilterColumnValues(e){if(!this.filterRange||!this.isColumnInFilter(e))return;const t=new Set,r=this.filterRange[0].r+1,o=this.filterRange[1].r;for(let s=r;s<=o;s++){if(!await this.rowMatchesFilters(s,e))continue;const a=await this.getCell({r:s,c:e}),c=this.normalizeFilterText(a==null?void 0:a.v);t.add(c.trim())}const i=Array.from(t).sort((s,a)=>s.localeCompare(a,void 0,{sensitivity:"base"})),n=this.filterColumns.get(e);return n?n.op==="in"?{values:i,selected:new Set((n.values||[]).map(s=>this.normalizeFilterText(s).trim()))}:{values:i,selected:new Set(i.filter(s=>this.matchesFilterCondition(s,n)))}:{values:i,selected:new Set(i)}}async setColumnIncludedValues(e,t){if(!this.filterRange||!this.isColumnInFilter(e))return!1;const r=Array.from(new Set(t.map(s=>this.normalizeFilterText(s).trim()))).sort((s,a)=>s.localeCompare(a,void 0,{sensitivity:"base"})),o=await this.getFilterColumnValues(e);if(!o)return!1;const i=new Set(o.values),n=r.filter(s=>i.has(s));this.store.beginBatch();try{n.length===o.values.length?this.filterColumns.delete(e):this.filterColumns.set(e,{op:"in",values:n}),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}async sortFilterByColumn(e,t){if(!this.filterRange||!this.isColumnInFilter(e))return!1;const r=this.filterRange[0].r+1,o=this.filterRange[1].r;if(o<=r)return!1;const i=[{r,c:1},{r:o,c:this.dimension.columns}];if(this.getMergesIntersecting(i).length>0)return!1;const n=[];for(let u=r;u<=o;u++){const h=await this.getCell({r:u,c:e}),f=this.normalizeFilterText(h==null?void 0:h.v).trim(),d=f.length>0&&Number.isFinite(Number(f))?Number(f):null;n.push({row:u,text:f,lower:f.toLowerCase(),numeric:d})}n.sort((u,h)=>{const f=u.text.length===0,d=h.text.length===0;if(f&&!d)return 1;if(!f&&d)return-1;let p=0;return u.numeric!==null&&h.numeric!==null?p=u.numeric-h.numeric:p=u.lower.localeCompare(h.lower,void 0,{sensitivity:"base"}),p===0&&(p=u.row-h.row),t==="asc"?p:-p});const s=n.map(u=>u.row),a=Array.from({length:o-r+1},(u,h)=>r+h),c=[];for(let u=0;u<s.length;u++){const h=s[u],f=a.indexOf(h);if(f===-1||f===u)continue;const d=r+f,p=r+u;c.push({srcIndex:d,dstIndex:p}),a.splice(f,1),a.splice(u,0,h)}if(c.length===0)return!0;this.store.beginBatch();try{for(const u of c)await this.moveCells("row",u.srcIndex,1,u.dstIndex,{skipPostRecalculate:!0});await this.recalculateAllFormulaCells(),await this.recomputeFilterHiddenRows()}finally{this.store.endBatch()}return!0}selectStart(e){xr(e,this.dimensionRange)&&(this.selectionType="cell",this.setActiveCell(this.normalizeRefToAnchor(e)),this.range=void 0)}selectEnd(e){if(!xr(e,this.dimensionRange))return;const t=this.normalizeRefToAnchor(e);if(Hi(this.activeCell,t)){this.range=void 0;return}this.range=this.expandRangeToMergedBoundaries(qe(this.activeCell,t))}hasRange(){return!!this.range}async selectAll(){let e=this.getRangeOrActiveCell(),t=st(e),r=!0;for(;r;){r=!1;for(const o of am(t,this.dimensionRange))await this.hasContents(o)&&(t=_a(t,o),r=!0)}if(Er(e,t)){this.range=st(this.dimensionRange);return}this.range=t}async moveToEdge(e){const t=this.getMergeForRef(this.activeCell),r={...this.activeCell};t&&(e==="right"?r.c=t.range[1].c:e==="down"&&(r.r=t.range[1].r));const o=await this.store.findEdge(r,e,this.dimensionRange);let i=this.normalizeRefToAnchor(o);if((e==="up"||e==="down")&&this.hiddenRows.has(i.r)){const n=this.findNextVisibleRow(i.r,e);if(n===void 0)return!1;i=this.normalizeRefToAnchor({r:n,c:i.c})}return Hi(this.activeCell,i)?!1:(this.range=void 0,this.setActiveCell(i),!0)}move(e){const t=e==="up"?-1:e==="down"?1:0,r=e==="left"?-1:e==="right"?1:0;let o=this.activeCell.r,i=this.activeCell.c;const n=this.getMergeForRef(this.activeCell);if(n?e==="right"?i=n.range[1].c+1:e==="down"?o=n.range[1].r+1:e==="left"?i-=1:o-=1:(o+=t,i+=r),(e==="up"||e==="down")&&this.hiddenRows.has(o)){const a=this.findNextVisibleRow(o,e);if(a===void 0)return!1;o=a}if(!xr({r:o,c:i},this.dimensionRange))return!1;const s=this.normalizeRefToAnchor({r:o,c:i});return Hi(this.activeCell,s)?!1:(this.range=void 0,this.setActiveCell(s),!0)}resizeRange(e){const t=e==="up"?-1:e==="down"?1:0,r=e==="left"?-1:e==="right"?1:0;let o=st(this.getRangeOrActiveCell());if(t!==0){const i=t>0?"down":"up",n=s=>this.hiddenRows.has(s)?this.findNextVisibleRow(s,i):s;if(this.activeCell.r===o[1].r){const s=n(o[0].r+t);if(s===void 0)return!1;o[0].r=s}else{const s=n(o[1].r+t);if(s===void 0)return!1;o[1].r=s}}return r!==0&&(this.activeCell.c===o[1].c?o[0].c+=r:o[1].c+=r),o=qe(o[0],o[1]),sm(o,this.dimensionRange)?(this.range=this.expandRangeToMergedBoundaries(o),!0):!1}async getStyle(e){const t=this.normalizeRefToAnchor(e),r=await this.store.get(t);return this.resolveEffectiveStyle(t.r,t.c,r==null?void 0:r.s)}async setStyle(e,t){const r=this.normalizeStylePatch(t);if(!r)return;const o=this.normalizeRefToAnchor(e),i=await this.store.get(o)||{},n=this.mergeStylePatch(i.s,r),s=this.compactCell(i,n);if(this.isEmptyCell(s)){await this.store.delete(o);return}await this.store.set(o,s)}async setRangeStyle(e){this.store.beginBatch();try{if(this.selectionType==="column"){const r=this.getRangeOrActiveCell();for(let o=r[0].c;o<=r[1].c;o++){const i=this.mergeStylePatch(this.colStyles.get(o),e);i&&(this.colStyles.set(o,i),await this.store.setColumnStyle(o,i))}return}if(this.selectionType==="row"){const r=this.getRangeOrActiveCell();for(let o=r[0].r;o<=r[1].r;o++){const i=this.mergeStylePatch(this.rowStyles.get(o),e);i&&(this.rowStyles.set(o,i),await this.store.setRowStyle(o,i))}return}if(this.selectionType==="all"){const r=this.mergeStylePatch(this.sheetStyle,e);if(!r)return;this.sheetStyle=r,await this.store.setSheetStyle(r);return}const t=this.getRangeOrActiveCell();await this.addRangeStylePatch(t,e),await this.applyStylePatchToExistingCells(t,e)}finally{this.store.endBatch()}}async setConditionalFormats(e){const t=e.map(r=>zo(r)).filter(r=>!!r).map(r=>ni(r));this.conditionalFormats=t,await this.store.setConditionalFormats(this.conditionalFormats)}async setRangeBorders(e){if(this.selectionType!=="cell")return!1;const t=this.getRangeOrActiveCell(),r=t[1].r-t[0].r+1,o=t[1].c-t[0].c+1;if(r*o>ty)return!1;const i=this.collectBorderTargets(t);this.store.beginBatch();try{for(const{anchor:n,range:s}of i){const a=this.toBorderPatchForPreset(e,t,s);await this.setStyle(n,a)}}finally{this.store.endBatch()}return!0}async toggleRangeStyle(e){const t=await this.getStyle(this.activeCell),r=!(t!=null&&t[e]);await this.setRangeStyle({[e]:r})}collectBorderTargets(e){const t=[],r=new Set;for(let o=e[0].r;o<=e[1].r;o++)for(let i=e[0].c;i<=e[1].c;i++){const n=this.normalizeRefToAnchor({r:o,c:i}),s=de(n);if(r.has(s))continue;r.add(s);const a=this.merges.get(s),c=a?Li(n,a):qe(n,n);t.push({anchor:n,range:c})}return t}toBorderPatchForPreset(e,t,r){const o=r[0].r===t[0].r,i=r[1].r===t[1].r,n=r[0].c===t[0].c,s=r[1].c===t[1].c;switch(e){case"all":return{bt:!0,bl:!0,br:s,bb:i};case"outer":return{bt:o,bl:n,br:s,bb:i};case"inner":return{bt:!o,bl:!n,br:!1,bb:!1};case"top":return{bt:o};case"bottom":return{bb:i};case"left":return{bl:n};case"right":return{br:s};case"clear":default:return{bt:!1,bl:!1,br:!1,bb:!1}}}isSelectionMerged(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell(),t=this.getMergesIntersecting(e);return t.length===1&&Er(t[0].range,e)}canMergeSelection(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell();if(e[0].r===e[1].r&&e[0].c===e[1].c)return!1;const r=this.frozenRows>0&&e[0].r<=this.frozenRows&&e[1].r>this.frozenRows,o=this.frozenCols>0&&e[0].c<=this.frozenCols&&e[1].c>this.frozenCols;return r||o?!1:this.getMergesIntersecting(e).length===0}async toggleMergeSelection(){return this.isSelectionMerged()?this.unmergeSelection():this.mergeSelection()}async mergeSelection(){if(!this.canMergeSelection())return!1;const e=this.getRangeOrActiveCell(),t=e[0],r={rs:e[1].r-e[0].r+1,cs:e[1].c-e[0].c+1},o=new Set;for(const i of this.mergeCoveredSrefs(t,r))o.add(i);this.store.beginBatch();try{for(let s=e[0].r;s<=e[1].r;s++)for(let a=e[0].c;a<=e[1].c;a++){if(s===t.r&&a===t.c)continue;const c={r:s,c:a},u=await this.store.get(c);u&&(u.s&&Object.keys(u.s).length>0?await this.store.set(c,{s:u.s}):await this.store.delete(c))}await this.store.setMerge(t,r),this.merges.set(de(t),r),this.rebuildMergeCoverMap();const i=this.expandChangedSrefsWithMergeAliases(o),n=await this.store.buildDependantsMap(i);await Sr(this,n,i)}finally{this.store.endBatch()}return this.selectionType="cell",this.setActiveCell(t),this.range=Li(t,r),!0}async unmergeSelection(){if(this.selectionType!=="cell")return!1;const e=this.getRangeOrActiveCell(),t=this.getMergesIntersecting(e);if(t.length===0)return!1;const r=new Set;for(const o of t)for(const i of this.mergeCoveredSrefs(o.anchor,o.span))r.add(i);this.store.beginBatch();try{for(const n of t)await this.store.deleteMerge(n.anchor),this.merges.delete(n.anchorSref);this.rebuildMergeCoverMap();const o=this.expandChangedSrefsWithMergeAliases(r),i=await this.store.buildDependantsMap(o);await Sr(this,i,o)}finally{this.store.endBatch()}return this.selectionType="cell",this.range=void 0,!0}async getActiveDecimalPlaces(){const e=await this.getStyle(this.activeCell);return(e==null?void 0:e.dp)??2}async undo(){const e=await this.store.undo();if(e.success&&(await this.loadDimensions(),await this.loadStyles(),await this.loadMerges(),await this.loadFreezePane(),await this.loadFilterState(),e.affectedRange)){const[t,r]=e.affectedRange;this.selectionType="cell",this.activeCell=t,t.r===r.r&&t.c===r.c?this.range=void 0:this.range=e.affectedRange,this.store.updateActiveCell(this.activeCell)}return e.success}async redo(){const e=await this.store.redo();if(e.success&&(await this.loadDimensions(),await this.loadStyles(),await this.loadMerges(),await this.loadFreezePane(),await this.loadFilterState(),e.affectedRange)){const[t,r]=e.affectedRange;this.selectionType="cell",this.activeCell=t,t.r===r.r&&t.c===r.c?this.range=void 0:this.range=e.affectedRange,this.store.updateActiveCell(this.activeCell)}return e.success}moveInRange(e,t){const r=this.range||this.dimensionRange;let o=this.activeCell.r,i=this.activeCell.c;const n=this.getMergeForRef(this.activeCell),s=r[1].r-r[0].r+1,a=r[1].c-r[0].c+1;if(e!==0){const c=e>0?n?n.span.rs:e:e<0?-1:0;o+c>r[1].r?(o=r[0].r,i=(i+1-r[0].c+a)%a+r[0].c):o+c<r[0].r?(o=r[1].r,i=(i-1-r[0].c+a)%a+r[0].c):o+=c}if(t!==0){const c=t>0?n?n.span.cs:t:t<0?-1:0;i+c>r[1].c?(i=r[0].c,o=(o+1-r[0].r+s)%s+r[0].r):i+c<r[0].c?(i=r[1].c,o=(o-1-r[0].r+s)%s+r[0].r):i+=c}this.setActiveCell(this.normalizeRefToAnchor({r:o,c:i}))}}class iy{constructor(e){k(this,"grid");k(this,"cellIndex",new Dg);k(this,"rowHeights",new Map);k(this,"colWidths",new Map);k(this,"colStyles",new Map);k(this,"rowStyles",new Map);k(this,"sheetStyle");k(this,"rangeStyles",[]);k(this,"conditionalFormats",[]);k(this,"merges",new Map);k(this,"filterState");k(this,"frozenRows",0);k(this,"frozenCols",0);this.grid=e||new Map,this.rebuildIndex()}async set(e,t){this.grid.set(de(e),t),this.cellIndex.add(e.r,e.c)}async get(e){return this.grid.get(de(e))}async has(e){return this.grid.has(de(e))}async delete(e){const t=this.grid.delete(de(e));return t&&this.cellIndex.remove(e.r,e.c),t}async deleteRange(e){const t=new Set,r=[];for(const[o,i]of this.cellIndex.cellsInRange(e)){const n=de({r:o,c:i});this.grid.delete(n),t.add(n),r.push([o,i])}for(const[o,i]of r)this.cellIndex.remove(o,i);return t}async setGrid(e){for(const[t,r]of e){this.grid.set(t,r);const o=Te(t);this.cellIndex.add(o.r,o.c)}}async getGrid(e){const t=new Map;for(const[r,o]of this.cellIndex.cellsInRange(e)){const i=de({r,c:o}),n=this.grid.get(i);n!==void 0&&t.set(i,n)}return t}async findEdge(e,t,r){return Lg(this.cellIndex,e,t,r,(o,i)=>{const n=this.grid.get(de({r:o,c:i}));return n!==void 0&&(!!n.v||!!n.f)})}async shiftCells(e,t,r){this.grid=vg(this.grid,e,t,r),this.rebuildIndex(),e==="row"?(this.rowHeights=Rr(this.rowHeights,t,r),this.rowStyles=Rr(this.rowStyles,t,r)):(this.colWidths=Rr(this.colWidths,t,r),this.colStyles=Rr(this.colStyles,t,r)),this.rangeStyles=Ep(this.rangeStyles,e,t,r),this.conditionalFormats=mp(this.conditionalFormats,e,t,r),this.merges=bp(this.merges,e,t,r)}async moveCells(e,t,r,o){this.grid=mg(this.grid,e,t,r,o),this.rebuildIndex(),e==="row"?(this.rowHeights=br(this.rowHeights,t,r,o),this.rowStyles=br(this.rowStyles,t,r,o)):(this.colWidths=br(this.colWidths,t,r,o),this.colStyles=br(this.colStyles,t,r,o)),this.rangeStyles=_p(this.rangeStyles,e,t,r,o),this.conditionalFormats=gp(this.conditionalFormats,e,t,r,o),this.merges=Rp(this.merges,e,t,r,o)}async getFormulaGrid(){const e=new Map;for(const[t,r]of this.grid)r.f&&e.set(t,r);return e}async buildDependantsMap(e){const t=Array.from(this.grid.entries()),r=new Map;for(const[o,i]of t)if(i.f)for(const n of Dr(pp(i.f)))Lo(n)||(r.has(n)||r.set(n,new Set),r.get(n).add(o));return r}getPresences(){return[]}async setDimensionSize(e,t,r){(e==="row"?this.rowHeights:this.colWidths).set(t,r)}async getDimensionSizes(e){return new Map(e==="row"?this.rowHeights:this.colWidths)}updateActiveCell(e){}async setColumnStyle(e,t){this.colStyles.set(e,t)}async getColumnStyles(){return new Map(this.colStyles)}async setRowStyle(e,t){this.rowStyles.set(e,t)}async getRowStyles(){return new Map(this.rowStyles)}async setSheetStyle(e){this.sheetStyle=e}async getSheetStyle(){return this.sheetStyle?{...this.sheetStyle}:void 0}async addRangeStyle(e){const t=gr(e);t&&this.rangeStyles.push(Ui(t))}async setRangeStyles(e){this.rangeStyles=e.map(t=>gr(t)).filter(t=>!!t).map(t=>Ui(t))}async getRangeStyles(){return this.rangeStyles.map(e=>Ui(e))}async setConditionalFormats(e){this.conditionalFormats=e.map(t=>zo(t)).filter(t=>!!t).map(t=>ni(t))}async getConditionalFormats(){return this.conditionalFormats.map(e=>ni(e))}async setMerge(e,t){this.merges.set(de(e),{...t})}async deleteMerge(e){return this.merges.delete(de(e))}async getMerges(){return new Map(this.merges)}async setFilterState(e){if(!e){this.filterState=void 0;return}this.filterState={range:[{...e.range[0]},{...e.range[1]}],columns:Object.fromEntries(Object.entries(e.columns).map(([t,r])=>[t,{...r}])),hiddenRows:[...e.hiddenRows]}}async getFilterState(){if(this.filterState)return{range:[{...this.filterState.range[0]},{...this.filterState.range[1]}],columns:Object.fromEntries(Object.entries(this.filterState.columns).map(([e,t])=>[e,{...t}])),hiddenRows:[...this.filterState.hiddenRows]}}async setFreezePane(e,t){this.frozenRows=e,this.frozenCols=t}async getFreezePane(){return{frozenRows:this.frozenRows,frozenCols:this.frozenCols}}beginBatch(){}endBatch(){}async undo(){return{success:!1}}async redo(){return{success:!1}}canUndo(){return!1}canRedo(){return!1}rebuildIndex(){this.cellIndex.rebuild(Array.from(this.grid.keys()).map(e=>{const t=Te(e);return[t.r,t.c]}))}}const oy={cellBorderColor:"#D3D3D3",customBorderColor:"#000000",cellBGColor:"#FFFFFF",cellTextColor:"#000000",activeCellColor:"#E6C746",selectionBGColor:"rgba(230, 199, 70, 0.1)",headerBGColor:"#F0F0F0",headerActiveBGColor:"#E6C746","tokens.REFERENCE":"#E6C746","tokens.NUM":"#4DA6FF",peerCursor1:"#FF6B6B",peerCursor2:"#4ECDC4",peerCursor3:"#45B7D1",peerCursor4:"#96CEB4",peerCursor5:"#FFEAA7",peerCursor6:"#DDA0DD",peerCursor7:"#98D8C8",peerCursor8:"#F7DC6F",resizeHandleColor:"#1A73E8",headerSelectedBGColor:"rgba(26, 115, 232, 0.3)",dropIndicatorColor:"#1A73E8",freezeLineColor:"#BBBBBB",freezeHandleColor:"#9E9E9E",freezeHandleHoverColor:"#5F6368",formulaRange1:"#1A73E8",formulaRange2:"#E84C3D",formulaRange3:"#9B59B6",formulaRange4:"#27AE60",formulaRange5:"#F39C12",formulaRange6:"#00ACC1"},sy={cellBorderColor:"#4A4A4A",customBorderColor:"#FFFFFF",cellBGColor:"#1E1E1E",cellTextColor:"#FFFFFF",activeCellColor:"#D4B73E",selectionBGColor:"rgba(212, 183, 62, 0.1)",headerBGColor:"#2D2D2D",headerActiveBGColor:"#D4B73E","tokens.REFERENCE":"#D4B73E","tokens.NUM":"#4DA6FF",peerCursor1:"#FF7979",peerCursor2:"#55EFC4",peerCursor3:"#74B9FF",peerCursor4:"#A4D4C4",peerCursor5:"#FDCB6E",peerCursor6:"#E17055",peerCursor7:"#81ECEC",peerCursor8:"#F8D84F",resizeHandleColor:"#8AB4F8",headerSelectedBGColor:"rgba(138, 180, 248, 0.3)",dropIndicatorColor:"#8AB4F8",freezeLineColor:"#5A5A5A",freezeHandleColor:"#8E8E8E",freezeHandleHoverColor:"#CCCCCC",formulaRange1:"#8AB4F8",formulaRange2:"#FF7979",formulaRange3:"#BB86FC",formulaRange4:"#66BB6A",formulaRange5:"#FFB74D",formulaRange6:"#4DD0E1"};function ve(l,e){return l==="light"?oy[e]:sy[e]}const Qf=["formulaRange1","formulaRange2","formulaRange3","formulaRange4","formulaRange5","formulaRange6"];function vo(l,e){return ve(l,Qf[e%Qf.length])}function Jf(l,e){const t=["peerCursor1","peerCursor2","peerCursor3","peerCursor4","peerCursor5","peerCursor6","peerCursor7","peerCursor8"];let r=0;for(let i=0;i<e.length;i++){const n=e.charCodeAt(i);r=(r<<5)-r+n,r=r&r}const o=Math.abs(r)%t.length;return ve(l,t[o])}function mr(l){const e=window.getSelection();if(e.rangeCount===0)return;const t=e.getRangeAt(0);if(!l.contains(t.commonAncestorContainer))return;let r=0,o=0,i=0;function n(s){if(s.nodeType===Node.TEXT_NODE){const a=s.textContent;s===t.startContainer&&(o=r+t.startOffset),s===t.endContainer&&(i=r+t.endOffset),r+=a.length}for(const a of s.childNodes)n(a)}return n(l),{start:o,end:i}}function _r(l,e){let t=0,r=null,o=null;const i=document.createRange();function n(a){if(a.nodeType===Node.TEXT_NODE){const c=a.textContent;r===null&&t+c.length>=e.start&&(r=a,i.setStart(a,e.start-t)),o===null&&t+c.length>=e.end&&(o=a,i.setEnd(a,e.end-t)),t+=c.length}for(const c of a.childNodes)n(c)}n(l);const s=window.getSelection();s.removeAllRanges(),s.addRange(i),l.focus()}function Fp(l){return l=l.replace(/&/g,"&amp;"),l=l.replace(/</g,"&lt;"),l=l.replace(/>/g,"&gt;"),l=l.replace(/"/g,"&quot;"),l=l.replace(/'/g,"&#039;"),l=l.replace(/\n/g,"<br>"),l=l.replace(/ /g,"&nbsp;"),l}const Pp=23,Ip=10;class ay{constructor(e="light"){k(this,"sheet");k(this,"theme");k(this,"container");k(this,"cellLabel");k(this,"formulaInput");k(this,"boundRenderInput");this.theme=e,this.container=document.createElement("div"),this.container.style.height=`${Pp}px`,this.container.style.margin=`${Ip}px 0px`,this.container.style.display="flex",this.container.style.alignItems="center",this.container.style.borderTop=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.container.style.borderBottom=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.container.style.justifyContent="flex-start",this.cellLabel=document.createElement("div"),this.cellLabel.style.width="120px",this.cellLabel.style.textAlign="center",this.cellLabel.style.font="12px Arial",this.cellLabel.style.borderRight=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.container.appendChild(this.cellLabel),this.formulaInput=document.createElement("div"),this.formulaInput.contentEditable="true",this.formulaInput.style.margin="0 20px",this.formulaInput.style.width="100%",this.formulaInput.style.height="12px",this.formulaInput.style.border="none",this.formulaInput.style.font="12px Arial",this.formulaInput.style.outline="none",this.formulaInput.style.overflow="hidden",this.formulaInput.style.whiteSpace="nowrap",this.formulaInput.style.lineHeight="12px",this.container.appendChild(this.formulaInput),this.boundRenderInput=this.renderInput.bind(this),this.formulaInput.addEventListener("input",this.boundRenderInput)}getContainer(){return this.container}initialize(e){this.sheet=e}cleanup(){this.formulaInput.removeEventListener("input",this.boundRenderInput),this.sheet=void 0,this.container.remove()}async render(){if(!this.sheet)return;const e=this.sheet.getActiveCell(),t=this.sheet.getSelectionType(),r=this.sheet.getSelectedIndices();let o;if(t==="row"&&r)o=`${r.from}:${r.to}`;else if(t==="column"&&r){const i=ti(r.from),n=ti(r.to);o=`${i}:${n}`}else{const i=this.sheet.getRange();o=i?lm(i):de(e)}this.cellLabel.textContent=o,this.formulaInput.innerText=await this.sheet.toInputString(e),this.renderInput()}getFormulaInput(){return this.formulaInput}getValue(){return this.formulaInput.innerText}setValue(e){this.formulaInput.innerText=e,this.renderInput()}focus(){this.formulaInput.focus()}blur(){this.formulaInput.blur()}isFocused(){return document.activeElement===this.formulaInput}renderInput(){const e=this.formulaInput.innerText;if(!e.startsWith("="))return;const t=Lr(e),r=[];let o=0;for(const n of t){if(n.type==="REFERENCE"){r.push(`<span style="color: ${vo(this.theme,o)}">${n.text}</span>`),o++;continue}if(n.type==="NUM"){r.push(`<span style="color: ${this.getThemeColor("tokens.NUM")}">${n.text}</span>`);continue}r.push(Fp(n.text))}const i=mr(this.formulaInput);this.formulaInput.innerHTML="="+r.join(""),i&&_r(this.formulaInput,i)}getThemeColor(e){return ve(this.theme,e)}}const at=100,oe=23,ue=50,Tr=13,So=1.5,lo=4,ka=5,ba=.5,ly=1.5,uy="center",Dp=4,cy=10;function Le(l,e={left:0,top:0},t,r){const o=r?r.getOffset(l.c):(l.c-1)*at,i=t?t.getOffset(l.r):(l.r-1)*oe,n=r?r.getSize(l.c):at,s=t?t.getSize(l.r):oe;return{left:o+ue-e.left,top:i+oe-e.top,width:n,height:s}}function qn(l,e){const t=Math.min(l.left,e.left),r=Math.min(l.top,e.top),o=Math.max(l.left+l.width,e.left+e.width),i=Math.max(l.top+l.height,e.top+e.height);return{left:t,top:r,width:o-t,height:i-r}}const Hn={frozenRows:0,frozenCols:0,frozenWidth:0,frozenHeight:0};function hy(l,e,t,r){return l===0&&e===0?Hn:{frozenRows:l,frozenCols:e,frozenWidth:e>0?r.getOffset(e+1):0,frozenHeight:l>0?t.getOffset(l+1):0}}function fy(l,e,t,r){const o=t?t.findIndex(e-oe):Math.floor(e/oe),i=r?r.findIndex(l-ue):Math.floor((l+ue)/at);return{r:o,c:i}}function dy(l,e,t,r,o,i){const n=i.frozenCols>0&&l<ue+i.frozenWidth,s=i.frozenRows>0&&e<oe+i.frozenHeight,a=n?l-ue:l-ue-i.frozenWidth+o.getOffset(i.frozenCols+1)+t.left,c=s?e-oe:e-oe-i.frozenHeight+r.getOffset(i.frozenRows+1)+t.top,u=o.findIndex(a),h=r.findIndex(c);return{r:Math.max(1,h),c:Math.max(1,u)}}function Vi(l,e,t,r,o){const i=r.getOffset(l.c),n=t.getOffset(l.r),s=r.getSize(l.c),a=t.getSize(l.r),c=o.frozenCols>0&&l.c<=o.frozenCols,u=o.frozenRows>0&&l.r<=o.frozenRows,h=c?i+ue:i+ue-e.left-r.getOffset(o.frozenCols+1)+o.frozenWidth,f=u?n+oe:n+oe-e.top-t.getOffset(o.frozenRows+1)+o.frozenHeight;return{left:h,top:f,width:s,height:a}}class py{constructor(e="light"){k(this,"container");k(this,"input");k(this,"cellPositionHint");k(this,"theme");k(this,"boundHandleInput");k(this,"minWidth",at);k(this,"minHeight",oe);k(this,"maxWidth",1/0);k(this,"maxHeight",1/0);k(this,"composing",!1);this.theme=e,this.container=document.createElement("div"),this.container.style.position="absolute",this.container.style.left="-1000px",this.container.style.width=at+"px",this.container.style.height=oe+"px",this.container.style.zIndex="1",this.container.style.margin="0px",this.container.style.pointerEvents="none",this.input=document.createElement("div"),this.input.contentEditable="true",this.input.style.border="none",this.input.style.outline=`2px solid ${this.getThemeColor("activeCellColor")}`,this.input.style.fontFamily="Arial, sans-serif",this.input.style.fontSize=Tr+"px",this.input.style.fontWeight="normal",this.input.style.lineHeight=String(So),this.input.style.color=this.getThemeColor("cellTextColor"),this.input.style.backgroundColor=this.getThemeColor("cellBGColor"),this.input.style.whiteSpace="pre",this.input.style.overflow="hidden",this.container.appendChild(this.input),this.cellPositionHint=document.createElement("div"),this.cellPositionHint.style.position="absolute",this.cellPositionHint.style.right="4px",this.cellPositionHint.style.top="4px",this.cellPositionHint.style.padding="0 4px",this.cellPositionHint.style.borderRadius="3px",this.cellPositionHint.style.border=`1px solid ${this.getThemeColor("cellBorderColor")}`,this.cellPositionHint.style.backgroundColor=this.getThemeColor("headerBGColor"),this.cellPositionHint.style.color=this.getThemeColor("cellTextColor"),this.cellPositionHint.style.fontSize="10px",this.cellPositionHint.style.lineHeight="14px",this.cellPositionHint.style.fontFamily="Arial, sans-serif",this.cellPositionHint.style.pointerEvents="none",this.cellPositionHint.style.display="none",this.cellPositionHint.style.zIndex="2",this.container.appendChild(this.cellPositionHint),this.boundHandleInput=this.handleInput.bind(this),this.input.addEventListener("input",this.boundHandleInput),this.input.addEventListener("compositionstart",()=>{this.composing=!0}),this.input.addEventListener("compositionend",()=>{this.composing=!1,this.adjustSize()})}cleanup(){this.input.removeEventListener("input",this.boundHandleInput),this.container.remove()}getContainer(){return this.container}getInput(){return this.input}show(e,t,r="",o=!0,i,n,s,a){this.updateFrame(e,t,i??at,n??oe,s??1/0,a??1/0),this.input.innerText=r,this.renderInput(),this.adjustSize(),o&&(_r(this.input,{start:this.input.innerText.length,end:this.input.innerText.length}),this.input.focus())}hide(){this.container.style.left="-1000px",this.container.style.pointerEvents="none",this.setCellPositionHint(),this.input.innerText="",this.input.blur()}isShown(){return this.container.style.left!=="-1000px"}isFocused(){return document.activeElement===this.input}getValue(){return this.input.innerText}setValue(e){this.input.innerText=e,this.renderInput(),this.adjustSize()}hasFormula(){return this.input.innerText.startsWith("=")}updatePlacement(e,t,r=at,o=oe,i=1/0,n=1/0){this.updateFrame(e,t,r,o,i,n),this.adjustSize()}setCellPositionHint(e){if(!e){this.cellPositionHint.style.display="none",this.cellPositionHint.innerText="";return}this.cellPositionHint.innerText=e,this.cellPositionHint.style.display="block"}applyStyle(e){this.input.style.fontWeight=e!=null&&e.b?"bold":"normal",this.input.style.fontStyle=e!=null&&e.i?"italic":"normal";const t=[];e!=null&&e.u&&t.push("underline"),e!=null&&e.st&&t.push("line-through"),this.input.style.textDecoration=t.length?t.join(" "):"none",this.input.style.color=(e==null?void 0:e.tc)||this.getThemeColor("cellTextColor"),this.input.style.backgroundColor=(e==null?void 0:e.bg)||this.getThemeColor("cellBGColor"),this.input.style.textAlign=(e==null?void 0:e.al)||"left";const r=(e==null?void 0:e.va)||"top";this.container.style.display="flex",this.container.style.alignItems=r==="middle"?"center":r==="bottom"?"flex-end":"flex-start"}handleInput(){this.renderInput(),this.composing||this.adjustSize()}updateFrame(e,t,r,o,i,n){this.minWidth=r,this.minHeight=o,this.maxWidth=i,this.maxHeight=n,this.container.style.left=e+"px",this.container.style.top=t+"px",this.container.style.pointerEvents="auto"}adjustSize(){this.input.style.width=this.minWidth+"px",this.input.style.height=this.minHeight+"px";const e=Math.min(Math.max(this.minWidth,this.input.scrollWidth),this.maxWidth),t=Math.min(Math.max(this.minHeight,this.input.scrollHeight),this.maxHeight);this.container.style.width=e+"px",this.container.style.height=t+"px",this.input.style.width=e+"px",this.input.style.height=t+"px",this.input.style.overflowY=this.input.scrollHeight>this.maxHeight?"auto":"hidden"}renderInput(){const e=this.input.innerText;if(!e.startsWith("="))return;const t=Lr(e),r=[];let o=0;for(const n of t){if(n.type==="REFERENCE"){r.push(`<span style="color: ${vo(this.theme,o)}">${n.text}</span>`),o++;continue}if(n.type==="NUM"){r.push(`<span style="color: ${this.getThemeColor("tokens.NUM")}">${n.text}</span>`);continue}r.push(Fp(n.text))}const i=mr(this.input);this.input.innerHTML="="+r.join(""),i&&_r(this.input,i)}getThemeColor(e){return ve(this.theme,e)}}class xy{constructor(e="light"){k(this,"canvas");k(this,"theme");this.theme=e,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.zIndex="1",this.canvas.style.pointerEvents="none"}cleanup(){this.canvas.remove()}getContainer(){return this.canvas}render(e,t,r,o,i,n,s,a,c,u,h,f=Hn,d,p,y,x=!0,v){this.canvas.width=0,this.canvas.height=0;const m=this.canvas.getContext("2d"),g=window.devicePixelRatio||1;this.canvas.width=e.width*g,this.canvas.height=e.height*g,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",m.scale(g,g);const S=f.frozenRows>0||f.frozenCols>0,C=this.buildMergeRenderData(v),A=this.resolveAutofillSelectionRange(i,r,C);if(!S)this.renderActiveCellSimple(m,r,t,n,s,C),this.renderSelectionSimple(m,e,t,i,c,n,s),this.renderPeerCursorsSimple(m,e,o,t,n,s,C),this.renderFormulaRangesSimple(m,h,t,n,s),this.renderCopyRangeSimple(m,p,t,n,s);else{const b=this.buildQuadrants(e,t,f,n,s);this.renderSelectionFrozen(m,e,t,i,c,n,s,f,b);for(const R of b){m.save(),m.beginPath(),m.rect(R.x,R.y,R.width,R.height),m.clip();const w=this.toCellRect(r,{left:R.scrollLeft,top:R.scrollTop},n,s,C);m.strokeStyle=this.getThemeColor("activeCellColor"),m.lineWidth=2,m.strokeRect(w.left,w.top,w.width,w.height),m.restore()}for(const{clientID:R,presence:w}of o){if(!w.activeCell)continue;const P=Te(w.activeCell),M=Jf(this.theme,R);for(const D of b){m.save(),m.beginPath(),m.rect(D.x,D.y,D.width,D.height),m.clip();const U=this.toCellRect(P,{left:D.scrollLeft,top:D.scrollTop},n,s,C);U.left>=-U.width&&U.left<e.width&&U.top>=-U.height&&U.top<e.height&&(m.strokeStyle=M,m.lineWidth=2,m.strokeRect(U.left,U.top,U.width,U.height)),m.restore()}}if(h&&h.length>0)for(let R=0;R<h.length;R++){const w=h[R],P=vo(this.theme,R);for(const M of b){m.save(),m.beginPath(),m.rect(M.x,M.y,M.width,M.height),m.clip();const D={left:M.scrollLeft,top:M.scrollTop},U=qn(Le(w[0],D,n,s),Le(w[1],D,n,s));m.strokeStyle=P,m.lineWidth=2,m.strokeRect(U.left,U.top,U.width,U.height),m.fillStyle=P+"20",m.fillRect(U.left,U.top,U.width,U.height),m.restore()}}if(p)for(const R of b){m.save(),m.beginPath(),m.rect(R.x,R.y,R.width,R.height),m.clip();const w={left:R.scrollLeft,top:R.scrollTop};this.drawCopyRangeBorder(m,p,w,n,s),m.restore()}}y&&!Er(y,A)&&this.renderAutofillPreview(m,y,t,n,s,f),x&&this.renderAutofillHandle(m,A,c,t,n,s,f),a&&s&&n&&this.renderResizeHover(m,e,t,a,n,s,f),u&&s&&n&&this.renderDragMoveIndicator(m,e,t,u,n,s,f),d&&s&&n&&this.renderFreezeDragPreview(m,e,d,n,s)}buildQuadrants(e,t,r,o,i){const n=r.frozenWidth,s=r.frozenHeight,a=o?o.getOffset(r.frozenRows+1):0,c=i?i.getOffset(r.frozenCols+1):0,u=[];return u.push({x:ue+n,y:oe+s,width:e.width-ue-n,height:e.height-oe-s,scrollLeft:t.left+c-n,scrollTop:t.top+a-s}),r.frozenRows>0&&u.push({x:ue+n,y:oe,width:e.width-ue-n,height:s,scrollLeft:t.left+c-n,scrollTop:0}),r.frozenCols>0&&u.push({x:ue,y:oe+s,width:n,height:e.height-oe-s,scrollLeft:0,scrollTop:t.top+a-s}),r.frozenRows>0&&r.frozenCols>0&&u.push({x:ue,y:oe,width:n,height:s,scrollLeft:0,scrollTop:0}),u}renderActiveCellSimple(e,t,r,o,i,n){const s=this.toCellRect(t,r,o,i,n);e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=2,e.strokeRect(s.left,s.top,s.width,s.height)}renderSelectionSimple(e,t,r,o,i,n,s){if(i==="all")e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,oe,t.width-ue,t.height-oe);else if(o)if(i==="row"){const a=Le(o[0],r,n,s),c=Le(o[1],r,n,s),u=a.top,h=c.top+c.height-a.top;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,u,t.width-ue,h),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(ue,u,t.width-ue,h)}else if(i==="column"){const a=Le(o[0],r,n,s),c=Le(o[1],r,n,s),u=a.left,h=c.left+c.width-a.left;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(u,oe,h,t.height-oe),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(u,oe,h,t.height-oe)}else{const a=qn(Le(o[0],r,n,s),Le(o[1],r,n,s));e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(a.left,a.top,a.width,a.height),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(a.left,a.top,a.width,a.height)}}renderPeerCursorsSimple(e,t,r,o,i,n,s){for(const{clientID:a,presence:c}of r){if(!c.activeCell)continue;const u=Te(c.activeCell),h=this.toCellRect(u,o,i,n,s);if(h.left>=-h.width&&h.left<t.width&&h.top>=-h.height&&h.top<t.height){const f=Jf(this.theme,a);e.strokeStyle=f,e.lineWidth=2,e.strokeRect(h.left,h.top,h.width,h.height)}}}renderFormulaRangesSimple(e,t,r,o,i){if(!(!t||t.length===0))for(let n=0;n<t.length;n++){const s=t[n],a=qn(Le(s[0],r,o,i),Le(s[1],r,o,i)),c=vo(this.theme,n);e.strokeStyle=c,e.lineWidth=2,e.strokeRect(a.left,a.top,a.width,a.height),e.fillStyle=c+"20",e.fillRect(a.left,a.top,a.width,a.height)}}renderCopyRangeSimple(e,t,r,o,i){t&&this.drawCopyRangeBorder(e,t,r,o,i)}drawCopyRangeBorder(e,t,r,o,i){const n=qn(Le(t[0],r,o,i),Le(t[1],r,o,i));e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=2,e.setLineDash([5,3]),e.strokeRect(n.left,n.top,n.width,n.height),e.setLineDash([])}renderSelectionFrozen(e,t,r,o,i,n,s,a,c){if(i==="all"){e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,oe,t.width-ue,t.height-oe);return}if(o)for(const u of c){e.save(),e.beginPath(),e.rect(u.x,u.y,u.width,u.height),e.clip();const h={left:u.scrollLeft,top:u.scrollTop};if(i==="row"){const f=Le(o[0],h,n,s),d=Le(o[1],h,n,s),p=f.top,y=d.top+d.height-f.top;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(ue,p,t.width-ue,y),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(ue,p,t.width-ue,y)}else if(i==="column"){const f=Le(o[0],h,n,s),d=Le(o[1],h,n,s),p=f.left,y=d.left+d.width-f.left;e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(p,oe,y,t.height-oe),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(p,oe,y,t.height-oe)}else{const f=qn(Le(o[0],h,n,s),Le(o[1],h,n,s));e.fillStyle=this.getThemeColor("selectionBGColor"),e.fillRect(f.left,f.top,f.width,f.height),e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.strokeRect(f.left,f.top,f.width,f.height)}e.restore()}}renderResizeHover(e,t,r,o,i,n,s){if(e.strokeStyle=this.getThemeColor("resizeHandleColor"),e.lineWidth=2,o.axis==="column"){const c=s.frozenCols>0&&o.index<=s.frozenCols?0:r.left+n.getOffset(s.frozenCols+1)-s.frozenWidth,u=ue+n.getOffset(o.index)+n.getSize(o.index)-c;e.beginPath(),e.moveTo(u,0),e.lineTo(u,t.height),e.stroke()}else{const c=s.frozenRows>0&&o.index<=s.frozenRows?0:r.top+i.getOffset(s.frozenRows+1)-s.frozenHeight,u=oe+i.getOffset(o.index)+i.getSize(o.index)-c;e.beginPath(),e.moveTo(0,u),e.lineTo(t.width,u),e.stroke()}}renderDragMoveIndicator(e,t,r,o,i,n,s){if(e.strokeStyle=this.getThemeColor("dropIndicatorColor"),e.lineWidth=3,o.axis==="column"){const c=s.frozenCols>0&&o.dropIndex<=s.frozenCols?0:r.left+n.getOffset(s.frozenCols+1)-s.frozenWidth,u=ue+n.getOffset(o.dropIndex)-c;e.beginPath(),e.moveTo(u,0),e.lineTo(u,t.height),e.stroke()}else{const c=s.frozenRows>0&&o.dropIndex<=s.frozenRows?0:r.top+i.getOffset(s.frozenRows+1)-s.frozenHeight,u=oe+i.getOffset(o.dropIndex)-c;e.beginPath(),e.moveTo(0,u),e.lineTo(t.width,u),e.stroke()}}renderFreezeDragPreview(e,t,r,o,i){if(e.strokeStyle=this.getThemeColor("freezeLineColor"),e.lineWidth=2,r.axis==="row"){const n=r.targetIndex===0?oe:oe+o.getOffset(r.targetIndex+1);e.beginPath(),e.moveTo(0,n),e.lineTo(t.width,n),e.stroke()}else{const n=r.targetIndex===0?ue:ue+i.getOffset(r.targetIndex+1);e.beginPath(),e.moveTo(n,0),e.lineTo(n,t.height),e.stroke()}}toRangeRect(e,t,r,o,i=Hn){if(!r||!o)return;const n=i.frozenRows>0||i.frozenCols>0,s=n?Vi(e[0],t,r,o,i):Le(e[0],t,r,o),a=n?Vi(e[1],t,r,o,i):Le(e[1],t,r,o);return qn(s,a)}renderAutofillPreview(e,t,r,o,i,n=Hn){const s=this.toRangeRect(t,r,o,i,n);s&&(e.strokeStyle=this.getThemeColor("activeCellColor"),e.lineWidth=1,e.setLineDash([4,2]),e.strokeRect(s.left,s.top,s.width,s.height),e.setLineDash([]))}renderAutofillHandle(e,t,r,o,i,n,s=Hn){if(r!=="cell"||!t)return;const a=this.toRangeRect(t,o,i,n,s);if(!a)return;const c=8,u=a.left+a.width-c/2,h=a.top+a.height-c/2;e.fillStyle=this.getThemeColor("activeCellColor"),e.fillRect(u,h,c,c),e.strokeStyle=this.getThemeColor("cellBGColor"),e.lineWidth=1,e.strokeRect(u+.5,h+.5,c,c)}resolveAutofillSelectionRange(e,t,r){if(e)return[e[0],e[1]];const o=de(t),i=(r==null?void 0:r.coverToAnchor.get(o))||o,n=Te(i),s=r==null?void 0:r.anchors.get(i);return!s||s.rs===1&&s.cs===1?[n,n]:[n,{r:n.r+s.rs-1,c:n.c+s.cs-1}]}getThemeColor(e){return ve(this.theme,e)}buildMergeRenderData(e){if(!e||e.size===0)return;const t=new Map,r=new Map;for(const[o,i]of e){t.set(o,i);const n=Te(o);for(let s=n.r;s<n.r+i.rs;s++)for(let a=n.c;a<n.c+i.cs;a++){const c=de({r:s,c:a});c!==o&&r.set(c,o)}}return{anchors:t,coverToAnchor:r}}toCellRect(e,t,r,o,i){const n=de(e),s=(i==null?void 0:i.coverToAnchor.get(n))||n,a=Te(s),c=i==null?void 0:i.anchors.get(s),u=Le(a,t,r,o);if(!c||c.rs===1&&c.cs===1)return u;const h=Le({r:a.r+c.rs-1,c:a.c+c.cs-1},t,r,o);return{left:u.left,top:u.top,width:h.left+h.width-u.left,height:h.top+h.height-u.top}}}const uo=1e7;class my{constructor(e="light"){k(this,"container");k(this,"scrollContainer");k(this,"dummyContainer");k(this,"actualWidth",0);k(this,"actualHeight",0);this.createContainers()}createContainers(){this.container=document.createElement("div"),this.container.style.position="relative",this.container.style.width="100%",this.container.style.height=`calc(100% - ${Pp+Ip*2}px)`,this.scrollContainer=document.createElement("div"),this.scrollContainer.style.position="absolute",this.scrollContainer.style.overflow="auto",this.scrollContainer.style.width="100%",this.scrollContainer.style.height="100%",this.scrollContainer.style.zIndex="1",this.dummyContainer=document.createElement("div"),this.dummyContainer.style.margin="0px",this.dummyContainer.style.padding="0px",this.dummyContainer.style.pointerEvents="none",this.scrollContainer.appendChild(this.dummyContainer),this.container.appendChild(this.scrollContainer)}getContainer(){return this.container}getScrollContainer(){return this.scrollContainer}getDummyContainer(){return this.dummyContainer}updateDummySize(e,t){this.actualWidth=e,this.actualHeight=t;const r=Math.min(e,uo),o=Math.min(t,uo);this.dummyContainer.style.width=r+"px",this.dummyContainer.style.height=o+"px"}appendChild(e){this.container.appendChild(e)}getViewport(){return this.scrollContainer.getBoundingClientRect()}getScrollPosition(){const e=this.scrollContainer.scrollLeft,t=this.scrollContainer.scrollTop,r=this.scrollContainer.getBoundingClientRect();return{left:this.toLogical(e,this.actualWidth,r.width),top:this.toLogical(t,this.actualHeight,r.height)}}setScrollPosition(e){const t=this.scrollContainer.getBoundingClientRect();e.left!==void 0&&(this.scrollContainer.scrollLeft=this.toPhysical(e.left,this.actualWidth,t.width)),e.top!==void 0&&(this.scrollContainer.scrollTop=this.toPhysical(e.top,this.actualHeight,t.height))}scrollBy(e,t){const r=this.scrollContainer.getBoundingClientRect(),o=this.needsRemap(this.actualWidth,r.width)?e*this.physicalMax(this.actualWidth,r.width)/this.logicalMax(this.actualWidth,r.width):e,i=this.needsRemap(this.actualHeight,r.height)?t*this.physicalMax(this.actualHeight,r.height)/this.logicalMax(this.actualHeight,r.height):t;this.scrollContainer.scrollBy(o,i)}addEventListener(e,t,r){this.scrollContainer.addEventListener(e,t,r)}removeEventListener(e,t,r){this.scrollContainer.removeEventListener(e,t,r)}cleanup(){this.container.remove()}needsRemap(e,t){return e>uo&&t<e}cappedSize(e){return Math.min(e,uo)}physicalMax(e,t){return Math.max(0,this.cappedSize(e)-t)}logicalMax(e,t){return Math.max(0,e-t)}clamp(e,t,r){return r<=t?t:Math.min(r,Math.max(t,e))}toLogical(e,t,r){const o=this.logicalMax(t,r);if(!this.needsRemap(t,r))return this.clamp(e,0,o);const i=this.physicalMax(t,r);return i<=0||o<=0?0:this.clamp(e,0,i)*o/i}toPhysical(e,t,r){const o=this.logicalMax(t,r);if(!this.needsRemap(t,r))return this.clamp(e,0,o);if(o<=0)return 0;const i=this.physicalMax(t,r);return this.clamp(e,0,o)*i/o}}const gy="M4 6h16 M6 12h12 M9 18h6",Qn=class Qn{constructor(e="light"){k(this,"canvas");k(this,"theme");this.theme=e,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.pointerEvents="none"}getCanvas(){return this.canvas}render(e,t,r,o,i,n,s,a,c,u=Hn,h=null,f,d,p,y,x,v,m,g,S=null){this.canvas.width=0,this.canvas.height=0;const C=this.canvas.getContext("2d"),A=window.devicePixelRatio||1;this.canvas.width=e.width*A,this.canvas.height=e.height*A,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",C.scale(A,A);const[b,R]=r,w=this.buildMergeRenderData(v);if(!(u.frozenRows>0||u.frozenCols>0))this.renderQuadrantCells(C,b.r,R.r+1,b.c,R.c+1,i,t,n,s,f,d,p,y,x,w,m,g,S),this.renderColumnHeaders(C,b.c,R.c,t.left,ue,e.width,o,a,c,n,s),this.renderRowHeaders(C,b.r,R.r,t.top,oe,e.height,o,a,c,n,s);else{const D=u.frozenWidth,U=u.frozenHeight,J=u.frozenRows,te=u.frozenCols,le=J+1,ge=te+1,ce=Math.max(le,b.r),ee=Math.max(ge,b.c),G=n?n.getOffset(le):J*oe,Q=s?s.getOffset(ge):te*at;C.save(),C.beginPath(),C.rect(ue+D,oe+U,e.width-ue-D,e.height-oe-U),C.clip(),this.renderQuadrantCells(C,ce,R.r+1,ee,R.c+1,i,{left:t.left+Q-D,top:t.top+G-U},n,s,f,d,p,y,x,w,m,g,S),C.restore(),J>0&&(C.save(),C.beginPath(),C.rect(ue+D,oe,e.width-ue-D,U),C.clip(),this.renderQuadrantCells(C,1,J+1,ee,R.c+1,i,{left:t.left+Q-D,top:0},n,s,f,d,p,y,x,w,m,g,S),C.restore()),te>0&&(C.save(),C.beginPath(),C.rect(ue,oe+U,D,e.height-oe-U),C.clip(),this.renderQuadrantCells(C,ce,R.r+1,1,te+1,i,{left:0,top:t.top+G-U},n,s,f,d,p,y,x,w,m,g,S),C.restore()),J>0&&te>0&&(C.save(),C.beginPath(),C.rect(ue,oe,D,U),C.clip(),this.renderQuadrantCells(C,1,J+1,1,te+1,i,{left:0,top:0},n,s,f,d,p,y,x,w,m,g,S),C.restore()),te>0&&this.renderColumnHeaders(C,1,te,0,ue,ue+D,o,a,c,n,s),this.renderColumnHeaders(C,ee,R.c,t.left+Q-D,ue+D,e.width,o,a,c,n,s),J>0&&this.renderRowHeaders(C,1,J,0,oe,oe+U,o,a,c,n,s),this.renderRowHeaders(C,ce,R.r,t.top+G-U,oe+U,e.height,o,a,c,n,s),this.renderFreezeLines(C,e,D,U)}const M=a==="all";C.fillStyle=M?this.getThemeColor("headerSelectedBGColor"):this.getThemeColor("headerBGColor"),C.fillRect(0,0,ue,oe),C.strokeStyle=this.getThemeColor("cellBorderColor"),C.lineWidth=ba,C.strokeRect(0,0,ue,oe),this.renderFreezeHandles(C,u,h)}renderQuadrantCells(e,t,r,o,i,n,s,a,c,u,h,f,d,p,y,x,v,m=null){const g=new Map,S=(A,b,R)=>{const w=de({r:A,c:b});if(g.has(w))return g.get(w)||void 0;const P=this.resolveEffectiveStyle(A,b,R,f,u,h,d,p);return g.set(w,P||null),P},C=this.buildTextOverflowRenderData(e,t,r,o,i,n,c,y,S);for(let A=t;A<=r;A++)for(let b=o;b<=i;b++){const R=de({r:A,c:b});if(y!=null&&y.coverToAnchor.has(R))continue;const w=n==null?void 0:n.get(de({r:A,c:b})),P=y==null?void 0:y.anchors.get(R),M=S(A,b,w),D=C==null?void 0:C.hiddenVerticalBoundaries.has(this.verticalBoundaryKey(A,b-1)),U=C==null?void 0:C.hiddenVerticalBoundaries.has(this.verticalBoundaryKey(A,b));this.renderCellBackground(e,{r:A,c:b},w,s,a,c,M,P,D,U)}for(let A=t;A<=r;A++)for(let b=o;b<=i;b++){const R=de({r:A,c:b});if(y!=null&&y.coverToAnchor.has(R))continue;const w=n==null?void 0:n.get(de({r:A,c:b})),P=y==null?void 0:y.anchors.get(R),M=S(A,b,w);this.renderCellCustomBorders(e,{r:A,c:b},s,a,c,M,P)}for(let A=t;A<=r;A++)for(let b=o;b<=i;b++){const R=de({r:A,c:b});if(y!=null&&y.coverToAnchor.has(R))continue;const w=n==null?void 0:n.get(de({r:A,c:b})),P=y==null?void 0:y.anchors.get(R),M=S(A,b,w),D=C==null?void 0:C.anchorToEndCol.get(R);this.renderCellContent(e,{r:A,c:b},w,s,a,c,M,n,i,P,D)}if(x){const A=x[0].r;if(A>=t&&A<=r){const b=Math.max(o,x[0].c),R=Math.min(i,x[1].c);for(let w=b;w<=R;w++){const P=de({r:A,c:w});if(y!=null&&y.coverToAnchor.has(P))continue;const M=y==null?void 0:y.anchors.get(P);this.renderCellFilterButton(e,{r:A,c:w},s,a,c,M,!!(v!=null&&v.has(w)),m===w)}}}}renderColumnHeaders(e,t,r,o,i,n,s,a,c,u,h){e.save(),e.beginPath(),e.rect(i,0,n-i,oe),e.clip();for(let f=t;f<=r;f++){const d=h?h.getOffset(f):at*(f-1),p=h?h.getSize(f):at,y=ue+d-o,x=0,v=a==="all"||a==="column"&&c&&f>=c[0].c&&f<=c[1].c;this.renderHeader(e,y,x,p,oe,ti(f),s.c===f,v||!1)}e.restore()}renderCellFilterButton(e,t,r,o,i,n,s=!1,a=!1){const c=this.toCellRect(t,r,o,i,n),u=c.width,h=c.height;if(u<=6||h<=6)return;const f=Math.min(16,Math.max(12,u-4)),d=Math.min(16,Math.max(12,h-6)),p=c.left+u-f-2,y=c.top+Math.max(3,(h-d)/2);(s||a)&&(e.fillStyle=s?this.getThemeColor("selectionBGColor"):this.getThemeColor("headerSelectedBGColor"),e.fillRect(p,y,f,d));const x=s||a?this.getThemeColor("resizeHandleColor"):this.getThemeColor("cellTextColor"),v=Math.max(9,Math.min(12,Math.min(f,d)-3)),m=p+(f-v)/2,g=y+(d-v)/2;e.save(),e.translate(m,g),e.scale(v/24,v/24),e.strokeStyle=x,e.lineCap="round",e.lineJoin="round";const S=this.getFilterIconPath2D();S?(e.lineWidth=2,e.stroke(S)):(e.lineWidth=2,e.beginPath(),e.moveTo(4,6),e.lineTo(20,6),e.moveTo(6,12),e.lineTo(18,12),e.moveTo(9,18),e.lineTo(15,18),e.stroke()),e.restore()}getFilterIconPath2D(){return typeof Path2D>"u"?null:(Qn.filterIconPath2D===void 0&&(Qn.filterIconPath2D=new Path2D(gy)),Qn.filterIconPath2D)}renderRowHeaders(e,t,r,o,i,n,s,a,c,u,h){e.save(),e.beginPath(),e.rect(0,i,ue,n-i),e.clip();for(let f=t;f<=r;f++){const d=u?u.getOffset(f):oe*(f-1),p=u?u.getSize(f):oe;if(p<=0)continue;const y=0,x=d+oe-o,v=a==="all"||a==="row"&&c&&f>=c[0].r&&f<=c[1].r;this.renderHeader(e,y,x,ue,p,String(f),s.r===f,v||!1)}e.restore()}renderFreezeLines(e,t,r,o){if(e.strokeStyle=this.getThemeColor("freezeLineColor"),e.lineWidth=2,o>0){const i=oe+o;e.beginPath(),e.moveTo(0,i),e.lineTo(t.width,i),e.stroke()}if(r>0){const i=ue+r;e.beginPath(),e.moveTo(i,0),e.lineTo(i,t.height),e.stroke()}}renderFreezeHandles(e,t,r){const o=t.frozenRows>0||t.frozenCols>0,i=Dp,n=o&&t.frozenRows>0?oe+t.frozenHeight-i/2:oe-i,s=r==="row";e.fillStyle=s?this.getThemeColor("freezeHandleHoverColor"):this.getThemeColor("freezeHandleColor"),e.fillRect(0,n,ue,i);const a=o&&t.frozenCols>0?ue+t.frozenWidth-i/2:ue-i,c=r==="column";e.fillStyle=c?this.getThemeColor("freezeHandleHoverColor"):this.getThemeColor("freezeHandleColor"),e.fillRect(a,0,i,oe)}renderHeader(e,t,r,o,i,n,s,a=!1){o<=0||i<=0||(e.fillStyle=a?this.getThemeColor("headerSelectedBGColor"):s?this.getThemeColor("headerActiveBGColor"):this.getThemeColor("headerBGColor"),e.fillRect(t,r,o,i),e.strokeStyle=this.getThemeColor("cellBorderColor"),e.lineWidth=ba,e.strokeRect(t,r,o,i),e.fillStyle=this.getThemeColor("cellTextColor"),e.textAlign=uy,e.font=s||a?"bold 10px Arial":"10px Arial",e.fillText(n,t+o/2,r+Math.min(15,i-4)))}renderCellBackground(e,t,r,o,i,n,s,a,c=!1,u=!1){const h=this.toCellRect(t,o,i,n,a),f=s??(r==null?void 0:r.s);if(e.fillStyle=(f==null?void 0:f.bg)||this.getThemeColor("cellBGColor"),e.fillRect(h.left,h.top,h.width,h.height),e.beginPath(),e.strokeStyle=this.getThemeColor("cellBorderColor"),e.lineWidth=ba,c||(e.moveTo(h.left,h.top),e.lineTo(h.left,h.top+h.height)),!u){const d=h.left+h.width;e.moveTo(d,h.top),e.lineTo(d,h.top+h.height)}e.moveTo(h.left,h.top),e.lineTo(h.left+h.width,h.top),e.moveTo(h.left,h.top+h.height),e.lineTo(h.left+h.width,h.top+h.height),e.stroke()}renderCellCustomBorders(e,t,r,o,i,n,s){if(!n||!n.bt&&!n.br&&!n.bb&&!n.bl)return;const a=this.toCellRect(t,r,o,i,s);if(e.beginPath(),e.strokeStyle=this.getThemeColor("customBorderColor"),e.lineWidth=ly,n.bt&&(e.moveTo(a.left,a.top),e.lineTo(a.left+a.width,a.top)),n.br){const c=a.left+a.width;e.moveTo(c,a.top),e.lineTo(c,a.top+a.height)}if(n.bb){const c=a.top+a.height;e.moveTo(a.left,c),e.lineTo(a.left+a.width,c)}n.bl&&(e.moveTo(a.left,a.top),e.lineTo(a.left,a.top+a.height)),e.stroke()}renderCellContent(e,t,r,o,i,n,s,a,c,u,h){const f=this.toCellRect(t,o,i,n,u),d=s??(r==null?void 0:r.s),p=(r==null?void 0:r.v)||"";if(p){const y=Ma(p,d==null?void 0:d.nf,d==null?void 0:d.dp),x=y.split(`
`),v=this.toCellFont(d);let m=f.width;const g=(d==null?void 0:d.al)||"left";if(!u&&h&&n&&h>t.c){let R=0;for(let w=t.c+1;w<=h;w++)R+=n.getSize(w);m=f.width+R}else if(!u&&x.length===1&&g==="left"&&a&&n&&c){e.save(),e.font=v;const R=e.measureText(y).width+lo*2;if(e.restore(),R>f.width){let w=0;for(let P=t.c+1;P<=c;P++){const M=a.get(de({r:t.r,c:P}));if(M&&(M.v||M.f))break;const D=n.getSize(P);if(w+=D,f.width+w>=R)break}m=f.width+w}}e.save(),e.beginPath(),e.rect(f.left,f.top,m,f.height),e.clip(),e.fillStyle=(d==null?void 0:d.tc)||this.getThemeColor("cellTextColor"),e.font=v,e.textBaseline="top";let S;g==="center"?(e.textAlign="center",S=f.left+f.width/2):g==="right"?(e.textAlign="right",S=f.left+f.width-lo):(e.textAlign="left",S=f.left+lo);const C=(d==null?void 0:d.va)||"top",A=x.length*Tr*So;let b;C==="middle"?b=f.top+(f.height-A)/2:C==="bottom"?b=f.top+f.height-A-ka:b=f.top+ka;for(let R=0;R<x.length;R++){const w=b+R*(Tr*So);if(e.fillText(x[R],S,w),d!=null&&d.u){const P=e.measureText(x[R]),M=w+Tr+1;let D;g==="center"?D=S-P.width/2:g==="right"?D=S-P.width:D=S,e.beginPath(),e.strokeStyle=(d==null?void 0:d.tc)||this.getThemeColor("cellTextColor"),e.lineWidth=1,e.moveTo(D,M),e.lineTo(D+P.width,M),e.stroke()}if(d!=null&&d.st){const P=e.measureText(x[R]),M=w+Tr/2;let D;g==="center"?D=S-P.width/2:g==="right"?D=S-P.width:D=S,e.beginPath(),e.strokeStyle=(d==null?void 0:d.tc)||this.getThemeColor("cellTextColor"),e.lineWidth=1,e.moveTo(D,M),e.lineTo(D+P.width,M),e.stroke()}}e.restore()}}buildTextOverflowRenderData(e,t,r,o,i,n,s,a,c){if(!n||!s)return;const u=new Map,h=new Set;e.save();for(let f=t;f<=r;f++)for(let d=o;d<=i;d++){const p=de({r:f,c:d});if(a!=null&&a.coverToAnchor.has(p)||a!=null&&a.anchors.has(p))continue;const y=n.get(p),x=(y==null?void 0:y.v)||"";if(!x)continue;const v=c==null?void 0:c(f,d,y);if(((v==null?void 0:v.al)||"left")!=="left")continue;const g=Ma(x,v==null?void 0:v.nf,v==null?void 0:v.dp);if(g.split(`
`).length!==1)continue;const C=s.getSize(d);e.font=this.toCellFont(v);const A=e.measureText(g).width+lo*2;if(A<=C)continue;let b=C,R=d;for(let w=d+1;w<=i;w++){const P=c==null?void 0:c(f,w-1,n.get(de({r:f,c:w-1}))),M=c==null?void 0:c(f,w,n.get(de({r:f,c:w})));if(P!=null&&P.br||M!=null&&M.bl)break;const D=de({r:f,c:w});if(a!=null&&a.coverToAnchor.has(D)||a!=null&&a.anchors.has(D))break;const U=n.get(D);if(U&&(U.v||U.f)||(b+=s.getSize(w),R=w,b>=A))break}if(R>d){u.set(p,R);for(let w=d;w<R;w++)h.add(this.verticalBoundaryKey(f,w))}}if(e.restore(),u.size!==0)return{anchorToEndCol:u,hiddenVerticalBoundaries:h}}resolveEffectiveStyle(e,t,r,o,i,n,s,a){const c=i==null?void 0:i.get(t),u=n==null?void 0:n.get(e),h=s?Tp(s,e,t):void 0,f=a?Rg(a,e,t,r):void 0;if(!(!o&&!c&&!u&&!h&&!(r!=null&&r.s)&&!f))return{...o,...c,...u,...h,...r==null?void 0:r.s,...f}}buildMergeRenderData(e){if(!e||e.size===0)return;const t=new Map,r=new Map;for(const[o,i]of e){t.set(o,i);const n=Te(o);for(let s=n.r;s<n.r+i.rs;s++)for(let a=n.c;a<n.c+i.cs;a++){const c=de({r:s,c:a});c!==o&&r.set(c,o)}}return{anchors:t,coverToAnchor:r}}toCellRect(e,t,r,o,i){const n=Le(e,t,r,o);if(!i||i.rs===1&&i.cs===1)return n;const s=Le({r:e.r+i.rs-1,c:e.c+i.cs-1},t,r,o);return{left:n.left,top:n.top,width:s.left+s.width-n.left,height:s.top+s.height-n.top}}toCellFont(e){const t=[];return e!=null&&e.b&&t.push("bold"),e!=null&&e.i&&t.push("italic"),t.push(`${Tr}px Arial`),t.join(" ")}verticalBoundaryKey(e,t){return`${e}:${t}`}getThemeColor(e){return ve(this.theme,e)}cleanup(){this.canvas.remove()}};k(Qn,"filterIconPath2D");let za=Qn;class yy{constructor(e="light"){k(this,"container");k(this,"theme");this.theme=e,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.display="none",this.container.style.zIndex="1000",this.container.style.minWidth="160px",this.container.style.borderRadius="4px",this.container.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)",this.container.style.padding="4px 0",this.container.style.fontSize="13px",this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.applyTheme(),this.handleDocumentClick=this.handleDocumentClick.bind(this)}getContainer(){return this.container}show(e,t,r){this.container.innerHTML="";for(const o of r){const i=document.createElement("div");i.textContent=o.label,i.style.padding="6px 16px",i.style.cursor="pointer",i.style.color=ve(this.theme,"cellTextColor"),i.addEventListener("mouseenter",()=>{i.style.backgroundColor=ve(this.theme,"selectionBGColor")}),i.addEventListener("mouseleave",()=>{i.style.backgroundColor="transparent"}),i.addEventListener("mousedown",n=>{n.preventDefault(),n.stopPropagation(),this.hide(),o.action()}),this.container.appendChild(i)}this.container.style.left=`${e}px`,this.container.style.top=`${t}px`,this.container.style.display="block",document.addEventListener("mousedown",this.handleDocumentClick)}hide(){this.container.style.display="none",document.removeEventListener("mousedown",this.handleDocumentClick)}cleanup(){this.hide(),this.container.remove()}handleDocumentClick(e){this.container.contains(e.target)||this.hide()}applyTheme(){this.container.style.backgroundColor=ve(this.theme,"cellBGColor"),this.container.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`}}const Wi=[{name:"SUM",description:"Returns the sum of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"ABS",description:"Returns the absolute value of a number",args:[{name:"number"}]},{name:"ROUND",description:"Rounds a number to a certain number of decimal places",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDUP",description:"Rounds a number away from zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDDOWN",description:"Rounds a number toward zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"INT",description:"Rounds a number down to the nearest integer",args:[{name:"value"}]},{name:"MOD",description:"Returns the remainder after division",args:[{name:"dividend"},{name:"divisor"}]},{name:"SQRT",description:"Returns the positive square root of a number",args:[{name:"value"}]},{name:"POWER",description:"Returns a number raised to a power",args:[{name:"base"},{name:"exponent"}]},{name:"PRODUCT",description:"Multiplies a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MEDIAN",description:"Returns the middle number in a series",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"IF",description:"Returns one value if true and another if false",args:[{name:"condition"},{name:"value_if_true"},{name:"value_if_false",optional:!0}]},{name:"IFS",description:"Returns the first value whose condition is true",args:[{name:"condition1"},{name:"value1"},{name:"condition2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0}]},{name:"SWITCH",description:"Matches an expression against case/value pairs",args:[{name:"expression"},{name:"case1"},{name:"value1"},{name:"case2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0},{name:"default",optional:!0}]},{name:"AND",description:"Returns TRUE if all arguments are true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"OR",description:"Returns TRUE if any argument is true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"NOT",description:"Returns the opposite of a logical value",args:[{name:"logical"}]},{name:"AVERAGE",description:"Returns the average of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MIN",description:"Returns the smallest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MAX",description:"Returns the largest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"COUNT",description:"Counts the number of numeric values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTA",description:"Counts the number of non-empty values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTBLANK",description:"Counts empty cells",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTIF",description:"Counts values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"}]},{name:"SUMIF",description:"Sums values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"},{name:"sum_range",optional:!0}]},{name:"COUNTIFS",description:"Counts values that meet multiple criteria",args:[{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"SUMIFS",description:"Sums values that meet multiple criteria",args:[{name:"sum_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"TRIM",description:"Removes leading and trailing whitespace from text",args:[{name:"text"}]},{name:"LEN",description:"Returns the number of characters in a text string",args:[{name:"text"}]},{name:"LEFT",description:"Returns the leftmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"RIGHT",description:"Returns the rightmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"MID",description:"Returns characters from the middle of a text string",args:[{name:"text"},{name:"start_num"},{name:"num_chars"}]},{name:"CONCATENATE",description:"Joins two or more text strings into one",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"CONCAT",description:"Joins text values into one string",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"FIND",description:"Finds one text value inside another (case-sensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"SEARCH",description:"Finds one text value inside another (case-insensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"TEXTJOIN",description:"Joins text values with a delimiter",args:[{name:"delimiter"},{name:"ignore_empty"},{name:"text1"},{name:"text2",optional:!0,repeating:!0}]},{name:"LOWER",description:"Converts text to lowercase",args:[{name:"text"}]},{name:"UPPER",description:"Converts text to uppercase",args:[{name:"text"}]},{name:"PROPER",description:"Capitalizes each word in text",args:[{name:"text"}]},{name:"SUBSTITUTE",description:"Replaces existing text with new text in a string",args:[{name:"text"},{name:"search_for"},{name:"replace_with"},{name:"occurrence",optional:!0}]},{name:"TODAY",description:"Returns the current date",args:[]},{name:"NOW",description:"Returns the current date and time",args:[]},{name:"YEAR",description:"Returns the year from a date",args:[{name:"date"}]},{name:"MONTH",description:"Returns the month from a date (1-12)",args:[{name:"date"}]},{name:"DAY",description:"Returns the day of the month from a date (1-31)",args:[{name:"date"}]},{name:"ISBLANK",description:"Checks whether a value is blank",args:[{name:"value"}]},{name:"ISNUMBER",description:"Checks whether a value is a number",args:[{name:"value"}]},{name:"ISTEXT",description:"Checks whether a value is text",args:[{name:"value"}]},{name:"IFERROR",description:"Returns a value if no error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_error"}]}];function vy(l){const e=l.toUpperCase();return Wi.filter(t=>t.name.startsWith(e))}function Sy(l){const e=l.toUpperCase();return Wi.find(t=>t.name===e)}function ja(l){const e=l.args.map(t=>{let r=t.optional?`[${t.name}]`:t.name;return t.repeating&&(r+=", ..."),r});return`${l.name}(${e.join(", ")})`}function Ay(l,e){if(!l.startsWith("="))return{type:"none"};const t=l.slice(1,e);let r=0,o=0;for(let n=t.length-1;n>=0;n--){const s=t[n];if(s===")")r++;else if(s==="(")if(r>0)r--;else{const a=t.slice(0,n).match(/([A-Za-z_]\w*)$/);return a?{type:"argument",funcName:a[1].toUpperCase(),argIndex:o}:{type:"none"}}else s===","&&r===0&&o++}const i=t.match(/([A-Za-z_]\w*)$/);return i?{type:"function-name",prefix:i[1]}:{type:"none"}}class Cy{constructor(e="light"){k(this,"container");k(this,"theme");k(this,"selectedIndex",0);k(this,"matches",[]);k(this,"mode","hidden");k(this,"currentHint",null);this.theme=e,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.display="none",this.container.style.zIndex="1000",this.container.style.minWidth="220px",this.container.style.maxWidth="360px",this.container.style.borderRadius="4px",this.container.style.boxShadow="0 2px 8px rgba(0,0,0,0.2)",this.container.style.padding="4px 0",this.container.style.fontSize="13px",this.container.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.container.style.overflow="hidden",this.applyTheme()}getContainer(){return this.container}showList(e,t){if(this.matches=vy(e),this.matches.length===0){this.hide();return}this.mode="list",this.selectedIndex=0,this.renderList(),this.positionAt(t),this.container.style.display="block"}showHint(e,t,r){const o=Sy(e);if(!o){this.hide();return}this.mode="hint",this.currentHint={info:o,argIndex:t},this.renderHint(),this.positionAt(r),this.container.style.display="block"}hide(){this.mode="hidden",this.matches=[],this.currentHint=null,this.container.style.display="none",this.container.innerHTML=""}reposition(e){this.mode!=="hidden"&&this.positionAt(e)}moveUp(){this.mode!=="list"||this.matches.length===0||(this.selectedIndex=(this.selectedIndex-1+this.matches.length)%this.matches.length,this.renderList())}moveDown(){this.mode!=="list"||this.matches.length===0||(this.selectedIndex=(this.selectedIndex+1)%this.matches.length,this.renderList())}getSelectedFunction(){if(this.mode==="list")return this.matches[this.selectedIndex]}isListVisible(){return this.mode==="list"}isHintVisible(){return this.mode==="hint"}cleanup(){this.hide(),this.container.remove()}positionAt(e){this.container.style.left=`${e.left}px`,this.container.style.top=`${e.top}px`}renderList(){this.container.innerHTML="";const e=ve(this.theme,"cellBGColor"),t=ve(this.theme,"cellTextColor"),r=ve(this.theme,"selectionBGColor"),o=ve(this.theme,"activeCellColor");for(let i=0;i<this.matches.length;i++){const n=this.matches[i],s=document.createElement("div");s.style.padding="4px 10px",s.style.cursor="pointer",s.style.display="flex",s.style.flexDirection="column",s.style.gap="1px",s.style.backgroundColor=i===this.selectedIndex?r:e;const a=document.createElement("div");a.style.fontWeight="600",a.style.color=i===this.selectedIndex?o:t,a.textContent=n.name;const c=document.createElement("div");c.style.fontSize="11px",c.style.opacity="0.7",c.style.color=t,c.textContent=n.description,s.appendChild(a),s.appendChild(c),s.addEventListener("mouseenter",()=>{this.selectedIndex=i,this.renderList()}),s.addEventListener("mousedown",u=>{u.preventDefault(),u.stopPropagation()}),this.container.appendChild(s)}}renderHint(){if(this.container.innerHTML="",!this.currentHint)return;const{info:e,argIndex:t}=this.currentHint,r=ve(this.theme,"cellTextColor"),o=ve(this.theme,"activeCellColor"),i=document.createElement("div");i.style.padding="6px 10px",i.style.color=r,i.style.whiteSpace="nowrap";const n=document.createElement("span");n.style.fontWeight="600",n.textContent=e.name+"(",i.appendChild(n);for(let a=0;a<e.args.length;a++){a>0&&i.appendChild(document.createTextNode(", "));const c=e.args[a];let u=c.optional?`[${c.name}]`:c.name;c.repeating&&(u+=", ...");const h=document.createElement("span");(a===t||a===e.args.length-1&&c.repeating&&t>=a)&&(h.style.fontWeight="700",h.style.color=o),h.textContent=u,i.appendChild(h)}i.appendChild(document.createTextNode(")"));const s=document.createElement("div");s.style.fontSize="11px",s.style.opacity="0.7",s.style.color=r,s.style.padding="2px 10px 4px",s.textContent=ja(e)+"  "+e.description,this.container.appendChild(i),this.container.appendChild(s)}applyTheme(){this.container.style.backgroundColor=ve(this.theme,"cellBGColor"),this.container.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`}}class Ey{constructor(e="light"){k(this,"theme");k(this,"container");k(this,"panel");k(this,"searchInput");k(this,"status");k(this,"list");k(this,"rows",[]);k(this,"matches",[...Wi]);k(this,"selectedIndex",0);k(this,"listTextColor","");k(this,"listSelectedBG","");k(this,"listActiveColor","");k(this,"onInsert");k(this,"onClose");k(this,"boundHandleBackdropMouseDown");k(this,"boundHandleSearchInput");k(this,"boundHandleSearchKeydown");k(this,"boundHandleListPointerDown");k(this,"boundHandleListClick");k(this,"boundHandleListMouseOver");this.theme=e,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.inset="0",this.container.style.display="none",this.container.style.zIndex="1100",this.container.style.backgroundColor="rgba(0, 0, 0, 0.18)",this.container.style.padding="40px 16px 16px",this.container.style.boxSizing="border-box",this.panel=document.createElement("div"),this.panel.style.margin="0 auto",this.panel.style.maxWidth="720px",this.panel.style.height="min(560px, calc(100vh - 72px))",this.panel.style.display="flex",this.panel.style.flexDirection="column",this.panel.style.backgroundColor=ve(this.theme,"cellBGColor"),this.panel.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.panel.style.borderRadius="8px",this.panel.style.boxShadow="0 10px 30px rgba(0, 0, 0, 0.2)",this.panel.style.color=ve(this.theme,"cellTextColor"),this.panel.style.overflow="hidden";const t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between",t.style.padding="12px 14px",t.style.borderBottom=`1px solid ${ve(this.theme,"cellBorderColor")}`;const r=document.createElement("div");r.textContent="Functions",r.style.font="600 14px Arial",t.appendChild(r);const o=document.createElement("button");o.type="button",o.textContent="Close",o.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`,o.style.borderRadius="4px",o.style.backgroundColor=ve(this.theme,"cellBGColor"),o.style.color=ve(this.theme,"cellTextColor"),o.style.padding="4px 8px",o.style.font="12px Arial",o.style.cursor="pointer",o.addEventListener("click",()=>this.hide()),t.appendChild(o);const i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="6px",i.style.padding="12px 14px 10px",i.style.borderBottom=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.searchInput=document.createElement("input"),this.searchInput.type="text",this.searchInput.placeholder="Search by name or description",this.searchInput.style.width="100%",this.searchInput.style.boxSizing="border-box",this.searchInput.style.padding="7px 10px",this.searchInput.style.border=`1px solid ${ve(this.theme,"cellBorderColor")}`,this.searchInput.style.borderRadius="4px",this.searchInput.style.outline="none",this.searchInput.style.font="13px Arial",this.searchInput.style.color=ve(this.theme,"cellTextColor"),this.searchInput.style.backgroundColor=ve(this.theme,"cellBGColor"),i.appendChild(this.searchInput),this.status=document.createElement("div"),this.status.style.font="12px Arial",this.status.style.opacity="0.75",i.appendChild(this.status),this.list=document.createElement("div"),this.list.style.flex="1",this.list.style.overflow="auto",this.list.style.padding="6px 0",this.panel.appendChild(t),this.panel.appendChild(i),this.panel.appendChild(this.list),this.container.appendChild(this.panel),this.boundHandleBackdropMouseDown=n=>{n.target===this.container&&this.hide()},this.boundHandleSearchInput=()=>{this.selectedIndex=0,this.filterAndRender()},this.boundHandleSearchKeydown=n=>{if(n.key==="ArrowDown"){n.preventDefault(),this.matches.length>0&&(this.setSelectedIndex((this.selectedIndex+1)%this.matches.length),this.scrollSelectedIntoView());return}if(n.key==="ArrowUp"){n.preventDefault(),this.matches.length>0&&(this.setSelectedIndex((this.selectedIndex-1+this.matches.length)%this.matches.length),this.scrollSelectedIntoView());return}if(n.key==="Enter"){n.preventDefault(),this.insertSelected();return}n.key==="Escape"&&(n.preventDefault(),this.hide())},this.boundHandleListPointerDown=n=>{if(n.button!==0)return;const s=this.getRowIndexFromTarget(n.target);s!==null&&(n.preventDefault(),this.setSelectedIndex(s),this.insertSelected())},this.boundHandleListClick=n=>{if(n.button!==0||!this.isVisible())return;const s=this.getRowIndexFromTarget(n.target);s!==null&&(n.preventDefault(),this.setSelectedIndex(s),this.insertSelected())},this.boundHandleListMouseOver=n=>{const s=this.getRowIndexFromTarget(n.target);s===null||s===this.selectedIndex||this.setSelectedIndex(s)},this.container.addEventListener("mousedown",this.boundHandleBackdropMouseDown),this.searchInput.addEventListener("input",this.boundHandleSearchInput),this.searchInput.addEventListener("keydown",this.boundHandleSearchKeydown),this.list.addEventListener("pointerdown",this.boundHandleListPointerDown),this.list.addEventListener("click",this.boundHandleListClick),this.list.addEventListener("mouseover",this.boundHandleListMouseOver),this.filterAndRender()}getContainer(){return this.container}setOnInsert(e){this.onInsert=e}setOnClose(e){this.onClose=e}contains(e){return e instanceof Node&&this.container.contains(e)}isVisible(){return this.container.style.display!=="none"}show(){this.searchInput.value="",this.selectedIndex=0,this.filterAndRender(),this.container.style.display="block",requestAnimationFrame(()=>this.searchInput.focus())}hide(){var e;this.isVisible()&&(this.container.style.display="none",(e=this.onClose)==null||e.call(this))}cleanup(){this.container.removeEventListener("mousedown",this.boundHandleBackdropMouseDown),this.searchInput.removeEventListener("input",this.boundHandleSearchInput),this.searchInput.removeEventListener("keydown",this.boundHandleSearchKeydown),this.list.removeEventListener("pointerdown",this.boundHandleListPointerDown),this.list.removeEventListener("click",this.boundHandleListClick),this.list.removeEventListener("mouseover",this.boundHandleListMouseOver),this.container.remove()}filterAndRender(){const e=this.searchInput.value.trim().toUpperCase();this.matches=e.length===0?[...Wi]:Wi.filter(t=>{const r=t.name.toUpperCase(),o=t.description.toUpperCase(),i=ja(t).toUpperCase();return r.includes(e)||o.includes(e)||i.includes(e)}),this.selectedIndex>=this.matches.length&&(this.selectedIndex=Math.max(0,this.matches.length-1)),this.renderList()}renderList(){if(this.list.innerHTML="",this.rows=[],this.status.textContent=`${this.matches.length} functions`,this.matches.length===0){const t=document.createElement("div");t.textContent="No matching functions",t.style.padding="16px 14px",t.style.font="13px Arial",t.style.opacity="0.8",this.list.appendChild(t);return}const e=ve(this.theme,"cellBorderColor");this.listTextColor=ve(this.theme,"cellTextColor"),this.listSelectedBG=ve(this.theme,"selectionBGColor"),this.listActiveColor=ve(this.theme,"activeCellColor");for(let t=0;t<this.matches.length;t++){const r=this.matches[t],o=document.createElement("div");o.dataset.funcName=r.name,o.dataset.funcIndex=String(t),o.style.display="flex",o.style.gap="10px",o.style.alignItems="flex-start",o.style.justifyContent="flex-start",o.style.padding="10px 14px",o.style.cursor="pointer",o.style.borderBottom=`1px solid ${e}`,o.style.backgroundColor="transparent";const i=document.createElement("div");i.style.minWidth="0",i.style.flex="1";const n=document.createElement("div");n.textContent=r.name,n.style.font="600 13px Arial",n.style.color=this.listTextColor;const s=document.createElement("div");s.textContent=ja(r),s.style.font="12px Arial",s.style.opacity="0.82",s.style.marginTop="2px",s.style.wordBreak="break-word";const a=document.createElement("div");a.textContent=r.description,a.style.font="12px Arial",a.style.opacity="0.72",a.style.marginTop="2px",a.style.wordBreak="break-word",i.appendChild(n),i.appendChild(s),i.appendChild(a),o.appendChild(i),this.list.appendChild(o),this.rows.push({row:o,name:n})}this.updateRowSelection(this.selectedIndex)}scrollSelectedIntoView(){var t;const e=(t=this.rows[this.selectedIndex])==null?void 0:t.row;e&&e.scrollIntoView({block:"nearest"})}getRowIndexFromTarget(e){if(!(e instanceof Element))return null;const t=e.closest("[data-func-index]");if(!(t instanceof HTMLDivElement)||!this.list.contains(t))return null;const r=Number(t.dataset.funcIndex);return Number.isInteger(r)?r:null}setSelectedIndex(e){if(e===this.selectedIndex||e<0||e>=this.matches.length)return;const t=this.selectedIndex;this.selectedIndex=e,this.updateRowSelection(t),this.updateRowSelection(e)}updateRowSelection(e){const t=this.rows[e];if(!t)return;const r=e===this.selectedIndex;t.row.style.backgroundColor=r?this.listSelectedBG:"transparent",t.name.style.color=r?this.listActiveColor:this.listTextColor}insertSelected(){var t;const e=this.matches[this.selectedIndex];e&&((t=this.onInsert)==null||t.call(this,e),this.hide())}}const Zf=l=>l.length===1?l.toLowerCase():l,qa=l=>l.metaKey||l.ctrlKey,Fe=(l,e)=>Zf(l.key)===Zf(e),Ze=(l,e)=>!(!Fe(l,e.key)||e.mod!==void 0&&qa(l)!==e.mod||e.shift!==void 0&&l.shiftKey!==e.shift||e.alt!==void 0&&l.altKey!==e.alt),ed=async(l,e)=>{for(const t of e)if(t.match(l))return await t.run(l),!0;return!1},co=6,_y=10,td=20,rd=120,nd=300,Ty=1800,Yn=8,ho=4,by=200,Xn=8;class Ry{constructor(e,t="light",r=!1){k(this,"sheet");k(this,"theme");k(this,"container");k(this,"formulaBar");k(this,"cellInput");k(this,"overlay");k(this,"gridContainer");k(this,"gridCanvas");k(this,"contextMenu");k(this,"autocomplete");k(this,"functionBrowser");k(this,"resizeTooltip");k(this,"filterPanel");k(this,"filterPanelState",null);k(this,"filterPanelOutsideClickUnsub",null);k(this,"filterPanelKeyboardUnsub",null);k(this,"rowDim");k(this,"colDim");k(this,"hiddenRows",new Set);k(this,"hiddenRowSizeBackup",new Map);k(this,"listeners",[]);k(this,"interactionCleanups",new Set);k(this,"resizeObserver");k(this,"preventDocumentSelectStart",e=>{e.preventDefault()});k(this,"resizeHover",null);k(this,"dragMove",null);k(this,"editMode",!1);k(this,"manuallyResizedRows",new Set);k(this,"formulaRanges",[]);k(this,"freezeState",Hn);k(this,"freezeHandleHover",null);k(this,"filterButtonHoverCol",null);k(this,"freezeDrag",null);k(this,"autofillPreview");k(this,"onRenderCallback");k(this,"readOnly");k(this,"formulaRangeAnchor",null);k(this,"activeFormulaInput",null);k(this,"formulaRefInsertPos",null);k(this,"lastFormulaRefTarget",null);k(this,"nativeSelectionBlockDepth",0);k(this,"previousBodyUserSelect","");k(this,"previousBodyWebkitUserSelect","");k(this,"pendingRenderFrame",null);k(this,"renderInFlight",!1);k(this,"renderQueued",!1);k(this,"renderVersion",0);this.container=e,this.theme=t,this.readOnly=r,this.formulaBar=new ay(t),this.gridContainer=new my(t),this.overlay=new xy(t),this.gridCanvas=new za(t),this.cellInput=new py(t),this.contextMenu=new yy(t),this.autocomplete=new Cy(t),this.functionBrowser=new Ey(t),this.resizeTooltip=document.createElement("div"),this.filterPanel=document.createElement("div"),this.rowDim=new $f(oe),this.colDim=new $f(at),this.gridContainer.appendChild(this.overlay.getContainer()),this.gridContainer.appendChild(this.gridCanvas.getCanvas()),this.gridContainer.appendChild(this.cellInput.getContainer()),this.container.appendChild(this.formulaBar.getContainer()),this.container.appendChild(this.gridContainer.getContainer()),this.container.appendChild(this.contextMenu.getContainer()),this.container.appendChild(this.autocomplete.getContainer()),document.body.appendChild(this.functionBrowser.getContainer()),this.resizeTooltip.style.position="fixed",this.resizeTooltip.style.display="none",this.resizeTooltip.style.pointerEvents="none",this.resizeTooltip.style.zIndex="1001",this.resizeTooltip.style.padding="4px 8px",this.resizeTooltip.style.borderRadius="4px",this.resizeTooltip.style.border=`1px solid ${ve(t,"cellBorderColor")}`,this.resizeTooltip.style.backgroundColor=ve(t,"cellBGColor"),this.resizeTooltip.style.color=ve(t,"cellTextColor"),this.resizeTooltip.style.fontSize="11px",this.resizeTooltip.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.resizeTooltip.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)",document.body.appendChild(this.resizeTooltip),this.filterPanel.style.position="fixed",this.filterPanel.style.display="none",this.filterPanel.style.zIndex="1002",this.filterPanel.style.width="260px",this.filterPanel.style.maxHeight="360px",this.filterPanel.style.overflow="hidden",this.filterPanel.style.borderRadius="6px",this.filterPanel.style.border=`1px solid ${ve(t,"cellBorderColor")}`,this.filterPanel.style.backgroundColor=ve(t,"cellBGColor"),this.filterPanel.style.color=ve(t,"cellTextColor"),this.filterPanel.style.fontSize="12px",this.filterPanel.style.fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',this.filterPanel.style.boxShadow="0 4px 14px rgba(0, 0, 0, 0.2)",document.body.appendChild(this.filterPanel),this.functionBrowser.setOnInsert(o=>{this.readOnly||this.insertFunctionFromBrowser(o.name)}),this.resizeObserver=new ResizeObserver(()=>this.render())}async initialize(e){this.sheet=e,this.sheet.setDimensions(this.rowDim,this.colDim),await this.sheet.loadDimensions(),await this.sheet.loadStyles(),await this.sheet.loadMerges(),await this.sheet.loadFreezePane(),await this.sheet.loadFilterState(),this.hiddenRows.clear(),this.hiddenRowSizeBackup.clear(),this.syncHiddenRowsFromSheet(),this.updateFreezeState(),this.formulaBar.initialize(e),this.addEventListeners(),this.resizeObserver.observe(this.container),this.render()}updateFreezeState(){const{frozenRows:e,frozenCols:t}=this.sheet.getFreezePane();this.freezeState=hy(e,t,this.rowDim,this.colDim)}async setFreezePane(e,t){await this.sheet.setFreezePane(e,t),this.updateFreezeState(),this.render()}async reloadFreezePane(){await this.sheet.loadFreezePane(),this.updateFreezeState()}panBy(e,t){this.gridContainer.scrollBy(e,t)}handleMobileDoubleTap(e,t){const{x:r,y:o}=this.clampClientPointToViewport(e,t);this.handleDblClickAt(r,o)}cleanup(){this.pendingRenderFrame!==null&&(cancelAnimationFrame(this.pendingRenderFrame),this.pendingRenderFrame=null),this.cancelActiveInteractions(),this.removeAllEventListeners(),this.forceEndNativeSelectionBlock(),this.resizeObserver.disconnect(),this.formulaBar.cleanup(),this.cellInput.cleanup(),this.overlay.cleanup(),this.gridCanvas.cleanup(),this.gridContainer.cleanup(),this.contextMenu.cleanup(),this.autocomplete.cleanup(),this.functionBrowser.cleanup(),this.resizeTooltip.remove(),this.hideFilterPanel(),this.filterPanel.remove(),this.sheet=void 0,this.container.innerHTML=""}beginNativeSelectionBlock(){if(this.nativeSelectionBlockDepth+=1,this.nativeSelectionBlockDepth!==1)return;const e=document.body.style;this.previousBodyUserSelect=e.userSelect,this.previousBodyWebkitUserSelect=e.webkitUserSelect,e.userSelect="none",e.webkitUserSelect="none",document.addEventListener("selectstart",this.preventDocumentSelectStart)}endNativeSelectionBlock(){if(this.nativeSelectionBlockDepth===0||(this.nativeSelectionBlockDepth-=1,this.nativeSelectionBlockDepth>0))return;const e=document.body.style;e.userSelect=this.previousBodyUserSelect,e.webkitUserSelect=this.previousBodyWebkitUserSelect,document.removeEventListener("selectstart",this.preventDocumentSelectStart)}forceEndNativeSelectionBlock(){this.nativeSelectionBlockDepth!==0&&(this.nativeSelectionBlockDepth=1,this.endNativeSelectionBlock())}showResizeTooltip(e,t,r,o,i){const n=e==="column"?"Width":"Height",s=i>1?` (${i} ${e==="column"?"columns":"rows"})`:"";this.resizeTooltip.textContent=`${n}: ${Math.round(t)}px${s}`,this.resizeTooltip.style.left=`${r+12}px`,this.resizeTooltip.style.top=`${o+12}px`,this.resizeTooltip.style.display="block"}hideResizeTooltip(){this.resizeTooltip.style.display="none"}bindEventListener(e,t,r,o){e.addEventListener(t,r,o);let i=!0;return()=>{i&&(i=!1,e.removeEventListener(t,r,o))}}addEventListener(e,t,r,o){const i=this.bindEventListener(e,t,r,o);return this.listeners.push(i),i}registerInteractionCleanup(e){let t=!0;const r=()=>{t&&(t=!1,this.interactionCleanups.delete(r),e())};return this.interactionCleanups.add(r),r}addInteractionEventListener(e,t,r,o){const i=this.bindEventListener(e,t,r,o);return this.registerInteractionCleanup(i)}startMouseDragSession({onMove:e,onComplete:t,onCleanup:r}){let o=()=>{};const i=()=>{try{t==null||t()}finally{o()}},n=this.addInteractionEventListener(document,"mousemove",e),s=this.addInteractionEventListener(document,"mouseup",i);return o=this.registerInteractionCleanup(()=>{n(),s(),r==null||r()}),o}cancelActiveInteractions(){for(const e of Array.from(this.interactionCleanups))e()}removeAllEventListeners(){for(const e of this.listeners)e();this.listeners=[]}focusGrid(){var e;this.formulaBar.blur(),this.cellInput.hide(),this.autocomplete.hide(),this.functionBrowser.hide(),this.formulaRanges=[],this.resetFormulaRangeState(),(e=window.getSelection())==null||e.removeAllRanges()}async finishEditing(){this.autocomplete.hide(),this.functionBrowser.hide();const e=this.sheet.getActiveCell();if(this.formulaBar.isFocused())await this.sheet.setData(e,this.formulaBar.getValue()),this.formulaBar.blur(),this.cellInput.hide();else if(this.cellInput.isFocused())await this.sheet.setData(e,this.cellInput.getValue()),this.cellInput.hide();else return;this.formulaRanges=[],this.resetFormulaRangeState(),await this.autoResizeRow(e.r)}isExternalInput(e){if(this.functionBrowser.contains(e))return!0;if(!(e instanceof Element)||this.container.contains(e))return!1;const t=e.tagName;return!!(t==="INPUT"||t==="TEXTAREA"||t==="SELECT"||e.isContentEditable)}handleKeyDown(e){if(this.functionBrowser.isVisible()){e.key==="Escape"&&(e.preventDefault(),this.functionBrowser.hide());return}if(!this.isExternalInput(e.target)){if(this.formulaBar.isFocused()){this.handleFormulaKeydown(e);return}else if(this.cellInput.isFocused()){this.handleCellInputKeydown(e);return}this.handleGridKeydown(e)}}handleKeyUp(e){if(this.functionBrowser.isVisible()||this.isExternalInput(e.target))return;const r=(e.key==="ArrowDown"||e.key==="ArrowUp"||e.key==="Escape"||e.key==="Enter"||e.key==="Tab")&&(this.autocomplete.isListVisible()||this.autocomplete.isHintVisible());let o,i;this.formulaBar.isFocused()?(o=this.formulaBar.getValue(),i=this.formulaBar.getFormulaInput(),this.cellInput.setValue(o)):this.cellInput.isFocused()&&(o=this.cellInput.getValue(),i=this.cellInput.getInput(),this.formulaBar.setValue(o)),o!==void 0&&o.startsWith("=")?(this.formulaRanges=Ii(o).map(n=>n.range),this.renderOverlay()):o!==void 0&&(this.formulaRanges=[],this.renderOverlay()),!r&&(i&&o!==void 0?this.updateAutocomplete(o,i):this.autocomplete.hide())}updateAutocomplete(e,t){if(!e.startsWith("=")){this.autocomplete.hide();return}const r=mr(t);if(!r){this.autocomplete.hide();return}const o=r.end,i=Ay(e,o),n=t.getBoundingClientRect(),s={left:n.left,top:n.bottom+2};i.type==="function-name"?this.autocomplete.showList(i.prefix,s):i.type==="argument"?this.autocomplete.showHint(i.funcName,i.argIndex,s):this.autocomplete.hide()}toggleFunctionBrowser(){if(this.functionBrowser.isVisible()){this.functionBrowser.hide();return}this.autocomplete.hide(),this.functionBrowser.show()}insertFunctionCompletion(e,t){const r=t.innerText,o=mr(t);if(!o)return;const i=o.end,s=r.slice(0,i).match(/([A-Za-z_]\w*)$/);if(!s)return;const a=i-s[1].length,c=r.slice(i),u=r.slice(0,a)+e+"("+c;this.formulaBar.setValue(u),this.cellInput.setValue(u);const h=a+e.length+1;_r(t,{start:h,end:h}),this.autocomplete.hide(),this.updateAutocomplete(u,t)}async insertFunctionFromBrowser(e){const t=await this.getInputForFunctionInsert(),r=t.innerText,o=mr(t);let i,n;if(!r.startsWith("="))i=`=${e}(`,n=i.length;else{const s=(o==null?void 0:o.start)??r.length,a=(o==null?void 0:o.end)??r.length;i=r.slice(0,s)+e+"("+r.slice(a),n=s+e.length+1}this.formulaBar.setValue(i),this.cellInput.setValue(i),_r(t,{start:n,end:n}),t.focus(),this.formulaRanges=Ii(i).map(s=>s.range),this.renderOverlay(),this.autocomplete.hide(),this.updateAutocomplete(i,t)}async getInputForFunctionInsert(){if(this.cellInput.isFocused())return this.cellInput.getInput();const e=this.cellInput.getInput(),t=this.formulaBar.getFormulaInput(),r=t.innerText,o=mr(t);this.cellInput.isShown()||await this.showCellInput(!0,!0),this.cellInput.setValue(r);const i=(o==null?void 0:o.end)??r.length;return _r(e,{start:i,end:i}),this.cellInput.isFocused()||e.focus(),e}isInFormulaRangeMode(){let e,t;if(this.cellInput.isFocused()?(e=this.cellInput.getValue(),t=this.cellInput.getInput()):this.formulaBar.isFocused()&&(e=this.formulaBar.getValue(),t=this.formulaBar.getFormulaInput()),!e||!t||!e.startsWith("="))return!1;const r=mr(t);return r?fg(e,r.end):!1}insertReferenceAtCursor(e,t){const r=this.cellInput.isFocused(),o=this.formulaBar.isFocused();if(!r&&!o)return;const i=r?this.cellInput.getInput():this.formulaBar.getFormulaInput(),n=i.innerText,s=mr(i);if(!s)return;const a=t&&(e.r!==t.r||e.c!==t.c)?de(e)+":"+de(t):de(e);let c,u;if(this.formulaRefInsertPos){const{start:h,end:f}=this.formulaRefInsertPos;c=n.slice(0,h)+a+n.slice(f),u=h+a.length,this.formulaRefInsertPos={start:h,end:u}}else{const h=kf(n,s.end);h?(c=n.slice(0,h.start)+a+n.slice(h.end),u=h.start+a.length,this.formulaRefInsertPos={start:h.start,end:u}):s.start!==s.end?(c=n.slice(0,s.start)+a+n.slice(s.end),u=s.start+a.length,this.formulaRefInsertPos={start:s.start,end:u}):(c=n.slice(0,s.end)+a+n.slice(s.end),u=s.end+a.length,this.formulaRefInsertPos={start:s.end,end:u})}this.formulaBar.setValue(c),this.cellInput.setValue(c),_r(i,{start:u,end:u}),c.startsWith("=")&&(this.formulaRanges=Ii(c).map(h=>h.range),this.renderOverlay()),this.lastFormulaRefTarget=t||e}toggleAbsoluteReference(e){const t=e.innerText;if(!t.startsWith("="))return;const r=mr(e);if(!r)return;const o=kf(t,r.end);if(!o)return;const i=o.text,n=i.startsWith("$"),s=i.replace(/\$/g,"");let a=0;for(let x=0;x<s.length;x++)if(s.charCodeAt(x)>=48&&s.charCodeAt(x)<=57){a=x;break}const c=s.slice(0,a),u=s.slice(a),h=i.indexOf(u,i.lastIndexOf(c)+c.length),f=h>0&&i[h-1]==="$";let d;!n&&!f?d="$"+c+"$"+u:n&&f?d=c+"$"+u:!n&&f?d="$"+c+u:d=c+u;const p=t.slice(0,o.start)+d+t.slice(o.end),y=o.start+d.length;this.formulaBar.setValue(p),this.cellInput.setValue(p),_r(e,{start:y,end:y}),p.startsWith("=")&&(this.formulaRanges=Ii(p).map(x=>x.range),this.renderOverlay())}resetFormulaRangeState(){this.formulaRangeAnchor=null,this.activeFormulaInput=null,this.formulaRefInsertPos=null,this.lastFormulaRefTarget=null}handleDblClick(e){e.preventDefault(),this.handleDblClickAt(e.offsetX,e.offsetY)}handleDblClickAt(e,t){if(this.readOnly)return;const r=this.detectFreezeHandle(e,t);if(r){const i=this.sheet.getFreezePane();r==="row"?this.setFreezePane(i.frozenRows>0?0:1,i.frozenCols):this.setFreezePane(i.frozenRows,i.frozenCols>0?0:1);return}const o=this.detectResizeEdge(e,t);if(o){this.autoFitSize(o.axis,o.index);return}this.showCellInput()}handleContextMenu(e){if(this.readOnly)return;const t=e.offsetX,r=e.offsetY,o=t<ue,i=r<oe;if(!(!o&&!i)){if(e.preventDefault(),o){const n=this.toRowFromMouse(r);if(n<1)return;const s=this.sheet.getSelectedIndices(),a=s&&s.axis==="row"&&n>=s.from&&n<=s.to,c=a?s.from:n,u=a?s.to-s.from+1:1,h=u>1?`${u} rows`:"row";this.contextMenu.show(e.clientX,e.clientY,[{label:`Insert ${h} above`,action:()=>{this.sheet.insertRows(c,u).then(()=>this.render())}},{label:`Insert ${h} below`,action:()=>{this.sheet.insertRows(c+u,u).then(()=>this.render())}},{label:`Delete ${h}`,action:()=>{this.sheet.deleteRows(c,u).then(()=>this.render())}}])}else if(i){const n=this.toColFromMouse(t);if(n<1)return;const s=this.sheet.getSelectedIndices(),a=s&&s.axis==="column"&&n>=s.from&&n<=s.to,c=a?s.from:n,u=a?s.to-s.from+1:1,h=u>1?`${u} columns`:"column",f=[{label:`Insert ${h} left`,action:()=>{this.sheet.insertColumns(c,u).then(()=>this.render())}},{label:`Insert ${h} right`,action:()=>{this.sheet.insertColumns(c+u,u).then(()=>this.render())}},{label:`Delete ${h}`,action:()=>{this.sheet.deleteColumns(c,u).then(()=>this.render())}}];this.contextMenu.show(e.clientX,e.clientY,f)}}}getFilterButtonRect(e){var s;const t=(s=this.sheet)==null?void 0:s.getFilterRange();if(!t)return null;const r=t[0].r,o=this.getCellRect({r,c:e});if(o.width<=6||o.height<=6)return null;const i=Math.min(16,Math.max(12,o.width-4)),n=Math.min(16,Math.max(12,o.height-6));return{left:o.left+o.width-i-2,top:o.top+Math.max(3,(o.height-n)/2),width:i,height:n}}detectFilterButton(e,t){if(!this.sheet||!this.sheet.hasFilter()||e<=ue||t<=oe)return null;const r=this.sheet.getFilterRange();if(!r)return null;const o=this.toRefFromMouse(e,t);if(o.r!==r[0].r||!this.sheet.isColumnInFilter(o.c))return null;const i=this.getFilterButtonRect(o.c);return!i||e<i.left-2||e>i.left+i.width+2||t<i.top-2||t>i.top+i.height+2?null:o.c}async showFilterPanel(e,t){var p,y;if(!this.sheet||!this.sheet.isColumnInFilter(e))return;const r=await this.sheet.getFilterColumnValues(e);if(!r)return;const o=this.sheet.getColumnFilterCondition(e),i=o&&o.op!=="in"&&o.op!=="isEmpty"&&o.op!=="isNotEmpty",n=t==="condition"||i?"condition":"values",s=o?{...o,values:o.values?[...o.values]:void 0}:{op:"contains",value:""};this.filterPanelState={col:e,values:r.values,selected:new Set(r.selected),initialSelected:new Set(r.selected),search:"",mode:n,condition:{...s,values:s.values?[...s.values]:void 0},initialCondition:s,hasExistingCondition:!!o},this.renderFilterPanel();const a=this.getFilterButtonRect(e);if(!a)return;const c=this.viewport,h=Math.min(c.left+Math.max(ue,a.left-6),c.left+Math.max(0,c.width-260-4)),f=c.top+a.top+a.height+4;this.filterPanel.style.left=`${h}px`,this.filterPanel.style.top=`${f}px`,this.filterPanel.style.display="block",(p=this.filterPanelKeyboardUnsub)==null||p.call(this);const d=x=>{if(!this.filterPanelState)return;const v=x.target,m=v?this.filterPanel.contains(v):!1;if(x.key==="Escape"){x.preventDefault(),x.stopPropagation(),this.hideFilterPanel();return}x.key==="Enter"&&m&&(x.preventDefault(),x.stopPropagation(),this.applyFilterPanel())};document.addEventListener("keydown",d,!0),this.filterPanelKeyboardUnsub=()=>{document.removeEventListener("keydown",d,!0)},(y=this.filterPanelOutsideClickUnsub)==null||y.call(this),requestAnimationFrame(()=>{if(!this.filterPanelState)return;const x=v=>{this.filterPanel.contains(v.target)||this.hideFilterPanel()};document.addEventListener("mousedown",x),this.filterPanelOutsideClickUnsub=()=>{document.removeEventListener("mousedown",x)}})}hideFilterPanel(){var e,t;this.filterPanel.style.display="none",this.filterPanel.innerHTML="",this.filterPanelState=null,(e=this.filterPanelOutsideClickUnsub)==null||e.call(this),this.filterPanelOutsideClickUnsub=null,(t=this.filterPanelKeyboardUnsub)==null||t.call(this),this.filterPanelKeyboardUnsub=null}areStringSetsEqual(e,t){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}areFilterConditionsEqual(e,t){if(e.op!==t.op)return!1;if(e.op==="in"){const r=Array.from(new Set(e.values||[])).sort(),o=Array.from(new Set(t.values||[])).sort();if(r.length!==o.length)return!1;for(let i=0;i<r.length;i++)if(r[i]!==o[i])return!1;return!0}return e.op==="isEmpty"||e.op==="isNotEmpty"?!0:(e.value||"").trim()===(t.value||"").trim()}isFilterPanelDirty(e){return e.mode==="values"?!this.areStringSetsEqual(e.selected,e.initialSelected):!this.areFilterConditionsEqual(e.condition,e.initialCondition)}async applyFilterPanel(){const e=this.filterPanelState;if(!(!e||!this.sheet)&&this.isFilterPanelDirty(e)){if(e.mode==="values"){await this.sheet.setColumnIncludedValues(e.col,Array.from(e.selected)),this.hideFilterPanel(),this.render();return}await this.sheet.setColumnFilter(e.col,e.condition),this.hideFilterPanel(),this.render()}}syncFilterPanelApplyButtonState(){const e=this.filterPanelState;if(!e)return;const t=this.filterPanel.querySelector('button[data-wb-filter-apply="true"]');if(!t)return;const r=this.isFilterPanelDirty(e);t.disabled=!r,t.style.opacity=r?"1":"0.5",t.style.cursor=r?"pointer":"not-allowed"}syncFilterPanelValuesSelectionState(e){const t=this.filterPanelState;if(!t)return;const r=this.filterPanel.querySelector('[data-wb-filter-summary="true"]');if(r){const i=t.values.filter(n=>t.selected.has(n)).length;r.textContent=`Selected ${i} / ${t.values.length}`}const o=this.filterPanel.querySelector('input[data-wb-filter-select-all="true"]');if(o){const i=e.filter(n=>t.selected.has(n)).length;o.checked=e.length>0&&i===e.length,o.indeterminate=i>0&&i<e.length}this.syncFilterPanelApplyButtonState()}renderFilterPanel(){var R;const e=this.filterPanelState;if(!e)return;const t=document.activeElement,r=t instanceof HTMLInputElement&&t.dataset.wbFilterSearch==="true",o=r?t.selectionStart:null,i=r?t.selectionEnd:null,n=ve(this.theme,"cellBorderColor"),s=ve(this.theme,"selectionBGColor"),a=w=>{const P=document.createElement("button");return P.type="button",P.textContent=w,P.style.height="26px",P.style.padding="0 8px",P.style.border=`1px solid ${n}`,P.style.borderRadius="4px",P.style.background="transparent",P.style.color="inherit",P.style.cursor="pointer",P};this.filterPanel.innerHTML="";const c=document.createElement("div");c.style.display="flex",c.style.flexDirection="column",c.style.maxHeight="360px",c.style.height=e.mode==="values"?"360px":"auto",c.style.overflow="hidden";const u=document.createElement("div");u.style.padding="8px 10px",u.style.borderBottom=`1px solid ${n}`,u.style.fontWeight="600",u.textContent=`Filter ${ti(e.col)}`,c.appendChild(u);const h=document.createElement("div");h.textContent="Sort",h.style.padding="8px 10px 4px",h.style.fontSize="11px",h.style.opacity="0.7",c.appendChild(h);const f=document.createElement("div");f.style.display="flex",f.style.flexWrap="wrap",f.style.gap="6px",f.style.padding="8px 10px 6px";const d=a("Sort A to Z");d.onclick=()=>{this.sheet.sortFilterByColumn(e.col,"asc").then(w=>{w&&(this.hideFilterPanel(),this.render())})};const p=a("Sort Z to A");p.onclick=()=>{this.sheet.sortFilterByColumn(e.col,"desc").then(w=>{w&&(this.hideFilterPanel(),this.render())})},f.append(d,p),c.appendChild(f);const y=document.createElement("div");y.textContent="Filter",y.style.padding="0 10px 4px",y.style.fontSize="11px",y.style.opacity="0.7",c.appendChild(y);const x=document.createElement("div");x.style.display="flex",x.style.flexWrap="wrap",x.style.gap="6px",x.style.padding="0 10px 8px";const v=(w,P)=>{const M=a(w);return e.mode===P&&(M.style.background=s),M.onclick=()=>{this.filterPanelState&&(this.filterPanelState.mode=P,this.renderFilterPanel())},M};x.append(v("Filter by values","values"),v("Filter by condition","condition")),c.appendChild(x);const m=document.createElement("div");if(m.style.flex="1",m.style.minHeight="0",m.style.padding="0 10px",m.style.display="flex",m.style.flexDirection="column",c.appendChild(m),e.mode==="values"){const w=document.createElement("input");w.type="text",w.dataset.wbFilterSearch="true",w.value=e.search,w.placeholder="Search values",w.style.width="100%",w.style.margin="0 0 8px",w.style.height="28px",w.style.padding="0 8px",w.style.border=`1px solid ${n}`,w.style.borderRadius="4px",w.style.background="transparent",w.style.color="inherit",w.oninput=()=>{this.filterPanelState&&(this.filterPanelState.search=w.value,this.renderFilterPanel())},m.appendChild(w);const P=e.values,M=P.filter(G=>e.selected.has(G)).length,D=document.createElement("div");D.dataset.wbFilterSummary="true",D.textContent=`Selected ${M} / ${P.length}`,D.style.margin="0 0 8px",D.style.fontSize="11px",D.style.opacity="0.7",m.appendChild(D);const U=e.search.trim().toLowerCase(),J=P.filter(G=>U?(G===""?"(Blanks)":G).toLowerCase().includes(U):!0).slice(0,by),te=document.createElement("div");te.style.flex="1",te.style.minHeight="0",te.style.border=`1px solid ${n}`,te.style.borderRadius="4px",te.style.overflow="auto";const le=J.filter(G=>e.selected.has(G)).length,ge=document.createElement("label");ge.style.display="flex",ge.style.alignItems="center",ge.style.gap="8px",ge.style.padding="6px 8px",ge.style.borderBottom=`1px solid ${n}`,ge.style.cursor="pointer";const ce=document.createElement("input");ce.type="checkbox",ce.dataset.wbFilterSelectAll="true",ce.checked=J.length>0&&le===J.length,ce.indeterminate=le>0&&le<J.length,ce.onchange=()=>{if(this.filterPanelState){if(ce.checked)for(const G of J)this.filterPanelState.selected.add(G);else for(const G of J)this.filterPanelState.selected.delete(G);this.renderFilterPanel()}};const ee=document.createElement("span");if(ee.textContent="Select all",ge.append(ce,ee),te.appendChild(ge),J.length===0){const G=document.createElement("div");G.style.padding="10px",G.style.opacity="0.7",G.textContent="No values",te.appendChild(G)}else for(const G of J){const Q=document.createElement("label");Q.style.display="flex",Q.style.alignItems="center",Q.style.gap="8px",Q.style.padding="6px 8px",Q.style.cursor="pointer";const ie=document.createElement("input");ie.type="checkbox",ie.checked=e.selected.has(G),ie.onchange=()=>{this.filterPanelState&&(ie.checked?this.filterPanelState.selected.add(G):this.filterPanelState.selected.delete(G),this.syncFilterPanelValuesSelectionState(J))};const _=document.createElement("span");_.textContent=G===""?"(Blanks)":G,_.style.overflow="hidden",_.style.textOverflow="ellipsis",_.style.whiteSpace="nowrap",Q.append(ie,_),te.appendChild(Q)}m.appendChild(te)}else{const w=document.createElement("div");w.style.display="grid",w.style.gap="8px";const P=document.createElement("select");P.style.height="30px",P.style.border=`1px solid ${n}`,P.style.borderRadius="4px",P.style.background="transparent",P.style.color="inherit";const M=[{value:"contains",label:"Contains"},{value:"notContains",label:"Does not contain"},{value:"equals",label:"Equals"},{value:"notEquals",label:"Does not equal"},{value:"isEmpty",label:"Is empty"},{value:"isNotEmpty",label:"Is not empty"}],D=e.condition.op==="in"?"contains":e.condition.op;for(const J of M){const te=document.createElement("option");te.value=J.value,te.textContent=J.label,te.selected=D===J.value,P.appendChild(te)}if(P.onchange=()=>{if(!this.filterPanelState)return;const J=P.value;this.filterPanelState.condition={op:J,value:this.filterPanelState.condition.value||""},this.renderFilterPanel()},w.appendChild(P),D!=="isEmpty"&&D!=="isNotEmpty"){const J=document.createElement("input");J.type="text",J.value=((R=this.filterPanelState)==null?void 0:R.condition.value)||"",J.placeholder="Enter value",J.style.height="30px",J.style.padding="0 8px",J.style.border=`1px solid ${n}`,J.style.borderRadius="4px",J.style.background="transparent",J.style.color="inherit",J.oninput=()=>{this.filterPanelState&&(this.filterPanelState.condition={...this.filterPanelState.condition,value:J.value},this.syncFilterPanelApplyButtonState())},w.appendChild(J)}m.appendChild(w)}const g=document.createElement("div");g.style.display="flex",g.style.justifyContent="flex-end",g.style.gap="6px",g.style.padding="8px 10px";const S=w=>{w.disabled=!0,w.style.opacity="0.5",w.style.cursor="not-allowed"},C=a("Clear");C.onclick=()=>{this.sheet.clearColumnFilter(e.col).then(()=>{this.hideFilterPanel(),this.render()})},e.hasExistingCondition||S(C);const A=a("Cancel");A.onclick=()=>this.hideFilterPanel();const b=a("Apply");if(b.dataset.wbFilterApply="true",b.onclick=()=>{this.applyFilterPanel()},this.isFilterPanelDirty(e)||S(b),g.append(C,A,b),c.appendChild(g),this.filterPanel.appendChild(c),r&&e.mode==="values"){const w=this.filterPanel.querySelector('input[data-wb-filter-search="true"]');if(w){w.focus();const P=w.value.length,M=Math.max(0,Math.min(P,o??P)),D=Math.max(M,Math.min(P,i??M));w.setSelectionRange(M,D)}}}addEventListeners(){const e=this.gridContainer.getScrollContainer();this.addEventListener(window,"resize",()=>{this.updateCellInputPosition(),this.render()}),this.addEventListener(e,"scroll",()=>{this.hideFilterPanel(),this.updateCellInputPosition(),this.render()}),this.addEventListener(e,"mousedown",t=>{this.handleMouseDown(t)}),this.addEventListener(e,"mousemove",t=>{this.handleMouseMove(t)}),this.addEventListener(e,"mouseleave",()=>{this.handleScrollContainerMouseLeave()}),this.addEventListener(e,"dblclick",t=>{this.handleDblClick(t)}),this.addEventListener(e,"contextmenu",t=>{this.handleContextMenu(t)}),this.addEventListener(document,"keydown",t=>{this.handleKeyDown(t)}),this.addEventListener(document,"keyup",t=>{this.handleKeyUp(t)})}detectResizeEdge(e,t){const r=this.scroll,o=this.freezeState;if(t<oe&&e>ue){const n=o.frozenCols>0&&e<ue+o.frozenWidth?e-ue:e-ue-o.frozenWidth+this.colDim.getOffset(o.frozenCols+1)+r.left,s=this.colDim.findIndex(n),a=this.colDim.getOffset(s)+this.colDim.getSize(s);if(Math.abs(n-a)<co)return{axis:"column",index:s};if(s>1){const c=this.colDim.getOffset(s-1)+this.colDim.getSize(s-1);if(Math.abs(n-c)<co)return{axis:"column",index:s-1}}}if(e<ue&&t>oe){const n=o.frozenRows>0&&t<oe+o.frozenHeight?t-oe:t-oe-o.frozenHeight+this.rowDim.getOffset(o.frozenRows+1)+r.top,s=this.rowDim.findIndex(n),a=this.rowDim.getOffset(s)+this.rowDim.getSize(s);if(Math.abs(n-a)<co)return{axis:"row",index:s};if(s>1){const c=this.rowDim.getOffset(s-1)+this.rowDim.getSize(s-1);if(Math.abs(n-c)<co)return{axis:"row",index:s-1}}}return null}detectFreezeHandle(e,t){const r=this.freezeState,o=r.frozenRows>0||r.frozenCols>0,i=Dp,n=cy,s=o&&r.frozenRows>0?oe+r.frozenHeight-i/2:oe-i;if(e>=0&&e<=ue&&t>=s-n&&t<=s+i+n)return"row";const a=o&&r.frozenCols>0?ue+r.frozenWidth-i/2:ue-i;return e>=a-n&&e<=a+i+n&&t>=0&&t<=oe?"column":null}startFreezeDrag(e,t){const r=this.gridContainer.getScrollContainer();r.style.cursor="grabbing";const o=n=>{const s=this.viewport;if(e==="row"){const a=n.target!==r?Math.max(0,Math.min(s.height,n.clientY-s.top)):n.offsetY;if(a<=oe)return 0;const c=a-oe,u=this.rowDim.findIndex(c),f=this.rowDim.getOffset(u)+this.rowDim.getSize(u)/2;return c<f?Math.max(0,u-1):u}else{const a=n.target!==r?Math.max(0,Math.min(s.width,n.clientX-s.left)):n.offsetX;if(a<=ue)return 0;const c=a-ue,u=this.colDim.findIndex(c),f=this.colDim.getOffset(u)+this.colDim.getSize(u)/2;return c<f?Math.max(0,u-1):u}};this.freezeDrag={axis:e,targetIndex:o(t)},this.renderOverlay();const i=n=>{const s=o(n);this.freezeDrag&&this.freezeDrag.targetIndex!==s&&(this.freezeDrag={axis:e,targetIndex:s},this.renderOverlay())};this.startMouseDragSession({onMove:i,onComplete:()=>{var a;const n=((a=this.freezeDrag)==null?void 0:a.targetIndex)??0,s=this.sheet.getFreezePane();e==="row"?this.setFreezePane(n,s.frozenCols):this.setFreezePane(s.frozenRows,n)},onCleanup:()=>{r.style.cursor="",this.freezeDrag=null,this.freezeHandleHover=null,this.renderOverlay()}})}toRefFromMouse(e,t){const r=this.freezeState;return r.frozenRows>0||r.frozenCols>0?dy(e,t,this.scroll,this.rowDim,this.colDim,r):fy(e+this.scroll.left,t+this.scroll.top,this.rowDim,this.colDim)}toRowFromMouse(e){const t=this.freezeState,o=t.frozenRows>0&&e<oe+t.frozenHeight?e-oe:e-oe-t.frozenHeight+this.rowDim.getOffset(t.frozenRows+1)+this.scroll.top;return this.rowDim.findIndex(o)}toColFromMouse(e){const t=this.freezeState,o=t.frozenCols>0&&e<ue+t.frozenWidth?e-ue:e-ue-t.frozenWidth+this.colDim.getOffset(t.frozenCols+1)+this.scroll.left;return this.colDim.findIndex(o)}getAutofillSelectionRect(e){if(!this.sheet||this.sheet.getSelectionType()!=="cell")return;const t=e||this.sheet.getRangeOrActiveCell(),r=Vi(t[0],this.scroll,this.rowDim,this.colDim,this.freezeState),o=Vi(t[1],this.scroll,this.rowDim,this.colDim,this.freezeState),i=Math.min(r.left,o.left),n=Math.min(r.top,o.top),s=Math.max(r.left+r.width,o.left+o.width),a=Math.max(r.top+r.height,o.top+o.height);return{left:i,top:n,width:s-i,height:a-n}}detectAutofillHandle(e,t){if(this.readOnly||!this.sheet||this.sheet.getSelectionType()!=="cell")return!1;const r=this.sheet.getRangeOrActiveCell(),o=this.getAutofillSelectionRect(r);if(!o||this.isAutofillHandleHiddenByFreeze(r,o))return!1;const i=o.left+o.width-Yn/2,n=o.top+o.height-Yn/2;return e>=i-ho&&e<=i+Yn+ho&&t>=n-ho&&t<=n+Yn+ho}shouldShowAutofillHandle(){if(this.readOnly||!this.sheet||this.sheet.getSelectionType()!=="cell")return!1;const e=this.sheet.getRangeOrActiveCell(),t=this.getAutofillSelectionRect(e);return t?!this.isAutofillHandleHiddenByFreeze(e,t):!1}isAutofillHandleHiddenByFreeze(e,t){const r=this.freezeState;if(r.frozenRows===0&&r.frozenCols===0)return!1;const o=Math.max(e[0].r,e[1].r),i=Math.max(e[0].c,e[1].c);if(!(o>r.frozenRows&&i>r.frozenCols))return!1;const s=t.left+t.width-Yn/2,a=t.top+t.height-Yn/2,c=ue+r.frozenWidth,u=oe+r.frozenHeight;return s<c||a<u}clampClientPointToViewport(e,t){const r=this.viewport;return{x:Math.max(0,Math.min(r.width,e-r.left)),y:Math.max(0,Math.min(r.height,t-r.top))}}getAutoScrollSpeed(e){const r=Math.min(rd,Math.max(0,e))/rd;return nd+(Ty-nd)*r}getAutoScrollVelocity(e,t,r){return e<t?-this.getAutoScrollSpeed(t-e):e>r?this.getAutoScrollSpeed(e-r):0}handleMouseMove(e){var n,s,a;const t=this.gridContainer.getScrollContainer();if((e.buttons&1)===1){this.resizeHover&&(this.resizeHover=null,this.renderOverlay());return}const r=this.detectFreezeHandle(e.offsetX,e.offsetY);if(r!==this.freezeHandleHover&&(this.freezeHandleHover=r,this.render()),r){t.style.cursor="grab",this.setFilterButtonHoverCol(null),this.resizeHover&&(this.resizeHover=null,this.renderOverlay());return}const o=this.detectResizeEdge(e.offsetX,e.offsetY),i=(o==null?void 0:o.axis)!==((n=this.resizeHover)==null?void 0:n.axis)||(o==null?void 0:o.index)!==((s=this.resizeHover)==null?void 0:s.index);if(i&&(this.resizeHover=o),o)t.style.cursor=o.axis==="column"?"col-resize":"row-resize",this.setFilterButtonHoverCol(null);else{if(this.detectAutofillHandle(e.offsetX,e.offsetY)){t.style.cursor="crosshair",this.setFilterButtonHoverCol(null),i&&this.renderOverlay();return}const c=e.offsetX,u=e.offsetY,h=this.detectFilterButton(c,u);if(h!==null){t.style.cursor="pointer",this.setFilterButtonHoverCol(h),i&&this.renderOverlay();return}this.setFilterButtonHoverCol(null);const f=(a=this.sheet)==null?void 0:a.getSelectedIndices();if(f){const d=f.axis==="column"?u<oe&&c>ue&&(()=>{const p=this.toColFromMouse(c);return p>=f.from&&p<=f.to})():c<ue&&u>oe&&(()=>{const p=this.toRowFromMouse(u);return p>=f.from&&p<=f.to})();t.style.cursor=d?"grab":""}else t.style.cursor=""}i&&this.renderOverlay()}handleScrollContainerMouseLeave(){const e=this.gridContainer.getScrollContainer();e.style.cursor="";const t=this.filterButtonHoverCol!==null||this.resizeHover!==null||this.freezeHandleHover!==null;this.filterButtonHoverCol=null,this.resizeHover=null,this.freezeHandleHover=null,t&&this.render()}setFilterButtonHoverCol(e){this.filterButtonHoverCol!==e&&(this.filterButtonHoverCol=e,this.render())}async handleMouseDown(e){const t=this.detectFreezeHandle(e.offsetX,e.offsetY);if(t&&!this.readOnly){e.preventDefault(),this.startFreezeDrag(t,e);return}const r=this.detectResizeEdge(e.offsetX,e.offsetY);if(r&&!this.readOnly){e.preventDefault(),this.startResize(r.axis,r.index,e);return}const o=e.offsetX,i=e.offsetY,n=this.detectFilterButton(o,i);if(n!==null){e.preventDefault(),await this.finishEditing(),await this.showFilterPanel(n);return}if(o<ue&&i<oe){e.preventDefault(),await this.finishEditing(),this.sheet.selectAllCells(),this.render();return}const a=i<oe&&o>ue,c=o<ue&&i>oe;if(a){e.preventDefault(),await this.finishEditing();const g=this.toColFromMouse(o);if(g<1)return;if(e.shiftKey){this.sheet.selectColumnRange(this.sheet.getActiveCell().c,g),this.render();return}const S=this.sheet.getSelectedIndices();if(!this.readOnly&&S&&S.axis==="column"&&g>=S.from&&g<=S.to){this.startDragMove("column",S.from,S.to-S.from+1,e);return}this.sheet.selectColumn(g),this.render();const C=g;let A=g,b=e.clientX,R=null,w=null;const P=()=>{const{x:te}=this.clampClientPointToViewport(b,0),le=this.toColFromMouse(te);le>=1&&le!==A&&(A=le,this.sheet.selectColumnRange(C,A))},M=()=>{R!==null&&(cancelAnimationFrame(R),R=null),w=null},D=te=>{const le=this.viewport,ge=this.getAutoScrollVelocity(b,le.left,le.left+le.width);if(ge===0){R=null,w=null;return}const ce=Math.min(50,w===null?16:te-w);w=te,this.gridContainer.scrollBy(ge*ce/1e3,0),P(),this.render(),R=requestAnimationFrame(D)},U=()=>{R===null&&(R=requestAnimationFrame(D))},J=te=>{b=te.clientX,P(),this.render();const le=this.viewport;this.getAutoScrollVelocity(b,le.left,le.left+le.width)===0?M():U()};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:J,onCleanup:()=>{M(),this.endNativeSelectionBlock()}});return}if(c){e.preventDefault(),await this.finishEditing();const g=this.toRowFromMouse(i);if(g<1)return;if(e.shiftKey){this.sheet.selectRowRange(this.sheet.getActiveCell().r,g),this.render();return}const S=this.sheet.getSelectedIndices();if(!this.readOnly&&S&&S.axis==="row"&&g>=S.from&&g<=S.to){this.startDragMove("row",S.from,S.to-S.from+1,e);return}this.sheet.selectRow(g),this.render();const C=g;let A=g,b=e.clientY,R=null,w=null;const P=()=>{const{y:te}=this.clampClientPointToViewport(0,b),le=this.toRowFromMouse(te);le>=1&&le!==A&&(A=le,this.sheet.selectRowRange(C,A))},M=()=>{R!==null&&(cancelAnimationFrame(R),R=null),w=null},D=te=>{const le=this.viewport,ge=this.getAutoScrollVelocity(b,le.top,le.top+le.height);if(ge===0){R=null,w=null;return}const ce=Math.min(50,w===null?16:te-w);w=te,this.gridContainer.scrollBy(0,ge*ce/1e3),P(),this.render(),R=requestAnimationFrame(D)},U=()=>{R===null&&(R=requestAnimationFrame(D))},J=te=>{b=te.clientY,P(),this.render();const le=this.viewport;this.getAutoScrollVelocity(b,le.top,le.top+le.height)===0?M():U()};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:J,onCleanup:()=>{M(),this.endNativeSelectionBlock()}});return}if(this.isInFormulaRangeMode()){e.preventDefault();const g=this.toRefFromMouse(e.offsetX,e.offsetY);if(this.activeFormulaInput=this.cellInput.isFocused()?"cellInput":"formulaBar",e.shiftKey&&this.formulaRangeAnchor){const A={r:Math.min(this.formulaRangeAnchor.r,g.r),c:Math.min(this.formulaRangeAnchor.c,g.c)},b={r:Math.max(this.formulaRangeAnchor.r,g.r),c:Math.max(this.formulaRangeAnchor.c,g.c)};this.insertReferenceAtCursor(A,b)}else this.formulaRangeAnchor=g,this.formulaRefInsertPos=null,this.insertReferenceAtCursor(g);const S=this.gridContainer.getScrollContainer(),C=A=>{const b=this.viewport,R=A.target!==S?Math.max(0,Math.min(b.width,A.clientX-b.left)):A.offsetX,w=A.target!==S?Math.max(0,Math.min(b.height,A.clientY-b.top)):A.offsetY,P=this.toRefFromMouse(R,w),M={r:Math.min(this.formulaRangeAnchor.r,P.r),c:Math.min(this.formulaRangeAnchor.c,P.c)},D={r:Math.max(this.formulaRangeAnchor.r,P.r),c:Math.max(this.formulaRangeAnchor.c,P.c)};this.insertReferenceAtCursor(M,D)};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:C,onComplete:()=>{this.scrollIntoView(),this.updateCellInputPosition(),this.activeFormulaInput==="cellInput"?this.cellInput.getInput().focus():this.activeFormulaInput==="formulaBar"&&this.formulaBar.getFormulaInput().focus()},onCleanup:()=>{this.endNativeSelectionBlock(),this.formulaRefInsertPos=null}});return}if(this.detectAutofillHandle(e.offsetX,e.offsetY)){e.preventDefault(),await this.finishEditing(),this.startAutofillDrag(e);return}if(await this.finishEditing(),e.shiftKey){const g=this.toRefFromMouse(e.offsetX,e.offsetY);this.sheet.selectEnd(g),this.render();return}this.sheet.selectStart(this.toRefFromMouse(e.offsetX,e.offsetY)),this.render();let u=e.clientX,h=e.clientY,f=null,d=null;const p=()=>{const{x:g,y:S}=this.clampClientPointToViewport(u,h);this.sheet.selectEnd(this.toRefFromMouse(g,S))},y=()=>{f!==null&&(cancelAnimationFrame(f),f=null),d=null},x=g=>{const S=this.viewport,C=this.getAutoScrollVelocity(u,S.left,S.left+S.width),A=this.getAutoScrollVelocity(h,S.top,S.top+S.height);if(C===0&&A===0){f=null,d=null;return}const b=Math.min(50,d===null?16:g-d);d=g,this.gridContainer.scrollBy(C*b/1e3,A*b/1e3),p(),this.render(),f=requestAnimationFrame(x)},v=()=>{f===null&&(f=requestAnimationFrame(x))},m=g=>{u=g.clientX,h=g.clientY,p(),this.renderOverlay();const S=this.viewport,C=this.getAutoScrollVelocity(u,S.left,S.left+S.width),A=this.getAutoScrollVelocity(h,S.top,S.top+S.height);C===0&&A===0?y():v()};this.beginNativeSelectionBlock(),this.startMouseDragSession({onMove:m,onComplete:()=>{this.render()},onCleanup:()=>{y(),this.endNativeSelectionBlock()}})}startAutofillDrag(e){let t=e.clientX,r=e.clientY,o=null,i=null;const n=()=>{const{x:h,y:f}=this.clampClientPointToViewport(t,r),d=this.toRefFromMouse(h,f);this.autofillPreview=this.sheet.getAutofillPreviewRange(d),this.renderOverlay()},s=()=>{o!==null&&(cancelAnimationFrame(o),o=null),i=null},a=h=>{const f=this.viewport,d=this.getAutoScrollVelocity(t,f.left,f.left+f.width),p=this.getAutoScrollVelocity(r,f.top,f.top+f.height);if(d===0&&p===0){o=null,i=null;return}const y=Math.min(50,i===null?16:h-i);i=h,this.gridContainer.scrollBy(d*y/1e3,p*y/1e3),n(),o=requestAnimationFrame(a)},c=()=>{o===null&&(o=requestAnimationFrame(a))},u=h=>{t=h.clientX,r=h.clientY,n();const f=this.viewport,d=this.getAutoScrollVelocity(t,f.left,f.left+f.width),p=this.getAutoScrollVelocity(r,f.top,f.top+f.height);d===0&&p===0?s():c()};this.beginNativeSelectionBlock(),n(),this.startMouseDragSession({onMove:u,onComplete:()=>{const{x:h,y:f}=this.clampClientPointToViewport(t,r),d=this.toRefFromMouse(h,f),p=this.sheet;(async()=>{const y=await p.autofill(d);this.autofillPreview=void 0,this.sheet&&(y?this.render():this.renderOverlay())})()},onCleanup:()=>{s(),this.endNativeSelectionBlock(),this.autofillPreview=void 0,this.sheet&&this.renderOverlay()}})}startResize(e,t,r){const o=e==="column"?r.clientX:r.clientY,i=e==="column"?this.colDim.getSize(t):this.rowDim.getSize(t),n=this.gridContainer.getScrollContainer();n.style.cursor=e==="column"?"col-resize":"row-resize";const s=e==="column"?this.colDim:this.rowDim,a=this.sheet.getSelectedIndices(),u=a&&a.axis===e&&t>=a.from&&t<=a.to?Array.from({length:a.to-a.from+1},(y,x)=>a.from+x):[t],h=u.length;let f=i,d=null;this.beginNativeSelectionBlock(),this.showResizeTooltip(e,i,r.clientX,r.clientY,h);const p=y=>{const v=(e==="column"?y.clientX:y.clientY)-o;f=Math.max(e==="column"?td:_y,i+v),d===null&&(d=requestAnimationFrame(()=>{d=null,s.setSize(t,f),this.render()})),this.showResizeTooltip(e,f,y.clientX,y.clientY,h)};this.startMouseDragSession({onMove:p,onComplete:()=>{const y=f;s.setSize(t,y);for(const x of u)s.setSize(x,y),e==="column"?this.sheet.setColumnWidth(x,y):(this.manuallyResizedRows.add(x),this.sheet.setRowHeight(x,y));this.render()},onCleanup:()=>{n.style.cursor="",this.hideResizeTooltip(),this.endNativeSelectionBlock(),d!==null&&(cancelAnimationFrame(d),d=null)}})}async autoFitSize(e,t){const o=document.createElement("canvas").getContext("2d"),i=6;if(e==="column"){o.font=`${Tr}px Arial`;const n=ti(t);let s=o.measureText(n).width+i;const[a,c]=this.viewRange,u=[{r:a.r,c:t},{r:c.r,c:t}],h=await this.sheet.fetchGrid(u);for(const[,d]of h)if(d.v){const p=o.measureText(d.v).width+i;p>s&&(s=p)}const f=Math.max(td,Math.ceil(s));this.sheet.setColumnWidth(t,f)}else{this.manuallyResizedRows.delete(t);const n=await this.computeContentHeight(t);this.sheet.setRowHeight(t,n)}this.render()}async computeContentHeight(e){const[t,r]=this.viewRange,o=[{r:e,c:t.c},{r:e,c:r.c}],i=await this.sheet.fetchGrid(o);let n=1;for(const[,s]of i)if(s.v){const a=s.v.split(`
`).length;a>n&&(n=a)}return n<=1?oe:Math.max(oe,Math.ceil(n*Tr*So+2*ka))}async autoResizeRow(e){if(this.manuallyResizedRows.has(e))return;const t=await this.computeContentHeight(e),r=this.rowDim.getSize(e);t!==r&&(this.sheet.setRowHeight(e,t),this.render())}startDragMove(e,t,r,o){const i=this.gridContainer.getScrollContainer();i.style.cursor="grabbing";const n=e==="column"?this.colDim:this.rowDim,s=c=>{const u=this.viewport;if(e==="column"){const h=c.target!==i?Math.max(0,Math.min(u.width,c.clientX-u.left)):c.offsetX,f=this.toColFromMouse(h),d=this.freezeState,y=d.frozenCols>0&&h<ue+d.frozenWidth?h-ue:h-ue-d.frozenWidth+this.colDim.getOffset(d.frozenCols+1)+this.scroll.left,v=n.getOffset(f)+n.getSize(f)/2;return y<v?f:f+1}else{const h=c.target!==i?Math.max(0,Math.min(u.height,c.clientY-u.top)):c.offsetY,f=this.toRowFromMouse(h),d=this.freezeState,y=d.frozenRows>0&&h<oe+d.frozenHeight?h-oe:h-oe-d.frozenHeight+this.rowDim.getOffset(d.frozenRows+1)+this.scroll.top,v=n.getOffset(f)+n.getSize(f)/2;return y<v?f:f+1}};this.dragMove={axis:e,srcIndex:t,count:r,dropIndex:s(o)},this.renderOverlay();const a=c=>{const u=s(c);this.dragMove&&this.dragMove.dropIndex!==u&&(this.dragMove={axis:e,srcIndex:t,count:r,dropIndex:u},this.renderOverlay())};this.startMouseDragSession({onMove:a,onComplete:()=>{var h;const c=(h=this.dragMove)==null?void 0:h.dropIndex;if(c===void 0||c>=t&&c<=t+r)return;(e==="row"?this.sheet.moveRows(t,r,c):this.sheet.moveColumns(t,r,c)).then(()=>{const f=c<t?c:c-r;e==="row"?(this.sheet.selectRow(f),r>1&&this.sheet.selectRowRange(f,f+r-1)):(this.sheet.selectColumn(f),r>1&&this.sheet.selectColumnRange(f,f+r-1)),this.render()})},onCleanup:()=>{i.style.cursor="",this.dragMove=null,this.renderOverlay()}})}async handleFormulaKeydown(e){await this.handleEditorKeydown(e,"formulaBar")}async handleCellInputKeydown(e){await this.handleEditorKeydown(e,"cellInput")}async handleEditorKeydown(e,t){if(e.isComposing)return;const r=t==="formulaBar"?this.formulaBar.getFormulaInput():this.cellInput.getInput();if(this.handleAutocompleteKeydown(e,r))return;const o=n=>{Fe(n,"ArrowDown")?this.sheet.move("down"):Fe(n,"ArrowUp")?this.sheet.move("up"):Fe(n,"ArrowLeft")?this.sheet.move("left"):Fe(n,"ArrowRight")&&this.sheet.move("right")};!await ed(e,[{match:n=>Ze(n,{key:"Enter",alt:!0}),run:n=>{n.preventDefault(),document.execCommand("insertLineBreak")}},{match:n=>Fe(n,"Enter"),run:async n=>{n.preventDefault(),await this.finishEditing(),t==="formulaBar"?(this.focusGrid(),this.sheet.move("down")):this.sheet.moveInRange(n.shiftKey?-1:1,0),this.render(),this.scrollIntoView()}},{match:n=>Fe(n,"Tab"),run:async n=>{n.preventDefault(),await this.finishEditing(),t==="formulaBar"&&this.focusGrid(),this.sheet.moveInRange(0,n.shiftKey?-1:1),this.render(),this.scrollIntoView()}},{match:n=>this.isArrowKey(n)&&!this.editMode&&(t==="formulaBar"||this.cellInput.hasFormula())&&this.isInFormulaRangeMode(),run:n=>{n.preventDefault();const s=this.applyFormulaRangeArrowKey(n);this.scrollIntoView(s)}},{match:n=>t==="cellInput"&&this.isArrowKey(n)&&!this.cellInput.hasFormula()&&!this.editMode,run:async n=>{n.preventDefault(),await this.finishEditing(),o(n),this.render(),this.scrollIntoView()}},{match:n=>Fe(n,"F4"),run:n=>{n.preventDefault(),this.toggleAbsoluteReference(r)}},{match:n=>Fe(n,"Escape"),run:n=>{n.preventDefault(),this.focusGrid(),this.render()}}])&&t==="formulaBar"&&!this.cellInput.isShown()&&this.showCellInput(!0,!0)}handleAutocompleteKeydown(e,t){if(this.autocomplete.isListVisible()){if(Fe(e,"ArrowDown"))return e.preventDefault(),this.autocomplete.moveDown(),!0;if(Fe(e,"ArrowUp"))return e.preventDefault(),this.autocomplete.moveUp(),!0;if(Fe(e,"Tab")||Fe(e,"Enter")){const r=this.autocomplete.getSelectedFunction();if(r)return e.preventDefault(),this.insertFunctionCompletion(r.name,t),!0}else Fe(e,"Escape")&&this.autocomplete.hide()}else this.autocomplete.isHintVisible()&&Fe(e,"Escape")&&this.autocomplete.hide();return!1}isArrowKey(e){return Fe(e,"ArrowDown")||Fe(e,"ArrowUp")||Fe(e,"ArrowLeft")||Fe(e,"ArrowRight")}applyFormulaRangeArrowKey(e){const r={...this.lastFormulaRefTarget||this.sheet.getActiveCell()};if(Fe(e,"ArrowDown")?r.r=Math.max(1,r.r+1):Fe(e,"ArrowUp")?r.r=Math.max(1,r.r-1):Fe(e,"ArrowLeft")?r.c=Math.max(1,r.c-1):Fe(e,"ArrowRight")&&(r.c=r.c+1),e.shiftKey&&this.formulaRangeAnchor){const o={r:Math.min(this.formulaRangeAnchor.r,r.r),c:Math.min(this.formulaRangeAnchor.c,r.c)},i={r:Math.max(this.formulaRangeAnchor.r,r.r),c:Math.max(this.formulaRangeAnchor.c,r.c)};this.insertReferenceAtCursor(o,i),this.lastFormulaRefTarget=r}else this.formulaRangeAnchor=r,this.formulaRefInsertPos=null,this.insertReferenceAtCursor(r);return r}async copy(){const{text:e}=await this.sheet.copy();await navigator.clipboard.writeText(e)}async paste(){try{let e,t;if(navigator.clipboard.read)try{const r=await navigator.clipboard.read();for(const o of r)o.types.includes("text/html")&&(t=await(await o.getType("text/html")).text()),o.types.includes("text/plain")&&(e=await(await o.getType("text/plain")).text())}catch{e=await navigator.clipboard.readText()}else e=await navigator.clipboard.readText();await this.sheet.paste({text:e,html:t}),this.sheet.clearCopyBuffer(),this.render()}catch(e){console.error("Failed to paste cell content: ",e)}}async handleGridKeydown(e){const t=async(r,o)=>{if(r.preventDefault(),r.shiftKey?this.sheet.resizeRange(o):qa(r)?await this.sheet.moveToEdge(o):this.sheet.move(o)){this.render();const n=r.shiftKey&&this.sheet.getSelectionType()==="cell"?this.getRangeExtentRef():void 0;this.scrollIntoView(n)}};await ed(e,[{match:r=>Fe(r,"ArrowDown"),run:r=>t(r,"down")},{match:r=>Fe(r,"ArrowUp"),run:r=>t(r,"up")},{match:r=>Fe(r,"ArrowLeft"),run:r=>t(r,"left")},{match:r=>Fe(r,"ArrowRight"),run:r=>t(r,"right")},{match:r=>Ze(r,{key:"a",mod:!0}),run:async r=>{r.preventDefault(),await this.sheet.selectAll(),this.render()}},{match:r=>Fe(r,"Tab"),run:r=>{r.preventDefault(),this.sheet.moveInRange(0,r.shiftKey?-1:1),this.render(),this.scrollIntoView()}},{match:r=>Fe(r,"Enter"),run:r=>{r.preventDefault(),this.sheet.hasRange()?(this.sheet.moveInRange(r.shiftKey?-1:1,0),this.render(),this.scrollIntoView()):this.readOnly||this.showCellInput()}},{match:r=>Fe(r,"Delete")||Fe(r,"Backspace"),run:async r=>{this.readOnly||(r.preventDefault(),await this.sheet.removeData()&&this.render())}},{match:r=>!qa(r)&&this.isValidCellInput(r.key),run:()=>{this.readOnly||this.showCellInput(!0)}},{match:r=>Ze(r,{key:"z",mod:!0,shift:!1}),run:async r=>{this.readOnly||(r.preventDefault(),await this.sheet.undo()&&(this.render(),this.scrollIntoView()))}},{match:r=>Ze(r,{key:"z",mod:!0,shift:!0})||Ze(r,{key:"y",mod:!0}),run:async r=>{this.readOnly||(r.preventDefault(),await this.sheet.redo()&&(this.render(),this.scrollIntoView()))}},{match:r=>Fe(r,"Escape"),run:r=>{r.preventDefault(),this.sheet.getCopyRange()&&(this.sheet.clearCopyBuffer(),this.renderOverlay())}},{match:r=>Ze(r,{key:"c",mod:!0}),run:async r=>{r.preventDefault(),await this.copy()}},{match:r=>Ze(r,{key:"v",mod:!0}),run:async r=>{this.readOnly||(r.preventDefault(),await this.paste())}},{match:r=>Ze(r,{key:"b",mod:!0}),run:async r=>{this.readOnly||(r.preventDefault(),await this.sheet.toggleRangeStyle("b"),this.render())}},{match:r=>Ze(r,{key:"i",mod:!0}),run:async r=>{this.readOnly||(r.preventDefault(),await this.sheet.toggleRangeStyle("i"),this.render())}},{match:r=>Ze(r,{key:"u",mod:!0}),run:async r=>{this.readOnly||(r.preventDefault(),await this.sheet.toggleRangeStyle("u"),this.render())}},{match:r=>Ze(r,{key:"s",mod:!0,shift:!0}),run:async r=>{this.readOnly||(r.preventDefault(),await this.sheet.toggleRangeStyle("st"),this.render())}},{match:r=>Ze(r,{key:"m",mod:!0,shift:!0}),run:async r=>{this.readOnly||(r.preventDefault(),await this.sheet.toggleMergeSelection()&&this.render())}}])}getRangeExtentRef(){const e=this.sheet.getActiveCell(),t=this.sheet.getRange();if(!t)return e;const r=Math.abs(e.r-t[0].r)>Math.abs(t[1].r-e.r)?t[0].r:t[1].r,o=Math.abs(e.c-t[0].c)>Math.abs(t[1].c-e.c)?t[0].c:t[1].c;return{r,c:o}}async reloadDimensions(){await this.sheet.loadDimensions(),await this.sheet.loadStyles(),await this.sheet.loadMerges(),await this.sheet.loadFreezePane(),await this.sheet.loadFilterState(),this.hiddenRows.clear(),this.hiddenRowSizeBackup.clear(),this.syncHiddenRowsFromSheet(),this.updateFreezeState()}getGridViewportRect(){const e=this.viewport,t=this.container.getBoundingClientRect();return{left:e.left-t.left,top:e.top-t.top,width:e.width,height:e.height}}getScrollableGridViewportRect(){const e=this.getGridViewportRect(),t=this.freezeState,r=ue+t.frozenWidth,o=oe+t.frozenHeight;return{left:e.left+r,top:e.top+o,width:Math.max(0,e.width-r),height:Math.max(0,e.height-o)}}getCellRect(e){const t=this.freezeState;return t.frozenRows>0||t.frozenCols>0?Vi(e,this.scroll,this.rowDim,this.colDim,t):Le(e,this.scroll,this.rowDim,this.colDim)}getCellRectInScrollableViewport(e){const t=this.freezeState,r=this.scroll,o=r.left+this.colDim.getOffset(t.frozenCols+1)-t.frozenWidth,i=r.top+this.rowDim.getOffset(t.frozenRows+1)-t.frozenHeight;return Le(e,{left:o,top:i},this.rowDim,this.colDim)}getRangeRect(e){return qn(this.getCellRect(e[0]),this.getCellRect(e[1]))}setOnRender(e){this.onRenderCallback=e}render(){this.renderVersion+=1,this.requestRenderFrame()}requestRenderFrame(){this.pendingRenderFrame===null&&(this.pendingRenderFrame=requestAnimationFrame(()=>{this.pendingRenderFrame=null,this.handleRenderFrame()}))}handleRenderFrame(){if(this.renderInFlight){this.renderQueued=!0;return}this.renderInFlight=!0;const e=this.renderVersion;this.performRender(e).finally(()=>{this.renderInFlight=!1,(this.renderQueued||this.renderVersion!==e)&&(this.renderQueued=!1,this.requestRenderFrame())})}async performRender(e){var t;this.sheet&&(this.formulaBar.render(),await this.renderSheet(e),!(!this.sheet||e!==this.renderVersion)&&(this.renderOverlay(),(t=this.onRenderCallback)==null||t.call(this)))}renderOverlay(){this.overlay.render(this.viewport,this.scroll,this.sheet.getActiveCell(),this.sheet.getPresences(),this.sheet.getRange(),this.rowDim,this.colDim,this.resizeHover,this.sheet.getSelectionType(),this.dragMove?{axis:this.dragMove.axis,dropIndex:this.dragMove.dropIndex}:null,this.formulaRanges,this.freezeState,this.freezeDrag,this.sheet.getCopyRange(),this.autofillPreview,this.shouldShowAutofillHandle(),this.sheet.getMerges())}get viewRange(){const e=this.scroll,t=this.viewport,r=this.freezeState,o=this.rowDim.getOffset(r.frozenRows+1),i=this.colDim.getOffset(r.frozenCols+1),n=Math.max(r.frozenRows+1,this.rowDim.findIndex(o+e.top)),s=Math.max(n,this.rowDim.findIndex(o+e.top+t.height)+1),a=Math.max(r.frozenCols+1,this.colDim.findIndex(i+e.left)),c=Math.max(a,this.colDim.findIndex(i+e.left+t.width)+1);return[{r:n,c:a},{r:s,c}]}scrollIntoView(e=this.sheet.getActiveCell()){const t=this.scroll,r=this.freezeState,o=r.frozenRows>0&&e.r<=r.frozenRows,i=r.frozenCols>0&&e.c<=r.frozenCols,n=Le(e,{left:0,top:0},this.rowDim,this.colDim),s=this.sheet.getMerges().get(de(e));if(s){const d=Le({r:e.r+s.rs-1,c:e.c+s.cs-1},{left:0,top:0},this.rowDim,this.colDim);n.width=d.left+d.width-n.left,n.height=d.top+d.height-n.top}const a=this.colDim.getOffset(r.frozenCols+1),c=this.rowDim.getOffset(r.frozenRows+1),u=this.viewport.width-ue-r.frozenWidth,h=this.viewport.height-oe-r.frozenHeight;let f=!1;if(!i){const d=a+t.left,p=d+u,y=n.left-ue,x=y+n.width;y<d?(this.scroll={left:y-a},f=!0):x>p&&(this.scroll={left:x-u-a},f=!0)}if(!o){const d=c+t.top,p=d+h,y=n.top-oe,x=y+n.height;y<d?(this.scroll={top:y-c},f=!0):x>p&&(this.scroll={top:x-h-c},f=!0)}f&&this.render()}getCellInputRect(e){const t=this.getCellRect(e),r=this.sheet.getMerges().get(de(e));if(!r)return t;const o=this.getCellRect({r:e.r+r.rs-1,c:e.c+r.cs-1});return t.width=o.left+o.width-t.left,t.height=o.top+o.height-t.top,t}resolveCellInputLayout(e){const t=this.getCellInputRect(e),r=this.viewport,o=ue,i=oe,n=r.width,s=r.height;if(t.left<n&&t.left+t.width>o&&t.top<s&&t.top+t.height>i)return{left:t.left,top:t.top,width:t.width,height:t.height,maxWidth:Math.max(t.width,r.width-t.left),maxHeight:Math.max(t.height,r.height-t.top),pinned:!1};const c=o+Xn,u=i+Xn,h=Math.max(c,r.width-t.width-Xn),f=Math.max(u,r.height-t.height-Xn),d=Math.min(h,Math.max(c,t.left)),p=Math.min(f,Math.max(u,t.top));return{left:d,top:p,width:t.width,height:t.height,maxWidth:Math.max(t.width,r.width-d-Xn),maxHeight:Math.max(t.height,r.height-p-Xn),pinned:!0}}updateAutocompletePositionForActiveInput(){if(!this.autocomplete.isListVisible()&&!this.autocomplete.isHintVisible())return;let e;if(this.cellInput.isFocused()?e=this.cellInput.getInput():this.formulaBar.isFocused()&&(e=this.formulaBar.getFormulaInput()),!e)return;const t=e.getBoundingClientRect();this.autocomplete.reposition({left:t.left,top:t.bottom+2})}updateCellInputPosition(){if(!this.sheet||!this.cellInput.isShown())return;const e=this.sheet.getActiveCell(),t=this.resolveCellInputLayout(e);this.cellInput.updatePlacement(t.left,t.top,t.width,t.height,t.maxWidth,t.maxHeight),this.cellInput.setCellPositionHint(t.pinned?de(e):void 0),this.updateAutocompletePositionForActiveInput()}async showCellInput(e=!1,t=!1){t||(this.editMode=!e);const r=this.sheet.getActiveCell(),o=this.resolveCellInputLayout(r),i=e?"":await this.sheet.toInputString(r);this.cellInput.show(o.left,o.top,i,!t,o.width,o.height,o.maxWidth,o.maxHeight),this.cellInput.setCellPositionHint(o.pinned?de(r):void 0);const n=await this.sheet.getStyle(r);this.cellInput.applyStyle(n),i.startsWith("=")&&(this.formulaRanges=Ii(i).map(s=>s.range),this.renderOverlay())}isValidCellInput(e){return e.length===1||e==="Process"}async renderSheet(e=this.renderVersion){const t=this.sheet;if(!t)return;this.syncHiddenRowsFromSheet();const r=this.gridSize,o=this.freezeState;this.gridContainer.updateDummySize(r.width+ue,r.height+oe);const i=this.viewport,n=this.scroll,s=this.viewRange,a=[{r:1,c:1},{r:s[1].r,c:s[1].c}],c=await t.fetchGrid(a);t!==this.sheet||e!==this.renderVersion||this.gridCanvas.render(i,n,s,t.getActiveCell(),c,this.rowDim,this.colDim,t.getSelectionType(),t.getRange(),o,this.freezeHandleHover,t.getColStyles(),t.getRowStyles(),t.getSheetStyle(),t.getRangeStyles(),t.getConditionalFormats(),t.getMerges(),t.getFilterRange(),t.getFilteredColumns(),this.filterButtonHoverCol)}syncHiddenRowsFromSheet(){const e=this.sheet;if(!e)return;const t=e.getHiddenRows();for(const r of this.hiddenRows){if(t.has(r))continue;const o=this.hiddenRowSizeBackup.get(r)??this.rowDim.getDefaultSize();this.rowDim.setSize(r,o),this.hiddenRowSizeBackup.delete(r)}for(const r of t)this.hiddenRows.has(r)||(this.hiddenRowSizeBackup.set(r,this.rowDim.getSize(r)),this.rowDim.setSize(r,0));this.hiddenRows=t}get gridSize(){const e=this.sheet.getDimension();return{width:this.colDim.getOffset(e.columns+1),height:this.rowDim.getOffset(e.rows+1)}}get viewport(){return this.gridContainer.getViewport()}get scroll(){return this.gridContainer.getScrollPosition()}set scroll(e){this.gridContainer.setScrollPosition(e)}}async function SS(l,e){const t=new wy(l,e),r=(e==null?void 0:e.store)||new iy;return await t.initialize(r),t}class wy{constructor(e,t){k(this,"container");k(this,"worksheet");k(this,"sheet");k(this,"theme");k(this,"_readOnly");k(this,"selectionChangeCallbacks",[]);this.container=e,this.container.style.position="relative",this.container.style.overflow="hidden",this.theme=(t==null?void 0:t.theme)||"light",this._readOnly=(t==null?void 0:t.readOnly)||!1,this.worksheet=new Ry(this.container,this.theme,this._readOnly)}get readOnly(){return this._readOnly}async initialize(e){this.sheet=new ny(e),this.worksheet.setOnRender(()=>this.notifySelectionChange()),await this.worksheet.initialize(this.sheet)}async reloadDimensions(){await this.worksheet.reloadDimensions()}async setFreezePane(e,t){this._readOnly||await this.worksheet.setFreezePane(e,t)}render(){this.worksheet.render()}renderOverlay(){this.worksheet.renderOverlay()}panBy(e,t){this.worksheet.panBy(e,t)}handleMobileDoubleTap(e,t){this.worksheet.handleMobileDoubleTap(e,t)}async applyStyle(e){!this.sheet||this._readOnly||(await this.sheet.setRangeStyle(e),this.worksheet.render(),this.notifySelectionChange())}async applyBorders(e){!this.sheet||this._readOnly||await this.sheet.setRangeBorders(e)&&(this.worksheet.render(),this.notifySelectionChange())}async toggleStyle(e){!this.sheet||this._readOnly||(await this.sheet.toggleRangeStyle(e),this.worksheet.render(),this.notifySelectionChange())}async getActiveStyle(){if(this.sheet)return this.sheet.getStyle(this.sheet.getActiveCell())}getConditionalFormats(){var e;return((e=this.sheet)==null?void 0:e.getConditionalFormats())||[]}async setConditionalFormats(e){!this.sheet||this._readOnly||(await this.sheet.setConditionalFormats(e),this.worksheet.render(),this.notifySelectionChange())}onSelectionChange(e){return this.selectionChangeCallbacks.push(e),()=>{this.selectionChangeCallbacks=this.selectionChangeCallbacks.filter(t=>t!==e)}}notifySelectionChange(){for(const e of this.selectionChangeCallbacks)e()}getSelectionType(){var e;return(e=this.sheet)==null?void 0:e.getSelectionType()}getSelectionRangeOrActiveCell(){var e;return(e=this.sheet)==null?void 0:e.getRangeOrActiveCell()}getGridViewportRect(){return this.worksheet.getGridViewportRect()}getScrollableGridViewportRect(){return this.worksheet.getScrollableGridViewportRect()}getCellRect(e){return this.worksheet.getCellRect(e)}getCellRectInScrollableViewport(e){return this.worksheet.getCellRectInScrollableViewport(e)}async increaseDecimals(){if(!this.sheet||this._readOnly)return;const e=await this.sheet.getActiveDecimalPlaces();await this.sheet.setRangeStyle({dp:e+1}),this.worksheet.render(),this.notifySelectionChange()}async decreaseDecimals(){if(!this.sheet||this._readOnly)return;const e=await this.sheet.getActiveDecimalPlaces();await this.sheet.setRangeStyle({dp:Math.max(0,e-1)}),this.worksheet.render(),this.notifySelectionChange()}async toggleMergeCells(){!this.sheet||this._readOnly||await this.sheet.toggleMergeSelection()&&(this.worksheet.render(),this.notifySelectionChange())}isSelectionMerged(){return this.sheet?this.sheet.isSelectionMerged():!1}canMergeSelection(){return this.sheet?this.sheet.canMergeSelection():!1}hasFilter(){var e;return((e=this.sheet)==null?void 0:e.hasFilter())||!1}async createFilterFromSelection(){if(!this.sheet||this._readOnly)return!1;const e=await this.sheet.createFilterFromSelection();return e&&(this.worksheet.render(),this.notifySelectionChange()),e}async clearFilter(){!this.sheet||this._readOnly||(await this.sheet.clearFilter(),this.worksheet.render(),this.notifySelectionChange())}async setColumnFilter(e,t){if(!this.sheet||this._readOnly)return!1;const r=await this.sheet.setColumnFilter(e,t);return r&&(this.worksheet.render(),this.notifySelectionChange()),r}async clearColumnFilter(e){if(!this.sheet||this._readOnly)return!1;const t=await this.sheet.clearColumnFilter(e);return t&&(this.worksheet.render(),this.notifySelectionChange()),t}async undo(){!this.sheet||this._readOnly||await this.sheet.undo()&&(this.worksheet.render(),this.notifySelectionChange())}async redo(){!this.sheet||this._readOnly||await this.sheet.redo()&&(this.worksheet.render(),this.notifySelectionChange())}toggleFunctionBrowser(){this.worksheet.toggleFunctionBrowser()}cleanup(){this.worksheet.cleanup(),this.selectionChangeCallbacks=[]}setGridResolver(e){this.sheet&&this.sheet.setGridResolver(e)}async recalculateCrossSheetFormulas(){this.sheet&&(await this.sheet.recalculateCrossSheetFormulas(),this.worksheet.render())}}const Ny=8,Oy=280,Fy=24;function AS({containerRef:l,sheetRef:e,enabled:t=!0}){const r=kp();Mp.useEffect(()=>{const o=l.current;if(!t||!r||!o)return;let i=0,n=0,s=0,a=0,c=!1,u=!1,h=0,f=0,d=0;const p=m=>{if(m.touches.length!==1){u=m.touches.length>1,c=!1;return}const g=m.touches[0];i=g.clientX,n=g.clientY,s=g.clientX,a=g.clientY},y=m=>{var b;if(m.touches.length!==1){u=u||m.touches.length>1;return}const g=m.touches[0],S=g.clientX-s,C=g.clientY-a,A=Math.hypot(g.clientX-i,g.clientY-n);!c&&A>=Ny&&(c=!0),c&&(m.preventDefault(),(b=e.current)==null||b.panBy(-S,-C)),s=g.clientX,a=g.clientY},x=m=>{var C;if(m.touches.length>0)return;if(u){u=!1,c=!1;return}if(c){c=!1;return}const g=Date.now(),S=Math.hypot(s-f,a-d);if(h!==0&&g-h<=Oy&&S<=Fy){(C=e.current)==null||C.handleMobileDoubleTap(s,a),h=0;return}h=g,f=s,d=a},v=()=>{c=!1,u=!1};return o.addEventListener("touchstart",p,{passive:!0}),o.addEventListener("touchmove",y,{passive:!1}),o.addEventListener("touchend",x,{passive:!0}),o.addEventListener("touchcancel",v,{passive:!0}),()=>{o.removeEventListener("touchstart",p),o.removeEventListener("touchmove",y),o.removeEventListener("touchend",x),o.removeEventListener("touchcancel",v)}},[l,t,r,e])}export{Dg as C,Dr as a,vS as b,Ui as c,zo as d,pp as e,Lg as f,ni as g,yg as h,Lo as i,Ep as j,mp as k,bp as l,Un as m,gr as n,xg as o,Te as p,_p as q,Ge as r,gg as s,de as t,gp as u,Rp as v,AS as w,SS as x};
