import{j as e,r as y}from"./vendor-react-Bg6UneQK.js";import{Q as K,U as M,V as P,t as p}from"./vendor-ui-DUghwSYy.js";import{B as N}from"./button-DWQ-sR7I.js";import{c as Q}from"./utils-DjqsqOe8.js";import{I as k}from"./input-BEpJFSyN.js";import{L as o}from"./label-CmhopHze.js";import{c as q,S as h}from"./IconDotsVertical-CWmuc0X_.js";import{S,a as w,b as A,c as I,d as g}from"./select-CwTFhjuc.js";import{r as G,I as R,p as H,f as J,g as O}from"./sheet-view-Cwx-ed1-.js";import{I as W}from"./IconX-ZR7dAakE.js";import"./index-3UDGtr2f.js";import"./index-Bux_NHpz.js";import"./vendor-app-HGRjaN7r.js";import"./vendor-yorkie-DqSL832E.js";import"./sheet-formula-D_DENlfx.js";import"./sheet-core-B5GRyhLw.js";import"./dropdown-menu-CQO2mrpo.js";import"./use-mobile-sheet-gestures-D5cbSotk.js";/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Y=q("outline","chart-line","IconChartLine",[["path",{d:"M4 19l16 0",key:"svg-0"}],["path",{d:"M4 15l4 -6l4 2l4 -5l4 4",key:"svg-1"}]]);function Z({className:c,...r}){return e.jsx(K,{"data-slot":"checkbox",className:Q("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",c),...r,children:e.jsx(M,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(P,{className:"size-3.5"})})})}function he({root:c,chart:r,open:z,onClose:D,onUpdateChart:l,getSelectionRange:E}){var b;const[m,d]=y.useState("");y.useEffect(()=>{d((r==null?void 0:r.sourceRange)||"")},[r==null?void 0:r.id,r==null?void 0:r.sourceRange]);const a=r?G(c,r):{columns:[],xAxisColumn:null,seriesColumns:[]};if(!z||!r)return null;const L=((b=c.tabs[r.sourceTabId])==null?void 0:b.name)||r.sourceTabId,f=a.xAxisColumn,j=a.columns.filter(s=>s.column!==f),T=new Set(a.seriesColumns),u=s=>{const t=H(s);if(!t){p.error("Enter a valid A1 range like A1:D20.");return}const n=t[1].r-t[0].r+1,i=t[1].c-t[0].c+1;if(n<2||i<2){p.error("Data range must include at least 2 rows and 2 columns.");return}const C=J(t),x=O(t),v={sourceRange:C,seriesColumns:x.seriesColumns};x.xAxisColumn&&(v.xAxisColumn=x.xAxisColumn),l(r.id,v),d(C)},B=s=>{s.key==="Enter"&&(s.preventDefault(),u(m))},F=()=>{const s=E();if(!s){p.error("Select a cell range first.");return}d(s),u(s)},V=s=>{const t=a.columns.map(i=>i.column).filter(i=>i!==s);let n=a.seriesColumns.filter(i=>t.includes(i));n.length===0&&(n=t.slice(0,1)),l(r.id,{xAxisColumn:s,seriesColumns:n})},X=(s,t)=>{const n=new Set(a.seriesColumns);t?n.add(s):n.delete(s),l(r.id,{seriesColumns:Array.from(n)})};return e.jsxs("aside",{className:"absolute inset-y-0 right-0 z-20 flex w-80 flex-col overflow-hidden border-l bg-background shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{size:16,className:"text-primary"}),e.jsx("p",{className:"text-sm font-semibold",children:"Chart editor"})]}),e.jsxs("p",{className:"truncate text-xs text-muted-foreground",children:["Source: ",L]})]}),e.jsx("button",{type:"button",className:"inline-flex h-7 w-7 items-center justify-center rounded-md text-muted-foreground hover:bg-muted hover:text-foreground",onClick:D,"aria-label":"Close chart editor",children:e.jsx(W,{size:16})})]}),e.jsxs("div",{className:"min-h-0 flex-1 space-y-4 overflow-y-auto overscroll-contain p-4 pb-6",children:[e.jsxs("section",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"chart-title",children:"Chart title"}),e.jsx(k,{id:"chart-title",value:r.title||"",onChange:s=>l(r.id,{title:s.target.value}),placeholder:"Chart"})]}),e.jsx(h,{}),e.jsxs("section",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"chart-type",children:"Chart type"}),e.jsxs(S,{value:r.type,onValueChange:s=>{l(r.id,{type:s})},children:[e.jsx(w,{id:"chart-type",className:"w-full",children:e.jsx(A,{})}),e.jsxs(I,{children:[e.jsx(g,{value:"bar",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(R,{size:14}),"Bar chart"]})}),e.jsx(g,{value:"line",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Y,{size:14}),"Line chart"]})})]})]})]}),e.jsx(h,{}),e.jsxs("section",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"chart-range",children:"Data range"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{id:"chart-range",value:m,onChange:s=>d(s.target.value),onKeyDown:B,placeholder:"A1:D20"}),e.jsx(N,{type:"button",variant:"outline",size:"sm",onClick:()=>u(m),children:"Apply"})]}),e.jsx(N,{type:"button",variant:"ghost",size:"sm",className:"px-0",onClick:F,children:"Use selected range"})]}),e.jsx(h,{}),e.jsxs("section",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"chart-x-axis",children:"X-axis"}),a.columns.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"Set a valid range to configure X-axis and series."}):e.jsxs(S,{value:f||"",onValueChange:V,children:[e.jsx(w,{id:"chart-x-axis",className:"w-full",children:e.jsx(A,{})}),e.jsx(I,{children:a.columns.map(s=>e.jsxs(g,{value:s.column,children:[s.column," - ",s.label]},s.column))})]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx(o,{children:"Series"}),j.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"No series columns available for this range."}):e.jsx("div",{className:"space-y-2",children:j.map(s=>e.jsxs("label",{className:"flex cursor-pointer items-center justify-between rounded-sm border px-2 py-1.5 hover:bg-muted/40",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"truncate text-sm font-medium",children:s.label}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.column})]}),e.jsx(Z,{checked:T.has(s.column),onCheckedChange:t=>X(s.column,t===!0)})]},s.column))})]})]})]})}export{he as ChartEditorPanel};
