var Kt=Object.defineProperty;var Wt=(u,s,e)=>s in u?Kt(u,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[s]=e;var K=(u,s,e)=>Wt(u,typeof s!="symbol"?s+"":s,e);import{a as P,F as G,b as w}from"./sheet-formula-parser-CbheDyXI.js";import{t as M,i as I,a as W,p as J,b as nt,c as Z,d as yt,e as wt}from"./sheet-core-wpLUU54d.js";class tt{constructor(){K(this,"ref");K(this,"bool");K(this,"num");K(this,"str")}static create(){return new tt}setRef(s){return this.ref=s,this}setBool(s){return this.bool=s,this}setNum(s){return this.num=s,this}setStr(s){return this.str=s,this}map(s,e){return s.t==="bool"&&this.bool?this.bool(s):s.t==="num"&&this.num?this.num(s):s.t==="str"&&this.str?this.str(s):s.t==="ref"&&this.ref&&e?this.ref(s,e):s}*iterate(s,e,n){for(const t of s.expr()){const r=e(t);if(r.t==="ref"&&n)for(const a of M([r.v]))yield this.ref({t:"ref",v:a},n);else yield this.map(r)}}}function Qt(u){return{t:"num",v:u.v?1:0}}function $t(u){const s=Number(u);return{t:"num",v:isNaN(s)?0:s}}function zt(u,s){var t;if(I(u.v))return{t:"err",v:"#VALUE!"};const e=((t=s.get(u.v))==null?void 0:t.v)||"",n=Number(e);return{t:"num",v:isNaN(n)?0:n}}const v=tt.create().setRef(zt).setBool(Qt).setStr($t);function jt(u){return{t:"bool",v:u.v!==0}}function Jt(u,s){var t;if(I(u.v))return{t:"err",v:"#VALUE!"};const e=((t=s.get(u.v))==null?void 0:t.v)||"";if(e==="TRUE"||e==="true")return{t:"bool",v:!0};if(e==="FALSE"||e==="false"||e==="")return{t:"bool",v:!1};const n=Number(e);return isNaN(n)?{t:"err",v:"#VALUE!"}:{t:"bool",v:n!==0}}const L=tt.create().setRef(Jt).setNum(jt).setStr(()=>({t:"err",v:"#VALUE!"}));function Zt(u){return{t:"str",v:u.v.toString()}}function tr(u){return{t:"str",v:u.v?"TRUE":"FALSE"}}function _t(u,s){var n;return I(u.v)?{t:"err",v:"#VALUE!"}:{t:"str",v:((n=s.get(u.v))==null?void 0:n.v)||""}}tt.create().setRef(_t).setNum(Zt).setBool(tr);const xt=new Map([["SUM",rr],["ABS",er],["ROUND",sr],["ROUNDUP",ar],["ROUNDDOWN",or],["INT",ur],["MOD",cr],["SQRT",ir],["POWER",fr],["PRODUCT",vr],["MEDIAN",pr],["IF",gr],["IFS",hr],["SWITCH",Nr],["AND",Ar],["OR",dr],["NOT",xr],["AVERAGE",Er],["MIN",Mr],["MAX",Rr],["COUNT",br],["COUNTA",Ir],["COUNTBLANK",Tr],["COUNTIF",Fr],["SUMIF",Sr],["COUNTIFS",Lr],["SUMIFS",Ur],["MATCH",Cr],["INDEX",Vr],["VLOOKUP",Dr],["HLOOKUP",Or],["TRIM",yr],["LEN",wr],["LEFT",_r],["RIGHT",Pr],["MID",kr],["CONCATENATE",Xt],["CONCAT",Xr],["FIND",Br],["SEARCH",Hr],["TEXTJOIN",Gr],["LOWER",Yr],["UPPER",qr],["PROPER",Kr],["SUBSTITUTE",Wr],["TODAY",Qr],["NOW",$r],["DATE",zr],["TIME",jr],["DAYS",Jr],["YEAR",Zr],["MONTH",te],["DAY",re],["HOUR",ee],["MINUTE",ne],["SECOND",se],["WEEKDAY",ae],["RAND",mr],["RANDBETWEEN",lr],["ISBLANK",oe],["ISNUMBER",ue],["ISTEXT",ce],["ISERROR",ie],["ISERR",fe],["ISNA",me],["ISLOGICAL",le],["ISNONTEXT",ve],["IFERROR",pe],["IFNA",ge],["PI",he],["SIGN",Ne],["EVEN",Ae],["ODD",de],["EXP",xe],["LN",Ee],["LOG",Me],["SIN",Re],["COS",be],["TAN",Ie],["ASIN",Te],["ACOS",Fe],["ATAN",Se],["ATAN2",Le],["DEGREES",Ue],["RADIANS",Ce],["CEILING",Ve],["FLOOR",De],["TRUNC",Oe],["MROUND",ye],["EXACT",we],["REPLACE",_e],["REPT",Pe],["T",ke],["VALUE",Xe],["TEXT",Be],["CHAR",He],["CODE",Ge],["AVERAGEIF",Ye],["AVERAGEIFS",qe],["LARGE",Ke],["SMALL",We],["N",Qe],["SUMPRODUCT",$e],["GCD",ze],["LCM",je],["COMBIN",Je],["FACT",Ze],["QUOTIENT",tn],["XOR",rn],["CHOOSE",en],["TYPE",nn],["EDATE",sn],["EOMONTH",an],["NETWORKDAYS",on],["DATEVALUE",un],["TIMEVALUE",cn],["DATEDIF",fn],["ROW",mn],["COLUMN",ln],["ROWS",vn],["COLUMNS",pn],["ADDRESS",gn],["HYPERLINK",hn],["MINIFS",Nn],["MAXIFS",An],["RANK",Et],["PERCENTILE",Mt],["CLEAN",dn],["NUMBERVALUE",xn],["STDEV",Rt],["STDEVP",bt],["STDEV.S",Rt],["STDEV.P",bt],["VAR",It],["VARP",Tt],["VAR.S",It],["VAR.P",Tt],["MODE",Ft],["MODE.SNGL",Ft],["SUMSQ",En],["NA",Mn],["QUARTILE",St],["QUARTILE.INC",St],["COUNTUNIQUE",Rn],["FIXED",bn],["DOLLAR",In],["WEEKNUM",Tn],["ISOWEEKNUM",Fn],["WORKDAY",Sn],["YEARFRAC",Ln],["LOOKUP",Un],["INDIRECT",Cn],["ERROR.TYPE",Vn],["ISDATE",Dn],["SPLIT",On],["JOIN",yn],["REGEXMATCH",wn],["FORECAST",Lt],["FORECAST.LINEAR",Lt],["SLOPE",_n],["INTERCEPT",Pn],["CORREL",kn],["XLOOKUP",Xn],["OFFSET",Bn],["ISEVEN",Hn],["ISODD",Gn],["FACTDOUBLE",Yn],["BASE",qn],["DECIMAL",Kn],["SQRTPI",Wn],["SINH",Qn],["COSH",$n],["TANH",zn],["ASINH",jn],["ACOSH",Jn],["ATANH",Zn],["COT",ts],["CSC",rs],["SEC",es],["REGEXEXTRACT",ns],["REGEXREPLACE",ss],["UNICODE",as],["UNICHAR",os],["GEOMEAN",us],["HARMEAN",cs],["AVEDEV",is],["DEVSQ",fs],["TRIMMEAN",ms],["PERMUT",ls],["PMT",vs],["FV",ps],["PV",gs],["NPV",hs],["NPER",Ns],["IPMT",As],["PPMT",ds],["SLN",xs],["EFFECT",Es],["RATE",Ms],["IRR",Rs],["DB",bs],["DDB",Is],["NOMINAL",Ts],["CUMIPMT",Fs],["CUMPRINC",Ss],["AVERAGEA",Ls],["MINA",Us],["MAXA",Cs],["FISHER",Vs],["FISHERINV",Ds],["GAMMA",Os],["GAMMALN",ys],["NORMDIST",Ut],["NORM.DIST",Ut],["NORMINV",Ct],["NORM.INV",Ct],["LOGNORMAL.DIST",ws],["LOGNORMAL.INV",_s],["STANDARDIZE",Ps],["WEIBULL.DIST",ks],["POISSON.DIST",Xs],["BINOM.DIST",Bs],["EXPON.DIST",Hs],["CONFIDENCE.NORM",Gs],["CONFIDENCE.T",zs],["CHISQ.DIST",Ys],["CHISQ.INV",qs],["T.DIST",Ks],["T.INV",Ws],["HYPGEOM.DIST",Qs],["NEGBINOM.DIST",$s],["ARABIC",js],["ROMAN",Js],["MULTINOMIAL",Zs],["SERIESSUM",ta],["DELTA",ra],["GESTEP",ea],["ERF",na],["ERFC",sa],["XNPV",aa],["XIRR",oa],["SYD",ua],["MIRR",ca],["TBILLEQ",ia],["TBILLPRICE",fa],["TBILLYIELD",ma],["DOLLARDE",la],["DOLLARFR",va],["ENCODEURL",pa],["ISURL",ga],["ISFORMULA",ha],["FORMULATEXT",Na],["CEILING.MATH",Aa],["FLOOR.MATH",da],["CEILING.PRECISE",xa],["FLOOR.PRECISE",Ea],["COVAR",Vt],["COVARIANCE.P",Vt],["COVARIANCE.S",Ma],["RSQ",Ra],["STEYX",ba],["SUMX2MY2",Ia],["SUMX2PY2",Ta],["SUMXMY2",Fa],["PERCENTILE.INC",Mt],["PERCENTILE.EXC",Sa],["QUARTILE.EXC",La],["RANK.AVG",Ua],["RANK.EQ",Et],["PERCENTRANK",Dt],["PERCENTRANK.INC",Dt],["PERCENTRANK.EXC",Ca],["BETA.DIST",Va],["BETA.INV",Da],["F.DIST",Oa],["F.INV",ya],["GAMMA.DIST",wa],["GAMMA.INV",_a],["CHISQ.DIST.RT",Pa],["CHISQ.INV.RT",ka],["T.DIST.RT",Xa],["T.DIST.2T",Ba],["T.INV.2T",Ha],["F.DIST.RT",Ga],["F.INV.RT",Ya],["BINOM.INV",qa],["TEXTBEFORE",Ka],["TEXTAFTER",Wa],["VALUETOTEXT",Qa],["SEQUENCE",$a],["RANDARRAY",za],["SORT",ja],["UNIQUE",Ja],["FLATTEN",Za],["TRANSPOSE",to],["NORM.S.DIST",ro],["NORM.S.INV",eo],["SUBTOTAL",no],["VARA",so],["VARPA",ao],["SKEW",oo],["KURT",uo],["ISREF",co],["SHEET",io],["SHEETS",fo],["MDETERM",mo],["PROB",lo],["CONVERT",vo],["BITAND",po],["BITOR",go],["BITXOR",ho],["BITLSHIFT",No],["BITRSHIFT",Ao],["HEX2DEC",xo],["DEC2HEX",Eo],["BIN2DEC",Mo],["DEC2BIN",Ro],["OCT2DEC",bo],["DEC2OCT",Io],["COMPLEX",To],["IMREAL",Fo],["IMAGINARY",So],["IMABS",Lo],["IMSUM",Uo],["IMSUB",Co],["IMPRODUCT",Vo],["IMDIV",Do],["IMCONJUGATE",Oo],["IMARGUMENT",yo],["IMPOWER",wo],["IMSQRT",_o],["IMEXP",Po],["IMLN",ko],["IMLOG2",Xo],["IMLOG10",Bo],["IMSIN",Ho],["IMCOS",Go],["IMTAN",Yo],["IMSINH",qo],["IMCOSH",Ko],["IMSEC",Wo],["IMCSC",Qo],["IMCOT",$o],["HEX2BIN",zo],["HEX2OCT",jo],["BIN2HEX",Jo],["BIN2OCT",Zo],["OCT2HEX",tu],["OCT2BIN",ru],["BESSELJ",nu],["BESSELY",su]]);function rr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0;for(const r of v.iterate(n,s,e)){if(r.t==="err")return r;t+=r.v}return{t:"num",v:t}}function er(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.abs(r.v)}}function nr(u){return u>=0?Math.floor(u+.5):Math.ceil(u-.5)}function mt(u,s,e){if(!u)return{t:"num",v:0};const n=v.map(s(u),e);return n.t==="err"?n:{t:"num",v:Math.trunc(n.v)}}function U(u){return typeof u=="object"&&u!==null&&u.t==="err"}function x(u,s,e){const n=s(u);return n.t==="err"?n:n.t!=="ref"||!e?{t:"err",v:"#VALUE!"}:{t:"refs",v:Array.from(M([n.v]))}}function st(u,s,e){const n=s(u);if(n.t==="err")return n;if(n.t!=="ref"||!e)return{t:"err",v:"#VALUE!"};if(!I(n.v))return{t:"matrix",v:{refs:[n.v],rowCount:1,colCount:1}};try{let t=n.v,r="";if(W(n.v)){const{sheetName:i,localRef:f}=J(n.v);t=f,r=`${i}!`}const[a,o]=Z(t),c=[];for(let i=a.r;i<=o.r;i++)for(let f=a.c;f<=o.c;f++)c.push(`${r}${wt({r:i,c:f})}`);return{t:"matrix",v:{refs:c,rowCount:o.r-a.r+1,colCount:o.c-a.c+1}}}catch{return{t:"err",v:"#VALUE!"}}}function Pt(u){const s=u===""?void 0:Number(u),e=s===void 0||isNaN(s)?void 0:s,n=u.toUpperCase(),t=n==="TRUE"?!0:n==="FALSE"?!1:void 0;return{normalized:u.toLowerCase(),numericValue:e,boolValue:t}}function lt(u,s){const e=A(u,s);return e.t==="err"?e:Pt(e.v)}function Y(u,s){var n;const e=((n=s==null?void 0:s.get(u))==null?void 0:n.v)||"";return Pt(e)}function vt(u,s){return u.numericValue!==void 0&&s.numericValue!==void 0?u.numericValue===s.numericValue:u.boolValue!==void 0&&s.boolValue!==void 0?u.boolValue===s.boolValue:u.normalized===s.normalized}function et(u,s){return u.numericValue!==void 0&&s.numericValue!==void 0?u.numericValue-s.numericValue:u.boolValue!==void 0&&s.boolValue!==void 0?Number(u.boolValue)-Number(s.boolValue):u.normalized.localeCompare(s.normalized)}function kt(u){const s=Number(u);return isNaN(s)?0:s}function X(u,s){if(u.t==="err")return u;if(u.t==="num")return{op:"=",value:u.v.toString(),numericValue:u.v};if(u.t==="bool")return{op:"=",value:u.v?"TRUE":"FALSE",boolValue:u.v};const e=A(u,s);if(e.t==="err")return e;const n=/^(<=|>=|<>|=|<|>)(.*)$/.exec(e.v),t=(n==null?void 0:n[1])||"=",r=n?n[2]:e.v;let a,o;if(r!==""){const i=Number(r);isNaN(i)?r.toUpperCase()==="TRUE"?o=!0:r.toUpperCase()==="FALSE"&&(o=!1):a=i}let c;return(t==="="||t==="<>")&&/(^|[^~])[*?]/.test(r)&&(c=new RegExp(`^${Ht(r)}$`,"i")),{op:t,value:r,numericValue:a,boolValue:o,wildcardPattern:c}}function B(u,s){const e=u===""?void 0:Number(u),n=e!==void 0&&!isNaN(e),t=u.toUpperCase(),r=t==="TRUE"?!0:t==="FALSE"?!1:void 0,a=u.toLowerCase(),o=s.value.toLowerCase();if(s.op==="<"||s.op==="<="||s.op===">"||s.op===">=")return s.numericValue!==void 0?n?s.op==="<"?e<s.numericValue:s.op==="<="?e<=s.numericValue:s.op===">"?e>s.numericValue:e>=s.numericValue:!1:s.op==="<"?a<o:s.op==="<="?a<=o:s.op===">"?a>o:a>=o;let c=!1;return s.wildcardPattern?c=s.wildcardPattern.test(u):s.numericValue!==void 0&&n?c=e===s.numericValue:s.boolValue!==void 0&&r!==void 0?c=r===s.boolValue:c=a===o,s.op==="="?c:!c}function sr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=mt(t[1],s,e);if(a.t==="err")return a;const o=10**a.v;return{t:"num",v:nr(r.v*o)/o}}function ar(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=mt(t[1],s,e);if(a.t==="err")return a;const o=10**a.v,c=r.v*o;return{t:"num",v:(c>=0?Math.ceil(c):Math.floor(c))/o}}function or(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=mt(t[1],s,e);if(a.t==="err")return a;const o=10**a.v,c=r.v*o;return{t:"num",v:(c>=0?Math.floor(c):Math.ceil(c))/o}}function ur(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.floor(r.v)}}function cr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:a.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:r.v-a.v*Math.floor(r.v/a.v)}}function ir(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.sqrt(r.v)}}function fr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.pow(r.v,a.v);return isFinite(o)?{t:"num",v:o}:{t:"err",v:"#VALUE!"}}function mr(u,s,e){const n=u.args();return n&&n.expr().length>0?{t:"err",v:"#N/A!"}:{t:"num",v:Math.random()}}function lr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.ceil(r.v),c=Math.floor(a.v);return o>c?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.floor(Math.random()*(c-o+1))+o}}function vr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=1;for(const r of v.iterate(n,s,e)){if(r.t==="err")return r;t*=r.v}return{t:"num",v:t}}function pr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const a of v.iterate(n,s,e)){if(a.t==="err")return a;t.push(a.v)}if(t.length===0)return{t:"err",v:"#VALUE!"};t.sort((a,o)=>a-o);const r=Math.floor(t.length/2);return t.length%2===1?{t:"num",v:t[r]}:{t:"num",v:(t[r-1]+t[r])/2}}function gr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=L.map(s(t[0]),e);return r.t==="err"?r:r.v?s(t[1]):t.length===3?s(t[2]):{t:"bool",v:!1}}function hr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length%2!==0)return{t:"err",v:"#N/A!"};for(let r=0;r<t.length;r+=2){const a=L.map(s(t[r]),e);if(a.t==="err")return a;if(a.v)return s(t[r+1])}return{t:"err",v:"#N/A!"}}function Nr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=t.length-1,o=a%2===1,c=o?(a-1)/2:a/2;for(let i=0;i<c;i++){const f=A(s(t[1+i*2]),e);if(f.t==="err")return f;if(f.v===r.v)return s(t[2+i*2])}return o?s(t[t.length-1]):{t:"err",v:"#N/A!"}}function Ar(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};for(const t of L.iterate(n,s,e)){if(t.t==="err")return t;if(!t.v)return{t:"bool",v:!1}}return{t:"bool",v:!0}}function dr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};for(const t of L.iterate(n,s,e)){if(t.t==="err")return t;if(t.v)return{t:"bool",v:!0}}return{t:"bool",v:!1}}function xr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=L.map(s(t[0]),e);return r.t==="err"?r:{t:"bool",v:!r.v}}function Er(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0,r=0;for(const a of v.iterate(n,s,e)){if(a.t==="err")return a;t+=a.v,r++}return r===0?{t:"err",v:"#VALUE!"}:{t:"num",v:t/r}}function Mr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=1/0;for(const r of v.iterate(n,s,e)){if(r.t==="err")return r;r.v<t&&(t=r.v)}return{t:"num",v:t}}function Rr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=-1/0;for(const r of v.iterate(n,s,e)){if(r.t==="err")return r;r.v>t&&(t=r.v)}return{t:"num",v:t}}function br(u,s,e){var r,a;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0;for(const o of n.expr()){const c=s(o);if(c.t==="num")t++;else if(c.t==="bool")t++;else if(c.t==="ref"&&e)if(I(c.v))for(const i of M([c.v])){const f=((r=e.get(i))==null?void 0:r.v)||"";f!==""&&!isNaN(Number(f))&&t++}else{const i=((a=e.get(c.v))==null?void 0:a.v)||"";i!==""&&!isNaN(Number(i))&&t++}}return{t:"num",v:t}}function Ir(u,s,e){var r,a;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0;for(const o of n.expr()){const c=s(o);if(c.t==="num"||c.t==="bool")t++;else if(c.t==="str")c.v!==""&&t++;else if(c.t==="ref"&&e)if(I(c.v))for(const i of M([c.v]))(((r=e.get(i))==null?void 0:r.v)||"")!==""&&t++;else(((a=e.get(c.v))==null?void 0:a.v)||"")!==""&&t++}return{t:"num",v:t}}function Tr(u,s,e){var r,a;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0;for(const o of n.expr()){const c=s(o);if(c.t==="str"){c.v===""&&t++;continue}if(c.t!=="ref"||!e)continue;if(I(c.v)){for(const f of M([c.v]))(((r=e.get(f))==null?void 0:r.v)||"")===""&&t++;continue}(((a=e.get(c.v))==null?void 0:a.v)||"")===""&&t++}return{t:"num",v:t}}function Fr(u,s,e){var c;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=x(t[0],s,e);if(r.t==="err")return r;const a=X(s(t[1]),e);if(U(a))return a;let o=0;for(const i of r.v){const f=((c=e==null?void 0:e.get(i))==null?void 0:c.v)||"";B(f,a)&&o++}return{t:"num",v:o}}function Sr(u,s,e){var i,f;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=x(t[0],s,e);if(r.t==="err")return r;const a=X(s(t[1]),e);if(U(a))return a;const o=t.length===3?x(t[2],s,e):r;if(o.t==="err")return o;if(r.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};let c=0;for(let m=0;m<r.v.length;m++){const l=((i=e==null?void 0:e.get(r.v[m]))==null?void 0:i.v)||"";if(!B(l,a))continue;const p=((f=e==null?void 0:e.get(o.v[m]))==null?void 0:f.v)||"";c+=kt(p)}return{t:"num",v:c}}function Lr(u,s,e){var i;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length%2!==0)return{t:"err",v:"#N/A!"};const r=[],a=[];for(let f=0;f<t.length;f+=2){const m=x(t[f],s,e);if(m.t==="err")return m;r.push(m.v);const l=X(s(t[f+1]),e);if(U(l))return l;a.push(l)}const o=r[0].length;if(r.some(f=>f.length!==o))return{t:"err",v:"#VALUE!"};let c=0;for(let f=0;f<o;f++){let m=!0;for(let l=0;l<r.length;l++){const p=((i=e==null?void 0:e.get(r[l][f]))==null?void 0:i.v)||"";if(!B(p,a[l])){m=!1;break}}m&&c++}return{t:"num",v:c}}function Ur(u,s,e){var i,f;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||(t.length-1)%2!==0)return{t:"err",v:"#N/A!"};const r=x(t[0],s,e);if(r.t==="err")return r;const a=[],o=[];for(let m=1;m<t.length;m+=2){const l=x(t[m],s,e);if(l.t==="err")return l;a.push(l.v);const p=X(s(t[m+1]),e);if(U(p))return p;o.push(p)}if(a.some(m=>m.length!==r.v.length))return{t:"err",v:"#VALUE!"};let c=0;for(let m=0;m<r.v.length;m++){let l=!0;for(let p=0;p<a.length;p++){const g=((i=e==null?void 0:e.get(a[p][m]))==null?void 0:i.v)||"";if(!B(g,o[p])){l=!1;break}}l&&(c+=kt(((f=e==null?void 0:e.get(r.v[m]))==null?void 0:f.v)||""))}return{t:"num",v:c}}function Cr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=lt(s(t[0]),e);if(U(r))return r;const a=st(t[1],s,e);if(a.t==="err")return a;if(a.v.rowCount>1&&a.v.colCount>1)return{t:"err",v:"#N/A!"};let o=1;if(t.length===3){const i=v.map(s(t[2]),e);if(i.t==="err")return i;o=Math.trunc(i.v)}if(o!==-1&&o!==0&&o!==1)return{t:"err",v:"#N/A!"};if(o===0){for(let i=0;i<a.v.refs.length;i++){const f=Y(a.v.refs[i],e);if(vt(f,r))return{t:"num",v:i+1}}return{t:"err",v:"#N/A!"}}let c=-1;if(o===1){let i=-1/0;for(let f=0;f<a.v.refs.length;f++){const m=Y(a.v.refs[f],e),l=et(m,r);l<=0&&l>i&&(i=l,c=f)}}else{let i=1/0;for(let f=0;f<a.v.refs.length;f++){const m=Y(a.v.refs[f],e),l=et(m,r);l>=0&&l<i&&(i=l,c=f)}}return c<0?{t:"err",v:"#N/A!"}:{t:"num",v:c+1}}function Vr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const r=st(t[0],s,e);if(r.t==="err")return r;let a=1,o=1;if(t.length>=2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);t.length===2&&r.v.rowCount===1&&r.v.colCount>1?o=i:a=i}if(t.length===3){const c=v.map(s(t[2]),e);if(c.t==="err")return c;o=Math.trunc(c.v)}return a<=0||o<=0?{t:"err",v:"#VALUE!"}:a>r.v.rowCount||o>r.v.colCount?{t:"err",v:"#REF!"}:{t:"ref",v:r.v.refs[(a-1)*r.v.colCount+(o-1)]}}function Dr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const r=lt(s(t[0]),e);if(U(r))return r;const a=st(t[1],s,e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<=0)return{t:"err",v:"#VALUE!"};if(c>a.v.colCount)return{t:"err",v:"#REF!"};let i=!0;if(t.length===4){const l=L.map(s(t[3]),e);if(l.t==="err")return l;i=l.v}if(!i){for(let l=0;l<a.v.rowCount;l++){const p=a.v.refs[l*a.v.colCount],g=Y(p,e);if(vt(g,r))return{t:"ref",v:a.v.refs[l*a.v.colCount+(c-1)]}}return{t:"err",v:"#N/A!"}}let f=-1,m=-1/0;for(let l=0;l<a.v.rowCount;l++){const p=a.v.refs[l*a.v.colCount],g=Y(p,e),h=et(g,r);h<=0&&h>m&&(m=h,f=l)}return f<0?{t:"err",v:"#N/A!"}:{t:"ref",v:a.v.refs[f*a.v.colCount+(c-1)]}}function Or(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const r=lt(s(t[0]),e);if(U(r))return r;const a=st(t[1],s,e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<=0)return{t:"err",v:"#VALUE!"};if(c>a.v.rowCount)return{t:"err",v:"#REF!"};let i=!0;if(t.length===4){const l=L.map(s(t[3]),e);if(l.t==="err")return l;i=l.v}if(!i){for(let l=0;l<a.v.colCount;l++){const p=a.v.refs[l],g=Y(p,e);if(vt(g,r))return{t:"ref",v:a.v.refs[(c-1)*a.v.colCount+l]}}return{t:"err",v:"#N/A!"}}let f=-1,m=-1/0;for(let l=0;l<a.v.colCount;l++){const p=a.v.refs[l],g=Y(p,e),h=et(g,r);h<=0&&h>m&&(m=h,f=l)}return f<0?{t:"err",v:"#N/A!"}:{t:"ref",v:a.v.refs[(c-1)*a.v.colCount+f]}}function A(u,s){return u.t==="err"||u.t==="str"?u:u.t==="num"?{t:"str",v:u.v.toString()}:u.t==="bool"?{t:"str",v:u.v?"TRUE":"FALSE"}:u.t==="ref"&&s?_t(u,s):{t:"err",v:"#VALUE!"}}function yr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);return r.t==="err"?r:{t:"str",v:r.v.trim()}}function wr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);return r.t==="err"?r:{t:"num",v:r.v.length}}function _r(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;let a=1;if(t.length===2){const o=v.map(s(t[1]),e);if(o.t==="err")return o;a=o.v}return{t:"str",v:r.v.slice(0,a)}}function Pr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;let a=1;if(t.length===2){const o=v.map(s(t[1]),e);if(o.t==="err")return o;a=o.v}return{t:"str",v:r.v.slice(-a)}}function kr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=a.v-1;return{t:"str",v:r.v.slice(c,c+o.v)}}function Xt(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2)return{t:"err",v:"#N/A!"};let r="";for(const a of t){const o=A(s(a),e);if(o.t==="err")return o;r+=o.v}return{t:"str",v:r}}function Xr(u,s,e){return Xt(u,s,e)}function Bt(u,s,e,n){if(!u)return{t:"num",v:1};const t=v.map(e(u),n);if(t.t==="err")return t;const r=Math.trunc(t.v);return r<1||r>s.length+1?{t:"err",v:"#VALUE!"}:{t:"num",v:r}}function Br(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;const o=Bt(t[2],a.v,s,e);if(o.t==="err")return o;if(r.v==="")return{t:"num",v:o.v};const c=a.v.indexOf(r.v,o.v-1);return c<0?{t:"err",v:"#VALUE!"}:{t:"num",v:c+1}}function Ht(u){let s="";for(let e=0;e<u.length;e++){const n=u[e];if(n==="~"&&e+1<u.length){s+=u[e+1].replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),e++;continue}if(n==="*"){s+=".*";continue}if(n==="?"){s+=".";continue}s+=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}return s}function Hr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;const o=Bt(t[2],a.v,s,e);if(o.t==="err")return o;if(r.v==="")return{t:"num",v:o.v};const c=Ht(r.v),i=new RegExp(c,"i"),f=a.v.slice(o.v-1),m=i.exec(f);return!m||m.index===void 0?{t:"err",v:"#VALUE!"}:{t:"num",v:o.v+m.index}}function Gr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=L.map(s(t[1]),e);if(a.t==="err")return a;const o=[];for(const c of t.slice(2)){const i=s(c);if(i.t==="ref"&&e&&I(i.v)){for(const m of M([i.v])){const l=A({t:"ref",v:m},e);if(l.t==="err")return l;a.v&&l.v===""||o.push(l.v)}continue}const f=A(i,e);if(f.t==="err")return f;a.v&&f.v===""||o.push(f.v)}return{t:"str",v:o.join(r.v)}}function Yr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);return r.t==="err"?r:{t:"str",v:r.v.toLowerCase()}}function qr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);return r.t==="err"?r:{t:"str",v:r.v.toUpperCase()}}function Kr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);return r.t==="err"?r:{t:"str",v:r.v.toLowerCase().replace(/\b([a-z])([a-z]*)/g,(o,c,i)=>c.toUpperCase()+i)}}function Wr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;const o=A(s(t[2]),e);if(o.t==="err")return o;if(a.v==="")return{t:"str",v:r.v};if(t.length===3)return{t:"str",v:r.v.split(a.v).join(o.v)};const c=v.map(s(t[3]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<=0)return{t:"err",v:"#VALUE!"};let f=0,m=0;for(;;){const l=r.v.indexOf(a.v,f);if(l<0)return{t:"str",v:r.v};if(m++,m===i)return{t:"str",v:r.v.slice(0,l)+o.v+r.v.slice(l+a.v.length)};f=l+a.v.length}}function k(u){const s=u.getFullYear(),e=String(u.getMonth()+1).padStart(2,"0"),n=String(u.getDate()).padStart(2,"0");return`${s}-${e}-${n}`}function Gt(u){const s=String(u.getHours()).padStart(2,"0"),e=String(u.getMinutes()).padStart(2,"0"),n=String(u.getSeconds()).padStart(2,"0");return`${s}:${e}:${n}`}function Qr(u,s,e){const n=u.args();return n&&n.expr().length>0?{t:"err",v:"#N/A!"}:{t:"str",v:k(new Date)}}function $r(u,s,e){const n=u.args();if(n&&n.expr().length>0)return{t:"err",v:"#N/A!"};const t=new Date;return{t:"str",v:`${k(t)} ${Gt(t)}`}}function S(u,s){const e=A(u,s);if(e.t==="err")return e;const n=new Date(e.v);return isNaN(n.getTime())?{t:"err",v:"#VALUE!"}:n}function at(u,s){const e=A(u,s);if(e.t==="err")return e;const n=/^(\d{1,2}):(\d{1,2})(?::(\d{1,2}))?$/.exec(e.v.trim());if(n){const r=Number(n[1]),a=Number(n[2]),o=Number(n[3]||"0");return r<0||r>23||a<0||a>59||o<0||o>59?{t:"err",v:"#VALUE!"}:new Date(1970,0,1,r,a,o)}const t=new Date(e.v);return isNaN(t.getTime())?{t:"err",v:"#VALUE!"}:t}function zr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=Math.trunc(r.v),i=Math.trunc(a.v),f=Math.trunc(o.v);return!isFinite(c)||!isFinite(i)||!isFinite(f)?{t:"err",v:"#VALUE!"}:{t:"str",v:k(new Date(c,i-1,f))}}function jr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=Math.trunc(r.v),i=Math.trunc(a.v),f=Math.trunc(o.v);return!isFinite(c)||!isFinite(i)||!isFinite(f)?{t:"err",v:"#VALUE!"}:{t:"str",v:Gt(new Date(1970,0,1,c,i,f))}}function Jr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;const a=S(s(t[1]),e);if(!(a instanceof Date))return a;const o=24*60*60*1e3,c=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate()),i=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate());return{t:"num",v:(c-i)/o}}function Zr(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);return r instanceof Date?{t:"num",v:r.getFullYear()}:r}function te(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);return r instanceof Date?{t:"num",v:r.getMonth()+1}:r}function re(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);return r instanceof Date?{t:"num",v:r.getDate()}:r}function ee(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=at(s(t[0]),e);return r instanceof Date?{t:"num",v:r.getHours()}:r}function ne(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=at(s(t[0]),e);return r instanceof Date?{t:"num",v:r.getMinutes()}:r}function se(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=at(s(t[0]),e);return r instanceof Date?{t:"num",v:r.getSeconds()}:r}function ae(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;let a=1;if(t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;a=Math.trunc(c.v)}const o=r.getDay();return a===1?{t:"num",v:o+1}:a===2?{t:"num",v:o===0?7:o}:a===3?{t:"num",v:o===0?6:o-1}:{t:"err",v:"#VALUE!"}}function oe(u,s,e){var o;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);return r.t==="err"?r:r.t!=="ref"||!e?{t:"bool",v:!1}:I(r.v)?{t:"err",v:"#VALUE!"}:{t:"bool",v:(((o=e.get(r.v))==null?void 0:o.v)||"")===""}}function ue(u,s,e){var i;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;if(r.t==="num")return{t:"bool",v:!0};if(r.t!=="ref"||!e)return{t:"bool",v:!1};if(I(r.v))return{t:"err",v:"#VALUE!"};const a=((i=e.get(r.v))==null?void 0:i.v)||"",o=a.toUpperCase();return{t:"bool",v:a!==""&&!(o==="TRUE"||o==="FALSE")&&!isNaN(Number(a))}}function ce(u,s,e){var f;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;if(r.t==="str")return{t:"bool",v:!0};if(r.t!=="ref"||!e)return{t:"bool",v:!1};if(I(r.v))return{t:"err",v:"#VALUE!"};const a=((f=e.get(r.v))==null?void 0:f.v)||"";if(a==="")return{t:"bool",v:!1};const o=a.toUpperCase(),c=o==="TRUE"||o==="FALSE",i=!isNaN(Number(a));return{t:"bool",v:!c&&!i}}function ie(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();return t.length!==1?{t:"err",v:"#N/A!"}:{t:"bool",v:s(t[0]).t==="err"}}function fe(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);return{t:"bool",v:r.t==="err"&&r.v!=="#N/A!"}}function me(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);return{t:"bool",v:r.t==="err"&&r.v==="#N/A!"}}function le(u,s,e){var c;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;if(r.t==="bool")return{t:"bool",v:!0};if(r.t!=="ref"||!e)return{t:"bool",v:!1};if(I(r.v))return{t:"err",v:"#VALUE!"};const o=(((c=e.get(r.v))==null?void 0:c.v)||"").toUpperCase();return{t:"bool",v:o==="TRUE"||o==="FALSE"}}function ve(u,s,e){var f;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return{t:"bool",v:!0};if(r.t==="str")return{t:"bool",v:!1};if(r.t==="num"||r.t==="bool")return{t:"bool",v:!0};if(r.t!=="ref"||!e)return{t:"bool",v:!1};if(I(r.v))return{t:"err",v:"#VALUE!"};const a=((f=e.get(r.v))==null?void 0:f.v)||"";if(a==="")return{t:"bool",v:!0};const o=a.toUpperCase(),c=o==="TRUE"||o==="FALSE",i=!isNaN(Number(a));return{t:"bool",v:c||i}}function pe(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=s(t[0]);return r.t==="err"?s(t[1]):r}function ge(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=s(t[0]);return r.t==="err"&&r.v==="#N/A!"?s(t[1]):r}function he(u,s,e){const n=u.args();return n&&n.expr().length>0?{t:"err",v:"#N/A!"}:{t:"num",v:Math.PI}}function Ne(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.sign(r.v)}}function Ae(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=r.v;if(a===0)return{t:"num",v:0};const o=a>0?Math.ceil(a):Math.floor(a);return{t:"num",v:o%2===0?o:a>0?o+1:o-1}}function de(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=r.v;if(a===0)return{t:"num",v:1};const o=a>0?Math.ceil(a):Math.floor(a);return{t:"num",v:Math.abs(o)%2===1?o:a>0?o+1:o-1}}function xe(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.exp(r.v)}}function Ee(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.log(r.v)}}function Me(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;if(r.v<=0)return{t:"err",v:"#VALUE!"};let a=10;if(t.length===2){const o=v.map(s(t[1]),e);if(o.t==="err")return o;if(o.v<=0||o.v===1)return{t:"err",v:"#VALUE!"};a=o.v}return{t:"num",v:Math.log(r.v)/Math.log(a)}}function Re(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.sin(r.v)}}function be(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.cos(r.v)}}function Ie(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.tan(r.v)}}function Te(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<-1||r.v>1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.asin(r.v)}}function Fe(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<-1||r.v>1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.acos(r.v)}}function Se(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.atan(r.v)}}function Le(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:r.v===0&&a.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.atan2(a.v,r.v)}}function Ue(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:r.v*180/Math.PI}}function Ce(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:r.v*Math.PI/180}}function Ve(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=1;if(t.length===2){const o=v.map(s(t[1]),e);if(o.t==="err")return o;a=o.v}return a===0?{t:"num",v:0}:r.v>0&&a<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.ceil(r.v/a)*a}}function De(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=1;if(t.length===2){const o=v.map(s(t[1]),e);if(o.t==="err")return o;a=o.v}return a===0?{t:"num",v:0}:r.v>0&&a<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.floor(r.v/a)*a}}function Oe(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=0;if(t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;a=Math.trunc(c.v)}const o=Math.pow(10,a);return{t:"num",v:Math.trunc(r.v*o)/o}}function ye(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:a.v===0?{t:"num",v:0}:r.v>0&&a.v<0||r.v<0&&a.v>0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.round(r.v/a.v)*a.v}}function we(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);return a.t==="err"?a:{t:"bool",v:r.v===a.v}}function _e(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=A(s(t[3]),e);if(c.t==="err")return c;const i=Math.trunc(a.v)-1,f=Math.trunc(o.v);return i<0||f<0?{t:"err",v:"#VALUE!"}:{t:"str",v:r.v.slice(0,i)+c.v+r.v.slice(i+f)}}function Pe(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);return o<0?{t:"err",v:"#VALUE!"}:{t:"str",v:r.v.repeat(o)}}function ke(u,s,e){var a;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err"||r.t==="str")return r;if(r.t==="ref"&&e){const o=((a=e.get(r.v))==null?void 0:a.v)||"";if(o==="")return{t:"str",v:""};const c=o.toUpperCase(),i=c==="TRUE"||c==="FALSE",f=!isNaN(Number(o));return i||f?{t:"str",v:""}:{t:"str",v:o}}return{t:"str",v:""}}function Xe(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=r.v.trim(),o=Number(a);return a===""||isNaN(o)?{t:"err",v:"#VALUE!"}:{t:"num",v:o}}function Be(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;const o=a.v,c=r.v;if(o.endsWith("%")){const f=(o.slice(0,-1).split(".")[1]||"").length;return{t:"str",v:(c*100).toFixed(f)+"%"}}if(o.includes(",")){const i=(o.split(".")[1]||"").replace(/[^0#]/g,"").length,f=c.toFixed(i).split(".");return f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),{t:"str",v:f.join(".")}}if(o.includes(".")){const i=(o.split(".")[1]||"").length;return{t:"str",v:c.toFixed(i)}}return{t:"str",v:c.toFixed(0)}}function He(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.trunc(r.v);return a<1||a>65535?{t:"err",v:"#VALUE!"}:{t:"str",v:String.fromCharCode(a)}}function Ge(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);return r.t==="err"?r:r.v.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:r.v.charCodeAt(0)}}function Ye(u,s,e){var f,m;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=x(t[0],s,e);if(r.t==="err")return r;const a=X(s(t[1]),e);if(U(a))return a;const o=t.length===3?x(t[2],s,e):r;if(o.t==="err")return o;if(r.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};let c=0,i=0;for(let l=0;l<r.v.length;l++){const p=((f=e==null?void 0:e.get(r.v[l]))==null?void 0:f.v)||"";if(!B(p,a))continue;const g=((m=e==null?void 0:e.get(o.v[l]))==null?void 0:m.v)||"",h=Number(g);g!==""&&!isNaN(h)&&(c+=h,i++)}return i===0?{t:"err",v:"#VALUE!"}:{t:"num",v:c/i}}function qe(u,s,e){var f,m;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||(t.length-1)%2!==0)return{t:"err",v:"#N/A!"};const r=x(t[0],s,e);if(r.t==="err")return r;const a=[],o=[];for(let l=1;l<t.length;l+=2){const p=x(t[l],s,e);if(p.t==="err")return p;a.push(p.v);const g=X(s(t[l+1]),e);if(U(g))return g;o.push(g)}if(a.some(l=>l.length!==r.v.length))return{t:"err",v:"#VALUE!"};let c=0,i=0;for(let l=0;l<r.v.length;l++){let p=!0;for(let g=0;g<a.length;g++){const h=((f=e==null?void 0:e.get(a[g][l]))==null?void 0:f.v)||"";if(!B(h,o[g])){p=!1;break}}if(p){const g=((m=e==null?void 0:e.get(r.v[l]))==null?void 0:m.v)||"",h=Number(g);g!==""&&!isNaN(h)&&(c+=h,i++)}}return i===0?{t:"err",v:"#VALUE!"}:{t:"num",v:c/i}}function Ke(u,s,e){var i;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=[],a=s(t[0]);if(a.t==="err")return a;if(a.t==="num")r.push(a.v);else if(a.t==="ref"&&e)for(const f of M([a.v])){const m=((i=e.get(f))==null?void 0:i.v)||"";m!==""&&!isNaN(Number(m))&&r.push(Number(m))}const o=v.map(s(t[1]),e);if(o.t==="err")return o;const c=Math.trunc(o.v);return c<1||c>r.length?{t:"err",v:"#VALUE!"}:(r.sort((f,m)=>m-f),{t:"num",v:r[c-1]})}function We(u,s,e){var i;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=[],a=s(t[0]);if(a.t==="err")return a;if(a.t==="num")r.push(a.v);else if(a.t==="ref"&&e)for(const f of M([a.v])){const m=((i=e.get(f))==null?void 0:i.v)||"";m!==""&&!isNaN(Number(m))&&r.push(Number(m))}const o=v.map(s(t[1]),e);if(o.t==="err")return o;const c=Math.trunc(o.v);return c<1||c>r.length?{t:"err",v:"#VALUE!"}:(r.sort((f,m)=>f-m),{t:"num",v:r[c-1]})}function Qe(u,s,e){var a;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err"||r.t==="num")return r;if(r.t==="bool")return{t:"num",v:r.v?1:0};if(r.t==="ref"&&e){const o=((a=e.get(r.v))==null?void 0:a.v)||"";if(o==="")return{t:"num",v:0};const c=o.toUpperCase();if(c==="TRUE")return{t:"num",v:1};if(c==="FALSE")return{t:"num",v:0};const i=Number(o);return{t:"num",v:isNaN(i)?0:i}}return{t:"num",v:0}}function $e(u,s,e){var c;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1)return{t:"err",v:"#N/A!"};const r=[];for(const i of t){const f=x(i,s,e);if(f.t==="err")return f;const m=[];for(const l of f.v){const p=((c=e==null?void 0:e.get(l))==null?void 0:c.v)||"";m.push(p!==""&&!isNaN(Number(p))?Number(p):0)}r.push(m)}const a=r[0].length;if(r.some(i=>i.length!==a))return{t:"err",v:"#VALUE!"};let o=0;for(let i=0;i<a;i++){let f=1;for(const m of r)f*=m[i];o+=f}return{t:"num",v:o}}function Yt(u,s){for(u=Math.abs(u),s=Math.abs(s);s;)[u,s]=[s,u%s];return u}function ze(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0;for(const r of v.iterate(n,s,e)){if(r.t==="err")return r;const a=Math.trunc(r.v);if(a<0)return{t:"err",v:"#VALUE!"};t=Yt(t,a)}return{t:"num",v:t}}function je(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=1,r=!1;for(const a of v.iterate(n,s,e)){if(a.t==="err")return a;const o=Math.trunc(a.v);if(o<0)return{t:"err",v:"#VALUE!"};if(o===0)return{t:"num",v:0};t=t/Yt(t,o)*o,r=!0}return r?{t:"num",v:t}:{t:"err",v:"#VALUE!"}}function Je(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(r.v),c=Math.trunc(a.v);if(o<0||c<0||c>o)return{t:"err",v:"#VALUE!"};let i=1;for(let f=0;f<c;f++)i=i*(o-f)/(f+1);return{t:"num",v:Math.round(i)}}function Ze(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.trunc(r.v);if(a<0)return{t:"err",v:"#VALUE!"};let o=1;for(let c=2;c<=a;c++)o*=c;return{t:"num",v:o}}function tn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:a.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(r.v/a.v)}}function rn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0;for(const r of L.iterate(n,s,e)){if(r.t==="err")return r;r.v&&t++}return{t:"bool",v:t%2===1}}function en(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.trunc(r.v);return a<1||a>=t.length?{t:"err",v:"#VALUE!"}:s(t[a])}function nn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};switch(s(t[0]).t){case"num":return{t:"num",v:1};case"str":return{t:"num",v:2};case"bool":return{t:"num",v:4};case"err":return{t:"num",v:16};case"ref":return{t:"num",v:1};default:return{t:"num",v:1}}}function sn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v),c=new Date(r.getFullYear(),r.getMonth()+o,r.getDate());return{t:"str",v:k(c)}}function an(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v),c=new Date(r.getFullYear(),r.getMonth()+o+1,0);return{t:"str",v:k(c)}}function on(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;const a=S(s(t[1]),e);if(!(a instanceof Date))return a;const o=r<=a?1:-1,c=o===1?r:a,i=o===1?a:r;let f=0;const m=new Date(c);for(;m<=i;){const l=m.getDay();l!==0&&l!==6&&f++,m.setDate(m.getDate()+1)}return{t:"num",v:f*o}}function un(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);return r instanceof Date?{t:"str",v:k(r)}:r}function cn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=at(s(t[0]),e);if(!(r instanceof Date))return r;const a=r.getHours(),o=r.getMinutes(),c=r.getSeconds();return{t:"num",v:(a*3600+o*60+c)/86400}}function fn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;const a=S(s(t[1]),e);if(!(a instanceof Date))return a;if(r>a)return{t:"err",v:"#VALUE!"};const o=A(s(t[2]),e);if(o.t==="err")return o;const c=o.v.toUpperCase();if(c==="D"){const f=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate());return{t:"num",v:(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-f)/864e5}}if(c==="M"){let i=(a.getFullYear()-r.getFullYear())*12+(a.getMonth()-r.getMonth());return a.getDate()<r.getDate()&&i--,{t:"num",v:i}}if(c==="Y"){let i=a.getFullYear()-r.getFullYear();return(a.getMonth()<r.getMonth()||a.getMonth()===r.getMonth()&&a.getDate()<r.getDate())&&i--,{t:"num",v:i}}if(c==="MD"){let i=a.getDate()-r.getDate();if(i<0){const f=new Date(a.getFullYear(),a.getMonth(),0);i+=f.getDate()}return{t:"num",v:i}}if(c==="YM"){let i=a.getMonth()-r.getMonth();return i<0&&(i+=12),a.getDate()<r.getDate()&&(i--,i<0&&(i+=12)),{t:"num",v:i}}if(c==="YD"){const i=new Date(a.getFullYear(),r.getMonth(),r.getDate());i>a&&i.setFullYear(i.getFullYear()-1);const f=24*60*60*1e3,m=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate());return{t:"num",v:(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-m)/f}}return{t:"err",v:"#VALUE!"}}function mn(u,s,e){const n=u.args();if(!n||n.expr().length===0)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;if(r.t!=="ref")return{t:"err",v:"#VALUE!"};const a=I(r.v)?r.v.split(":")[0]:r.v;let o=a;W(a)&&(o=J(a).localRef);try{return{t:"num",v:nt(o).r}}catch{return{t:"err",v:"#REF!"}}}function ln(u,s,e){const n=u.args();if(!n||n.expr().length===0)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;if(r.t!=="ref")return{t:"err",v:"#VALUE!"};const a=I(r.v)?r.v.split(":")[0]:r.v;let o=a;W(a)&&(o=J(a).localRef);try{return{t:"num",v:nt(o).c}}catch{return{t:"err",v:"#REF!"}}}function vn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;if(r.t!=="ref")return{t:"err",v:"#VALUE!"};if(!I(r.v))return{t:"num",v:1};let a=r.v;W(r.v)&&(a=J(r.v).localRef);try{const[o,c]=Z(a);return{t:"num",v:Math.abs(c.r-o.r)+1}}catch{return{t:"err",v:"#REF!"}}}function pn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;if(r.t!=="ref")return{t:"err",v:"#VALUE!"};if(!I(r.v))return{t:"num",v:1};let a=r.v;W(r.v)&&(a=J(r.v).localRef);try{const[o,c]=Z(a);return{t:"num",v:Math.abs(c.c-o.c)+1}}catch{return{t:"err",v:"#REF!"}}}function gn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(r.v),c=Math.trunc(a.v);if(o<1||c<1)return{t:"err",v:"#VALUE!"};let i=1;if(t.length>=3){const m=v.map(s(t[2]),e);if(m.t==="err")return m;i=Math.trunc(m.v)}const f=yt(c);switch(i){case 1:return{t:"str",v:`$${f}$${o}`};case 2:return{t:"str",v:`${f}$${o}`};case 3:return{t:"str",v:`$${f}${o}`};case 4:return{t:"str",v:`${f}${o}`};default:return{t:"err",v:"#VALUE!"}}}function hn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;if(t.length===2){const a=A(s(t[1]),e);return a.t==="err"?a:{t:"str",v:a.v}}return{t:"str",v:r.v}}function Nn(u,s,e){var i,f;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||(t.length-1)%2!==0)return{t:"err",v:"#N/A!"};const r=x(t[0],s,e);if(r.t==="err")return r;const a=[],o=[];for(let m=1;m<t.length;m+=2){const l=x(t[m],s,e);if(l.t==="err")return l;a.push(l.v);const p=X(s(t[m+1]),e);if(U(p))return p;o.push(p)}if(a.some(m=>m.length!==r.v.length))return{t:"err",v:"#VALUE!"};let c=1/0;for(let m=0;m<r.v.length;m++){let l=!0;for(let p=0;p<a.length;p++){const g=((i=e==null?void 0:e.get(a[p][m]))==null?void 0:i.v)||"";if(!B(g,o[p])){l=!1;break}}if(l){const p=((f=e==null?void 0:e.get(r.v[m]))==null?void 0:f.v)||"",g=Number(p);p!==""&&!isNaN(g)&&g<c&&(c=g)}}return c===1/0?{t:"num",v:0}:{t:"num",v:c}}function An(u,s,e){var i,f;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||(t.length-1)%2!==0)return{t:"err",v:"#N/A!"};const r=x(t[0],s,e);if(r.t==="err")return r;const a=[],o=[];for(let m=1;m<t.length;m+=2){const l=x(t[m],s,e);if(l.t==="err")return l;a.push(l.v);const p=X(s(t[m+1]),e);if(U(p))return p;o.push(p)}if(a.some(m=>m.length!==r.v.length))return{t:"err",v:"#VALUE!"};let c=-1/0;for(let m=0;m<r.v.length;m++){let l=!0;for(let p=0;p<a.length;p++){const g=((i=e==null?void 0:e.get(a[p][m]))==null?void 0:i.v)||"";if(!B(g,o[p])){l=!1;break}}if(l){const p=((f=e==null?void 0:e.get(r.v[m]))==null?void 0:f.v)||"",g=Number(p);p!==""&&!isNaN(g)&&g>c&&(c=g)}}return c===-1/0?{t:"num",v:0}:{t:"num",v:c}}function Et(u,s,e){var f;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=s(t[1]);if(a.t==="err")return a;const o=[];if(a.t==="num")o.push(a.v);else if(a.t==="ref"&&e)for(const m of M([a.v])){const l=((f=e.get(m))==null?void 0:f.v)||"";l!==""&&!isNaN(Number(l))&&o.push(Number(l))}let c=0;if(t.length===3){const m=v.map(s(t[2]),e);if(m.t==="err")return m;c=Math.trunc(m.v)}const i=r.v;return o.includes(i)?c===0?{t:"num",v:o.filter(l=>l>i).length+1}:{t:"num",v:o.filter(l=>l<i).length+1}:{t:"err",v:"#N/A!"}}function Mt(u,s,e){var g;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=[],a=s(t[0]);if(a.t==="err")return a;if(a.t==="num")r.push(a.v);else if(a.t==="ref"&&e)for(const h of M([a.v])){const N=((g=e.get(h))==null?void 0:g.v)||"";N!==""&&!isNaN(Number(N))&&r.push(Number(N))}const o=v.map(s(t[1]),e);if(o.t==="err")return o;const c=o.v;if(c<0||c>1||r.length===0)return{t:"err",v:"#VALUE!"};r.sort((h,N)=>h-N);const i=r.length,f=c*(i-1),m=Math.floor(f),l=Math.ceil(f),p=f-m;return m===l?{t:"num",v:r[m]}:{t:"num",v:r[m]+p*(r[l]-r[m])}}function dn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);return r.t==="err"?r:{t:"str",v:r.v.replace(/[\x00-\x1F]/g,"")}}function xn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;let a=".";if(t.length>=2){const f=A(s(t[1]),e);if(f.t==="err")return f;a=f.v||"."}let o=",";if(t.length===3){const f=A(s(t[2]),e);if(f.t==="err")return f;o=f.v||","}let c=r.v.trim();if(o&&(c=c.split(o).join("")),a!=="."&&(c=c.replace(a,".")),c.endsWith("%")){const f=Number(c.slice(0,-1));return isNaN(f)?{t:"err",v:"#VALUE!"}:{t:"num",v:f/100}}const i=Number(c);return c===""||isNaN(i)?{t:"err",v:"#VALUE!"}:{t:"num",v:i}}function Rt(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(n,s,e)){if(o.t==="err")return o;t.push(o.v)}if(t.length<2)return{t:"err",v:"#VALUE!"};const r=t.reduce((o,c)=>o+c,0)/t.length,a=t.reduce((o,c)=>o+(c-r)**2,0);return{t:"num",v:Math.sqrt(a/(t.length-1))}}function bt(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(n,s,e)){if(o.t==="err")return o;t.push(o.v)}if(t.length===0)return{t:"err",v:"#VALUE!"};const r=t.reduce((o,c)=>o+c,0)/t.length,a=t.reduce((o,c)=>o+(c-r)**2,0);return{t:"num",v:Math.sqrt(a/t.length)}}function It(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(n,s,e)){if(o.t==="err")return o;t.push(o.v)}if(t.length<2)return{t:"err",v:"#VALUE!"};const r=t.reduce((o,c)=>o+c,0)/t.length;return{t:"num",v:t.reduce((o,c)=>o+(c-r)**2,0)/(t.length-1)}}function Tt(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(n,s,e)){if(o.t==="err")return o;t.push(o.v)}if(t.length===0)return{t:"err",v:"#VALUE!"};const r=t.reduce((o,c)=>o+c,0)/t.length;return{t:"num",v:t.reduce((o,c)=>o+(c-r)**2,0)/t.length}}function Ft(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const c of v.iterate(n,s,e)){if(c.t==="err")return c;t.push(c.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const r=new Map;for(const c of t)r.set(c,(r.get(c)||0)+1);let a=0,o=t[0];for(const[c,i]of r)i>a&&(a=i,o=c);return a<=1?{t:"err",v:"#N/A!"}:{t:"num",v:o}}function En(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0;for(const r of v.iterate(n,s,e)){if(r.t==="err")return r;t+=r.v**2}return{t:"num",v:t}}function Mn(u,s,e){const n=u.args();return n&&n.expr().length>0?{t:"err",v:"#N/A!"}:{t:"err",v:"#N/A!"}}function St(u,s,e){var h;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=[],a=s(t[0]);if(a.t==="err")return a;if(a.t==="num")r.push(a.v);else if(a.t==="ref"&&e)for(const N of M([a.v])){const d=((h=e.get(N))==null?void 0:h.v)||"";d!==""&&!isNaN(Number(d))&&r.push(Number(d))}const o=v.map(s(t[1]),e);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<0||c>4||r.length===0)return{t:"err",v:"#VALUE!"};const i=c/4;r.sort((N,d)=>N-d);const f=r.length,m=i*(f-1),l=Math.floor(m),p=Math.ceil(m),g=m-l;return l===p?{t:"num",v:r[l]}:{t:"num",v:r[l]+g*(r[p]-r[l])}}function Rn(u,s,e){var a;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=new Set,r=n.expr();for(const o of r){const c=s(o);if(c.t==="err")return c;if(c.t==="ref"&&e)for(const i of M([c.v])){const f=(a=e.get(i))==null?void 0:a.v;f!==void 0&&f!==""&&t.add(f)}else c.t==="num"?t.add(String(c.v)):c.t==="str"&&c.v!==""?t.add(c.v):c.t==="bool"&&t.add(String(c.v))}return{t:"num",v:t.size}}function bn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=2;if(t.length>=2){const i=v.map(s(t[1]),e);if(i.t==="err")return i;a=Math.trunc(i.v)}let o=!1;if(t.length===3){const i=L.map(s(t[2]),e);if(i.t==="err")return i;o=i.v}let c;if(a<0){const i=10**-a;c=String(Math.round(r.v/i)*i)}else c=r.v.toFixed(a);if(!o){const i=c.split(".");i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),c=i.join(".")}return{t:"str",v:c}}function In(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=2;if(t.length===2){const l=v.map(s(t[1]),e);if(l.t==="err")return l;a=Math.trunc(l.v)}let o;if(a<0){const l=10**-a;o=Math.round(r.v/l)*l}else o=r.v;const c=o<0,f=Math.abs(o).toFixed(Math.max(0,a)).split(".");f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");const m=f.join(".");return{t:"str",v:c?`($${m})`:`$${m}`}}function Tn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;let a=1;if(t.length===2){const g=v.map(s(t[1]),e);if(g.t==="err")return g;a=Math.trunc(g.v)}const o=new Date(r.getFullYear(),0,1),c=a===2?1:0,f=(o.getDay()-c+7)%7,m=new Date(o.getTime()-f*864e5),l=r.getTime()-m.getTime();return{t:"num",v:Math.floor(l/(7*864e5))+1}}function Fn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;const a=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),o=a.getUTCDay()||7;a.setUTCDate(a.getUTCDate()+4-o);const c=new Date(Date.UTC(a.getUTCFullYear(),0,1));return{t:"num",v:Math.ceil(((a.getTime()-c.getTime())/864e5+1)/7)}}function Sn(u,s,e){var m;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=new Set;if(t.length===3){const l=s(t[2]);if(l.t==="err")return l;if(l.t==="ref"&&e)for(const p of M([l.v])){const g=((m=e.get(p))==null?void 0:m.v)||"";g&&o.add(g)}else l.t==="str"&&o.add(l.v)}let c=Math.trunc(a.v);const i=c>0?1:-1;c=Math.abs(c);const f=new Date(r);for(;c>0;){f.setDate(f.getDate()+i);const l=f.getDay();l!==0&&l!==6&&!o.has(k(f))&&c--}return{t:"str",v:k(f)}}function Ln(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=S(s(t[0]),e);if(!(r instanceof Date))return r;const a=S(s(t[1]),e);if(!(a instanceof Date))return a;let o=0;if(t.length===3){const m=v.map(s(t[2]),e);if(m.t==="err")return m;o=Math.trunc(m.v)}if(o<0||o>4)return{t:"err",v:"#VALUE!"};const c=r<a?r:a,i=r<a?a:r,f=Math.round((i.getTime()-c.getTime())/864e5);switch(o){case 0:case 4:return{t:"num",v:f/360};case 1:{const m=c.getFullYear(),l=i.getFullYear();if(m===l){const N=(new Date(m+1,0,1).getTime()-new Date(m,0,1).getTime())/864e5;return{t:"num",v:f/N}}const p=l-m+1,h=(new Date(l+1,0,1).getTime()-new Date(m,0,1).getTime())/864e5/p;return{t:"num",v:f/h}}case 2:return{t:"num",v:f/360};case 3:return{t:"num",v:f/365};default:return{t:"err",v:"#VALUE!"}}}function Un(u,s,e){var p,g;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;const a=x(t[1],s,e);if(U(a))return a;let o=a.v;if(t.length===3){const h=x(t[2],s,e);if(U(h))return h;o=h.v}const c=r.t==="num"||r.t==="str"?r.v:"",i=r.t==="num";let f=-1;for(let h=0;h<a.v.length;h++){const N=((p=e==null?void 0:e.get(a.v[h]))==null?void 0:p.v)||"";if(i){const d=Number(N);N!==""&&!isNaN(d)&&d<=c&&(f=h)}else N.toLowerCase()<=String(c).toLowerCase()&&(f=h)}if(f===-1||f>=o.length)return{t:"err",v:"#N/A!"};const m=((g=e==null?void 0:e.get(o[f]))==null?void 0:g.v)||"",l=Number(m);return m!==""&&!isNaN(l)?{t:"num",v:l}:{t:"str",v:m}}function Cn(u,s,e){var i;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;if(!e)return{t:"err",v:"#REF!"};const a=r.v.trim(),o=(i=e.get(a))==null?void 0:i.v;if(o===void 0)return{t:"str",v:""};const c=Number(o);return o!==""&&!isNaN(c)?{t:"num",v:c}:{t:"str",v:o}}function Vn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t!=="err")return{t:"err",v:"#N/A!"};const o={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A!":7,"#ERROR!":8}[r.v];return o!==void 0?{t:"num",v:o}:{t:"err",v:"#N/A!"}}function Dn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return{t:"bool",v:!1};if(r.t!=="str"||r.v==="")return{t:"bool",v:!1};if(!/[\-\/]/.test(r.v))return{t:"bool",v:!1};const a=new Date(r.v);return{t:"bool",v:!isNaN(a.getTime())}}function On(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>4)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;let o=!0;if(t.length>=3){const f=L.map(s(t[2]),e);if(f.t==="err")return f;o=f.v}let c=!0;if(t.length===4){const f=L.map(s(t[3]),e);if(f.t==="err")return f;c=f.v}let i;if(o&&a.v.length>1){const f=new RegExp("["+a.v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"]");i=r.v.split(f)}else i=r.v.split(a.v);return c&&(i=i.filter(f=>f!=="")),{t:"str",v:i.length>0?i[0]:""}}function yn(u,s,e){var o;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=[];for(let c=1;c<t.length;c++){const i=s(t[c]);if(i.t==="err")return i;if(i.t==="ref"&&e)for(const f of M([i.v])){const m=((o=e.get(f))==null?void 0:o.v)||"";a.push(m)}else i.t==="num"?a.push(String(i.v)):i.t==="str"?a.push(i.v):i.t==="bool"&&a.push(i.v?"TRUE":"FALSE")}return{t:"str",v:a.join(r.v)}}function wn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;try{return{t:"bool",v:new RegExp(a.v).test(r.v)}}catch{return{t:"err",v:"#VALUE!"}}}function D(u,s,e,n){var c,i;const t=x(u,e,n);if(U(t))return t;const r=x(s,e,n);if(U(r))return r;if(t.v.length!==r.v.length)return{t:"err",v:"#N/A!"};const a=[],o=[];for(let f=0;f<r.v.length;f++){const m=((c=n==null?void 0:n.get(r.v[f]))==null?void 0:c.v)||"",l=((i=n==null?void 0:n.get(t.v[f]))==null?void 0:i.v)||"";m!==""&&l!==""&&!isNaN(Number(m))&&!isNaN(Number(l))&&(a.push(Number(m)),o.push(Number(l)))}return a.length<2?{t:"err",v:"#N/A!"}:{xs:a,ys:o}}function ot(u,s){const e=u.length,n=u.reduce((i,f)=>i+f,0),t=s.reduce((i,f)=>i+f,0),r=u.reduce((i,f,m)=>i+f*s[m],0),a=u.reduce((i,f)=>i+f*f,0),o=(e*r-n*t)/(e*a-n*n),c=(t-o*n)/e;return{slope:o,intercept:c}}function Lt(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=D(t[1],t[2],s,e);if("t"in a)return a;const{slope:o,intercept:c}=ot(a.xs,a.ys);return{t:"num",v:c+o*r.v}}function _n(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const{slope:a}=ot(r.xs,r.ys);return{t:"num",v:a}}function Pn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const{intercept:a}=ot(r.xs,r.ys);return{t:"num",v:a}}function kn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const a=r.xs.length,o=r.xs.reduce((p,g)=>p+g,0)/a,c=r.ys.reduce((p,g)=>p+g,0)/a;let i=0,f=0,m=0;for(let p=0;p<a;p++){const g=r.xs[p]-o,h=r.ys[p]-c;i+=g*h,f+=g*g,m+=h*h}const l=Math.sqrt(f*m);return l===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:i/l}}function Xn(u,s,e){var h,N,d,R;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>6)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;const a=x(t[1],s,e);if(U(a))return a;const o=x(t[2],s,e);if(U(o))return o;let c=null;t.length>=4&&(c=s(t[3]));let i=0;if(t.length>=5){const b=v.map(s(t[4]),e);if(b.t==="err")return b;i=Math.trunc(b.v)}const f=r.t==="num"||r.t==="str"||r.t==="bool"?r.v:"",m=r.t==="num";let l=-1;if(i===0)for(let b=0;b<a.v.length;b++){const V=((h=e==null?void 0:e.get(a.v[b]))==null?void 0:h.v)||"";if(m){if(V!==""&&Number(V)===f){l=b;break}}else if(String(V).toLowerCase()===String(f).toLowerCase()){l=b;break}}else if(i===-1){let b=-1/0;for(let V=0;V<a.v.length;V++){const $=((N=e==null?void 0:e.get(a.v[V]))==null?void 0:N.v)||"";if(m){const _=Number($);$!==""&&!isNaN(_)&&_<=f&&_>b&&(b=_,l=V)}}}else if(i===1){let b=1/0;for(let V=0;V<a.v.length;V++){const $=((d=e==null?void 0:e.get(a.v[V]))==null?void 0:d.v)||"";if(m){const _=Number($);$!==""&&!isNaN(_)&&_>=f&&_<b&&(b=_,l=V)}}}if(l===-1)return c||{t:"err",v:"#N/A!"};if(l>=o.v.length)return{t:"err",v:"#N/A!"};const p=((R=e==null?void 0:e.get(o.v[l]))==null?void 0:R.v)||"",g=Number(p);return p!==""&&!isNaN(g)?{t:"num",v:g}:{t:"str",v:p}}function Bn(u,s,e){var d;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;if(r.t!=="ref"||!e)return{t:"err",v:"#VALUE!"};const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=Math.trunc(a.v),i=Math.trunc(o.v),f=I(r.v)?r.v.split(":")[0]:r.v,m=nt(f),l=m.r+c,p=m.c+i;if(l<1||p<1)return{t:"err",v:"#REF!"};const g=`${yt(p)}${l}`,h=((d=e.get(g))==null?void 0:d.v)||"",N=Number(h);return h!==""&&!isNaN(N)?{t:"num",v:N}:{t:"str",v:h}}function Hn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"bool",v:Math.trunc(r.v)%2===0}}function Gn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"bool",v:Math.trunc(r.v)%2!==0}}function Yn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.trunc(r.v);if(a<-1)return{t:"err",v:"#VALUE!"};if(a<=0)return{t:"num",v:1};let o=1;for(let c=a;c>0;c-=2)o*=c;return{t:"num",v:o}}function qn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);if(o<2||o>36)return{t:"err",v:"#VALUE!"};let c=Math.trunc(r.v).toString(o).toUpperCase();if(t.length===3){const i=v.map(s(t[2]),e);if(i.t==="err")return i;c=c.padStart(Math.trunc(i.v),"0")}return{t:"str",v:c}}function Kn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);if(o<2||o>36)return{t:"err",v:"#VALUE!"};const c=parseInt(r.v,o);return isNaN(c)?{t:"err",v:"#VALUE!"}:{t:"num",v:c}}function Wn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.sqrt(r.v*Math.PI)}}function Qn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.sinh(r.v)}}function $n(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.cosh(r.v)}}function zn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.tanh(r.v)}}function jn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:Math.asinh(r.v)}}function Jn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.acosh(r.v)}}function Zn(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<=-1||r.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.atanh(r.v)}}function ts(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.tan(r.v);return a===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:1/a}}function rs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.sin(r.v);return a===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:1/a}}function es(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.cos(r.v);return a===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:1/a}}function ns(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;try{const o=new RegExp(a.v).exec(r.v);return o?{t:"str",v:o[1]!==void 0?o[1]:o[0]}:{t:"err",v:"#N/A!"}}catch{return{t:"err",v:"#VALUE!"}}}function ss(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;const o=A(s(t[2]),e);if(o.t==="err")return o;try{return{t:"str",v:r.v.replace(new RegExp(a.v,"g"),o.v)}}catch{return{t:"err",v:"#VALUE!"}}}function as(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);return r.t==="err"?r:r.v.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:r.v.codePointAt(0)}}function os(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.trunc(r.v);if(a<1)return{t:"err",v:"#VALUE!"};try{return{t:"str",v:String.fromCodePoint(a)}}catch{return{t:"err",v:"#VALUE!"}}}function us(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const a of v.iterate(n,s,e)){if(a.t==="err")return a;if(a.v<=0)return{t:"err",v:"#VALUE!"};t.push(a.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const r=t.reduce((a,o)=>a+Math.log(o),0);return{t:"num",v:Math.exp(r/t.length)}}function cs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const a of v.iterate(n,s,e)){if(a.t==="err")return a;if(a.v<=0)return{t:"err",v:"#VALUE!"};t.push(a.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const r=t.reduce((a,o)=>a+1/o,0);return{t:"num",v:t.length/r}}function is(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const o of v.iterate(n,s,e)){if(o.t==="err")return o;t.push(o.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const r=t.reduce((o,c)=>o+c,0)/t.length;return{t:"num",v:t.reduce((o,c)=>o+Math.abs(c-r),0)/t.length}}function fs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=[];for(const a of v.iterate(n,s,e)){if(a.t==="err")return a;t.push(a.v)}if(t.length===0)return{t:"err",v:"#N/A!"};const r=t.reduce((a,o)=>a+o,0)/t.length;return{t:"num",v:t.reduce((a,o)=>a+(o-r)**2,0)}}function ms(u,s,e){var m;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;const a=[];if(r.t==="num")a.push(r.v);else if(r.t==="ref"&&e)for(const l of M([r.v])){const p=((m=e.get(l))==null?void 0:m.v)||"";p!==""&&!isNaN(Number(p))&&a.push(Number(p))}const o=v.map(s(t[1]),e);if(o.t==="err")return o;const c=o.v;if(c<0||c>=1)return{t:"err",v:"#VALUE!"};if(a.length===0)return{t:"err",v:"#N/A!"};a.sort((l,p)=>l-p);const i=Math.floor(a.length*c/2),f=a.slice(i,a.length-i);return f.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:f.reduce((l,p)=>l+p,0)/f.length}}function ls(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(r.v),c=Math.trunc(a.v);if(o<0||c<0||c>o)return{t:"err",v:"#VALUE!"};let i=1;for(let f=o;f>o-c;f--)i*=f;return{t:"num",v:i}}function rt(u,s,e,n,t){if(u===0)return-(e+n)/s;const r=Math.pow(1+u,s);return-(u*(e*r+n)/((1+u*t)*(r-1)))}function vs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;let c=0;if(t.length>=4){const f=v.map(s(t[3]),e);if(f.t==="err")return f;c=f.v}let i=0;if(t.length===5){const f=v.map(s(t[4]),e);if(f.t==="err")return f;i=Math.trunc(f.v)}return{t:"num",v:rt(r.v,a.v,o.v,c,i)}}function ps(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;let c=0;if(t.length>=4){const m=v.map(s(t[3]),e);if(m.t==="err")return m;c=m.v}let i=0;if(t.length===5){const m=v.map(s(t[4]),e);if(m.t==="err")return m;i=Math.trunc(m.v)}if(r.v===0)return{t:"num",v:-(c+o.v*a.v)};const f=Math.pow(1+r.v,a.v);return{t:"num",v:-(c*f+o.v*(1+r.v*i)*(f-1)/r.v)}}function gs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;let c=0;if(t.length>=4){const m=v.map(s(t[3]),e);if(m.t==="err")return m;c=m.v}let i=0;if(t.length===5){const m=v.map(s(t[4]),e);if(m.t==="err")return m;i=Math.trunc(m.v)}if(r.v===0)return{t:"num",v:-(c+o.v*a.v)};const f=Math.pow(1+r.v,a.v);return{t:"num",v:-(c+o.v*(1+r.v*i)*(f-1)/r.v)/f}}function hs(u,s,e){var c;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=0,o=1;for(let i=1;i<t.length;i++){const f=s(t[i]);if(f.t==="err")return f;if(f.t==="ref"&&e)for(const m of M([f.v])){const l=((c=e.get(m))==null?void 0:c.v)||"";l!==""&&!isNaN(Number(l))&&(a+=Number(l)/Math.pow(1+r.v,o),o++)}else f.t==="num"&&(a+=f.v/Math.pow(1+r.v,o),o++)}return{t:"num",v:a}}function Ns(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;let c=0;if(t.length>=4){const m=v.map(s(t[3]),e);if(m.t==="err")return m;c=m.v}let i=0;if(t.length===5){const m=v.map(s(t[4]),e);if(m.t==="err")return m;i=Math.trunc(m.v)}if(r.v===0)return a.v===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:-(o.v+c)/a.v};const f=a.v*(1+r.v*i)/r.v;return{t:"num",v:Math.log((f-c)/(o.v+f))/Math.log(1+r.v)}}function As(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<4||t.length>6)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=v.map(s(t[3]),e);if(c.t==="err")return c;let i=0;if(t.length>=5){const g=v.map(s(t[4]),e);if(g.t==="err")return g;i=g.v}let f=0;if(t.length===6){const g=v.map(s(t[5]),e);if(g.t==="err")return g;f=Math.trunc(g.v)}const m=rt(r.v,o.v,c.v,i,f);let l=c.v;for(let g=1;g<a.v;g++){f===1&&g===1&&(l+=m);const h=l*r.v;l+=h+(f===0||g>1?m:0)}const p=l*r.v;return f===1&&a.v===1?{t:"num",v:0}:{t:"num",v:p}}function ds(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<4||t.length>6)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=v.map(s(t[3]),e);if(c.t==="err")return c;let i=0;if(t.length>=5){const g=v.map(s(t[4]),e);if(g.t==="err")return g;i=g.v}let f=0;if(t.length===6){const g=v.map(s(t[5]),e);if(g.t==="err")return g;f=Math.trunc(g.v)}const m=rt(r.v,o.v,c.v,i,f);let l=c.v;for(let g=1;g<a.v;g++){f===1&&g===1&&(l+=m);const h=l*r.v;l+=h+(f===0||g>1?m:0)}const p=f===1&&a.v===1?0:l*r.v;return{t:"num",v:m-p}}function xs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);return o.t==="err"?o:o.v===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:(r.v-a.v)/o.v}}function Es(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);return o<1||r.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.pow(1+r.v/o,o)-1}}function Ms(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>6)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;let c=0;if(t.length>=4){const l=v.map(s(t[3]),e);if(l.t==="err")return l;c=l.v}let i=0;if(t.length>=5){const l=v.map(s(t[4]),e);if(l.t==="err")return l;i=Math.trunc(l.v)}let f=.1;if(t.length===6){const l=v.map(s(t[5]),e);if(l.t==="err")return l;f=l.v}let m=f;for(let l=0;l<100;l++){const p=Math.pow(1+m,r.v),g=o.v*p+a.v*(1+m*i)*(p-1)/m+c,h=r.v*o.v*Math.pow(1+m,r.v-1)+a.v*(1+m*i)*(r.v*Math.pow(1+m,r.v-1)*m-(p-1))/(m*m)+a.v*i*(p-1)/m,N=m-g/h;if(Math.abs(N-m)<1e-10)return{t:"num",v:N};m=N}return{t:"err",v:"#VALUE!"}}function Rs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=[],a=x(t[0],s,e);if(a.t==="err")return a;for(const i of a.v){const f=e.get(i),m=f?Number(f.v):0;if(isNaN(m))return{t:"err",v:"#VALUE!"};r.push(m)}let o=.1;if(t.length===2){const i=v.map(s(t[1]),e);if(i.t==="err")return i;o=i.v}let c=o;for(let i=0;i<100;i++){let f=0,m=0;for(let p=0;p<r.length;p++){const g=Math.pow(1+c,p);f+=r[p]/g,m-=p*r[p]/Math.pow(1+c,p+1)}if(Math.abs(m)<1e-15)return{t:"err",v:"#VALUE!"};const l=c-f/m;if(Math.abs(l-c)<1e-10)return{t:"num",v:l};c=l}return{t:"err",v:"#VALUE!"}}function bs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=v.map(s(t[3]),e);if(c.t==="err")return c;let i=12;if(t.length===5){const p=v.map(s(t[4]),e);if(p.t==="err")return p;i=Math.trunc(p.v)}if(o.v<=0||c.v<1||r.v<0)return{t:"err",v:"#VALUE!"};const f=Math.round((1-Math.pow(a.v/r.v,1/o.v))*1e3)/1e3;let m=0;const l=Math.trunc(c.v);for(let p=1;p<=l;p++){let g;if(p===1?g=r.v*f*i/12:p===Math.trunc(o.v)+1?g=(r.v-m)*f*(12-i)/12:g=(r.v-m)*f,p===l)return{t:"num",v:g};m+=g}return{t:"err",v:"#VALUE!"}}function Is(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<4||t.length>5)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=v.map(s(t[3]),e);if(c.t==="err")return c;let i=2;if(t.length===5){const p=v.map(s(t[4]),e);if(p.t==="err")return p;i=p.v}if(o.v<=0||c.v<1)return{t:"err",v:"#VALUE!"};const f=i/o.v;let m=r.v;const l=Math.trunc(c.v);for(let p=1;p<=l;p++){let g=m*f;if(m-g<a.v&&(g=m-a.v),g<0&&(g=0),p===l)return{t:"num",v:g};m-=g}return{t:"err",v:"#VALUE!"}}function Ts(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);return o<1||r.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:o*(Math.pow(1+r.v,1/o)-1)}}function Fs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==6)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=v.map(s(t[3]),e);if(c.t==="err")return c;const i=v.map(s(t[4]),e);if(i.t==="err")return i;const f=v.map(s(t[5]),e);if(f.t==="err")return f;const m=Math.trunc(c.v),l=Math.trunc(i.v),p=Math.trunc(f.v);if(r.v<=0||a.v<=0||o.v<=0||m<1||l<m||p!==0&&p!==1)return{t:"err",v:"#VALUE!"};const g=rt(r.v,a.v,o.v,0,p);let h=0,N=o.v;for(let d=1;d<=l;d++){const R=p===1&&d===1?0:N*r.v,b=g-R;d>=m&&(h+=R),N+=b}return{t:"num",v:h}}function Ss(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==6)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=v.map(s(t[3]),e);if(c.t==="err")return c;const i=v.map(s(t[4]),e);if(i.t==="err")return i;const f=v.map(s(t[5]),e);if(f.t==="err")return f;const m=Math.trunc(c.v),l=Math.trunc(i.v),p=Math.trunc(f.v);if(r.v<=0||a.v<=0||o.v<=0||m<1||l<m||p!==0&&p!==1)return{t:"err",v:"#VALUE!"};const g=rt(r.v,a.v,o.v,0,p);let h=0,N=o.v;for(let d=1;d<=l;d++){const R=p===1&&d===1?0:N*r.v,b=g-R;d>=m&&(h+=b),N+=b}return{t:"num",v:h}}function Ls(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0,r=0;for(const a of n.expr()){const o=s(a);if(o.t==="err")return o;if(o.t==="ref"&&e){const c=Array.from(M([o.v]));for(const i of c){const f=e.get(i);if(!f||f.v===void 0||f.v==="")continue;const m=Number(f.v);t+=isNaN(m)?0:m,r++}}else o.t==="num"?(t+=o.v,r++):o.t==="bool"?(t+=o.v?1:0,r++):o.t==="str"&&(t+=0,r++)}return r===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:t/r}}function Us(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=1/0,r=!1;for(const a of n.expr()){const o=s(a);if(o.t==="err")return o;if(o.t==="ref"&&e){const c=Array.from(M([o.v]));for(const i of c){const f=e.get(i);if(!f||f.v===void 0||f.v==="")continue;const m=Number(f.v),l=isNaN(m)?0:m;l<t&&(t=l),r=!0}}else if(o.t==="num")o.v<t&&(t=o.v),r=!0;else if(o.t==="bool"){const c=o.v?1:0;c<t&&(t=c),r=!0}else o.t==="str"&&(0<t&&(t=0),r=!0)}return r?{t:"num",v:t}:{t:"num",v:0}}function Cs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=-1/0,r=!1;for(const a of n.expr()){const o=s(a);if(o.t==="err")return o;if(o.t==="ref"&&e){const c=Array.from(M([o.v]));for(const i of c){const f=e.get(i);if(!f||f.v===void 0||f.v==="")continue;const m=Number(f.v),l=isNaN(m)?0:m;l>t&&(t=l),r=!0}}else if(o.t==="num")o.v>t&&(t=o.v),r=!0;else if(o.t==="bool"){const c=o.v?1:0;c>t&&(t=c),r=!0}else o.t==="str"&&(0>t&&(t=0),r=!0)}return r?{t:"num",v:t}:{t:"num",v:0}}function Vs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<=-1||r.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:.5*Math.log((1+r.v)/(1-r.v))}}function Ds(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.exp(2*r.v);return{t:"num",v:(a-1)/(a+1)}}function E(u){const e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(u<.5)return Math.PI/(Math.sin(Math.PI*u)*E(1-u));u-=1;let n=e[0];for(let r=1;r<9;r++)n+=e[r]/(u+r);const t=u+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(t,u+.5)*Math.exp(-t)*n}function Os(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<=0&&Number.isInteger(r.v)?{t:"err",v:"#VALUE!"}:{t:"num",v:E(r.v)}}function ys(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.log(E(r.v))}}function z(u){const s=u>=0?1:-1;u=Math.abs(u);const e=.254829592,n=-.284496736,t=1.421413741,r=-1.453152027,a=1.061405429,c=1/(1+.3275911*u),i=1-((((a*c+r)*c+t)*c+n)*c+e)*c*Math.exp(-u*u);return s*i}function pt(u){return .5*(1+z(u/Math.SQRT2))}function gt(u){return Math.exp(-.5*u*u)/Math.sqrt(2*Math.PI)}function H(u){if(u<=0||u>=1)return NaN;if(u<.5)return-H(1-u);const s=Math.sqrt(-2*Math.log(1-u));return s-(2.515517+.802853*s+.010328*s*s)/(1+1.432788*s+.189269*s*s+.001308*s*s*s)}function Ut(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;if(o.v<=0)return{t:"err",v:"#VALUE!"};const c=s(t[3]),i=c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0,f=(r.v-a.v)/o.v;return i?{t:"num",v:pt(f)}:{t:"num",v:gt(f)/o.v}}function Ct(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);return o.t==="err"?o:o.v<=0||r.v<=0||r.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:a.v+o.v*H(r.v)}}function ws(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;if(r.v<=0||o.v<=0)return{t:"err",v:"#VALUE!"};const c=s(t[3]),i=c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0,f=(Math.log(r.v)-a.v)/o.v;return i?{t:"num",v:pt(f)}:{t:"num",v:gt(f)/(r.v*o.v)}}function _s(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);return o.t==="err"?o:o.v<=0||r.v<=0||r.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.exp(a.v+o.v*H(r.v))}}function Ps(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);return o.t==="err"?o:o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:(r.v-a.v)/o.v}}function ks(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;if(r.v<0||a.v<=0||o.v<=0)return{t:"err",v:"#VALUE!"};const c=s(t[3]);return(c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0)?{t:"num",v:1-Math.exp(-Math.pow(r.v/o.v,a.v))}:{t:"num",v:a.v/Math.pow(o.v,a.v)*Math.pow(r.v,a.v-1)*Math.exp(-Math.pow(r.v/o.v,a.v))}}function Xs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(a.v<0)return{t:"err",v:"#VALUE!"};const o=s(t[2]),c=o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0,i=Math.trunc(r.v);if(i<0)return{t:"err",v:"#VALUE!"};if(c){let f=0;for(let m=0;m<=i;m++)f+=Math.pow(a.v,m)*Math.exp(-a.v)/E(m+1);return{t:"num",v:f}}return{t:"num",v:Math.pow(a.v,i)*Math.exp(-a.v)/E(i+1)}}function Bs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=Math.trunc(r.v),i=Math.trunc(a.v);if(c<0||i<0||c>i||o.v<0||o.v>1)return{t:"err",v:"#VALUE!"};const f=s(t[3]),m=f.t==="bool"?f.v:f.t==="num"?f.v!==0:!0;function l(p){const g=Math.log(E(i+1))-Math.log(E(p+1))-Math.log(E(i-p+1));return Math.exp(g+p*Math.log(o.v)+(i-p)*Math.log(1-o.v))}if(m){let p=0;for(let g=0;g<=c;g++)p+=l(g);return{t:"num",v:p}}return{t:"num",v:l(c)}}function Hs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(r.v<0||a.v<=0)return{t:"err",v:"#VALUE!"};const o=s(t[2]);return(o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0)?{t:"num",v:1-Math.exp(-a.v*r.v)}:{t:"num",v:a.v*Math.exp(-a.v*r.v)}}function Gs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);return o.t==="err"?o:r.v<=0||r.v>=1||a.v<=0||o.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:H(1-r.v/2)*a.v/Math.sqrt(Math.trunc(o.v))}}function j(u){return Math.log(E(u))}function q(u,s){if(s<0||s===0)return 0;if(s<u+1){let a=1/u,o=a;for(let c=1;c<200&&(a*=s/(u+c),o+=a,!(Math.abs(a)<1e-14*Math.abs(o)));c++);return o*Math.exp(-s+u*Math.log(s)-j(u))}let e=s+1-u,n=1e30,t=1/e,r=t;for(let a=1;a<200;a++){const o=-a*(a-u);e+=2,t=o*t+e,Math.abs(t)<1e-30&&(t=1e-30),n=e+o/n,Math.abs(n)<1e-30&&(n=1e-30),t=1/t;const c=t*n;if(r*=c,Math.abs(c-1)<1e-14)break}return 1-Math.exp(-s+u*Math.log(s)-j(u))*r}function Ys(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(r.v<0||a.v<1)return{t:"err",v:"#VALUE!"};const o=s(t[2]),c=o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0,f=Math.trunc(a.v)/2;return c?{t:"num",v:q(f,r.v/2)}:{t:"num",v:Math.pow(r.v,f-1)*Math.exp(-r.v/2)/(Math.pow(2,f)*E(f))}}function qs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(r.v<=0||r.v>=1||a.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(a.v);let c=o*Math.pow(1-2/(9*o)+H(r.v)*Math.sqrt(2/(9*o)),3);c<=0&&(c=.01);for(let i=0;i<100;i++){const f=q(o/2,c/2),m=o/2,l=Math.pow(c,m-1)*Math.exp(-c/2)/(Math.pow(2,m)*E(m));if(Math.abs(l)<1e-15)break;const p=c-(f-r.v)/l;if(Math.abs(p-c)<1e-10){c=p;break}c=Math.max(p,1e-10)}return{t:"num",v:c}}function Ks(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(a.v<1)return{t:"err",v:"#VALUE!"};const o=s(t[2]),c=o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0,i=Math.trunc(a.v);if(c){const m=r.v*r.v;q(i/2,i/(i+m)*i/2);const l=i/(i+m),p=y(l,i/2,.5);return{t:"num",v:r.v>=0?1-.5*p:.5*p}}return{t:"num",v:E((i+1)/2)/(Math.sqrt(i*Math.PI)*E(i/2))*Math.pow(1+t2/i,-(i+1)/2)}}function y(u,s,e){if(u<=0)return 0;if(u>=1)return 1;if(u>(s+1)/(s+e+2))return 1-y(1-u,e,s);const n=j(s)+j(e)-j(s+e),t=Math.exp(s*Math.log(u)+e*Math.log(1-u)-n)/s,r=200,a=1e-14,o=1e-30;let c=s+e,i=s+1,f=s-1,m=1,l=1-c*u/i;Math.abs(l)<o&&(l=o),l=1/l;let p=l;for(let g=1;g<=r;g++){const h=2*g;let N=g*(e-g)*u/((f+h)*(s+h));l=1+N*l,Math.abs(l)<o&&(l=o),m=1+N/m,Math.abs(m)<o&&(m=o),l=1/l,p*=l*m,N=-(s+g)*(c+g)*u/((s+h)*(i+h)),l=1+N*l,Math.abs(l)<o&&(l=o),m=1+N/m,Math.abs(m)<o&&(m=o),l=1/l;const d=l*m;if(p*=d,Math.abs(d-1)<a)break}return t*p}function ht(u,s){let e=H(u);for(let n=0;n<100;n++){const t=e*e,r=s/(s+t),a=y(r,s/2,.5),o=e>=0?1-.5*a:.5*a,c=E((s+1)/2)/(Math.sqrt(s*Math.PI)*E(s/2))*Math.pow(1+t/s,-(s+1)/2);if(Math.abs(c)<1e-15)break;const i=e-(o-u)/c;if(Math.abs(i-e)<1e-10)return i;e=i}return e}function Ws(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:r.v<=0||r.v>=1||a.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:ht(r.v,Math.trunc(a.v))}}function Qs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==5)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=v.map(s(t[3]),e);if(c.t==="err")return c;const i=s(t[4]),f=i.t==="bool"?i.v:i.t==="num"?i.v!==0:!0,m=Math.trunc(r.v),l=Math.trunc(a.v),p=Math.trunc(o.v),g=Math.trunc(c.v);if(m<0||l<0||p<0||g<0||l>g||p>g||m>Math.min(l,p))return{t:"err",v:"#VALUE!"};function h(d,R){return Math.log(E(d+1))-Math.log(E(R+1))-Math.log(E(d-R+1))}function N(d){return Math.exp(h(p,d)+h(g-p,l-d)-h(g,l))}if(f){let d=0;for(let R=Math.max(0,l+p-g);R<=m;R++)d+=N(R);return{t:"num",v:d}}return{t:"num",v:N(m)}}function $s(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=s(t[3]),i=c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0,f=Math.trunc(r.v),m=Math.trunc(a.v);if(f<0||m<1||o.v<=0||o.v>1)return{t:"err",v:"#VALUE!"};function l(p){const g=Math.log(E(p+m))-Math.log(E(m))-Math.log(E(p+1));return Math.exp(g+m*Math.log(o.v)+p*Math.log(1-o.v))}if(i){let p=0;for(let g=0;g<=f;g++)p+=l(g);return{t:"num",v:p}}return{t:"num",v:l(f)}}function zs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=Math.trunc(o.v);if(r.v<=0||r.v>=1||a.v<=0||c<2)return{t:"err",v:"#VALUE!"};const i=1-r.v/2,f=c-1;return{t:"num",v:ht(i,f)*a.v/Math.sqrt(c)}}function js(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]),a=A(r,e);if(a.t==="err")return a;const o=a.v.toUpperCase(),c={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3};let i=0;for(let f=0;f<o.length;f++){const m=c[o[f]],l=f+1<o.length?c[o[f+1]]:0;if(m===void 0)return{t:"err",v:"#VALUE!"};m<l?i-=m:i+=m}return{t:"num",v:i}}function Js(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=Math.trunc(r.v);if(a<0||a>3999)return{t:"err",v:"#VALUE!"};if(a===0)return{t:"str",v:""};const o=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],c=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"];let i="";for(let f=0;f<o.length;f++)for(;a>=o[f];)i+=c[f],a-=o[f];return{t:"str",v:i}}function Zs(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};let t=0,r=1;for(const a of n.expr()){const o=v.map(s(a),e);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<0)return{t:"err",v:"#VALUE!"};t+=c,r*=E(c+1)}return{t:"num",v:Math.round(E(t+1)/r)}}function ta(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=x(t[3],s,e);if(c.t==="err")return c;let i=0;for(let f=0;f<c.v.length;f++){const m=e.get(c.v[f]),l=m?Number(m.v):0;if(isNaN(l))return{t:"err",v:"#VALUE!"};i+=l*Math.pow(r.v,a.v+f*o.v)}return{t:"num",v:i}}function ra(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=0;if(t.length===2){const o=v.map(s(t[1]),e);if(o.t==="err")return o;a=o.v}return{t:"num",v:r.v===a?1:0}}function ea(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=0;if(t.length===2){const o=v.map(s(t[1]),e);if(o.t==="err")return o;a=o.v}return{t:"num",v:r.v>=a?1:0}}function na(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;if(t.length===1)return{t:"num",v:z(r.v)};const a=v.map(s(t[1]),e);return a.t==="err"?a:{t:"num",v:z(a.v)-z(r.v)}}function sa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:{t:"num",v:1-z(r.v)}}function aa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=x(t[1],s,e);if(a.t==="err")return a;const o=x(t[2],s,e);if(o.t==="err")return o;if(a.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};const c=[],i=[];for(let l=0;l<a.v.length;l++){const p=e.get(a.v[l]),g=p?Number(p.v):0;if(isNaN(g))return{t:"err",v:"#VALUE!"};c.push(g);const h=e.get(o.v[l]),N=(h==null?void 0:h.v)||"",d=new Date(N);if(isNaN(d.getTime()))return{t:"err",v:"#VALUE!"};i.push(d.getTime())}const f=i[0];let m=0;for(let l=0;l<c.length;l++){const p=(i[l]-f)/315576e5;m+=c[l]/Math.pow(1+r.v,p)}return{t:"num",v:m}}function oa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=x(t[0],s,e);if(r.t==="err")return r;const a=x(t[1],s,e);if(a.t==="err")return a;if(r.v.length!==a.v.length)return{t:"err",v:"#VALUE!"};const o=[],c=[];for(let l=0;l<r.v.length;l++){const p=e.get(r.v[l]),g=p?Number(p.v):0;if(isNaN(g))return{t:"err",v:"#VALUE!"};o.push(g);const h=e.get(a.v[l]),N=(h==null?void 0:h.v)||"",d=new Date(N);if(isNaN(d.getTime()))return{t:"err",v:"#VALUE!"};c.push(d.getTime())}let i=.1;if(t.length===3){const l=v.map(s(t[2]),e);if(l.t==="err")return l;i=l.v}const f=c[0];let m=i;for(let l=0;l<100;l++){let p=0,g=0;for(let N=0;N<o.length;N++){const d=(c[N]-f)/315576e5,R=Math.pow(1+m,d);p+=o[N]/R,g-=d*o[N]/Math.pow(1+m,d+1)}if(Math.abs(g)<1e-15)return{t:"err",v:"#VALUE!"};const h=m-p/g;if(Math.abs(h-m)<1e-10)return{t:"num",v:h};m=h}return{t:"err",v:"#VALUE!"}}function ua(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=v.map(s(t[3]),e);if(c.t==="err")return c;const i=Math.trunc(o.v),f=Math.trunc(c.v);if(i<=0||f<1||f>i)return{t:"err",v:"#VALUE!"};const m=i*(i+1)/2;return{t:"num",v:(r.v-a.v)*(i-f+1)/m}}function ca(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=x(t[0],s,e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=[];for(const l of r.v){const p=e.get(l),g=p?Number(p.v):0;if(isNaN(g))return{t:"err",v:"#VALUE!"};c.push(g)}const i=c.length;if(i<2)return{t:"err",v:"#VALUE!"};let f=0,m=0;for(let l=0;l<i;l++)c[l]<0?f+=c[l]/Math.pow(1+a.v,l):m+=c[l]*Math.pow(1+o.v,i-1-l);return f===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:Math.pow(-m/f,1/(i-1))-1}}function ia(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=s(t[0]),a=s(t[1]),o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=A(r,e);if(c.t==="err")return c;const i=A(a,e);if(i.t==="err")return i;const f=new Date(c.v),m=new Date(i.v);if(isNaN(f.getTime())||isNaN(m.getTime()))return{t:"err",v:"#VALUE!"};const l=(m.getTime()-f.getTime())/(24*3600*1e3);return l<=0||o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:365*o.v/(360-o.v*l)}}function fa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=s(t[0]),a=s(t[1]),o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=A(r,e),i=A(a,e);if(c.t==="err"||i.t==="err")return{t:"err",v:"#VALUE!"};const f=new Date(c.v),m=new Date(i.v);if(isNaN(f.getTime())||isNaN(m.getTime()))return{t:"err",v:"#VALUE!"};const l=(m.getTime()-f.getTime())/(24*3600*1e3);return l<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:100*(1-o.v*l/360)}}function ma(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=s(t[0]),a=s(t[1]),o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=A(r,e),i=A(a,e);if(c.t==="err"||i.t==="err")return{t:"err",v:"#VALUE!"};const f=new Date(c.v),m=new Date(i.v);if(isNaN(f.getTime())||isNaN(m.getTime()))return{t:"err",v:"#VALUE!"};const l=(m.getTime()-f.getTime())/(24*3600*1e3);return l<=0||o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:(100-o.v)/o.v*360/l}}function la(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);if(o<1)return{t:"err",v:"#VALUE!"};const c=Math.trunc(r.v),i=r.v-c,f=Math.pow(10,Math.ceil(Math.log10(o)));return{t:"num",v:c+i*f/o}}function va(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);if(o<1)return{t:"err",v:"#VALUE!"};const c=Math.trunc(r.v),i=r.v-c,f=Math.pow(10,Math.ceil(Math.log10(o)));return{t:"num",v:c+i*o/f}}function pa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]),a=A(r,e);return a.t==="err"?a:{t:"str",v:encodeURIComponent(a.v)}}function ga(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]),a=A(r,e);if(a.t==="err")return a;const o=a.v.trim();return{t:"bool",v:/^https?:\/\//i.test(o)||/^ftp:\/\//i.test(o)}}function ha(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t!=="ref"||!e)return{t:"bool",v:!1};if(I(r.v))return{t:"err",v:"#VALUE!"};const a=e.get(r.v);return{t:"bool",v:!!(a&&a.f)}}function Na(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t!=="ref"||!e)return{t:"err",v:"#N/A!"};if(I(r.v))return{t:"err",v:"#VALUE!"};const a=e.get(r.v);return!a||!a.f?{t:"err",v:"#N/A!"}:{t:"str",v:a.f}}function Aa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=1;if(t.length>=2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;a=c.v}if(a===0)return{t:"num",v:0};let o=0;if(t.length===3){const c=v.map(s(t[2]),e);if(c.t==="err")return c;o=c.v}return a=Math.abs(a),r.v<0&&o!==0?{t:"num",v:-Math.ceil(Math.abs(r.v)/a)*a}:{t:"num",v:Math.ceil(r.v/a)*a}}function da(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=1;if(t.length>=2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;a=c.v}if(a===0)return{t:"num",v:0};let o=0;if(t.length===3){const c=v.map(s(t[2]),e);if(c.t==="err")return c;o=c.v}return a=Math.abs(a),r.v<0&&o!==0?{t:"num",v:-Math.floor(Math.abs(r.v)/a)*a}:{t:"num",v:Math.floor(r.v/a)*a}}function xa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=1;if(t.length===2){const o=v.map(s(t[1]),e);if(o.t==="err")return o;a=Math.abs(o.v)}return a===0?{t:"num",v:0}:{t:"num",v:Math.ceil(r.v/a)*a}}function Ea(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=1;if(t.length===2){const o=v.map(s(t[1]),e);if(o.t==="err")return o;a=Math.abs(o.v)}return a===0?{t:"num",v:0}:{t:"num",v:Math.floor(r.v/a)*a}}function Vt(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const{xs:a,ys:o}=r,c=a.length,i=a.reduce((l,p)=>l+p,0)/c,f=o.reduce((l,p)=>l+p,0)/c;return{t:"num",v:a.reduce((l,p,g)=>l+(p-i)*(o[g]-f),0)/c}}function Ma(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const{xs:a,ys:o}=r,c=a.length;if(c<2)return{t:"err",v:"#N/A!"};const i=a.reduce((l,p)=>l+p,0)/c,f=o.reduce((l,p)=>l+p,0)/c;return{t:"num",v:a.reduce((l,p,g)=>l+(p-i)*(o[g]-f),0)/(c-1)}}function Ra(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const{xs:a,ys:o}=r,c=a.length,i=a.reduce((h,N)=>h+N,0)/c,f=o.reduce((h,N)=>h+N,0)/c,m=a.reduce((h,N,d)=>h+(N-i)*(o[d]-f),0),l=a.reduce((h,N)=>h+(N-i)*(N-i),0),p=o.reduce((h,N)=>h+(N-f)*(N-f),0);if(l===0||p===0)return{t:"err",v:"#DIV/0!"};const g=m/Math.sqrt(l*p);return{t:"num",v:g*g}}function ba(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const{xs:a,ys:o}=r,c=a.length;if(c<3)return{t:"err",v:"#N/A!"};const{slope:i,intercept:f}=ot(a,o),m=o.reduce((l,p,g)=>{const h=i*a[g]+f;return l+(p-h)*(p-h)},0);return{t:"num",v:Math.sqrt(m/(c-2))}}function Q(u,s,e){var r;const n=s(u);if(n.t==="err")return n;const t=[];if(n.t==="num")t.push(n.v);else if(n.t==="ref"&&e)for(const a of M([n.v])){const o=((r=e.get(a))==null?void 0:r.v)||"";o!==""&&!isNaN(Number(o))&&t.push(Number(o))}return t}function Ia(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const a=r.ys,o=r.xs;let c=0;for(let i=0;i<a.length;i++)c+=a[i]*a[i]-o[i]*o[i];return{t:"num",v:c}}function Ta(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const a=r.ys,o=r.xs;let c=0;for(let i=0;i<a.length;i++)c+=a[i]*a[i]+o[i]*o[i];return{t:"num",v:c}}function Fa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const a=r.ys,o=r.xs;let c=0;for(let i=0;i<a.length;i++){const f=a[i]-o[i];c+=f*f}return{t:"num",v:c}}function Sa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=Q(t[0],s,e);if(!Array.isArray(r))return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=a.v;if(o<=0||o>=1||r.length===0)return{t:"err",v:"#VALUE!"};r.sort((p,g)=>p-g);const c=r.length,i=o*(c+1)-1;if(i<0||i>c-1)return{t:"err",v:"#VALUE!"};const f=Math.floor(i),m=Math.ceil(i),l=i-f;return f===m||m>=c?{t:"num",v:r[Math.min(f,c-1)]}:{t:"num",v:r[f]+l*(r[m]-r[f])}}function La(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=Q(t[0],s,e);if(!Array.isArray(r))return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);if(o<1||o>3||r.length===0)return{t:"err",v:"#VALUE!"};r.sort((g,h)=>g-h);const c=r.length,f=o/4*(c+1)-1;if(f<0||f>c-1)return{t:"err",v:"#VALUE!"};const m=Math.floor(f),l=Math.ceil(f),p=f-m;return m===l?{t:"num",v:r[m]}:{t:"num",v:r[m]+p*(r[l]-r[m])}}function Ua(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Q(t[1],s,e);if(!Array.isArray(a))return a;let o=0;if(t.length===3){const f=v.map(s(t[2]),e);if(f.t==="err")return f;o=Math.trunc(f.v)}const c=r.v;if(!a.includes(c))return{t:"err",v:"#N/A!"};const i=a.filter(f=>f===c).length;return o===0?{t:"num",v:a.filter(m=>m>c).length+1+(i-1)/2}:{t:"num",v:a.filter(m=>m<c).length+1+(i-1)/2}}function Dt(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=Q(t[0],s,e);if(!Array.isArray(r))return r;if(r.length===0)return{t:"err",v:"#N/A!"};const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=a.v;let c=3;if(t.length===3){const g=v.map(s(t[2]),e);if(g.t==="err")return g;if(c=Math.trunc(g.v),c<1)return{t:"err",v:"#VALUE!"}}if(r.sort((g,h)=>g-h),o<r[0]||o>r[r.length-1])return{t:"err",v:"#N/A!"};const i=r.length;let f=0;for(const g of r)g<o&&f++;const m=r.indexOf(o);let l;if(m>=0)l=f/(i-1);else{const g=r[f-1],h=r[f];l=(f-1+(o-g)/(h-g))/(i-1)}const p=Math.pow(10,c);return{t:"num",v:Math.trunc(l*p)/p}}function Ca(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=Q(t[0],s,e);if(!Array.isArray(r))return r;if(r.length===0)return{t:"err",v:"#N/A!"};const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=a.v;let c=3;if(t.length===3){const g=v.map(s(t[2]),e);if(g.t==="err")return g;if(c=Math.trunc(g.v),c<1)return{t:"err",v:"#VALUE!"}}if(r.sort((g,h)=>g-h),o<r[0]||o>r[r.length-1])return{t:"err",v:"#N/A!"};const i=r.length;let f=0;for(const g of r)g<o&&f++;const m=r.indexOf(o);let l;if(m>=0)l=(f+1)/(i+1);else{const g=r[f-1],h=r[f];l=(f+(o-g)/(h-g))/(i+1)}const p=Math.pow(10,c);return{t:"num",v:Math.trunc(l*p)/p}}function Va(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<4||t.length>6)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=L.map(s(t[3]),e);if(c.t==="err")return c;let i=0,f=1;if(t.length>=5){const g=v.map(s(t[4]),e);if(g.t==="err")return g;i=g.v}if(t.length===6){const g=v.map(s(t[5]),e);if(g.t==="err")return g;f=g.v}const m=a.v,l=o.v;if(m<=0||l<=0||i>=f)return{t:"err",v:"#VALUE!"};const p=(r.v-i)/(f-i);if(p<0||p>1)return{t:"err",v:"#VALUE!"};if(c.v)return{t:"num",v:y(p,m,l)};{const g=F(m)+F(l)-F(m+l);return{t:"num",v:Math.exp((m-1)*Math.log(p)+(l-1)*Math.log(1-p)-g)/(f-i)}}}function F(u){return Math.log(E(u))}function Da(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>5)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;let c=0,i=1;if(t.length>=4){const h=v.map(s(t[3]),e);if(h.t==="err")return h;c=h.v}if(t.length===5){const h=v.map(s(t[4]),e);if(h.t==="err")return h;i=h.v}const f=r.v,m=a.v,l=o.v;if(f<0||f>1||m<=0||l<=0||c>=i)return{t:"err",v:"#VALUE!"};let p=.5;const g=F(m)+F(l)-F(m+l);for(let h=0;h<200;h++){const d=y(p,m,l)-f;if(Math.abs(d)<1e-12)break;const R=Math.exp((m-1)*Math.log(Math.max(p,1e-300))+(l-1)*Math.log(Math.max(1-p,1e-300))-g);if(R===0)break;p=Math.max(1e-15,Math.min(1-1e-15,p-d/R))}return{t:"num",v:c+p*(i-c)}}function Oa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=L.map(s(t[3]),e);if(c.t==="err")return c;const i=r.v,f=Math.trunc(a.v),m=Math.trunc(o.v);if(i<0||f<1||m<1)return{t:"err",v:"#VALUE!"};if(c.v){const l=f*i/(f*i+m);return{t:"num",v:y(l,f/2,m/2)}}else{const l=f/2*Math.log(f)+m/2*Math.log(m)+(f/2-1)*Math.log(i),p=(f+m)/2*Math.log(f*i+m)+F(f/2)+F(m/2)-F((f+m)/2);return{t:"num",v:Math.exp(l-p)}}}function ya(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=r.v,i=Math.trunc(a.v),f=Math.trunc(o.v);if(c<0||c>=1||i<1||f<1)return{t:"err",v:"#VALUE!"};if(c===0)return{t:"num",v:0};let m=1;for(let l=0;l<200;l++){const p=i*m/(i*m+f),h=y(p,i/2,f/2)-c;if(Math.abs(h)<1e-12)break;const N=i/2*Math.log(i)+f/2*Math.log(f)+(i/2-1)*Math.log(Math.max(m,1e-300)),d=(i+f)/2*Math.log(i*m+f)+F(i/2)+F(f/2)-F((i+f)/2),R=Math.exp(N-d);if(R===0)break;m=Math.max(1e-15,m-h/R)}return{t:"num",v:m}}function wa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=L.map(s(t[3]),e);if(c.t==="err")return c;const i=r.v,f=a.v,m=o.v;return i<0||f<=0||m<=0?{t:"err",v:"#VALUE!"}:c.v?{t:"num",v:q(f,i/m)}:{t:"num",v:Math.pow(i,f-1)*Math.exp(-i/m)/(Math.pow(m,f)*E(f))}}function _a(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=r.v,i=a.v,f=o.v;if(c<0||c>1||i<=0||f<=0)return{t:"err",v:"#VALUE!"};if(c===0)return{t:"num",v:0};if(c===1)return{t:"err",v:"#VALUE!"};let m=i*f;for(let l=0;l<200;l++){const g=q(i,m/f)-c;if(Math.abs(g)<1e-12)break;const h=Math.pow(m,i-1)*Math.exp(-m/f)/(Math.pow(f,i)*E(i));if(h===0)break;m=Math.max(1e-15,m-g/h)}return{t:"num",v:m}}function Pa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(r.v<0||a.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(a.v);return{t:"num",v:1-q(o/2,r.v/2)}}function ka(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(r.v<=0||r.v>=1||a.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(a.v),c=1-r.v;let i=o*Math.pow(1-2/(9*o)+H(c)*Math.sqrt(2/(9*o)),3);i<=0&&(i=.01);for(let f=0;f<100;f++){const m=q(o/2,i/2),l=o/2,p=Math.pow(i,l-1)*Math.exp(-i/2)/(Math.pow(2,l)*E(l));if(Math.abs(p)<1e-15)break;const g=i-(m-c)/p;if(Math.abs(g-i)<1e-10){i=g;break}i=Math.max(g,1e-10)}return{t:"num",v:i}}function Xa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(a.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(a.v),c=r.v*r.v,i=o/(o+c),f=y(i,o/2,.5);return{t:"num",v:1-(r.v>=0?1-.5*f:.5*f)}}function Ba(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(r.v<0||a.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(a.v),c=r.v*r.v,i=o/(o+c);return{t:"num",v:y(i,o/2,.5)}}function Ha(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;if(r.v<=0||r.v>1||a.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(a.v);return{t:"num",v:ht(1-r.v/2,o)}}function Ga(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=r.v,i=Math.trunc(a.v),f=Math.trunc(o.v);if(c<0||i<1||f<1)return{t:"err",v:"#VALUE!"};const m=i*c/(i*c+f);return{t:"num",v:1-y(m,i/2,f/2)}}function Ya(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=r.v,i=Math.trunc(a.v),f=Math.trunc(o.v);if(c<=0||c>=1||i<1||f<1)return{t:"err",v:"#VALUE!"};const m=1-c;let l=1;for(let p=0;p<200;p++){const g=i*l/(i*l+f),N=y(g,i/2,f/2)-m;if(Math.abs(N)<1e-12)break;const d=i/2*Math.log(i)+f/2*Math.log(f)+(i/2-1)*Math.log(Math.max(l,1e-300)),R=(i+f)/2*Math.log(i*l+f)+F(i/2)+F(f/2)-F((i+f)/2),b=Math.exp(d-R);if(b===0)break;l=Math.max(1e-15,l-N/b)}return{t:"num",v:l}}function qa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=v.map(s(t[2]),e);if(o.t==="err")return o;const c=Math.trunc(r.v),i=a.v,f=o.v;if(c<0||i<0||i>1||f<0||f>1)return{t:"err",v:"#VALUE!"};let m=0;for(let l=0;l<=c;l++){const p=F(c+1)-F(l+1)-F(c-l+1)+l*Math.log(Math.max(i,1e-300))+(c-l)*Math.log(Math.max(1-i,1e-300));if(m+=Math.exp(p),m>=f)return{t:"num",v:l}}return{t:"num",v:c}}function Ka(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;let o=1;if(t.length===3){const f=v.map(s(t[2]),e);if(f.t==="err")return f;o=Math.trunc(f.v)}const c=r.v,i=a.v;if(i==="")return{t:"err",v:"#VALUE!"};if(o>0){let f=-1;for(let m=0;m<o;m++)if(f=c.indexOf(i,f+1),f===-1)return{t:"err",v:"#N/A!"};return{t:"str",v:c.substring(0,f)}}else if(o<0){let f=c.length;for(let m=0;m<-o;m++)if(f=c.lastIndexOf(i,f-1),f===-1)return{t:"err",v:"#N/A!"};return{t:"str",v:c.substring(0,f)}}return{t:"err",v:"#VALUE!"}}function Wa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;let o=1;if(t.length===3){const f=v.map(s(t[2]),e);if(f.t==="err")return f;o=Math.trunc(f.v)}const c=r.v,i=a.v;if(i==="")return{t:"err",v:"#VALUE!"};if(o>0){let f=-1;for(let m=0;m<o;m++)if(f=c.indexOf(i,f+1),f===-1)return{t:"err",v:"#N/A!"};return{t:"str",v:c.substring(f+i.length)}}else if(o<0){let f=c.length;for(let m=0;m<-o;m++)if(f=c.lastIndexOf(i,f-1),f===-1)return{t:"err",v:"#N/A!"};return{t:"str",v:c.substring(f+i.length)}}return{t:"err",v:"#VALUE!"}}function Qa(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err")return r;const a=A(r,e);if(a.t==="err")return a;let o=0;if(t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;o=Math.trunc(c.v)}return o===1&&r.t==="str"?{t:"str",v:'"'+a.v+'"'}:{t:"str",v:a.v}}function $a(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>4)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;if(r.v<1)return{t:"err",v:"#VALUE!"};let a=1;if(t.length>=3){const o=v.map(s(t[2]),e);if(o.t==="err")return o;a=o.v}return{t:"num",v:a}}function za(u,s,e){const n=u.args(),t=n?n.expr():[];if(t.length>5)return{t:"err",v:"#N/A!"};let r=0,a=1,o=!1;if(t.length>=3){const i=v.map(s(t[2]),e);if(i.t==="err")return i;r=i.v}if(t.length>=4){const i=v.map(s(t[3]),e);if(i.t==="err")return i;a=i.v}if(t.length>=5){const i=L.map(s(t[4]),e);if(i.t==="err")return i;o=i.v}if(r>a)return{t:"err",v:"#VALUE!"};const c=r+Math.random()*(a-r);return{t:"num",v:o?Math.floor(c):c}}function ja(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>3)return{t:"err",v:"#N/A!"};const r=Q(t[0],s,e);if(!Array.isArray(r))return r;if(r.length===0)return{t:"err",v:"#VALUE!"};let a=1;if(t.length>=3){const o=v.map(s(t[2]),e);if(o.t==="err")return o;a=o.v}return r.sort((o,c)=>a>=0?o-c:c-o),{t:"num",v:r[0]}}function Nt(u,s){if(u.t!=="ref")return u;const e=M([u.v]).next().value;if(!e)return{t:"str",v:""};const n=s.get(e),t=(n==null?void 0:n.v)||"";return t===""?{t:"str",v:""}:isNaN(Number(t))?{t:"str",v:t}:{t:"num",v:Number(t)}}function Ja(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);return r.t==="err"||r.t!=="ref"||!e?r:Nt(r,e)}function Za(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);return r.t==="err"||r.t!=="ref"||!e?r:Nt(r,e)}function to(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);return r.t==="err"||r.t!=="ref"||!e?r:Nt(r,e)}function ro(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=L.map(s(t[1]),e);return a.t==="err"?a:a.v?{t:"num",v:pt(r.v)}:{t:"num",v:gt(r.v)}}function eo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);return r.t==="err"?r:r.v<=0||r.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:H(r.v)}}function no(u,s,e){var i;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=Math.trunc(r.v),o=[];for(let f=1;f<t.length;f++){const m=s(t[f]);if(m.t==="err")return m;if(m.t==="num")o.push(m.v);else if(m.t==="ref"&&e)for(const l of M([m.v])){const p=((i=e.get(l))==null?void 0:i.v)||"";p!==""&&!isNaN(Number(p))&&o.push(Number(p))}}const c=a>100?a-100:a;if(o.length===0&&c!==2&&c!==3)return{t:"num",v:0};switch(c){case 1:return{t:"num",v:o.reduce((f,m)=>f+m,0)/o.length};case 2:return{t:"num",v:o.length};case 3:return{t:"num",v:o.length};case 4:return{t:"num",v:Math.max(...o)};case 5:return{t:"num",v:Math.min(...o)};case 6:return{t:"num",v:o.reduce((f,m)=>f*m,1)};case 7:{const f=o.length;if(f<2)return{t:"err",v:"#DIV/0!"};const m=o.reduce((p,g)=>p+g,0)/f,l=o.reduce((p,g)=>p+(g-m)*(g-m),0)/(f-1);return{t:"num",v:Math.sqrt(l)}}case 8:{const f=o.length;if(f===0)return{t:"err",v:"#DIV/0!"};const m=o.reduce((p,g)=>p+g,0)/f,l=o.reduce((p,g)=>p+(g-m)*(g-m),0)/f;return{t:"num",v:Math.sqrt(l)}}case 9:return{t:"num",v:o.reduce((f,m)=>f+m,0)};case 10:{const f=o.length;if(f<2)return{t:"err",v:"#DIV/0!"};const m=o.reduce((l,p)=>l+p,0)/f;return{t:"num",v:o.reduce((l,p)=>l+(p-m)*(p-m),0)/(f-1)}}case 11:{const f=o.length;if(f===0)return{t:"err",v:"#DIV/0!"};const m=o.reduce((l,p)=>l+p,0)/f;return{t:"num",v:o.reduce((l,p)=>l+(p-m)*(p-m),0)/f}}default:return{t:"err",v:"#VALUE!"}}}function so(u,s,e){var c;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length===0)return{t:"err",v:"#N/A!"};const r=[];for(const i of t){const f=s(i);if(f.t==="err")return f;if(f.t==="num"){r.push(f.v);continue}if(f.t==="bool"){r.push(f.v?1:0);continue}if(f.t==="str"){r.push(0);continue}if(f.t==="ref"&&e)for(const m of M([f.v])){const l=((c=e.get(m))==null?void 0:c.v)||"";if(l!==""){if(l==="true"){r.push(1);continue}if(l==="false"){r.push(0);continue}if(!isNaN(Number(l))){r.push(Number(l));continue}r.push(0)}}}const a=r.length;if(a<2)return{t:"err",v:"#DIV/0!"};const o=r.reduce((i,f)=>i+f,0)/a;return{t:"num",v:r.reduce((i,f)=>i+(f-o)*(f-o),0)/(a-1)}}function ao(u,s,e){var c;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length===0)return{t:"err",v:"#N/A!"};const r=[];for(const i of t){const f=s(i);if(f.t==="err")return f;if(f.t==="num"){r.push(f.v);continue}if(f.t==="bool"){r.push(f.v?1:0);continue}if(f.t==="str"){r.push(0);continue}if(f.t==="ref"&&e)for(const m of M([f.v])){const l=((c=e.get(m))==null?void 0:c.v)||"";if(l!==""){if(l==="true"){r.push(1);continue}if(l==="false"){r.push(0);continue}if(!isNaN(Number(l))){r.push(Number(l));continue}r.push(0)}}}const a=r.length;if(a===0)return{t:"err",v:"#DIV/0!"};const o=r.reduce((i,f)=>i+f,0)/a;return{t:"num",v:r.reduce((i,f)=>i+(f-o)*(f-o),0)/a}}function oo(u,s,e){var f;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length===0)return{t:"err",v:"#N/A!"};const r=[];for(const m of t){const l=s(m);if(l.t==="err")return l;if(l.t==="num"){r.push(l.v);continue}if(l.t==="ref"&&e)for(const p of M([l.v])){const g=((f=e.get(p))==null?void 0:f.v)||"";g!==""&&!isNaN(Number(g))&&r.push(Number(g))}}const a=r.length;if(a<3)return{t:"err",v:"#DIV/0!"};const o=r.reduce((m,l)=>m+l,0)/a,c=Math.sqrt(r.reduce((m,l)=>m+(l-o)*(l-o),0)/(a-1));if(c===0)return{t:"err",v:"#DIV/0!"};const i=r.reduce((m,l)=>m+Math.pow((l-o)/c,3),0);return{t:"num",v:a/((a-1)*(a-2))*i}}function uo(u,s,e){var m;const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length===0)return{t:"err",v:"#N/A!"};const r=[];for(const l of t){const p=s(l);if(p.t==="err")return p;if(p.t==="num"){r.push(p.v);continue}if(p.t==="ref"&&e)for(const g of M([p.v])){const h=((m=e.get(g))==null?void 0:m.v)||"";h!==""&&!isNaN(Number(h))&&r.push(Number(h))}}const a=r.length;if(a<4)return{t:"err",v:"#DIV/0!"};const o=r.reduce((l,p)=>l+p,0)/a,c=Math.sqrt(r.reduce((l,p)=>l+(p-o)*(p-o),0)/(a-1));if(c===0)return{t:"err",v:"#DIV/0!"};const i=r.reduce((l,p)=>l+Math.pow((p-o)/c,4),0);return{t:"num",v:a*(a+1)*i/((a-1)*(a-2)*(a-3))-3*(a-1)*(a-1)/((a-2)*(a-3))}}function co(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();return t.length!==1?{t:"err",v:"#N/A!"}:{t:"bool",v:s(t[0]).t==="ref"}}function io(u,s,e){return{t:"num",v:1}}function fo(u,s,e){return{t:"num",v:1}}function mo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=s(t[0]);if(r.t==="err"||r.t==="num")return r;if(r.t!=="ref"||!e)return{t:"err",v:"#VALUE!"};const a=r.v;if(!I(a)){const l=e.get(a),p=(l==null?void 0:l.v)||"";return p===""||isNaN(Number(p))?{t:"err",v:"#VALUE!"}:{t:"num",v:Number(p)}}const o=Z(a),c=o[1].r-o[0].r+1,i=o[1].c-o[0].c+1;if(c!==i)return{t:"err",v:"#VALUE!"};const f=[];for(let l=o[0].r;l<=o[1].r;l++){const p=[];for(let g=o[0].c;g<=o[1].c;g++){const h=wt({r:l,c:g}),N=e.get(h),d=(N==null?void 0:N.v)||"";if(d===""||isNaN(Number(d)))return{t:"err",v:"#VALUE!"};p.push(Number(d))}f.push(p)}function m(l){const p=l.length;if(p===1)return l[0][0];if(p===2)return l[0][0]*l[1][1]-l[0][1]*l[1][0];let g=0;for(let h=0;h<p;h++){const N=[];for(let d=1;d<p;d++)N.push([...l[d].slice(0,h),...l[d].slice(h+1)]);g+=(h%2===0?1:-1)*l[0][h]*m(N)}return g}return{t:"num",v:m(f)}}function lo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<3||t.length>4)return{t:"err",v:"#N/A!"};const r=D(t[0],t[1],s,e);if("t"in r)return r;const a=r.ys,o=r.xs,c=v.map(s(t[2]),e);if(c.t==="err")return c;const i=c.v;let f=i;if(t.length===4){const p=v.map(s(t[3]),e);if(p.t==="err")return p;f=p.v}if(o.reduce((p,g)=>p+g,0)>1.0001||o.some(p=>p<0))return{t:"err",v:"#VALUE!"};let l=0;for(let p=0;p<a.length;p++)a[p]>=i&&a[p]<=f&&(l+=o[p]);return{t:"num",v:l}}function vo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=A(s(t[1]),e);if(a.t==="err")return a;const o=A(s(t[2]),e);if(o.t==="err")return o;const c=a.v,i=o.v,f=r.v,m={m:{category:"length",factor:1},km:{category:"length",factor:1e3},cm:{category:"length",factor:.01},mm:{category:"length",factor:.001},in:{category:"length",factor:.0254},ft:{category:"length",factor:.3048},yd:{category:"length",factor:.9144},mi:{category:"length",factor:1609.344},Nmi:{category:"length",factor:1852},um:{category:"length",factor:1e-6},kg:{category:"mass",factor:1},g:{category:"mass",factor:.001},mg:{category:"mass",factor:1e-6},lbm:{category:"mass",factor:.45359237},ozm:{category:"mass",factor:.028349523125},stone:{category:"mass",factor:6.35029318},ton:{category:"mass",factor:907.18474},C:{category:"temperature",factor:1,offset:0},F:{category:"temperature",factor:5/9,offset:-32},K:{category:"temperature",factor:1,offset:-273.15},sec:{category:"time",factor:1},s:{category:"time",factor:1},min:{category:"time",factor:60},hr:{category:"time",factor:3600},day:{category:"time",factor:86400},yr:{category:"time",factor:31557600},l:{category:"volume",factor:1},lt:{category:"volume",factor:1},ml:{category:"volume",factor:.001},gal:{category:"volume",factor:3.785411784},qt:{category:"volume",factor:.946352946},pt:{category:"volume",factor:.473176473},cup:{category:"volume",factor:.2365882365},tsp:{category:"volume",factor:.00492892159375},tbs:{category:"volume",factor:.01478676478125},"m/s":{category:"speed",factor:1},"m/h":{category:"speed",factor:1/3600},mph:{category:"speed",factor:.44704},kn:{category:"speed",factor:.514444},m2:{category:"area",factor:1},ha:{category:"area",factor:1e4},acre:{category:"area",factor:4046.8564224},J:{category:"energy",factor:1},cal:{category:"energy",factor:4.1868},BTU:{category:"energy",factor:1055.05585262},kWh:{category:"energy",factor:36e5},eV:{category:"energy",factor:1602176634e-28}},l=m[c],p=m[i];if(!l||!p)return{t:"err",v:"#N/A!"};if(l.category!==p.category)return{t:"err",v:"#N/A!"};if(l.category==="temperature"){let g;c==="C"?g=f:c==="F"?g=(f-32)*5/9:g=f-273.15;let h;return i==="C"?h=g:i==="F"?h=g*9/5+32:h=g+273.15,{t:"num",v:h}}return{t:"num",v:f*l.factor/p.factor}}function po(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:r.v<0||a.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(r.v)&Math.trunc(a.v)}}function go(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:r.v<0||a.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(r.v)|Math.trunc(a.v)}}function ho(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:r.v<0||a.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(r.v)^Math.trunc(a.v)}}function No(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:r.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(r.v)*Math.pow(2,Math.trunc(a.v))}}function Ao(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);return a.t==="err"?a:r.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.floor(Math.trunc(r.v)/Math.pow(2,Math.trunc(a.v)))}}function xo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=r.v.trim();if(!/^[0-9A-Fa-f]+$/.test(a))return{t:"err",v:"#VALUE!"};const o=parseInt(a,16);return a.length===10&&a[0].match(/[89A-Fa-f]/)?{t:"num",v:o-Math.pow(2,40)}:{t:"num",v:o}}function Eo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=Math.trunc(r.v);if(a<-549755813888||a>549755813887)return{t:"err",v:"#VALUE!"};let o;if(a<0?o=(a+Math.pow(2,40)).toString(16).toUpperCase():o=a.toString(16).toUpperCase(),t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function Mo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=r.v.trim();if(!/^[01]+$/.test(a)||a.length>10)return{t:"err",v:"#VALUE!"};const o=parseInt(a,2);return a.length===10&&a[0]==="1"?{t:"num",v:o-1024}:{t:"num",v:o}}function Ro(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=Math.trunc(r.v);if(a<-512||a>511)return{t:"err",v:"#VALUE!"};let o;if(a<0?o=(a+1024).toString(2):o=a.toString(2),t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function bo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=r.v.trim();if(!/^[0-7]+$/.test(a))return{t:"err",v:"#VALUE!"};const o=parseInt(a,8);return a.length===10&&a[0]>="4"?{t:"num",v:o-Math.pow(2,30)}:{t:"num",v:o}}function Io(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;let a=Math.trunc(r.v);if(a<-536870912||a>536870911)return{t:"err",v:"#VALUE!"};let o;if(a<0?o=(a+Math.pow(2,30)).toString(8):o=a.toString(8),t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function O(u){if(u=u.trim().replace(/\s/g,""),u==="i")return{re:0,im:1};if(u==="-i")return{re:0,im:-1};if(u.endsWith("i")){const e=u.slice(0,-1),n=Number(e);if(!isNaN(n))return{re:0,im:n};const t=e.lastIndexOf("+"),r=e.lastIndexOf("-"),a=Math.max(t,r);if(a<=0)return null;const o=Number(e.slice(0,a));if(isNaN(o))return null;const c=e.slice(a),i=c==="+"?1:c==="-"?-1:Number(c);return isNaN(i)?null:{re:o,im:i}}const s=Number(u);return isNaN(s)?null:{re:s,im:0}}function To(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<2||t.length>3)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;let o="i";if(t.length===3){const i=A(s(t[2]),e);if(i.t==="err")return i;if(o=i.v,o!=="i"&&o!=="j")return{t:"err",v:"#VALUE!"}}if(a.v===0)return{t:"str",v:String(r.v)};if(r.v===0)return a.v===1?{t:"str",v:o}:a.v===-1?{t:"str",v:"-"+o}:{t:"str",v:a.v+o};const c=a.v>0?"+":"";return a.v===1?{t:"str",v:r.v+"+"+o}:a.v===-1?{t:"str",v:r.v+"-"+o}:{t:"str",v:r.v+c+a.v+o}}function Fo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=O(r.v);return a?{t:"num",v:a.re}:{t:"err",v:"#VALUE!"}}function So(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=O(r.v);return a?{t:"num",v:a.im}:{t:"err",v:"#VALUE!"}}function Lo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=O(r.v);return a?{t:"num",v:Math.sqrt(a.re*a.re+a.im*a.im)}:{t:"err",v:"#VALUE!"}}function T(u,s){if(s===0)return String(u);if(u===0)return s===1?"i":s===-1?"-i":s+"i";const e=s>0?"+":"";return s===1?u+"+i":s===-1?u+"-i":u+e+s+"i"}function C(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==1)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=O(r.v);return a||{t:"err",v:"#VALUE!"}}function Uo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1)return{t:"err",v:"#N/A!"};let r=0,a=0;for(const o of t){const c=A(s(o),e);if(c.t==="err")return c;const i=O(c.v);if(!i)return{t:"err",v:"#VALUE!"};r+=i.re,a+=i.im}return{t:"str",v:T(r,a)}}function Co(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=O(r.v);if(!a)return{t:"err",v:"#VALUE!"};const o=A(s(t[1]),e);if(o.t==="err")return o;const c=O(o.v);return c?{t:"str",v:T(a.re-c.re,a.im-c.im)}:{t:"err",v:"#VALUE!"}}function Vo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1)return{t:"err",v:"#N/A!"};let r=1,a=0;for(const o of t){const c=A(s(o),e);if(c.t==="err")return c;const i=O(c.v);if(!i)return{t:"err",v:"#VALUE!"};const f=r*i.re-a*i.im,m=r*i.im+a*i.re;r=f,a=m}return{t:"str",v:T(r,a)}}function Do(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=O(r.v);if(!a)return{t:"err",v:"#VALUE!"};const o=A(s(t[1]),e);if(o.t==="err")return o;const c=O(o.v);if(!c)return{t:"err",v:"#VALUE!"};const i=c.re*c.re+c.im*c.im;if(i===0)return{t:"err",v:"#VALUE!"};const f=(a.re*c.re+a.im*c.im)/i,m=(a.im*c.re-a.re*c.im)/i;return{t:"str",v:T(f,m)}}function Oo(u,s,e){const n=C(u,s,e);return"t"in n?n:{t:"str",v:T(n.re,-n.im)}}function yo(u,s,e){const n=C(u,s,e);return"t"in n?n:n.re===0&&n.im===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.atan2(n.im,n.re)}}function wo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=O(r.v);if(!a)return{t:"err",v:"#VALUE!"};const o=v.map(s(t[1]),e);if(o.t==="err")return o;const c=Math.sqrt(a.re*a.re+a.im*a.im),i=Math.atan2(a.im,a.re),f=Math.pow(c,o.v),m=f*Math.cos(o.v*i),l=f*Math.sin(o.v*i);return{t:"str",v:T(Math.abs(m)<1e-14?0:m,Math.abs(l)<1e-14?0:l)}}function _o(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.sqrt(n.re*n.re+n.im*n.im),r=Math.atan2(n.im,n.re),a=Math.sqrt(t),o=a*Math.cos(r/2),c=a*Math.sin(r/2);return{t:"str",v:T(Math.abs(o)<1e-14?0:o,Math.abs(c)<1e-14?0:c)}}function Po(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.exp(n.re),r=t*Math.cos(n.im),a=t*Math.sin(n.im);return{t:"str",v:T(Math.abs(r)<1e-14?0:r,Math.abs(a)<1e-14?0:a)}}function ko(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.sqrt(n.re*n.re+n.im*n.im);if(t===0)return{t:"err",v:"#VALUE!"};const r=Math.atan2(n.im,n.re);return{t:"str",v:T(Math.log(t),r)}}function Xo(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.sqrt(n.re*n.re+n.im*n.im);if(t===0)return{t:"err",v:"#VALUE!"};const r=Math.atan2(n.im,n.re),a=Math.log(2);return{t:"str",v:T(Math.log(t)/a,r/a)}}function Bo(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.sqrt(n.re*n.re+n.im*n.im);if(t===0)return{t:"err",v:"#VALUE!"};const r=Math.atan2(n.im,n.re),a=Math.log(10);return{t:"str",v:T(Math.log(t)/a,r/a)}}function Ho(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.sin(n.re)*Math.cosh(n.im),r=Math.cos(n.re)*Math.sinh(n.im);return{t:"str",v:T(Math.abs(t)<1e-14?0:t,Math.abs(r)<1e-14?0:r)}}function Go(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.cos(n.re)*Math.cosh(n.im),r=-(Math.sin(n.re)*Math.sinh(n.im));return{t:"str",v:T(Math.abs(t)<1e-14?0:t,Math.abs(r)<1e-14?0:r)}}function ut(u,s,e,n){const t=e*e+n*n;return{re:(u*e+s*n)/t,im:(s*e-u*n)/t}}function Yo(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.sin(n.re)*Math.cosh(n.im),r=Math.cos(n.re)*Math.sinh(n.im),a=Math.cos(n.re)*Math.cosh(n.im),o=-(Math.sin(n.re)*Math.sinh(n.im)),c=ut(t,r,a,o);return{t:"str",v:T(Math.abs(c.re)<1e-14?0:c.re,Math.abs(c.im)<1e-14?0:c.im)}}function qo(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.sinh(n.re)*Math.cos(n.im),r=Math.cosh(n.re)*Math.sin(n.im);return{t:"str",v:T(Math.abs(t)<1e-14?0:t,Math.abs(r)<1e-14?0:r)}}function Ko(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.cosh(n.re)*Math.cos(n.im),r=Math.sinh(n.re)*Math.sin(n.im);return{t:"str",v:T(Math.abs(t)<1e-14?0:t,Math.abs(r)<1e-14?0:r)}}function Wo(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.cos(n.re)*Math.cosh(n.im),r=-(Math.sin(n.re)*Math.sinh(n.im)),a=ut(1,0,t,r);return{t:"str",v:T(Math.abs(a.re)<1e-14?0:a.re,Math.abs(a.im)<1e-14?0:a.im)}}function Qo(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.sin(n.re)*Math.cosh(n.im),r=Math.cos(n.re)*Math.sinh(n.im),a=ut(1,0,t,r);return{t:"str",v:T(Math.abs(a.re)<1e-14?0:a.re,Math.abs(a.im)<1e-14?0:a.im)}}function $o(u,s,e){const n=C(u,s,e);if("t"in n)return n;const t=Math.sin(n.re)*Math.cosh(n.im),r=Math.cos(n.re)*Math.sinh(n.im),a=Math.cos(n.re)*Math.cosh(n.im),o=-(Math.sin(n.re)*Math.sinh(n.im)),c=ut(a,o,t,r);return{t:"str",v:T(Math.abs(c.re)<1e-14?0:c.re,Math.abs(c.im)<1e-14?0:c.im)}}function zo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=parseInt(r.v,16);if(isNaN(a))return{t:"err",v:"#VALUE!"};let o=a.toString(2);if(t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function jo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=parseInt(r.v,16);if(isNaN(a))return{t:"err",v:"#VALUE!"};let o=a.toString(8);if(t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function Jo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=parseInt(r.v,2);if(isNaN(a))return{t:"err",v:"#VALUE!"};let o=a.toString(16).toUpperCase();if(t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function Zo(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=parseInt(r.v,2);if(isNaN(a))return{t:"err",v:"#VALUE!"};let o=a.toString(8);if(t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function tu(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=parseInt(r.v,8);if(isNaN(a))return{t:"err",v:"#VALUE!"};let o=a.toString(16).toUpperCase();if(t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function ru(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length<1||t.length>2)return{t:"err",v:"#N/A!"};const r=A(s(t[0]),e);if(r.t==="err")return r;const a=parseInt(r.v,8);if(isNaN(a))return{t:"err",v:"#VALUE!"};let o=a.toString(2);if(t.length===2){const c=v.map(s(t[1]),e);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<o.length)return{t:"err",v:"#VALUE!"};o=o.padStart(i,"0")}return{t:"str",v:o}}function ct(u,s){let e=0;for(let n=0;n<=100;n++){const t=n%2===0?1:-1;let r=1;for(let c=2;c<=n;c++)r*=c;let a=1;for(let c=2;c<=u+n;c++)a*=c;const o=t/(r*a)*Math.pow(s/2,2*n+u);if(e+=o,Math.abs(o)<1e-15*Math.abs(e)&&n>5)break}return e}function eu(u,s){if(s<=0)return NaN;const e=.5772156649015329;function n(o){let c=0;for(let i=1;i<=100;i++){const f=i%2===0?1:-1;let m=1;for(let g=2;g<=i;g++)m*=g;let l=0;for(let g=1;g<=i;g++)l+=1/g;const p=f*l/(m*m)*Math.pow(o/2,2*i);if(c+=p,Math.abs(p)<1e-15*Math.abs(c)&&i>5)break}return 2/Math.PI*((Math.log(o/2)+e)*ct(0,o)-c)}function t(o){let c=0;for(let i=0;i<=100;i++){const f=i%2===0?1:-1;let m=1;for(let N=2;N<=i;N++)m*=N;let l=1;for(let N=2;N<=i+1;N++)l*=N;let p=0;for(let N=1;N<=i;N++)p+=1/N;let g=0;for(let N=1;N<=i+1;N++)g+=1/N;const h=f*(p+g)/(m*l)*Math.pow(o/2,2*i+1);if(c+=h,Math.abs(h)<1e-15*Math.abs(c)&&i>5)break}return 2/Math.PI*((Math.log(o/2)+e)*ct(1,o)-1/o)-1/Math.PI*c}if(u===0)return n(s);if(u===1)return t(s);let r=n(s),a=t(s);for(let o=1;o<u;o++){const c=2*o/s*a-r;r=a,a=c}return a}function nu(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);return o<0?{t:"err",v:"#VALUE!"}:{t:"num",v:ct(o,r.v)}}function su(u,s,e){const n=u.args();if(!n)return{t:"err",v:"#N/A!"};const t=n.expr();if(t.length!==2)return{t:"err",v:"#N/A!"};const r=v.map(s(t[0]),e);if(r.t==="err")return r;const a=v.map(s(t[1]),e);if(a.t==="err")return a;const o=Math.trunc(a.v);return o<0?{t:"err",v:"#VALUE!"}:r.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:eu(o,r.v)}}function Ot(u){return{syntaxError:(s,e,n,t,r)=>{u.push({message:r,line:n,charPositionInLine:t})}}}function it(u){const s=P.CharStreams.fromString(u.slice(1)),e=new G(s),n=new P.CommonTokenStream(e),t=new w(n),r=[];e.removeErrorListeners(),t.removeErrorListeners(),e.addErrorListener(Ot(r)),t.addErrorListener(Ot(r));try{return{tree:t.expr(),syntaxErrors:r,parser:t}}catch{return}}function ft(u){return u.syntaxErrors.length>0||u.parser.numberOfSyntaxErrors>0}function au(u){return u.length>0&&u.every(s=>s.message.includes("missing ')' at '<EOF>'"))}function ou(u){const s=P.CharStreams.fromString(u.slice(1)),e=new G(s),n=new P.CommonTokenStream(e);e.removeErrorListeners(),n.fill();let t=0;for(const r of n.getTokens()){if(r.type===G.T__0){t+=1;continue}r.type===G.T__1&&t>0&&(t-=1)}return t}function pu(u){if(!u.startsWith("="))return u;const s=it(u);if(!s||!ft(s)||!au(s.syntaxErrors))return u;const e=ou(u);if(e<=0)return u;const n=u+")".repeat(e),t=it(n);return!t||ft(t)?u:n}function gu(u){const s=P.CharStreams.fromString(u.slice(1)),e=new G(s),n=new P.CommonTokenStream(e);e.removeErrorListeners(),n.fill();const t=new Set;for(const r of n.getTokens())r.type===w.REFERENCE&&t.add(r.text.toUpperCase());return t}function At(u){const s=P.CharStreams.fromString(u.slice(1)),e=new G(s),n=new P.CommonTokenStream(e);e.removeErrorListeners(),n.fill();const t=[];for(const o of n.getTokens())o.type!=G.EOF&&t.push({type:e.vocabulary.getSymbolicName(o.type)||"STRING",start:o.startIndex,stop:o.stopIndex,text:o.text});const r=[];let a;for(const o of t)!a&&o.start>0?r.push({type:"STRING",start:0,stop:o.start-1,text:u.slice(1,o.start+1)}):a&&a.stop+1!==o.start&&r.push({type:"STRING",start:a.stop+1,stop:o.start-1,text:u.slice(a.stop+2,o.start+1)}),r.push(o),a=o;return a&&a.stop+2<u.length&&r.push({type:"STRING",start:a.stop+1,stop:u.length-1,text:u.slice(a.stop+2)}),r}function hu(u){const s=At(u),e=[];for(const n of s)if(n.type==="REFERENCE")try{const t=n.text.toUpperCase();if(W(t))continue;if(t.includes(":"))e.push({text:t,range:Z(t)});else{const r=nt(t);e.push({text:t,range:[r,r]})}}catch{}return e}function Nu(u,s){if(!u.startsWith("=")||s<=0)return!1;if(s===1)return!0;const e=At(u);for(const o of e){const c=o.start+1,i=o.stop+2;if(o.type==="REFERENCE"&&s>=c&&s<=i)return!0}const t=u.slice(0,s).trimEnd();if(t.length===0)return!1;const r=t[t.length-1];return new Set(["=","(",",","+","-","*","/","<",">",":"]).has(r)}function Au(u,s){if(!u.startsWith("="))return;const e=At(u);for(const n of e){if(n.type!=="REFERENCE")continue;const t=n.start+1,r=n.stop+2;if(s>=t&&s<=r)return{start:t,end:r,text:n.text}}}function du(u,s){var e;try{const n=it(u);if(!n||ft(n))return"#ERROR!";const r=new uu(s).visit(n.tree);return r.t==="ref"&&s?I(r.v)?"#VALUE!":((e=s.get(r.v))==null?void 0:e.v)||"":r.v.toString()}catch{return"#ERROR!"}}class uu{constructor(s){K(this,"grid");this.visit=this.visit.bind(this),this.grid=s}visitChildren(){throw new Error("Method not implemented.")}visitTerminal(){throw new Error("Method not implemented.")}visitErrorNode(){throw new Error("Method not implemented.")}visitFormula(){throw new Error("Method not implemented.")}visitExpr(){throw new Error("Method not implemented.")}visitArgs(){throw new Error("Method not implemented.")}visit(s){return s.accept(this)}visitFunction(s){const e=s.FUNCNAME().text.toUpperCase();if(xt.has(e))return xt.get(e)(s,this.visit,this.grid);throw new Error("Function not implemented.")}visitReference(s){return this.grid?{t:"ref",v:s.text.toUpperCase()}:{t:"err",v:"#REF!"}}visitParentheses(s){return this.visit(s.expr())}visitNumber(s){return{t:"num",v:Number(s.text)}}visitBoolean(s){return{t:"bool",v:s.text==="TRUE"||s.text==="true"}}visitAddSub(s){const e=v.map(this.visit(s.expr(0)),this.grid);if(e.t==="err")return e;const n=v.map(this.visit(s.expr(1)),this.grid);return n.t==="err"?n:s._op.type===w.ADD?{t:"num",v:e.v+n.v}:{t:"num",v:e.v-n.v}}visitMulDiv(s){const e=v.map(this.visit(s.expr(0)),this.grid);if(e.t==="err")return e;const n=v.map(this.visit(s.expr(1)),this.grid);return n.t==="err"?n:s._op.type===w.MUL?{t:"num",v:e.v*n.v}:{t:"num",v:e.v/n.v}}visitComparison(s){const e=v.map(this.visit(s.expr(0)),this.grid);if(e.t==="err")return e;const n=v.map(this.visit(s.expr(1)),this.grid);if(n.t==="err")return n;switch(s._op.type){case w.EQ:return{t:"bool",v:e.v===n.v};case w.NEQ:return{t:"bool",v:e.v!==n.v};case w.LT:return{t:"bool",v:e.v<n.v};case w.GT:return{t:"bool",v:e.v>n.v};case w.LTE:return{t:"bool",v:e.v<=n.v};case w.GTE:return{t:"bool",v:e.v>=n.v};default:return{t:"err",v:"#ERROR!"}}}visitStr(s){return{t:"str",v:s.text.slice(1,-1)}}}const qt=["Date","Engineering","Filter","Financial","Info","Logical","Lookup","Math","Operator","Statistical","Text","Database","Parser","Array","Web"],cu=[{name:"SUM",description:"Returns the sum of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"ABS",description:"Returns the absolute value of a number",args:[{name:"number"}]},{name:"ROUND",description:"Rounds a number to a certain number of decimal places",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDUP",description:"Rounds a number away from zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDDOWN",description:"Rounds a number toward zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"INT",description:"Rounds a number down to the nearest integer",args:[{name:"value"}]},{name:"MOD",description:"Returns the remainder after division",args:[{name:"dividend"},{name:"divisor"}]},{name:"SQRT",description:"Returns the positive square root of a number",args:[{name:"value"}]},{name:"POWER",description:"Returns a number raised to a power",args:[{name:"base"},{name:"exponent"}]},{name:"PRODUCT",description:"Multiplies a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MEDIAN",description:"Returns the middle number in a series",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"RAND",description:"Returns a random number between 0 and 1",args:[]},{name:"RANDBETWEEN",description:"Returns a random integer between two values",args:[{name:"low"},{name:"high"}]},{name:"IF",description:"Returns one value if true and another if false",args:[{name:"condition"},{name:"value_if_true"},{name:"value_if_false",optional:!0}]},{name:"IFS",description:"Returns the first value whose condition is true",args:[{name:"condition1"},{name:"value1"},{name:"condition2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0}]},{name:"SWITCH",description:"Matches an expression against case/value pairs",args:[{name:"expression"},{name:"case1"},{name:"value1"},{name:"case2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0},{name:"default",optional:!0}]},{name:"AND",description:"Returns TRUE if all arguments are true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"OR",description:"Returns TRUE if any argument is true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"NOT",description:"Returns the opposite of a logical value",args:[{name:"logical"}]},{name:"AVERAGE",description:"Returns the average of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MIN",description:"Returns the smallest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MAX",description:"Returns the largest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"COUNT",description:"Counts the number of numeric values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTA",description:"Counts the number of non-empty values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTBLANK",description:"Counts empty cells",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTIF",description:"Counts values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"}]},{name:"SUMIF",description:"Sums values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"},{name:"sum_range",optional:!0}]},{name:"COUNTIFS",description:"Counts values that meet multiple criteria",args:[{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"SUMIFS",description:"Sums values that meet multiple criteria",args:[{name:"sum_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"MATCH",description:"Returns the position of an item in a one-dimensional range",args:[{name:"search_key"},{name:"range"},{name:"search_type",optional:!0}]},{name:"INDEX",description:"Returns the value at a given row and column of a range",args:[{name:"reference"},{name:"row",optional:!0},{name:"column",optional:!0}]},{name:"VLOOKUP",description:"Looks up a value in the first column of a range",args:[{name:"search_key"},{name:"range"},{name:"index"},{name:"is_sorted",optional:!0}]},{name:"HLOOKUP",description:"Looks up a value in the first row of a range",args:[{name:"search_key"},{name:"range"},{name:"index"},{name:"is_sorted",optional:!0}]},{name:"TRIM",description:"Removes leading and trailing whitespace from text",args:[{name:"text"}]},{name:"LEN",description:"Returns the number of characters in a text string",args:[{name:"text"}]},{name:"LEFT",description:"Returns the leftmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"RIGHT",description:"Returns the rightmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"MID",description:"Returns characters from the middle of a text string",args:[{name:"text"},{name:"start_num"},{name:"num_chars"}]},{name:"CONCATENATE",description:"Joins two or more text strings into one",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"CONCAT",description:"Joins text values into one string",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"FIND",description:"Finds one text value inside another (case-sensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"SEARCH",description:"Finds one text value inside another (case-insensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"TEXTJOIN",description:"Joins text values with a delimiter",args:[{name:"delimiter"},{name:"ignore_empty"},{name:"text1"},{name:"text2",optional:!0,repeating:!0}]},{name:"LOWER",description:"Converts text to lowercase",args:[{name:"text"}]},{name:"UPPER",description:"Converts text to uppercase",args:[{name:"text"}]},{name:"PROPER",description:"Capitalizes each word in text",args:[{name:"text"}]},{name:"SUBSTITUTE",description:"Replaces existing text with new text in a string",args:[{name:"text"},{name:"search_for"},{name:"replace_with"},{name:"occurrence",optional:!0}]},{name:"TODAY",description:"Returns the current date",args:[]},{name:"NOW",description:"Returns the current date and time",args:[]},{name:"DATE",description:"Returns a date from year, month, and day values",args:[{name:"year"},{name:"month"},{name:"day"}]},{name:"TIME",description:"Returns a time from hour, minute, and second values",args:[{name:"hour"},{name:"minute"},{name:"second"}]},{name:"DAYS",description:"Returns the number of days between two dates",args:[{name:"end_date"},{name:"start_date"}]},{name:"YEAR",description:"Returns the year from a date",args:[{name:"date"}]},{name:"MONTH",description:"Returns the month from a date (1-12)",args:[{name:"date"}]},{name:"DAY",description:"Returns the day of the month from a date (1-31)",args:[{name:"date"}]},{name:"HOUR",description:"Returns the hour from a date/time (0-23)",args:[{name:"time"}]},{name:"MINUTE",description:"Returns the minute from a date/time (0-59)",args:[{name:"time"}]},{name:"SECOND",description:"Returns the second from a date/time (0-59)",args:[{name:"time"}]},{name:"WEEKDAY",description:"Returns day of the week as a number",args:[{name:"date"},{name:"type",optional:!0}]},{name:"ISBLANK",description:"Checks whether a value is blank",args:[{name:"value"}]},{name:"ISNUMBER",description:"Checks whether a value is a number",args:[{name:"value"}]},{name:"ISTEXT",description:"Checks whether a value is text",args:[{name:"value"}]},{name:"ISERROR",description:"Checks whether a value is any error",args:[{name:"value"}]},{name:"ISERR",description:"Checks whether a value is an error except #N/A!",args:[{name:"value"}]},{name:"ISNA",description:"Checks whether a value is the #N/A! error",args:[{name:"value"}]},{name:"ISLOGICAL",description:"Checks whether a value is boolean",args:[{name:"value"}]},{name:"ISNONTEXT",description:"Checks whether a value is not text",args:[{name:"value"}]},{name:"IFERROR",description:"Returns a value if no error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_error"}]},{name:"IFNA",description:"Returns a value if no #N/A! error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_na"}]},{name:"PI",description:"Returns the value of Pi",args:[]},{name:"SIGN",description:"Returns the sign of a number (-1, 0, or 1)",args:[{name:"number"}]},{name:"EVEN",description:"Rounds a number up to the nearest even integer",args:[{name:"number"}]},{name:"ODD",description:"Rounds a number up to the nearest odd integer",args:[{name:"number"}]},{name:"EXP",description:"Returns Euler's number raised to a power",args:[{name:"exponent"}]},{name:"LN",description:"Returns the natural logarithm of a number",args:[{name:"number"}]},{name:"LOG",description:"Returns the logarithm of a number given a base",args:[{name:"number"},{name:"base",optional:!0}]},{name:"SIN",description:"Returns the sine of an angle in radians",args:[{name:"angle"}]},{name:"COS",description:"Returns the cosine of an angle in radians",args:[{name:"angle"}]},{name:"TAN",description:"Returns the tangent of an angle in radians",args:[{name:"angle"}]},{name:"ASIN",description:"Returns the inverse sine of a value in radians",args:[{name:"value"}]},{name:"ACOS",description:"Returns the inverse cosine of a value in radians",args:[{name:"value"}]},{name:"ATAN",description:"Returns the inverse tangent of a value in radians",args:[{name:"value"}]},{name:"ATAN2",description:"Returns the angle between the x-axis and a point",args:[{name:"x"},{name:"y"}]},{name:"DEGREES",description:"Converts an angle from radians to degrees",args:[{name:"angle"}]},{name:"RADIANS",description:"Converts an angle from degrees to radians",args:[{name:"angle"}]},{name:"CEILING",description:"Rounds a number up to the nearest multiple of significance",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"FLOOR",description:"Rounds a number down to the nearest multiple of significance",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"TRUNC",description:"Truncates a number to a given number of decimal places",args:[{name:"number"},{name:"places",optional:!0}]},{name:"MROUND",description:"Rounds a number to the nearest specified multiple",args:[{name:"number"},{name:"multiple"}]},{name:"EXACT",description:"Tests whether two strings are identical (case-sensitive)",args:[{name:"text1"},{name:"text2"}]},{name:"REPLACE",description:"Replaces part of a text string with a different text string",args:[{name:"old_text"},{name:"start_num"},{name:"num_chars"},{name:"new_text"}]},{name:"REPT",description:"Repeats text a given number of times",args:[{name:"text"},{name:"number_times"}]},{name:"T",description:"Returns the text referred to by value",args:[{name:"value"}]},{name:"VALUE",description:"Converts a text string that represents a number to a number",args:[{name:"text"}]},{name:"TEXT",description:"Formats a number and converts it to text",args:[{name:"number"},{name:"format"}]},{name:"CHAR",description:"Returns the character specified by the code number",args:[{name:"number"}]},{name:"CODE",description:"Returns a numeric code for the first character in a text string",args:[{name:"text"}]},{name:"AVERAGEIF",description:"Returns the average of a range that meets a criterion",args:[{name:"criteria_range"},{name:"criterion"},{name:"average_range",optional:!0}]},{name:"AVERAGEIFS",description:"Returns the average of a range that meets multiple criteria",args:[{name:"average_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"LARGE",description:"Returns the nth largest value in a data set",args:[{name:"data"},{name:"n"}]},{name:"SMALL",description:"Returns the nth smallest value in a data set",args:[{name:"data"},{name:"n"}]},{name:"N",description:"Converts a value to a number",args:[{name:"value"}]},{name:"SUMPRODUCT",description:"Multiplies corresponding components and returns the sum",args:[{name:"array1"},{name:"array2",optional:!0,repeating:!0}]},{name:"GCD",description:"Returns the greatest common divisor",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"LCM",description:"Returns the least common multiple",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"COMBIN",description:"Returns the number of combinations for a given number of items",args:[{name:"n"},{name:"k"}]},{name:"FACT",description:"Returns the factorial of a number",args:[{name:"number"}]},{name:"QUOTIENT",description:"Returns the integer portion of a division",args:[{name:"numerator"},{name:"denominator"}]},{name:"XOR",description:"Returns TRUE if an odd number of arguments are TRUE",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"CHOOSE",description:"Returns a value from a list based on index",args:[{name:"index"},{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"TYPE",description:"Returns a number indicating the data type of a value",args:[{name:"value"}]},{name:"EDATE",description:"Returns a date a specified number of months before or after another date",args:[{name:"start_date"},{name:"months"}]},{name:"EOMONTH",description:"Returns the last day of the month a specified number of months away",args:[{name:"start_date"},{name:"months"}]},{name:"NETWORKDAYS",description:"Returns the number of net working days between two dates",args:[{name:"start_date"},{name:"end_date"},{name:"holidays",optional:!0}]},{name:"DATEVALUE",description:"Converts a date string to a date value",args:[{name:"date_string"}]},{name:"TIMEVALUE",description:"Returns the fraction of the day a time represents",args:[{name:"time_string"}]},{name:"DATEDIF",description:"Calculates the number of days, months, or years between two dates",args:[{name:"start_date"},{name:"end_date"},{name:"unit"}]},{name:"ROW",description:"Returns the row number of a reference",args:[{name:"reference",optional:!0}]},{name:"COLUMN",description:"Returns the column number of a reference",args:[{name:"reference",optional:!0}]},{name:"ROWS",description:"Returns the number of rows in a range",args:[{name:"range"}]},{name:"COLUMNS",description:"Returns the number of columns in a range",args:[{name:"range"}]},{name:"ADDRESS",description:"Returns a cell reference as text given row and column numbers",args:[{name:"row"},{name:"column"},{name:"abs_num",optional:!0},{name:"a1",optional:!0}]},{name:"HYPERLINK",description:"Creates a hyperlink in a cell",args:[{name:"url"},{name:"link_label",optional:!0}]},{name:"MINIFS",description:"Returns the minimum value in a range that meets multiple criteria",args:[{name:"min_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"MAXIFS",description:"Returns the maximum value in a range that meets multiple criteria",args:[{name:"max_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"RANK",description:"Returns the rank of a value within a data set",args:[{name:"value"},{name:"data"},{name:"order",optional:!0}]},{name:"PERCENTILE",description:"Returns the k-th percentile of a data set",args:[{name:"data"},{name:"k"}]},{name:"CLEAN",description:"Removes all non-printable characters from text",args:[{name:"text"}]},{name:"NUMBERVALUE",description:"Converts text to a number in a locale-independent way",args:[{name:"text"},{name:"decimal_separator",optional:!0},{name:"group_separator",optional:!0}]},{name:"STDEV",description:"Returns the sample standard deviation",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"STDEVP",description:"Returns the population standard deviation",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"VAR",description:"Returns the sample variance",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"VARP",description:"Returns the population variance",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MODE",description:"Returns the most frequently occurring value",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"SUMSQ",description:"Returns the sum of the squares of the arguments",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"NA",description:"Returns the #N/A! error value",args:[]},{name:"QUARTILE",description:"Returns the quartile of a data set",args:[{name:"data"},{name:"quart"}]},{name:"COUNTUNIQUE",description:"Counts the number of unique values in a list",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"FIXED",description:"Formats a number with a fixed number of decimal places",args:[{name:"number"},{name:"decimals",optional:!0},{name:"no_commas",optional:!0}]},{name:"DOLLAR",description:"Formats a number as currency with a dollar sign",args:[{name:"number"},{name:"decimals",optional:!0}]},{name:"WEEKNUM",description:"Returns the week number of the year",args:[{name:"date"},{name:"type",optional:!0}]},{name:"ISOWEEKNUM",description:"Returns the ISO week number of the year",args:[{name:"date"}]},{name:"WORKDAY",description:"Returns a date that is a specified number of working days away",args:[{name:"start_date"},{name:"days"},{name:"holidays",optional:!0}]},{name:"YEARFRAC",description:"Returns the fraction of the year between two dates",args:[{name:"start_date"},{name:"end_date"},{name:"basis",optional:!0}]},{name:"LOOKUP",description:"Searches a sorted range for a key",args:[{name:"search_key"},{name:"search_range"},{name:"result_range",optional:!0}]},{name:"INDIRECT",description:"Returns the reference specified by a text string",args:[{name:"cell_reference"},{name:"is_A1_notation",optional:!0}]},{name:"ERROR.TYPE",description:"Returns a number corresponding to the error type",args:[{name:"value"}]},{name:"ISDATE",description:"Checks whether a value is a date",args:[{name:"value"}]},{name:"SPLIT",description:"Splits text around a delimiter",args:[{name:"text"},{name:"delimiter"},{name:"split_by_each",optional:!0},{name:"remove_empty",optional:!0}]},{name:"JOIN",description:"Joins values with a delimiter",args:[{name:"delimiter"},{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"REGEXMATCH",description:"Returns whether text matches a regular expression",args:[{name:"text"},{name:"regular_expression"}]},{name:"FORECAST",description:"Predicts a y-value for a given x using linear regression",args:[{name:"x"},{name:"known_ys"},{name:"known_xs"}]},{name:"SLOPE",description:"Returns the slope of the linear regression line",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"INTERCEPT",description:"Returns the y-intercept of the linear regression line",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"CORREL",description:"Returns the Pearson correlation coefficient",args:[{name:"data_y"},{name:"data_x"}]},{name:"XLOOKUP",description:"Searches a range for a match and returns a corresponding item",args:[{name:"search_key"},{name:"lookup_range"},{name:"return_range"},{name:"if_not_found",optional:!0},{name:"match_mode",optional:!0},{name:"search_mode",optional:!0}]},{name:"OFFSET",description:"Returns a reference offset from a starting reference",args:[{name:"reference"},{name:"rows"},{name:"cols"},{name:"height",optional:!0},{name:"width",optional:!0}]},{name:"ISEVEN",description:"Checks whether a number is even",args:[{name:"number"}]},{name:"ISODD",description:"Checks whether a number is odd",args:[{name:"number"}]},{name:"FACTDOUBLE",description:"Returns the double factorial of a number",args:[{name:"number"}]},{name:"BASE",description:"Converts a number to text in another base",args:[{name:"number"},{name:"base"},{name:"min_length",optional:!0}]},{name:"DECIMAL",description:"Converts text from another base to a decimal number",args:[{name:"text"},{name:"base"}]},{name:"SQRTPI",description:"Returns the square root of number * PI",args:[{name:"number"}]},{name:"SINH",description:"Returns the hyperbolic sine of a number",args:[{name:"number"}]},{name:"COSH",description:"Returns the hyperbolic cosine of a number",args:[{name:"number"}]},{name:"TANH",description:"Returns the hyperbolic tangent of a number",args:[{name:"number"}]},{name:"ASINH",description:"Returns the inverse hyperbolic sine of a number",args:[{name:"number"}]},{name:"ACOSH",description:"Returns the inverse hyperbolic cosine of a number",args:[{name:"number"}]},{name:"ATANH",description:"Returns the inverse hyperbolic tangent of a number",args:[{name:"number"}]},{name:"COT",description:"Returns the cotangent of an angle in radians",args:[{name:"angle"}]},{name:"CSC",description:"Returns the cosecant of an angle in radians",args:[{name:"angle"}]},{name:"SEC",description:"Returns the secant of an angle in radians",args:[{name:"angle"}]},{name:"REGEXEXTRACT",description:"Extracts matching substrings using a regular expression",args:[{name:"text"},{name:"regular_expression"}]},{name:"REGEXREPLACE",description:"Replaces text matching a regular expression",args:[{name:"text"},{name:"regular_expression"},{name:"replacement"}]},{name:"UNICODE",description:"Returns the Unicode code point of the first character",args:[{name:"text"}]},{name:"UNICHAR",description:"Returns the Unicode character for a code point",args:[{name:"number"}]},{name:"GEOMEAN",description:"Returns the geometric mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"HARMEAN",description:"Returns the harmonic mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"AVEDEV",description:"Returns the average absolute deviation from the mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"DEVSQ",description:"Returns the sum of squared deviations from the mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"TRIMMEAN",description:"Returns the mean of the interior portion of a data set",args:[{name:"data"},{name:"percent"}]},{name:"PERMUT",description:"Returns the number of permutations for a given number of objects",args:[{name:"n"},{name:"k"}]},{name:"PMT",description:"Returns the periodic payment for an annuity",args:[{name:"rate"},{name:"nper"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"FV",description:"Returns the future value of an investment",args:[{name:"rate"},{name:"nper"},{name:"pmt"},{name:"pv",optional:!0},{name:"type",optional:!0}]},{name:"PV",description:"Returns the present value of an investment",args:[{name:"rate"},{name:"nper"},{name:"pmt"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"NPV",description:"Returns the net present value of an investment",args:[{name:"rate"},{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"NPER",description:"Returns the number of periods for an investment",args:[{name:"rate"},{name:"pmt"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"IPMT",description:"Returns the interest portion of a payment",args:[{name:"rate"},{name:"period"},{name:"nper"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"PPMT",description:"Returns the principal portion of a payment",args:[{name:"rate"},{name:"period"},{name:"nper"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"SLN",description:"Returns the straight-line depreciation of an asset",args:[{name:"cost"},{name:"salvage"},{name:"life"}]},{name:"EFFECT",description:"Returns the effective annual interest rate",args:[{name:"nominal_rate"},{name:"periods_per_year"}]},{name:"RATE",description:"Returns the interest rate per period of an annuity",args:[{name:"nper"},{name:"pmt"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0},{name:"guess",optional:!0}]},{name:"IRR",description:"Returns the internal rate of return for a series of cash flows",args:[{name:"values"},{name:"guess",optional:!0}]},{name:"DB",description:"Returns the depreciation using the fixed-declining balance method",args:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"month",optional:!0}]},{name:"DDB",description:"Returns the depreciation using the double-declining balance method",args:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"factor",optional:!0}]},{name:"NOMINAL",description:"Returns the nominal annual interest rate",args:[{name:"effective_rate"},{name:"periods_per_year"}]},{name:"CUMIPMT",description:"Returns the cumulative interest paid between two periods",args:[{name:"rate"},{name:"nper"},{name:"pv"},{name:"start_period"},{name:"end_period"},{name:"type"}]},{name:"CUMPRINC",description:"Returns the cumulative principal paid between two periods",args:[{name:"rate"},{name:"nper"},{name:"pv"},{name:"start_period"},{name:"end_period"},{name:"type"}]},{name:"AVERAGEA",description:"Returns the average, including text as 0 and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"MINA",description:"Returns the minimum value, including text as 0 and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"MAXA",description:"Returns the maximum value, including text as 0 and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"FISHER",description:"Returns the Fisher transformation",args:[{name:"x"}]},{name:"FISHERINV",description:"Returns the inverse Fisher transformation",args:[{name:"y"}]},{name:"GAMMA",description:"Returns the gamma function value",args:[{name:"number"}]},{name:"GAMMALN",description:"Returns the natural log of the gamma function",args:[{name:"number"}]},{name:"NORMDIST",description:"Returns the normal distribution",args:[{name:"x"},{name:"mean"},{name:"stdev"},{name:"cumulative"}]},{name:"NORMINV",description:"Returns the inverse of the normal distribution",args:[{name:"probability"},{name:"mean"},{name:"stdev"}]},{name:"LOGNORMAL.DIST",description:"Returns the lognormal distribution",args:[{name:"x"},{name:"mean"},{name:"stdev"},{name:"cumulative"}]},{name:"LOGNORMAL.INV",description:"Returns the inverse of the lognormal distribution",args:[{name:"probability"},{name:"mean"},{name:"stdev"}]},{name:"STANDARDIZE",description:"Returns a normalized value (z-score)",args:[{name:"x"},{name:"mean"},{name:"stdev"}]},{name:"WEIBULL.DIST",description:"Returns the Weibull distribution",args:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"}]},{name:"POISSON.DIST",description:"Returns the Poisson distribution",args:[{name:"x"},{name:"mean"},{name:"cumulative"}]},{name:"BINOM.DIST",description:"Returns the binomial distribution probability",args:[{name:"successes"},{name:"trials"},{name:"probability"},{name:"cumulative"}]},{name:"EXPON.DIST",description:"Returns the exponential distribution",args:[{name:"x"},{name:"lambda"},{name:"cumulative"}]},{name:"CONFIDENCE.NORM",description:"Returns the confidence interval using normal distribution",args:[{name:"alpha"},{name:"stdev"},{name:"size"}]},{name:"CONFIDENCE.T",description:"Returns the confidence interval using t-distribution",args:[{name:"alpha"},{name:"stdev"},{name:"size"}]},{name:"CHISQ.DIST",description:"Returns the chi-squared distribution",args:[{name:"x"},{name:"degrees_freedom"},{name:"cumulative"}]},{name:"CHISQ.INV",description:"Returns the inverse of the chi-squared distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"T.DIST",description:"Returns the Student t-distribution",args:[{name:"x"},{name:"degrees_freedom"},{name:"cumulative"}]},{name:"T.INV",description:"Returns the inverse of the Student t-distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"HYPGEOM.DIST",description:"Returns the hypergeometric distribution",args:[{name:"sample_s"},{name:"number_sample"},{name:"population_s"},{name:"number_pop"},{name:"cumulative"}]},{name:"NEGBINOM.DIST",description:"Returns the negative binomial distribution",args:[{name:"failures"},{name:"successes"},{name:"probability"},{name:"cumulative"}]},{name:"ARABIC",description:"Converts a Roman numeral to a number",args:[{name:"roman_numeral"}]},{name:"ROMAN",description:"Converts a number to Roman numeral text",args:[{name:"number"},{name:"form",optional:!0}]},{name:"MULTINOMIAL",description:"Returns the multinomial coefficient",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"SERIESSUM",description:"Returns the sum of a power series",args:[{name:"x"},{name:"n"},{name:"m"},{name:"coefficients"}]},{name:"DELTA",description:"Tests whether two values are equal",args:[{name:"number1"},{name:"number2",optional:!0}]},{name:"GESTEP",description:"Tests whether a number is greater than or equal to a step value",args:[{name:"number"},{name:"step",optional:!0}]},{name:"ERF",description:"Returns the error function",args:[{name:"lower_limit"},{name:"upper_limit",optional:!0}]},{name:"ERFC",description:"Returns the complementary error function",args:[{name:"x"}]},{name:"XNPV",description:"Returns net present value for irregular cash flows",args:[{name:"rate"},{name:"values"},{name:"dates"}]},{name:"XIRR",description:"Returns internal rate of return for irregular cash flows",args:[{name:"values"},{name:"dates"},{name:"guess",optional:!0}]},{name:"SYD",description:"Returns the sum-of-years-digits depreciation",args:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"}]},{name:"MIRR",description:"Returns the modified internal rate of return",args:[{name:"values"},{name:"finance_rate"},{name:"reinvest_rate"}]},{name:"TBILLEQ",description:"Returns the bond-equivalent yield for a T-bill",args:[{name:"settlement"},{name:"maturity"},{name:"discount"}]},{name:"TBILLPRICE",description:"Returns the price per $100 for a T-bill",args:[{name:"settlement"},{name:"maturity"},{name:"discount"}]},{name:"TBILLYIELD",description:"Returns the yield for a T-bill",args:[{name:"settlement"},{name:"maturity"},{name:"price"}]},{name:"DOLLARDE",description:"Converts a fractional dollar price to a decimal price",args:[{name:"fractional_dollar"},{name:"fraction"}]},{name:"DOLLARFR",description:"Converts a decimal dollar price to a fractional price",args:[{name:"decimal_dollar"},{name:"fraction"}]},{name:"ENCODEURL",description:"Encodes a string for use in a URL",args:[{name:"text"}]},{name:"ISURL",description:"Returns TRUE if a value is a valid URL",args:[{name:"value"}]},{name:"ISFORMULA",description:"Returns TRUE if a cell contains a formula",args:[{name:"cell"}]},{name:"FORMULATEXT",description:"Returns the formula of a cell as a string",args:[{name:"cell"}]},{name:"CEILING.MATH",description:"Rounds a number up to the nearest integer or multiple of significance",args:[{name:"number"},{name:"significance",optional:!0},{name:"mode",optional:!0}]},{name:"FLOOR.MATH",description:"Rounds a number down to the nearest integer or multiple of significance",args:[{name:"number"},{name:"significance",optional:!0},{name:"mode",optional:!0}]},{name:"CEILING.PRECISE",description:"Rounds a number up to the nearest multiple of significance, ignoring sign",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"FLOOR.PRECISE",description:"Rounds a number down to the nearest multiple of significance, ignoring sign",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"COVAR",description:"Returns the population covariance of two datasets",args:[{name:"data_y"},{name:"data_x"}]},{name:"COVARIANCE.S",description:"Returns the sample covariance of two datasets",args:[{name:"data_y"},{name:"data_x"}]},{name:"RSQ",description:"Returns the R-squared value of a linear regression",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"STEYX",description:"Returns the standard error of the predicted y-value in a regression",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"SUMX2MY2",description:"Returns the sum of differences of squares of corresponding values",args:[{name:"array_x"},{name:"array_y"}]},{name:"SUMX2PY2",description:"Returns the sum of sums of squares of corresponding values",args:[{name:"array_x"},{name:"array_y"}]},{name:"SUMXMY2",description:"Returns the sum of squares of differences of corresponding values",args:[{name:"array_x"},{name:"array_y"}]},{name:"PERCENTILE.EXC",description:"Returns the k-th percentile of values using exclusive interpolation",args:[{name:"data"},{name:"k"}]},{name:"QUARTILE.EXC",description:"Returns the exclusive quartile of a dataset",args:[{name:"data"},{name:"quart"}]},{name:"RANK.AVG",description:"Returns the rank of a value with average ranking for ties",args:[{name:"value"},{name:"data"},{name:"is_ascending",optional:!0}]},{name:"PERCENTRANK",description:"Returns the percentage rank of a value in a dataset (inclusive)",args:[{name:"data"},{name:"x"},{name:"significance",optional:!0}]},{name:"PERCENTRANK.EXC",description:"Returns the percentage rank of a value in a dataset (exclusive)",args:[{name:"data"},{name:"x"},{name:"significance",optional:!0}]},{name:"BETA.DIST",description:"Returns the beta distribution probability",args:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"},{name:"A",optional:!0},{name:"B",optional:!0}]},{name:"BETA.INV",description:"Returns the inverse of the beta cumulative distribution",args:[{name:"probability"},{name:"alpha"},{name:"beta"},{name:"A",optional:!0},{name:"B",optional:!0}]},{name:"F.DIST",description:"Returns the F probability distribution",args:[{name:"x"},{name:"deg_freedom1"},{name:"deg_freedom2"},{name:"cumulative"}]},{name:"F.INV",description:"Returns the inverse of the F probability distribution",args:[{name:"probability"},{name:"deg_freedom1"},{name:"deg_freedom2"}]},{name:"GAMMA.DIST",description:"Returns the gamma distribution probability",args:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"}]},{name:"GAMMA.INV",description:"Returns the inverse of the gamma cumulative distribution",args:[{name:"probability"},{name:"alpha"},{name:"beta"}]},{name:"CHISQ.DIST.RT",description:"Returns the right-tailed chi-squared distribution probability",args:[{name:"x"},{name:"degrees_freedom"}]},{name:"CHISQ.INV.RT",description:"Returns the inverse right-tailed chi-squared distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"T.DIST.RT",description:"Returns the right-tailed Student t-distribution",args:[{name:"x"},{name:"degrees_freedom"}]},{name:"T.DIST.2T",description:"Returns the two-tailed Student t-distribution",args:[{name:"x"},{name:"degrees_freedom"}]},{name:"T.INV.2T",description:"Returns the inverse two-tailed Student t-distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"F.DIST.RT",description:"Returns the right-tailed F probability distribution",args:[{name:"x"},{name:"deg_freedom1"},{name:"deg_freedom2"}]},{name:"F.INV.RT",description:"Returns the inverse right-tailed F probability distribution",args:[{name:"probability"},{name:"deg_freedom1"},{name:"deg_freedom2"}]},{name:"BINOM.INV",description:"Returns the smallest value for which the cumulative binomial distribution is >= alpha",args:[{name:"trials"},{name:"probability_s"},{name:"alpha"}]},{name:"TEXTBEFORE",description:"Returns text before a specified delimiter",args:[{name:"text"},{name:"delimiter"},{name:"instance_num",optional:!0}]},{name:"TEXTAFTER",description:"Returns text after a specified delimiter",args:[{name:"text"},{name:"delimiter"},{name:"instance_num",optional:!0}]},{name:"VALUETOTEXT",description:"Converts a value to text",args:[{name:"value"},{name:"format",optional:!0}]},{name:"SEQUENCE",description:"Generates a sequence of numbers",args:[{name:"rows"},{name:"columns",optional:!0},{name:"start",optional:!0},{name:"step",optional:!0}]},{name:"RANDARRAY",description:"Generates an array of random numbers",args:[{name:"rows",optional:!0},{name:"columns",optional:!0},{name:"min",optional:!0},{name:"max",optional:!0},{name:"whole_number",optional:!0}]},{name:"SORT",description:"Sorts a range of data",args:[{name:"range"},{name:"sort_index",optional:!0},{name:"sort_order",optional:!0}]},{name:"UNIQUE",description:"Returns unique values from a range",args:[{name:"range"}]},{name:"FLATTEN",description:"Flattens a range into a single column",args:[{name:"range"}]},{name:"TRANSPOSE",description:"Transposes the rows and columns of a range",args:[{name:"range"}]},{name:"NORM.S.DIST",description:"Returns the standard normal distribution probability",args:[{name:"z"},{name:"cumulative"}]},{name:"NORM.S.INV",description:"Returns the inverse of the standard normal distribution",args:[{name:"probability"}]},{name:"SUBTOTAL",description:"Returns a subtotal using a specified aggregate function",args:[{name:"function_num"},{name:"ref1"},{name:"ref2",optional:!0,repeating:!0}]},{name:"VARA",description:"Returns the sample variance including text and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"VARPA",description:"Returns the population variance including text and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"SKEW",description:"Returns the skewness of a dataset",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"KURT",description:"Returns the excess kurtosis of a dataset",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"ISREF",description:"Returns TRUE if the value is a reference",args:[{name:"value"}]},{name:"SHEET",description:"Returns the sheet number of a reference",args:[{name:"value",optional:!0}]},{name:"SHEETS",description:"Returns the number of sheets in a reference",args:[{name:"reference",optional:!0}]},{name:"MDETERM",description:"Returns the determinant of a square matrix",args:[{name:"square_matrix"}]},{name:"PROB",description:"Returns the probability of values in a range between two limits",args:[{name:"x_range"},{name:"prob_range"},{name:"lower_limit"},{name:"upper_limit",optional:!0}]},{name:"CONVERT",description:"Converts a number from one measurement unit to another",args:[{name:"number"},{name:"from_unit"},{name:"to_unit"}]},{name:"BITAND",description:"Returns the bitwise AND of two numbers",args:[{name:"number1"},{name:"number2"}]},{name:"BITOR",description:"Returns the bitwise OR of two numbers",args:[{name:"number1"},{name:"number2"}]},{name:"BITXOR",description:"Returns the bitwise XOR of two numbers",args:[{name:"number1"},{name:"number2"}]},{name:"BITLSHIFT",description:"Shifts a number left by a specified number of bits",args:[{name:"number"},{name:"shift_amount"}]},{name:"BITRSHIFT",description:"Shifts a number right by a specified number of bits",args:[{name:"number"},{name:"shift_amount"}]},{name:"HEX2DEC",description:"Converts a hexadecimal number to decimal",args:[{name:"hex_string"}]},{name:"DEC2HEX",description:"Converts a decimal number to hexadecimal",args:[{name:"number"},{name:"places",optional:!0}]},{name:"BIN2DEC",description:"Converts a binary number to decimal",args:[{name:"bin_string"}]},{name:"DEC2BIN",description:"Converts a decimal number to binary",args:[{name:"number"},{name:"places",optional:!0}]},{name:"OCT2DEC",description:"Converts an octal number to decimal",args:[{name:"oct_string"}]},{name:"DEC2OCT",description:"Converts a decimal number to octal",args:[{name:"number"},{name:"places",optional:!0}]},{name:"COMPLEX",description:"Creates a complex number from real and imaginary parts",args:[{name:"real"},{name:"imaginary"},{name:"suffix",optional:!0}]},{name:"IMREAL",description:"Returns the real part of a complex number",args:[{name:"complex_number"}]},{name:"IMAGINARY",description:"Returns the imaginary part of a complex number",args:[{name:"complex_number"}]},{name:"IMABS",description:"Returns the absolute value (modulus) of a complex number",args:[{name:"complex_number"}]},{name:"IMSUM",description:"Returns the sum of complex numbers",args:[{name:"complex1"},{name:"complex2",optional:!0,repeating:!0}]},{name:"IMSUB",description:"Returns the difference of two complex numbers",args:[{name:"complex1"},{name:"complex2"}]},{name:"IMPRODUCT",description:"Returns the product of complex numbers",args:[{name:"complex1"},{name:"complex2",optional:!0,repeating:!0}]},{name:"IMDIV",description:"Returns the quotient of two complex numbers",args:[{name:"complex1"},{name:"complex2"}]},{name:"IMCONJUGATE",description:"Returns the complex conjugate of a complex number",args:[{name:"complex_number"}]},{name:"IMARGUMENT",description:"Returns the argument (angle) of a complex number in radians",args:[{name:"complex_number"}]},{name:"IMPOWER",description:"Returns a complex number raised to a power",args:[{name:"complex_number"},{name:"power"}]},{name:"IMSQRT",description:"Returns the square root of a complex number",args:[{name:"complex_number"}]},{name:"IMEXP",description:"Returns e raised to a complex power",args:[{name:"complex_number"}]},{name:"IMLN",description:"Returns the natural logarithm of a complex number",args:[{name:"complex_number"}]},{name:"IMLOG2",description:"Returns the base-2 logarithm of a complex number",args:[{name:"complex_number"}]},{name:"IMLOG10",description:"Returns the base-10 logarithm of a complex number",args:[{name:"complex_number"}]},{name:"IMSIN",description:"Returns the sine of a complex number",args:[{name:"complex_number"}]},{name:"IMCOS",description:"Returns the cosine of a complex number",args:[{name:"complex_number"}]},{name:"IMTAN",description:"Returns the tangent of a complex number",args:[{name:"complex_number"}]},{name:"IMSINH",description:"Returns the hyperbolic sine of a complex number",args:[{name:"complex_number"}]},{name:"IMCOSH",description:"Returns the hyperbolic cosine of a complex number",args:[{name:"complex_number"}]},{name:"IMSEC",description:"Returns the secant of a complex number",args:[{name:"complex_number"}]},{name:"IMCSC",description:"Returns the cosecant of a complex number",args:[{name:"complex_number"}]},{name:"IMCOT",description:"Returns the cotangent of a complex number",args:[{name:"complex_number"}]},{name:"HEX2BIN",description:"Converts a hexadecimal number to binary",args:[{name:"hex_string"},{name:"places",optional:!0}]},{name:"HEX2OCT",description:"Converts a hexadecimal number to octal",args:[{name:"hex_string"},{name:"places",optional:!0}]},{name:"BIN2HEX",description:"Converts a binary number to hexadecimal",args:[{name:"bin_string"},{name:"places",optional:!0}]},{name:"BIN2OCT",description:"Converts a binary number to octal",args:[{name:"bin_string"},{name:"places",optional:!0}]},{name:"OCT2HEX",description:"Converts an octal number to hexadecimal",args:[{name:"oct_string"},{name:"places",optional:!0}]},{name:"OCT2BIN",description:"Converts an octal number to binary",args:[{name:"oct_string"},{name:"places",optional:!0}]},{name:"BESSELJ",description:"Returns the Bessel function of the first kind Jn(x)",args:[{name:"x"},{name:"n"}]},{name:"BESSELY",description:"Returns the Bessel function of the second kind Yn(x)",args:[{name:"x"},{name:"n"}]}],iu={Date:new Set(["TODAY","NOW","DATE","TIME","DAYS","YEAR","MONTH","DAY","HOUR","MINUTE","SECOND","WEEKDAY","EDATE","EOMONTH","NETWORKDAYS","DATEVALUE","TIMEVALUE","DATEDIF","WEEKNUM","ISOWEEKNUM","WORKDAY","YEARFRAC"]),Engineering:new Set(["DELTA","GESTEP","ERF","ERFC","CONVERT","BITAND","BITOR","BITXOR","BITLSHIFT","BITRSHIFT","HEX2DEC","DEC2HEX","BIN2DEC","DEC2BIN","OCT2DEC","DEC2OCT","COMPLEX","IMREAL","IMAGINARY","IMABS","IMSUM","IMSUB","IMPRODUCT","IMDIV","IMCONJUGATE","IMARGUMENT","IMPOWER","IMSQRT","IMEXP","IMLN","IMLOG2","IMLOG10","IMSIN","IMCOS","IMTAN","IMSINH","IMCOSH","IMSEC","IMCSC","IMCOT","HEX2BIN","HEX2OCT","BIN2HEX","BIN2OCT","OCT2HEX","OCT2BIN","BESSELJ","BESSELY"]),Financial:new Set(["PMT","FV","PV","NPV","NPER","IPMT","PPMT","SLN","EFFECT","RATE","IRR","DB","DDB","NOMINAL","CUMIPMT","CUMPRINC","XNPV","XIRR","SYD","MIRR","TBILLEQ","TBILLPRICE","TBILLYIELD","DOLLARDE","DOLLARFR"]),Info:new Set(["ISBLANK","ISNUMBER","ISTEXT","ISERROR","ISERR","ISNA","ISLOGICAL","ISNONTEXT","ISURL","ISFORMULA","FORMULATEXT","ISREF","SHEET","SHEETS","N","TYPE","NA","ERROR.TYPE","ISDATE"]),Logical:new Set(["IF","IFS","SWITCH","AND","OR","NOT","IFERROR","IFNA","XOR","CHOOSE"]),Lookup:new Set(["MATCH","INDEX","VLOOKUP","HLOOKUP","ROW","COLUMN","ROWS","COLUMNS","ADDRESS","HYPERLINK","LOOKUP","INDIRECT","XLOOKUP","OFFSET","SORT","UNIQUE","FLATTEN","TRANSPOSE"]),Math:new Set(["SUM","ABS","ROUND","ROUNDUP","ROUNDDOWN","INT","MOD","SQRT","POWER","PRODUCT","RAND","RANDBETWEEN","COUNTBLANK","COUNTIF","SUMIF","COUNTIFS","SUMIFS","PI","SIGN","EVEN","ODD","EXP","LN","LOG","SIN","COS","TAN","ASIN","ACOS","ATAN","ATAN2","DEGREES","RADIANS","CEILING","FLOOR","TRUNC","MROUND","SUMPRODUCT","GCD","LCM","COMBIN","FACT","QUOTIENT","SUMSQ","ISEVEN","ISODD","FACTDOUBLE","BASE","DECIMAL","SQRTPI","SINH","COSH","TANH","ASINH","ACOSH","ATANH","COT","CSC","SEC","ARABIC","ROMAN","MULTINOMIAL","SERIESSUM","CEILING.MATH","FLOOR.MATH","CEILING.PRECISE","FLOOR.PRECISE","SUMX2MY2","SUMX2PY2","SUMXMY2","SEQUENCE","RANDARRAY","SUBTOTAL","MDETERM"]),Statistical:new Set(["AVERAGE","MIN","MAX","COUNT","COUNTA","MEDIAN","AVERAGEIF","AVERAGEIFS","LARGE","SMALL","MINIFS","MAXIFS","RANK","PERCENTILE","STDEV","STDEVP","VAR","VARP","MODE","QUARTILE","COUNTUNIQUE","FORECAST","SLOPE","INTERCEPT","CORREL","GEOMEAN","HARMEAN","AVEDEV","DEVSQ","TRIMMEAN","PERMUT","AVERAGEA","MINA","MAXA","FISHER","FISHERINV","GAMMA","GAMMALN","NORMDIST","NORMINV","LOGNORMAL.DIST","LOGNORMAL.INV","STANDARDIZE","WEIBULL.DIST","POISSON.DIST","BINOM.DIST","EXPON.DIST","CONFIDENCE.NORM","CONFIDENCE.T","CHISQ.DIST","CHISQ.INV","T.DIST","T.INV","HYPGEOM.DIST","NEGBINOM.DIST","COVAR","COVARIANCE.S","RSQ","STEYX","PERCENTILE.EXC","QUARTILE.EXC","RANK.AVG","PERCENTRANK","PERCENTRANK.EXC","BETA.DIST","BETA.INV","F.DIST","F.INV","GAMMA.DIST","GAMMA.INV","CHISQ.DIST.RT","CHISQ.INV.RT","T.DIST.RT","T.DIST.2T","T.INV.2T","F.DIST.RT","F.INV.RT","BINOM.INV","NORM.S.DIST","NORM.S.INV","VARA","VARPA","SKEW","KURT","PROB"]),Text:new Set(["TRIM","LEN","LEFT","RIGHT","MID","CONCATENATE","CONCAT","FIND","SEARCH","TEXTJOIN","LOWER","UPPER","PROPER","SUBSTITUTE","EXACT","REPLACE","REPT","T","VALUE","TEXT","CHAR","CODE","CLEAN","NUMBERVALUE","FIXED","DOLLAR","SPLIT","JOIN","REGEXMATCH","REGEXEXTRACT","REGEXREPLACE","UNICODE","UNICHAR","ENCODEURL","TEXTBEFORE","TEXTAFTER","VALUETOTEXT"])};function fu(u){var s;for(const e of qt)if((s=iu[e])!=null&&s.has(u))return e;throw new Error(`Missing Sheets category for function: ${u}`)}const dt=cu.map(u=>({...u,category:fu(u.name)}));function xu(u=dt){const s=new Set(u.map(e=>e.category));return qt.filter(e=>s.has(e))}function Eu(u){const s=u.toUpperCase();return dt.filter(e=>e.name.startsWith(s))}function Mu(u){const s=u.toUpperCase();return dt.find(e=>e.name===s)}function Ru(u){const s=u.args.map(e=>{let n=e.optional?`[${e.name}]`:e.name;return e.repeating&&(n+=", ..."),n});return`${u.name}(${s.join(", ")})`}export{dt as F,qt as S,gu as a,du as b,Ru as c,hu as d,At as e,Mu as f,Au as g,Nu as i,xu as l,pu as n,Eu as s};
