import{u as V,r as l,j as e}from"./vendor-react-Bg6UneQK.js";import{b as E,c as x,d as k,f,g as H,e as K,h as q,i as A,u as I}from"./vendor-app-HGRjaN7r.js";import{c as L,r as Q,d as z,f as B}from"./documents-BltkGFFU.js";import{i as O}from"./index-Qy4aMP9R.js";import{B as n}from"./button-DWQ-sR7I.js";import{D as $,a as G,b as J,c as U,d as W,e as X}from"./dialog-CFv6VfMI.js";import{D as Y,a as Z,b as _,c as N}from"./dropdown-menu-CQO2mrpo.js";import{I as y}from"./input-BEpJFSyN.js";import{L as ee}from"./label-CmhopHze.js";import{T as te,a as se,b as g,c as ae,d as ie,e as C}from"./table-BcaU83pl.js";import{P as ne,E as le,a as re,b as oe}from"./vendor-ui-DUghwSYy.js";import{f as ce}from"./formatDistanceToNow-DXTjigy3.js";import"./http-error-XKKRT0jQ.js";import"./vendor-yorkie-DqSL832E.js";import"./index-3UDGtr2f.js";import"./utils-DjqsqOe8.js";function de({data:m}){var p,j;const r=E(),o=V(),c=[{accessorKey:"id",header:"ID",enableHiding:!0},{accessorKey:"title",header:"Title",cell:({row:t})=>e.jsx("div",{className:"capitalize",children:t.getValue("title")})},{accessorKey:"createdAt",header:()=>e.jsx("div",{className:"text-right",children:"Created At"}),cell:({row:t})=>{const s=t.getValue("createdAt"),u=ce(new Date(s),{includeSeconds:!0,addSuffix:!0});return e.jsx("div",{className:"text-right font-medium",children:u})}},{id:"actions",enableHiding:!1,cell:({row:t})=>e.jsxs(Y,{children:[e.jsx(Z,{asChild:!0,children:e.jsxs(n,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(le,{})]})}),e.jsxs(_,{align:"end",children:[e.jsxs(N,{onClick:s=>{s.stopPropagation(),d({id:String(t.getValue("id")),title:t.getValue("title")})},children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Rename"]}),e.jsxs(N,{className:"text-red-500 focus:text-red-500",onClick:s=>{s.stopPropagation(),D.mutate(String(t.getValue("id")))},children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}],[a,d]=l.useState(null),w=x({mutationFn:async t=>await L(t),onSuccess:t=>o(`/${t.id}`)}),D=x({mutationFn:async t=>await z(t),onSuccess:()=>r.invalidateQueries({queryKey:["documents"]})}),h=x({mutationFn:async({id:t,title:s})=>await Q(t,s),onSuccess:()=>{r.invalidateQueries({queryKey:["documents"]}),d(null)}}),[b,v]=l.useState([]),[S,R]=l.useState([]),[M,F]=l.useState({id:!1}),[P,T]=l.useState({}),i=k({data:m,columns:c,onSortingChange:v,onColumnFiltersChange:R,getCoreRowModel:A(),getPaginationRowModel:q(),getSortedRowModel:K(),getFilteredRowModel:H(),onColumnVisibilityChange:F,onRowSelectionChange:T,state:{sorting:b,columnFilters:S,columnVisibility:M,rowSelection:P}});return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsx(y,{placeholder:"Filter by title...",value:((p=i.getColumn("title"))==null?void 0:p.getFilterValue())??"",onChange:t=>{var s;return(s=i.getColumn("title"))==null?void 0:s.setFilterValue(t.target.value)},className:"max-w-sm"}),e.jsxs(n,{onClick:()=>{w.mutate({title:"New Document"})},className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"New Document"]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(te,{children:[e.jsx(se,{children:i.getHeaderGroups().map(t=>e.jsx(g,{children:t.headers.map(s=>e.jsx(ae,{children:s.isPlaceholder?null:f(s.column.columnDef.header,s.getContext())},s.id))},t.id))}),e.jsx(ie,{children:(j=i.getRowModel().rows)!=null&&j.length?i.getRowModel().rows.map(t=>e.jsx(g,{"data-state":t.getIsSelected()&&"selected",className:"cursor-pointer hover:bg-muted",onClick:s=>{s.target.closest("input, button")||o(`/${t.getValue("id")}`)},children:t.getVisibleCells().map(s=>e.jsx(C,{children:f(s.column.columnDef.cell,s.getContext())},s.id))},t.id)):e.jsx(g,{children:e.jsx(C,{colSpan:c.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>i.previousPage(),disabled:!i.getCanPreviousPage(),children:"Previous"}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>i.nextPage(),disabled:!i.getCanNextPage(),children:"Next"})]})]}),e.jsx($,{open:a!==null,onOpenChange:t=>{t||d(null)},children:e.jsx(G,{className:"sm:max-w-md",children:e.jsxs("form",{onSubmit:t=>{if(t.preventDefault(),!a)return;const u=new FormData(t.target).get("title");u.trim()&&h.mutate({id:a.id,title:u.trim()})},children:[e.jsxs(J,{children:[e.jsx(U,{children:"Rename Document"}),e.jsx(W,{children:"Enter a new name for this document."})]}),e.jsx("div",{className:"grid gap-4 py-2",children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx(ee,{htmlFor:"rename-title",children:"Title"}),e.jsx(y,{id:"rename-title",name:"title",defaultValue:(a==null?void 0:a.title)??"",autoFocus:!0},a==null?void 0:a.id)]})}),e.jsxs(X,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>d(null),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:h.isPending,children:"Rename"})]})]})})})]})}function Re(){const{data:m=[],isLoading:r,isError:o,error:c}=I({queryKey:["documents"],queryFn:B});return r?e.jsx("div",{className:"flex flex-col items-center justify-center h-64",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"Loading documents..."})}):o?O(c)?null:e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("p",{className:"text-red-500 text-lg",children:"Failed to load documents."}),e.jsx("p",{className:"text-gray-400",children:"Please try again later."})]}):e.jsx("div",{className:"p-4",children:e.jsx(de,{data:m})})}export{Re as default};
