var _e=Object.defineProperty;var Xe=(u,n,r)=>n in u?_e(u,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[n]=r;var Y=(u,n,r)=>Xe(u,typeof n!="symbol"?n+"":n,r);import{a as O,F as k,b as D}from"./sheet-formula-parser-CbheDyXI.js";import{t as F,i as M,a as G,p as W,b as J,c as Z,d as Te,e as Ye}from"./sheet-core-C-km7R37.js";class ${constructor(){Y(this,"ref");Y(this,"bool");Y(this,"num");Y(this,"str")}static create(){return new $}setRef(n){return this.ref=n,this}setBool(n){return this.bool=n,this}setNum(n){return this.num=n,this}setStr(n){return this.str=n,this}map(n,r){return n.t==="bool"&&this.bool?this.bool(n):n.t==="num"&&this.num?this.num(n):n.t==="str"&&this.str?this.str(n):n.t==="ref"&&this.ref&&r?this.ref(n,r):n}*iterate(n,r,a){for(const e of n.expr()){const t=r(e);if(t.t==="ref"&&a)for(const s of F([t.v]))yield this.ref({t:"ref",v:s},a);else yield this.map(t)}}}function Ge(u){return{t:"num",v:u.v?1:0}}function He(u){const n=Number(u);return{t:"num",v:isNaN(n)?0:n}}function Be(u,n){var e;if(M(u.v))return{t:"err",v:"#VALUE!"};const r=((e=n.get(u.v))==null?void 0:e.v)||"",a=Number(r);return{t:"num",v:isNaN(a)?0:a}}const v=$.create().setRef(Be).setBool(Ge).setStr(He);function qe(u){return{t:"bool",v:u.v!==0}}function Ke(u,n){var e;if(M(u.v))return{t:"err",v:"#VALUE!"};const r=((e=n.get(u.v))==null?void 0:e.v)||"";if(r==="TRUE"||r==="true")return{t:"bool",v:!0};if(r==="FALSE"||r==="false"||r==="")return{t:"bool",v:!1};const a=Number(r);return isNaN(a)?{t:"err",v:"#VALUE!"}:{t:"bool",v:a!==0}}const I=$.create().setRef(Ke).setNum(qe).setStr(()=>({t:"err",v:"#VALUE!"}));function We(u){return{t:"str",v:u.v.toString()}}function $e(u){return{t:"str",v:u.v?"TRUE":"FALSE"}}function Le(u,n){var a;return M(u.v)?{t:"err",v:"#VALUE!"}:{t:"str",v:((a=n.get(u.v))==null?void 0:a.v)||""}}$.create().setRef(Le).setNum(We).setBool($e);const me=new Map([["SUM",Qe],["ABS",ze],["ROUND",Je],["ROUNDUP",Ze],["ROUNDDOWN",et],["INT",tt],["MOD",rt],["SQRT",nt],["POWER",st],["PRODUCT",ut],["MEDIAN",ct],["IF",it],["IFS",ft],["SWITCH",mt],["AND",lt],["OR",vt],["NOT",pt],["AVERAGE",gt],["MIN",ht],["MAX",Nt],["COUNT",At],["COUNTA",dt],["COUNTBLANK",Et],["COUNTIF",xt],["SUMIF",Rt],["COUNTIFS",Mt],["SUMIFS",bt],["MATCH",Ft],["INDEX",Tt],["VLOOKUP",Lt],["HLOOKUP",It],["TRIM",St],["LEN",Ut],["LEFT",Ct],["RIGHT",Dt],["MID",Vt],["CONCATENATE",Ue],["CONCAT",Ot],["FIND",yt],["SEARCH",wt],["TEXTJOIN",Pt],["LOWER",kt],["UPPER",_t],["PROPER",Xt],["SUBSTITUTE",Yt],["TODAY",Gt],["NOW",Ht],["DATE",Bt],["TIME",qt],["DAYS",Kt],["YEAR",Wt],["MONTH",$t],["DAY",Qt],["HOUR",zt],["MINUTE",jt],["SECOND",Jt],["WEEKDAY",Zt],["RAND",at],["RANDBETWEEN",ot],["ISBLANK",er],["ISNUMBER",tr],["ISTEXT",rr],["ISERROR",nr],["ISERR",sr],["ISNA",ar],["ISLOGICAL",or],["ISNONTEXT",ur],["IFERROR",cr],["IFNA",ir],["PI",fr],["SIGN",mr],["EVEN",lr],["ODD",vr],["EXP",pr],["LN",gr],["LOG",hr],["SIN",Nr],["COS",Ar],["TAN",dr],["ASIN",Er],["ACOS",xr],["ATAN",Rr],["ATAN2",Mr],["DEGREES",br],["RADIANS",Fr],["CEILING",Tr],["FLOOR",Lr],["TRUNC",Ir],["MROUND",Sr],["EXACT",Ur],["REPLACE",Cr],["REPT",Dr],["T",Vr],["VALUE",Or],["TEXT",yr],["CHAR",wr],["CODE",Pr],["AVERAGEIF",kr],["AVERAGEIFS",_r],["LARGE",Xr],["SMALL",Yr],["N",Gr],["SUMPRODUCT",Hr],["GCD",Br],["LCM",qr],["COMBIN",Kr],["FACT",Wr],["QUOTIENT",$r],["XOR",Qr],["CHOOSE",zr],["TYPE",jr],["EDATE",Jr],["EOMONTH",Zr],["NETWORKDAYS",en],["DATEVALUE",tn],["TIMEVALUE",rn],["DATEDIF",nn],["ROW",sn],["COLUMN",an],["ROWS",on],["COLUMNS",un],["ADDRESS",cn],["HYPERLINK",fn],["MINIFS",mn],["MAXIFS",ln],["RANK",le],["PERCENTILE",ve],["CLEAN",vn],["NUMBERVALUE",pn],["STDEV",pe],["STDEVP",ge],["STDEV.S",pe],["STDEV.P",ge],["VAR",he],["VARP",Ne],["VAR.S",he],["VAR.P",Ne],["MODE",Ae],["MODE.SNGL",Ae],["SUMSQ",gn],["NA",hn],["QUARTILE",de],["QUARTILE.INC",de],["COUNTUNIQUE",Nn],["FIXED",An],["DOLLAR",dn],["WEEKNUM",En],["ISOWEEKNUM",xn],["WORKDAY",Rn],["YEARFRAC",Mn],["LOOKUP",bn],["INDIRECT",Fn],["ERROR.TYPE",Tn],["ISDATE",Ln],["SPLIT",In],["JOIN",Sn],["REGEXMATCH",Un],["FORECAST",Ee],["FORECAST.LINEAR",Ee],["SLOPE",Cn],["INTERCEPT",Dn],["CORREL",Vn],["XLOOKUP",On],["OFFSET",yn],["ISEVEN",wn],["ISODD",Pn],["FACTDOUBLE",kn],["BASE",_n],["DECIMAL",Xn],["SQRTPI",Yn],["SINH",Gn],["COSH",Hn],["TANH",Bn],["ASINH",qn],["ACOSH",Kn],["ATANH",Wn],["COT",$n],["CSC",Qn],["SEC",zn],["REGEXEXTRACT",jn],["REGEXREPLACE",Jn],["UNICODE",Zn],["UNICHAR",es],["GEOMEAN",ts],["HARMEAN",rs],["AVEDEV",ns],["DEVSQ",ss],["TRIMMEAN",as],["PERMUT",os],["PMT",us],["FV",cs],["PV",is],["NPV",fs],["NPER",ms],["IPMT",ls],["PPMT",vs],["SLN",ps],["EFFECT",gs],["RATE",hs],["IRR",Ns],["DB",As],["DDB",ds],["NOMINAL",Es],["CUMIPMT",xs],["CUMPRINC",Rs],["AVERAGEA",Ms],["MINA",bs],["MAXA",Fs],["FISHER",Ts],["FISHERINV",Ls],["GAMMA",Is],["GAMMALN",Ss],["NORMDIST",xe],["NORM.DIST",xe],["NORMINV",Re],["NORM.INV",Re],["LOGNORMAL.DIST",Us],["LOGNORMAL.INV",Cs],["STANDARDIZE",Ds],["WEIBULL.DIST",Vs],["POISSON.DIST",Os],["BINOM.DIST",ys],["EXPON.DIST",ws],["CONFIDENCE.NORM",Ps],["CONFIDENCE.T",Bs],["CHISQ.DIST",ks],["CHISQ.INV",_s],["T.DIST",Xs],["T.INV",Ys],["HYPGEOM.DIST",Gs],["NEGBINOM.DIST",Hs],["ARABIC",qs],["ROMAN",Ks],["MULTINOMIAL",Ws],["SERIESSUM",$s],["DELTA",Qs],["GESTEP",zs],["ERF",js],["ERFC",Js],["XNPV",Zs],["XIRR",ea],["SYD",ta],["MIRR",ra],["TBILLEQ",na],["TBILLPRICE",sa],["TBILLYIELD",aa],["DOLLARDE",oa],["DOLLARFR",ua],["ENCODEURL",ca],["ISURL",ia],["ISFORMULA",fa],["FORMULATEXT",ma],["CEILING.MATH",la],["FLOOR.MATH",va],["CEILING.PRECISE",pa],["FLOOR.PRECISE",ga],["COVAR",Me],["COVARIANCE.P",Me],["COVARIANCE.S",ha],["RSQ",Na],["STEYX",Aa],["SUMX2MY2",da],["SUMX2PY2",Ea],["SUMXMY2",xa],["PERCENTILE.INC",ve],["PERCENTILE.EXC",Ra],["QUARTILE.EXC",Ma],["RANK.AVG",ba],["RANK.EQ",le],["PERCENTRANK",be],["PERCENTRANK.INC",be],["PERCENTRANK.EXC",Fa],["BETA.DIST",Ta],["BETA.INV",La],["F.DIST",Ia],["F.INV",Sa]]);function Qe(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0;for(const t of v.iterate(a,n,r)){if(t.t==="err")return t;e+=t.v}return{t:"num",v:e}}function ze(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.abs(t.v)}}function je(u){return u>=0?Math.floor(u+.5):Math.ceil(u-.5)}function ae(u,n,r){if(!u)return{t:"num",v:0};const a=v.map(n(u),r);return a.t==="err"?a:{t:"num",v:Math.trunc(a.v)}}function L(u){return typeof u=="object"&&u!==null&&u.t==="err"}function E(u,n,r){const a=n(u);return a.t==="err"?a:a.t!=="ref"||!r?{t:"err",v:"#VALUE!"}:{t:"refs",v:Array.from(F([a.v]))}}function ee(u,n,r){const a=n(u);if(a.t==="err")return a;if(a.t!=="ref"||!r)return{t:"err",v:"#VALUE!"};if(!M(a.v))return{t:"matrix",v:{refs:[a.v],rowCount:1,colCount:1}};try{let e=a.v,t="";if(G(a.v)){const{sheetName:i,localRef:f}=W(a.v);e=f,t=`${i}!`}const[s,o]=Z(e),c=[];for(let i=s.r;i<=o.r;i++)for(let f=s.c;f<=o.c;f++)c.push(`${t}${Ye({r:i,c:f})}`);return{t:"matrix",v:{refs:c,rowCount:o.r-s.r+1,colCount:o.c-s.c+1}}}catch{return{t:"err",v:"#VALUE!"}}}function Ie(u){const n=u===""?void 0:Number(u),r=n===void 0||isNaN(n)?void 0:n,a=u.toUpperCase(),e=a==="TRUE"?!0:a==="FALSE"?!1:void 0;return{normalized:u.toLowerCase(),numericValue:r,boolValue:e}}function oe(u,n){const r=A(u,n);return r.t==="err"?r:Ie(r.v)}function _(u,n){var a;const r=((a=n==null?void 0:n.get(u))==null?void 0:a.v)||"";return Ie(r)}function ue(u,n){return u.numericValue!==void 0&&n.numericValue!==void 0?u.numericValue===n.numericValue:u.boolValue!==void 0&&n.boolValue!==void 0?u.boolValue===n.boolValue:u.normalized===n.normalized}function j(u,n){return u.numericValue!==void 0&&n.numericValue!==void 0?u.numericValue-n.numericValue:u.boolValue!==void 0&&n.boolValue!==void 0?Number(u.boolValue)-Number(n.boolValue):u.normalized.localeCompare(n.normalized)}function Se(u){const n=Number(u);return isNaN(n)?0:n}function w(u,n){if(u.t==="err")return u;if(u.t==="num")return{op:"=",value:u.v.toString(),numericValue:u.v};if(u.t==="bool")return{op:"=",value:u.v?"TRUE":"FALSE",boolValue:u.v};const r=A(u,n);if(r.t==="err")return r;const a=/^(<=|>=|<>|=|<|>)(.*)$/.exec(r.v),e=(a==null?void 0:a[1])||"=",t=a?a[2]:r.v;let s,o;if(t!==""){const i=Number(t);isNaN(i)?t.toUpperCase()==="TRUE"?o=!0:t.toUpperCase()==="FALSE"&&(o=!1):s=i}let c;return(e==="="||e==="<>")&&/(^|[^~])[*?]/.test(t)&&(c=new RegExp(`^${De(t)}$`,"i")),{op:e,value:t,numericValue:s,boolValue:o,wildcardPattern:c}}function P(u,n){const r=u===""?void 0:Number(u),a=r!==void 0&&!isNaN(r),e=u.toUpperCase(),t=e==="TRUE"?!0:e==="FALSE"?!1:void 0,s=u.toLowerCase(),o=n.value.toLowerCase();if(n.op==="<"||n.op==="<="||n.op===">"||n.op===">=")return n.numericValue!==void 0?a?n.op==="<"?r<n.numericValue:n.op==="<="?r<=n.numericValue:n.op===">"?r>n.numericValue:r>=n.numericValue:!1:n.op==="<"?s<o:n.op==="<="?s<=o:n.op===">"?s>o:s>=o;let c=!1;return n.wildcardPattern?c=n.wildcardPattern.test(u):n.numericValue!==void 0&&a?c=r===n.numericValue:n.boolValue!==void 0&&t!==void 0?c=t===n.boolValue:c=s===o,n.op==="="?c:!c}function Je(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=ae(e[1],n,r);if(s.t==="err")return s;const o=10**s.v;return{t:"num",v:je(t.v*o)/o}}function Ze(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=ae(e[1],n,r);if(s.t==="err")return s;const o=10**s.v,c=t.v*o;return{t:"num",v:(c>=0?Math.ceil(c):Math.floor(c))/o}}function et(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=ae(e[1],n,r);if(s.t==="err")return s;const o=10**s.v,c=t.v*o;return{t:"num",v:(c>=0?Math.floor(c):Math.ceil(c))/o}}function tt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.floor(t.v)}}function rt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);return s.t==="err"?s:s.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:t.v-s.v*Math.floor(t.v/s.v)}}function nt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.sqrt(t.v)}}function st(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.pow(t.v,s.v);return isFinite(o)?{t:"num",v:o}:{t:"err",v:"#VALUE!"}}function at(u,n,r){const a=u.args();return a&&a.expr().length>0?{t:"err",v:"#N/A!"}:{t:"num",v:Math.random()}}function ot(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.ceil(t.v),c=Math.floor(s.v);return o>c?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.floor(Math.random()*(c-o+1))+o}}function ut(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=1;for(const t of v.iterate(a,n,r)){if(t.t==="err")return t;e*=t.v}return{t:"num",v:e}}function ct(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const s of v.iterate(a,n,r)){if(s.t==="err")return s;e.push(s.v)}if(e.length===0)return{t:"err",v:"#VALUE!"};e.sort((s,o)=>s-o);const t=Math.floor(e.length/2);return e.length%2===1?{t:"num",v:e[t]}:{t:"num",v:(e[t-1]+e[t])/2}}function it(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=I.map(n(e[0]),r);return t.t==="err"?t:t.v?n(e[1]):e.length===3?n(e[2]):{t:"bool",v:!1}}function ft(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length%2!==0)return{t:"err",v:"#N/A!"};for(let t=0;t<e.length;t+=2){const s=I.map(n(e[t]),r);if(s.t==="err")return s;if(s.v)return n(e[t+1])}return{t:"err",v:"#N/A!"}}function mt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=e.length-1,o=s%2===1,c=o?(s-1)/2:s/2;for(let i=0;i<c;i++){const f=A(n(e[1+i*2]),r);if(f.t==="err")return f;if(f.v===t.v)return n(e[2+i*2])}return o?n(e[e.length-1]):{t:"err",v:"#N/A!"}}function lt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};for(const e of I.iterate(a,n,r)){if(e.t==="err")return e;if(!e.v)return{t:"bool",v:!1}}return{t:"bool",v:!0}}function vt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};for(const e of I.iterate(a,n,r)){if(e.t==="err")return e;if(e.v)return{t:"bool",v:!0}}return{t:"bool",v:!1}}function pt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=I.map(n(e[0]),r);return t.t==="err"?t:{t:"bool",v:!t.v}}function gt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0,t=0;for(const s of v.iterate(a,n,r)){if(s.t==="err")return s;e+=s.v,t++}return t===0?{t:"err",v:"#VALUE!"}:{t:"num",v:e/t}}function ht(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=1/0;for(const t of v.iterate(a,n,r)){if(t.t==="err")return t;t.v<e&&(e=t.v)}return{t:"num",v:e}}function Nt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=-1/0;for(const t of v.iterate(a,n,r)){if(t.t==="err")return t;t.v>e&&(e=t.v)}return{t:"num",v:e}}function At(u,n,r){var t,s;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0;for(const o of a.expr()){const c=n(o);if(c.t==="num")e++;else if(c.t==="bool")e++;else if(c.t==="ref"&&r)if(M(c.v))for(const i of F([c.v])){const f=((t=r.get(i))==null?void 0:t.v)||"";f!==""&&!isNaN(Number(f))&&e++}else{const i=((s=r.get(c.v))==null?void 0:s.v)||"";i!==""&&!isNaN(Number(i))&&e++}}return{t:"num",v:e}}function dt(u,n,r){var t,s;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0;for(const o of a.expr()){const c=n(o);if(c.t==="num"||c.t==="bool")e++;else if(c.t==="str")c.v!==""&&e++;else if(c.t==="ref"&&r)if(M(c.v))for(const i of F([c.v]))(((t=r.get(i))==null?void 0:t.v)||"")!==""&&e++;else(((s=r.get(c.v))==null?void 0:s.v)||"")!==""&&e++}return{t:"num",v:e}}function Et(u,n,r){var t,s;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0;for(const o of a.expr()){const c=n(o);if(c.t==="str"){c.v===""&&e++;continue}if(c.t!=="ref"||!r)continue;if(M(c.v)){for(const f of F([c.v]))(((t=r.get(f))==null?void 0:t.v)||"")===""&&e++;continue}(((s=r.get(c.v))==null?void 0:s.v)||"")===""&&e++}return{t:"num",v:e}}function xt(u,n,r){var c;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=E(e[0],n,r);if(t.t==="err")return t;const s=w(n(e[1]),r);if(L(s))return s;let o=0;for(const i of t.v){const f=((c=r==null?void 0:r.get(i))==null?void 0:c.v)||"";P(f,s)&&o++}return{t:"num",v:o}}function Rt(u,n,r){var i,f;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=E(e[0],n,r);if(t.t==="err")return t;const s=w(n(e[1]),r);if(L(s))return s;const o=e.length===3?E(e[2],n,r):t;if(o.t==="err")return o;if(t.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};let c=0;for(let m=0;m<t.v.length;m++){const l=((i=r==null?void 0:r.get(t.v[m]))==null?void 0:i.v)||"";if(!P(l,s))continue;const p=((f=r==null?void 0:r.get(o.v[m]))==null?void 0:f.v)||"";c+=Se(p)}return{t:"num",v:c}}function Mt(u,n,r){var i;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length%2!==0)return{t:"err",v:"#N/A!"};const t=[],s=[];for(let f=0;f<e.length;f+=2){const m=E(e[f],n,r);if(m.t==="err")return m;t.push(m.v);const l=w(n(e[f+1]),r);if(L(l))return l;s.push(l)}const o=t[0].length;if(t.some(f=>f.length!==o))return{t:"err",v:"#VALUE!"};let c=0;for(let f=0;f<o;f++){let m=!0;for(let l=0;l<t.length;l++){const p=((i=r==null?void 0:r.get(t[l][f]))==null?void 0:i.v)||"";if(!P(p,s[l])){m=!1;break}}m&&c++}return{t:"num",v:c}}function bt(u,n,r){var i,f;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||(e.length-1)%2!==0)return{t:"err",v:"#N/A!"};const t=E(e[0],n,r);if(t.t==="err")return t;const s=[],o=[];for(let m=1;m<e.length;m+=2){const l=E(e[m],n,r);if(l.t==="err")return l;s.push(l.v);const p=w(n(e[m+1]),r);if(L(p))return p;o.push(p)}if(s.some(m=>m.length!==t.v.length))return{t:"err",v:"#VALUE!"};let c=0;for(let m=0;m<t.v.length;m++){let l=!0;for(let p=0;p<s.length;p++){const g=((i=r==null?void 0:r.get(s[p][m]))==null?void 0:i.v)||"";if(!P(g,o[p])){l=!1;break}}l&&(c+=Se(((f=r==null?void 0:r.get(t.v[m]))==null?void 0:f.v)||""))}return{t:"num",v:c}}function Ft(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=oe(n(e[0]),r);if(L(t))return t;const s=ee(e[1],n,r);if(s.t==="err")return s;if(s.v.rowCount>1&&s.v.colCount>1)return{t:"err",v:"#N/A!"};let o=1;if(e.length===3){const i=v.map(n(e[2]),r);if(i.t==="err")return i;o=Math.trunc(i.v)}if(o!==-1&&o!==0&&o!==1)return{t:"err",v:"#N/A!"};if(o===0){for(let i=0;i<s.v.refs.length;i++){const f=_(s.v.refs[i],r);if(ue(f,t))return{t:"num",v:i+1}}return{t:"err",v:"#N/A!"}}let c=-1;if(o===1){let i=-1/0;for(let f=0;f<s.v.refs.length;f++){const m=_(s.v.refs[f],r),l=j(m,t);l<=0&&l>i&&(i=l,c=f)}}else{let i=1/0;for(let f=0;f<s.v.refs.length;f++){const m=_(s.v.refs[f],r),l=j(m,t);l>=0&&l<i&&(i=l,c=f)}}return c<0?{t:"err",v:"#N/A!"}:{t:"num",v:c+1}}function Tt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>3)return{t:"err",v:"#N/A!"};const t=ee(e[0],n,r);if(t.t==="err")return t;let s=1,o=1;if(e.length>=2){const c=v.map(n(e[1]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);e.length===2&&t.v.rowCount===1&&t.v.colCount>1?o=i:s=i}if(e.length===3){const c=v.map(n(e[2]),r);if(c.t==="err")return c;o=Math.trunc(c.v)}return s<=0||o<=0?{t:"err",v:"#VALUE!"}:s>t.v.rowCount||o>t.v.colCount?{t:"err",v:"#REF!"}:{t:"ref",v:t.v.refs[(s-1)*t.v.colCount+(o-1)]}}function Lt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>4)return{t:"err",v:"#N/A!"};const t=oe(n(e[0]),r);if(L(t))return t;const s=ee(e[1],n,r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<=0)return{t:"err",v:"#VALUE!"};if(c>s.v.colCount)return{t:"err",v:"#REF!"};let i=!0;if(e.length===4){const l=I.map(n(e[3]),r);if(l.t==="err")return l;i=l.v}if(!i){for(let l=0;l<s.v.rowCount;l++){const p=s.v.refs[l*s.v.colCount],g=_(p,r);if(ue(g,t))return{t:"ref",v:s.v.refs[l*s.v.colCount+(c-1)]}}return{t:"err",v:"#N/A!"}}let f=-1,m=-1/0;for(let l=0;l<s.v.rowCount;l++){const p=s.v.refs[l*s.v.colCount],g=_(p,r),h=j(g,t);h<=0&&h>m&&(m=h,f=l)}return f<0?{t:"err",v:"#N/A!"}:{t:"ref",v:s.v.refs[f*s.v.colCount+(c-1)]}}function It(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>4)return{t:"err",v:"#N/A!"};const t=oe(n(e[0]),r);if(L(t))return t;const s=ee(e[1],n,r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<=0)return{t:"err",v:"#VALUE!"};if(c>s.v.rowCount)return{t:"err",v:"#REF!"};let i=!0;if(e.length===4){const l=I.map(n(e[3]),r);if(l.t==="err")return l;i=l.v}if(!i){for(let l=0;l<s.v.colCount;l++){const p=s.v.refs[l],g=_(p,r);if(ue(g,t))return{t:"ref",v:s.v.refs[(c-1)*s.v.colCount+l]}}return{t:"err",v:"#N/A!"}}let f=-1,m=-1/0;for(let l=0;l<s.v.colCount;l++){const p=s.v.refs[l],g=_(p,r),h=j(g,t);h<=0&&h>m&&(m=h,f=l)}return f<0?{t:"err",v:"#N/A!"}:{t:"ref",v:s.v.refs[(c-1)*s.v.colCount+f]}}function A(u,n){return u.t==="err"||u.t==="str"?u:u.t==="num"?{t:"str",v:u.v.toString()}:u.t==="bool"?{t:"str",v:u.v?"TRUE":"FALSE"}:u.t==="ref"&&n?Le(u,n):{t:"err",v:"#VALUE!"}}function St(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);return t.t==="err"?t:{t:"str",v:t.v.trim()}}function Ut(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);return t.t==="err"?t:{t:"num",v:t.v.length}}function Ct(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;let s=1;if(e.length===2){const o=v.map(n(e[1]),r);if(o.t==="err")return o;s=o.v}return{t:"str",v:t.v.slice(0,s)}}function Dt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;let s=1;if(e.length===2){const o=v.map(n(e[1]),r);if(o.t==="err")return o;s=o.v}return{t:"str",v:t.v.slice(-s)}}function Vt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=s.v-1;return{t:"str",v:t.v.slice(c,c+o.v)}}function Ue(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2)return{t:"err",v:"#N/A!"};let t="";for(const s of e){const o=A(n(s),r);if(o.t==="err")return o;t+=o.v}return{t:"str",v:t}}function Ot(u,n,r){return Ue(u,n,r)}function Ce(u,n,r,a){if(!u)return{t:"num",v:1};const e=v.map(r(u),a);if(e.t==="err")return e;const t=Math.trunc(e.v);return t<1||t>n.length+1?{t:"err",v:"#VALUE!"}:{t:"num",v:t}}function yt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=A(n(e[1]),r);if(s.t==="err")return s;const o=Ce(e[2],s.v,n,r);if(o.t==="err")return o;if(t.v==="")return{t:"num",v:o.v};const c=s.v.indexOf(t.v,o.v-1);return c<0?{t:"err",v:"#VALUE!"}:{t:"num",v:c+1}}function De(u){let n="";for(let r=0;r<u.length;r++){const a=u[r];if(a==="~"&&r+1<u.length){n+=u[r+1].replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r++;continue}if(a==="*"){n+=".*";continue}if(a==="?"){n+=".";continue}n+=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}return n}function wt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=A(n(e[1]),r);if(s.t==="err")return s;const o=Ce(e[2],s.v,n,r);if(o.t==="err")return o;if(t.v==="")return{t:"num",v:o.v};const c=De(t.v),i=new RegExp(c,"i"),f=s.v.slice(o.v-1),m=i.exec(f);return!m||m.index===void 0?{t:"err",v:"#VALUE!"}:{t:"num",v:o.v+m.index}}function Pt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=I.map(n(e[1]),r);if(s.t==="err")return s;const o=[];for(const c of e.slice(2)){const i=n(c);if(i.t==="ref"&&r&&M(i.v)){for(const m of F([i.v])){const l=A({t:"ref",v:m},r);if(l.t==="err")return l;s.v&&l.v===""||o.push(l.v)}continue}const f=A(i,r);if(f.t==="err")return f;s.v&&f.v===""||o.push(f.v)}return{t:"str",v:o.join(t.v)}}function kt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);return t.t==="err"?t:{t:"str",v:t.v.toLowerCase()}}function _t(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);return t.t==="err"?t:{t:"str",v:t.v.toUpperCase()}}function Xt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);return t.t==="err"?t:{t:"str",v:t.v.toLowerCase().replace(/\b([a-z])([a-z]*)/g,(o,c,i)=>c.toUpperCase()+i)}}function Yt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>4)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=A(n(e[1]),r);if(s.t==="err")return s;const o=A(n(e[2]),r);if(o.t==="err")return o;if(s.v==="")return{t:"str",v:t.v};if(e.length===3)return{t:"str",v:t.v.split(s.v).join(o.v)};const c=v.map(n(e[3]),r);if(c.t==="err")return c;const i=Math.trunc(c.v);if(i<=0)return{t:"err",v:"#VALUE!"};let f=0,m=0;for(;;){const l=t.v.indexOf(s.v,f);if(l<0)return{t:"str",v:t.v};if(m++,m===i)return{t:"str",v:t.v.slice(0,l)+o.v+t.v.slice(l+s.v.length)};f=l+s.v.length}}function y(u){const n=u.getFullYear(),r=String(u.getMonth()+1).padStart(2,"0"),a=String(u.getDate()).padStart(2,"0");return`${n}-${r}-${a}`}function Ve(u){const n=String(u.getHours()).padStart(2,"0"),r=String(u.getMinutes()).padStart(2,"0"),a=String(u.getSeconds()).padStart(2,"0");return`${n}:${r}:${a}`}function Gt(u,n,r){const a=u.args();return a&&a.expr().length>0?{t:"err",v:"#N/A!"}:{t:"str",v:y(new Date)}}function Ht(u,n,r){const a=u.args();if(a&&a.expr().length>0)return{t:"err",v:"#N/A!"};const e=new Date;return{t:"str",v:`${y(e)} ${Ve(e)}`}}function T(u,n){const r=A(u,n);if(r.t==="err")return r;const a=new Date(r.v);return isNaN(a.getTime())?{t:"err",v:"#VALUE!"}:a}function te(u,n){const r=A(u,n);if(r.t==="err")return r;const a=/^(\d{1,2}):(\d{1,2})(?::(\d{1,2}))?$/.exec(r.v.trim());if(a){const t=Number(a[1]),s=Number(a[2]),o=Number(a[3]||"0");return t<0||t>23||s<0||s>59||o<0||o>59?{t:"err",v:"#VALUE!"}:new Date(1970,0,1,t,s,o)}const e=new Date(r.v);return isNaN(e.getTime())?{t:"err",v:"#VALUE!"}:e}function Bt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=Math.trunc(t.v),i=Math.trunc(s.v),f=Math.trunc(o.v);return!isFinite(c)||!isFinite(i)||!isFinite(f)?{t:"err",v:"#VALUE!"}:{t:"str",v:y(new Date(c,i-1,f))}}function qt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=Math.trunc(t.v),i=Math.trunc(s.v),f=Math.trunc(o.v);return!isFinite(c)||!isFinite(i)||!isFinite(f)?{t:"err",v:"#VALUE!"}:{t:"str",v:Ve(new Date(1970,0,1,c,i,f))}}function Kt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;const s=T(n(e[1]),r);if(!(s instanceof Date))return s;const o=24*60*60*1e3,c=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),i=Date.UTC(s.getFullYear(),s.getMonth(),s.getDate());return{t:"num",v:(c-i)/o}}function Wt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);return t instanceof Date?{t:"num",v:t.getFullYear()}:t}function $t(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);return t instanceof Date?{t:"num",v:t.getMonth()+1}:t}function Qt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);return t instanceof Date?{t:"num",v:t.getDate()}:t}function zt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=te(n(e[0]),r);return t instanceof Date?{t:"num",v:t.getHours()}:t}function jt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=te(n(e[0]),r);return t instanceof Date?{t:"num",v:t.getMinutes()}:t}function Jt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=te(n(e[0]),r);return t instanceof Date?{t:"num",v:t.getSeconds()}:t}function Zt(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;let s=1;if(e.length===2){const c=v.map(n(e[1]),r);if(c.t==="err")return c;s=Math.trunc(c.v)}const o=t.getDay();return s===1?{t:"num",v:o+1}:s===2?{t:"num",v:o===0?7:o}:s===3?{t:"num",v:o===0?6:o-1}:{t:"err",v:"#VALUE!"}}function er(u,n,r){var o;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);return t.t==="err"?t:t.t!=="ref"||!r?{t:"bool",v:!1}:M(t.v)?{t:"err",v:"#VALUE!"}:{t:"bool",v:(((o=r.get(t.v))==null?void 0:o.v)||"")===""}}function tr(u,n,r){var i;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;if(t.t==="num")return{t:"bool",v:!0};if(t.t!=="ref"||!r)return{t:"bool",v:!1};if(M(t.v))return{t:"err",v:"#VALUE!"};const s=((i=r.get(t.v))==null?void 0:i.v)||"",o=s.toUpperCase();return{t:"bool",v:s!==""&&!(o==="TRUE"||o==="FALSE")&&!isNaN(Number(s))}}function rr(u,n,r){var f;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;if(t.t==="str")return{t:"bool",v:!0};if(t.t!=="ref"||!r)return{t:"bool",v:!1};if(M(t.v))return{t:"err",v:"#VALUE!"};const s=((f=r.get(t.v))==null?void 0:f.v)||"";if(s==="")return{t:"bool",v:!1};const o=s.toUpperCase(),c=o==="TRUE"||o==="FALSE",i=!isNaN(Number(s));return{t:"bool",v:!c&&!i}}function nr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();return e.length!==1?{t:"err",v:"#N/A!"}:{t:"bool",v:n(e[0]).t==="err"}}function sr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);return{t:"bool",v:t.t==="err"&&t.v!=="#N/A!"}}function ar(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);return{t:"bool",v:t.t==="err"&&t.v==="#N/A!"}}function or(u,n,r){var c;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;if(t.t==="bool")return{t:"bool",v:!0};if(t.t!=="ref"||!r)return{t:"bool",v:!1};if(M(t.v))return{t:"err",v:"#VALUE!"};const o=(((c=r.get(t.v))==null?void 0:c.v)||"").toUpperCase();return{t:"bool",v:o==="TRUE"||o==="FALSE"}}function ur(u,n,r){var f;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return{t:"bool",v:!0};if(t.t==="str")return{t:"bool",v:!1};if(t.t==="num"||t.t==="bool")return{t:"bool",v:!0};if(t.t!=="ref"||!r)return{t:"bool",v:!1};if(M(t.v))return{t:"err",v:"#VALUE!"};const s=((f=r.get(t.v))==null?void 0:f.v)||"";if(s==="")return{t:"bool",v:!0};const o=s.toUpperCase(),c=o==="TRUE"||o==="FALSE",i=!isNaN(Number(s));return{t:"bool",v:c||i}}function cr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=n(e[0]);return t.t==="err"?n(e[1]):t}function ir(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=n(e[0]);return t.t==="err"&&t.v==="#N/A!"?n(e[1]):t}function fr(u,n,r){const a=u.args();return a&&a.expr().length>0?{t:"err",v:"#N/A!"}:{t:"num",v:Math.PI}}function mr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.sign(t.v)}}function lr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=t.v;if(s===0)return{t:"num",v:0};const o=s>0?Math.ceil(s):Math.floor(s);return{t:"num",v:o%2===0?o:s>0?o+1:o-1}}function vr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=t.v;if(s===0)return{t:"num",v:1};const o=s>0?Math.ceil(s):Math.floor(s);return{t:"num",v:Math.abs(o)%2===1?o:s>0?o+1:o-1}}function pr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.exp(t.v)}}function gr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.log(t.v)}}function hr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;if(t.v<=0)return{t:"err",v:"#VALUE!"};let s=10;if(e.length===2){const o=v.map(n(e[1]),r);if(o.t==="err")return o;if(o.v<=0||o.v===1)return{t:"err",v:"#VALUE!"};s=o.v}return{t:"num",v:Math.log(t.v)/Math.log(s)}}function Nr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.sin(t.v)}}function Ar(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.cos(t.v)}}function dr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.tan(t.v)}}function Er(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<-1||t.v>1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.asin(t.v)}}function xr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<-1||t.v>1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.acos(t.v)}}function Rr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.atan(t.v)}}function Mr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);return s.t==="err"?s:t.v===0&&s.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.atan2(s.v,t.v)}}function br(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:t.v*180/Math.PI}}function Fr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:t.v*Math.PI/180}}function Tr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=1;if(e.length===2){const o=v.map(n(e[1]),r);if(o.t==="err")return o;s=o.v}return s===0?{t:"num",v:0}:t.v>0&&s<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.ceil(t.v/s)*s}}function Lr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=1;if(e.length===2){const o=v.map(n(e[1]),r);if(o.t==="err")return o;s=o.v}return s===0?{t:"num",v:0}:t.v>0&&s<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.floor(t.v/s)*s}}function Ir(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=0;if(e.length===2){const c=v.map(n(e[1]),r);if(c.t==="err")return c;s=Math.trunc(c.v)}const o=Math.pow(10,s);return{t:"num",v:Math.trunc(t.v*o)/o}}function Sr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);return s.t==="err"?s:s.v===0?{t:"num",v:0}:t.v>0&&s.v<0||t.v<0&&s.v>0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.round(t.v/s.v)*s.v}}function Ur(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=A(n(e[1]),r);return s.t==="err"?s:{t:"bool",v:t.v===s.v}}function Cr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==4)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=A(n(e[3]),r);if(c.t==="err")return c;const i=Math.trunc(s.v)-1,f=Math.trunc(o.v);return i<0||f<0?{t:"err",v:"#VALUE!"}:{t:"str",v:t.v.slice(0,i)+c.v+t.v.slice(i+f)}}function Dr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v);return o<0?{t:"err",v:"#VALUE!"}:{t:"str",v:t.v.repeat(o)}}function Vr(u,n,r){var s;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err"||t.t==="str")return t;if(t.t==="ref"&&r){const o=((s=r.get(t.v))==null?void 0:s.v)||"";if(o==="")return{t:"str",v:""};const c=o.toUpperCase(),i=c==="TRUE"||c==="FALSE",f=!isNaN(Number(o));return i||f?{t:"str",v:""}:{t:"str",v:o}}return{t:"str",v:""}}function Or(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=t.v.trim(),o=Number(s);return s===""||isNaN(o)?{t:"err",v:"#VALUE!"}:{t:"num",v:o}}function yr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=A(n(e[1]),r);if(s.t==="err")return s;const o=s.v,c=t.v;if(o.endsWith("%")){const f=(o.slice(0,-1).split(".")[1]||"").length;return{t:"str",v:(c*100).toFixed(f)+"%"}}if(o.includes(",")){const i=(o.split(".")[1]||"").replace(/[^0#]/g,"").length,f=c.toFixed(i).split(".");return f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),{t:"str",v:f.join(".")}}if(o.includes(".")){const i=(o.split(".")[1]||"").length;return{t:"str",v:c.toFixed(i)}}return{t:"str",v:c.toFixed(0)}}function wr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=Math.trunc(t.v);return s<1||s>65535?{t:"err",v:"#VALUE!"}:{t:"str",v:String.fromCharCode(s)}}function Pr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);return t.t==="err"?t:t.v.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:t.v.charCodeAt(0)}}function kr(u,n,r){var f,m;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=E(e[0],n,r);if(t.t==="err")return t;const s=w(n(e[1]),r);if(L(s))return s;const o=e.length===3?E(e[2],n,r):t;if(o.t==="err")return o;if(t.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};let c=0,i=0;for(let l=0;l<t.v.length;l++){const p=((f=r==null?void 0:r.get(t.v[l]))==null?void 0:f.v)||"";if(!P(p,s))continue;const g=((m=r==null?void 0:r.get(o.v[l]))==null?void 0:m.v)||"",h=Number(g);g!==""&&!isNaN(h)&&(c+=h,i++)}return i===0?{t:"err",v:"#VALUE!"}:{t:"num",v:c/i}}function _r(u,n,r){var f,m;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||(e.length-1)%2!==0)return{t:"err",v:"#N/A!"};const t=E(e[0],n,r);if(t.t==="err")return t;const s=[],o=[];for(let l=1;l<e.length;l+=2){const p=E(e[l],n,r);if(p.t==="err")return p;s.push(p.v);const g=w(n(e[l+1]),r);if(L(g))return g;o.push(g)}if(s.some(l=>l.length!==t.v.length))return{t:"err",v:"#VALUE!"};let c=0,i=0;for(let l=0;l<t.v.length;l++){let p=!0;for(let g=0;g<s.length;g++){const h=((f=r==null?void 0:r.get(s[g][l]))==null?void 0:f.v)||"";if(!P(h,o[g])){p=!1;break}}if(p){const g=((m=r==null?void 0:r.get(t.v[l]))==null?void 0:m.v)||"",h=Number(g);g!==""&&!isNaN(h)&&(c+=h,i++)}}return i===0?{t:"err",v:"#VALUE!"}:{t:"num",v:c/i}}function Xr(u,n,r){var i;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=[],s=n(e[0]);if(s.t==="err")return s;if(s.t==="num")t.push(s.v);else if(s.t==="ref"&&r)for(const f of F([s.v])){const m=((i=r.get(f))==null?void 0:i.v)||"";m!==""&&!isNaN(Number(m))&&t.push(Number(m))}const o=v.map(n(e[1]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);return c<1||c>t.length?{t:"err",v:"#VALUE!"}:(t.sort((f,m)=>m-f),{t:"num",v:t[c-1]})}function Yr(u,n,r){var i;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=[],s=n(e[0]);if(s.t==="err")return s;if(s.t==="num")t.push(s.v);else if(s.t==="ref"&&r)for(const f of F([s.v])){const m=((i=r.get(f))==null?void 0:i.v)||"";m!==""&&!isNaN(Number(m))&&t.push(Number(m))}const o=v.map(n(e[1]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);return c<1||c>t.length?{t:"err",v:"#VALUE!"}:(t.sort((f,m)=>f-m),{t:"num",v:t[c-1]})}function Gr(u,n,r){var s;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err"||t.t==="num")return t;if(t.t==="bool")return{t:"num",v:t.v?1:0};if(t.t==="ref"&&r){const o=((s=r.get(t.v))==null?void 0:s.v)||"";if(o==="")return{t:"num",v:0};const c=o.toUpperCase();if(c==="TRUE")return{t:"num",v:1};if(c==="FALSE")return{t:"num",v:0};const i=Number(o);return{t:"num",v:isNaN(i)?0:i}}return{t:"num",v:0}}function Hr(u,n,r){var c;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1)return{t:"err",v:"#N/A!"};const t=[];for(const i of e){const f=E(i,n,r);if(f.t==="err")return f;const m=[];for(const l of f.v){const p=((c=r==null?void 0:r.get(l))==null?void 0:c.v)||"";m.push(p!==""&&!isNaN(Number(p))?Number(p):0)}t.push(m)}const s=t[0].length;if(t.some(i=>i.length!==s))return{t:"err",v:"#VALUE!"};let o=0;for(let i=0;i<s;i++){let f=1;for(const m of t)f*=m[i];o+=f}return{t:"num",v:o}}function Oe(u,n){for(u=Math.abs(u),n=Math.abs(n);n;)[u,n]=[n,u%n];return u}function Br(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0;for(const t of v.iterate(a,n,r)){if(t.t==="err")return t;const s=Math.trunc(t.v);if(s<0)return{t:"err",v:"#VALUE!"};e=Oe(e,s)}return{t:"num",v:e}}function qr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=1,t=!1;for(const s of v.iterate(a,n,r)){if(s.t==="err")return s;const o=Math.trunc(s.v);if(o<0)return{t:"err",v:"#VALUE!"};if(o===0)return{t:"num",v:0};e=e/Oe(e,o)*o,t=!0}return t?{t:"num",v:e}:{t:"err",v:"#VALUE!"}}function Kr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(t.v),c=Math.trunc(s.v);if(o<0||c<0||c>o)return{t:"err",v:"#VALUE!"};let i=1;for(let f=0;f<c;f++)i=i*(o-f)/(f+1);return{t:"num",v:Math.round(i)}}function Wr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=Math.trunc(t.v);if(s<0)return{t:"err",v:"#VALUE!"};let o=1;for(let c=2;c<=s;c++)o*=c;return{t:"num",v:o}}function $r(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);return s.t==="err"?s:s.v===0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.trunc(t.v/s.v)}}function Qr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0;for(const t of I.iterate(a,n,r)){if(t.t==="err")return t;t.v&&e++}return{t:"bool",v:e%2===1}}function zr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=Math.trunc(t.v);return s<1||s>=e.length?{t:"err",v:"#VALUE!"}:n(e[s])}function jr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};switch(n(e[0]).t){case"num":return{t:"num",v:1};case"str":return{t:"num",v:2};case"bool":return{t:"num",v:4};case"err":return{t:"num",v:16};case"ref":return{t:"num",v:1};default:return{t:"num",v:1}}}function Jr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v),c=new Date(t.getFullYear(),t.getMonth()+o,t.getDate());return{t:"str",v:y(c)}}function Zr(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v),c=new Date(t.getFullYear(),t.getMonth()+o+1,0);return{t:"str",v:y(c)}}function en(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;const s=T(n(e[1]),r);if(!(s instanceof Date))return s;const o=t<=s?1:-1,c=o===1?t:s,i=o===1?s:t;let f=0;const m=new Date(c);for(;m<=i;){const l=m.getDay();l!==0&&l!==6&&f++,m.setDate(m.getDate()+1)}return{t:"num",v:f*o}}function tn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);return t instanceof Date?{t:"str",v:y(t)}:t}function rn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=te(n(e[0]),r);if(!(t instanceof Date))return t;const s=t.getHours(),o=t.getMinutes(),c=t.getSeconds();return{t:"num",v:(s*3600+o*60+c)/86400}}function nn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;const s=T(n(e[1]),r);if(!(s instanceof Date))return s;if(t>s)return{t:"err",v:"#VALUE!"};const o=A(n(e[2]),r);if(o.t==="err")return o;const c=o.v.toUpperCase();if(c==="D"){const f=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return{t:"num",v:(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())-f)/864e5}}if(c==="M"){let i=(s.getFullYear()-t.getFullYear())*12+(s.getMonth()-t.getMonth());return s.getDate()<t.getDate()&&i--,{t:"num",v:i}}if(c==="Y"){let i=s.getFullYear()-t.getFullYear();return(s.getMonth()<t.getMonth()||s.getMonth()===t.getMonth()&&s.getDate()<t.getDate())&&i--,{t:"num",v:i}}if(c==="MD"){let i=s.getDate()-t.getDate();if(i<0){const f=new Date(s.getFullYear(),s.getMonth(),0);i+=f.getDate()}return{t:"num",v:i}}if(c==="YM"){let i=s.getMonth()-t.getMonth();return i<0&&(i+=12),s.getDate()<t.getDate()&&(i--,i<0&&(i+=12)),{t:"num",v:i}}if(c==="YD"){const i=new Date(s.getFullYear(),t.getMonth(),t.getDate());i>s&&i.setFullYear(i.getFullYear()-1);const f=24*60*60*1e3,m=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate());return{t:"num",v:(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())-m)/f}}return{t:"err",v:"#VALUE!"}}function sn(u,n,r){const a=u.args();if(!a||a.expr().length===0)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;if(t.t!=="ref")return{t:"err",v:"#VALUE!"};const s=M(t.v)?t.v.split(":")[0]:t.v;let o=s;G(s)&&(o=W(s).localRef);try{return{t:"num",v:J(o).r}}catch{return{t:"err",v:"#REF!"}}}function an(u,n,r){const a=u.args();if(!a||a.expr().length===0)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;if(t.t!=="ref")return{t:"err",v:"#VALUE!"};const s=M(t.v)?t.v.split(":")[0]:t.v;let o=s;G(s)&&(o=W(s).localRef);try{return{t:"num",v:J(o).c}}catch{return{t:"err",v:"#REF!"}}}function on(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;if(t.t!=="ref")return{t:"err",v:"#VALUE!"};if(!M(t.v))return{t:"num",v:1};let s=t.v;G(t.v)&&(s=W(t.v).localRef);try{const[o,c]=Z(s);return{t:"num",v:Math.abs(c.r-o.r)+1}}catch{return{t:"err",v:"#REF!"}}}function un(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;if(t.t!=="ref")return{t:"err",v:"#VALUE!"};if(!M(t.v))return{t:"num",v:1};let s=t.v;G(t.v)&&(s=W(t.v).localRef);try{const[o,c]=Z(s);return{t:"num",v:Math.abs(c.c-o.c)+1}}catch{return{t:"err",v:"#REF!"}}}function cn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>4)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(t.v),c=Math.trunc(s.v);if(o<1||c<1)return{t:"err",v:"#VALUE!"};let i=1;if(e.length>=3){const m=v.map(n(e[2]),r);if(m.t==="err")return m;i=Math.trunc(m.v)}const f=Te(c);switch(i){case 1:return{t:"str",v:`$${f}$${o}`};case 2:return{t:"str",v:`${f}$${o}`};case 3:return{t:"str",v:`$${f}${o}`};case 4:return{t:"str",v:`${f}${o}`};default:return{t:"err",v:"#VALUE!"}}}function fn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;if(e.length===2){const s=A(n(e[1]),r);return s.t==="err"?s:{t:"str",v:s.v}}return{t:"str",v:t.v}}function mn(u,n,r){var i,f;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||(e.length-1)%2!==0)return{t:"err",v:"#N/A!"};const t=E(e[0],n,r);if(t.t==="err")return t;const s=[],o=[];for(let m=1;m<e.length;m+=2){const l=E(e[m],n,r);if(l.t==="err")return l;s.push(l.v);const p=w(n(e[m+1]),r);if(L(p))return p;o.push(p)}if(s.some(m=>m.length!==t.v.length))return{t:"err",v:"#VALUE!"};let c=1/0;for(let m=0;m<t.v.length;m++){let l=!0;for(let p=0;p<s.length;p++){const g=((i=r==null?void 0:r.get(s[p][m]))==null?void 0:i.v)||"";if(!P(g,o[p])){l=!1;break}}if(l){const p=((f=r==null?void 0:r.get(t.v[m]))==null?void 0:f.v)||"",g=Number(p);p!==""&&!isNaN(g)&&g<c&&(c=g)}}return c===1/0?{t:"num",v:0}:{t:"num",v:c}}function ln(u,n,r){var i,f;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||(e.length-1)%2!==0)return{t:"err",v:"#N/A!"};const t=E(e[0],n,r);if(t.t==="err")return t;const s=[],o=[];for(let m=1;m<e.length;m+=2){const l=E(e[m],n,r);if(l.t==="err")return l;s.push(l.v);const p=w(n(e[m+1]),r);if(L(p))return p;o.push(p)}if(s.some(m=>m.length!==t.v.length))return{t:"err",v:"#VALUE!"};let c=-1/0;for(let m=0;m<t.v.length;m++){let l=!0;for(let p=0;p<s.length;p++){const g=((i=r==null?void 0:r.get(s[p][m]))==null?void 0:i.v)||"";if(!P(g,o[p])){l=!1;break}}if(l){const p=((f=r==null?void 0:r.get(t.v[m]))==null?void 0:f.v)||"",g=Number(p);p!==""&&!isNaN(g)&&g>c&&(c=g)}}return c===-1/0?{t:"num",v:0}:{t:"num",v:c}}function le(u,n,r){var f;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=n(e[1]);if(s.t==="err")return s;const o=[];if(s.t==="num")o.push(s.v);else if(s.t==="ref"&&r)for(const m of F([s.v])){const l=((f=r.get(m))==null?void 0:f.v)||"";l!==""&&!isNaN(Number(l))&&o.push(Number(l))}let c=0;if(e.length===3){const m=v.map(n(e[2]),r);if(m.t==="err")return m;c=Math.trunc(m.v)}const i=t.v;return o.includes(i)?c===0?{t:"num",v:o.filter(l=>l>i).length+1}:{t:"num",v:o.filter(l=>l<i).length+1}:{t:"err",v:"#N/A!"}}function ve(u,n,r){var g;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=[],s=n(e[0]);if(s.t==="err")return s;if(s.t==="num")t.push(s.v);else if(s.t==="ref"&&r)for(const h of F([s.v])){const N=((g=r.get(h))==null?void 0:g.v)||"";N!==""&&!isNaN(Number(N))&&t.push(Number(N))}const o=v.map(n(e[1]),r);if(o.t==="err")return o;const c=o.v;if(c<0||c>1||t.length===0)return{t:"err",v:"#VALUE!"};t.sort((h,N)=>h-N);const i=t.length,f=c*(i-1),m=Math.floor(f),l=Math.ceil(f),p=f-m;return m===l?{t:"num",v:t[m]}:{t:"num",v:t[m]+p*(t[l]-t[m])}}function vn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);return t.t==="err"?t:{t:"str",v:t.v.replace(/[\x00-\x1F]/g,"")}}function pn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>3)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;let s=".";if(e.length>=2){const f=A(n(e[1]),r);if(f.t==="err")return f;s=f.v||"."}let o=",";if(e.length===3){const f=A(n(e[2]),r);if(f.t==="err")return f;o=f.v||","}let c=t.v.trim();if(o&&(c=c.split(o).join("")),s!=="."&&(c=c.replace(s,".")),c.endsWith("%")){const f=Number(c.slice(0,-1));return isNaN(f)?{t:"err",v:"#VALUE!"}:{t:"num",v:f/100}}const i=Number(c);return c===""||isNaN(i)?{t:"err",v:"#VALUE!"}:{t:"num",v:i}}function pe(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const o of v.iterate(a,n,r)){if(o.t==="err")return o;e.push(o.v)}if(e.length<2)return{t:"err",v:"#VALUE!"};const t=e.reduce((o,c)=>o+c,0)/e.length,s=e.reduce((o,c)=>o+(c-t)**2,0);return{t:"num",v:Math.sqrt(s/(e.length-1))}}function ge(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const o of v.iterate(a,n,r)){if(o.t==="err")return o;e.push(o.v)}if(e.length===0)return{t:"err",v:"#VALUE!"};const t=e.reduce((o,c)=>o+c,0)/e.length,s=e.reduce((o,c)=>o+(c-t)**2,0);return{t:"num",v:Math.sqrt(s/e.length)}}function he(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const o of v.iterate(a,n,r)){if(o.t==="err")return o;e.push(o.v)}if(e.length<2)return{t:"err",v:"#VALUE!"};const t=e.reduce((o,c)=>o+c,0)/e.length;return{t:"num",v:e.reduce((o,c)=>o+(c-t)**2,0)/(e.length-1)}}function Ne(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const o of v.iterate(a,n,r)){if(o.t==="err")return o;e.push(o.v)}if(e.length===0)return{t:"err",v:"#VALUE!"};const t=e.reduce((o,c)=>o+c,0)/e.length;return{t:"num",v:e.reduce((o,c)=>o+(c-t)**2,0)/e.length}}function Ae(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const c of v.iterate(a,n,r)){if(c.t==="err")return c;e.push(c.v)}if(e.length===0)return{t:"err",v:"#N/A!"};const t=new Map;for(const c of e)t.set(c,(t.get(c)||0)+1);let s=0,o=e[0];for(const[c,i]of t)i>s&&(s=i,o=c);return s<=1?{t:"err",v:"#N/A!"}:{t:"num",v:o}}function gn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0;for(const t of v.iterate(a,n,r)){if(t.t==="err")return t;e+=t.v**2}return{t:"num",v:e}}function hn(u,n,r){const a=u.args();return a&&a.expr().length>0?{t:"err",v:"#N/A!"}:{t:"err",v:"#N/A!"}}function de(u,n,r){var h;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=[],s=n(e[0]);if(s.t==="err")return s;if(s.t==="num")t.push(s.v);else if(s.t==="ref"&&r)for(const N of F([s.v])){const d=((h=r.get(N))==null?void 0:h.v)||"";d!==""&&!isNaN(Number(d))&&t.push(Number(d))}const o=v.map(n(e[1]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<0||c>4||t.length===0)return{t:"err",v:"#VALUE!"};const i=c/4;t.sort((N,d)=>N-d);const f=t.length,m=i*(f-1),l=Math.floor(m),p=Math.ceil(m),g=m-l;return l===p?{t:"num",v:t[l]}:{t:"num",v:t[l]+g*(t[p]-t[l])}}function Nn(u,n,r){var s;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=new Set,t=a.expr();for(const o of t){const c=n(o);if(c.t==="err")return c;if(c.t==="ref"&&r)for(const i of F([c.v])){const f=(s=r.get(i))==null?void 0:s.v;f!==void 0&&f!==""&&e.add(f)}else c.t==="num"?e.add(String(c.v)):c.t==="str"&&c.v!==""?e.add(c.v):c.t==="bool"&&e.add(String(c.v))}return{t:"num",v:e.size}}function An(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=2;if(e.length>=2){const i=v.map(n(e[1]),r);if(i.t==="err")return i;s=Math.trunc(i.v)}let o=!1;if(e.length===3){const i=I.map(n(e[2]),r);if(i.t==="err")return i;o=i.v}let c;if(s<0){const i=10**-s;c=String(Math.round(t.v/i)*i)}else c=t.v.toFixed(s);if(!o){const i=c.split(".");i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),c=i.join(".")}return{t:"str",v:c}}function dn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=2;if(e.length===2){const l=v.map(n(e[1]),r);if(l.t==="err")return l;s=Math.trunc(l.v)}let o;if(s<0){const l=10**-s;o=Math.round(t.v/l)*l}else o=t.v;const c=o<0,f=Math.abs(o).toFixed(Math.max(0,s)).split(".");f[0]=f[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");const m=f.join(".");return{t:"str",v:c?`($${m})`:`$${m}`}}function En(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;let s=1;if(e.length===2){const g=v.map(n(e[1]),r);if(g.t==="err")return g;s=Math.trunc(g.v)}const o=new Date(t.getFullYear(),0,1),c=s===2?1:0,f=(o.getDay()-c+7)%7,m=new Date(o.getTime()-f*864e5),l=t.getTime()-m.getTime();return{t:"num",v:Math.floor(l/(7*864e5))+1}}function xn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;const s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),o=s.getUTCDay()||7;s.setUTCDate(s.getUTCDate()+4-o);const c=new Date(Date.UTC(s.getUTCFullYear(),0,1));return{t:"num",v:Math.ceil(((s.getTime()-c.getTime())/864e5+1)/7)}}function Rn(u,n,r){var m;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=new Set;if(e.length===3){const l=n(e[2]);if(l.t==="err")return l;if(l.t==="ref"&&r)for(const p of F([l.v])){const g=((m=r.get(p))==null?void 0:m.v)||"";g&&o.add(g)}else l.t==="str"&&o.add(l.v)}let c=Math.trunc(s.v);const i=c>0?1:-1;c=Math.abs(c);const f=new Date(t);for(;c>0;){f.setDate(f.getDate()+i);const l=f.getDay();l!==0&&l!==6&&!o.has(y(f))&&c--}return{t:"str",v:y(f)}}function Mn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=T(n(e[0]),r);if(!(t instanceof Date))return t;const s=T(n(e[1]),r);if(!(s instanceof Date))return s;let o=0;if(e.length===3){const m=v.map(n(e[2]),r);if(m.t==="err")return m;o=Math.trunc(m.v)}if(o<0||o>4)return{t:"err",v:"#VALUE!"};const c=t<s?t:s,i=t<s?s:t,f=Math.round((i.getTime()-c.getTime())/864e5);switch(o){case 0:case 4:return{t:"num",v:f/360};case 1:{const m=c.getFullYear(),l=i.getFullYear();if(m===l){const N=(new Date(m+1,0,1).getTime()-new Date(m,0,1).getTime())/864e5;return{t:"num",v:f/N}}const p=l-m+1,h=(new Date(l+1,0,1).getTime()-new Date(m,0,1).getTime())/864e5/p;return{t:"num",v:f/h}}case 2:return{t:"num",v:f/360};case 3:return{t:"num",v:f/365};default:return{t:"err",v:"#VALUE!"}}}function bn(u,n,r){var p,g;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;const s=E(e[1],n,r);if(L(s))return s;let o=s.v;if(e.length===3){const h=E(e[2],n,r);if(L(h))return h;o=h.v}const c=t.t==="num"||t.t==="str"?t.v:"",i=t.t==="num";let f=-1;for(let h=0;h<s.v.length;h++){const N=((p=r==null?void 0:r.get(s.v[h]))==null?void 0:p.v)||"";if(i){const d=Number(N);N!==""&&!isNaN(d)&&d<=c&&(f=h)}else N.toLowerCase()<=String(c).toLowerCase()&&(f=h)}if(f===-1||f>=o.length)return{t:"err",v:"#N/A!"};const m=((g=r==null?void 0:r.get(o[f]))==null?void 0:g.v)||"",l=Number(m);return m!==""&&!isNaN(l)?{t:"num",v:l}:{t:"str",v:m}}function Fn(u,n,r){var i;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;if(!r)return{t:"err",v:"#REF!"};const s=t.v.trim(),o=(i=r.get(s))==null?void 0:i.v;if(o===void 0)return{t:"str",v:""};const c=Number(o);return o!==""&&!isNaN(c)?{t:"num",v:c}:{t:"str",v:o}}function Tn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t!=="err")return{t:"err",v:"#N/A!"};const o={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A!":7,"#ERROR!":8}[t.v];return o!==void 0?{t:"num",v:o}:{t:"err",v:"#N/A!"}}function Ln(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return{t:"bool",v:!1};if(t.t!=="str"||t.v==="")return{t:"bool",v:!1};if(!/[\-\/]/.test(t.v))return{t:"bool",v:!1};const s=new Date(t.v);return{t:"bool",v:!isNaN(s.getTime())}}function In(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>4)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=A(n(e[1]),r);if(s.t==="err")return s;let o=!0;if(e.length>=3){const f=I.map(n(e[2]),r);if(f.t==="err")return f;o=f.v}let c=!0;if(e.length===4){const f=I.map(n(e[3]),r);if(f.t==="err")return f;c=f.v}let i;if(o&&s.v.length>1){const f=new RegExp("["+s.v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"]");i=t.v.split(f)}else i=t.v.split(s.v);return c&&(i=i.filter(f=>f!=="")),{t:"str",v:i.length>0?i[0]:""}}function Sn(u,n,r){var o;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=[];for(let c=1;c<e.length;c++){const i=n(e[c]);if(i.t==="err")return i;if(i.t==="ref"&&r)for(const f of F([i.v])){const m=((o=r.get(f))==null?void 0:o.v)||"";s.push(m)}else i.t==="num"?s.push(String(i.v)):i.t==="str"?s.push(i.v):i.t==="bool"&&s.push(i.v?"TRUE":"FALSE")}return{t:"str",v:s.join(t.v)}}function Un(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=A(n(e[1]),r);if(s.t==="err")return s;try{return{t:"bool",v:new RegExp(s.v).test(t.v)}}catch{return{t:"err",v:"#VALUE!"}}}function C(u,n,r,a){var c,i;const e=E(u,r,a);if(L(e))return e;const t=E(n,r,a);if(L(t))return t;if(e.v.length!==t.v.length)return{t:"err",v:"#N/A!"};const s=[],o=[];for(let f=0;f<t.v.length;f++){const m=((c=a==null?void 0:a.get(t.v[f]))==null?void 0:c.v)||"",l=((i=a==null?void 0:a.get(e.v[f]))==null?void 0:i.v)||"";m!==""&&l!==""&&!isNaN(Number(m))&&!isNaN(Number(l))&&(s.push(Number(m)),o.push(Number(l)))}return s.length<2?{t:"err",v:"#N/A!"}:{xs:s,ys:o}}function re(u,n){const r=u.length,a=u.reduce((i,f)=>i+f,0),e=n.reduce((i,f)=>i+f,0),t=u.reduce((i,f,m)=>i+f*n[m],0),s=u.reduce((i,f)=>i+f*f,0),o=(r*t-a*e)/(r*s-a*a),c=(e-o*a)/r;return{slope:o,intercept:c}}function Ee(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=C(e[1],e[2],n,r);if("t"in s)return s;const{slope:o,intercept:c}=re(s.xs,s.ys);return{t:"num",v:c+o*t.v}}function Cn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const{slope:s}=re(t.xs,t.ys);return{t:"num",v:s}}function Dn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const{intercept:s}=re(t.xs,t.ys);return{t:"num",v:s}}function Vn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const s=t.xs.length,o=t.xs.reduce((p,g)=>p+g,0)/s,c=t.ys.reduce((p,g)=>p+g,0)/s;let i=0,f=0,m=0;for(let p=0;p<s;p++){const g=t.xs[p]-o,h=t.ys[p]-c;i+=g*h,f+=g*g,m+=h*h}const l=Math.sqrt(f*m);return l===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:i/l}}function On(u,n,r){var h,N,d,R;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>6)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;const s=E(e[1],n,r);if(L(s))return s;const o=E(e[2],n,r);if(L(o))return o;let c=null;e.length>=4&&(c=n(e[3]));let i=0;if(e.length>=5){const b=v.map(n(e[4]),r);if(b.t==="err")return b;i=Math.trunc(b.v)}const f=t.t==="num"||t.t==="str"||t.t==="bool"?t.v:"",m=t.t==="num";let l=-1;if(i===0)for(let b=0;b<s.v.length;b++){const S=((h=r==null?void 0:r.get(s.v[b]))==null?void 0:h.v)||"";if(m){if(S!==""&&Number(S)===f){l=b;break}}else if(String(S).toLowerCase()===String(f).toLowerCase()){l=b;break}}else if(i===-1){let b=-1/0;for(let S=0;S<s.v.length;S++){const B=((N=r==null?void 0:r.get(s.v[S]))==null?void 0:N.v)||"";if(m){const V=Number(B);B!==""&&!isNaN(V)&&V<=f&&V>b&&(b=V,l=S)}}}else if(i===1){let b=1/0;for(let S=0;S<s.v.length;S++){const B=((d=r==null?void 0:r.get(s.v[S]))==null?void 0:d.v)||"";if(m){const V=Number(B);B!==""&&!isNaN(V)&&V>=f&&V<b&&(b=V,l=S)}}}if(l===-1)return c||{t:"err",v:"#N/A!"};if(l>=o.v.length)return{t:"err",v:"#N/A!"};const p=((R=r==null?void 0:r.get(o.v[l]))==null?void 0:R.v)||"",g=Number(p);return p!==""&&!isNaN(g)?{t:"num",v:g}:{t:"str",v:p}}function yn(u,n,r){var d;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>5)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;if(t.t!=="ref"||!r)return{t:"err",v:"#VALUE!"};const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=Math.trunc(s.v),i=Math.trunc(o.v),f=M(t.v)?t.v.split(":")[0]:t.v,m=J(f),l=m.r+c,p=m.c+i;if(l<1||p<1)return{t:"err",v:"#REF!"};const g=`${Te(p)}${l}`,h=((d=r.get(g))==null?void 0:d.v)||"",N=Number(h);return h!==""&&!isNaN(N)?{t:"num",v:N}:{t:"str",v:h}}function wn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"bool",v:Math.trunc(t.v)%2===0}}function Pn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"bool",v:Math.trunc(t.v)%2!==0}}function kn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=Math.trunc(t.v);if(s<-1)return{t:"err",v:"#VALUE!"};if(s<=0)return{t:"num",v:1};let o=1;for(let c=s;c>0;c-=2)o*=c;return{t:"num",v:o}}function _n(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v);if(o<2||o>36)return{t:"err",v:"#VALUE!"};let c=Math.trunc(t.v).toString(o).toUpperCase();if(e.length===3){const i=v.map(n(e[2]),r);if(i.t==="err")return i;c=c.padStart(Math.trunc(i.v),"0")}return{t:"str",v:c}}function Xn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v);if(o<2||o>36)return{t:"err",v:"#VALUE!"};const c=parseInt(t.v,o);return isNaN(c)?{t:"err",v:"#VALUE!"}:{t:"num",v:c}}function Yn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.sqrt(t.v*Math.PI)}}function Gn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.sinh(t.v)}}function Hn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.cosh(t.v)}}function Bn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.tanh(t.v)}}function qn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:Math.asinh(t.v)}}function Kn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.acosh(t.v)}}function Wn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<=-1||t.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.atanh(t.v)}}function $n(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=Math.tan(t.v);return s===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:1/s}}function Qn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=Math.sin(t.v);return s===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:1/s}}function zn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=Math.cos(t.v);return s===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:1/s}}function jn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=A(n(e[1]),r);if(s.t==="err")return s;try{const o=new RegExp(s.v).exec(t.v);return o?{t:"str",v:o[1]!==void 0?o[1]:o[0]}:{t:"err",v:"#N/A!"}}catch{return{t:"err",v:"#VALUE!"}}}function Jn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);if(t.t==="err")return t;const s=A(n(e[1]),r);if(s.t==="err")return s;const o=A(n(e[2]),r);if(o.t==="err")return o;try{return{t:"str",v:t.v.replace(new RegExp(s.v,"g"),o.v)}}catch{return{t:"err",v:"#VALUE!"}}}function Zn(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=A(n(e[0]),r);return t.t==="err"?t:t.v.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:t.v.codePointAt(0)}}function es(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=Math.trunc(t.v);if(s<1)return{t:"err",v:"#VALUE!"};try{return{t:"str",v:String.fromCodePoint(s)}}catch{return{t:"err",v:"#VALUE!"}}}function ts(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const s of v.iterate(a,n,r)){if(s.t==="err")return s;if(s.v<=0)return{t:"err",v:"#VALUE!"};e.push(s.v)}if(e.length===0)return{t:"err",v:"#N/A!"};const t=e.reduce((s,o)=>s+Math.log(o),0);return{t:"num",v:Math.exp(t/e.length)}}function rs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const s of v.iterate(a,n,r)){if(s.t==="err")return s;if(s.v<=0)return{t:"err",v:"#VALUE!"};e.push(s.v)}if(e.length===0)return{t:"err",v:"#N/A!"};const t=e.reduce((s,o)=>s+1/o,0);return{t:"num",v:e.length/t}}function ns(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const o of v.iterate(a,n,r)){if(o.t==="err")return o;e.push(o.v)}if(e.length===0)return{t:"err",v:"#N/A!"};const t=e.reduce((o,c)=>o+c,0)/e.length;return{t:"num",v:e.reduce((o,c)=>o+Math.abs(c-t),0)/e.length}}function ss(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=[];for(const s of v.iterate(a,n,r)){if(s.t==="err")return s;e.push(s.v)}if(e.length===0)return{t:"err",v:"#N/A!"};const t=e.reduce((s,o)=>s+o,0)/e.length;return{t:"num",v:e.reduce((s,o)=>s+(o-t)**2,0)}}function as(u,n,r){var m;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t==="err")return t;const s=[];if(t.t==="num")s.push(t.v);else if(t.t==="ref"&&r)for(const l of F([t.v])){const p=((m=r.get(l))==null?void 0:m.v)||"";p!==""&&!isNaN(Number(p))&&s.push(Number(p))}const o=v.map(n(e[1]),r);if(o.t==="err")return o;const c=o.v;if(c<0||c>=1)return{t:"err",v:"#VALUE!"};if(s.length===0)return{t:"err",v:"#N/A!"};s.sort((l,p)=>l-p);const i=Math.floor(s.length*c/2),f=s.slice(i,s.length-i);return f.length===0?{t:"err",v:"#VALUE!"}:{t:"num",v:f.reduce((l,p)=>l+p,0)/f.length}}function os(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(t.v),c=Math.trunc(s.v);if(o<0||c<0||c>o)return{t:"err",v:"#VALUE!"};let i=1;for(let f=o;f>o-c;f--)i*=f;return{t:"num",v:i}}function Q(u,n,r,a,e){if(u===0)return-(r+a)/n;const t=Math.pow(1+u,n);return-(u*(r*t+a)/((1+u*e)*(t-1)))}function us(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>5)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;let c=0;if(e.length>=4){const f=v.map(n(e[3]),r);if(f.t==="err")return f;c=f.v}let i=0;if(e.length===5){const f=v.map(n(e[4]),r);if(f.t==="err")return f;i=Math.trunc(f.v)}return{t:"num",v:Q(t.v,s.v,o.v,c,i)}}function cs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>5)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;let c=0;if(e.length>=4){const m=v.map(n(e[3]),r);if(m.t==="err")return m;c=m.v}let i=0;if(e.length===5){const m=v.map(n(e[4]),r);if(m.t==="err")return m;i=Math.trunc(m.v)}if(t.v===0)return{t:"num",v:-(c+o.v*s.v)};const f=Math.pow(1+t.v,s.v);return{t:"num",v:-(c*f+o.v*(1+t.v*i)*(f-1)/t.v)}}function is(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>5)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;let c=0;if(e.length>=4){const m=v.map(n(e[3]),r);if(m.t==="err")return m;c=m.v}let i=0;if(e.length===5){const m=v.map(n(e[4]),r);if(m.t==="err")return m;i=Math.trunc(m.v)}if(t.v===0)return{t:"num",v:-(c+o.v*s.v)};const f=Math.pow(1+t.v,s.v);return{t:"num",v:-(c+o.v*(1+t.v*i)*(f-1)/t.v)/f}}function fs(u,n,r){var c;const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=0,o=1;for(let i=1;i<e.length;i++){const f=n(e[i]);if(f.t==="err")return f;if(f.t==="ref"&&r)for(const m of F([f.v])){const l=((c=r.get(m))==null?void 0:c.v)||"";l!==""&&!isNaN(Number(l))&&(s+=Number(l)/Math.pow(1+t.v,o),o++)}else f.t==="num"&&(s+=f.v/Math.pow(1+t.v,o),o++)}return{t:"num",v:s}}function ms(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>5)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;let c=0;if(e.length>=4){const m=v.map(n(e[3]),r);if(m.t==="err")return m;c=m.v}let i=0;if(e.length===5){const m=v.map(n(e[4]),r);if(m.t==="err")return m;i=Math.trunc(m.v)}if(t.v===0)return s.v===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:-(o.v+c)/s.v};const f=s.v*(1+t.v*i)/t.v;return{t:"num",v:Math.log((f-c)/(o.v+f))/Math.log(1+t.v)}}function ls(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<4||e.length>6)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=v.map(n(e[3]),r);if(c.t==="err")return c;let i=0;if(e.length>=5){const g=v.map(n(e[4]),r);if(g.t==="err")return g;i=g.v}let f=0;if(e.length===6){const g=v.map(n(e[5]),r);if(g.t==="err")return g;f=Math.trunc(g.v)}const m=Q(t.v,o.v,c.v,i,f);let l=c.v;for(let g=1;g<s.v;g++){f===1&&g===1&&(l+=m);const h=l*t.v;l+=h+(f===0||g>1?m:0)}const p=l*t.v;return f===1&&s.v===1?{t:"num",v:0}:{t:"num",v:p}}function vs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<4||e.length>6)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=v.map(n(e[3]),r);if(c.t==="err")return c;let i=0;if(e.length>=5){const g=v.map(n(e[4]),r);if(g.t==="err")return g;i=g.v}let f=0;if(e.length===6){const g=v.map(n(e[5]),r);if(g.t==="err")return g;f=Math.trunc(g.v)}const m=Q(t.v,o.v,c.v,i,f);let l=c.v;for(let g=1;g<s.v;g++){f===1&&g===1&&(l+=m);const h=l*t.v;l+=h+(f===0||g>1?m:0)}const p=f===1&&s.v===1?0:l*t.v;return{t:"num",v:m-p}}function ps(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);return o.t==="err"?o:o.v===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:(t.v-s.v)/o.v}}function gs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v);return o<1||t.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.pow(1+t.v/o,o)-1}}function hs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>6)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;let c=0;if(e.length>=4){const l=v.map(n(e[3]),r);if(l.t==="err")return l;c=l.v}let i=0;if(e.length>=5){const l=v.map(n(e[4]),r);if(l.t==="err")return l;i=Math.trunc(l.v)}let f=.1;if(e.length===6){const l=v.map(n(e[5]),r);if(l.t==="err")return l;f=l.v}let m=f;for(let l=0;l<100;l++){const p=Math.pow(1+m,t.v),g=o.v*p+s.v*(1+m*i)*(p-1)/m+c,h=t.v*o.v*Math.pow(1+m,t.v-1)+s.v*(1+m*i)*(t.v*Math.pow(1+m,t.v-1)*m-(p-1))/(m*m)+s.v*i*(p-1)/m,N=m-g/h;if(Math.abs(N-m)<1e-10)return{t:"num",v:N};m=N}return{t:"err",v:"#VALUE!"}}function Ns(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=[],s=E(e[0],n,r);if(s.t==="err")return s;for(const i of s.v){const f=r.get(i),m=f?Number(f.v):0;if(isNaN(m))return{t:"err",v:"#VALUE!"};t.push(m)}let o=.1;if(e.length===2){const i=v.map(n(e[1]),r);if(i.t==="err")return i;o=i.v}let c=o;for(let i=0;i<100;i++){let f=0,m=0;for(let p=0;p<t.length;p++){const g=Math.pow(1+c,p);f+=t[p]/g,m-=p*t[p]/Math.pow(1+c,p+1)}if(Math.abs(m)<1e-15)return{t:"err",v:"#VALUE!"};const l=c-f/m;if(Math.abs(l-c)<1e-10)return{t:"num",v:l};c=l}return{t:"err",v:"#VALUE!"}}function As(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<4||e.length>5)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=v.map(n(e[3]),r);if(c.t==="err")return c;let i=12;if(e.length===5){const p=v.map(n(e[4]),r);if(p.t==="err")return p;i=Math.trunc(p.v)}if(o.v<=0||c.v<1||t.v<0)return{t:"err",v:"#VALUE!"};const f=Math.round((1-Math.pow(s.v/t.v,1/o.v))*1e3)/1e3;let m=0;const l=Math.trunc(c.v);for(let p=1;p<=l;p++){let g;if(p===1?g=t.v*f*i/12:p===Math.trunc(o.v)+1?g=(t.v-m)*f*(12-i)/12:g=(t.v-m)*f,p===l)return{t:"num",v:g};m+=g}return{t:"err",v:"#VALUE!"}}function ds(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<4||e.length>5)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=v.map(n(e[3]),r);if(c.t==="err")return c;let i=2;if(e.length===5){const p=v.map(n(e[4]),r);if(p.t==="err")return p;i=p.v}if(o.v<=0||c.v<1)return{t:"err",v:"#VALUE!"};const f=i/o.v;let m=t.v;const l=Math.trunc(c.v);for(let p=1;p<=l;p++){let g=m*f;if(m-g<s.v&&(g=m-s.v),g<0&&(g=0),p===l)return{t:"num",v:g};m-=g}return{t:"err",v:"#VALUE!"}}function Es(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v);return o<1||t.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:o*(Math.pow(1+t.v,1/o)-1)}}function xs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==6)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=v.map(n(e[3]),r);if(c.t==="err")return c;const i=v.map(n(e[4]),r);if(i.t==="err")return i;const f=v.map(n(e[5]),r);if(f.t==="err")return f;const m=Math.trunc(c.v),l=Math.trunc(i.v),p=Math.trunc(f.v);if(t.v<=0||s.v<=0||o.v<=0||m<1||l<m||p!==0&&p!==1)return{t:"err",v:"#VALUE!"};const g=Q(t.v,s.v,o.v,0,p);let h=0,N=o.v;for(let d=1;d<=l;d++){const R=p===1&&d===1?0:N*t.v,b=g-R;d>=m&&(h+=R),N+=b}return{t:"num",v:h}}function Rs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==6)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=v.map(n(e[3]),r);if(c.t==="err")return c;const i=v.map(n(e[4]),r);if(i.t==="err")return i;const f=v.map(n(e[5]),r);if(f.t==="err")return f;const m=Math.trunc(c.v),l=Math.trunc(i.v),p=Math.trunc(f.v);if(t.v<=0||s.v<=0||o.v<=0||m<1||l<m||p!==0&&p!==1)return{t:"err",v:"#VALUE!"};const g=Q(t.v,s.v,o.v,0,p);let h=0,N=o.v;for(let d=1;d<=l;d++){const R=p===1&&d===1?0:N*t.v,b=g-R;d>=m&&(h+=b),N+=b}return{t:"num",v:h}}function Ms(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0,t=0;for(const s of a.expr()){const o=n(s);if(o.t==="err")return o;if(o.t==="ref"&&r){const c=Array.from(F([o.v]));for(const i of c){const f=r.get(i);if(!f||f.v===void 0||f.v==="")continue;const m=Number(f.v);e+=isNaN(m)?0:m,t++}}else o.t==="num"?(e+=o.v,t++):o.t==="bool"?(e+=o.v?1:0,t++):o.t==="str"&&(e+=0,t++)}return t===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:e/t}}function bs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=1/0,t=!1;for(const s of a.expr()){const o=n(s);if(o.t==="err")return o;if(o.t==="ref"&&r){const c=Array.from(F([o.v]));for(const i of c){const f=r.get(i);if(!f||f.v===void 0||f.v==="")continue;const m=Number(f.v),l=isNaN(m)?0:m;l<e&&(e=l),t=!0}}else if(o.t==="num")o.v<e&&(e=o.v),t=!0;else if(o.t==="bool"){const c=o.v?1:0;c<e&&(e=c),t=!0}else o.t==="str"&&(0<e&&(e=0),t=!0)}return t?{t:"num",v:e}:{t:"num",v:0}}function Fs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=-1/0,t=!1;for(const s of a.expr()){const o=n(s);if(o.t==="err")return o;if(o.t==="ref"&&r){const c=Array.from(F([o.v]));for(const i of c){const f=r.get(i);if(!f||f.v===void 0||f.v==="")continue;const m=Number(f.v),l=isNaN(m)?0:m;l>e&&(e=l),t=!0}}else if(o.t==="num")o.v>e&&(e=o.v),t=!0;else if(o.t==="bool"){const c=o.v?1:0;c>e&&(e=c),t=!0}else o.t==="str"&&(0>e&&(e=0),t=!0)}return t?{t:"num",v:e}:{t:"num",v:0}}function Ts(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<=-1||t.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:.5*Math.log((1+t.v)/(1-t.v))}}function Ls(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=Math.exp(2*t.v);return{t:"num",v:(s-1)/(s+1)}}function x(u){const r=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];if(u<.5)return Math.PI/(Math.sin(Math.PI*u)*x(1-u));u-=1;let a=r[0];for(let t=1;t<9;t++)a+=r[t]/(u+t);const e=u+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(e,u+.5)*Math.exp(-e)*a}function Is(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<=0&&Number.isInteger(t.v)?{t:"err",v:"#VALUE!"}:{t:"num",v:x(t.v)}}function Ss(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:t.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.log(x(t.v))}}function q(u){const n=u>=0?1:-1;u=Math.abs(u);const r=.254829592,a=-.284496736,e=1.421413741,t=-1.453152027,s=1.061405429,c=1/(1+.3275911*u),i=1-((((s*c+t)*c+e)*c+a)*c+r)*c*Math.exp(-u*u);return n*i}function ye(u){return .5*(1+q(u/Math.SQRT2))}function we(u){return Math.exp(-.5*u*u)/Math.sqrt(2*Math.PI)}function H(u){if(u<=0||u>=1)return NaN;if(u<.5)return-H(1-u);const n=Math.sqrt(-2*Math.log(1-u));return n-(2.515517+.802853*n+.010328*n*n)/(1+1.432788*n+.189269*n*n+.001308*n*n*n)}function xe(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==4)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;if(o.v<=0)return{t:"err",v:"#VALUE!"};const c=n(e[3]),i=c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0,f=(t.v-s.v)/o.v;return i?{t:"num",v:ye(f)}:{t:"num",v:we(f)/o.v}}function Re(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);return o.t==="err"?o:o.v<=0||t.v<=0||t.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:s.v+o.v*H(t.v)}}function Us(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==4)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;if(t.v<=0||o.v<=0)return{t:"err",v:"#VALUE!"};const c=n(e[3]),i=c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0,f=(Math.log(t.v)-s.v)/o.v;return i?{t:"num",v:ye(f)}:{t:"num",v:we(f)/(t.v*o.v)}}function Cs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);return o.t==="err"?o:o.v<=0||t.v<=0||t.v>=1?{t:"err",v:"#VALUE!"}:{t:"num",v:Math.exp(s.v+o.v*H(t.v))}}function Ds(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);return o.t==="err"?o:o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:(t.v-s.v)/o.v}}function Vs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==4)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;if(t.v<0||s.v<=0||o.v<=0)return{t:"err",v:"#VALUE!"};const c=n(e[3]);return(c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0)?{t:"num",v:1-Math.exp(-Math.pow(t.v/o.v,s.v))}:{t:"num",v:s.v/Math.pow(o.v,s.v)*Math.pow(t.v,s.v-1)*Math.exp(-Math.pow(t.v/o.v,s.v))}}function Os(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;if(s.v<0)return{t:"err",v:"#VALUE!"};const o=n(e[2]),c=o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0,i=Math.trunc(t.v);if(i<0)return{t:"err",v:"#VALUE!"};if(c){let f=0;for(let m=0;m<=i;m++)f+=Math.pow(s.v,m)*Math.exp(-s.v)/x(m+1);return{t:"num",v:f}}return{t:"num",v:Math.pow(s.v,i)*Math.exp(-s.v)/x(i+1)}}function ys(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==4)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=Math.trunc(t.v),i=Math.trunc(s.v);if(c<0||i<0||c>i||o.v<0||o.v>1)return{t:"err",v:"#VALUE!"};const f=n(e[3]),m=f.t==="bool"?f.v:f.t==="num"?f.v!==0:!0;function l(p){const g=Math.log(x(i+1))-Math.log(x(p+1))-Math.log(x(i-p+1));return Math.exp(g+p*Math.log(o.v)+(i-p)*Math.log(1-o.v))}if(m){let p=0;for(let g=0;g<=c;g++)p+=l(g);return{t:"num",v:p}}return{t:"num",v:l(c)}}function ws(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;if(t.v<0||s.v<=0)return{t:"err",v:"#VALUE!"};const o=n(e[2]);return(o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0)?{t:"num",v:1-Math.exp(-s.v*t.v)}:{t:"num",v:s.v*Math.exp(-s.v*t.v)}}function Ps(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);return o.t==="err"?o:t.v<=0||t.v>=1||s.v<=0||o.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:H(1-t.v/2)*s.v/Math.sqrt(Math.trunc(o.v))}}function K(u){return Math.log(x(u))}function ce(u,n){if(n<0||n===0)return 0;if(n<u+1){let s=1/u,o=s;for(let c=1;c<200&&(s*=n/(u+c),o+=s,!(Math.abs(s)<1e-14*Math.abs(o)));c++);return o*Math.exp(-n+u*Math.log(n)-K(u))}let r=n+1-u,a=1e30,e=1/r,t=e;for(let s=1;s<200;s++){const o=-s*(s-u);r+=2,e=o*e+r,Math.abs(e)<1e-30&&(e=1e-30),a=r+o/a,Math.abs(a)<1e-30&&(a=1e-30),e=1/e;const c=e*a;if(t*=c,Math.abs(c-1)<1e-14)break}return 1-Math.exp(-n+u*Math.log(n)-K(u))*t}function ks(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;if(t.v<0||s.v<1)return{t:"err",v:"#VALUE!"};const o=n(e[2]),c=o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0,f=Math.trunc(s.v)/2;return c?{t:"num",v:ce(f,t.v/2)}:{t:"num",v:Math.pow(t.v,f-1)*Math.exp(-t.v/2)/(Math.pow(2,f)*x(f))}}function _s(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;if(t.v<=0||t.v>=1||s.v<1)return{t:"err",v:"#VALUE!"};const o=Math.trunc(s.v);let c=o*Math.pow(1-2/(9*o)+H(t.v)*Math.sqrt(2/(9*o)),3);c<=0&&(c=.01);for(let i=0;i<100;i++){const f=ce(o/2,c/2),m=o/2,l=Math.pow(c,m-1)*Math.exp(-c/2)/(Math.pow(2,m)*x(m));if(Math.abs(l)<1e-15)break;const p=c-(f-t.v)/l;if(Math.abs(p-c)<1e-10){c=p;break}c=Math.max(p,1e-10)}return{t:"num",v:c}}function Xs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;if(s.v<1)return{t:"err",v:"#VALUE!"};const o=n(e[2]),c=o.t==="bool"?o.v:o.t==="num"?o.v!==0:!0,i=Math.trunc(s.v);if(c){const m=t.v*t.v;ce(i/2,i/(i+m)*i/2);const l=i/(i+m),p=X(l,i/2,.5);return{t:"num",v:t.v>=0?1-.5*p:.5*p}}return{t:"num",v:x((i+1)/2)/(Math.sqrt(i*Math.PI)*x(i/2))*Math.pow(1+t2/i,-(i+1)/2)}}function X(u,n,r){if(u<=0)return 0;if(u>=1)return 1;if(u>(n+1)/(n+r+2))return 1-X(1-u,r,n);const a=K(n)+K(r)-K(n+r),e=Math.exp(n*Math.log(u)+r*Math.log(1-u)-a)/n,t=200,s=1e-14,o=1e-30;let c=n+r,i=n+1,f=n-1,m=1,l=1-c*u/i;Math.abs(l)<o&&(l=o),l=1/l;let p=l;for(let g=1;g<=t;g++){const h=2*g;let N=g*(r-g)*u/((f+h)*(n+h));l=1+N*l,Math.abs(l)<o&&(l=o),m=1+N/m,Math.abs(m)<o&&(m=o),l=1/l,p*=l*m,N=-(n+g)*(c+g)*u/((n+h)*(i+h)),l=1+N*l,Math.abs(l)<o&&(l=o),m=1+N/m,Math.abs(m)<o&&(m=o),l=1/l;const d=l*m;if(p*=d,Math.abs(d-1)<s)break}return e*p}function Pe(u,n){let r=H(u);for(let a=0;a<100;a++){const e=r*r,t=n/(n+e),s=X(t,n/2,.5),o=r>=0?1-.5*s:.5*s,c=x((n+1)/2)/(Math.sqrt(n*Math.PI)*x(n/2))*Math.pow(1+e/n,-(n+1)/2);if(Math.abs(c)<1e-15)break;const i=r-(o-u)/c;if(Math.abs(i-r)<1e-10)return i;r=i}return r}function Ys(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);return s.t==="err"?s:t.v<=0||t.v>=1||s.v<1?{t:"err",v:"#VALUE!"}:{t:"num",v:Pe(t.v,Math.trunc(s.v))}}function Gs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==5)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=v.map(n(e[3]),r);if(c.t==="err")return c;const i=n(e[4]),f=i.t==="bool"?i.v:i.t==="num"?i.v!==0:!0,m=Math.trunc(t.v),l=Math.trunc(s.v),p=Math.trunc(o.v),g=Math.trunc(c.v);if(m<0||l<0||p<0||g<0||l>g||p>g||m>Math.min(l,p))return{t:"err",v:"#VALUE!"};function h(d,R){return Math.log(x(d+1))-Math.log(x(R+1))-Math.log(x(d-R+1))}function N(d){return Math.exp(h(p,d)+h(g-p,l-d)-h(g,l))}if(f){let d=0;for(let R=Math.max(0,l+p-g);R<=m;R++)d+=N(R);return{t:"num",v:d}}return{t:"num",v:N(m)}}function Hs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==4)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=n(e[3]),i=c.t==="bool"?c.v:c.t==="num"?c.v!==0:!0,f=Math.trunc(t.v),m=Math.trunc(s.v);if(f<0||m<1||o.v<=0||o.v>1)return{t:"err",v:"#VALUE!"};function l(p){const g=Math.log(x(p+m))-Math.log(x(m))-Math.log(x(p+1));return Math.exp(g+m*Math.log(o.v)+p*Math.log(1-o.v))}if(i){let p=0;for(let g=0;g<=f;g++)p+=l(g);return{t:"num",v:p}}return{t:"num",v:l(f)}}function Bs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(t.v<=0||t.v>=1||s.v<=0||c<2)return{t:"err",v:"#VALUE!"};const i=1-t.v/2,f=c-1;return{t:"num",v:Pe(i,f)*s.v/Math.sqrt(c)}}function qs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]),s=A(t,r);if(s.t==="err")return s;const o=s.v.toUpperCase(),c={I:1,V:5,X:10,L:50,C:100,D:500,M:1e3};let i=0;for(let f=0;f<o.length;f++){const m=c[o[f]],l=f+1<o.length?c[o[f+1]]:0;if(m===void 0)return{t:"err",v:"#VALUE!"};m<l?i-=m:i+=m}return{t:"num",v:i}}function Ks(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=Math.trunc(t.v);if(s<0||s>3999)return{t:"err",v:"#VALUE!"};if(s===0)return{t:"str",v:""};const o=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],c=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"];let i="";for(let f=0;f<o.length;f++)for(;s>=o[f];)i+=c[f],s-=o[f];return{t:"str",v:i}}function Ws(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};let e=0,t=1;for(const s of a.expr()){const o=v.map(n(s),r);if(o.t==="err")return o;const c=Math.trunc(o.v);if(c<0)return{t:"err",v:"#VALUE!"};e+=c,t*=x(c+1)}return{t:"num",v:Math.round(x(e+1)/t)}}function $s(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==4)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=E(e[3],n,r);if(c.t==="err")return c;let i=0;for(let f=0;f<c.v.length;f++){const m=r.get(c.v[f]),l=m?Number(m.v):0;if(isNaN(l))return{t:"err",v:"#VALUE!"};i+=l*Math.pow(t.v,s.v+f*o.v)}return{t:"num",v:i}}function Qs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=0;if(e.length===2){const o=v.map(n(e[1]),r);if(o.t==="err")return o;s=o.v}return{t:"num",v:t.v===s?1:0}}function zs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=0;if(e.length===2){const o=v.map(n(e[1]),r);if(o.t==="err")return o;s=o.v}return{t:"num",v:t.v>=s?1:0}}function js(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;if(e.length===1)return{t:"num",v:q(t.v)};const s=v.map(n(e[1]),r);return s.t==="err"?s:{t:"num",v:q(s.v)-q(t.v)}}function Js(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);return t.t==="err"?t:{t:"num",v:1-q(t.v)}}function Zs(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=E(e[1],n,r);if(s.t==="err")return s;const o=E(e[2],n,r);if(o.t==="err")return o;if(s.v.length!==o.v.length)return{t:"err",v:"#VALUE!"};const c=[],i=[];for(let l=0;l<s.v.length;l++){const p=r.get(s.v[l]),g=p?Number(p.v):0;if(isNaN(g))return{t:"err",v:"#VALUE!"};c.push(g);const h=r.get(o.v[l]),N=(h==null?void 0:h.v)||"",d=new Date(N);if(isNaN(d.getTime()))return{t:"err",v:"#VALUE!"};i.push(d.getTime())}const f=i[0];let m=0;for(let l=0;l<c.length;l++){const p=(i[l]-f)/315576e5;m+=c[l]/Math.pow(1+t.v,p)}return{t:"num",v:m}}function ea(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=E(e[0],n,r);if(t.t==="err")return t;const s=E(e[1],n,r);if(s.t==="err")return s;if(t.v.length!==s.v.length)return{t:"err",v:"#VALUE!"};const o=[],c=[];for(let l=0;l<t.v.length;l++){const p=r.get(t.v[l]),g=p?Number(p.v):0;if(isNaN(g))return{t:"err",v:"#VALUE!"};o.push(g);const h=r.get(s.v[l]),N=(h==null?void 0:h.v)||"",d=new Date(N);if(isNaN(d.getTime()))return{t:"err",v:"#VALUE!"};c.push(d.getTime())}let i=.1;if(e.length===3){const l=v.map(n(e[2]),r);if(l.t==="err")return l;i=l.v}const f=c[0];let m=i;for(let l=0;l<100;l++){let p=0,g=0;for(let N=0;N<o.length;N++){const d=(c[N]-f)/315576e5,R=Math.pow(1+m,d);p+=o[N]/R,g-=d*o[N]/Math.pow(1+m,d+1)}if(Math.abs(g)<1e-15)return{t:"err",v:"#VALUE!"};const h=m-p/g;if(Math.abs(h-m)<1e-10)return{t:"num",v:h};m=h}return{t:"err",v:"#VALUE!"}}function ta(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==4)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=v.map(n(e[3]),r);if(c.t==="err")return c;const i=Math.trunc(o.v),f=Math.trunc(c.v);if(i<=0||f<1||f>i)return{t:"err",v:"#VALUE!"};const m=i*(i+1)/2;return{t:"num",v:(t.v-s.v)*(i-f+1)/m}}function ra(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=E(e[0],n,r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=[];for(const l of t.v){const p=r.get(l),g=p?Number(p.v):0;if(isNaN(g))return{t:"err",v:"#VALUE!"};c.push(g)}const i=c.length;if(i<2)return{t:"err",v:"#VALUE!"};let f=0,m=0;for(let l=0;l<i;l++)c[l]<0?f+=c[l]/Math.pow(1+s.v,l):m+=c[l]*Math.pow(1+o.v,i-1-l);return f===0?{t:"err",v:"#DIV/0!"}:{t:"num",v:Math.pow(-m/f,1/(i-1))-1}}function na(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=n(e[0]),s=n(e[1]),o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=A(t,r);if(c.t==="err")return c;const i=A(s,r);if(i.t==="err")return i;const f=new Date(c.v),m=new Date(i.v);if(isNaN(f.getTime())||isNaN(m.getTime()))return{t:"err",v:"#VALUE!"};const l=(m.getTime()-f.getTime())/(24*3600*1e3);return l<=0||o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:365*o.v/(360-o.v*l)}}function sa(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=n(e[0]),s=n(e[1]),o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=A(t,r),i=A(s,r);if(c.t==="err"||i.t==="err")return{t:"err",v:"#VALUE!"};const f=new Date(c.v),m=new Date(i.v);if(isNaN(f.getTime())||isNaN(m.getTime()))return{t:"err",v:"#VALUE!"};const l=(m.getTime()-f.getTime())/(24*3600*1e3);return l<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:100*(1-o.v*l/360)}}function aa(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=n(e[0]),s=n(e[1]),o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=A(t,r),i=A(s,r);if(c.t==="err"||i.t==="err")return{t:"err",v:"#VALUE!"};const f=new Date(c.v),m=new Date(i.v);if(isNaN(f.getTime())||isNaN(m.getTime()))return{t:"err",v:"#VALUE!"};const l=(m.getTime()-f.getTime())/(24*3600*1e3);return l<=0||o.v<=0?{t:"err",v:"#VALUE!"}:{t:"num",v:(100-o.v)/o.v*360/l}}function oa(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v);if(o<1)return{t:"err",v:"#VALUE!"};const c=Math.trunc(t.v),i=t.v-c,f=Math.pow(10,Math.ceil(Math.log10(o)));return{t:"num",v:c+i*f/o}}function ua(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v);if(o<1)return{t:"err",v:"#VALUE!"};const c=Math.trunc(t.v),i=t.v-c,f=Math.pow(10,Math.ceil(Math.log10(o)));return{t:"num",v:c+i*o/f}}function ca(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]),s=A(t,r);return s.t==="err"?s:{t:"str",v:encodeURIComponent(s.v)}}function ia(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]),s=A(t,r);if(s.t==="err")return s;const o=s.v.trim();return{t:"bool",v:/^https?:\/\//i.test(o)||/^ftp:\/\//i.test(o)}}function fa(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t!=="ref"||!r)return{t:"bool",v:!1};if(M(t.v))return{t:"err",v:"#VALUE!"};const s=r.get(t.v);return{t:"bool",v:!!(s&&s.f)}}function ma(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==1)return{t:"err",v:"#N/A!"};const t=n(e[0]);if(t.t!=="ref"||!r)return{t:"err",v:"#N/A!"};if(M(t.v))return{t:"err",v:"#VALUE!"};const s=r.get(t.v);return!s||!s.f?{t:"err",v:"#N/A!"}:{t:"str",v:s.f}}function la(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=1;if(e.length>=2){const c=v.map(n(e[1]),r);if(c.t==="err")return c;s=c.v}if(s===0)return{t:"num",v:0};let o=0;if(e.length===3){const c=v.map(n(e[2]),r);if(c.t==="err")return c;o=c.v}return s=Math.abs(s),t.v<0&&o!==0?{t:"num",v:-Math.ceil(Math.abs(t.v)/s)*s}:{t:"num",v:Math.ceil(t.v/s)*s}}function va(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=1;if(e.length>=2){const c=v.map(n(e[1]),r);if(c.t==="err")return c;s=c.v}if(s===0)return{t:"num",v:0};let o=0;if(e.length===3){const c=v.map(n(e[2]),r);if(c.t==="err")return c;o=c.v}return s=Math.abs(s),t.v<0&&o!==0?{t:"num",v:-Math.floor(Math.abs(t.v)/s)*s}:{t:"num",v:Math.floor(t.v/s)*s}}function pa(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=1;if(e.length===2){const o=v.map(n(e[1]),r);if(o.t==="err")return o;s=Math.abs(o.v)}return s===0?{t:"num",v:0}:{t:"num",v:Math.ceil(t.v/s)*s}}function ga(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<1||e.length>2)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;let s=1;if(e.length===2){const o=v.map(n(e[1]),r);if(o.t==="err")return o;s=Math.abs(o.v)}return s===0?{t:"num",v:0}:{t:"num",v:Math.floor(t.v/s)*s}}function Me(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const{xs:s,ys:o}=t,c=s.length,i=s.reduce((l,p)=>l+p,0)/c,f=o.reduce((l,p)=>l+p,0)/c;return{t:"num",v:s.reduce((l,p,g)=>l+(p-i)*(o[g]-f),0)/c}}function ha(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const{xs:s,ys:o}=t,c=s.length;if(c<2)return{t:"err",v:"#N/A!"};const i=s.reduce((l,p)=>l+p,0)/c,f=o.reduce((l,p)=>l+p,0)/c;return{t:"num",v:s.reduce((l,p,g)=>l+(p-i)*(o[g]-f),0)/(c-1)}}function Na(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const{xs:s,ys:o}=t,c=s.length,i=s.reduce((h,N)=>h+N,0)/c,f=o.reduce((h,N)=>h+N,0)/c,m=s.reduce((h,N,d)=>h+(N-i)*(o[d]-f),0),l=s.reduce((h,N)=>h+(N-i)*(N-i),0),p=o.reduce((h,N)=>h+(N-f)*(N-f),0);if(l===0||p===0)return{t:"err",v:"#DIV/0!"};const g=m/Math.sqrt(l*p);return{t:"num",v:g*g}}function Aa(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const{xs:s,ys:o}=t,c=s.length;if(c<3)return{t:"err",v:"#N/A!"};const{slope:i,intercept:f}=re(s,o),m=o.reduce((l,p,g)=>{const h=i*s[g]+f;return l+(p-h)*(p-h)},0);return{t:"num",v:Math.sqrt(m/(c-2))}}function z(u,n,r){var t;const a=n(u);if(a.t==="err")return a;const e=[];if(a.t==="num")e.push(a.v);else if(a.t==="ref"&&r)for(const s of F([a.v])){const o=((t=r.get(s))==null?void 0:t.v)||"";o!==""&&!isNaN(Number(o))&&e.push(Number(o))}return e}function da(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const s=t.ys,o=t.xs;let c=0;for(let i=0;i<s.length;i++)c+=s[i]*s[i]-o[i]*o[i];return{t:"num",v:c}}function Ea(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const s=t.ys,o=t.xs;let c=0;for(let i=0;i<s.length;i++)c+=s[i]*s[i]+o[i]*o[i];return{t:"num",v:c}}function xa(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=C(e[0],e[1],n,r);if("t"in t)return t;const s=t.ys,o=t.xs;let c=0;for(let i=0;i<s.length;i++){const f=s[i]-o[i];c+=f*f}return{t:"num",v:c}}function Ra(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=z(e[0],n,r);if(!Array.isArray(t))return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=s.v;if(o<=0||o>=1||t.length===0)return{t:"err",v:"#VALUE!"};t.sort((p,g)=>p-g);const c=t.length,i=o*(c+1)-1;if(i<0||i>c-1)return{t:"err",v:"#VALUE!"};const f=Math.floor(i),m=Math.ceil(i),l=i-f;return f===m||m>=c?{t:"num",v:t[Math.min(f,c-1)]}:{t:"num",v:t[f]+l*(t[m]-t[f])}}function Ma(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==2)return{t:"err",v:"#N/A!"};const t=z(e[0],n,r);if(!Array.isArray(t))return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=Math.trunc(s.v);if(o<1||o>3||t.length===0)return{t:"err",v:"#VALUE!"};t.sort((g,h)=>g-h);const c=t.length,f=o/4*(c+1)-1;if(f<0||f>c-1)return{t:"err",v:"#VALUE!"};const m=Math.floor(f),l=Math.ceil(f),p=f-m;return m===l?{t:"num",v:t[m]}:{t:"num",v:t[m]+p*(t[l]-t[m])}}function ba(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=z(e[1],n,r);if(!Array.isArray(s))return s;let o=0;if(e.length===3){const f=v.map(n(e[2]),r);if(f.t==="err")return f;o=Math.trunc(f.v)}const c=t.v;if(!s.includes(c))return{t:"err",v:"#N/A!"};const i=s.filter(f=>f===c).length;return o===0?{t:"num",v:s.filter(m=>m>c).length+1+(i-1)/2}:{t:"num",v:s.filter(m=>m<c).length+1+(i-1)/2}}function be(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=z(e[0],n,r);if(!Array.isArray(t))return t;if(t.length===0)return{t:"err",v:"#N/A!"};const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=s.v;let c=3;if(e.length===3){const g=v.map(n(e[2]),r);if(g.t==="err")return g;if(c=Math.trunc(g.v),c<1)return{t:"err",v:"#VALUE!"}}if(t.sort((g,h)=>g-h),o<t[0]||o>t[t.length-1])return{t:"err",v:"#N/A!"};const i=t.length;let f=0;for(const g of t)g<o&&f++;const m=t.indexOf(o);let l;if(m>=0)l=f/(i-1);else{const g=t[f-1],h=t[f];l=(f-1+(o-g)/(h-g))/(i-1)}const p=Math.pow(10,c);return{t:"num",v:Math.trunc(l*p)/p}}function Fa(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<2||e.length>3)return{t:"err",v:"#N/A!"};const t=z(e[0],n,r);if(!Array.isArray(t))return t;if(t.length===0)return{t:"err",v:"#N/A!"};const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=s.v;let c=3;if(e.length===3){const g=v.map(n(e[2]),r);if(g.t==="err")return g;if(c=Math.trunc(g.v),c<1)return{t:"err",v:"#VALUE!"}}if(t.sort((g,h)=>g-h),o<t[0]||o>t[t.length-1])return{t:"err",v:"#N/A!"};const i=t.length;let f=0;for(const g of t)g<o&&f++;const m=t.indexOf(o);let l;if(m>=0)l=(f+1)/(i+1);else{const g=t[f-1],h=t[f];l=(f+(o-g)/(h-g))/(i+1)}const p=Math.pow(10,c);return{t:"num",v:Math.trunc(l*p)/p}}function Ta(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<4||e.length>6)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=I.map(n(e[3]),r);if(c.t==="err")return c;let i=0,f=1;if(e.length>=5){const g=v.map(n(e[4]),r);if(g.t==="err")return g;i=g.v}if(e.length===6){const g=v.map(n(e[5]),r);if(g.t==="err")return g;f=g.v}const m=s.v,l=o.v;if(m<=0||l<=0||i>=f)return{t:"err",v:"#VALUE!"};const p=(t.v-i)/(f-i);if(p<0||p>1)return{t:"err",v:"#VALUE!"};if(c.v)return{t:"num",v:X(p,m,l)};{const g=U(m)+U(l)-U(m+l);return{t:"num",v:Math.exp((m-1)*Math.log(p)+(l-1)*Math.log(1-p)-g)/(f-i)}}}function U(u){return Math.log(x(u))}function La(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length<3||e.length>5)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;let c=0,i=1;if(e.length>=4){const h=v.map(n(e[3]),r);if(h.t==="err")return h;c=h.v}if(e.length===5){const h=v.map(n(e[4]),r);if(h.t==="err")return h;i=h.v}const f=t.v,m=s.v,l=o.v;if(f<0||f>1||m<=0||l<=0||c>=i)return{t:"err",v:"#VALUE!"};let p=.5;const g=U(m)+U(l)-U(m+l);for(let h=0;h<200;h++){const d=X(p,m,l)-f;if(Math.abs(d)<1e-12)break;const R=Math.exp((m-1)*Math.log(Math.max(p,1e-300))+(l-1)*Math.log(Math.max(1-p,1e-300))-g);if(R===0)break;p=Math.max(1e-15,Math.min(1-1e-15,p-d/R))}return{t:"num",v:c+p*(i-c)}}function Ia(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==4)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=I.map(n(e[3]),r);if(c.t==="err")return c;const i=t.v,f=Math.trunc(s.v),m=Math.trunc(o.v);if(i<0||f<1||m<1)return{t:"err",v:"#VALUE!"};if(c.v){const l=f*i/(f*i+m);return{t:"num",v:X(l,f/2,m/2)}}else{const l=f/2*Math.log(f)+m/2*Math.log(m)+(f/2-1)*Math.log(i),p=(f+m)/2*Math.log(f*i+m)+U(f/2)+U(m/2)-U((f+m)/2);return{t:"num",v:Math.exp(l-p)}}}function Sa(u,n,r){const a=u.args();if(!a)return{t:"err",v:"#N/A!"};const e=a.expr();if(e.length!==3)return{t:"err",v:"#N/A!"};const t=v.map(n(e[0]),r);if(t.t==="err")return t;const s=v.map(n(e[1]),r);if(s.t==="err")return s;const o=v.map(n(e[2]),r);if(o.t==="err")return o;const c=t.v,i=Math.trunc(s.v),f=Math.trunc(o.v);if(c<0||c>=1||i<1||f<1)return{t:"err",v:"#VALUE!"};if(c===0)return{t:"num",v:0};let m=1;for(let l=0;l<200;l++){const p=i*m/(i*m+f),h=X(p,i/2,f/2)-c;if(Math.abs(h)<1e-12)break;const N=i/2*Math.log(i)+f/2*Math.log(f)+(i/2-1)*Math.log(Math.max(m,1e-300)),d=(i+f)/2*Math.log(i*m+f)+U(i/2)+U(f/2)-U((i+f)/2),R=Math.exp(N-d);if(R===0)break;m=Math.max(1e-15,m-h/R)}return{t:"num",v:m}}function Fe(u){return{syntaxError:(n,r,a,e,t)=>{u.push({message:t,line:a,charPositionInLine:e})}}}function ne(u){const n=O.CharStreams.fromString(u.slice(1)),r=new k(n),a=new O.CommonTokenStream(r),e=new D(a),t=[];r.removeErrorListeners(),e.removeErrorListeners(),r.addErrorListener(Fe(t)),e.addErrorListener(Fe(t));try{return{tree:e.expr(),syntaxErrors:t,parser:e}}catch{return}}function se(u){return u.syntaxErrors.length>0||u.parser.numberOfSyntaxErrors>0}function Ua(u){return u.length>0&&u.every(n=>n.message.includes("missing ')' at '<EOF>'"))}function Ca(u){const n=O.CharStreams.fromString(u.slice(1)),r=new k(n),a=new O.CommonTokenStream(r);r.removeErrorListeners(),a.fill();let e=0;for(const t of a.getTokens()){if(t.type===k.T__0){e+=1;continue}t.type===k.T__1&&e>0&&(e-=1)}return e}function _a(u){if(!u.startsWith("="))return u;const n=ne(u);if(!n||!se(n)||!Ua(n.syntaxErrors))return u;const r=Ca(u);if(r<=0)return u;const a=u+")".repeat(r),e=ne(a);return!e||se(e)?u:a}function Xa(u){const n=O.CharStreams.fromString(u.slice(1)),r=new k(n),a=new O.CommonTokenStream(r);r.removeErrorListeners(),a.fill();const e=new Set;for(const t of a.getTokens())t.type===D.REFERENCE&&e.add(t.text.toUpperCase());return e}function ie(u){const n=O.CharStreams.fromString(u.slice(1)),r=new k(n),a=new O.CommonTokenStream(r);r.removeErrorListeners(),a.fill();const e=[];for(const o of a.getTokens())o.type!=k.EOF&&e.push({type:r.vocabulary.getSymbolicName(o.type)||"STRING",start:o.startIndex,stop:o.stopIndex,text:o.text});const t=[];let s;for(const o of e)!s&&o.start>0?t.push({type:"STRING",start:0,stop:o.start-1,text:u.slice(1,o.start+1)}):s&&s.stop+1!==o.start&&t.push({type:"STRING",start:s.stop+1,stop:o.start-1,text:u.slice(s.stop+2,o.start+1)}),t.push(o),s=o;return s&&s.stop+2<u.length&&t.push({type:"STRING",start:s.stop+1,stop:u.length-1,text:u.slice(s.stop+2)}),t}function Ya(u){const n=ie(u),r=[];for(const a of n)if(a.type==="REFERENCE")try{const e=a.text.toUpperCase();if(G(e))continue;if(e.includes(":"))r.push({text:e,range:Z(e)});else{const t=J(e);r.push({text:e,range:[t,t]})}}catch{}return r}function Ga(u,n){if(!u.startsWith("=")||n<=0)return!1;if(n===1)return!0;const r=ie(u);for(const o of r){const c=o.start+1,i=o.stop+2;if(o.type==="REFERENCE"&&n>=c&&n<=i)return!0}const e=u.slice(0,n).trimEnd();if(e.length===0)return!1;const t=e[e.length-1];return new Set(["=","(",",","+","-","*","/","<",">",":"]).has(t)}function Ha(u,n){if(!u.startsWith("="))return;const r=ie(u);for(const a of r){if(a.type!=="REFERENCE")continue;const e=a.start+1,t=a.stop+2;if(n>=e&&n<=t)return{start:e,end:t,text:a.text}}}function Ba(u,n){var r;try{const a=ne(u);if(!a||se(a))return"#ERROR!";const t=new Da(n).visit(a.tree);return t.t==="ref"&&n?M(t.v)?"#VALUE!":((r=n.get(t.v))==null?void 0:r.v)||"":t.v.toString()}catch{return"#ERROR!"}}class Da{constructor(n){Y(this,"grid");this.visit=this.visit.bind(this),this.grid=n}visitChildren(){throw new Error("Method not implemented.")}visitTerminal(){throw new Error("Method not implemented.")}visitErrorNode(){throw new Error("Method not implemented.")}visitFormula(){throw new Error("Method not implemented.")}visitExpr(){throw new Error("Method not implemented.")}visitArgs(){throw new Error("Method not implemented.")}visit(n){return n.accept(this)}visitFunction(n){const r=n.FUNCNAME().text.toUpperCase();if(me.has(r))return me.get(r)(n,this.visit,this.grid);throw new Error("Function not implemented.")}visitReference(n){return this.grid?{t:"ref",v:n.text.toUpperCase()}:{t:"err",v:"#REF!"}}visitParentheses(n){return this.visit(n.expr())}visitNumber(n){return{t:"num",v:Number(n.text)}}visitBoolean(n){return{t:"bool",v:n.text==="TRUE"||n.text==="true"}}visitAddSub(n){const r=v.map(this.visit(n.expr(0)),this.grid);if(r.t==="err")return r;const a=v.map(this.visit(n.expr(1)),this.grid);return a.t==="err"?a:n._op.type===D.ADD?{t:"num",v:r.v+a.v}:{t:"num",v:r.v-a.v}}visitMulDiv(n){const r=v.map(this.visit(n.expr(0)),this.grid);if(r.t==="err")return r;const a=v.map(this.visit(n.expr(1)),this.grid);return a.t==="err"?a:n._op.type===D.MUL?{t:"num",v:r.v*a.v}:{t:"num",v:r.v/a.v}}visitComparison(n){const r=v.map(this.visit(n.expr(0)),this.grid);if(r.t==="err")return r;const a=v.map(this.visit(n.expr(1)),this.grid);if(a.t==="err")return a;switch(n._op.type){case D.EQ:return{t:"bool",v:r.v===a.v};case D.NEQ:return{t:"bool",v:r.v!==a.v};case D.LT:return{t:"bool",v:r.v<a.v};case D.GT:return{t:"bool",v:r.v>a.v};case D.LTE:return{t:"bool",v:r.v<=a.v};case D.GTE:return{t:"bool",v:r.v>=a.v};default:return{t:"err",v:"#ERROR!"}}}visitStr(n){return{t:"str",v:n.text.slice(1,-1)}}}const ke=["Date","Engineering","Filter","Financial","Info","Logical","Lookup","Math","Operator","Statistical","Text","Database","Parser","Array","Web"],Va=[{name:"SUM",description:"Returns the sum of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"ABS",description:"Returns the absolute value of a number",args:[{name:"number"}]},{name:"ROUND",description:"Rounds a number to a certain number of decimal places",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDUP",description:"Rounds a number away from zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"ROUNDDOWN",description:"Rounds a number toward zero",args:[{name:"value"},{name:"places",optional:!0}]},{name:"INT",description:"Rounds a number down to the nearest integer",args:[{name:"value"}]},{name:"MOD",description:"Returns the remainder after division",args:[{name:"dividend"},{name:"divisor"}]},{name:"SQRT",description:"Returns the positive square root of a number",args:[{name:"value"}]},{name:"POWER",description:"Returns a number raised to a power",args:[{name:"base"},{name:"exponent"}]},{name:"PRODUCT",description:"Multiplies a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MEDIAN",description:"Returns the middle number in a series",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"RAND",description:"Returns a random number between 0 and 1",args:[]},{name:"RANDBETWEEN",description:"Returns a random integer between two values",args:[{name:"low"},{name:"high"}]},{name:"IF",description:"Returns one value if true and another if false",args:[{name:"condition"},{name:"value_if_true"},{name:"value_if_false",optional:!0}]},{name:"IFS",description:"Returns the first value whose condition is true",args:[{name:"condition1"},{name:"value1"},{name:"condition2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0}]},{name:"SWITCH",description:"Matches an expression against case/value pairs",args:[{name:"expression"},{name:"case1"},{name:"value1"},{name:"case2",optional:!0,repeating:!0},{name:"value2",optional:!0,repeating:!0},{name:"default",optional:!0}]},{name:"AND",description:"Returns TRUE if all arguments are true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"OR",description:"Returns TRUE if any argument is true",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"NOT",description:"Returns the opposite of a logical value",args:[{name:"logical"}]},{name:"AVERAGE",description:"Returns the average of a series of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MIN",description:"Returns the smallest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MAX",description:"Returns the largest value in a set of numbers",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"COUNT",description:"Counts the number of numeric values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTA",description:"Counts the number of non-empty values",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTBLANK",description:"Counts empty cells",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"COUNTIF",description:"Counts values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"}]},{name:"SUMIF",description:"Sums values in a range that meet a criterion",args:[{name:"range"},{name:"criterion"},{name:"sum_range",optional:!0}]},{name:"COUNTIFS",description:"Counts values that meet multiple criteria",args:[{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"SUMIFS",description:"Sums values that meet multiple criteria",args:[{name:"sum_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"MATCH",description:"Returns the position of an item in a one-dimensional range",args:[{name:"search_key"},{name:"range"},{name:"search_type",optional:!0}]},{name:"INDEX",description:"Returns the value at a given row and column of a range",args:[{name:"reference"},{name:"row",optional:!0},{name:"column",optional:!0}]},{name:"VLOOKUP",description:"Looks up a value in the first column of a range",args:[{name:"search_key"},{name:"range"},{name:"index"},{name:"is_sorted",optional:!0}]},{name:"HLOOKUP",description:"Looks up a value in the first row of a range",args:[{name:"search_key"},{name:"range"},{name:"index"},{name:"is_sorted",optional:!0}]},{name:"TRIM",description:"Removes leading and trailing whitespace from text",args:[{name:"text"}]},{name:"LEN",description:"Returns the number of characters in a text string",args:[{name:"text"}]},{name:"LEFT",description:"Returns the leftmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"RIGHT",description:"Returns the rightmost characters from a text string",args:[{name:"text"},{name:"num_chars",optional:!0}]},{name:"MID",description:"Returns characters from the middle of a text string",args:[{name:"text"},{name:"start_num"},{name:"num_chars"}]},{name:"CONCATENATE",description:"Joins two or more text strings into one",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"CONCAT",description:"Joins text values into one string",args:[{name:"text1"},{name:"text2"},{name:"text3",optional:!0,repeating:!0}]},{name:"FIND",description:"Finds one text value inside another (case-sensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"SEARCH",description:"Finds one text value inside another (case-insensitive)",args:[{name:"search_for"},{name:"text_to_search"},{name:"starting_at",optional:!0}]},{name:"TEXTJOIN",description:"Joins text values with a delimiter",args:[{name:"delimiter"},{name:"ignore_empty"},{name:"text1"},{name:"text2",optional:!0,repeating:!0}]},{name:"LOWER",description:"Converts text to lowercase",args:[{name:"text"}]},{name:"UPPER",description:"Converts text to uppercase",args:[{name:"text"}]},{name:"PROPER",description:"Capitalizes each word in text",args:[{name:"text"}]},{name:"SUBSTITUTE",description:"Replaces existing text with new text in a string",args:[{name:"text"},{name:"search_for"},{name:"replace_with"},{name:"occurrence",optional:!0}]},{name:"TODAY",description:"Returns the current date",args:[]},{name:"NOW",description:"Returns the current date and time",args:[]},{name:"DATE",description:"Returns a date from year, month, and day values",args:[{name:"year"},{name:"month"},{name:"day"}]},{name:"TIME",description:"Returns a time from hour, minute, and second values",args:[{name:"hour"},{name:"minute"},{name:"second"}]},{name:"DAYS",description:"Returns the number of days between two dates",args:[{name:"end_date"},{name:"start_date"}]},{name:"YEAR",description:"Returns the year from a date",args:[{name:"date"}]},{name:"MONTH",description:"Returns the month from a date (1-12)",args:[{name:"date"}]},{name:"DAY",description:"Returns the day of the month from a date (1-31)",args:[{name:"date"}]},{name:"HOUR",description:"Returns the hour from a date/time (0-23)",args:[{name:"time"}]},{name:"MINUTE",description:"Returns the minute from a date/time (0-59)",args:[{name:"time"}]},{name:"SECOND",description:"Returns the second from a date/time (0-59)",args:[{name:"time"}]},{name:"WEEKDAY",description:"Returns day of the week as a number",args:[{name:"date"},{name:"type",optional:!0}]},{name:"ISBLANK",description:"Checks whether a value is blank",args:[{name:"value"}]},{name:"ISNUMBER",description:"Checks whether a value is a number",args:[{name:"value"}]},{name:"ISTEXT",description:"Checks whether a value is text",args:[{name:"value"}]},{name:"ISERROR",description:"Checks whether a value is any error",args:[{name:"value"}]},{name:"ISERR",description:"Checks whether a value is an error except #N/A!",args:[{name:"value"}]},{name:"ISNA",description:"Checks whether a value is the #N/A! error",args:[{name:"value"}]},{name:"ISLOGICAL",description:"Checks whether a value is boolean",args:[{name:"value"}]},{name:"ISNONTEXT",description:"Checks whether a value is not text",args:[{name:"value"}]},{name:"IFERROR",description:"Returns a value if no error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_error"}]},{name:"IFNA",description:"Returns a value if no #N/A! error, otherwise returns an alternate value",args:[{name:"value"},{name:"value_if_na"}]},{name:"PI",description:"Returns the value of Pi",args:[]},{name:"SIGN",description:"Returns the sign of a number (-1, 0, or 1)",args:[{name:"number"}]},{name:"EVEN",description:"Rounds a number up to the nearest even integer",args:[{name:"number"}]},{name:"ODD",description:"Rounds a number up to the nearest odd integer",args:[{name:"number"}]},{name:"EXP",description:"Returns Euler's number raised to a power",args:[{name:"exponent"}]},{name:"LN",description:"Returns the natural logarithm of a number",args:[{name:"number"}]},{name:"LOG",description:"Returns the logarithm of a number given a base",args:[{name:"number"},{name:"base",optional:!0}]},{name:"SIN",description:"Returns the sine of an angle in radians",args:[{name:"angle"}]},{name:"COS",description:"Returns the cosine of an angle in radians",args:[{name:"angle"}]},{name:"TAN",description:"Returns the tangent of an angle in radians",args:[{name:"angle"}]},{name:"ASIN",description:"Returns the inverse sine of a value in radians",args:[{name:"value"}]},{name:"ACOS",description:"Returns the inverse cosine of a value in radians",args:[{name:"value"}]},{name:"ATAN",description:"Returns the inverse tangent of a value in radians",args:[{name:"value"}]},{name:"ATAN2",description:"Returns the angle between the x-axis and a point",args:[{name:"x"},{name:"y"}]},{name:"DEGREES",description:"Converts an angle from radians to degrees",args:[{name:"angle"}]},{name:"RADIANS",description:"Converts an angle from degrees to radians",args:[{name:"angle"}]},{name:"CEILING",description:"Rounds a number up to the nearest multiple of significance",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"FLOOR",description:"Rounds a number down to the nearest multiple of significance",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"TRUNC",description:"Truncates a number to a given number of decimal places",args:[{name:"number"},{name:"places",optional:!0}]},{name:"MROUND",description:"Rounds a number to the nearest specified multiple",args:[{name:"number"},{name:"multiple"}]},{name:"EXACT",description:"Tests whether two strings are identical (case-sensitive)",args:[{name:"text1"},{name:"text2"}]},{name:"REPLACE",description:"Replaces part of a text string with a different text string",args:[{name:"old_text"},{name:"start_num"},{name:"num_chars"},{name:"new_text"}]},{name:"REPT",description:"Repeats text a given number of times",args:[{name:"text"},{name:"number_times"}]},{name:"T",description:"Returns the text referred to by value",args:[{name:"value"}]},{name:"VALUE",description:"Converts a text string that represents a number to a number",args:[{name:"text"}]},{name:"TEXT",description:"Formats a number and converts it to text",args:[{name:"number"},{name:"format"}]},{name:"CHAR",description:"Returns the character specified by the code number",args:[{name:"number"}]},{name:"CODE",description:"Returns a numeric code for the first character in a text string",args:[{name:"text"}]},{name:"AVERAGEIF",description:"Returns the average of a range that meets a criterion",args:[{name:"criteria_range"},{name:"criterion"},{name:"average_range",optional:!0}]},{name:"AVERAGEIFS",description:"Returns the average of a range that meets multiple criteria",args:[{name:"average_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"LARGE",description:"Returns the nth largest value in a data set",args:[{name:"data"},{name:"n"}]},{name:"SMALL",description:"Returns the nth smallest value in a data set",args:[{name:"data"},{name:"n"}]},{name:"N",description:"Converts a value to a number",args:[{name:"value"}]},{name:"SUMPRODUCT",description:"Multiplies corresponding components and returns the sum",args:[{name:"array1"},{name:"array2",optional:!0,repeating:!0}]},{name:"GCD",description:"Returns the greatest common divisor",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"LCM",description:"Returns the least common multiple",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"COMBIN",description:"Returns the number of combinations for a given number of items",args:[{name:"n"},{name:"k"}]},{name:"FACT",description:"Returns the factorial of a number",args:[{name:"number"}]},{name:"QUOTIENT",description:"Returns the integer portion of a division",args:[{name:"numerator"},{name:"denominator"}]},{name:"XOR",description:"Returns TRUE if an odd number of arguments are TRUE",args:[{name:"logical1"},{name:"logical2",optional:!0,repeating:!0}]},{name:"CHOOSE",description:"Returns a value from a list based on index",args:[{name:"index"},{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"TYPE",description:"Returns a number indicating the data type of a value",args:[{name:"value"}]},{name:"EDATE",description:"Returns a date a specified number of months before or after another date",args:[{name:"start_date"},{name:"months"}]},{name:"EOMONTH",description:"Returns the last day of the month a specified number of months away",args:[{name:"start_date"},{name:"months"}]},{name:"NETWORKDAYS",description:"Returns the number of net working days between two dates",args:[{name:"start_date"},{name:"end_date"},{name:"holidays",optional:!0}]},{name:"DATEVALUE",description:"Converts a date string to a date value",args:[{name:"date_string"}]},{name:"TIMEVALUE",description:"Returns the fraction of the day a time represents",args:[{name:"time_string"}]},{name:"DATEDIF",description:"Calculates the number of days, months, or years between two dates",args:[{name:"start_date"},{name:"end_date"},{name:"unit"}]},{name:"ROW",description:"Returns the row number of a reference",args:[{name:"reference",optional:!0}]},{name:"COLUMN",description:"Returns the column number of a reference",args:[{name:"reference",optional:!0}]},{name:"ROWS",description:"Returns the number of rows in a range",args:[{name:"range"}]},{name:"COLUMNS",description:"Returns the number of columns in a range",args:[{name:"range"}]},{name:"ADDRESS",description:"Returns a cell reference as text given row and column numbers",args:[{name:"row"},{name:"column"},{name:"abs_num",optional:!0},{name:"a1",optional:!0}]},{name:"HYPERLINK",description:"Creates a hyperlink in a cell",args:[{name:"url"},{name:"link_label",optional:!0}]},{name:"MINIFS",description:"Returns the minimum value in a range that meets multiple criteria",args:[{name:"min_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"MAXIFS",description:"Returns the maximum value in a range that meets multiple criteria",args:[{name:"max_range"},{name:"criteria_range1"},{name:"criterion1"},{name:"criteria_range2",optional:!0,repeating:!0},{name:"criterion2",optional:!0,repeating:!0}]},{name:"RANK",description:"Returns the rank of a value within a data set",args:[{name:"value"},{name:"data"},{name:"order",optional:!0}]},{name:"PERCENTILE",description:"Returns the k-th percentile of a data set",args:[{name:"data"},{name:"k"}]},{name:"CLEAN",description:"Removes all non-printable characters from text",args:[{name:"text"}]},{name:"NUMBERVALUE",description:"Converts text to a number in a locale-independent way",args:[{name:"text"},{name:"decimal_separator",optional:!0},{name:"group_separator",optional:!0}]},{name:"STDEV",description:"Returns the sample standard deviation",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"STDEVP",description:"Returns the population standard deviation",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"VAR",description:"Returns the sample variance",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"VARP",description:"Returns the population variance",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"MODE",description:"Returns the most frequently occurring value",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"SUMSQ",description:"Returns the sum of the squares of the arguments",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"NA",description:"Returns the #N/A! error value",args:[]},{name:"QUARTILE",description:"Returns the quartile of a data set",args:[{name:"data"},{name:"quart"}]},{name:"COUNTUNIQUE",description:"Counts the number of unique values in a list",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"FIXED",description:"Formats a number with a fixed number of decimal places",args:[{name:"number"},{name:"decimals",optional:!0},{name:"no_commas",optional:!0}]},{name:"DOLLAR",description:"Formats a number as currency with a dollar sign",args:[{name:"number"},{name:"decimals",optional:!0}]},{name:"WEEKNUM",description:"Returns the week number of the year",args:[{name:"date"},{name:"type",optional:!0}]},{name:"ISOWEEKNUM",description:"Returns the ISO week number of the year",args:[{name:"date"}]},{name:"WORKDAY",description:"Returns a date that is a specified number of working days away",args:[{name:"start_date"},{name:"days"},{name:"holidays",optional:!0}]},{name:"YEARFRAC",description:"Returns the fraction of the year between two dates",args:[{name:"start_date"},{name:"end_date"},{name:"basis",optional:!0}]},{name:"LOOKUP",description:"Searches a sorted range for a key",args:[{name:"search_key"},{name:"search_range"},{name:"result_range",optional:!0}]},{name:"INDIRECT",description:"Returns the reference specified by a text string",args:[{name:"cell_reference"},{name:"is_A1_notation",optional:!0}]},{name:"ERROR.TYPE",description:"Returns a number corresponding to the error type",args:[{name:"value"}]},{name:"ISDATE",description:"Checks whether a value is a date",args:[{name:"value"}]},{name:"SPLIT",description:"Splits text around a delimiter",args:[{name:"text"},{name:"delimiter"},{name:"split_by_each",optional:!0},{name:"remove_empty",optional:!0}]},{name:"JOIN",description:"Joins values with a delimiter",args:[{name:"delimiter"},{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"REGEXMATCH",description:"Returns whether text matches a regular expression",args:[{name:"text"},{name:"regular_expression"}]},{name:"FORECAST",description:"Predicts a y-value for a given x using linear regression",args:[{name:"x"},{name:"known_ys"},{name:"known_xs"}]},{name:"SLOPE",description:"Returns the slope of the linear regression line",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"INTERCEPT",description:"Returns the y-intercept of the linear regression line",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"CORREL",description:"Returns the Pearson correlation coefficient",args:[{name:"data_y"},{name:"data_x"}]},{name:"XLOOKUP",description:"Searches a range for a match and returns a corresponding item",args:[{name:"search_key"},{name:"lookup_range"},{name:"return_range"},{name:"if_not_found",optional:!0},{name:"match_mode",optional:!0},{name:"search_mode",optional:!0}]},{name:"OFFSET",description:"Returns a reference offset from a starting reference",args:[{name:"reference"},{name:"rows"},{name:"cols"},{name:"height",optional:!0},{name:"width",optional:!0}]},{name:"ISEVEN",description:"Checks whether a number is even",args:[{name:"number"}]},{name:"ISODD",description:"Checks whether a number is odd",args:[{name:"number"}]},{name:"FACTDOUBLE",description:"Returns the double factorial of a number",args:[{name:"number"}]},{name:"BASE",description:"Converts a number to text in another base",args:[{name:"number"},{name:"base"},{name:"min_length",optional:!0}]},{name:"DECIMAL",description:"Converts text from another base to a decimal number",args:[{name:"text"},{name:"base"}]},{name:"SQRTPI",description:"Returns the square root of number * PI",args:[{name:"number"}]},{name:"SINH",description:"Returns the hyperbolic sine of a number",args:[{name:"number"}]},{name:"COSH",description:"Returns the hyperbolic cosine of a number",args:[{name:"number"}]},{name:"TANH",description:"Returns the hyperbolic tangent of a number",args:[{name:"number"}]},{name:"ASINH",description:"Returns the inverse hyperbolic sine of a number",args:[{name:"number"}]},{name:"ACOSH",description:"Returns the inverse hyperbolic cosine of a number",args:[{name:"number"}]},{name:"ATANH",description:"Returns the inverse hyperbolic tangent of a number",args:[{name:"number"}]},{name:"COT",description:"Returns the cotangent of an angle in radians",args:[{name:"angle"}]},{name:"CSC",description:"Returns the cosecant of an angle in radians",args:[{name:"angle"}]},{name:"SEC",description:"Returns the secant of an angle in radians",args:[{name:"angle"}]},{name:"REGEXEXTRACT",description:"Extracts matching substrings using a regular expression",args:[{name:"text"},{name:"regular_expression"}]},{name:"REGEXREPLACE",description:"Replaces text matching a regular expression",args:[{name:"text"},{name:"regular_expression"},{name:"replacement"}]},{name:"UNICODE",description:"Returns the Unicode code point of the first character",args:[{name:"text"}]},{name:"UNICHAR",description:"Returns the Unicode character for a code point",args:[{name:"number"}]},{name:"GEOMEAN",description:"Returns the geometric mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"HARMEAN",description:"Returns the harmonic mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"AVEDEV",description:"Returns the average absolute deviation from the mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"DEVSQ",description:"Returns the sum of squared deviations from the mean",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"TRIMMEAN",description:"Returns the mean of the interior portion of a data set",args:[{name:"data"},{name:"percent"}]},{name:"PERMUT",description:"Returns the number of permutations for a given number of objects",args:[{name:"n"},{name:"k"}]},{name:"PMT",description:"Returns the periodic payment for an annuity",args:[{name:"rate"},{name:"nper"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"FV",description:"Returns the future value of an investment",args:[{name:"rate"},{name:"nper"},{name:"pmt"},{name:"pv",optional:!0},{name:"type",optional:!0}]},{name:"PV",description:"Returns the present value of an investment",args:[{name:"rate"},{name:"nper"},{name:"pmt"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"NPV",description:"Returns the net present value of an investment",args:[{name:"rate"},{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"NPER",description:"Returns the number of periods for an investment",args:[{name:"rate"},{name:"pmt"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"IPMT",description:"Returns the interest portion of a payment",args:[{name:"rate"},{name:"period"},{name:"nper"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"PPMT",description:"Returns the principal portion of a payment",args:[{name:"rate"},{name:"period"},{name:"nper"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0}]},{name:"SLN",description:"Returns the straight-line depreciation of an asset",args:[{name:"cost"},{name:"salvage"},{name:"life"}]},{name:"EFFECT",description:"Returns the effective annual interest rate",args:[{name:"nominal_rate"},{name:"periods_per_year"}]},{name:"RATE",description:"Returns the interest rate per period of an annuity",args:[{name:"nper"},{name:"pmt"},{name:"pv"},{name:"fv",optional:!0},{name:"type",optional:!0},{name:"guess",optional:!0}]},{name:"IRR",description:"Returns the internal rate of return for a series of cash flows",args:[{name:"values"},{name:"guess",optional:!0}]},{name:"DB",description:"Returns the depreciation using the fixed-declining balance method",args:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"month",optional:!0}]},{name:"DDB",description:"Returns the depreciation using the double-declining balance method",args:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"},{name:"factor",optional:!0}]},{name:"NOMINAL",description:"Returns the nominal annual interest rate",args:[{name:"effective_rate"},{name:"periods_per_year"}]},{name:"CUMIPMT",description:"Returns the cumulative interest paid between two periods",args:[{name:"rate"},{name:"nper"},{name:"pv"},{name:"start_period"},{name:"end_period"},{name:"type"}]},{name:"CUMPRINC",description:"Returns the cumulative principal paid between two periods",args:[{name:"rate"},{name:"nper"},{name:"pv"},{name:"start_period"},{name:"end_period"},{name:"type"}]},{name:"AVERAGEA",description:"Returns the average, including text as 0 and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"MINA",description:"Returns the minimum value, including text as 0 and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"MAXA",description:"Returns the maximum value, including text as 0 and booleans",args:[{name:"value1"},{name:"value2",optional:!0,repeating:!0}]},{name:"FISHER",description:"Returns the Fisher transformation",args:[{name:"x"}]},{name:"FISHERINV",description:"Returns the inverse Fisher transformation",args:[{name:"y"}]},{name:"GAMMA",description:"Returns the gamma function value",args:[{name:"number"}]},{name:"GAMMALN",description:"Returns the natural log of the gamma function",args:[{name:"number"}]},{name:"NORMDIST",description:"Returns the normal distribution",args:[{name:"x"},{name:"mean"},{name:"stdev"},{name:"cumulative"}]},{name:"NORMINV",description:"Returns the inverse of the normal distribution",args:[{name:"probability"},{name:"mean"},{name:"stdev"}]},{name:"LOGNORMAL.DIST",description:"Returns the lognormal distribution",args:[{name:"x"},{name:"mean"},{name:"stdev"},{name:"cumulative"}]},{name:"LOGNORMAL.INV",description:"Returns the inverse of the lognormal distribution",args:[{name:"probability"},{name:"mean"},{name:"stdev"}]},{name:"STANDARDIZE",description:"Returns a normalized value (z-score)",args:[{name:"x"},{name:"mean"},{name:"stdev"}]},{name:"WEIBULL.DIST",description:"Returns the Weibull distribution",args:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"}]},{name:"POISSON.DIST",description:"Returns the Poisson distribution",args:[{name:"x"},{name:"mean"},{name:"cumulative"}]},{name:"BINOM.DIST",description:"Returns the binomial distribution probability",args:[{name:"successes"},{name:"trials"},{name:"probability"},{name:"cumulative"}]},{name:"EXPON.DIST",description:"Returns the exponential distribution",args:[{name:"x"},{name:"lambda"},{name:"cumulative"}]},{name:"CONFIDENCE.NORM",description:"Returns the confidence interval using normal distribution",args:[{name:"alpha"},{name:"stdev"},{name:"size"}]},{name:"CONFIDENCE.T",description:"Returns the confidence interval using t-distribution",args:[{name:"alpha"},{name:"stdev"},{name:"size"}]},{name:"CHISQ.DIST",description:"Returns the chi-squared distribution",args:[{name:"x"},{name:"degrees_freedom"},{name:"cumulative"}]},{name:"CHISQ.INV",description:"Returns the inverse of the chi-squared distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"T.DIST",description:"Returns the Student t-distribution",args:[{name:"x"},{name:"degrees_freedom"},{name:"cumulative"}]},{name:"T.INV",description:"Returns the inverse of the Student t-distribution",args:[{name:"probability"},{name:"degrees_freedom"}]},{name:"HYPGEOM.DIST",description:"Returns the hypergeometric distribution",args:[{name:"sample_s"},{name:"number_sample"},{name:"population_s"},{name:"number_pop"},{name:"cumulative"}]},{name:"NEGBINOM.DIST",description:"Returns the negative binomial distribution",args:[{name:"failures"},{name:"successes"},{name:"probability"},{name:"cumulative"}]},{name:"ARABIC",description:"Converts a Roman numeral to a number",args:[{name:"roman_numeral"}]},{name:"ROMAN",description:"Converts a number to Roman numeral text",args:[{name:"number"},{name:"form",optional:!0}]},{name:"MULTINOMIAL",description:"Returns the multinomial coefficient",args:[{name:"number1"},{name:"number2",optional:!0,repeating:!0}]},{name:"SERIESSUM",description:"Returns the sum of a power series",args:[{name:"x"},{name:"n"},{name:"m"},{name:"coefficients"}]},{name:"DELTA",description:"Tests whether two values are equal",args:[{name:"number1"},{name:"number2",optional:!0}]},{name:"GESTEP",description:"Tests whether a number is greater than or equal to a step value",args:[{name:"number"},{name:"step",optional:!0}]},{name:"ERF",description:"Returns the error function",args:[{name:"lower_limit"},{name:"upper_limit",optional:!0}]},{name:"ERFC",description:"Returns the complementary error function",args:[{name:"x"}]},{name:"XNPV",description:"Returns net present value for irregular cash flows",args:[{name:"rate"},{name:"values"},{name:"dates"}]},{name:"XIRR",description:"Returns internal rate of return for irregular cash flows",args:[{name:"values"},{name:"dates"},{name:"guess",optional:!0}]},{name:"SYD",description:"Returns the sum-of-years-digits depreciation",args:[{name:"cost"},{name:"salvage"},{name:"life"},{name:"period"}]},{name:"MIRR",description:"Returns the modified internal rate of return",args:[{name:"values"},{name:"finance_rate"},{name:"reinvest_rate"}]},{name:"TBILLEQ",description:"Returns the bond-equivalent yield for a T-bill",args:[{name:"settlement"},{name:"maturity"},{name:"discount"}]},{name:"TBILLPRICE",description:"Returns the price per $100 for a T-bill",args:[{name:"settlement"},{name:"maturity"},{name:"discount"}]},{name:"TBILLYIELD",description:"Returns the yield for a T-bill",args:[{name:"settlement"},{name:"maturity"},{name:"price"}]},{name:"DOLLARDE",description:"Converts a fractional dollar price to a decimal price",args:[{name:"fractional_dollar"},{name:"fraction"}]},{name:"DOLLARFR",description:"Converts a decimal dollar price to a fractional price",args:[{name:"decimal_dollar"},{name:"fraction"}]},{name:"ENCODEURL",description:"Encodes a string for use in a URL",args:[{name:"text"}]},{name:"ISURL",description:"Returns TRUE if a value is a valid URL",args:[{name:"value"}]},{name:"ISFORMULA",description:"Returns TRUE if a cell contains a formula",args:[{name:"cell"}]},{name:"FORMULATEXT",description:"Returns the formula of a cell as a string",args:[{name:"cell"}]},{name:"CEILING.MATH",description:"Rounds a number up to the nearest integer or multiple of significance",args:[{name:"number"},{name:"significance",optional:!0},{name:"mode",optional:!0}]},{name:"FLOOR.MATH",description:"Rounds a number down to the nearest integer or multiple of significance",args:[{name:"number"},{name:"significance",optional:!0},{name:"mode",optional:!0}]},{name:"CEILING.PRECISE",description:"Rounds a number up to the nearest multiple of significance, ignoring sign",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"FLOOR.PRECISE",description:"Rounds a number down to the nearest multiple of significance, ignoring sign",args:[{name:"number"},{name:"significance",optional:!0}]},{name:"COVAR",description:"Returns the population covariance of two datasets",args:[{name:"data_y"},{name:"data_x"}]},{name:"COVARIANCE.S",description:"Returns the sample covariance of two datasets",args:[{name:"data_y"},{name:"data_x"}]},{name:"RSQ",description:"Returns the R-squared value of a linear regression",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"STEYX",description:"Returns the standard error of the predicted y-value in a regression",args:[{name:"known_ys"},{name:"known_xs"}]},{name:"SUMX2MY2",description:"Returns the sum of differences of squares of corresponding values",args:[{name:"array_x"},{name:"array_y"}]},{name:"SUMX2PY2",description:"Returns the sum of sums of squares of corresponding values",args:[{name:"array_x"},{name:"array_y"}]},{name:"SUMXMY2",description:"Returns the sum of squares of differences of corresponding values",args:[{name:"array_x"},{name:"array_y"}]},{name:"PERCENTILE.EXC",description:"Returns the k-th percentile of values using exclusive interpolation",args:[{name:"data"},{name:"k"}]},{name:"QUARTILE.EXC",description:"Returns the exclusive quartile of a dataset",args:[{name:"data"},{name:"quart"}]},{name:"RANK.AVG",description:"Returns the rank of a value with average ranking for ties",args:[{name:"value"},{name:"data"},{name:"is_ascending",optional:!0}]},{name:"PERCENTRANK",description:"Returns the percentage rank of a value in a dataset (inclusive)",args:[{name:"data"},{name:"x"},{name:"significance",optional:!0}]},{name:"PERCENTRANK.EXC",description:"Returns the percentage rank of a value in a dataset (exclusive)",args:[{name:"data"},{name:"x"},{name:"significance",optional:!0}]},{name:"BETA.DIST",description:"Returns the beta distribution probability",args:[{name:"x"},{name:"alpha"},{name:"beta"},{name:"cumulative"},{name:"A",optional:!0},{name:"B",optional:!0}]},{name:"BETA.INV",description:"Returns the inverse of the beta cumulative distribution",args:[{name:"probability"},{name:"alpha"},{name:"beta"},{name:"A",optional:!0},{name:"B",optional:!0}]},{name:"F.DIST",description:"Returns the F probability distribution",args:[{name:"x"},{name:"deg_freedom1"},{name:"deg_freedom2"},{name:"cumulative"}]},{name:"F.INV",description:"Returns the inverse of the F probability distribution",args:[{name:"probability"},{name:"deg_freedom1"},{name:"deg_freedom2"}]}],Oa={Date:new Set(["TODAY","NOW","DATE","TIME","DAYS","YEAR","MONTH","DAY","HOUR","MINUTE","SECOND","WEEKDAY","EDATE","EOMONTH","NETWORKDAYS","DATEVALUE","TIMEVALUE","DATEDIF","WEEKNUM","ISOWEEKNUM","WORKDAY","YEARFRAC"]),Engineering:new Set(["DELTA","GESTEP","ERF","ERFC"]),Financial:new Set(["PMT","FV","PV","NPV","NPER","IPMT","PPMT","SLN","EFFECT","RATE","IRR","DB","DDB","NOMINAL","CUMIPMT","CUMPRINC","XNPV","XIRR","SYD","MIRR","TBILLEQ","TBILLPRICE","TBILLYIELD","DOLLARDE","DOLLARFR"]),Info:new Set(["ISBLANK","ISNUMBER","ISTEXT","ISERROR","ISERR","ISNA","ISLOGICAL","ISNONTEXT","ISURL","ISFORMULA","FORMULATEXT","N","TYPE","NA","ERROR.TYPE","ISDATE"]),Logical:new Set(["IF","IFS","SWITCH","AND","OR","NOT","IFERROR","IFNA","XOR","CHOOSE"]),Lookup:new Set(["MATCH","INDEX","VLOOKUP","HLOOKUP","ROW","COLUMN","ROWS","COLUMNS","ADDRESS","HYPERLINK","LOOKUP","INDIRECT","XLOOKUP","OFFSET"]),Math:new Set(["SUM","ABS","ROUND","ROUNDUP","ROUNDDOWN","INT","MOD","SQRT","POWER","PRODUCT","RAND","RANDBETWEEN","COUNTBLANK","COUNTIF","SUMIF","COUNTIFS","SUMIFS","PI","SIGN","EVEN","ODD","EXP","LN","LOG","SIN","COS","TAN","ASIN","ACOS","ATAN","ATAN2","DEGREES","RADIANS","CEILING","FLOOR","TRUNC","MROUND","SUMPRODUCT","GCD","LCM","COMBIN","FACT","QUOTIENT","SUMSQ","ISEVEN","ISODD","FACTDOUBLE","BASE","DECIMAL","SQRTPI","SINH","COSH","TANH","ASINH","ACOSH","ATANH","COT","CSC","SEC","ARABIC","ROMAN","MULTINOMIAL","SERIESSUM","CEILING.MATH","FLOOR.MATH","CEILING.PRECISE","FLOOR.PRECISE","SUMX2MY2","SUMX2PY2","SUMXMY2"]),Statistical:new Set(["AVERAGE","MIN","MAX","COUNT","COUNTA","MEDIAN","AVERAGEIF","AVERAGEIFS","LARGE","SMALL","MINIFS","MAXIFS","RANK","PERCENTILE","STDEV","STDEVP","VAR","VARP","MODE","QUARTILE","COUNTUNIQUE","FORECAST","SLOPE","INTERCEPT","CORREL","GEOMEAN","HARMEAN","AVEDEV","DEVSQ","TRIMMEAN","PERMUT","AVERAGEA","MINA","MAXA","FISHER","FISHERINV","GAMMA","GAMMALN","NORMDIST","NORMINV","LOGNORMAL.DIST","LOGNORMAL.INV","STANDARDIZE","WEIBULL.DIST","POISSON.DIST","BINOM.DIST","EXPON.DIST","CONFIDENCE.NORM","CONFIDENCE.T","CHISQ.DIST","CHISQ.INV","T.DIST","T.INV","HYPGEOM.DIST","NEGBINOM.DIST","COVAR","COVARIANCE.S","RSQ","STEYX","PERCENTILE.EXC","QUARTILE.EXC","RANK.AVG","PERCENTRANK","PERCENTRANK.EXC","BETA.DIST","BETA.INV","F.DIST","F.INV"]),Text:new Set(["TRIM","LEN","LEFT","RIGHT","MID","CONCATENATE","CONCAT","FIND","SEARCH","TEXTJOIN","LOWER","UPPER","PROPER","SUBSTITUTE","EXACT","REPLACE","REPT","T","VALUE","TEXT","CHAR","CODE","CLEAN","NUMBERVALUE","FIXED","DOLLAR","SPLIT","JOIN","REGEXMATCH","REGEXEXTRACT","REGEXREPLACE","UNICODE","UNICHAR","ENCODEURL"])};function ya(u){var n;for(const r of ke)if((n=Oa[r])!=null&&n.has(u))return r;throw new Error(`Missing Sheets category for function: ${u}`)}const fe=Va.map(u=>({...u,category:ya(u.name)}));function qa(u=fe){const n=new Set(u.map(r=>r.category));return ke.filter(r=>n.has(r))}function Ka(u){const n=u.toUpperCase();return fe.filter(r=>r.name.startsWith(n))}function Wa(u){const n=u.toUpperCase();return fe.find(r=>r.name===n)}function $a(u){const n=u.args.map(r=>{let a=r.optional?`[${r.name}]`:r.name;return r.repeating&&(a+=", ..."),a});return`${u.name}(${n.join(", ")})`}export{fe as F,ke as S,Xa as a,Ba as b,$a as c,Ya as d,ie as e,Wa as f,Ha as g,Ga as i,qa as l,_a as n,Ka as s};
