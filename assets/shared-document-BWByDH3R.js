import{d as u,r as n,j as e,e as c,b as x,y as d,f}from"./index-1gnYbMGL.js";import{r as h,i as p}from"./worksheet-BmH_U5en.js";import{S as j}from"./sheet-view-DXNpaeZ-.js";import"./use-mobile-sheet-gestures-CKFPzk2h.js";import"./IconDotsVertical-KDTGp0Fg.js";import"./dropdown-menu-Cm0XLNQJ.js";import"./index-Bkwsx0hP.js";import"./index-D4xK6nGZ.js";import"./index-CI-R76lv.js";function b({resolved:s}){const t=s.role==="viewer",{doc:r}=d.useDocument();if(!r)return e.jsx(c,{});const a=r.getRoot(),o=a.tabOrder&&a.tabOrder.length>0?a.tabOrder[0]:"tab-1";return e.jsxs("div",{className:"flex h-screen w-full flex-col",children:[e.jsxs("header",{className:"flex h-14 shrink-0 items-center gap-2 border-b px-4",children:[e.jsx("h1",{className:"text-base font-medium",children:s.title}),t&&e.jsx("span",{className:"rounded bg-muted px-2 py-0.5 text-xs text-muted-foreground",children:"View only"})]}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx(j,{tabId:o,readOnly:t})})]})}function y({resolved:s}){const{data:t}=x({queryKey:["me"],queryFn:f,retry:!1}),r={username:(t==null?void 0:t.username)||"Anonymous",email:(t==null?void 0:t.email)||"",photo:(t==null?void 0:t.photo)||""};return e.jsx(d.YorkieProvider,{apiKey:"fbuqYRxotajGGzb3kUD6aX",metadata:{userID:r.username},children:e.jsx(d.DocumentProvider,{docKey:`sheet-${s.documentId}`,initialRoot:p,initialPresence:r,enableDevtools:!1,children:e.jsx(b,{resolved:s})})})}function E(){const{token:s}=u(),[t,r]=n.useState(null),[a,o]=n.useState(null),[m,i]=n.useState(!0);return n.useEffect(()=>{if(!s){o("No share token provided"),i(!1);return}h(s).then(l=>{r(l),i(!1)}).catch(l=>{o(l.message||"Invalid or expired link"),i(!1)})},[s]),m?e.jsx(c,{}):a||!t?e.jsx("div",{className:"flex h-screen w-full items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Link unavailable"}),e.jsx("p",{className:"text-muted-foreground",children:a||"Invalid or expired link"})]})}):e.jsx(y,{resolved:t})}export{E as SharedDocument,E as default};
