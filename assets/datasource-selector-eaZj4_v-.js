import{r as s,j as e}from"./index-Be86izrq.js";import{D as g,a as D,b as N,c as b,d as S}from"./dialog-27lC9Uj_.js";import{B as x}from"./button-EK1VOglo.js";import{L as C}from"./label-MarD7BxX.js";import{f}from"./datasources-86NudJhE.js";import{D as v}from"./datasource-dialog-oAQINJVg.js";import{c as y}from"./index-3cL1CT6c.js";import{I as w}from"./site-header-Bc-7Uk9x.js";import{I}from"./document-detail-C0RWY34q.js";import"./index-DF_D7c3F.js";import"./index-CGFVQLu4.js";import"./dropdown-menu-CrG1Wdzl.js";import"./index-Bo56FxG0.js";import"./input-BUf8wpFL.js";import"./switch-CCYwfAFZ.js";import"./index-CM2Hds3L.js";import"./IconDotsVertical-JA2D39GJ.js";import"./grid-2x2-plus-BI6S8LTV.js";import"./documents-9f-z2BRb.js";import"./select-mYCnb76g.js";import"./worksheet-CP-ItPiy.js";import"./IconTrash-Bxesv3TM.js";function Z({open:r,onOpenChange:a,onSelect:o}){const[i,c]=s.useState([]),[u,m]=s.useState(!1),[d,n]=s.useState(!1),[l,p]=s.useState(null);s.useEffect(()=>{r&&(m(!0),f().then(c).catch(()=>c([])).finally(()=>m(!1)))},[r]);const h=()=>{const t=i.find(j=>j.id===l);t&&(o(t),a(!1))};return e.jsxs(e.Fragment,{children:[e.jsx(g,{open:r&&!d,onOpenChange:a,children:e.jsxs(D,{className:"sm:max-w-sm",children:[e.jsxs(N,{children:[e.jsx(b,{children:"Select DataSource"}),e.jsx(S,{children:"Choose an existing connection or create a new one."})]}),e.jsx("div",{className:"grid gap-4 py-2",children:u?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"Loading..."}):i.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"No datasources yet. Create one to get started."}):e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{children:"Connections"}),e.jsx("div",{className:"flex flex-col gap-1 max-h-60 overflow-y-auto",children:i.map(t=>e.jsxs("button",{className:y("flex items-center gap-2 px-3 py-2 rounded-md border text-sm text-left cursor-pointer","hover:bg-muted/50 transition-colors",l===t.id&&"bg-muted border-primary"),onClick:()=>p(t.id),onDoubleClick:()=>{o(t),a(!1)},children:[e.jsx(w,{className:"size-4 text-muted-foreground shrink-0"}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"font-medium truncate",children:t.name}),e.jsxs("span",{className:"text-xs text-muted-foreground truncate",children:[t.host,":",t.port,"/",t.database]})]})]},t.id))})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(x,{variant:"outline",onClick:()=>n(!0),children:[e.jsx(I,{className:"size-4"}),"New Connection"]}),e.jsx(x,{disabled:!l,onClick:h,children:"Select"})]})]})}),e.jsx(v,{open:d,onOpenChange:t=>{n(t),t||f().then(c).catch(()=>{})},onCreated:t=>{o(t),a(!1),n(!1)}})]})}export{Z as DataSourceSelector};
