import{j as e,r as c}from"./vendor-react-Bg6UneQK.js";import{B as z}from"./badge-D_FUDBc2.js";import{B as m}from"./button-DWQ-sR7I.js";import{c as o}from"./utils-DjqsqOe8.js";import{I as x}from"./input-BEpJFSyN.js";import{L as p}from"./label-CmhopHze.js";import{T as E,a as k,b as C,c as f,d as R,e as g}from"./table-BcaU83pl.js";import{j as M,k as F,l as T,m as V}from"./vendor-ui-DUghwSYy.js";import"./sheet-formula-parser-CbheDyXI.js";import"./sheet-formula-eval-0HEooW9a.js";import{M as v,f as G}from"./sheet-core-Bt70Yhok.js";import"./index-3UDGtr2f.js";function b({className:t,...a}){return e.jsx("div",{"data-slot":"card",className:o("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function w({className:t,...a}){return e.jsx("div",{"data-slot":"card-header",className:o("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function j({className:t,...a}){return e.jsx("div",{"data-slot":"card-title",className:o("leading-none font-semibold",t),...a})}function y({className:t,...a}){return e.jsx("div",{"data-slot":"card-description",className:o("text-muted-foreground text-sm",t),...a})}function S({className:t,...a}){return e.jsx("div",{"data-slot":"card-content",className:o("px-6",t),...a})}function I({className:t,...a}){return e.jsx(M,{"data-slot":"tabs",className:o("flex flex-col gap-2",t),...a})}function H({className:t,...a}){return e.jsx(F,{"data-slot":"tabs-list",className:o("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...a})}function A({className:t,...a}){return e.jsx(T,{"data-slot":"tabs-trigger",className:o("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...a})}function B({className:t,...a}){return e.jsx(V,{"data-slot":"tabs-content",className:o("flex-1 outline-none",t),...a})}async function L(){const t=new Map([["A1",{v:"Region"}],["B1",{v:"Jan"}],["C1",{v:"Feb"}],["D1",{v:"Mar"}],["E1",{v:"Apr"}],["F1",{v:"May"}],["G1",{v:"Jun"}],["H1",{v:"Total"}],["A2",{v:"Seoul"}],["B2",{v:"120"}],["C2",{v:"140"}],["D2",{v:"135"}],["E2",{v:"150"}],["F2",{v:"148"}],["G2",{v:"160"}],["H2",{f:"=SUM(B2:G2)"}],["A3",{v:"Busan"}],["B3",{v:"95"}],["C3",{v:"102"}],["D3",{v:"110"}],["E3",{v:"107"}],["F3",{v:"112"}],["G3",{v:"109"}],["H3",{f:"=SUM(B3:G3)"}],["A4",{v:"Incheon"}],["B4",{v:"88"}],["C4",{v:"91"}],["D4",{v:"95"}],["E4",{v:"98"}],["F4",{v:"101"}],["G4",{v:"105"}],["H4",{f:"=SUM(B4:G4)"}],["A5",{v:"Daegu"}],["B5",{v:"70"}],["C5",{v:"76"}],["D5",{v:"81"}],["E5",{v:"78"}],["F5",{v:"84"}],["G5",{v:"86"}],["H5",{f:"=SUM(B5:G5)"}],["A6",{v:"Gwangju"}],["B6",{v:"65"}],["C6",{v:"69"}],["D6",{v:"74"}],["E6",{v:"77"}],["F6",{v:"79"}],["G6",{v:"82"}],["H6",{f:"=SUM(B6:G6)"}],["A7",{v:"Daejeon"}],["B7",{v:"58"}],["C7",{v:"62"}],["D7",{v:"67"}],["E7",{v:"70"}],["F7",{v:"71"}],["G7",{v:"73"}],["H7",{f:"=SUM(B7:G7)"}],["A8",{v:"Ulsan"}],["B8",{v:"55"}],["C8",{v:"58"}],["D8",{v:"63"}],["E8",{v:"66"}],["F8",{v:"68"}],["G8",{v:"72"}],["H8",{f:"=SUM(B8:G8)"}],["A9",{v:"Jeju"}],["B9",{v:"41"}],["C9",{v:"45"}],["D9",{v:"48"}],["E9",{v:"52"}],["F9",{v:"57"}],["G9",{v:"60"}],["H9",{f:"=SUM(B9:G9)"}]]),a=new v(t);return await a.setFreezePane(1,1),await a.addRangeStyle({range:[{r:1,c:1},{r:1,c:8}],style:{b:!0,bg:"#f1f5f9",al:"center"}}),await a.addRangeStyle({range:[{r:2,c:8},{r:9,c:8}],style:{b:!0,bg:"#eff6ff"}}),{store:a,afterInitialize:async s=>{await s.focusCell({r:8,c:8})}}}async function O(){const t=new Map([["A1",{v:"Case"}],["B1",{v:"Cell B"}],["C1",{v:"Cell C"}],["D1",{v:"Cell D"}],["A2",{v:"Overflow"}],["B2",{v:"Long text should overflow into empty neighboring cells for readability."}],["A3",{v:"Clipped"}],["B3",{v:"This line should clip because C3 contains data and blocks overflow rendering."}],["C3",{v:"BLOCK"}],["A4",{v:"Merged-look"}],["B4",{v:"Header-like band with borders"}],["C4",{v:""}],["D4",{v:""}]]),a=new v(t);return await a.setDimensionSize("column",1,110),await a.setDimensionSize("column",2,170),await a.setDimensionSize("column",3,110),await a.setDimensionSize("column",4,110),await a.addRangeStyle({range:[{r:1,c:1},{r:1,c:4}],style:{b:!0,bg:"#f8fafc"}}),await a.addRangeStyle({range:[{r:3,c:3},{r:3,c:3}],style:{b:!0,bg:"#fee2e2",tc:"#7f1d1d",al:"center"}}),await a.addRangeStyle({range:[{r:4,c:2},{r:4,c:4}],style:{b:!0,bg:"#ecfeff",bt:!0,bb:!0,bl:!0,br:!0}}),{store:a,afterInitialize:async s=>{await s.focusCell({r:2,c:2})}}}async function U(){const t=new Map([["A1",{v:"Metric"}],["B1",{v:"Q1"}],["C1",{v:"Q2"}],["D1",{v:"Q3"}],["E1",{v:"Q4"}],["A2",{v:"Revenue"}],["B2",{v:`Q1 TOTAL
$1,240,000`}],["E2",{v:"$340k"}],["A3",{v:"Growth"}],["E3",{v:"+14%"}],["A4",{v:"Cost"}],["B4",{v:"$180k"}],["C4",{v:"$175k"}],["D4",{v:"$190k"}],["E4",{v:"$200k"}]]),a=new v(t);return await a.setMerge({r:2,c:2},{rs:2,cs:3}),await a.setDimensionSize("column",1,120),await a.setDimensionSize("column",2,140),await a.setDimensionSize("column",3,120),await a.setDimensionSize("column",4,120),await a.setDimensionSize("column",5,120),await a.setDimensionSize("row",2,44),await a.setDimensionSize("row",3,44),await a.addRangeStyle({range:[{r:1,c:1},{r:1,c:5}],style:{b:!0,bg:"#f8fafc",al:"center"}}),await a.addRangeStyle({range:[{r:2,c:2},{r:2,c:2}],style:{b:!0,bg:"#e0f2fe",al:"center",va:"middle"}}),{store:a,afterInitialize:async s=>{await s.focusCell({r:2,c:2})}}}async function P(){const t=new Map([["A1",{v:"Formula"}],["B1",{v:"Rendered Value"}],["A2",{v:"=MOD(10,0)"}],["B2",{f:"=MOD(10,0)"}],["A3",{v:"=INDEX(A1:A2,3,1)"}],["B3",{f:"=INDEX(A1:A2,3,1)"}],["A4",{v:"=1+"}],["B4",{f:"=1+"}],["A5",{v:"=IFS(FALSE,1)"}],["B5",{f:"=IFS(FALSE,1)"}],["A6",{v:'=VLOOKUP("x",A1:B2,3,FALSE)'}],["B6",{f:'=VLOOKUP("x",A1:B2,3,FALSE)'}]]),a=new v(t);return await a.setDimensionSize("column",1,260),await a.setDimensionSize("column",2,170),await a.addRangeStyle({range:[{r:1,c:1},{r:1,c:2}],style:{b:!0,bg:"#f8fafc"}}),{store:a,afterInitialize:async s=>{await s.focusCell({r:4,c:2})}}}async function $(){const t=new Map([["A1",{v:"Task"}],["B1",{v:"Owner"}],["C1",{v:"ETA"}],["D1",{v:"Notes"}],["A2",{v:"Chunk gate cleanup"}],["B2",{v:"alice"}],["C2",{v:"2d"}],["D2",{v:"High priority and needs wider note column"}],["A3",{v:"Visual browser lane"}],["B3",{v:"bruno"}],["C3",{v:"1d"}],["D3",{v:"Snapshot drift triage"}],["A4",{v:"Integration docker"}],["B4",{v:"chloe"}],["C4",{v:"3d"}],["D4",{v:"Interruption-safe cleanup"}],["A5",{v:"PR evidence"}],["B5",{v:"derek"}],["C5",{v:"1d"}],["D5",{v:"Auto-link lane reports"}],["A6",{v:"Smoke suite"}],["B6",{v:"ella"}],["C6",{v:"2d"}],["D6",{v:"Refresh-auth + API error cases"}],["A7",{v:"Docs sync"}],["B7",{v:"frank"}],["C7",{v:"1d"}],["D7",{v:"README + CLAUDE update"}],["A8",{v:"CI hardening"}],["B8",{v:"grace"}],["C8",{v:"2d"}],["D8",{v:"Add retry on flaky service boot"}]]),a=new v(t);return await a.setFreezePane(2,0),await a.setDimensionSize("column",1,190),await a.setDimensionSize("column",2,130),await a.setDimensionSize("column",3,72),await a.setDimensionSize("column",4,280),await a.setDimensionSize("row",2,44),await a.setDimensionSize("row",4,52),await a.setDimensionSize("row",8,40),await a.addRangeStyle({range:[{r:1,c:1},{r:1,c:4}],style:{b:!0,bg:"#f1f5f9",al:"center"}}),{store:a,afterInitialize:async s=>{await s.focusCell({r:8,c:4})}}}const h=[{id:"sheet-freeze-selection",title:"Freeze + Selection",description:"Verifies frozen row/column panes and scrolled selection cell overlay via baseline snapshot.",setup:L},{id:"sheet-overflow-clip",title:"Text Overflow + Clip",description:"Verifies text overflow and clipping regression based on neighboring cell data.",setup:O},{id:"sheet-merge-layout",title:"Merge Layout",description:"Verifies merged cell rendering (background, alignment, borders, selection box) consistency.",setup:U},{id:"sheet-formula-errors",title:"Formula Errors",description:"Verifies rendering regression of #VALUE!, #REF!, #ERROR!, and #N/A! error displays.",setup:P},{id:"sheet-dimensions-freeze",title:"Custom Dimensions",description:"Verifies layout regression of custom row/column sizes with top freeze pane.",setup:$}];function Q({scenario:t,onReadyChange:a}){const s=c.useRef(null),[n,r]=c.useState("loading");return c.useEffect(()=>{a(t.id,n==="ready")},[a,t.id,n]),c.useEffect(()=>{let l=!0,i;const u=s.current;async function N(){var D;if(u){r("loading"),u.innerHTML="";try{const d=await t.setup();if(!l)return;i=await G(u,{theme:"light",store:d.store,readOnly:!0}),await((D=d.afterInitialize)==null?void 0:D.call(d,i)),l&&r("ready")}catch(d){console.error(`[visual-harness] failed to set up scenario ${t.id}`,d),l&&r("error")}}}return N(),()=>{l=!1,i==null||i.cleanup(),u&&(u.innerHTML="")}},[t]),e.jsxs(b,{"data-visual-scenario-id":t.id,"data-visual-scenario-ready":n==="ready"?"true":"false","data-visual-scenario-state":n,className:"border-border/80",children:[e.jsxs(w,{className:"space-y-1",children:[e.jsx(j,{className:"text-base",children:t.title}),e.jsx(y,{children:t.description})]}),e.jsxs(S,{className:"space-y-2",children:[e.jsx("div",{className:"rounded-md border bg-background p-2",children:e.jsx("div",{className:"h-[320px] w-full overflow-hidden rounded-sm bg-white",ref:s})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n==="ready"&&"Scenario ready",n==="loading"&&"Rendering scenario...",n==="error"&&"Failed to render scenario"]})]})]})}function _(){const[t,a]=c.useState(()=>Object.fromEntries(h.map(r=>[r.id,!1]))),s=c.useCallback((r,l)=>{a(i=>i[r]===l?i:{...i,[r]:l})},[]),n=c.useMemo(()=>h.every(r=>t[r.id]===!0),[t]);return e.jsxs("section",{className:"space-y-4","data-testid":"visual-harness-sheet-section","data-visual-sheet-ready":n?"true":"false",children:[e.jsxs("header",{className:"space-y-1",children:[e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Spreadsheet Engine Visual Scenarios"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Validates core rendering states of the canvas-based spreadsheet against browser baselines."})]}),e.jsx("div",{className:"grid gap-4 xl:grid-cols-2",children:h.map(r=>e.jsx(Q,{onReadyChange:s,scenario:r},r.id))})]})}const W=[{id:"doc-001",title:"Q1 Revenue Plan",owner:"alice",updatedAt:"2026-02-20 09:31",status:"stable"},{id:"doc-002",title:"Supply Chain Tracker",owner:"bruno",updatedAt:"2026-02-21 14:04",status:"review"},{id:"doc-003",title:"Retention Experiments",owner:"chloe",updatedAt:"2026-02-22 18:12",status:"stable"}];function J(t){return t==="stable"?"default":"secondary"}function oe(){return e.jsx("main",{className:"min-h-screen bg-muted/20 p-6 md:p-10","data-testid":"visual-harness-root",children:e.jsxs("div",{className:"mx-auto flex w-full max-w-6xl flex-col gap-6",children:[e.jsx("header",{className:"rounded-xl border bg-card p-5 shadow-sm",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Wafflebase Harness"}),e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Frontend Visual Regression Baseline"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"outline",children:"Export"}),e.jsx(m,{children:"Create Document"})]})]})}),e.jsxs(I,{className:"gap-4",defaultValue:"documents",children:[e.jsxs(H,{children:[e.jsx(A,{value:"documents",children:"Documents"}),e.jsx(A,{value:"settings",children:"Settings"})]}),e.jsx(B,{value:"documents",children:e.jsxs(b,{children:[e.jsxs(w,{children:[e.jsx(j,{children:"Document Overview"}),e.jsx(y,{children:"Stable sample data used to detect visual regressions."})]}),e.jsx(S,{className:"space-y-4",children:e.jsxs(E,{children:[e.jsx(k,{children:e.jsxs(C,{children:[e.jsx(f,{children:"Title"}),e.jsx(f,{children:"Owner"}),e.jsx(f,{children:"Updated"}),e.jsx(f,{children:"Status"})]})}),e.jsx(R,{children:W.map(t=>e.jsxs(C,{children:[e.jsx(g,{className:"font-medium",children:t.title}),e.jsx(g,{children:t.owner}),e.jsx(g,{children:t.updatedAt}),e.jsx(g,{children:e.jsx(z,{variant:J(t.status),children:t.status})})]},t.id))})]})})]})}),e.jsx(B,{value:"settings",children:e.jsxs(b,{children:[e.jsxs(w,{children:[e.jsx(j,{children:"Workspace Preferences"}),e.jsx(y,{children:"Input controls are included for style and spacing coverage."})]}),e.jsxs(S,{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"workspace-name",children:"Workspace Name"}),e.jsx(x,{defaultValue:"Wafflebase Team",id:"workspace-name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"timezone",children:"Time Zone"}),e.jsx(x,{defaultValue:"UTC+09:00 (Asia/Seoul)",id:"timezone"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"currency",children:"Default Currency"}),e.jsx(x,{defaultValue:"USD",id:"currency"})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(m,{variant:"outline",children:"Discard"}),e.jsx(m,{children:"Save Changes"})]})]})]})})]}),e.jsx(_,{})]})})}export{oe as default};
