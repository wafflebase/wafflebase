const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chart-object-layer-BHAQAai-.js","assets/index-Be86izrq.js","assets/index-J8kVSbPG.css","assets/use-mobile-sheet-gestures-C4icGIwp.js","assets/IconDotsVertical-JA2D39GJ.js","assets/dropdown-menu-CrG1Wdzl.js","assets/index-CGFVQLu4.js","assets/index-3cL1CT6c.js","assets/IconTrash-Bxesv3TM.js","assets/index-Bo56FxG0.js","assets/chart-editor-panel-C5Z1dJYj.js","assets/button-EK1VOglo.js","assets/index-CM2Hds3L.js","assets/select-mYCnb76g.js","assets/input-BUf8wpFL.js","assets/label-MarD7BxX.js"])))=>i.map(i=>d[i]);
var dt=Object.defineProperty;var ut=(l,t,s)=>t in l?dt(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s;var H=(l,t,s)=>ut(l,typeof t!="symbol"?t+"":t,s);import{r as f,j as e,x as ft,y as gt,t as ve,e as mt,_ as nt}from"./index-Be86izrq.js";import{b as Ee,C as yt,p as B,t as w,f as vt,a as pe,e as xe,i as be,n as _e,c as Z,s as Ke,d as pt,g as xt,h as bt,m as Le,j as jt,r as Ve,k as kt,l as Ct,u as Mt,o as St}from"./use-mobile-sheet-gestures-C4icGIwp.js";import{a as wt}from"./index-CGFVQLu4.js";import{f as It,P as zt,D as G,a as X,b as Y,e as Q,d as K,c as y,p as le}from"./dropdown-menu-CrG1Wdzl.js";import{c as Nt}from"./index-Bo56FxG0.js";import{c as Ot}from"./index-3cL1CT6c.js";import{c as j,u as Rt,a as N,b as O,d as R,S as ee,I as At}from"./IconDotsVertical-JA2D39GJ.js";/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ce=j("outline","abc","IconAbc",[["path",{d:"M3 16v-6a2 2 0 1 1 4 0v6",key:"svg-0"}],["path",{d:"M3 13h4",key:"svg-1"}],["path",{d:"M10 8v6a2 2 0 1 0 4 0v-1a2 2 0 1 0 -4 0v1",key:"svg-2"}],["path",{d:"M20.732 12a2 2 0 0 0 -3.732 1v1a2 2 0 0 0 3.726 1.01",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Me=j("outline","align-box-bottom-center","IconAlignBoxBottomCenter",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 15v2",key:"svg-1"}],["path",{d:"M12 11v6",key:"svg-2"}],["path",{d:"M15 13v4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Se=j("outline","align-box-center-middle","IconAlignBoxCenterMiddle",[["path",{d:"M3 19v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M11 15h2",key:"svg-1"}],["path",{d:"M9 12h6",key:"svg-2"}],["path",{d:"M10 9h4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var we=j("outline","align-box-top-center","IconAlignBoxTopCenter",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 9v-2",key:"svg-1"}],["path",{d:"M12 13v-6",key:"svg-2"}],["path",{d:"M15 11v-4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ie=j("outline","align-center","IconAlignCenter",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M8 12l8 0",key:"svg-1"}],["path",{d:"M6 18l12 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ze=j("outline","align-left","IconAlignLeft",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M4 12l10 0",key:"svg-1"}],["path",{d:"M4 18l14 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ne=j("outline","align-right","IconAlignRight",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M10 12l10 0",key:"svg-1"}],["path",{d:"M6 18l14 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ft=j("outline","arrow-back-up","IconArrowBackUp",[["path",{d:"M9 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M5 10h11a4 4 0 1 1 0 8h-1",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Tt=j("outline","arrow-forward-up","IconArrowForwardUp",[["path",{d:"M15 14l4 -4l-4 -4",key:"svg-0"}],["path",{d:"M19 10h-11a4 4 0 1 0 0 8h1",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Bt=j("outline","bold","IconBold",[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var je=j("outline","border-all","IconBorderAll",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M4 12l16 0",key:"svg-1"}],["path",{d:"M12 4l0 16",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ue=j("outline","border-bottom","IconBorderBottom",[["path",{d:"M20 20l-16 0",key:"svg-0"}],["path",{d:"M4 4l0 .01",key:"svg-1"}],["path",{d:"M8 4l0 .01",key:"svg-2"}],["path",{d:"M12 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M20 4l0 .01",key:"svg-5"}],["path",{d:"M4 8l0 .01",key:"svg-6"}],["path",{d:"M12 8l0 .01",key:"svg-7"}],["path",{d:"M20 8l0 .01",key:"svg-8"}],["path",{d:"M4 12l0 .01",key:"svg-9"}],["path",{d:"M8 12l0 .01",key:"svg-10"}],["path",{d:"M12 12l0 .01",key:"svg-11"}],["path",{d:"M16 12l0 .01",key:"svg-12"}],["path",{d:"M20 12l0 .01",key:"svg-13"}],["path",{d:"M4 16l0 .01",key:"svg-14"}],["path",{d:"M12 16l0 .01",key:"svg-15"}],["path",{d:"M20 16l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var $e=j("outline","border-inner","IconBorderInner",[["path",{d:"M4 12l16 0",key:"svg-0"}],["path",{d:"M12 4l0 16",key:"svg-1"}],["path",{d:"M4 4l0 .01",key:"svg-2"}],["path",{d:"M8 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M20 4l0 .01",key:"svg-5"}],["path",{d:"M4 8l0 .01",key:"svg-6"}],["path",{d:"M20 8l0 .01",key:"svg-7"}],["path",{d:"M4 16l0 .01",key:"svg-8"}],["path",{d:"M20 16l0 .01",key:"svg-9"}],["path",{d:"M4 20l0 .01",key:"svg-10"}],["path",{d:"M8 20l0 .01",key:"svg-11"}],["path",{d:"M16 20l0 .01",key:"svg-12"}],["path",{d:"M20 20l0 .01",key:"svg-13"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var We=j("outline","border-left","IconBorderLeft",[["path",{d:"M4 20l0 -16",key:"svg-0"}],["path",{d:"M8 4l0 .01",key:"svg-1"}],["path",{d:"M12 4l0 .01",key:"svg-2"}],["path",{d:"M16 4l0 .01",key:"svg-3"}],["path",{d:"M20 4l0 .01",key:"svg-4"}],["path",{d:"M12 8l0 .01",key:"svg-5"}],["path",{d:"M20 8l0 .01",key:"svg-6"}],["path",{d:"M8 12l0 .01",key:"svg-7"}],["path",{d:"M12 12l0 .01",key:"svg-8"}],["path",{d:"M16 12l0 .01",key:"svg-9"}],["path",{d:"M20 12l0 .01",key:"svg-10"}],["path",{d:"M12 16l0 .01",key:"svg-11"}],["path",{d:"M20 16l0 .01",key:"svg-12"}],["path",{d:"M8 20l0 .01",key:"svg-13"}],["path",{d:"M12 20l0 .01",key:"svg-14"}],["path",{d:"M16 20l0 .01",key:"svg-15"}],["path",{d:"M20 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var He=j("outline","border-none","IconBorderNone",[["path",{d:"M4 4l0 .01",key:"svg-0"}],["path",{d:"M8 4l0 .01",key:"svg-1"}],["path",{d:"M12 4l0 .01",key:"svg-2"}],["path",{d:"M16 4l0 .01",key:"svg-3"}],["path",{d:"M20 4l0 .01",key:"svg-4"}],["path",{d:"M4 8l0 .01",key:"svg-5"}],["path",{d:"M12 8l0 .01",key:"svg-6"}],["path",{d:"M20 8l0 .01",key:"svg-7"}],["path",{d:"M4 12l0 .01",key:"svg-8"}],["path",{d:"M8 12l0 .01",key:"svg-9"}],["path",{d:"M12 12l0 .01",key:"svg-10"}],["path",{d:"M16 12l0 .01",key:"svg-11"}],["path",{d:"M20 12l0 .01",key:"svg-12"}],["path",{d:"M4 16l0 .01",key:"svg-13"}],["path",{d:"M12 16l0 .01",key:"svg-14"}],["path",{d:"M20 16l0 .01",key:"svg-15"}],["path",{d:"M4 20l0 .01",key:"svg-16"}],["path",{d:"M8 20l0 .01",key:"svg-17"}],["path",{d:"M12 20l0 .01",key:"svg-18"}],["path",{d:"M16 20l0 .01",key:"svg-19"}],["path",{d:"M20 20l0 .01",key:"svg-20"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ge=j("outline","border-outer","IconBorderOuter",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M12 8l0 .01",key:"svg-1"}],["path",{d:"M8 12l0 .01",key:"svg-2"}],["path",{d:"M12 12l0 .01",key:"svg-3"}],["path",{d:"M16 12l0 .01",key:"svg-4"}],["path",{d:"M12 16l0 .01",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xe=j("outline","border-right","IconBorderRight",[["path",{d:"M20 4l0 16",key:"svg-0"}],["path",{d:"M4 4l0 .01",key:"svg-1"}],["path",{d:"M8 4l0 .01",key:"svg-2"}],["path",{d:"M12 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M4 8l0 .01",key:"svg-5"}],["path",{d:"M12 8l0 .01",key:"svg-6"}],["path",{d:"M4 12l0 .01",key:"svg-7"}],["path",{d:"M8 12l0 .01",key:"svg-8"}],["path",{d:"M12 12l0 .01",key:"svg-9"}],["path",{d:"M16 12l0 .01",key:"svg-10"}],["path",{d:"M4 16l0 .01",key:"svg-11"}],["path",{d:"M12 16l0 .01",key:"svg-12"}],["path",{d:"M4 20l0 .01",key:"svg-13"}],["path",{d:"M8 20l0 .01",key:"svg-14"}],["path",{d:"M12 20l0 .01",key:"svg-15"}],["path",{d:"M16 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ye=j("outline","border-top","IconBorderTop",[["path",{d:"M4 4l16 0",key:"svg-0"}],["path",{d:"M4 8l0 .01",key:"svg-1"}],["path",{d:"M12 8l0 .01",key:"svg-2"}],["path",{d:"M20 8l0 .01",key:"svg-3"}],["path",{d:"M4 12l0 .01",key:"svg-4"}],["path",{d:"M8 12l0 .01",key:"svg-5"}],["path",{d:"M12 12l0 .01",key:"svg-6"}],["path",{d:"M16 12l0 .01",key:"svg-7"}],["path",{d:"M20 12l0 .01",key:"svg-8"}],["path",{d:"M4 16l0 .01",key:"svg-9"}],["path",{d:"M12 16l0 .01",key:"svg-10"}],["path",{d:"M20 16l0 .01",key:"svg-11"}],["path",{d:"M4 20l0 .01",key:"svg-12"}],["path",{d:"M8 20l0 .01",key:"svg-13"}],["path",{d:"M12 20l0 .01",key:"svg-14"}],["path",{d:"M16 20l0 .01",key:"svg-15"}],["path",{d:"M20 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Oe=j("outline","calendar","IconCalendar",[["path",{d:"M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z",key:"svg-0"}],["path",{d:"M16 3v4",key:"svg-1"}],["path",{d:"M8 3v4",key:"svg-2"}],["path",{d:"M4 11h16",key:"svg-3"}],["path",{d:"M11 15h1",key:"svg-4"}],["path",{d:"M12 15v3",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var qe=j("outline","chart-bar","IconChartBar",[["path",{d:"M3 13a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M15 9a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M9 5a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M4 20h14",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ue=j("outline","chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var oe=j("outline","currency-dollar","IconCurrencyDollar",[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var fe=j("outline","decimal","IconDecimal",[["path",{d:"M17 8a2 2 0 0 1 2 2v4a2 2 0 1 1 -4 0v-4a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M10 8a2 2 0 0 1 2 2v4a2 2 0 1 1 -4 0v-4a2 2 0 0 1 2 -2z",key:"svg-1"}],["path",{d:"M5 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Je=j("outline","droplet-off","IconDropletOff",[["path",{d:"M18.963 14.938a6.54 6.54 0 0 0 -.899 -4.06l-4.89 -7.26c-.42 -.626 -1.287 -.804 -1.936 -.398a1.376 1.376 0 0 0 -.41 .397l-1.282 1.9m-1.625 2.415l-1.986 2.946c-1.695 2.837 -1.035 6.44 1.567 8.545c2.602 2.105 6.395 2.105 8.996 0a6.83 6.83 0 0 0 1.376 -1.499",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ze=j("outline","filter","IconFilter",[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Re=j("outline","hash","IconHash",[["path",{d:"M5 9l14 0",key:"svg-0"}],["path",{d:"M5 15l14 0",key:"svg-1"}],["path",{d:"M11 4l-4 16",key:"svg-2"}],["path",{d:"M17 4l-4 16",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Pt=j("outline","italic","IconItalic",[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Qe=j("outline","math-function","IconMathFunction",[["path",{d:"M3 19a2 2 0 0 0 2 2c2 0 2 -4 3 -9s1 -9 3 -9a2 2 0 0 1 2 2",key:"svg-0"}],["path",{d:"M5 12h6",key:"svg-1"}],["path",{d:"M15 12l6 6",key:"svg-2"}],["path",{d:"M15 18l6 -6",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Dt=j("outline","paint","IconPaint",[["path",{d:"M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2",key:"svg-1"}],["path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ge=j("outline","percentage","IconPercentage",[["path",{d:"M17 17m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M7 7m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M6 18l12 -12",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var et=j("outline","strikethrough","IconStrikethrough",[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Et=j("outline","table-alias","IconTableAlias",[["path",{d:"M3 12v-7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-7",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v10",key:"svg-2"}],["path",{d:"M2 17a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-4z",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var _t=j("outline","typography","IconTypography",[["path",{d:"M4 20l3 0",key:"svg-0"}],["path",{d:"M14 20l7 0",key:"svg-1"}],["path",{d:"M6.9 15l6.9 0",key:"svg-2"}],["path",{d:"M10.2 6.3l5.8 13.7",key:"svg-3"}],["path",{d:"M5 20l6 -16l2 0l7 16",key:"svg-4"}]]),Kt="Toggle",rt=f.forwardRef((l,t)=>{const{pressed:s,defaultPressed:n=!1,onPressedChange:r,...o}=l,[i=!1,d]=It({prop:s,onChange:r,defaultProp:n});return e.jsx(zt.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":l.disabled?"":void 0,...o,ref:t,onClick:wt(l.onClick,()=>{l.disabled||d(!i)})})});rt.displayName=Kt;var Lt=rt;const Vt=Nt("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}});function ke({className:l,variant:t,size:s,...n}){return e.jsx(Lt,{"data-slot":"toggle",className:Ot(Vt({variant:t,size:s}),l),...n})}const Ut=["#000000","#434343","#666666","#999999","#cccccc","#d50000","#e67c73","#f4511e","#ef6c00","#f09300","#0b8043","#33b679","#039be5","#3f51b5","#7986cb","#8e24aa","#d81b60","#ad1457","#6a1b9a","#4a148c"],$t=["#ffffff","#f3f3f3","#e8e8e8","#d9d9d9","#cccccc","#fce4ec","#fff3e0","#fff9c4","#e8f5e9","#e0f7fa","#e3f2fd","#ede7f6","#fce4ec","#f3e5f5","#e8eaf6","#ffcdd2","#ffe0b2","#fff59d","#c8e6c9","#b2dfdb"],Wt={left:ze,center:Ie,right:Ne},Ht={top:we,middle:Se,bottom:Me},Gt={plain:Ce,number:Re,currency:oe,percent:ge,date:Oe},lt=typeof navigator<"u"&&/Mac|iPhone|iPad|iPod/.test(navigator.userAgent),te=lt?"⌘":"Ctrl";function Xt({spreadsheet:l,onInsertChart:t}){const s=Rt(),[n,r]=f.useState(void 0),[o,i]=f.useState(!1),[d,u]=f.useState(!1),[x,v]=f.useState(!1),p=f.useMemo(()=>Ee("en-US"),[]),m=f.useMemo(()=>Ee(),[]),M=f.useCallback(async()=>{if(!l)return;const C=await l.getActiveStyle();r(C),i(l.isSelectionMerged()),u(l.canMergeSelection()),v(l.hasFilter())},[l]);f.useEffect(()=>{if(l)return M(),l.onSelectionChange(M)},[l,M]);const k=f.useCallback(C=>{l==null||l.toggleStyle(C)},[l]),g=f.useCallback(C=>{l==null||l.applyStyle({al:C})},[l]),a=f.useCallback(C=>{l==null||l.applyStyle({va:C})},[l]),h=f.useCallback(C=>{l==null||l.applyStyle({tc:C})},[l]),b=f.useCallback(()=>{l==null||l.applyStyle({tc:""})},[l]),z=f.useCallback(C=>{l==null||l.applyStyle({bg:C})},[l]),D=f.useCallback(()=>{l==null||l.applyStyle({bg:""})},[l]),V=f.useCallback(()=>{l==null||l.undo()},[l]),q=f.useCallback(()=>{l==null||l.redo()},[l]),ie=f.useCallback(()=>{l==null||l.toggleFunctionBrowser()},[l]),ae=f.useCallback(()=>{t==null||t()},[t]),A=f.useCallback(C=>{l==null||l.applyStyle({nf:C})},[l]),se=f.useCallback(()=>{l==null||l.increaseDecimals()},[l]),ne=f.useCallback(()=>{l==null||l.decreaseDecimals()},[l]),ce=f.useCallback(()=>{l==null||l.toggleMergeCells()},[l]),I=f.useCallback(async()=>{l&&(l.hasFilter()?await l.clearFilter():await l.createFilterFromSelection(),await M())},[M,l]),c=f.useCallback(C=>{l==null||l.applyBorders(C)},[l]),F=(n==null?void 0:n.al)||"left",S=Wt[F],T=(n==null?void 0:n.va)||"top",E=Ht[T],L=(n==null?void 0:n.nf)||"plain",_=Gt[L];return e.jsxs("div",{className:"flex items-center gap-0.5 overflow-x-auto border-b bg-background px-2 py-1 whitespace-nowrap",children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:V,children:e.jsx(Ft,{size:16})})}),e.jsxs(R,{children:["Undo (",te,"+Z)"]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:q,children:e.jsx(Tt,{size:16})})}),e.jsxs(R,{children:["Redo (",te,"+",lt?"⇧Z":"Y",")"]})]}),e.jsx(ee,{orientation:"vertical",className:"mx-1 h-6"}),!s&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:()=>A("currency"),children:e.jsx(oe,{size:16})})}),e.jsxs(R,{children:["Format as currency (",m.currency,")"]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:()=>A("percent"),children:e.jsx(ge,{size:16})})}),e.jsx(R,{children:"Format as percent"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:ne,children:[e.jsx(fe,{size:16}),e.jsx("span",{className:"absolute mt-3.5 ml-3 text-[8px] font-bold leading-none",children:"-"})]})}),e.jsx(R,{children:"Decrease decimal places"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:se,children:[e.jsx(fe,{size:16}),e.jsx("span",{className:"absolute mt-3.5 ml-3 text-[8px] font-bold leading-none",children:"+"})]})}),e.jsx(R,{children:"Increase decimal places"})]}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(_,{size:16}),e.jsx(ue,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"More format"})]}),e.jsxs(Y,{children:[e.jsx(Q,{className:"text-xs font-normal text-muted-foreground",children:"Common formats (US examples)"}),e.jsx(K,{}),e.jsxs(y,{onClick:()=>A("plain"),children:[e.jsx(Ce,{size:16,className:"mr-2"}),"Plain text"]}),e.jsxs(y,{onClick:()=>A("number"),children:[e.jsx(Re,{size:16,className:"mr-2"}),"Number",e.jsx(le,{children:p.number})]}),e.jsxs(y,{onClick:()=>A("currency"),children:[e.jsx(oe,{size:16,className:"mr-2"}),"Currency",e.jsx(le,{children:p.currencyValue})]}),e.jsxs(y,{onClick:()=>A("percent"),children:[e.jsx(ge,{size:16,className:"mr-2"}),"Percent",e.jsx(le,{children:p.percent})]}),e.jsx(K,{}),e.jsxs(Q,{className:"text-xs font-normal text-muted-foreground",children:["US date preview: ",p.date]}),e.jsx(K,{}),e.jsxs(Q,{className:"text-xs font-normal text-muted-foreground",children:["Your locale (",m.locale,")"]}),e.jsxs(y,{onClick:()=>A("currency"),children:[e.jsx(oe,{size:16,className:"mr-2"}),"Locale currency",e.jsx(le,{children:m.currencyValue})]}),e.jsxs(y,{onClick:()=>A("date"),children:[e.jsx(Oe,{size:16,className:"mr-2"}),"Locale date",e.jsx(le,{children:m.date})]})]})]}),e.jsx(ee,{orientation:"vertical",className:"mx-1 h-6"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(ke,{size:"sm",pressed:(n==null?void 0:n.b)||!1,onPressedChange:()=>k("b"),className:"h-7 w-7 cursor-pointer",children:e.jsx(Bt,{size:16})})}),e.jsxs(R,{children:["Bold (",te,"+B)"]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(ke,{size:"sm",pressed:(n==null?void 0:n.i)||!1,onPressedChange:()=>k("i"),className:"h-7 w-7 cursor-pointer",children:e.jsx(Pt,{size:16})})}),e.jsxs(R,{children:["Italic (",te,"+I)"]})]}),!s&&e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(ke,{size:"sm",pressed:(n==null?void 0:n.st)||!1,onPressedChange:()=>k("st"),className:"h-7 w-7 cursor-pointer",children:e.jsx(et,{size:16})})}),e.jsxs(R,{children:["Strikethrough (",te,"+Shift+S)"]})]}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:[e.jsx(_t,{size:16}),e.jsx("span",{className:"absolute mt-5 h-0.5 w-3.5 rounded",style:{backgroundColor:(n==null?void 0:n.tc)||"#000000"}})]})})}),e.jsx(R,{children:"Text color"})]}),e.jsxs(Y,{className:"w-auto p-2",children:[e.jsxs("button",{className:"mb-2 flex w-full items-center gap-2 rounded px-2 py-1 text-xs hover:bg-muted",onClick:b,children:[e.jsx(Je,{size:14}),"Reset"]}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:Ut.map(C=>e.jsx("button",{className:"h-5 w-5 rounded border border-border hover:scale-125 transition-transform",style:{backgroundColor:C},onClick:()=>h(C)},C))})]})]}),e.jsx(ee,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:[e.jsx(Dt,{size:16}),e.jsx("span",{className:"absolute mt-5 h-0.5 w-3.5 rounded",style:{backgroundColor:(n==null?void 0:n.bg)||"transparent",border:n!=null&&n.bg?"none":"1px solid #ccc"}})]})})}),e.jsx(R,{children:"Fill color"})]}),e.jsxs(Y,{className:"w-auto p-2",children:[e.jsxs("button",{className:"mb-2 flex w-full items-center gap-2 rounded px-2 py-1 text-xs hover:bg-muted",onClick:D,children:[e.jsx(Je,{size:14}),"Reset"]}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:$t.map(C=>e.jsx("button",{className:"h-5 w-5 rounded border border-border hover:scale-125 transition-transform",style:{backgroundColor:C},onClick:()=>z(C)},C))})]})]}),!s&&e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(je,{size:14}),e.jsx(ue,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"Cell borders"})]}),e.jsxs(Y,{children:[e.jsxs(y,{onClick:()=>c("all"),children:[e.jsx(je,{size:14,className:"mr-2"}),"All borders"]}),e.jsxs(y,{onClick:()=>c("outer"),children:[e.jsx(Ge,{size:14,className:"mr-2"}),"Outer border"]}),e.jsxs(y,{onClick:()=>c("inner"),children:[e.jsx($e,{size:14,className:"mr-2"}),"Inner borders"]}),e.jsx(K,{}),e.jsxs(y,{onClick:()=>c("top"),children:[e.jsx(Ye,{size:14,className:"mr-2"}),"Top border"]}),e.jsxs(y,{onClick:()=>c("bottom"),children:[e.jsx(Ue,{size:14,className:"mr-2"}),"Bottom border"]}),e.jsxs(y,{onClick:()=>c("left"),children:[e.jsx(We,{size:14,className:"mr-2"}),"Left border"]}),e.jsxs(y,{onClick:()=>c("right"),children:[e.jsx(Xe,{size:14,className:"mr-2"}),"Right border"]}),e.jsx(K,{}),e.jsxs(y,{onClick:()=>c("clear"),children:[e.jsx(He,{size:14,className:"mr-2"}),"Clear borders"]})]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:`inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted disabled:cursor-not-allowed disabled:opacity-50 ${o?"bg-muted":""}`,onClick:ce,disabled:!o&&!d,children:e.jsx(Et,{size:16})})}),e.jsx(R,{children:o?"Unmerge cells":`Merge cells (${te}+Shift+M)`})]}),!s&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(S,{size:16}),e.jsx(ue,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"Horizontal align"})]}),e.jsxs(Y,{children:[e.jsxs(y,{onClick:()=>g("left"),children:[e.jsx(ze,{size:16,className:"mr-2"}),"Left"]}),e.jsxs(y,{onClick:()=>g("center"),children:[e.jsx(Ie,{size:16,className:"mr-2"}),"Center"]}),e.jsxs(y,{onClick:()=>g("right"),children:[e.jsx(Ne,{size:16,className:"mr-2"}),"Right"]})]})]}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(E,{size:16}),e.jsx(ue,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"Vertical align"})]}),e.jsxs(Y,{children:[e.jsxs(y,{onClick:()=>a("top"),children:[e.jsx(we,{size:16,className:"mr-2"}),"Top"]}),e.jsxs(y,{onClick:()=>a("middle"),children:[e.jsx(Se,{size:16,className:"mr-2"}),"Middle"]}),e.jsxs(y,{onClick:()=>a("bottom"),children:[e.jsx(Me,{size:16,className:"mr-2"}),"Bottom"]})]})]}),e.jsx(ee,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-[11px] font-semibold hover:bg-muted",onClick:ie,children:e.jsx(Qe,{size:16,className:"mr-2"})})}),e.jsx(R,{children:"Functions"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:`inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted ${x?"bg-muted":""}`,onClick:()=>{I()},children:e.jsx(Ze,{size:16})})}),e.jsx(R,{children:x?"Clear filter":"Create filter from selection"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-[11px] font-semibold hover:bg-muted",onClick:ae,children:e.jsx(qe,{size:16})})}),e.jsx(R,{children:"Insert chart"})]})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(G,{children:[e.jsx(X,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:e.jsx(At,{size:16})})}),e.jsxs(Y,{align:"end",children:[e.jsx(Q,{children:"Format"}),e.jsxs(y,{onClick:()=>A("currency"),children:[e.jsx(oe,{size:16,className:"mr-2"}),"Currency"]}),e.jsxs(y,{onClick:()=>A("percent"),children:[e.jsx(ge,{size:16,className:"mr-2"}),"Percent"]}),e.jsxs(y,{onClick:ne,children:[e.jsx(fe,{size:16,className:"mr-2"}),"Decrease decimals"]}),e.jsxs(y,{onClick:se,children:[e.jsx(fe,{size:16,className:"mr-2"}),"Increase decimals"]}),e.jsx(K,{}),e.jsxs(y,{onClick:()=>A("plain"),children:[e.jsx(Ce,{size:16,className:"mr-2"}),"Plain text"]}),e.jsxs(y,{onClick:()=>A("number"),children:[e.jsx(Re,{size:16,className:"mr-2"}),"Number (",p.number,")"]}),e.jsxs(y,{onClick:()=>A("date"),children:[e.jsx(Oe,{size:16,className:"mr-2"}),"Date (",m.date,")"]}),e.jsx(K,{}),e.jsxs(y,{onClick:()=>{I()},children:[e.jsx(Ze,{size:16,className:"mr-2"}),x?"Clear filter":"Create filter"]}),e.jsx(K,{}),e.jsx(Q,{children:"Align"}),e.jsxs(y,{onClick:()=>g("left"),children:[e.jsx(ze,{size:16,className:"mr-2"}),"Left"]}),e.jsxs(y,{onClick:()=>g("center"),children:[e.jsx(Ie,{size:16,className:"mr-2"}),"Center"]}),e.jsxs(y,{onClick:()=>g("right"),children:[e.jsx(Ne,{size:16,className:"mr-2"}),"Right"]}),e.jsxs(y,{onClick:()=>a("top"),children:[e.jsx(we,{size:16,className:"mr-2"}),"Top"]}),e.jsxs(y,{onClick:()=>a("middle"),children:[e.jsx(Se,{size:16,className:"mr-2"}),"Middle"]}),e.jsxs(y,{onClick:()=>a("bottom"),children:[e.jsx(Me,{size:16,className:"mr-2"}),"Bottom"]}),e.jsx(K,{}),e.jsx(Q,{children:"Borders"}),e.jsxs(y,{onClick:()=>c("all"),children:[e.jsx(je,{size:14,className:"mr-2"}),"All borders"]}),e.jsxs(y,{onClick:()=>c("outer"),children:[e.jsx(Ge,{size:14,className:"mr-2"}),"Outer border"]}),e.jsxs(y,{onClick:()=>c("inner"),children:[e.jsx($e,{size:14,className:"mr-2"}),"Inner borders"]}),e.jsxs(y,{onClick:()=>c("top"),children:[e.jsx(Ye,{size:14,className:"mr-2"}),"Top border"]}),e.jsxs(y,{onClick:()=>c("bottom"),children:[e.jsx(Ue,{size:14,className:"mr-2"}),"Bottom border"]}),e.jsxs(y,{onClick:()=>c("left"),children:[e.jsx(We,{size:14,className:"mr-2"}),"Left border"]}),e.jsxs(y,{onClick:()=>c("right"),children:[e.jsx(Xe,{size:14,className:"mr-2"}),"Right border"]}),e.jsxs(y,{onClick:()=>c("clear"),children:[e.jsx(He,{size:14,className:"mr-2"}),"Clear borders"]}),e.jsx(K,{}),e.jsxs(y,{onClick:()=>k("st"),children:[e.jsx(et,{size:16,className:"mr-2"}),"Strikethrough"]}),e.jsxs(y,{onClick:ie,children:[e.jsx(Qe,{size:16,className:"mr-2"}),"Functions"]}),e.jsxs(y,{onClick:ae,children:[e.jsx(qe,{size:16,className:"mr-2"}),"Insert chart"]})]})]})]})]})}class Yt{constructor(t,s){H(this,"doc");H(this,"tabId");H(this,"cellIndex",new yt);H(this,"dirty",!0);H(this,"batchOverlay",null);H(this,"batchOps",null);this.doc=t,this.tabId=s,t.subscribe(n=>{n.type==="remote-change"&&(this.dirty=!0)})}getSheet(){return this.doc.getRoot().sheets[this.tabId]}isDuplicateOwnKeysError(t){return t instanceof TypeError&&t.message.includes("ownKeys")&&t.message.includes("duplicate")}snapshotObject(t){const s=t.toJSON;return typeof s=="function"?JSON.parse(s.call(t)):{...t}}stableObjectKeys(t){try{return Object.keys(t)}catch(s){if(this.isDuplicateOwnKeysError(s))return console.warn(s),Object.keys(this.snapshotObject(t));throw s}}stableObjectEntries(t){try{return Object.entries(t)}catch(s){if(this.isDuplicateOwnKeysError(s))return console.warn(s),Object.entries(this.snapshotObject(t));throw s}}stableSheetKeys(t){return this.stableObjectKeys(t)}stableSheetEntries(t){return this.stableObjectEntries(t)}toPlainString(t){if(typeof t=="string")return t;if(t==null)return"";if(typeof t=="number"||typeof t=="boolean")return String(t);if(typeof t=="object"){const s=t;if(s.value!==void 0&&s.value!==t)return this.toPlainString(s.value);if(typeof s.toJSON=="function")try{const n=s.toJSON.call(t);if(n!==t)return this.toPlainString(n)}catch{}}return String(t)}normalizeFilterCondition(t){const s={op:t.op};return t.value!==void 0&&(s.value=this.toPlainString(t.value)),t.values!==void 0&&(s.values=t.values.map(n=>this.toPlainString(n))),s}toWorksheetFilterState(t){return{startRow:t.range[0].r,endRow:t.range[1].r,startCol:t.range[0].c,endCol:t.range[1].c,columns:Object.fromEntries(Object.entries(t.columns).map(([s,n])=>[s,this.normalizeFilterCondition(n)])),hiddenRows:[...t.hiddenRows]}}fromWorksheetFilterState(t){if(t)return{range:[{r:t.startRow,c:t.startCol},{r:t.endRow,c:t.endCol}],columns:Object.fromEntries(Object.entries(t.columns||{}).map(([s,n])=>[s,this.normalizeFilterCondition(n)])),hiddenRows:[...t.hiddenRows||[]]}}ensureIndex(){if(!this.dirty)return;const t=this.getSheet().sheet,s=[];for(const n of this.stableSheetKeys(t)){const r=B(n);s.push([r.r,r.c])}this.cellIndex.rebuild(s),this.dirty=!1}normalizeCell(t){const s={};return t.v!==void 0&&t.v!==""&&(s.v=t.v),t.f!==void 0&&t.f!==""&&(s.f=t.f),t.s&&Object.keys(t.s).length>0&&(s.s=t.s),s.v===void 0&&s.f===void 0&&s.s===void 0?null:s}async set(t,s){const n=w(t),r=this.normalizeCell(s);if(this.batchOverlay){r?(this.batchOverlay.set(n,r),this.dirty||this.cellIndex.add(t.r,t.c)):(this.batchOverlay.set(n,null),this.dirty||this.cellIndex.remove(t.r,t.c));return}if(!r){await this.delete(t);return}const o=this.tabId;this.doc.update(i=>{i.sheets[o].sheet[n]=r}),this.dirty||this.cellIndex.add(t.r,t.c)}async get(t){const s=w(t);if(this.batchOverlay&&this.batchOverlay.has(s)){const n=this.batchOverlay.get(s);return n===null?void 0:n}return this.getSheet().sheet[s]}async has(t){const s=w(t);return this.batchOverlay&&this.batchOverlay.has(s)?this.batchOverlay.get(s)!==null:this.getSheet().sheet[s]!==void 0}async delete(t){const s=w(t);if(this.batchOverlay){let o=!1;return this.batchOverlay.has(s)?o=this.batchOverlay.get(s)!==null:o=this.getSheet().sheet[s]!==void 0,o?(this.batchOverlay.set(s,null),this.dirty||this.cellIndex.remove(t.r,t.c),!0):!1}let n=!1;const r=this.tabId;return this.doc.update(o=>{o.sheets[r].sheet[s]!==void 0&&(delete o.sheets[r].sheet[s],n=!0)}),n&&!this.dirty&&this.cellIndex.remove(t.r,t.c),n}async deleteRange(t){this.ensureIndex();const s=Array.from(this.cellIndex.cellsInRange(t)),n=new Set;if(this.batchOverlay){for(const[o,i]of s){const d=w({r:o,c:i});this.batchOverlay.has(d)&&this.batchOverlay.get(d)===null||(this.batchOverlay.set(d,null),n.add(d))}for(const[o,i]of s)this.cellIndex.remove(o,i);return n}const r=this.tabId;this.doc.update(o=>{for(const[i,d]of s){const u=w({r:i,c:d});delete o.sheets[r].sheet[u],n.add(u)}});for(const[o,i]of s)this.cellIndex.remove(o,i);return n}async setGrid(t){if(this.batchOverlay){for(const[n,r]of t){const o=B(n),i=this.normalizeCell(r);i?(this.batchOverlay.set(n,i),this.dirty||this.cellIndex.add(o.r,o.c)):(this.batchOverlay.set(n,null),this.dirty||this.cellIndex.remove(o.r,o.c))}return}const s=this.tabId;if(this.doc.update(n=>{for(const[r,o]of t){const i=this.normalizeCell(o);i?n.sheets[s].sheet[r]=i:n.sheets[s].sheet[r]!==void 0&&delete n.sheets[s].sheet[r]}}),!this.dirty)for(const[n,r]of t){const o=B(n);this.normalizeCell(r)?this.cellIndex.add(o.r,o.c):this.cellIndex.remove(o.r,o.c)}}async getGrid(t){this.ensureIndex();const s=this.getSheet().sheet,n=new Map;for(const[r,o]of this.cellIndex.cellsInRange(t)){const i=w({r,c:o});if(this.batchOverlay&&this.batchOverlay.has(i)){const u=this.batchOverlay.get(i);u!==null&&n.set(i,u);continue}const d=s[i];d!==void 0&&n.set(i,d)}return n}async findEdge(t,s,n){return this.ensureIndex(),vt(this.cellIndex,t,s,n,(r,o)=>{const i=w({r,c:o}),d=this.getSheet().sheet[i];return d!==void 0&&(!!d.v||!!d.f)})}async shiftCells(t,s,n){const r=this.tabId,o=i=>{const d=i.sheets[r],u=[];for(const[g,a]of this.stableSheetEntries(d.sheet))u.push([g,{v:a.v,f:a.f,s:a.s}]);const x=new Map;for(const[g,a]of u){const h=Ke(g,t,s,n);if(h===null)continue;let b;a.f?b={...a,f:pt(a.f,t,s,n)}:b={...a};const z=this.normalizeCell(b);z&&x.set(h,z)}for(const[g]of u)!x.has(g)&&d.sheet[g]!==void 0&&delete d.sheet[g];for(const[g,a]of x)d.sheet[g]=a;const v=t==="row"?d.rowHeights:d.colWidths,p=[];for(const[g,a]of Object.entries(v))p.push([g,a]);for(const[g]of p)delete v[g];for(const[g,a]of p){const h=Number(g);if(n>0)h>=s?v[String(h+n)]=a:v[g]=a;else{const b=Math.abs(n);h>=s&&h<s+b||(h>=s+b?v[String(h+n)]=a:v[g]=a)}}const m=t==="row"?d.rowStyles:d.colStyles;if(m){const g=[];for(const[a,h]of Object.entries(m))g.push([a,h]);for(const[a]of g)delete m[a];for(const[a,h]of g){const b=Number(a);if(n>0)b>=s?m[String(b+n)]=h:m[a]=h;else{const z=Math.abs(n);b>=s&&b<s+z||(b>=s+z?m[String(b+n)]=h:m[a]=h)}}}d.rangeStyles&&(d.rangeStyles=xt(d.rangeStyles,t,s,n));const M=new Map(Object.entries(d.merges||{})),k=bt(M,t,s,n);d.merges={};for(const[g,a]of k)d.merges[g]=a;if(d.charts)for(const g of Object.values(d.charts)){const a=Ke(g.anchor,t,s,n);if(a){g.anchor=a;continue}const h=B(g.anchor);t==="row"?h.r=Math.max(1,s):h.c=Math.max(1,s),g.anchor=w(h)}};if(this.batchOps){this.batchOps.push(o),this.dirty=!0;return}this.doc.update(i=>{o(i)}),this.dirty=!0}async moveCells(t,s,n,r){const o=this.tabId,i=d=>{const u=d.sheets[o],x=[];for(const[a,h]of this.stableSheetEntries(u.sheet))x.push([a,{v:h.v,f:h.f,s:h.s}]);const v=new Map;for(const[a,h]of x){const b=B(a),z=Le(b,t,s,n,r),D=w(z);let V;h.f?V={...h,f:jt(h.f,t,s,n,r)}:V={...h};const q=this.normalizeCell(V);q&&v.set(D,q)}for(const[a]of x)!v.has(a)&&u.sheet[a]!==void 0&&delete u.sheet[a];for(const[a,h]of v)u.sheet[a]=h;const p=t==="row"?u.rowHeights:u.colWidths,m=[];for(const[a,h]of Object.entries(p))m.push([a,h]);for(const[a]of m)delete p[a];for(const[a,h]of m){const b=Number(a),z=Ve(b,s,n,r);p[String(z)]=h}const M=t==="row"?u.rowStyles:u.colStyles;if(M){const a=[];for(const[h,b]of Object.entries(M))a.push([h,b]);for(const[h]of a)delete M[h];for(const[h,b]of a){const z=Number(h),D=Ve(z,s,n,r);M[String(D)]=b}}u.rangeStyles&&(u.rangeStyles=kt(u.rangeStyles,t,s,n,r));const k=new Map(Object.entries(u.merges||{})),g=Ct(k,t,s,n,r);u.merges={};for(const[a,h]of g)u.merges[a]=h;if(u.charts)for(const a of Object.values(u.charts)){const h=Le(B(a.anchor),t,s,n,r);a.anchor=w(h)}};if(this.batchOps){this.batchOps.push(i),this.dirty=!0;return}this.doc.update(d=>{i(d)}),this.dirty=!0}async getFormulaGrid(){const t=new Map,s=this.getSheet().sheet;for(const[n,r]of this.stableSheetEntries(s))r.f&&t.set(n,r);return t}async buildDependantsMap(t){const s=new Map,n=this.getSheet().sheet;if(this.batchOverlay){for(const[r,o]of this.stableSheetEntries(n))if(!this.batchOverlay.has(r)&&o.f)for(const i of pe(xe(o.f)))be(i)||(s.has(i)||s.set(i,new Set),s.get(i).add(r));for(const[r,o]of this.batchOverlay)if(!(o===null||!o.f))for(const i of pe(xe(o.f)))be(i)||(s.has(i)||s.set(i,new Set),s.get(i).add(r));return s}for(const[r,o]of this.stableSheetEntries(n))if(o.f)for(const i of pe(xe(o.f)))be(i)||(s.has(i)||s.set(i,new Set),s.get(i).add(r));return s}async setDimensionSize(t,s,n){if(this.batchOps){const o=this.tabId;this.batchOps.push(i=>{const d=t==="row"?i.sheets[o].rowHeights:i.sheets[o].colWidths;d[String(s)]=n});return}const r=this.tabId;this.doc.update(o=>{const i=t==="row"?o.sheets[r].rowHeights:o.sheets[r].colWidths;i[String(s)]=n})}async getDimensionSizes(t){const s=this.getSheet(),n=t==="row"?s.rowHeights:s.colWidths,r=new Map;if(n)for(const[o,i]of Object.entries(n))r.set(Number(o),i);return r}updateActiveCell(t){this.doc.update((s,n)=>{n.set({activeCell:w(t)})})}getPresences(){return this.doc.getOthersPresences()}async setColumnStyle(t,s){if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{o.sheets[r].colStyles||(o.sheets[r].colStyles={}),o.sheets[r].colStyles[String(t)]=s});return}const n=this.tabId;this.doc.update(r=>{r.sheets[n].colStyles||(r.sheets[n].colStyles={}),r.sheets[n].colStyles[String(t)]=s})}async getColumnStyles(){const t=this.getSheet(),s=new Map;if(t.colStyles)for(const[n,r]of Object.entries(t.colStyles))s.set(Number(n),r);return s}async setRowStyle(t,s){if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{o.sheets[r].rowStyles||(o.sheets[r].rowStyles={}),o.sheets[r].rowStyles[String(t)]=s});return}const n=this.tabId;this.doc.update(r=>{r.sheets[n].rowStyles||(r.sheets[n].rowStyles={}),r.sheets[n].rowStyles[String(t)]=s})}async getRowStyles(){const t=this.getSheet(),s=new Map;if(t.rowStyles)for(const[n,r]of Object.entries(t.rowStyles))s.set(Number(n),r);return s}async setSheetStyle(t){if(this.batchOps){const n=this.tabId;this.batchOps.push(r=>{r.sheets[n].sheetStyle=t});return}const s=this.tabId;this.doc.update(n=>{n.sheets[s].sheetStyle=t})}async getSheetStyle(){const t=this.getSheet();return t.sheetStyle?{...t.sheetStyle}:void 0}async addRangeStyle(t){const s=_e(t);if(!s)return;if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{o.sheets[r].rangeStyles||(o.sheets[r].rangeStyles=[]),o.sheets[r].rangeStyles.push(Z(s))});return}const n=this.tabId;this.doc.update(r=>{r.sheets[n].rangeStyles||(r.sheets[n].rangeStyles=[]),r.sheets[n].rangeStyles.push(Z(s))})}async setRangeStyles(t){const s=t.map(r=>_e(r)).filter(r=>!!r).map(r=>Z(r));if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{if(s.length===0){delete o.sheets[r].rangeStyles;return}o.sheets[r].rangeStyles=s.map(i=>Z(i))});return}const n=this.tabId;this.doc.update(r=>{if(s.length===0){delete r.sheets[n].rangeStyles;return}r.sheets[n].rangeStyles=s.map(o=>Z(o))})}async getRangeStyles(){const t=this.getSheet();return!t.rangeStyles||t.rangeStyles.length===0?[]:t.rangeStyles.map(s=>Z(s))}async setMerge(t,s){if(this.batchOps){const o=this.tabId,i=w(t);this.batchOps.push(d=>{d.sheets[o].merges||(d.sheets[o].merges={}),d.sheets[o].merges[i]={...s}});return}const n=this.tabId,r=w(t);this.doc.update(o=>{o.sheets[n].merges||(o.sheets[n].merges={}),o.sheets[n].merges[r]={...s}})}async deleteMerge(t){var o;const s=w(t);if(this.batchOps){const i=this.tabId;return!((o=this.getSheet().merges)!=null&&o[s])?!1:(this.batchOps.push(x=>{var v;(v=x.sheets[i].merges)!=null&&v[s]&&delete x.sheets[i].merges[s]}),!0)}let n=!1;const r=this.tabId;return this.doc.update(i=>{var d;(d=i.sheets[r].merges)!=null&&d[s]&&(delete i.sheets[r].merges[s],n=!0)}),n}async getMerges(){const t=this.getSheet(),s=new Map;if(!t.merges)return s;for(const[n,r]of Object.entries(t.merges))s.set(n,{...r});return s}async setFilterState(t){if(this.batchOps){const n=this.tabId;this.batchOps.push(r=>{const o=r.sheets[n];if(!t){delete o.filter;return}o.filter=this.toWorksheetFilterState(t)});return}const s=this.tabId;this.doc.update(n=>{const r=n.sheets[s];if(!t){delete r.filter;return}r.filter=this.toWorksheetFilterState(t)})}async getFilterState(){return this.fromWorksheetFilterState(this.getSheet().filter)}async setFreezePane(t,s){if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{o.sheets[r].frozenRows=t,o.sheets[r].frozenCols=s});return}const n=this.tabId;this.doc.update(r=>{r.sheets[n].frozenRows=t,r.sheets[n].frozenCols=s})}async getFreezePane(){const t=this.getSheet();return{frozenRows:t.frozenRows??0,frozenCols:t.frozenCols??0}}beginBatch(){this.batchOverlay=new Map,this.batchOps=[]}endBatch(){const t=this.batchOverlay,s=this.batchOps;this.batchOverlay=null,this.batchOps=null;const n=t&&t.size>0,r=s&&s.length>0;if(!n&&!r)return;const o=this.tabId;this.doc.update(i=>{const d=i.sheets[o];if(t)for(const[u,x]of t)if(x===null)d.sheet[u]!==void 0&&delete d.sheet[u];else{const v=this.normalizeCell(x);v?d.sheet[u]=v:d.sheet[u]!==void 0&&delete d.sheet[u]}if(s)for(const u of s)u(i)}),this.dirty=!0}async undo(){if(!this.doc.history.canUndo())return{success:!1};const t=new Set(this.stableSheetKeys(this.getSheet().sheet)),s=new Map(Object.entries(this.getSheet().merges||{}));return this.doc.history.undo(),this.dirty=!0,{success:!0,affectedRange:this.computeAffectedRange(t,s)}}async redo(){if(!this.doc.history.canRedo())return{success:!1};const t=new Set(this.stableSheetKeys(this.getSheet().sheet)),s=new Map(Object.entries(this.getSheet().merges||{}));return this.doc.history.redo(),this.dirty=!0,{success:!0,affectedRange:this.computeAffectedRange(t,s)}}computeAffectedRange(t,s){const n=new Set(this.stableSheetKeys(this.getSheet().sheet)),r=new Map(Object.entries(this.getSheet().merges||{})),o=new Set;for(const v of n)t.has(v)||o.add(v);for(const v of t)n.has(v)||o.add(v);for(const[v,p]of r){const m=s.get(v);(!m||m.rs!==p.rs||m.cs!==p.cs)&&o.add(v)}for(const v of s.keys())r.has(v)||o.add(v);if(o.size===0)return;let i=1/0,d=-1/0,u=1/0,x=-1/0;for(const v of o){const p=B(v);p.r<i&&(i=p.r),p.r>d&&(d=p.r),p.c<u&&(u=p.c),p.c>x&&(x=p.c)}return[{r:i,c:u},{r:d,c:x}]}canUndo(){return this.doc.history.canUndo()}canRedo(){return this.doc.history.canRedo()}}function ot(l){if(typeof l!="string")return null;const t=l.toUpperCase().replace(/\$/g,"").split(":").map(s=>s.trim()).filter(Boolean);if(t.length!==2)return null;try{const s=B(t[0]),n=B(t[1]);return[{r:Math.min(s.r,n.r),c:Math.min(s.c,n.c)},{r:Math.max(s.r,n.r),c:Math.max(s.c,n.c)}]}catch{return null}}function hs(l){return`${w(l[0])}:${w(l[1])}`}function qt(l){const[t,s]=l,n=[];for(let r=t.c;r<=s.c;r++)n.push(it(r));return n.length===0?{xAxisColumn:null,seriesColumns:[]}:{xAxisColumn:n[0],seriesColumns:n.slice(1)}}function Jt(l,t){const s=l.sheets[t.sourceTabId];if(!s)return{columns:[],xAxisColumn:null,seriesColumns:[]};const n=ot(t.sourceRange);if(!n)return{columns:[],xAxisColumn:null,seriesColumns:[]};const[r,o]=n,i=[];for(let m=r.c;m<=o.c;m++){const M=it(m);i.push({column:M,index:m,label:me(s,r.r,m)||M})}if(i.length===0)return{columns:[],xAxisColumn:null,seriesColumns:[]};const d=i[0].column,u=Ae(t.xAxisColumn),x=i.some(m=>m.column===u)?u:d,v=new Set,p=[];for(const m of t.seriesColumns||[]){const M=Ae(m);M&&M!==x&&!v.has(M)&&i.some(k=>k.column===M)&&(v.add(M),p.push(M))}if(p.length===0)for(const m of i)m.column!==x&&p.push(m.column);return{columns:i,xAxisColumn:x,seriesColumns:p}}function ds(l,t){const s=l.sheets[t.sourceTabId];if(!s)return{xKey:"category",rows:[],series:[],config:{}};const n=ot(t.sourceRange);if(!n)return{xKey:"category",rows:[],series:[],config:{}};const[r,o]=n,i=o.c-r.c+1,d=o.r-r.r+1;if(i<2||d<2)return{xKey:"category",rows:[],series:[],config:{}};const u=Jt(l,t);if(!u.xAxisColumn||u.seriesColumns.length===0)return{xKey:"category",rows:[],series:[],config:{}};const x=tt(u.xAxisColumn);if(!x)return{xKey:"category",rows:[],series:[],config:{}};const v=[],p={},m=[];for(const[g,a]of u.seriesColumns.entries()){const h=tt(a);if(!h)continue;const b=me(s,r.r,h)||a,z=`series_${a}`,D={key:z,label:b};v.push(D),m.push({...D,index:h}),p[z]={label:b,color:Qt(g)}}if(m.length===0)return{xKey:"category",rows:[],series:[],config:{}};const M="category",k=[];for(let g=r.r+1;g<=o.r;g++){const a={};a[M]=me(s,g,x)||`Row ${g-r.r}`;let h=!1;for(const b of m){const z=Zt(me(s,g,b.index));z!==null&&(a[b.key]=z,h=!0)}h&&k.push(a)}return{xKey:M,rows:k,series:v,config:p}}function me(l,t,s){var r;const n=(r=l.sheet[w({r:t,c:s})])==null?void 0:r.v;return typeof n=="string"?n:n==null?"":String(n)}function Zt(l){if(typeof l!="string")return null;const t=l.trim().replace(/,/g,"");if(!t)return null;const s=Number(t);return Number.isFinite(s)?s:null}function it(l){return w({r:1,c:l}).replace(/[0-9]+$/,"")}function tt(l){const t=Ae(l);if(!t)return null;try{return B(`${t}1`).c}catch{return null}}function Ae(l){if(typeof l!="string")return null;const t=l.trim().toUpperCase();return/^[A-Z]+$/.test(t)?t:null}function Qt(l){const t=["var(--color-primary)","color-mix(in oklch, var(--color-primary) 78%, var(--color-background))","color-mix(in oklch, var(--color-primary) 68%, var(--color-foreground))","color-mix(in oklch, var(--color-primary) 56%, var(--color-background))","color-mix(in oklch, var(--color-primary) 46%, var(--color-foreground))"];return t[l%t.length]}const es=f.lazy(()=>nt(()=>import("./chart-object-layer-BHAQAai-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(l=>({default:l.ChartObjectLayer}))),ts=f.lazy(()=>nt(()=>import("./chart-editor-panel-C5Z1dJYj.js"),__vite__mapDeps([10,1,2,11,7,9,6,5,12,13,4,14,15,3])).then(l=>({default:l.ChartEditorPanel})));function st({tabId:l,readOnly:t=!1}){var se,ne,ce;const{resolvedTheme:s}=ft(),n=f.useRef(null),[r,o]=f.useState(!1),[i,d]=f.useState(0),[u,x]=f.useState(null),[v,p]=f.useState(!1),m=f.useRef(void 0),M=f.useRef(!1),{doc:k,loading:g,error:a}=gt.useDocument();Mt({containerRef:n,sheetRef:m});const h=k==null?void 0:k.getRoot(),b=!!h&&Object.keys(((se=h.sheets[l])==null?void 0:se.charts)||{}).length>0,z=h&&u?(ce=(ne=h.sheets[l])==null?void 0:ne.charts)==null?void 0:ce[u]:void 0;f.useEffect(()=>{M.current=b},[b]);const D=f.useCallback(()=>{if(t)return;const I=m.current;if(!k||!I)return;if(I.getSelectionType()!=="cell"){ve.error("Select a cell range to insert a chart.");return}const c=I.getSelectionRangeOrActiveCell();if(!c){ve.error("Select a cell range to insert a chart.");return}const F=c[1].r-c[0].r+1,S=c[1].c-c[0].c+1;if(F<2||S<2){ve.error("Select at least 2 rows and 2 columns.");return}const T=`chart-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,E=`${w(c[0])}:${w(c[1])}`,L=w(c[0]),_=qt([c[0],c[1]]);k.update(C=>{const P=C.sheets[l];P.charts||(P.charts={}),P.charts[T]={id:T,type:"bar",title:"Chart",sourceTabId:l,sourceRange:E,xAxisColumn:_.xAxisColumn||void 0,seriesColumns:_.seriesColumns,anchor:L,offsetX:8,offsetY:8,width:420,height:260}}),x(T),p(!0)},[k,t,l]),V=f.useCallback((I,c)=>{t||!k||k.update(F=>{var T,E;const S=(E=(T=F.sheets[l])==null?void 0:T.charts)==null?void 0:E[I];S&&(c.anchor!==void 0&&(S.anchor=c.anchor),c.offsetX!==void 0&&(S.offsetX=c.offsetX),c.offsetY!==void 0&&(S.offsetY=c.offsetY),c.width!==void 0&&(S.width=c.width),c.height!==void 0&&(S.height=c.height),c.title!==void 0&&(S.title=c.title),c.sourceRange!==void 0&&(S.sourceRange=c.sourceRange),c.type!==void 0&&(S.type=c.type),c.sourceTabId!==void 0&&(S.sourceTabId=c.sourceTabId),c.xAxisColumn!==void 0&&(S.xAxisColumn=c.xAxisColumn),c.seriesColumns!==void 0&&(S.seriesColumns=[...c.seriesColumns]))})},[k,t,l]),q=f.useCallback(I=>{t||!k||(k.update(c=>{var S;const F=c.sheets[l];(S=F==null?void 0:F.charts)!=null&&S[I]&&delete F.charts[I]}),u===I&&(x(null),p(!1)))},[k,t,u,l]),ie=f.useCallback(I=>{x(I),p(!0)},[]),ae=f.useCallback(()=>{const I=m.current;if(!I||I.getSelectionType()!=="cell")return null;const c=I.getSelectionRangeOrActiveCell();return c?`${w(c[0])}:${w(c[1])}`:null},[]),A=f.useCallback(()=>{u!==null&&x(null),v&&p(!1)},[v,u]);return f.useEffect(()=>{x(null),p(!1)},[l]),f.useEffect(()=>{o(!0)},[]),f.useEffect(()=>{const I=n.current;if(!r||!I||!k)return;let c;const F=[];let S=!1,T=!1,E=!1,L=null,_=null,C=null;return St(I,{theme:s,store:new Yt(k,l),readOnly:t}).then(P=>{if(S){P.cleanup();return}c=P,m.current=P,d($=>$+1),F.push(P.onSelectionChange(()=>{!M.current||L!==null||(L=requestAnimationFrame(()=>{L=null,d($=>$+1)}))}));const ye=()=>{if(!(S||!c)){if(T){E=!0;return}T=!0,c.reloadDimensions().then(()=>{if(!(S||!c))return c.recalculateCrossSheetFormulas()}).finally(()=>{T=!1,E&&(E=!1,queueMicrotask(ye))})}},at=()=>{S||C!==null||(C=requestAnimationFrame(()=>{C=null,ye()}))},ct=()=>{_===null&&(_=requestAnimationFrame(()=>{_=null,!S&&c&&c.renderOverlay()}))};P.setGridResolver(($,ht)=>{const Fe=k.getRoot(),Te=Object.values(Fe.tabs).find(U=>U.name.toUpperCase()===$);if(!Te)return;const he=Fe.sheets[Te.id];if(!he)return;const Be=new Map;if(he.merges)for(const[U,de]of Object.entries(he.merges)){const W=B(U);for(let re=W.r;re<W.r+de.rs;re++)for(let J=W.c;J<W.c+de.cs;J++){const De=w({r:re,c:J});De!==U&&Be.set(De,U)}}const Pe=new Map;for(const U of ht){const de=B(U),W=w(de),re=Be.get(W)||W,J=he.sheet[re];J&&Pe.set(U,J)}return Pe}),ye(),F.push(k.subscribe($=>{$.type==="remote-change"&&at()})),F.push(k.subscribe("presence",ct))}),()=>{S=!0,c&&c.cleanup(),m.current=void 0,L!==null&&cancelAnimationFrame(L),_!==null&&cancelAnimationFrame(_),C!==null&&cancelAnimationFrame(C);for(const P of F)P()}},[r,n,k,l,t,s]),f.useEffect(()=>{var I,c;u&&((c=(I=h==null?void 0:h.sheets[l])==null?void 0:I.charts)!=null&&c[u]||(x(null),p(!1)))},[h,u,l]),g?e.jsx(mt,{}):a?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx("div",{className:"text-red-500",children:a.message})}):e.jsxs("div",{className:"flex h-full w-full flex-col",children:[!t&&e.jsx(Xt,{spreadsheet:m.current,onInsertChart:D}),e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx("div",{ref:n,className:"h-full w-full",style:{touchAction:"manipulation"},onPointerDown:A}),h&&b&&e.jsx(f.Suspense,{fallback:null,children:e.jsx(es,{spreadsheet:m.current,root:h,tabId:l,readOnly:t,selectedChartId:u,onSelectChart:x,onRequestEditChart:ie,onDeleteChart:q,onUpdateChart:V,renderVersion:i})}),h&&!t&&v&&e.jsx(f.Suspense,{fallback:null,children:e.jsx(ts,{root:h,chart:z,open:v,onClose:()=>p(!1),onUpdateChart:V,getSelectionRange:ae})})]})]})}const us=Object.freeze(Object.defineProperty({__proto__:null,SheetView:st,default:st},Symbol.toStringTag,{value:"Module"}));export{qe as I,st as S,ds as b,hs as f,qt as g,ot as p,Jt as r,us as s};
