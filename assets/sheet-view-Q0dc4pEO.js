const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chart-object-layer-44ZQCmbg.js","assets/index-D5oNvs3K.js","assets/index-J8kVSbPG.css","assets/use-mobile-sheet-gestures-CXy8Dgwh.js","assets/IconDotsVertical-CIzKPvuZ.js","assets/dropdown-menu-BoN6q3f2.js","assets/index-Dzzh6ZHZ.js","assets/index-Blev2G-K.js","assets/IconTrash-BwLIn7D5.js","assets/index-FAgfuOTz.js","assets/chart-editor-panel-D6M7R_vD.js","assets/button-qO4JQShF.js","assets/index-B1oXoLIo.js","assets/select-BDkYUNxM.js","assets/input-BY__sCcw.js","assets/label-B1x72qGd.js"])))=>i.map(i=>d[i]);
var as=Object.defineProperty;var hs=(n,s,t)=>s in n?as(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var H=(n,s,t)=>hs(n,typeof s!="symbol"?s+"":s,t);import{r as f,j as e,x as ds,y as us,t as ve,e as fs,_ as ss}from"./index-D5oNvs3K.js";import{b as Pe,C as ms,p as B,t as w,f as gs,a as ye,e as xe,i as pe,s as Ee,c as vs,d as ys,m as _e,g as xs,r as Ke,h as ps,u as bs,j as js}from"./use-mobile-sheet-gestures-CXy8Dgwh.js";import{a as ks}from"./index-Dzzh6ZHZ.js";import{f as Cs,P as Ms,D as G,a as X,b as Y,e as Z,d as K,c as v,p as re}from"./dropdown-menu-BoN6q3f2.js";import{c as Ss}from"./index-FAgfuOTz.js";import{c as ws}from"./index-Blev2G-K.js";import{c as j,u as Is,a as N,b as O,d as R,S as Q,I as zs}from"./IconDotsVertical-CIzKPvuZ.js";/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ke=j("outline","abc","IconAbc",[["path",{d:"M3 16v-6a2 2 0 1 1 4 0v6",key:"svg-0"}],["path",{d:"M3 13h4",key:"svg-1"}],["path",{d:"M10 8v6a2 2 0 1 0 4 0v-1a2 2 0 1 0 -4 0v1",key:"svg-2"}],["path",{d:"M20.732 12a2 2 0 0 0 -3.732 1v1a2 2 0 0 0 3.726 1.01",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ce=j("outline","align-box-bottom-center","IconAlignBoxBottomCenter",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 15v2",key:"svg-1"}],["path",{d:"M12 11v6",key:"svg-2"}],["path",{d:"M15 13v4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Me=j("outline","align-box-center-middle","IconAlignBoxCenterMiddle",[["path",{d:"M3 19v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M11 15h2",key:"svg-1"}],["path",{d:"M9 12h6",key:"svg-2"}],["path",{d:"M10 9h4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Se=j("outline","align-box-top-center","IconAlignBoxTopCenter",[["path",{d:"M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 9v-2",key:"svg-1"}],["path",{d:"M12 13v-6",key:"svg-2"}],["path",{d:"M15 11v-4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var we=j("outline","align-center","IconAlignCenter",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M8 12l8 0",key:"svg-1"}],["path",{d:"M6 18l12 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ie=j("outline","align-left","IconAlignLeft",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M4 12l10 0",key:"svg-1"}],["path",{d:"M4 18l14 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ze=j("outline","align-right","IconAlignRight",[["path",{d:"M4 6l16 0",key:"svg-0"}],["path",{d:"M10 12l10 0",key:"svg-1"}],["path",{d:"M6 18l14 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ns=j("outline","arrow-back-up","IconArrowBackUp",[["path",{d:"M9 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M5 10h11a4 4 0 1 1 0 8h-1",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Os=j("outline","arrow-forward-up","IconArrowForwardUp",[["path",{d:"M15 14l4 -4l-4 -4",key:"svg-0"}],["path",{d:"M19 10h-11a4 4 0 1 0 0 8h1",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Rs=j("outline","bold","IconBold",[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var be=j("outline","border-all","IconBorderAll",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M4 12l16 0",key:"svg-1"}],["path",{d:"M12 4l0 16",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Le=j("outline","border-bottom","IconBorderBottom",[["path",{d:"M20 20l-16 0",key:"svg-0"}],["path",{d:"M4 4l0 .01",key:"svg-1"}],["path",{d:"M8 4l0 .01",key:"svg-2"}],["path",{d:"M12 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M20 4l0 .01",key:"svg-5"}],["path",{d:"M4 8l0 .01",key:"svg-6"}],["path",{d:"M12 8l0 .01",key:"svg-7"}],["path",{d:"M20 8l0 .01",key:"svg-8"}],["path",{d:"M4 12l0 .01",key:"svg-9"}],["path",{d:"M8 12l0 .01",key:"svg-10"}],["path",{d:"M12 12l0 .01",key:"svg-11"}],["path",{d:"M16 12l0 .01",key:"svg-12"}],["path",{d:"M20 12l0 .01",key:"svg-13"}],["path",{d:"M4 16l0 .01",key:"svg-14"}],["path",{d:"M12 16l0 .01",key:"svg-15"}],["path",{d:"M20 16l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ve=j("outline","border-inner","IconBorderInner",[["path",{d:"M4 12l16 0",key:"svg-0"}],["path",{d:"M12 4l0 16",key:"svg-1"}],["path",{d:"M4 4l0 .01",key:"svg-2"}],["path",{d:"M8 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M20 4l0 .01",key:"svg-5"}],["path",{d:"M4 8l0 .01",key:"svg-6"}],["path",{d:"M20 8l0 .01",key:"svg-7"}],["path",{d:"M4 16l0 .01",key:"svg-8"}],["path",{d:"M20 16l0 .01",key:"svg-9"}],["path",{d:"M4 20l0 .01",key:"svg-10"}],["path",{d:"M8 20l0 .01",key:"svg-11"}],["path",{d:"M16 20l0 .01",key:"svg-12"}],["path",{d:"M20 20l0 .01",key:"svg-13"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ue=j("outline","border-left","IconBorderLeft",[["path",{d:"M4 20l0 -16",key:"svg-0"}],["path",{d:"M8 4l0 .01",key:"svg-1"}],["path",{d:"M12 4l0 .01",key:"svg-2"}],["path",{d:"M16 4l0 .01",key:"svg-3"}],["path",{d:"M20 4l0 .01",key:"svg-4"}],["path",{d:"M12 8l0 .01",key:"svg-5"}],["path",{d:"M20 8l0 .01",key:"svg-6"}],["path",{d:"M8 12l0 .01",key:"svg-7"}],["path",{d:"M12 12l0 .01",key:"svg-8"}],["path",{d:"M16 12l0 .01",key:"svg-9"}],["path",{d:"M20 12l0 .01",key:"svg-10"}],["path",{d:"M12 16l0 .01",key:"svg-11"}],["path",{d:"M20 16l0 .01",key:"svg-12"}],["path",{d:"M8 20l0 .01",key:"svg-13"}],["path",{d:"M12 20l0 .01",key:"svg-14"}],["path",{d:"M16 20l0 .01",key:"svg-15"}],["path",{d:"M20 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var $e=j("outline","border-none","IconBorderNone",[["path",{d:"M4 4l0 .01",key:"svg-0"}],["path",{d:"M8 4l0 .01",key:"svg-1"}],["path",{d:"M12 4l0 .01",key:"svg-2"}],["path",{d:"M16 4l0 .01",key:"svg-3"}],["path",{d:"M20 4l0 .01",key:"svg-4"}],["path",{d:"M4 8l0 .01",key:"svg-5"}],["path",{d:"M12 8l0 .01",key:"svg-6"}],["path",{d:"M20 8l0 .01",key:"svg-7"}],["path",{d:"M4 12l0 .01",key:"svg-8"}],["path",{d:"M8 12l0 .01",key:"svg-9"}],["path",{d:"M12 12l0 .01",key:"svg-10"}],["path",{d:"M16 12l0 .01",key:"svg-11"}],["path",{d:"M20 12l0 .01",key:"svg-12"}],["path",{d:"M4 16l0 .01",key:"svg-13"}],["path",{d:"M12 16l0 .01",key:"svg-14"}],["path",{d:"M20 16l0 .01",key:"svg-15"}],["path",{d:"M4 20l0 .01",key:"svg-16"}],["path",{d:"M8 20l0 .01",key:"svg-17"}],["path",{d:"M12 20l0 .01",key:"svg-18"}],["path",{d:"M16 20l0 .01",key:"svg-19"}],["path",{d:"M20 20l0 .01",key:"svg-20"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var We=j("outline","border-outer","IconBorderOuter",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M12 8l0 .01",key:"svg-1"}],["path",{d:"M8 12l0 .01",key:"svg-2"}],["path",{d:"M12 12l0 .01",key:"svg-3"}],["path",{d:"M16 12l0 .01",key:"svg-4"}],["path",{d:"M12 16l0 .01",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var He=j("outline","border-right","IconBorderRight",[["path",{d:"M20 4l0 16",key:"svg-0"}],["path",{d:"M4 4l0 .01",key:"svg-1"}],["path",{d:"M8 4l0 .01",key:"svg-2"}],["path",{d:"M12 4l0 .01",key:"svg-3"}],["path",{d:"M16 4l0 .01",key:"svg-4"}],["path",{d:"M4 8l0 .01",key:"svg-5"}],["path",{d:"M12 8l0 .01",key:"svg-6"}],["path",{d:"M4 12l0 .01",key:"svg-7"}],["path",{d:"M8 12l0 .01",key:"svg-8"}],["path",{d:"M12 12l0 .01",key:"svg-9"}],["path",{d:"M16 12l0 .01",key:"svg-10"}],["path",{d:"M4 16l0 .01",key:"svg-11"}],["path",{d:"M12 16l0 .01",key:"svg-12"}],["path",{d:"M4 20l0 .01",key:"svg-13"}],["path",{d:"M8 20l0 .01",key:"svg-14"}],["path",{d:"M12 20l0 .01",key:"svg-15"}],["path",{d:"M16 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ge=j("outline","border-top","IconBorderTop",[["path",{d:"M4 4l16 0",key:"svg-0"}],["path",{d:"M4 8l0 .01",key:"svg-1"}],["path",{d:"M12 8l0 .01",key:"svg-2"}],["path",{d:"M20 8l0 .01",key:"svg-3"}],["path",{d:"M4 12l0 .01",key:"svg-4"}],["path",{d:"M8 12l0 .01",key:"svg-5"}],["path",{d:"M12 12l0 .01",key:"svg-6"}],["path",{d:"M16 12l0 .01",key:"svg-7"}],["path",{d:"M20 12l0 .01",key:"svg-8"}],["path",{d:"M4 16l0 .01",key:"svg-9"}],["path",{d:"M12 16l0 .01",key:"svg-10"}],["path",{d:"M20 16l0 .01",key:"svg-11"}],["path",{d:"M4 20l0 .01",key:"svg-12"}],["path",{d:"M8 20l0 .01",key:"svg-13"}],["path",{d:"M12 20l0 .01",key:"svg-14"}],["path",{d:"M16 20l0 .01",key:"svg-15"}],["path",{d:"M20 20l0 .01",key:"svg-16"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ne=j("outline","calendar","IconCalendar",[["path",{d:"M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z",key:"svg-0"}],["path",{d:"M16 3v4",key:"svg-1"}],["path",{d:"M8 3v4",key:"svg-2"}],["path",{d:"M4 11h16",key:"svg-3"}],["path",{d:"M11 15h1",key:"svg-4"}],["path",{d:"M12 15v3",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xe=j("outline","chart-bar","IconChartBar",[["path",{d:"M3 13a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M15 9a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M9 5a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M4 20h14",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var de=j("outline","chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var oe=j("outline","currency-dollar","IconCurrencyDollar",[["path",{d:"M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2",key:"svg-0"}],["path",{d:"M12 3v3m0 12v3",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ue=j("outline","decimal","IconDecimal",[["path",{d:"M17 8a2 2 0 0 1 2 2v4a2 2 0 1 1 -4 0v-4a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M10 8a2 2 0 0 1 2 2v4a2 2 0 1 1 -4 0v-4a2 2 0 0 1 2 -2z",key:"svg-1"}],["path",{d:"M5 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ye=j("outline","droplet-off","IconDropletOff",[["path",{d:"M18.963 14.938a6.54 6.54 0 0 0 -.899 -4.06l-4.89 -7.26c-.42 -.626 -1.287 -.804 -1.936 -.398a1.376 1.376 0 0 0 -.41 .397l-1.282 1.9m-1.625 2.415l-1.986 2.946c-1.695 2.837 -1.035 6.44 1.567 8.545c2.602 2.105 6.395 2.105 8.996 0a6.83 6.83 0 0 0 1.376 -1.499",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var qe=j("outline","filter","IconFilter",[["path",{d:"M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Oe=j("outline","hash","IconHash",[["path",{d:"M5 9l14 0",key:"svg-0"}],["path",{d:"M5 15l14 0",key:"svg-1"}],["path",{d:"M11 4l-4 16",key:"svg-2"}],["path",{d:"M17 4l-4 16",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var As=j("outline","italic","IconItalic",[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Je=j("outline","math-function","IconMathFunction",[["path",{d:"M3 19a2 2 0 0 0 2 2c2 0 2 -4 3 -9s1 -9 3 -9a2 2 0 0 1 2 2",key:"svg-0"}],["path",{d:"M5 12h6",key:"svg-1"}],["path",{d:"M15 12l6 6",key:"svg-2"}],["path",{d:"M15 18l6 -6",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fs=j("outline","paint","IconPaint",[["path",{d:"M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2",key:"svg-1"}],["path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var fe=j("outline","percentage","IconPercentage",[["path",{d:"M17 17m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M7 7m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M6 18l12 -12",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ze=j("outline","strikethrough","IconStrikethrough",[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ts=j("outline","table-alias","IconTableAlias",[["path",{d:"M3 12v-7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-7",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v10",key:"svg-2"}],["path",{d:"M2 17a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-4z",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Bs=j("outline","typography","IconTypography",[["path",{d:"M4 20l3 0",key:"svg-0"}],["path",{d:"M14 20l7 0",key:"svg-1"}],["path",{d:"M6.9 15l6.9 0",key:"svg-2"}],["path",{d:"M10.2 6.3l5.8 13.7",key:"svg-3"}],["path",{d:"M5 20l6 -16l2 0l7 16",key:"svg-4"}]]),Ds="Toggle",ts=f.forwardRef((n,s)=>{const{pressed:t,defaultPressed:r=!1,onPressedChange:o,...l}=n,[i=!1,d]=Cs({prop:t,onChange:o,defaultProp:r});return e.jsx(Ms.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":n.disabled?"":void 0,...l,ref:s,onClick:ks(n.onClick,()=>{n.disabled||d(!i)})})});ts.displayName=Ds;var Ps=ts;const Es=Ss("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}});function je({className:n,variant:s,size:t,...r}){return e.jsx(Ps,{"data-slot":"toggle",className:ws(Es({variant:s,size:t}),n),...r})}const _s=["#000000","#434343","#666666","#999999","#cccccc","#d50000","#e67c73","#f4511e","#ef6c00","#f09300","#0b8043","#33b679","#039be5","#3f51b5","#7986cb","#8e24aa","#d81b60","#ad1457","#6a1b9a","#4a148c"],Ks=["#ffffff","#f3f3f3","#e8e8e8","#d9d9d9","#cccccc","#fce4ec","#fff3e0","#fff9c4","#e8f5e9","#e0f7fa","#e3f2fd","#ede7f6","#fce4ec","#f3e5f5","#e8eaf6","#ffcdd2","#ffe0b2","#fff59d","#c8e6c9","#b2dfdb"],Ls={left:Ie,center:we,right:ze},Vs={top:Se,middle:Me,bottom:Ce},Us={plain:ke,number:Oe,currency:oe,percent:fe,date:Ne},rs=typeof navigator<"u"&&/Mac|iPhone|iPad|iPod/.test(navigator.userAgent),ne=rs?"⌘":"Ctrl";function $s({spreadsheet:n,onInsertChart:s}){const t=Is(),[r,o]=f.useState(void 0),[l,i]=f.useState(!1),[d,u]=f.useState(!1),[p,y]=f.useState(!1),x=f.useMemo(()=>Pe("en-US"),[]),g=f.useMemo(()=>Pe(),[]),M=f.useCallback(async()=>{if(!n)return;const C=await n.getActiveStyle();o(C),i(n.isSelectionMerged()),u(n.canMergeSelection()),y(n.hasFilter())},[n]);f.useEffect(()=>{if(n)return M(),n.onSelectionChange(M)},[n,M]);const k=f.useCallback(C=>{n==null||n.toggleStyle(C)},[n]),m=f.useCallback(C=>{n==null||n.applyStyle({al:C})},[n]),c=f.useCallback(C=>{n==null||n.applyStyle({va:C})},[n]),h=f.useCallback(C=>{n==null||n.applyStyle({tc:C})},[n]),b=f.useCallback(()=>{n==null||n.applyStyle({tc:""})},[n]),z=f.useCallback(C=>{n==null||n.applyStyle({bg:C})},[n]),P=f.useCallback(()=>{n==null||n.applyStyle({bg:""})},[n]),V=f.useCallback(()=>{n==null||n.undo()},[n]),q=f.useCallback(()=>{n==null||n.redo()},[n]),le=f.useCallback(()=>{n==null||n.toggleFunctionBrowser()},[n]),ie=f.useCallback(()=>{s==null||s()},[s]),A=f.useCallback(C=>{n==null||n.applyStyle({nf:C})},[n]),ee=f.useCallback(()=>{n==null||n.increaseDecimals()},[n]),se=f.useCallback(()=>{n==null||n.decreaseDecimals()},[n]),ce=f.useCallback(()=>{n==null||n.toggleMergeCells()},[n]),I=f.useCallback(async()=>{n&&(n.hasFilter()?await n.clearFilter():await n.createFilterFromSelection(),await M())},[M,n]),a=f.useCallback(C=>{n==null||n.applyBorders(C)},[n]),F=(r==null?void 0:r.al)||"left",S=Ls[F],T=(r==null?void 0:r.va)||"top",E=Vs[T],L=(r==null?void 0:r.nf)||"plain",_=Us[L];return e.jsxs("div",{className:"flex items-center gap-0.5 overflow-x-auto border-b bg-background px-2 py-1 whitespace-nowrap",children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:V,children:e.jsx(Ns,{size:16})})}),e.jsxs(R,{children:["Undo (",ne,"+Z)"]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:q,children:e.jsx(Os,{size:16})})}),e.jsxs(R,{children:["Redo (",ne,"+",rs?"⇧Z":"Y",")"]})]}),e.jsx(Q,{orientation:"vertical",className:"mx-1 h-6"}),!t&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:()=>A("currency"),children:e.jsx(oe,{size:16})})}),e.jsxs(R,{children:["Format as currency (",g.currency,")"]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:()=>A("percent"),children:e.jsx(fe,{size:16})})}),e.jsx(R,{children:"Format as percent"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:se,children:[e.jsx(ue,{size:16}),e.jsx("span",{className:"absolute mt-3.5 ml-3 text-[8px] font-bold leading-none",children:"-"})]})}),e.jsx(R,{children:"Decrease decimal places"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",onClick:ee,children:[e.jsx(ue,{size:16}),e.jsx("span",{className:"absolute mt-3.5 ml-3 text-[8px] font-bold leading-none",children:"+"})]})}),e.jsx(R,{children:"Increase decimal places"})]}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(_,{size:16}),e.jsx(de,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"More format"})]}),e.jsxs(Y,{children:[e.jsx(Z,{className:"text-xs font-normal text-muted-foreground",children:"Common formats (US examples)"}),e.jsx(K,{}),e.jsxs(v,{onClick:()=>A("plain"),children:[e.jsx(ke,{size:16,className:"mr-2"}),"Plain text"]}),e.jsxs(v,{onClick:()=>A("number"),children:[e.jsx(Oe,{size:16,className:"mr-2"}),"Number",e.jsx(re,{children:x.number})]}),e.jsxs(v,{onClick:()=>A("currency"),children:[e.jsx(oe,{size:16,className:"mr-2"}),"Currency",e.jsx(re,{children:x.currencyValue})]}),e.jsxs(v,{onClick:()=>A("percent"),children:[e.jsx(fe,{size:16,className:"mr-2"}),"Percent",e.jsx(re,{children:x.percent})]}),e.jsx(K,{}),e.jsxs(Z,{className:"text-xs font-normal text-muted-foreground",children:["US date preview: ",x.date]}),e.jsx(K,{}),e.jsxs(Z,{className:"text-xs font-normal text-muted-foreground",children:["Your locale (",g.locale,")"]}),e.jsxs(v,{onClick:()=>A("currency"),children:[e.jsx(oe,{size:16,className:"mr-2"}),"Locale currency",e.jsx(re,{children:g.currencyValue})]}),e.jsxs(v,{onClick:()=>A("date"),children:[e.jsx(Ne,{size:16,className:"mr-2"}),"Locale date",e.jsx(re,{children:g.date})]})]})]}),e.jsx(Q,{orientation:"vertical",className:"mx-1 h-6"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(je,{size:"sm",pressed:(r==null?void 0:r.b)||!1,onPressedChange:()=>k("b"),className:"h-7 w-7 cursor-pointer",children:e.jsx(Rs,{size:16})})}),e.jsxs(R,{children:["Bold (",ne,"+B)"]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(je,{size:"sm",pressed:(r==null?void 0:r.i)||!1,onPressedChange:()=>k("i"),className:"h-7 w-7 cursor-pointer",children:e.jsx(As,{size:16})})}),e.jsxs(R,{children:["Italic (",ne,"+I)"]})]}),!t&&e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(je,{size:"sm",pressed:(r==null?void 0:r.st)||!1,onPressedChange:()=>k("st"),className:"h-7 w-7 cursor-pointer",children:e.jsx(Ze,{size:16})})}),e.jsx(R,{children:"Strikethrough"})]}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:[e.jsx(Bs,{size:16}),e.jsx("span",{className:"absolute mt-5 h-0.5 w-3.5 rounded",style:{backgroundColor:(r==null?void 0:r.tc)||"#000000"}})]})})}),e.jsx(R,{children:"Text color"})]}),e.jsxs(Y,{className:"w-auto p-2",children:[e.jsxs("button",{className:"mb-2 flex w-full items-center gap-2 rounded px-2 py-1 text-xs hover:bg-muted",onClick:b,children:[e.jsx(Ye,{size:14}),"Reset"]}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:_s.map(C=>e.jsx("button",{className:"h-5 w-5 rounded border border-border hover:scale-125 transition-transform",style:{backgroundColor:C},onClick:()=>h(C)},C))})]})]}),e.jsx(Q,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:[e.jsx(Fs,{size:16}),e.jsx("span",{className:"absolute mt-5 h-0.5 w-3.5 rounded",style:{backgroundColor:(r==null?void 0:r.bg)||"transparent",border:r!=null&&r.bg?"none":"1px solid #ccc"}})]})})}),e.jsx(R,{children:"Fill color"})]}),e.jsxs(Y,{className:"w-auto p-2",children:[e.jsxs("button",{className:"mb-2 flex w-full items-center gap-2 rounded px-2 py-1 text-xs hover:bg-muted",onClick:P,children:[e.jsx(Ye,{size:14}),"Reset"]}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:Ks.map(C=>e.jsx("button",{className:"h-5 w-5 rounded border border-border hover:scale-125 transition-transform",style:{backgroundColor:C},onClick:()=>z(C)},C))})]})]}),!t&&e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(be,{size:14}),e.jsx(de,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"Cell borders"})]}),e.jsxs(Y,{children:[e.jsxs(v,{onClick:()=>a("all"),children:[e.jsx(be,{size:14,className:"mr-2"}),"All borders"]}),e.jsxs(v,{onClick:()=>a("outer"),children:[e.jsx(We,{size:14,className:"mr-2"}),"Outer border"]}),e.jsxs(v,{onClick:()=>a("inner"),children:[e.jsx(Ve,{size:14,className:"mr-2"}),"Inner borders"]}),e.jsx(K,{}),e.jsxs(v,{onClick:()=>a("top"),children:[e.jsx(Ge,{size:14,className:"mr-2"}),"Top border"]}),e.jsxs(v,{onClick:()=>a("bottom"),children:[e.jsx(Le,{size:14,className:"mr-2"}),"Bottom border"]}),e.jsxs(v,{onClick:()=>a("left"),children:[e.jsx(Ue,{size:14,className:"mr-2"}),"Left border"]}),e.jsxs(v,{onClick:()=>a("right"),children:[e.jsx(He,{size:14,className:"mr-2"}),"Right border"]}),e.jsx(K,{}),e.jsxs(v,{onClick:()=>a("clear"),children:[e.jsx($e,{size:14,className:"mr-2"}),"Clear borders"]})]})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:`inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted disabled:cursor-not-allowed disabled:opacity-50 ${l?"bg-muted":""}`,onClick:ce,disabled:!l&&!d,children:e.jsx(Ts,{size:16})})}),e.jsx(R,{children:l?"Unmerge cells":`Merge cells (${ne}+Shift+M)`})]}),!t&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(S,{size:16}),e.jsx(de,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"Horizontal align"})]}),e.jsxs(Y,{children:[e.jsxs(v,{onClick:()=>m("left"),children:[e.jsx(Ie,{size:16,className:"mr-2"}),"Left"]}),e.jsxs(v,{onClick:()=>m("center"),children:[e.jsx(we,{size:16,className:"mr-2"}),"Center"]}),e.jsxs(v,{onClick:()=>m("right"),children:[e.jsx(ze,{size:16,className:"mr-2"}),"Right"]})]})]}),e.jsxs(G,{children:[e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx(X,{asChild:!0,children:e.jsxs("button",{className:"inline-flex h-7 cursor-pointer items-center justify-center gap-0 rounded-md px-1 text-sm hover:bg-muted",children:[e.jsx(E,{size:16}),e.jsx(de,{size:12,className:"ml-0.5 opacity-50"})]})})}),e.jsx(R,{children:"Vertical align"})]}),e.jsxs(Y,{children:[e.jsxs(v,{onClick:()=>c("top"),children:[e.jsx(Se,{size:16,className:"mr-2"}),"Top"]}),e.jsxs(v,{onClick:()=>c("middle"),children:[e.jsx(Me,{size:16,className:"mr-2"}),"Middle"]}),e.jsxs(v,{onClick:()=>c("bottom"),children:[e.jsx(Ce,{size:16,className:"mr-2"}),"Bottom"]})]})]}),e.jsx(Q,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-[11px] font-semibold hover:bg-muted",onClick:le,children:e.jsx(Je,{size:16,className:"mr-2"})})}),e.jsx(R,{children:"Functions"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:`inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted ${p?"bg-muted":""}`,onClick:()=>{I()},children:e.jsx(qe,{size:16})})}),e.jsx(R,{children:p?"Clear filter":"Create filter from selection"})]}),e.jsxs(N,{children:[e.jsx(O,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-[11px] font-semibold hover:bg-muted",onClick:ie,children:e.jsx(Xe,{size:16})})}),e.jsx(R,{children:"Insert chart"})]})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{orientation:"vertical",className:"mx-1 h-6"}),e.jsxs(G,{children:[e.jsx(X,{asChild:!0,children:e.jsx("button",{className:"inline-flex h-7 w-7 cursor-pointer items-center justify-center rounded-md text-sm hover:bg-muted",children:e.jsx(zs,{size:16})})}),e.jsxs(Y,{align:"end",children:[e.jsx(Z,{children:"Format"}),e.jsxs(v,{onClick:()=>A("currency"),children:[e.jsx(oe,{size:16,className:"mr-2"}),"Currency"]}),e.jsxs(v,{onClick:()=>A("percent"),children:[e.jsx(fe,{size:16,className:"mr-2"}),"Percent"]}),e.jsxs(v,{onClick:se,children:[e.jsx(ue,{size:16,className:"mr-2"}),"Decrease decimals"]}),e.jsxs(v,{onClick:ee,children:[e.jsx(ue,{size:16,className:"mr-2"}),"Increase decimals"]}),e.jsx(K,{}),e.jsxs(v,{onClick:()=>A("plain"),children:[e.jsx(ke,{size:16,className:"mr-2"}),"Plain text"]}),e.jsxs(v,{onClick:()=>A("number"),children:[e.jsx(Oe,{size:16,className:"mr-2"}),"Number (",x.number,")"]}),e.jsxs(v,{onClick:()=>A("date"),children:[e.jsx(Ne,{size:16,className:"mr-2"}),"Date (",g.date,")"]}),e.jsx(K,{}),e.jsxs(v,{onClick:()=>{I()},children:[e.jsx(qe,{size:16,className:"mr-2"}),p?"Clear filter":"Create filter"]}),e.jsx(K,{}),e.jsx(Z,{children:"Align"}),e.jsxs(v,{onClick:()=>m("left"),children:[e.jsx(Ie,{size:16,className:"mr-2"}),"Left"]}),e.jsxs(v,{onClick:()=>m("center"),children:[e.jsx(we,{size:16,className:"mr-2"}),"Center"]}),e.jsxs(v,{onClick:()=>m("right"),children:[e.jsx(ze,{size:16,className:"mr-2"}),"Right"]}),e.jsxs(v,{onClick:()=>c("top"),children:[e.jsx(Se,{size:16,className:"mr-2"}),"Top"]}),e.jsxs(v,{onClick:()=>c("middle"),children:[e.jsx(Me,{size:16,className:"mr-2"}),"Middle"]}),e.jsxs(v,{onClick:()=>c("bottom"),children:[e.jsx(Ce,{size:16,className:"mr-2"}),"Bottom"]}),e.jsx(K,{}),e.jsx(Z,{children:"Borders"}),e.jsxs(v,{onClick:()=>a("all"),children:[e.jsx(be,{size:14,className:"mr-2"}),"All borders"]}),e.jsxs(v,{onClick:()=>a("outer"),children:[e.jsx(We,{size:14,className:"mr-2"}),"Outer border"]}),e.jsxs(v,{onClick:()=>a("inner"),children:[e.jsx(Ve,{size:14,className:"mr-2"}),"Inner borders"]}),e.jsxs(v,{onClick:()=>a("top"),children:[e.jsx(Ge,{size:14,className:"mr-2"}),"Top border"]}),e.jsxs(v,{onClick:()=>a("bottom"),children:[e.jsx(Le,{size:14,className:"mr-2"}),"Bottom border"]}),e.jsxs(v,{onClick:()=>a("left"),children:[e.jsx(Ue,{size:14,className:"mr-2"}),"Left border"]}),e.jsxs(v,{onClick:()=>a("right"),children:[e.jsx(He,{size:14,className:"mr-2"}),"Right border"]}),e.jsxs(v,{onClick:()=>a("clear"),children:[e.jsx($e,{size:14,className:"mr-2"}),"Clear borders"]}),e.jsx(K,{}),e.jsxs(v,{onClick:()=>k("st"),children:[e.jsx(Ze,{size:16,className:"mr-2"}),"Strikethrough"]}),e.jsxs(v,{onClick:le,children:[e.jsx(Je,{size:16,className:"mr-2"}),"Functions"]}),e.jsxs(v,{onClick:ie,children:[e.jsx(Xe,{size:16,className:"mr-2"}),"Insert chart"]})]})]})]})]})}class Ws{constructor(s,t){H(this,"doc");H(this,"tabId");H(this,"cellIndex",new ms);H(this,"dirty",!0);H(this,"batchOverlay",null);H(this,"batchOps",null);this.doc=s,this.tabId=t,s.subscribe(r=>{r.type==="remote-change"&&(this.dirty=!0)})}getSheet(){return this.doc.getRoot().sheets[this.tabId]}isDuplicateOwnKeysError(s){return s instanceof TypeError&&s.message.includes("ownKeys")&&s.message.includes("duplicate")}snapshotObject(s){const t=s.toJSON;return typeof t=="function"?JSON.parse(t.call(s)):{...s}}stableObjectKeys(s){try{return Object.keys(s)}catch(t){if(this.isDuplicateOwnKeysError(t))return console.warn(t),Object.keys(this.snapshotObject(s));throw t}}stableObjectEntries(s){try{return Object.entries(s)}catch(t){if(this.isDuplicateOwnKeysError(t))return console.warn(t),Object.entries(this.snapshotObject(s));throw t}}stableSheetKeys(s){return this.stableObjectKeys(s)}stableSheetEntries(s){return this.stableObjectEntries(s)}toPlainString(s){if(typeof s=="string")return s;if(s==null)return"";if(typeof s=="number"||typeof s=="boolean")return String(s);if(typeof s=="object"){const t=s;if(t.value!==void 0&&t.value!==s)return this.toPlainString(t.value);if(typeof t.toJSON=="function")try{const r=t.toJSON.call(s);if(r!==s)return this.toPlainString(r)}catch{}}return String(s)}normalizeFilterCondition(s){const t={op:s.op};return s.value!==void 0&&(t.value=this.toPlainString(s.value)),s.values!==void 0&&(t.values=s.values.map(r=>this.toPlainString(r))),t}toWorksheetFilterState(s){return{startRow:s.range[0].r,endRow:s.range[1].r,startCol:s.range[0].c,endCol:s.range[1].c,columns:Object.fromEntries(Object.entries(s.columns).map(([t,r])=>[t,this.normalizeFilterCondition(r)])),hiddenRows:[...s.hiddenRows]}}fromWorksheetFilterState(s){if(s)return{range:[{r:s.startRow,c:s.startCol},{r:s.endRow,c:s.endCol}],columns:Object.fromEntries(Object.entries(s.columns||{}).map(([t,r])=>[t,this.normalizeFilterCondition(r)])),hiddenRows:[...s.hiddenRows||[]]}}ensureIndex(){if(!this.dirty)return;const s=this.getSheet().sheet,t=[];for(const r of this.stableSheetKeys(s)){const o=B(r);t.push([o.r,o.c])}this.cellIndex.rebuild(t),this.dirty=!1}normalizeCell(s){const t={};return s.v!==void 0&&s.v!==""&&(t.v=s.v),s.f!==void 0&&s.f!==""&&(t.f=s.f),s.s&&Object.keys(s.s).length>0&&(t.s=s.s),t.v===void 0&&t.f===void 0&&t.s===void 0?null:t}async set(s,t){const r=w(s),o=this.normalizeCell(t);if(this.batchOverlay){o?(this.batchOverlay.set(r,o),this.dirty||this.cellIndex.add(s.r,s.c)):(this.batchOverlay.set(r,null),this.dirty||this.cellIndex.remove(s.r,s.c));return}if(!o){await this.delete(s);return}const l=this.tabId;this.doc.update(i=>{i.sheets[l].sheet[r]=o}),this.dirty||this.cellIndex.add(s.r,s.c)}async get(s){const t=w(s);if(this.batchOverlay&&this.batchOverlay.has(t)){const r=this.batchOverlay.get(t);return r===null?void 0:r}return this.getSheet().sheet[t]}async has(s){const t=w(s);return this.batchOverlay&&this.batchOverlay.has(t)?this.batchOverlay.get(t)!==null:this.getSheet().sheet[t]!==void 0}async delete(s){const t=w(s);if(this.batchOverlay){let l=!1;return this.batchOverlay.has(t)?l=this.batchOverlay.get(t)!==null:l=this.getSheet().sheet[t]!==void 0,l?(this.batchOverlay.set(t,null),this.dirty||this.cellIndex.remove(s.r,s.c),!0):!1}let r=!1;const o=this.tabId;return this.doc.update(l=>{l.sheets[o].sheet[t]!==void 0&&(delete l.sheets[o].sheet[t],r=!0)}),r&&!this.dirty&&this.cellIndex.remove(s.r,s.c),r}async deleteRange(s){this.ensureIndex();const t=Array.from(this.cellIndex.cellsInRange(s)),r=new Set;if(this.batchOverlay){for(const[l,i]of t){const d=w({r:l,c:i});this.batchOverlay.has(d)&&this.batchOverlay.get(d)===null||(this.batchOverlay.set(d,null),r.add(d))}for(const[l,i]of t)this.cellIndex.remove(l,i);return r}const o=this.tabId;this.doc.update(l=>{for(const[i,d]of t){const u=w({r:i,c:d});delete l.sheets[o].sheet[u],r.add(u)}});for(const[l,i]of t)this.cellIndex.remove(l,i);return r}async setGrid(s){if(this.batchOverlay){for(const[r,o]of s){const l=B(r),i=this.normalizeCell(o);i?(this.batchOverlay.set(r,i),this.dirty||this.cellIndex.add(l.r,l.c)):(this.batchOverlay.set(r,null),this.dirty||this.cellIndex.remove(l.r,l.c))}return}const t=this.tabId;if(this.doc.update(r=>{for(const[o,l]of s){const i=this.normalizeCell(l);i?r.sheets[t].sheet[o]=i:r.sheets[t].sheet[o]!==void 0&&delete r.sheets[t].sheet[o]}}),!this.dirty)for(const[r,o]of s){const l=B(r);this.normalizeCell(o)?this.cellIndex.add(l.r,l.c):this.cellIndex.remove(l.r,l.c)}}async getGrid(s){this.ensureIndex();const t=this.getSheet().sheet,r=new Map;for(const[o,l]of this.cellIndex.cellsInRange(s)){const i=w({r:o,c:l});if(this.batchOverlay&&this.batchOverlay.has(i)){const u=this.batchOverlay.get(i);u!==null&&r.set(i,u);continue}const d=t[i];d!==void 0&&r.set(i,d)}return r}async findEdge(s,t,r){return this.ensureIndex(),gs(this.cellIndex,s,t,r,(o,l)=>{const i=w({r:o,c:l}),d=this.getSheet().sheet[i];return d!==void 0&&(!!d.v||!!d.f)})}async shiftCells(s,t,r){const o=this.tabId,l=i=>{const d=i.sheets[o],u=[];for(const[m,c]of this.stableSheetEntries(d.sheet))u.push([m,{v:c.v,f:c.f,s:c.s}]);const p=new Map;for(const[m,c]of u){const h=Ee(m,s,t,r);if(h===null)continue;let b;c.f?b={...c,f:vs(c.f,s,t,r)}:b={...c};const z=this.normalizeCell(b);z&&p.set(h,z)}for(const[m]of u)!p.has(m)&&d.sheet[m]!==void 0&&delete d.sheet[m];for(const[m,c]of p)d.sheet[m]=c;const y=s==="row"?d.rowHeights:d.colWidths,x=[];for(const[m,c]of Object.entries(y))x.push([m,c]);for(const[m]of x)delete y[m];for(const[m,c]of x){const h=Number(m);if(r>0)h>=t?y[String(h+r)]=c:y[m]=c;else{const b=Math.abs(r);h>=t&&h<t+b||(h>=t+b?y[String(h+r)]=c:y[m]=c)}}const g=s==="row"?d.rowStyles:d.colStyles;if(g){const m=[];for(const[c,h]of Object.entries(g))m.push([c,h]);for(const[c]of m)delete g[c];for(const[c,h]of m){const b=Number(c);if(r>0)b>=t?g[String(b+r)]=h:g[c]=h;else{const z=Math.abs(r);b>=t&&b<t+z||(b>=t+z?g[String(b+r)]=h:g[c]=h)}}}const M=new Map(Object.entries(d.merges||{})),k=ys(M,s,t,r);d.merges={};for(const[m,c]of k)d.merges[m]=c;if(d.charts)for(const m of Object.values(d.charts)){const c=Ee(m.anchor,s,t,r);if(c){m.anchor=c;continue}const h=B(m.anchor);s==="row"?h.r=Math.max(1,t):h.c=Math.max(1,t),m.anchor=w(h)}};if(this.batchOps){this.batchOps.push(l),this.dirty=!0;return}this.doc.update(i=>{l(i)}),this.dirty=!0}async moveCells(s,t,r,o){const l=this.tabId,i=d=>{const u=d.sheets[l],p=[];for(const[c,h]of this.stableSheetEntries(u.sheet))p.push([c,{v:h.v,f:h.f,s:h.s}]);const y=new Map;for(const[c,h]of p){const b=B(c),z=_e(b,s,t,r,o),P=w(z);let V;h.f?V={...h,f:xs(h.f,s,t,r,o)}:V={...h};const q=this.normalizeCell(V);q&&y.set(P,q)}for(const[c]of p)!y.has(c)&&u.sheet[c]!==void 0&&delete u.sheet[c];for(const[c,h]of y)u.sheet[c]=h;const x=s==="row"?u.rowHeights:u.colWidths,g=[];for(const[c,h]of Object.entries(x))g.push([c,h]);for(const[c]of g)delete x[c];for(const[c,h]of g){const b=Number(c),z=Ke(b,t,r,o);x[String(z)]=h}const M=s==="row"?u.rowStyles:u.colStyles;if(M){const c=[];for(const[h,b]of Object.entries(M))c.push([h,b]);for(const[h]of c)delete M[h];for(const[h,b]of c){const z=Number(h),P=Ke(z,t,r,o);M[String(P)]=b}}const k=new Map(Object.entries(u.merges||{})),m=ps(k,s,t,r,o);u.merges={};for(const[c,h]of m)u.merges[c]=h;if(u.charts)for(const c of Object.values(u.charts)){const h=_e(B(c.anchor),s,t,r,o);c.anchor=w(h)}};if(this.batchOps){this.batchOps.push(i),this.dirty=!0;return}this.doc.update(d=>{i(d)}),this.dirty=!0}async getFormulaGrid(){const s=new Map,t=this.getSheet().sheet;for(const[r,o]of this.stableSheetEntries(t))o.f&&s.set(r,o);return s}async buildDependantsMap(s){const t=new Map,r=this.getSheet().sheet;if(this.batchOverlay){for(const[o,l]of this.stableSheetEntries(r))if(!this.batchOverlay.has(o)&&l.f)for(const i of ye(xe(l.f)))pe(i)||(t.has(i)||t.set(i,new Set),t.get(i).add(o));for(const[o,l]of this.batchOverlay)if(!(l===null||!l.f))for(const i of ye(xe(l.f)))pe(i)||(t.has(i)||t.set(i,new Set),t.get(i).add(o));return t}for(const[o,l]of this.stableSheetEntries(r))if(l.f)for(const i of ye(xe(l.f)))pe(i)||(t.has(i)||t.set(i,new Set),t.get(i).add(o));return t}async setDimensionSize(s,t,r){if(this.batchOps){const l=this.tabId;this.batchOps.push(i=>{const d=s==="row"?i.sheets[l].rowHeights:i.sheets[l].colWidths;d[String(t)]=r});return}const o=this.tabId;this.doc.update(l=>{const i=s==="row"?l.sheets[o].rowHeights:l.sheets[o].colWidths;i[String(t)]=r})}async getDimensionSizes(s){const t=this.getSheet(),r=s==="row"?t.rowHeights:t.colWidths,o=new Map;if(r)for(const[l,i]of Object.entries(r))o.set(Number(l),i);return o}updateActiveCell(s){this.doc.update((t,r)=>{r.set({activeCell:w(s)})})}getPresences(){return this.doc.getOthersPresences()}async setColumnStyle(s,t){if(this.batchOps){const o=this.tabId;this.batchOps.push(l=>{l.sheets[o].colStyles||(l.sheets[o].colStyles={}),l.sheets[o].colStyles[String(s)]=t});return}const r=this.tabId;this.doc.update(o=>{o.sheets[r].colStyles||(o.sheets[r].colStyles={}),o.sheets[r].colStyles[String(s)]=t})}async getColumnStyles(){const s=this.getSheet(),t=new Map;if(s.colStyles)for(const[r,o]of Object.entries(s.colStyles))t.set(Number(r),o);return t}async setRowStyle(s,t){if(this.batchOps){const o=this.tabId;this.batchOps.push(l=>{l.sheets[o].rowStyles||(l.sheets[o].rowStyles={}),l.sheets[o].rowStyles[String(s)]=t});return}const r=this.tabId;this.doc.update(o=>{o.sheets[r].rowStyles||(o.sheets[r].rowStyles={}),o.sheets[r].rowStyles[String(s)]=t})}async getRowStyles(){const s=this.getSheet(),t=new Map;if(s.rowStyles)for(const[r,o]of Object.entries(s.rowStyles))t.set(Number(r),o);return t}async setSheetStyle(s){if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{o.sheets[r].sheetStyle=s});return}const t=this.tabId;this.doc.update(r=>{r.sheets[t].sheetStyle=s})}async getSheetStyle(){const s=this.getSheet();return s.sheetStyle?{...s.sheetStyle}:void 0}async setMerge(s,t){if(this.batchOps){const l=this.tabId,i=w(s);this.batchOps.push(d=>{d.sheets[l].merges||(d.sheets[l].merges={}),d.sheets[l].merges[i]={...t}});return}const r=this.tabId,o=w(s);this.doc.update(l=>{l.sheets[r].merges||(l.sheets[r].merges={}),l.sheets[r].merges[o]={...t}})}async deleteMerge(s){var l;const t=w(s);if(this.batchOps){const i=this.tabId;return!((l=this.getSheet().merges)!=null&&l[t])?!1:(this.batchOps.push(p=>{var y;(y=p.sheets[i].merges)!=null&&y[t]&&delete p.sheets[i].merges[t]}),!0)}let r=!1;const o=this.tabId;return this.doc.update(i=>{var d;(d=i.sheets[o].merges)!=null&&d[t]&&(delete i.sheets[o].merges[t],r=!0)}),r}async getMerges(){const s=this.getSheet(),t=new Map;if(!s.merges)return t;for(const[r,o]of Object.entries(s.merges))t.set(r,{...o});return t}async setFilterState(s){if(this.batchOps){const r=this.tabId;this.batchOps.push(o=>{const l=o.sheets[r];if(!s){delete l.filter;return}l.filter=this.toWorksheetFilterState(s)});return}const t=this.tabId;this.doc.update(r=>{const o=r.sheets[t];if(!s){delete o.filter;return}o.filter=this.toWorksheetFilterState(s)})}async getFilterState(){return this.fromWorksheetFilterState(this.getSheet().filter)}async setFreezePane(s,t){if(this.batchOps){const o=this.tabId;this.batchOps.push(l=>{l.sheets[o].frozenRows=s,l.sheets[o].frozenCols=t});return}const r=this.tabId;this.doc.update(o=>{o.sheets[r].frozenRows=s,o.sheets[r].frozenCols=t})}async getFreezePane(){const s=this.getSheet();return{frozenRows:s.frozenRows??0,frozenCols:s.frozenCols??0}}beginBatch(){this.batchOverlay=new Map,this.batchOps=[]}endBatch(){const s=this.batchOverlay,t=this.batchOps;this.batchOverlay=null,this.batchOps=null;const r=s&&s.size>0,o=t&&t.length>0;if(!r&&!o)return;const l=this.tabId;this.doc.update(i=>{const d=i.sheets[l];if(s)for(const[u,p]of s)if(p===null)d.sheet[u]!==void 0&&delete d.sheet[u];else{const y=this.normalizeCell(p);y?d.sheet[u]=y:d.sheet[u]!==void 0&&delete d.sheet[u]}if(t)for(const u of t)u(i)}),this.dirty=!0}async undo(){if(!this.doc.history.canUndo())return{success:!1};const s=new Set(this.stableSheetKeys(this.getSheet().sheet)),t=new Map(Object.entries(this.getSheet().merges||{}));return this.doc.history.undo(),this.dirty=!0,{success:!0,affectedRange:this.computeAffectedRange(s,t)}}async redo(){if(!this.doc.history.canRedo())return{success:!1};const s=new Set(this.stableSheetKeys(this.getSheet().sheet)),t=new Map(Object.entries(this.getSheet().merges||{}));return this.doc.history.redo(),this.dirty=!0,{success:!0,affectedRange:this.computeAffectedRange(s,t)}}computeAffectedRange(s,t){const r=new Set(this.stableSheetKeys(this.getSheet().sheet)),o=new Map(Object.entries(this.getSheet().merges||{})),l=new Set;for(const y of r)s.has(y)||l.add(y);for(const y of s)r.has(y)||l.add(y);for(const[y,x]of o){const g=t.get(y);(!g||g.rs!==x.rs||g.cs!==x.cs)&&l.add(y)}for(const y of t.keys())o.has(y)||l.add(y);if(l.size===0)return;let i=1/0,d=-1/0,u=1/0,p=-1/0;for(const y of l){const x=B(y);x.r<i&&(i=x.r),x.r>d&&(d=x.r),x.c<u&&(u=x.c),x.c>p&&(p=x.c)}return[{r:i,c:u},{r:d,c:p}]}canUndo(){return this.doc.history.canUndo()}canRedo(){return this.doc.history.canRedo()}}function ns(n){if(typeof n!="string")return null;const s=n.toUpperCase().replace(/\$/g,"").split(":").map(t=>t.trim()).filter(Boolean);if(s.length!==2)return null;try{const t=B(s[0]),r=B(s[1]);return[{r:Math.min(t.r,r.r),c:Math.min(t.c,r.c)},{r:Math.max(t.r,r.r),c:Math.max(t.c,r.c)}]}catch{return null}}function lt(n){return`${w(n[0])}:${w(n[1])}`}function Hs(n){const[s,t]=n,r=[];for(let o=s.c;o<=t.c;o++)r.push(os(o));return r.length===0?{xAxisColumn:null,seriesColumns:[]}:{xAxisColumn:r[0],seriesColumns:r.slice(1)}}function Gs(n,s){const t=n.sheets[s.sourceTabId];if(!t)return{columns:[],xAxisColumn:null,seriesColumns:[]};const r=ns(s.sourceRange);if(!r)return{columns:[],xAxisColumn:null,seriesColumns:[]};const[o,l]=r,i=[];for(let g=o.c;g<=l.c;g++){const M=os(g);i.push({column:M,index:g,label:me(t,o.r,g)||M})}if(i.length===0)return{columns:[],xAxisColumn:null,seriesColumns:[]};const d=i[0].column,u=Re(s.xAxisColumn),p=i.some(g=>g.column===u)?u:d,y=new Set,x=[];for(const g of s.seriesColumns||[]){const M=Re(g);M&&M!==p&&!y.has(M)&&i.some(k=>k.column===M)&&(y.add(M),x.push(M))}if(x.length===0)for(const g of i)g.column!==p&&x.push(g.column);return{columns:i,xAxisColumn:p,seriesColumns:x}}function it(n,s){const t=n.sheets[s.sourceTabId];if(!t)return{xKey:"category",rows:[],series:[],config:{}};const r=ns(s.sourceRange);if(!r)return{xKey:"category",rows:[],series:[],config:{}};const[o,l]=r,i=l.c-o.c+1,d=l.r-o.r+1;if(i<2||d<2)return{xKey:"category",rows:[],series:[],config:{}};const u=Gs(n,s);if(!u.xAxisColumn||u.seriesColumns.length===0)return{xKey:"category",rows:[],series:[],config:{}};const p=Qe(u.xAxisColumn);if(!p)return{xKey:"category",rows:[],series:[],config:{}};const y=[],x={},g=[];for(const[m,c]of u.seriesColumns.entries()){const h=Qe(c);if(!h)continue;const b=me(t,o.r,h)||c,z=`series_${c}`,P={key:z,label:b};y.push(P),g.push({...P,index:h}),x[z]={label:b,color:Ys(m)}}if(g.length===0)return{xKey:"category",rows:[],series:[],config:{}};const M="category",k=[];for(let m=o.r+1;m<=l.r;m++){const c={};c[M]=me(t,m,p)||`Row ${m-o.r}`;let h=!1;for(const b of g){const z=Xs(me(t,m,b.index));z!==null&&(c[b.key]=z,h=!0)}h&&k.push(c)}return{xKey:M,rows:k,series:y,config:x}}function me(n,s,t){var o;const r=(o=n.sheet[w({r:s,c:t})])==null?void 0:o.v;return typeof r=="string"?r:r==null?"":String(r)}function Xs(n){if(typeof n!="string")return null;const s=n.trim().replace(/,/g,"");if(!s)return null;const t=Number(s);return Number.isFinite(t)?t:null}function os(n){return w({r:1,c:n}).replace(/[0-9]+$/,"")}function Qe(n){const s=Re(n);if(!s)return null;try{return B(`${s}1`).c}catch{return null}}function Re(n){if(typeof n!="string")return null;const s=n.trim().toUpperCase();return/^[A-Z]+$/.test(s)?s:null}function Ys(n){const s=["var(--color-primary)","color-mix(in oklch, var(--color-primary) 78%, var(--color-background))","color-mix(in oklch, var(--color-primary) 68%, var(--color-foreground))","color-mix(in oklch, var(--color-primary) 56%, var(--color-background))","color-mix(in oklch, var(--color-primary) 46%, var(--color-foreground))"];return s[n%s.length]}const qs=f.lazy(()=>ss(()=>import("./chart-object-layer-44ZQCmbg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(n=>({default:n.ChartObjectLayer}))),Js=f.lazy(()=>ss(()=>import("./chart-editor-panel-D6M7R_vD.js"),__vite__mapDeps([10,1,2,11,7,9,6,5,12,13,4,14,15,3])).then(n=>({default:n.ChartEditorPanel})));function es({tabId:n,readOnly:s=!1}){var ee,se,ce;const{resolvedTheme:t}=ds(),r=f.useRef(null),[o,l]=f.useState(!1),[i,d]=f.useState(0),[u,p]=f.useState(null),[y,x]=f.useState(!1),g=f.useRef(void 0),M=f.useRef(!1),{doc:k,loading:m,error:c}=us.useDocument();bs({containerRef:r,sheetRef:g});const h=k==null?void 0:k.getRoot(),b=!!h&&Object.keys(((ee=h.sheets[n])==null?void 0:ee.charts)||{}).length>0,z=h&&u?(ce=(se=h.sheets[n])==null?void 0:se.charts)==null?void 0:ce[u]:void 0;f.useEffect(()=>{M.current=b},[b]);const P=f.useCallback(()=>{if(s)return;const I=g.current;if(!k||!I)return;if(I.getSelectionType()!=="cell"){ve.error("Select a cell range to insert a chart.");return}const a=I.getSelectionRangeOrActiveCell();if(!a){ve.error("Select a cell range to insert a chart.");return}const F=a[1].r-a[0].r+1,S=a[1].c-a[0].c+1;if(F<2||S<2){ve.error("Select at least 2 rows and 2 columns.");return}const T=`chart-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,E=`${w(a[0])}:${w(a[1])}`,L=w(a[0]),_=Hs([a[0],a[1]]);k.update(C=>{const D=C.sheets[n];D.charts||(D.charts={}),D.charts[T]={id:T,type:"bar",title:"Chart",sourceTabId:n,sourceRange:E,xAxisColumn:_.xAxisColumn||void 0,seriesColumns:_.seriesColumns,anchor:L,offsetX:8,offsetY:8,width:420,height:260}}),p(T),x(!0)},[k,s,n]),V=f.useCallback((I,a)=>{s||!k||k.update(F=>{var T,E;const S=(E=(T=F.sheets[n])==null?void 0:T.charts)==null?void 0:E[I];S&&(a.anchor!==void 0&&(S.anchor=a.anchor),a.offsetX!==void 0&&(S.offsetX=a.offsetX),a.offsetY!==void 0&&(S.offsetY=a.offsetY),a.width!==void 0&&(S.width=a.width),a.height!==void 0&&(S.height=a.height),a.title!==void 0&&(S.title=a.title),a.sourceRange!==void 0&&(S.sourceRange=a.sourceRange),a.type!==void 0&&(S.type=a.type),a.sourceTabId!==void 0&&(S.sourceTabId=a.sourceTabId),a.xAxisColumn!==void 0&&(S.xAxisColumn=a.xAxisColumn),a.seriesColumns!==void 0&&(S.seriesColumns=[...a.seriesColumns]))})},[k,s,n]),q=f.useCallback(I=>{s||!k||(k.update(a=>{var S;const F=a.sheets[n];(S=F==null?void 0:F.charts)!=null&&S[I]&&delete F.charts[I]}),u===I&&(p(null),x(!1)))},[k,s,u,n]),le=f.useCallback(I=>{p(I),x(!0)},[]),ie=f.useCallback(()=>{const I=g.current;if(!I||I.getSelectionType()!=="cell")return null;const a=I.getSelectionRangeOrActiveCell();return a?`${w(a[0])}:${w(a[1])}`:null},[]),A=f.useCallback(()=>{u!==null&&p(null),y&&x(!1)},[y,u]);return f.useEffect(()=>{p(null),x(!1)},[n]),f.useEffect(()=>{l(!0)},[]),f.useEffect(()=>{const I=r.current;if(!o||!I||!k)return;let a;const F=[];let S=!1,T=!1,E=!1,L=null,_=null,C=null;return js(I,{theme:t,store:new Ws(k,n),readOnly:s}).then(D=>{if(S){D.cleanup();return}a=D,g.current=D,d($=>$+1),F.push(D.onSelectionChange(()=>{!M.current||L!==null||(L=requestAnimationFrame(()=>{L=null,d($=>$+1)}))}));const ge=()=>{if(!(S||!a)){if(T){E=!0;return}T=!0,a.reloadDimensions().then(()=>{if(!(S||!a))return a.recalculateCrossSheetFormulas()}).finally(()=>{T=!1,E&&(E=!1,queueMicrotask(ge))})}},ls=()=>{S||C!==null||(C=requestAnimationFrame(()=>{C=null,ge()}))},is=()=>{_===null&&(_=requestAnimationFrame(()=>{_=null,!S&&a&&a.renderOverlay()}))};D.setGridResolver(($,cs)=>{const Ae=k.getRoot(),Fe=Object.values(Ae.tabs).find(U=>U.name.toUpperCase()===$);if(!Fe)return;const ae=Ae.sheets[Fe.id];if(!ae)return;const Te=new Map;if(ae.merges)for(const[U,he]of Object.entries(ae.merges)){const W=B(U);for(let te=W.r;te<W.r+he.rs;te++)for(let J=W.c;J<W.c+he.cs;J++){const De=w({r:te,c:J});De!==U&&Te.set(De,U)}}const Be=new Map;for(const U of cs){const he=B(U),W=w(he),te=Te.get(W)||W,J=ae.sheet[te];J&&Be.set(U,J)}return Be}),ge(),F.push(k.subscribe($=>{$.type==="remote-change"&&ls()})),F.push(k.subscribe("presence",is))}),()=>{S=!0,a&&a.cleanup(),g.current=void 0,L!==null&&cancelAnimationFrame(L),_!==null&&cancelAnimationFrame(_),C!==null&&cancelAnimationFrame(C);for(const D of F)D()}},[o,r,k,n,s,t]),f.useEffect(()=>{var I,a;u&&((a=(I=h==null?void 0:h.sheets[n])==null?void 0:I.charts)!=null&&a[u]||(p(null),x(!1)))},[h,u,n]),m?e.jsx(fs,{}):c?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx("div",{className:"text-red-500",children:c.message})}):e.jsxs("div",{className:"flex h-full w-full flex-col",children:[!s&&e.jsx($s,{spreadsheet:g.current,onInsertChart:P}),e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx("div",{ref:r,className:"h-full w-full",style:{touchAction:"manipulation"},onPointerDown:A}),h&&b&&e.jsx(f.Suspense,{fallback:null,children:e.jsx(qs,{spreadsheet:g.current,root:h,tabId:n,readOnly:s,selectedChartId:u,onSelectChart:p,onRequestEditChart:le,onDeleteChart:q,onUpdateChart:V,renderVersion:i})}),h&&!s&&y&&e.jsx(f.Suspense,{fallback:null,children:e.jsx(Js,{root:h,chart:z,open:y,onClose:()=>x(!1),onUpdateChart:V,getSelectionRange:ie})})]})]})}const ct=Object.freeze(Object.defineProperty({__proto__:null,SheetView:es,default:es},Symbol.toStringTag,{value:"Module"}));export{Xe as I,es as S,it as b,lt as f,Hs as g,ns as p,Gs as r,ct as s};
